<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.5"/>
<title>queso-0.50.0: QUESO::MLSampling&lt; P_V, P_M &gt; Class Template Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">queso-0.50.0
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.5 -->
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li class="current"><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="annotated.html"><span>Class&#160;List</span></a></li>
      <li><a href="classes.html"><span>Class&#160;Index</span></a></li>
      <li><a href="inherits.html"><span>Class&#160;Hierarchy</span></a></li>
      <li><a href="functions.html"><span>Class&#160;Members</span></a></li>
    </ul>
  </div>
<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="namespace_q_u_e_s_o.html">QUESO</a></li><li class="navelem"><a class="el" href="class_q_u_e_s_o_1_1_m_l_sampling.html">MLSampling</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#pri-methods">Private Member Functions</a> &#124;
<a href="#pri-attribs">Private Attributes</a> &#124;
<a href="#friends">Friends</a> &#124;
<a href="class_q_u_e_s_o_1_1_m_l_sampling-members.html">List of all members</a>  </div>
  <div class="headertitle">
<div class="title">QUESO::MLSampling&lt; P_V, P_M &gt; Class Template Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>A templated class that represents a Multilevel generator of samples.  
 <a href="class_q_u_e_s_o_1_1_m_l_sampling.html#details">More...</a></p>

<p><code>#include &lt;<a class="el" href="_m_l_sampling_8h_source.html">MLSampling.h</a>&gt;</code></p>
<div class="dynheader">
Collaboration diagram for QUESO::MLSampling&lt; P_V, P_M &gt;:</div>
<div class="dyncontent">
<div class="center"><img src="class_q_u_e_s_o_1_1_m_l_sampling__coll__graph.png" border="0" usemap="#_q_u_e_s_o_1_1_m_l_sampling_3_01_p___v_00_01_p___m_01_4_coll__map" alt="Collaboration graph"/></div>
<map name="_q_u_e_s_o_1_1_m_l_sampling_3_01_p___v_00_01_p___m_01_4_coll__map" id="_q_u_e_s_o_1_1_m_l_sampling_3_01_p___v_00_01_p___m_01_4_coll__map">
<area shape="rect" id="node2" href="class_q_u_e_s_o_1_1_base_environment.html" title="This (virtual) class sets up the environment underlying the use of the QUESO library by an executable..." alt="" coords="448,540,648,569"/><area shape="rect" id="node8" href="class_q_u_e_s_o_1_1_environment_options.html" title="This class reads options one can pass to a QUESO environment through an input file. " alt="" coords="805,855,1024,884"/><area shape="rect" id="node14" href="class_q_u_e_s_o_1_1_mpi_comm.html" title="The QUESO MPI Communicator Class. " alt="" coords="841,673,988,703"/><area shape="rect" id="node17" href="class_q_u_e_s_o_1_1_base_scalar_function.html" title="QUESO::BaseScalarFunction\l\&lt; P_V, P_M \&gt;" alt="" coords="1247,114,1457,161"/><area shape="rect" id="node20" href="class_q_u_e_s_o_1_1_vector_set.html" title="QUESO::VectorSet\&lt; P\l_V, P_M \&gt;" alt="" coords="828,245,1001,291"/><area shape="rect" id="node23" href="class_q_u_e_s_o_1_1_m_l_sampling_options.html" title="This class provides options for the Multilevel sequence generator if no input file is available..." alt="" coords="1483,67,1693,96"/><area shape="rect" id="node27" href="class_q_u_e_s_o_1_1_base_vector_r_v.html" title="QUESO::BaseVectorRV\l\&lt; P_V, P_M \&gt;" alt="" coords="1720,378,1896,425"/><area shape="rect" id="node29" href="class_q_u_e_s_o_1_1_base_vector_cdf.html" title="QUESO::BaseVectorCdf\l\&lt; P_V, P_M \&gt;" alt="" coords="1261,378,1443,425"/><area shape="rect" id="node33" href="class_q_u_e_s_o_1_1_base_vector_realizer.html" title="QUESO::BaseVectorRealizer\l\&lt; P_V, P_M \&gt;" alt="" coords="1245,517,1459,563"/><area shape="rect" id="node38" href="class_q_u_e_s_o_1_1_base_vector_mdf.html" title="QUESO::BaseVectorMdf\l\&lt; P_V, P_M \&gt;" alt="" coords="1260,309,1444,355"/><area shape="rect" id="node45" href="class_q_u_e_s_o_1_1_base_scalar_function.html" title="A templated (base) class for handling scalar functions. " alt="" coords="809,467,1020,514"/><area shape="rect" id="node50" href="class_q_u_e_s_o_1_1_vector_set.html" title="A templated class for handling sets. " alt="" coords="1048,754,1221,801"/><area shape="rect" id="node4" href="class_q_u_e_s_o_1_1_basic_pdfs_base.html" title="TODO: Base class for basic PDFs (via either GSL or Boost). " alt="" coords="16,513,195,543"/><area shape="rect" id="node6" href="class_q_u_e_s_o_1_1_rng_base.html" title="Class for random number generation (base class for either GSL or Boost RNG). " alt="" coords="36,567,175,596"/><area shape="rect" id="node11" href="class_q_u_e_s_o_1_1_env_options_values.html" title="This class provides a suite options one can pass to a QUESO environment. " alt="" coords="5,773,205,803"/><area shape="rect" id="node55" href="class_q_u_e_s_o_1_1_map.html" title="A class for partitioning vectors and matrices. " alt="" coords="1299,673,1405,703"/><area shape="rect" id="node43" href="class_q_u_e_s_o_1_1_base_joint_pdf.html" title="QUESO::BaseJointPdf\l\&lt; P_V, P_M \&gt;" alt="" coords="1269,447,1435,494"/><area shape="rect" id="node48" href="class_q_u_e_s_o_1_1_vector_space.html" title="QUESO::VectorSpace\l\&lt; P_V, P_M \&gt;" alt="" coords="2135,658,2300,705"/><area shape="rect" id="node53" href="class_q_u_e_s_o_1_1_dist_array.html" title="QUESO::DistArray\&lt; std\l::string \&gt;" alt="" coords="1719,697,1897,743"/></map>
<center><span class="legend">[<a href="graph_legend.html">legend</a>]</span></center></div>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr><td colspan="2"><div class="groupHeader">Constructor/Destructor methods</div></td></tr>
<tr class="memitem:a7738e481975c7ca2a47fa763bb92bdbe"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a7738e481975c7ca2a47fa763bb92bdbe">MLSampling</a> (const char *prefix, const <a class="el" href="class_q_u_e_s_o_1_1_base_vector_r_v.html">BaseVectorRV</a>&lt; P_V, P_M &gt; &amp;priorRv, const <a class="el" href="class_q_u_e_s_o_1_1_base_scalar_function.html">BaseScalarFunction</a>&lt; P_V, P_M &gt; &amp;likelihoodFunction)</td></tr>
<tr class="memdesc:a7738e481975c7ca2a47fa763bb92bdbe"><td class="mdescLeft">&#160;</td><td class="mdescRight">Constructor.  <a href="#a7738e481975c7ca2a47fa763bb92bdbe">More...</a><br/></td></tr>
<tr class="separator:a7738e481975c7ca2a47fa763bb92bdbe"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad3f442d1cac363497d04a4c8f8cf76c3"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_q_u_e_s_o_1_1_m_l_sampling.html#ad3f442d1cac363497d04a4c8f8cf76c3">~MLSampling</a> ()</td></tr>
<tr class="memdesc:ad3f442d1cac363497d04a4c8f8cf76c3"><td class="mdescLeft">&#160;</td><td class="mdescRight">Destructor.  <a href="#ad3f442d1cac363497d04a4c8f8cf76c3">More...</a><br/></td></tr>
<tr class="separator:ad3f442d1cac363497d04a4c8f8cf76c3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr><td colspan="2"><div class="groupHeader">Statistical methods</div></td></tr>
<tr class="memitem:a8d7296b30623c73ada38971cae27994a"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a8d7296b30623c73ada38971cae27994a">generateSequence</a> (<a class="el" href="class_q_u_e_s_o_1_1_base_vector_sequence.html">BaseVectorSequence</a>&lt; P_V, P_M &gt; &amp;workingChain, <a class="el" href="class_q_u_e_s_o_1_1_scalar_sequence.html">ScalarSequence</a>&lt; double &gt; *workingLogLikelihoodValues, <a class="el" href="class_q_u_e_s_o_1_1_scalar_sequence.html">ScalarSequence</a>&lt; double &gt; *workingLogTargetValues)</td></tr>
<tr class="memdesc:a8d7296b30623c73ada38971cae27994a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Method to generate the chain.  <a href="#a8d7296b30623c73ada38971cae27994a">More...</a><br/></td></tr>
<tr class="separator:a8d7296b30623c73ada38971cae27994a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae870f4b12060ae67d0c4473828b142f1"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_q_u_e_s_o_1_1_m_l_sampling.html#ae870f4b12060ae67d0c4473828b142f1">logEvidence</a> () const </td></tr>
<tr class="memdesc:ae870f4b12060ae67d0c4473828b142f1"><td class="mdescLeft">&#160;</td><td class="mdescRight">Method to calculate the logarithm of the evidence.  <a href="#ae870f4b12060ae67d0c4473828b142f1">More...</a><br/></td></tr>
<tr class="separator:ae870f4b12060ae67d0c4473828b142f1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ace6bbf605f8b655e0671d20309160941"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_q_u_e_s_o_1_1_m_l_sampling.html#ace6bbf605f8b655e0671d20309160941">meanLogLikelihood</a> () const </td></tr>
<tr class="memdesc:ace6bbf605f8b655e0671d20309160941"><td class="mdescLeft">&#160;</td><td class="mdescRight">Method to calculate the mean of the logarithm of the likelihood.  <a href="#ace6bbf605f8b655e0671d20309160941">More...</a><br/></td></tr>
<tr class="separator:ace6bbf605f8b655e0671d20309160941"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a31f7f977a3d42a06fdcd2918cc31bb40"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a31f7f977a3d42a06fdcd2918cc31bb40">eig</a> () const </td></tr>
<tr class="memdesc:a31f7f977a3d42a06fdcd2918cc31bb40"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculates the expected information gain value, EIG.  <a href="#a31f7f977a3d42a06fdcd2918cc31bb40">More...</a><br/></td></tr>
<tr class="separator:a31f7f977a3d42a06fdcd2918cc31bb40"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr><td colspan="2"><div class="groupHeader">I/O methods</div></td></tr>
<tr class="memitem:aec103dbc7af1af9e982d8c162033e77b"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_q_u_e_s_o_1_1_m_l_sampling.html#aec103dbc7af1af9e982d8c162033e77b">print</a> (std::ostream &amp;os) const </td></tr>
<tr class="memdesc:aec103dbc7af1af9e982d8c162033e77b"><td class="mdescLeft">&#160;</td><td class="mdescRight">TODO: Prints the sequence.  <a href="#aec103dbc7af1af9e982d8c162033e77b">More...</a><br/></td></tr>
<tr class="separator:aec103dbc7af1af9e982d8c162033e77b"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pri-methods"></a>
Private Member Functions</h2></td></tr>
<tr class="memitem:aa8e7bb1bd54ccafb9b276127a76eba71"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_q_u_e_s_o_1_1_m_l_sampling.html#aa8e7bb1bd54ccafb9b276127a76eba71">checkpointML</a> (double currExponent, double currEta, const <a class="el" href="class_q_u_e_s_o_1_1_sequence_of_vectors.html">SequenceOfVectors</a>&lt; P_V, P_M &gt; &amp;currChain, const <a class="el" href="class_q_u_e_s_o_1_1_scalar_sequence.html">ScalarSequence</a>&lt; double &gt; &amp;currLogLikelihoodValues, const <a class="el" href="class_q_u_e_s_o_1_1_scalar_sequence.html">ScalarSequence</a>&lt; double &gt; &amp;currLogTargetValues)</td></tr>
<tr class="memdesc:aa8e7bb1bd54ccafb9b276127a76eba71"><td class="mdescLeft">&#160;</td><td class="mdescRight">Writes checkpoint data for the ML method.  <a href="#aa8e7bb1bd54ccafb9b276127a76eba71">More...</a><br/></td></tr>
<tr class="separator:aa8e7bb1bd54ccafb9b276127a76eba71"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa387be291dd763ce001ea769e87266c4"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_q_u_e_s_o_1_1_m_l_sampling.html#aa387be291dd763ce001ea769e87266c4">restartML</a> (double &amp;currExponent, double &amp;currEta, <a class="el" href="class_q_u_e_s_o_1_1_sequence_of_vectors.html">SequenceOfVectors</a>&lt; P_V, P_M &gt; &amp;currChain, <a class="el" href="class_q_u_e_s_o_1_1_scalar_sequence.html">ScalarSequence</a>&lt; double &gt; &amp;currLogLikelihoodValues, <a class="el" href="class_q_u_e_s_o_1_1_scalar_sequence.html">ScalarSequence</a>&lt; double &gt; &amp;currLogTargetValues)</td></tr>
<tr class="memdesc:aa387be291dd763ce001ea769e87266c4"><td class="mdescLeft">&#160;</td><td class="mdescRight">Restarts ML algorithm.  <a href="#aa387be291dd763ce001ea769e87266c4">More...</a><br/></td></tr>
<tr class="separator:aa387be291dd763ce001ea769e87266c4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0a2615d8f3627630d0cb62cb91614bd1"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a0a2615d8f3627630d0cb62cb91614bd1">generateSequence_Level0_all</a> (const <a class="el" href="class_q_u_e_s_o_1_1_m_l_sampling_level_options.html">MLSamplingLevelOptions</a> &amp;currOptions, unsigned int &amp;unifiedRequestedNumSamples, <a class="el" href="class_q_u_e_s_o_1_1_sequence_of_vectors.html">SequenceOfVectors</a>&lt; P_V, P_M &gt; &amp;currChain, <a class="el" href="class_q_u_e_s_o_1_1_scalar_sequence.html">ScalarSequence</a>&lt; double &gt; &amp;currLogLikelihoodValues, <a class="el" href="class_q_u_e_s_o_1_1_scalar_sequence.html">ScalarSequence</a>&lt; double &gt; &amp;currLogTargetValues)</td></tr>
<tr class="memdesc:a0a2615d8f3627630d0cb62cb91614bd1"><td class="mdescLeft">&#160;</td><td class="mdescRight">Generates the sequence at the level 0.  <a href="#a0a2615d8f3627630d0cb62cb91614bd1">More...</a><br/></td></tr>
<tr class="separator:a0a2615d8f3627630d0cb62cb91614bd1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aea8da13aed5b04e64b8490ca5f107889"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_q_u_e_s_o_1_1_m_l_sampling.html#aea8da13aed5b04e64b8490ca5f107889">generateSequence_Step01_inter0</a> (const <a class="el" href="class_q_u_e_s_o_1_1_m_l_sampling_level_options.html">MLSamplingLevelOptions</a> *currOptions, unsigned int &amp;unifiedRequestedNumSamples)</td></tr>
<tr class="memdesc:aea8da13aed5b04e64b8490ca5f107889"><td class="mdescLeft">&#160;</td><td class="mdescRight">Reads options for the ML algorithm (Step 01 from ML algorithm).  <a href="#aea8da13aed5b04e64b8490ca5f107889">More...</a><br/></td></tr>
<tr class="separator:aea8da13aed5b04e64b8490ca5f107889"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a06c37730b943a1838d58475d322639b9"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a06c37730b943a1838d58475d322639b9">generateSequence_Step02_inter0</a> (const <a class="el" href="class_q_u_e_s_o_1_1_m_l_sampling_level_options.html">MLSamplingLevelOptions</a> *currOptions, <a class="el" href="class_q_u_e_s_o_1_1_sequence_of_vectors.html">SequenceOfVectors</a>&lt; P_V, P_M &gt; &amp;currChain, <a class="el" href="class_q_u_e_s_o_1_1_scalar_sequence.html">ScalarSequence</a>&lt; double &gt; &amp;currLogLikelihoodValues, <a class="el" href="class_q_u_e_s_o_1_1_scalar_sequence.html">ScalarSequence</a>&lt; double &gt; &amp;currLogTargetValues, <a class="el" href="class_q_u_e_s_o_1_1_sequence_of_vectors.html">SequenceOfVectors</a>&lt; P_V, P_M &gt; &amp;prevChain, <a class="el" href="class_q_u_e_s_o_1_1_scalar_sequence.html">ScalarSequence</a>&lt; double &gt; &amp;prevLogLikelihoodValues, <a class="el" href="class_q_u_e_s_o_1_1_scalar_sequence.html">ScalarSequence</a>&lt; double &gt; &amp;prevLogTargetValues, unsigned int &amp;indexOfFirstWeight, unsigned int &amp;indexOfLastWeight)</td></tr>
<tr class="memdesc:a06c37730b943a1838d58475d322639b9"><td class="mdescLeft">&#160;</td><td class="mdescRight">Saves chain and corresponding target pdf values from previous level (Step 02 from ML algorithm).  <a href="#a06c37730b943a1838d58475d322639b9">More...</a><br/></td></tr>
<tr class="separator:a06c37730b943a1838d58475d322639b9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae53e6bc0ec5d1f3d3ac9df268086cd75"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_q_u_e_s_o_1_1_m_l_sampling.html#ae53e6bc0ec5d1f3d3ac9df268086cd75">generateSequence_Step03_inter0</a> (const <a class="el" href="class_q_u_e_s_o_1_1_m_l_sampling_level_options.html">MLSamplingLevelOptions</a> *currOptions, const <a class="el" href="class_q_u_e_s_o_1_1_scalar_sequence.html">ScalarSequence</a>&lt; double &gt; &amp;prevLogLikelihoodValues, double prevExponent, double failedExponent, double &amp;currExponent, <a class="el" href="class_q_u_e_s_o_1_1_scalar_sequence.html">ScalarSequence</a>&lt; double &gt; &amp;weightSequence)</td></tr>
<tr class="memdesc:ae53e6bc0ec5d1f3d3ac9df268086cd75"><td class="mdescLeft">&#160;</td><td class="mdescRight">Computes <code>currExponent</code> and sequence of weights for current level and update 'm_logEvidenceFactors' (Step 03 from ML algorithm).  <a href="#ae53e6bc0ec5d1f3d3ac9df268086cd75">More...</a><br/></td></tr>
<tr class="separator:ae53e6bc0ec5d1f3d3ac9df268086cd75"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a955fb446652327edbc275e3d9145e2db"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a955fb446652327edbc275e3d9145e2db">generateSequence_Step04_inter0</a> (const <a class="el" href="class_q_u_e_s_o_1_1_sequence_of_vectors.html">SequenceOfVectors</a>&lt; P_V, P_M &gt; &amp;prevChain, const <a class="el" href="class_q_u_e_s_o_1_1_scalar_sequence.html">ScalarSequence</a>&lt; double &gt; &amp;weightSequence, P_M &amp;unifiedCovMatrix)</td></tr>
<tr class="memdesc:a955fb446652327edbc275e3d9145e2db"><td class="mdescLeft">&#160;</td><td class="mdescRight">Creates covariance matrix for current level (Step 04 from ML algorithm).  <a href="#a955fb446652327edbc275e3d9145e2db">More...</a><br/></td></tr>
<tr class="separator:a955fb446652327edbc275e3d9145e2db"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3db529d364d5bb47916066d7cc21cb00"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a3db529d364d5bb47916066d7cc21cb00">generateSequence_Step05_inter0</a> (unsigned int unifiedRequestedNumSamples, const <a class="el" href="class_q_u_e_s_o_1_1_scalar_sequence.html">ScalarSequence</a>&lt; double &gt; &amp;weightSequence, std::vector&lt; unsigned int &gt; &amp;unifiedIndexCountersAtProc0Only, std::vector&lt; double &gt; &amp;unifiedWeightStdVectorAtProc0Only)</td></tr>
<tr class="memdesc:a3db529d364d5bb47916066d7cc21cb00"><td class="mdescLeft">&#160;</td><td class="mdescRight">Creates <b>unified</b> finite distribution for current level (Step 05 from ML algorithm).  <a href="#a3db529d364d5bb47916066d7cc21cb00">More...</a><br/></td></tr>
<tr class="separator:a3db529d364d5bb47916066d7cc21cb00"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a21f642100e0690f65563e2c1f8bed816"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a21f642100e0690f65563e2c1f8bed816">generateSequence_Step06_all</a> (const <a class="el" href="class_q_u_e_s_o_1_1_m_l_sampling_level_options.html">MLSamplingLevelOptions</a> *currOptions, unsigned int indexOfFirstWeight, unsigned int indexOfLastWeight, const std::vector&lt; unsigned int &gt; &amp;unifiedIndexCountersAtProc0Only, bool &amp;useBalancedChains, std::vector&lt; <a class="el" href="struct_q_u_e_s_o_1_1_exchange_info_struct.html">ExchangeInfoStruct</a> &gt; &amp;exchangeStdVec)</td></tr>
<tr class="memdesc:a21f642100e0690f65563e2c1f8bed816"><td class="mdescLeft">&#160;</td><td class="mdescRight">Decides on wheter or not to use balanced chains (Step 06 from ML algorithm).  <a href="#a21f642100e0690f65563e2c1f8bed816">More...</a><br/></td></tr>
<tr class="separator:a21f642100e0690f65563e2c1f8bed816"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a270d639f90f6f2c60d1af851eea63d41"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a270d639f90f6f2c60d1af851eea63d41">generateSequence_Step07_inter0</a> (bool useBalancedChains, unsigned int indexOfFirstWeight, unsigned int indexOfLastWeight, const std::vector&lt; unsigned int &gt; &amp;unifiedIndexCountersAtProc0Only, <a class="el" href="struct_q_u_e_s_o_1_1_unbalanced_linked_chains_per_node_struct.html">UnbalancedLinkedChainsPerNodeStruct</a> &amp;unbalancedLinkControl, const <a class="el" href="class_q_u_e_s_o_1_1_m_l_sampling_level_options.html">MLSamplingLevelOptions</a> *currOptions, const <a class="el" href="class_q_u_e_s_o_1_1_sequence_of_vectors.html">SequenceOfVectors</a>&lt; P_V, P_M &gt; &amp;prevChain, std::vector&lt; <a class="el" href="struct_q_u_e_s_o_1_1_exchange_info_struct.html">ExchangeInfoStruct</a> &gt; &amp;exchangeStdVec, <a class="el" href="struct_q_u_e_s_o_1_1_balanced_linked_chains_per_node_struct.html">BalancedLinkedChainsPerNodeStruct</a>&lt; P_V &gt; &amp;balancedLinkControl)</td></tr>
<tr class="memdesc:a270d639f90f6f2c60d1af851eea63d41"><td class="mdescLeft">&#160;</td><td class="mdescRight">Plans for number of linked chains for each node so that all nodes generate the closest possible to the same number of positions (Step 07 from ML algorithm).  <a href="#a270d639f90f6f2c60d1af851eea63d41">More...</a><br/></td></tr>
<tr class="separator:a270d639f90f6f2c60d1af851eea63d41"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a754bc11c7802f627fece9f063450739a"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a754bc11c7802f627fece9f063450739a">generateSequence_Step08_all</a> (<a class="el" href="class_q_u_e_s_o_1_1_bayesian_joint_pdf.html">BayesianJointPdf</a>&lt; P_V, P_M &gt; &amp;currPdf, <a class="el" href="class_q_u_e_s_o_1_1_generic_vector_r_v.html">GenericVectorRV</a>&lt; P_V, P_M &gt; &amp;currRv)</td></tr>
<tr class="memdesc:a754bc11c7802f627fece9f063450739a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Creates a vector RV for current level (Step 08 from ML algorithm).  <a href="#a754bc11c7802f627fece9f063450739a">More...</a><br/></td></tr>
<tr class="separator:a754bc11c7802f627fece9f063450739a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a26892288f3b1902d78ba049b96579a08"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a26892288f3b1902d78ba049b96579a08">generateSequence_Step09_all</a> (const <a class="el" href="class_q_u_e_s_o_1_1_sequence_of_vectors.html">SequenceOfVectors</a>&lt; P_V, P_M &gt; &amp;prevChain, unsigned int indexOfFirstWeight, unsigned int indexOfLastWeight, const std::vector&lt; double &gt; &amp;unifiedWeightStdVectorAtProc0Only, const <a class="el" href="class_q_u_e_s_o_1_1_scalar_sequence.html">ScalarSequence</a>&lt; double &gt; &amp;weightSequence, double prevEta, const <a class="el" href="class_q_u_e_s_o_1_1_generic_vector_r_v.html">GenericVectorRV</a>&lt; P_V, P_M &gt; &amp;currRv, <a class="el" href="class_q_u_e_s_o_1_1_m_l_sampling_level_options.html">MLSamplingLevelOptions</a> *currOptions, P_M &amp;unifiedCovMatrix, double &amp;currEta)</td></tr>
<tr class="memdesc:a26892288f3b1902d78ba049b96579a08"><td class="mdescLeft">&#160;</td><td class="mdescRight">Scales the unified covariance matrix until min &lt;= rejection rate &lt;= max (Step 09 from ML algorithm).  <a href="#a26892288f3b1902d78ba049b96579a08">More...</a><br/></td></tr>
<tr class="separator:a26892288f3b1902d78ba049b96579a08"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a04322fda4c97eee6c6739fc007d642c1"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a04322fda4c97eee6c6739fc007d642c1">generateSequence_Step10_all</a> (<a class="el" href="class_q_u_e_s_o_1_1_m_l_sampling_level_options.html">MLSamplingLevelOptions</a> &amp;currOptions, const P_M &amp;unifiedCovMatrix, const <a class="el" href="class_q_u_e_s_o_1_1_generic_vector_r_v.html">GenericVectorRV</a>&lt; P_V, P_M &gt; &amp;currRv, bool useBalancedChains, const <a class="el" href="struct_q_u_e_s_o_1_1_unbalanced_linked_chains_per_node_struct.html">UnbalancedLinkedChainsPerNodeStruct</a> &amp;unbalancedLinkControl, unsigned int indexOfFirstWeight, const <a class="el" href="class_q_u_e_s_o_1_1_sequence_of_vectors.html">SequenceOfVectors</a>&lt; P_V, P_M &gt; &amp;prevChain, const <a class="el" href="struct_q_u_e_s_o_1_1_balanced_linked_chains_per_node_struct.html">BalancedLinkedChainsPerNodeStruct</a>&lt; P_V &gt; &amp;balancedLinkControl, <a class="el" href="class_q_u_e_s_o_1_1_sequence_of_vectors.html">SequenceOfVectors</a>&lt; P_V, P_M &gt; &amp;currChain, double &amp;cumulativeRawChainRunTime, unsigned int &amp;cumulativeRawChainRejections, <a class="el" href="class_q_u_e_s_o_1_1_scalar_sequence.html">ScalarSequence</a>&lt; double &gt; *currLogLikelihoodValues, <a class="el" href="class_q_u_e_s_o_1_1_scalar_sequence.html">ScalarSequence</a>&lt; double &gt; *currLogTargetValues)</td></tr>
<tr class="memdesc:a04322fda4c97eee6c6739fc007d642c1"><td class="mdescLeft">&#160;</td><td class="mdescRight">Samples the vector RV of current level (Step 10 from ML algorithm).  <a href="#a04322fda4c97eee6c6739fc007d642c1">More...</a><br/></td></tr>
<tr class="separator:a04322fda4c97eee6c6739fc007d642c1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aae527304bc1012a91ffc396e94fbab11"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_q_u_e_s_o_1_1_m_l_sampling.html#aae527304bc1012a91ffc396e94fbab11">generateSequence_Step11_inter0</a> (const <a class="el" href="class_q_u_e_s_o_1_1_m_l_sampling_level_options.html">MLSamplingLevelOptions</a> *currOptions, unsigned int unifiedRequestedNumSamples, unsigned int cumulativeRawChainRejections, <a class="el" href="class_q_u_e_s_o_1_1_sequence_of_vectors.html">SequenceOfVectors</a>&lt; P_V, P_M &gt; &amp;currChain, <a class="el" href="class_q_u_e_s_o_1_1_scalar_sequence.html">ScalarSequence</a>&lt; double &gt; &amp;currLogLikelihoodValues, <a class="el" href="class_q_u_e_s_o_1_1_scalar_sequence.html">ScalarSequence</a>&lt; double &gt; &amp;currLogTargetValues, unsigned int &amp;unifiedNumberOfRejections)</td></tr>
<tr class="memdesc:aae527304bc1012a91ffc396e94fbab11"><td class="mdescLeft">&#160;</td><td class="mdescRight">Filters chain (Step 11 from ML algorithm).  <a href="#aae527304bc1012a91ffc396e94fbab11">More...</a><br/></td></tr>
<tr class="separator:aae527304bc1012a91ffc396e94fbab11"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af71979655e46135b6a3c97b8909321f0"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_q_u_e_s_o_1_1_m_l_sampling.html#af71979655e46135b6a3c97b8909321f0">sampleIndexes_proc0</a> (unsigned int unifiedRequestedNumSamples, const std::vector&lt; double &gt; &amp;unifiedWeightStdVectorAtProc0Only, std::vector&lt; unsigned int &gt; &amp;unifiedIndexCountersAtProc0Only)</td></tr>
<tr class="separator:af71979655e46135b6a3c97b8909321f0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0f6f7872635b9546b3215fee347601f6"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a0f6f7872635b9546b3215fee347601f6">decideOnBalancedChains_all</a> (const <a class="el" href="class_q_u_e_s_o_1_1_m_l_sampling_level_options.html">MLSamplingLevelOptions</a> *currOptions, unsigned int indexOfFirstWeight, unsigned int indexOfLastWeight, const std::vector&lt; unsigned int &gt; &amp;unifiedIndexCountersAtProc0Only, std::vector&lt; <a class="el" href="struct_q_u_e_s_o_1_1_exchange_info_struct.html">ExchangeInfoStruct</a> &gt; &amp;exchangeStdVec)</td></tr>
<tr class="separator:a0f6f7872635b9546b3215fee347601f6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a75b2d73a0b07f594951a89cc1bc96849"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a75b2d73a0b07f594951a89cc1bc96849">prepareBalLinkedChains_inter0</a> (const <a class="el" href="class_q_u_e_s_o_1_1_m_l_sampling_level_options.html">MLSamplingLevelOptions</a> *currOptions, const <a class="el" href="class_q_u_e_s_o_1_1_sequence_of_vectors.html">SequenceOfVectors</a>&lt; P_V, P_M &gt; &amp;prevChain, std::vector&lt; <a class="el" href="struct_q_u_e_s_o_1_1_exchange_info_struct.html">ExchangeInfoStruct</a> &gt; &amp;exchangeStdVec, <a class="el" href="struct_q_u_e_s_o_1_1_balanced_linked_chains_per_node_struct.html">BalancedLinkedChainsPerNodeStruct</a>&lt; P_V &gt; &amp;balancedLinkControl)</td></tr>
<tr class="separator:a75b2d73a0b07f594951a89cc1bc96849"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a37dcf4d893b6c8f67fe077892bada773"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a37dcf4d893b6c8f67fe077892bada773">prepareUnbLinkedChains_inter0</a> (unsigned int indexOfFirstWeight, unsigned int indexOfLastWeight, const std::vector&lt; unsigned int &gt; &amp;unifiedIndexCountersAtProc0Only, <a class="el" href="struct_q_u_e_s_o_1_1_unbalanced_linked_chains_per_node_struct.html">UnbalancedLinkedChainsPerNodeStruct</a> &amp;unbalancedLinkControl)</td></tr>
<tr class="separator:a37dcf4d893b6c8f67fe077892bada773"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8e9d7681d17623c726814d206c8be4b2"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a8e9d7681d17623c726814d206c8be4b2">generateBalLinkedChains_all</a> (<a class="el" href="class_q_u_e_s_o_1_1_m_l_sampling_level_options.html">MLSamplingLevelOptions</a> &amp;inputOptions, const P_M &amp;unifiedCovMatrix, const <a class="el" href="class_q_u_e_s_o_1_1_generic_vector_r_v.html">GenericVectorRV</a>&lt; P_V, P_M &gt; &amp;rv, const <a class="el" href="struct_q_u_e_s_o_1_1_balanced_linked_chains_per_node_struct.html">BalancedLinkedChainsPerNodeStruct</a>&lt; P_V &gt; &amp;balancedLinkControl, <a class="el" href="class_q_u_e_s_o_1_1_sequence_of_vectors.html">SequenceOfVectors</a>&lt; P_V, P_M &gt; &amp;workingChain, double &amp;cumulativeRunTime, unsigned int &amp;cumulativeRejections, <a class="el" href="class_q_u_e_s_o_1_1_scalar_sequence.html">ScalarSequence</a>&lt; double &gt; *currLogLikelihoodValues, <a class="el" href="class_q_u_e_s_o_1_1_scalar_sequence.html">ScalarSequence</a>&lt; double &gt; *currLogTargetValues)</td></tr>
<tr class="separator:a8e9d7681d17623c726814d206c8be4b2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a04b0d797b321bb5c4047aab89a445e3c"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a04b0d797b321bb5c4047aab89a445e3c">generateUnbLinkedChains_all</a> (<a class="el" href="class_q_u_e_s_o_1_1_m_l_sampling_level_options.html">MLSamplingLevelOptions</a> &amp;inputOptions, const P_M &amp;unifiedCovMatrix, const <a class="el" href="class_q_u_e_s_o_1_1_generic_vector_r_v.html">GenericVectorRV</a>&lt; P_V, P_M &gt; &amp;rv, const <a class="el" href="struct_q_u_e_s_o_1_1_unbalanced_linked_chains_per_node_struct.html">UnbalancedLinkedChainsPerNodeStruct</a> &amp;unbalancedLinkControl, unsigned int indexOfFirstWeight, const <a class="el" href="class_q_u_e_s_o_1_1_sequence_of_vectors.html">SequenceOfVectors</a>&lt; P_V, P_M &gt; &amp;prevChain, <a class="el" href="class_q_u_e_s_o_1_1_sequence_of_vectors.html">SequenceOfVectors</a>&lt; P_V, P_M &gt; &amp;workingChain, double &amp;cumulativeRunTime, unsigned int &amp;cumulativeRejections, <a class="el" href="class_q_u_e_s_o_1_1_scalar_sequence.html">ScalarSequence</a>&lt; double &gt; *currLogLikelihoodValues, <a class="el" href="class_q_u_e_s_o_1_1_scalar_sequence.html">ScalarSequence</a>&lt; double &gt; *currLogTargetValues)</td></tr>
<tr class="separator:a04b0d797b321bb5c4047aab89a445e3c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a44ff302d505e5de781ea6635ea0d85d9"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a44ff302d505e5de781ea6635ea0d85d9">justBalance_proc0</a> (const <a class="el" href="class_q_u_e_s_o_1_1_m_l_sampling_level_options.html">MLSamplingLevelOptions</a> *currOptions, std::vector&lt; <a class="el" href="struct_q_u_e_s_o_1_1_exchange_info_struct.html">ExchangeInfoStruct</a> &gt; &amp;exchangeStdVec)</td></tr>
<tr class="separator:a44ff302d505e5de781ea6635ea0d85d9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1bb275df38553b88e2196103c7f5ea46"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a1bb275df38553b88e2196103c7f5ea46">mpiExchangePositions_inter0</a> (const <a class="el" href="class_q_u_e_s_o_1_1_sequence_of_vectors.html">SequenceOfVectors</a>&lt; P_V, P_M &gt; &amp;prevChain, const std::vector&lt; <a class="el" href="struct_q_u_e_s_o_1_1_exchange_info_struct.html">ExchangeInfoStruct</a> &gt; &amp;exchangeStdVec, const std::vector&lt; unsigned int &gt; &amp;finalNumChainsPerNode, const std::vector&lt; unsigned int &gt; &amp;finalNumPositionsPerNode, <a class="el" href="struct_q_u_e_s_o_1_1_balanced_linked_chains_per_node_struct.html">BalancedLinkedChainsPerNodeStruct</a>&lt; P_V &gt; &amp;balancedLinkControl)</td></tr>
<tr class="separator:a1bb275df38553b88e2196103c7f5ea46"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pri-attribs"></a>
Private Attributes</h2></td></tr>
<tr class="memitem:a13f1ca4fe9f94822fe572a743eaced1d"><td class="memItemLeft" align="right" valign="top">const <a class="el" href="class_q_u_e_s_o_1_1_base_environment.html">BaseEnvironment</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a></td></tr>
<tr class="memdesc:a13f1ca4fe9f94822fe572a743eaced1d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Queso enviroment.  <a href="#a13f1ca4fe9f94822fe572a743eaced1d">More...</a><br/></td></tr>
<tr class="separator:a13f1ca4fe9f94822fe572a743eaced1d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa45e9c06bd51cae0dc2294af1831c158"><td class="memItemLeft" align="right" valign="top">const <a class="el" href="class_q_u_e_s_o_1_1_base_vector_r_v.html">BaseVectorRV</a>&lt; P_V, P_M &gt; &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_q_u_e_s_o_1_1_m_l_sampling.html#aa45e9c06bd51cae0dc2294af1831c158">m_priorRv</a></td></tr>
<tr class="memdesc:aa45e9c06bd51cae0dc2294af1831c158"><td class="mdescLeft">&#160;</td><td class="mdescRight">Prior RV.  <a href="#aa45e9c06bd51cae0dc2294af1831c158">More...</a><br/></td></tr>
<tr class="separator:aa45e9c06bd51cae0dc2294af1831c158"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab08c3059d23460db49b229aa88bd4e70"><td class="memItemLeft" align="right" valign="top">const <a class="el" href="class_q_u_e_s_o_1_1_base_scalar_function.html">BaseScalarFunction</a>&lt; P_V, <br class="typebreak"/>
P_M &gt; &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_q_u_e_s_o_1_1_m_l_sampling.html#ab08c3059d23460db49b229aa88bd4e70">m_likelihoodFunction</a></td></tr>
<tr class="memdesc:ab08c3059d23460db49b229aa88bd4e70"><td class="mdescLeft">&#160;</td><td class="mdescRight">Likelihood function.  <a href="#ab08c3059d23460db49b229aa88bd4e70">More...</a><br/></td></tr>
<tr class="separator:ab08c3059d23460db49b229aa88bd4e70"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7bc4c72f65ba9166ed94a6e198b0915b"><td class="memItemLeft" align="right" valign="top">const <a class="el" href="class_q_u_e_s_o_1_1_vector_space.html">VectorSpace</a>&lt; P_V, P_M &gt; &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a7bc4c72f65ba9166ed94a6e198b0915b">m_vectorSpace</a></td></tr>
<tr class="memdesc:a7bc4c72f65ba9166ed94a6e198b0915b"><td class="mdescLeft">&#160;</td><td class="mdescRight"><a class="el" href="class_q_u_e_s_o_1_1_vector.html" title="Class for vector operations (virtual). ">Vector</a> space.  <a href="#a7bc4c72f65ba9166ed94a6e198b0915b">More...</a><br/></td></tr>
<tr class="separator:a7bc4c72f65ba9166ed94a6e198b0915b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a21525858e93a7d9654fdf68c8ac25576"><td class="memItemLeft" align="right" valign="top"><a class="el" href="class_q_u_e_s_o_1_1_vector_set.html">VectorSet</a>&lt; P_V, P_M &gt; *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a21525858e93a7d9654fdf68c8ac25576">m_targetDomain</a></td></tr>
<tr class="memdesc:a21525858e93a7d9654fdf68c8ac25576"><td class="mdescLeft">&#160;</td><td class="mdescRight">Domain of the target PDF: intersection of the domains of the prior PDf and likelihood function.  <a href="#a21525858e93a7d9654fdf68c8ac25576">More...</a><br/></td></tr>
<tr class="separator:a21525858e93a7d9654fdf68c8ac25576"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afbe27e6149562020663b72da6592d933"><td class="memItemLeft" align="right" valign="top">unsigned int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_q_u_e_s_o_1_1_m_l_sampling.html#afbe27e6149562020663b72da6592d933">m_numDisabledParameters</a></td></tr>
<tr class="separator:afbe27e6149562020663b72da6592d933"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac76690384f70d74b8662faf7a051449e"><td class="memItemLeft" align="right" valign="top">std::vector&lt; bool &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_q_u_e_s_o_1_1_m_l_sampling.html#ac76690384f70d74b8662faf7a051449e">m_parameterEnabledStatus</a></td></tr>
<tr class="separator:ac76690384f70d74b8662faf7a051449e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af8504cc57ec72b3c52833826b2bfff8e"><td class="memItemLeft" align="right" valign="top"><a class="el" href="class_q_u_e_s_o_1_1_m_l_sampling_options.html">MLSamplingOptions</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_q_u_e_s_o_1_1_m_l_sampling.html#af8504cc57ec72b3c52833826b2bfff8e">m_options</a></td></tr>
<tr class="memdesc:af8504cc57ec72b3c52833826b2bfff8e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Options for the ML algorithm.  <a href="#af8504cc57ec72b3c52833826b2bfff8e">More...</a><br/></td></tr>
<tr class="separator:af8504cc57ec72b3c52833826b2bfff8e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af9416874c856e50f3b35270e801f17e4"><td class="memItemLeft" align="right" valign="top">unsigned int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_q_u_e_s_o_1_1_m_l_sampling.html#af9416874c856e50f3b35270e801f17e4">m_currLevel</a></td></tr>
<tr class="memdesc:af9416874c856e50f3b35270e801f17e4"><td class="mdescLeft">&#160;</td><td class="mdescRight">Current level.  <a href="#af9416874c856e50f3b35270e801f17e4">More...</a><br/></td></tr>
<tr class="separator:af9416874c856e50f3b35270e801f17e4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1b1f8ccb4823bdfa26ec652f0807c63e"><td class="memItemLeft" align="right" valign="top">unsigned int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a1b1f8ccb4823bdfa26ec652f0807c63e">m_currStep</a></td></tr>
<tr class="memdesc:a1b1f8ccb4823bdfa26ec652f0807c63e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Curret step.  <a href="#a1b1f8ccb4823bdfa26ec652f0807c63e">More...</a><br/></td></tr>
<tr class="separator:a1b1f8ccb4823bdfa26ec652f0807c63e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abdd5cd35419283c33cc40a77d0f4f07f"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_q_u_e_s_o_1_1_m_l_sampling.html#abdd5cd35419283c33cc40a77d0f4f07f">m_debugExponent</a></td></tr>
<tr class="memdesc:abdd5cd35419283c33cc40a77d0f4f07f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Exponent for debugging.  <a href="#abdd5cd35419283c33cc40a77d0f4f07f">More...</a><br/></td></tr>
<tr class="separator:abdd5cd35419283c33cc40a77d0f4f07f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a75f2ceab4a2c6774b3fa07d74221dbf3"><td class="memItemLeft" align="right" valign="top">std::vector&lt; double &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a75f2ceab4a2c6774b3fa07d74221dbf3">m_logEvidenceFactors</a></td></tr>
<tr class="separator:a75f2ceab4a2c6774b3fa07d74221dbf3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afad63c42dccb1518319bf677f2bffde0"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_q_u_e_s_o_1_1_m_l_sampling.html#afad63c42dccb1518319bf677f2bffde0">m_logEvidence</a></td></tr>
<tr class="separator:afad63c42dccb1518319bf677f2bffde0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aec4229773274b58e3eaa49a77738389f"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_q_u_e_s_o_1_1_m_l_sampling.html#aec4229773274b58e3eaa49a77738389f">m_meanLogLikelihood</a></td></tr>
<tr class="separator:aec4229773274b58e3eaa49a77738389f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abec7f8cf9da08bc5c0a20d99fa4570af"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_q_u_e_s_o_1_1_m_l_sampling.html#abec7f8cf9da08bc5c0a20d99fa4570af">m_eig</a></td></tr>
<tr class="separator:abec7f8cf9da08bc5c0a20d99fa4570af"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="friends"></a>
Friends</h2></td></tr>
<tr class="memitem:a5a8aa9e185dfa1698ec94d6709895d2c"><td class="memItemLeft" align="right" valign="top">std::ostream &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a5a8aa9e185dfa1698ec94d6709895d2c">operator&lt;&lt;</a> (std::ostream &amp;os, const <a class="el" href="class_q_u_e_s_o_1_1_m_l_sampling.html">MLSampling</a>&lt; P_V, P_M &gt; &amp;obj)</td></tr>
<tr class="separator:a5a8aa9e185dfa1698ec94d6709895d2c"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><h3>template&lt;class P_V, class P_M&gt;<br/>
class QUESO::MLSampling&lt; P_V, P_M &gt;</h3>

<p>A templated class that represents a Multilevel generator of samples. </p>
<p>A templated class that represents a Multilevel sampler. Options reading is handled by class '<a class="el" href="class_q_u_e_s_o_1_1_m_l_sampling_options.html" title="This class provides options for the Multilevel sequence generator if no input file is available...">MLSamplingOptions</a>'. It implements the method: S. H. Cheung and E. E. Prudencio. Parallel adaptive multilevel sampling algorithms for the Bayesian analysis of mathematical models. International Journal for Uncertainty Quantification, 2(3):215237, 2012. </p>

<p>Definition at line <a class="el" href="_m_l_sampling_8h_source.html#l00118">118</a> of file <a class="el" href="_m_l_sampling_8h_source.html">MLSampling.h</a>.</p>
</div><h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a class="anchor" id="a7738e481975c7ca2a47fa763bb92bdbe"></a>
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;class P_V , class P_M &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="class_q_u_e_s_o_1_1_m_l_sampling.html">QUESO::MLSampling</a>&lt; P_V, P_M &gt;::<a class="el" href="class_q_u_e_s_o_1_1_m_l_sampling.html">MLSampling</a> </td>
          <td>(</td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>prefix</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="class_q_u_e_s_o_1_1_base_vector_r_v.html">BaseVectorRV</a>&lt; P_V, P_M &gt; &amp;&#160;</td>
          <td class="paramname"><em>priorRv</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="class_q_u_e_s_o_1_1_base_scalar_function.html">BaseScalarFunction</a>&lt; P_V, P_M &gt; &amp;&#160;</td>
          <td class="paramname"><em>likelihoodFunction</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Constructor. </p>
<p>Constructor: instantiates an object of the class given a prefix, the prior RV and the likelihood function. Internally, this method set the domain of the target PDF to be the intersection of the domains of the prior PDF and of the likelihood function. Also the current level and exponent of the Multilevel method are set to zero. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">prefix</td><td>Prefix </td></tr>
    <tr><td class="paramname">priorRv</td><td>The prior rv </td></tr>
    <tr><td class="paramname">likelihoodFunction</td><td>The likelihood function </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="_m_l_sampling_8_c_source.html#l04033">4033</a> of file <a class="el" href="_m_l_sampling_8_c_source.html">MLSampling.C</a>.</p>

<p>References <a class="el" href="_m_l_sampling_8h_source.html#l00442">QUESO::MLSampling&lt; P_V, P_M &gt;::m_env</a>, <a class="el" href="_m_l_sampling_8h_source.html#l00461">QUESO::MLSampling&lt; P_V, P_M &gt;::m_options</a>, <a class="el" href="_m_l_sampling_options_8_c_source.html#l00071">QUESO::MLSamplingOptions::scanOptionsValues()</a>, and <a class="el" href="_environment_8_c_source.html#l00305">QUESO::BaseEnvironment::subDisplayFile()</a>.</p>
<div class="fragment"><div class="line"><a name="l04037"></a><span class="lineno"> 4037</span>&#160;  :</div>
<div class="line"><a name="l04038"></a><span class="lineno"> 4038</span>&#160;  <a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>               (priorRv.<a class="code" href="class_q_u_e_s_o_1_1_base_vector_r_v.html#ad5bf8486b3bacb46b9d4ecba513fd37b">env</a>()),</div>
<div class="line"><a name="l04039"></a><span class="lineno"> 4039</span>&#160;  <a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#aa45e9c06bd51cae0dc2294af1831c158">m_priorRv</a>           (priorRv),</div>
<div class="line"><a name="l04040"></a><span class="lineno"> 4040</span>&#160;  <a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#ab08c3059d23460db49b229aa88bd4e70">m_likelihoodFunction</a>(likelihoodFunction),</div>
<div class="line"><a name="l04041"></a><span class="lineno"> 4041</span>&#160;  <a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a7bc4c72f65ba9166ed94a6e198b0915b">m_vectorSpace</a>       (<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#aa45e9c06bd51cae0dc2294af1831c158">m_priorRv</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_vector_r_v.html#aa4dd2f036228eac1f945bacc7147a922">imageSet</a>().<a class="code" href="class_q_u_e_s_o_1_1_vector_set.html#a923421590baf5bf93cf066e528f927dc">vectorSpace</a>()),</div>
<div class="line"><a name="l04042"></a><span class="lineno"> 4042</span>&#160;  <a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a21525858e93a7d9654fdf68c8ac25576">m_targetDomain</a>      (<a class="code" href="namespace_q_u_e_s_o.html#aa79046437ab085c5487ae16e9a0baeec">InstantiateIntersection</a>(<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#aa45e9c06bd51cae0dc2294af1831c158">m_priorRv</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_vector_r_v.html#a3206740e05e0c64a88273029e963b185">pdf</a>().<a class="code" href="class_q_u_e_s_o_1_1_base_scalar_function.html#ad0937628825249dd36ded3ce0c7959ac">domainSet</a>(),<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#ab08c3059d23460db49b229aa88bd4e70">m_likelihoodFunction</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_scalar_function.html#ad0937628825249dd36ded3ce0c7959ac">domainSet</a>())),</div>
<div class="line"><a name="l04043"></a><span class="lineno"> 4043</span>&#160;  <a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#afbe27e6149562020663b72da6592d933">m_numDisabledParameters</a> (0), <span class="comment">// gpmsa2</span></div>
<div class="line"><a name="l04044"></a><span class="lineno"> 4044</span>&#160;  <a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#ac76690384f70d74b8662faf7a051449e">m_parameterEnabledStatus</a>(<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a7bc4c72f65ba9166ed94a6e198b0915b">m_vectorSpace</a>.<a class="code" href="class_q_u_e_s_o_1_1_vector_space.html#a5829a1f4f996f8307c840b705144d666">dimLocal</a>(),<span class="keyword">true</span>), <span class="comment">// gpmsa2</span></div>
<div class="line"><a name="l04045"></a><span class="lineno"> 4045</span>&#160;  <a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#af8504cc57ec72b3c52833826b2bfff8e">m_options</a>           (<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>,prefix),</div>
<div class="line"><a name="l04046"></a><span class="lineno"> 4046</span>&#160;  <a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#af9416874c856e50f3b35270e801f17e4">m_currLevel</a>         (0),</div>
<div class="line"><a name="l04047"></a><span class="lineno"> 4047</span>&#160;  <a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a1b1f8ccb4823bdfa26ec652f0807c63e">m_currStep</a>          (0),</div>
<div class="line"><a name="l04048"></a><span class="lineno"> 4048</span>&#160;  <a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#abdd5cd35419283c33cc40a77d0f4f07f">m_debugExponent</a>     (0.),</div>
<div class="line"><a name="l04049"></a><span class="lineno"> 4049</span>&#160;  <a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a75f2ceab4a2c6774b3fa07d74221dbf3">m_logEvidenceFactors</a>(0),</div>
<div class="line"><a name="l04050"></a><span class="lineno"> 4050</span>&#160;  <a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#afad63c42dccb1518319bf677f2bffde0">m_logEvidence</a>       (0.),</div>
<div class="line"><a name="l04051"></a><span class="lineno"> 4051</span>&#160;  <a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#aec4229773274b58e3eaa49a77738389f">m_meanLogLikelihood</a> (0.),</div>
<div class="line"><a name="l04052"></a><span class="lineno"> 4052</span>&#160;  <a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#abec7f8cf9da08bc5c0a20d99fa4570af">m_eig</a>               (0.)</div>
<div class="line"><a name="l04053"></a><span class="lineno"> 4053</span>&#160;{</div>
<div class="line"><a name="l04054"></a><span class="lineno"> 4054</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#a8a0064746ae8dddfece4229b9ad374d6">subDisplayFile</a>()) {</div>
<div class="line"><a name="l04055"></a><span class="lineno"> 4055</span>&#160;    *<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#a8a0064746ae8dddfece4229b9ad374d6">subDisplayFile</a>() &lt;&lt; <span class="stringliteral">&quot;Entering MLSampling&lt;P_V,P_M&gt;::constructor()&quot;</span></div>
<div class="line"><a name="l04056"></a><span class="lineno"> 4056</span>&#160;                            &lt;&lt; std::endl;</div>
<div class="line"><a name="l04057"></a><span class="lineno"> 4057</span>&#160;  }</div>
<div class="line"><a name="l04058"></a><span class="lineno"> 4058</span>&#160;</div>
<div class="line"><a name="l04059"></a><span class="lineno"> 4059</span>&#160;  <a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#af8504cc57ec72b3c52833826b2bfff8e">m_options</a>.<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling_options.html#ac30d28bbd4eea520fbbcfa5641dc62e1">scanOptionsValues</a>();</div>
<div class="line"><a name="l04060"></a><span class="lineno"> 4060</span>&#160;</div>
<div class="line"><a name="l04061"></a><span class="lineno"> 4061</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#a8a0064746ae8dddfece4229b9ad374d6">subDisplayFile</a>()) {</div>
<div class="line"><a name="l04062"></a><span class="lineno"> 4062</span>&#160;    *<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#a8a0064746ae8dddfece4229b9ad374d6">subDisplayFile</a>() &lt;&lt; <span class="stringliteral">&quot;Leaving MLSampling&lt;P_V,P_M&gt;::constructor()&quot;</span></div>
<div class="line"><a name="l04063"></a><span class="lineno"> 4063</span>&#160;                            &lt;&lt; std::endl;</div>
<div class="line"><a name="l04064"></a><span class="lineno"> 4064</span>&#160;  }</div>
<div class="line"><a name="l04065"></a><span class="lineno"> 4065</span>&#160;}</div>
<div class="ttc" id="class_q_u_e_s_o_1_1_m_l_sampling_html_abec7f8cf9da08bc5c0a20d99fa4570af"><div class="ttname"><a href="class_q_u_e_s_o_1_1_m_l_sampling.html#abec7f8cf9da08bc5c0a20d99fa4570af">QUESO::MLSampling::m_eig</a></div><div class="ttdeci">double m_eig</div><div class="ttdef"><b>Definition:</b> <a href="_m_l_sampling_8h_source.html#l00474">MLSampling.h:474</a></div></div>
<div class="ttc" id="class_q_u_e_s_o_1_1_m_l_sampling_html_a13f1ca4fe9f94822fe572a743eaced1d"><div class="ttname"><a href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">QUESO::MLSampling::m_env</a></div><div class="ttdeci">const BaseEnvironment &amp; m_env</div><div class="ttdoc">Queso enviroment. </div><div class="ttdef"><b>Definition:</b> <a href="_m_l_sampling_8h_source.html#l00442">MLSampling.h:442</a></div></div>
<div class="ttc" id="class_q_u_e_s_o_1_1_vector_space_html_a5829a1f4f996f8307c840b705144d666"><div class="ttname"><a href="class_q_u_e_s_o_1_1_vector_space.html#a5829a1f4f996f8307c840b705144d666">QUESO::VectorSpace::dimLocal</a></div><div class="ttdeci">unsigned int dimLocal() const </div><div class="ttdef"><b>Definition:</b> <a href="_vector_space_8_c_source.html#l00199">VectorSpace.C:199</a></div></div>
<div class="ttc" id="class_q_u_e_s_o_1_1_m_l_sampling_html_abdd5cd35419283c33cc40a77d0f4f07f"><div class="ttname"><a href="class_q_u_e_s_o_1_1_m_l_sampling.html#abdd5cd35419283c33cc40a77d0f4f07f">QUESO::MLSampling::m_debugExponent</a></div><div class="ttdeci">double m_debugExponent</div><div class="ttdoc">Exponent for debugging. </div><div class="ttdef"><b>Definition:</b> <a href="_m_l_sampling_8h_source.html#l00470">MLSampling.h:470</a></div></div>
<div class="ttc" id="class_q_u_e_s_o_1_1_base_vector_r_v_html_a3206740e05e0c64a88273029e963b185"><div class="ttname"><a href="class_q_u_e_s_o_1_1_base_vector_r_v.html#a3206740e05e0c64a88273029e963b185">QUESO::BaseVectorRV::pdf</a></div><div class="ttdeci">const BaseJointPdf&lt; V, M &gt; &amp; pdf() const </div><div class="ttdoc">Posterior Density Function of the vector RV; access to private attribute m_pdf. </div><div class="ttdef"><b>Definition:</b> <a href="_vector_r_v_8_c_source.html#l00086">VectorRV.C:86</a></div></div>
<div class="ttc" id="class_q_u_e_s_o_1_1_m_l_sampling_html_a21525858e93a7d9654fdf68c8ac25576"><div class="ttname"><a href="class_q_u_e_s_o_1_1_m_l_sampling.html#a21525858e93a7d9654fdf68c8ac25576">QUESO::MLSampling::m_targetDomain</a></div><div class="ttdeci">VectorSet&lt; P_V, P_M &gt; * m_targetDomain</div><div class="ttdoc">Domain of the target PDF: intersection of the domains of the prior PDf and likelihood function...</div><div class="ttdef"><b>Definition:</b> <a href="_m_l_sampling_8h_source.html#l00454">MLSampling.h:454</a></div></div>
<div class="ttc" id="class_q_u_e_s_o_1_1_m_l_sampling_html_afbe27e6149562020663b72da6592d933"><div class="ttname"><a href="class_q_u_e_s_o_1_1_m_l_sampling.html#afbe27e6149562020663b72da6592d933">QUESO::MLSampling::m_numDisabledParameters</a></div><div class="ttdeci">unsigned int m_numDisabledParameters</div><div class="ttdef"><b>Definition:</b> <a href="_m_l_sampling_8h_source.html#l00456">MLSampling.h:456</a></div></div>
<div class="ttc" id="class_q_u_e_s_o_1_1_m_l_sampling_html_a75f2ceab4a2c6774b3fa07d74221dbf3"><div class="ttname"><a href="class_q_u_e_s_o_1_1_m_l_sampling.html#a75f2ceab4a2c6774b3fa07d74221dbf3">QUESO::MLSampling::m_logEvidenceFactors</a></div><div class="ttdeci">std::vector&lt; double &gt; m_logEvidenceFactors</div><div class="ttdef"><b>Definition:</b> <a href="_m_l_sampling_8h_source.html#l00471">MLSampling.h:471</a></div></div>
<div class="ttc" id="class_q_u_e_s_o_1_1_m_l_sampling_html_af8504cc57ec72b3c52833826b2bfff8e"><div class="ttname"><a href="class_q_u_e_s_o_1_1_m_l_sampling.html#af8504cc57ec72b3c52833826b2bfff8e">QUESO::MLSampling::m_options</a></div><div class="ttdeci">MLSamplingOptions m_options</div><div class="ttdoc">Options for the ML algorithm. </div><div class="ttdef"><b>Definition:</b> <a href="_m_l_sampling_8h_source.html#l00461">MLSampling.h:461</a></div></div>
<div class="ttc" id="class_q_u_e_s_o_1_1_m_l_sampling_html_ab08c3059d23460db49b229aa88bd4e70"><div class="ttname"><a href="class_q_u_e_s_o_1_1_m_l_sampling.html#ab08c3059d23460db49b229aa88bd4e70">QUESO::MLSampling::m_likelihoodFunction</a></div><div class="ttdeci">const BaseScalarFunction&lt; P_V, P_M &gt; &amp; m_likelihoodFunction</div><div class="ttdoc">Likelihood function. </div><div class="ttdef"><b>Definition:</b> <a href="_m_l_sampling_8h_source.html#l00448">MLSampling.h:448</a></div></div>
<div class="ttc" id="class_q_u_e_s_o_1_1_m_l_sampling_html_aec4229773274b58e3eaa49a77738389f"><div class="ttname"><a href="class_q_u_e_s_o_1_1_m_l_sampling.html#aec4229773274b58e3eaa49a77738389f">QUESO::MLSampling::m_meanLogLikelihood</a></div><div class="ttdeci">double m_meanLogLikelihood</div><div class="ttdef"><b>Definition:</b> <a href="_m_l_sampling_8h_source.html#l00473">MLSampling.h:473</a></div></div>
<div class="ttc" id="class_q_u_e_s_o_1_1_m_l_sampling_html_ac76690384f70d74b8662faf7a051449e"><div class="ttname"><a href="class_q_u_e_s_o_1_1_m_l_sampling.html#ac76690384f70d74b8662faf7a051449e">QUESO::MLSampling::m_parameterEnabledStatus</a></div><div class="ttdeci">std::vector&lt; bool &gt; m_parameterEnabledStatus</div><div class="ttdef"><b>Definition:</b> <a href="_m_l_sampling_8h_source.html#l00458">MLSampling.h:458</a></div></div>
<div class="ttc" id="class_q_u_e_s_o_1_1_base_scalar_function_html_ad0937628825249dd36ded3ce0c7959ac"><div class="ttname"><a href="class_q_u_e_s_o_1_1_base_scalar_function.html#ad0937628825249dd36ded3ce0c7959ac">QUESO::BaseScalarFunction::domainSet</a></div><div class="ttdeci">const VectorSet&lt; V, M &gt; &amp; domainSet() const </div><div class="ttdoc">Access to the protected attribute m_domainSet: domain set of the scalar function. ...</div><div class="ttdef"><b>Definition:</b> <a href="_scalar_function_8_c_source.html#l00050">ScalarFunction.C:50</a></div></div>
<div class="ttc" id="class_q_u_e_s_o_1_1_m_l_sampling_html_aa45e9c06bd51cae0dc2294af1831c158"><div class="ttname"><a href="class_q_u_e_s_o_1_1_m_l_sampling.html#aa45e9c06bd51cae0dc2294af1831c158">QUESO::MLSampling::m_priorRv</a></div><div class="ttdeci">const BaseVectorRV&lt; P_V, P_M &gt; &amp; m_priorRv</div><div class="ttdoc">Prior RV. </div><div class="ttdef"><b>Definition:</b> <a href="_m_l_sampling_8h_source.html#l00445">MLSampling.h:445</a></div></div>
<div class="ttc" id="class_q_u_e_s_o_1_1_m_l_sampling_html_af9416874c856e50f3b35270e801f17e4"><div class="ttname"><a href="class_q_u_e_s_o_1_1_m_l_sampling.html#af9416874c856e50f3b35270e801f17e4">QUESO::MLSampling::m_currLevel</a></div><div class="ttdeci">unsigned int m_currLevel</div><div class="ttdoc">Current level. </div><div class="ttdef"><b>Definition:</b> <a href="_m_l_sampling_8h_source.html#l00464">MLSampling.h:464</a></div></div>
<div class="ttc" id="class_q_u_e_s_o_1_1_m_l_sampling_options_html_ac30d28bbd4eea520fbbcfa5641dc62e1"><div class="ttname"><a href="class_q_u_e_s_o_1_1_m_l_sampling_options.html#ac30d28bbd4eea520fbbcfa5641dc62e1">QUESO::MLSamplingOptions::scanOptionsValues</a></div><div class="ttdeci">void scanOptionsValues()</div><div class="ttdoc">It scans the option values from the options input file. </div><div class="ttdef"><b>Definition:</b> <a href="_m_l_sampling_options_8_c_source.html#l00071">MLSamplingOptions.C:71</a></div></div>
<div class="ttc" id="class_q_u_e_s_o_1_1_base_vector_r_v_html_ad5bf8486b3bacb46b9d4ecba513fd37b"><div class="ttname"><a href="class_q_u_e_s_o_1_1_base_vector_r_v.html#ad5bf8486b3bacb46b9d4ecba513fd37b">QUESO::BaseVectorRV::env</a></div><div class="ttdeci">const BaseEnvironment &amp; env() const </div><div class="ttdoc">QUESO environment; access to private attribute m_env. </div><div class="ttdef"><b>Definition:</b> <a href="_vector_r_v_8_c_source.html#l00072">VectorRV.C:72</a></div></div>
<div class="ttc" id="class_q_u_e_s_o_1_1_m_l_sampling_html_a7bc4c72f65ba9166ed94a6e198b0915b"><div class="ttname"><a href="class_q_u_e_s_o_1_1_m_l_sampling.html#a7bc4c72f65ba9166ed94a6e198b0915b">QUESO::MLSampling::m_vectorSpace</a></div><div class="ttdeci">const VectorSpace&lt; P_V, P_M &gt; &amp; m_vectorSpace</div><div class="ttdoc">Vector space. </div><div class="ttdef"><b>Definition:</b> <a href="_m_l_sampling_8h_source.html#l00451">MLSampling.h:451</a></div></div>
<div class="ttc" id="namespace_q_u_e_s_o_html_aa79046437ab085c5487ae16e9a0baeec"><div class="ttname"><a href="namespace_q_u_e_s_o.html#aa79046437ab085c5487ae16e9a0baeec">QUESO::InstantiateIntersection</a></div><div class="ttdeci">VectorSet&lt; V, M &gt; * InstantiateIntersection(const VectorSet&lt; V, M &gt; &amp;domain1, const VectorSet&lt; V, M &gt; &amp;domain2)</div><div class="ttdoc">This method calculates the intersection of domain1 and domain2. </div><div class="ttdef"><b>Definition:</b> <a href="_instantiate_intersection_8_c_source.html#l00037">InstantiateIntersection.C:37</a></div></div>
<div class="ttc" id="class_q_u_e_s_o_1_1_m_l_sampling_html_a1b1f8ccb4823bdfa26ec652f0807c63e"><div class="ttname"><a href="class_q_u_e_s_o_1_1_m_l_sampling.html#a1b1f8ccb4823bdfa26ec652f0807c63e">QUESO::MLSampling::m_currStep</a></div><div class="ttdeci">unsigned int m_currStep</div><div class="ttdoc">Curret step. </div><div class="ttdef"><b>Definition:</b> <a href="_m_l_sampling_8h_source.html#l00467">MLSampling.h:467</a></div></div>
<div class="ttc" id="class_q_u_e_s_o_1_1_base_environment_html_a8a0064746ae8dddfece4229b9ad374d6"><div class="ttname"><a href="class_q_u_e_s_o_1_1_base_environment.html#a8a0064746ae8dddfece4229b9ad374d6">QUESO::BaseEnvironment::subDisplayFile</a></div><div class="ttdeci">std::ofstream * subDisplayFile() const </div><div class="ttdoc">Access function for m_subDisplayFile (displays file on stream). </div><div class="ttdef"><b>Definition:</b> <a href="_environment_8_c_source.html#l00305">Environment.C:305</a></div></div>
<div class="ttc" id="class_q_u_e_s_o_1_1_base_vector_r_v_html_aa4dd2f036228eac1f945bacc7147a922"><div class="ttname"><a href="class_q_u_e_s_o_1_1_base_vector_r_v.html#aa4dd2f036228eac1f945bacc7147a922">QUESO::BaseVectorRV::imageSet</a></div><div class="ttdeci">const VectorSet&lt; V, M &gt; &amp; imageSet() const </div><div class="ttdoc">Image set of the vector RV; access to private attribute m_imageSet. </div><div class="ttdef"><b>Definition:</b> <a href="_vector_r_v_8_c_source.html#l00079">VectorRV.C:79</a></div></div>
<div class="ttc" id="class_q_u_e_s_o_1_1_m_l_sampling_html_afad63c42dccb1518319bf677f2bffde0"><div class="ttname"><a href="class_q_u_e_s_o_1_1_m_l_sampling.html#afad63c42dccb1518319bf677f2bffde0">QUESO::MLSampling::m_logEvidence</a></div><div class="ttdeci">double m_logEvidence</div><div class="ttdef"><b>Definition:</b> <a href="_m_l_sampling_8h_source.html#l00472">MLSampling.h:472</a></div></div>
<div class="ttc" id="class_q_u_e_s_o_1_1_vector_set_html_a923421590baf5bf93cf066e528f927dc"><div class="ttname"><a href="class_q_u_e_s_o_1_1_vector_set.html#a923421590baf5bf93cf066e528f927dc">QUESO::VectorSet::vectorSpace</a></div><div class="ttdeci">virtual const VectorSpace&lt; V, M &gt; &amp; vectorSpace() const =0</div><div class="ttdoc">Vector space to which this set belongs to. See template specialization. </div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ad3f442d1cac363497d04a4c8f8cf76c3"></a>
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;class P_V , class P_M &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="class_q_u_e_s_o_1_1_m_l_sampling.html">QUESO::MLSampling</a>&lt; P_V, P_M &gt;::~<a class="el" href="class_q_u_e_s_o_1_1_m_l_sampling.html">MLSampling</a> </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Destructor. </p>

<p>Definition at line <a class="el" href="_m_l_sampling_8_c_source.html#l04068">4068</a> of file <a class="el" href="_m_l_sampling_8_c_source.html">MLSampling.C</a>.</p>
<div class="fragment"><div class="line"><a name="l04069"></a><span class="lineno"> 4069</span>&#160;{</div>
<div class="line"><a name="l04070"></a><span class="lineno"> 4070</span>&#160;  <a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#afbe27e6149562020663b72da6592d933">m_numDisabledParameters</a> = 0; <span class="comment">// gpmsa2</span></div>
<div class="line"><a name="l04071"></a><span class="lineno"> 4071</span>&#160;  <a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#ac76690384f70d74b8662faf7a051449e">m_parameterEnabledStatus</a>.clear(); <span class="comment">// gpmsa2</span></div>
<div class="line"><a name="l04072"></a><span class="lineno"> 4072</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a21525858e93a7d9654fdf68c8ac25576">m_targetDomain</a>) <span class="keyword">delete</span> <a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a21525858e93a7d9654fdf68c8ac25576">m_targetDomain</a>;</div>
<div class="line"><a name="l04073"></a><span class="lineno"> 4073</span>&#160;}</div>
<div class="ttc" id="class_q_u_e_s_o_1_1_m_l_sampling_html_a21525858e93a7d9654fdf68c8ac25576"><div class="ttname"><a href="class_q_u_e_s_o_1_1_m_l_sampling.html#a21525858e93a7d9654fdf68c8ac25576">QUESO::MLSampling::m_targetDomain</a></div><div class="ttdeci">VectorSet&lt; P_V, P_M &gt; * m_targetDomain</div><div class="ttdoc">Domain of the target PDF: intersection of the domains of the prior PDf and likelihood function...</div><div class="ttdef"><b>Definition:</b> <a href="_m_l_sampling_8h_source.html#l00454">MLSampling.h:454</a></div></div>
<div class="ttc" id="class_q_u_e_s_o_1_1_m_l_sampling_html_afbe27e6149562020663b72da6592d933"><div class="ttname"><a href="class_q_u_e_s_o_1_1_m_l_sampling.html#afbe27e6149562020663b72da6592d933">QUESO::MLSampling::m_numDisabledParameters</a></div><div class="ttdeci">unsigned int m_numDisabledParameters</div><div class="ttdef"><b>Definition:</b> <a href="_m_l_sampling_8h_source.html#l00456">MLSampling.h:456</a></div></div>
<div class="ttc" id="class_q_u_e_s_o_1_1_m_l_sampling_html_ac76690384f70d74b8662faf7a051449e"><div class="ttname"><a href="class_q_u_e_s_o_1_1_m_l_sampling.html#ac76690384f70d74b8662faf7a051449e">QUESO::MLSampling::m_parameterEnabledStatus</a></div><div class="ttdeci">std::vector&lt; bool &gt; m_parameterEnabledStatus</div><div class="ttdef"><b>Definition:</b> <a href="_m_l_sampling_8h_source.html#l00458">MLSampling.h:458</a></div></div>
</div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a class="anchor" id="aa8e7bb1bd54ccafb9b276127a76eba71"></a>
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;class P_V , class P_M &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="class_q_u_e_s_o_1_1_m_l_sampling.html">QUESO::MLSampling</a>&lt; P_V, P_M &gt;::checkpointML </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>currExponent</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>currEta</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="class_q_u_e_s_o_1_1_sequence_of_vectors.html">SequenceOfVectors</a>&lt; P_V, P_M &gt; &amp;&#160;</td>
          <td class="paramname"><em>currChain</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="class_q_u_e_s_o_1_1_scalar_sequence.html">ScalarSequence</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>currLogLikelihoodValues</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="class_q_u_e_s_o_1_1_scalar_sequence.html">ScalarSequence</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>currLogTargetValues</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Writes checkpoint data for the ML method. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">currExponent,currEta,currChain,currLogLikelihoodValues,currLogTargetValues.</td><td></td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="_m_l_sampling_8_c_source.html#l02033">2033</a> of file <a class="el" href="_m_l_sampling_8_c_source.html">MLSampling.C</a>.</p>

<p>References <a class="el" href="_m_l_sampling_level_options_8h_source.html#l00028">LEVEL_REF_ID</a>, <a class="el" href="_vector_sequence_8_c_source.html#l00070">QUESO::BaseVectorSequence&lt; V, M &gt;::unifiedSequenceSize()</a>, <a class="el" href="_scalar_sequence_8_c_source.html#l00148">QUESO::ScalarSequence&lt; T &gt;::unifiedSequenceSize()</a>, <a class="el" href="_sequence_of_vectors_8_c_source.html#l01485">QUESO::SequenceOfVectors&lt; V, M &gt;::unifiedWriteContents()</a>, <a class="el" href="_scalar_sequence_8_c_source.html#l02799">QUESO::ScalarSequence&lt; T &gt;::unifiedWriteContents()</a>, and <a class="el" href="_defines_8h_source.html#l00222">UQ_FATAL_TEST_MACRO</a>.</p>
<div class="fragment"><div class="line"><a name="l02039"></a><span class="lineno"> 2039</span>&#160;{</div>
<div class="line"><a name="l02040"></a><span class="lineno"> 2040</span>&#160;  <span class="keywordflow">if</span> ((<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#a8a0064746ae8dddfece4229b9ad374d6">subDisplayFile</a>()) &amp;&amp; (<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#a1fe5f244fc0316a0ab3e37463f108b96">displayVerbosity</a>() &gt;= 2)) {</div>
<div class="line"><a name="l02041"></a><span class="lineno"> 2041</span>&#160;    *<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#a8a0064746ae8dddfece4229b9ad374d6">subDisplayFile</a>() &lt;&lt; <span class="stringliteral">&quot;\n CHECKPOINTING initiating at level &quot;</span> &lt;&lt; <a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#af9416874c856e50f3b35270e801f17e4">m_currLevel</a></div>
<div class="line"><a name="l02042"></a><span class="lineno"> 2042</span>&#160;                            &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l02043"></a><span class="lineno"> 2043</span>&#160;  }</div>
<div class="line"><a name="l02044"></a><span class="lineno"> 2044</span>&#160;</div>
<div class="line"><a name="l02045"></a><span class="lineno"> 2045</span>&#160;  <span class="comment">//******************************************************************************</span></div>
<div class="line"><a name="l02046"></a><span class="lineno"> 2046</span>&#160;  <span class="comment">// Write &#39;control&#39; file without &#39;level&#39; spefication in name</span></div>
<div class="line"><a name="l02047"></a><span class="lineno"> 2047</span>&#160;  <span class="comment">//******************************************************************************</span></div>
<div class="line"><a name="l02048"></a><span class="lineno"> 2048</span>&#160;  <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> quantity1 = currChain.unifiedSequenceSize();</div>
<div class="line"><a name="l02049"></a><span class="lineno"> 2049</span>&#160;  <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> quantity2 = currLogLikelihoodValues.<a class="code" href="class_q_u_e_s_o_1_1_scalar_sequence.html#a52829afc95e5c36e9db44f40854153b0">unifiedSequenceSize</a>(<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a7bc4c72f65ba9166ed94a6e198b0915b">m_vectorSpace</a>.<a class="code" href="class_q_u_e_s_o_1_1_vector_space.html#a67b0c3620662116f5a346fdaa5faf38e">numOfProcsForStorage</a>() == 1);</div>
<div class="line"><a name="l02050"></a><span class="lineno"> 2050</span>&#160;  <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> quantity3 = currLogTargetValues.<a class="code" href="class_q_u_e_s_o_1_1_scalar_sequence.html#a52829afc95e5c36e9db44f40854153b0">unifiedSequenceSize</a>(<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a7bc4c72f65ba9166ed94a6e198b0915b">m_vectorSpace</a>.<a class="code" href="class_q_u_e_s_o_1_1_vector_space.html#a67b0c3620662116f5a346fdaa5faf38e">numOfProcsForStorage</a>() == 1);</div>
<div class="line"><a name="l02051"></a><span class="lineno"> 2051</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#ae106b5bb8a80b655b88b3a26b1e7c185">inter0Rank</a>() &gt;= 0) {</div>
<div class="line"><a name="l02052"></a><span class="lineno"> 2052</span>&#160;    <a class="code" href="_defines_8h.html#a56d63d18d0a6d45757de47fcc06f574d">UQ_FATAL_TEST_MACRO</a>(<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a75f2ceab4a2c6774b3fa07d74221dbf3">m_logEvidenceFactors</a>.size() != <a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#af9416874c856e50f3b35270e801f17e4">m_currLevel</a>,</div>
<div class="line"><a name="l02053"></a><span class="lineno"> 2053</span>&#160;                        <a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#a84a239e42ae443cf71db6e03e8159620">fullRank</a>(),</div>
<div class="line"><a name="l02054"></a><span class="lineno"> 2054</span>&#160;                        <span class="stringliteral">&quot;MLSampling&lt;P_V,P_M&gt;::checkpointML()&quot;</span>,</div>
<div class="line"><a name="l02055"></a><span class="lineno"> 2055</span>&#160;                        <span class="stringliteral">&quot;number of evidence factors is not consistent&quot;</span>);</div>
<div class="line"><a name="l02056"></a><span class="lineno"> 2056</span>&#160;    <a class="code" href="_defines_8h.html#a56d63d18d0a6d45757de47fcc06f574d">UQ_FATAL_TEST_MACRO</a>(quantity1 != quantity2,</div>
<div class="line"><a name="l02057"></a><span class="lineno"> 2057</span>&#160;                        <a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#a84a239e42ae443cf71db6e03e8159620">fullRank</a>(),</div>
<div class="line"><a name="l02058"></a><span class="lineno"> 2058</span>&#160;                        <span class="stringliteral">&quot;MLSampling&lt;P_V,P_M&gt;::checkpointML()&quot;</span>,</div>
<div class="line"><a name="l02059"></a><span class="lineno"> 2059</span>&#160;                        <span class="stringliteral">&quot;quantity2 is not consistent&quot;</span>);</div>
<div class="line"><a name="l02060"></a><span class="lineno"> 2060</span>&#160;    <a class="code" href="_defines_8h.html#a56d63d18d0a6d45757de47fcc06f574d">UQ_FATAL_TEST_MACRO</a>(quantity1 != quantity3,</div>
<div class="line"><a name="l02061"></a><span class="lineno"> 2061</span>&#160;                        <a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#a84a239e42ae443cf71db6e03e8159620">fullRank</a>(),</div>
<div class="line"><a name="l02062"></a><span class="lineno"> 2062</span>&#160;                        <span class="stringliteral">&quot;MLSampling&lt;P_V,P_M&gt;::checkpointML()&quot;</span>,</div>
<div class="line"><a name="l02063"></a><span class="lineno"> 2063</span>&#160;                        <span class="stringliteral">&quot;quantity3 is not consistent&quot;</span>);</div>
<div class="line"><a name="l02064"></a><span class="lineno"> 2064</span>&#160;  }</div>
<div class="line"><a name="l02065"></a><span class="lineno"> 2065</span>&#160;</div>
<div class="line"><a name="l02066"></a><span class="lineno"> 2066</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#a84a239e42ae443cf71db6e03e8159620">fullRank</a>() == 0) {</div>
<div class="line"><a name="l02067"></a><span class="lineno"> 2067</span>&#160;    std::ofstream* ofsVar = <span class="keyword">new</span> std::ofstream((<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#af8504cc57ec72b3c52833826b2bfff8e">m_options</a>.m_restartOutput_baseNameForFiles + <span class="stringliteral">&quot;Control.txt&quot;</span>).c_str(),</div>
<div class="line"><a name="l02068"></a><span class="lineno"> 2068</span>&#160;                                              std::ofstream::out | std::ofstream::trunc);</div>
<div class="line"><a name="l02069"></a><span class="lineno"> 2069</span>&#160;    *ofsVar &lt;&lt; <a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#af9416874c856e50f3b35270e801f17e4">m_currLevel</a>               &lt;&lt; std::endl  <span class="comment">// 1</span></div>
<div class="line"><a name="l02070"></a><span class="lineno"> 2070</span>&#160;            &lt;&lt; <a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a7bc4c72f65ba9166ed94a6e198b0915b">m_vectorSpace</a>.<a class="code" href="class_q_u_e_s_o_1_1_vector_space.html#acd4359dc120905c22ca1064e33787239">dimGlobal</a>() &lt;&lt; std::endl  <span class="comment">// 2</span></div>
<div class="line"><a name="l02071"></a><span class="lineno"> 2071</span>&#160;            &lt;&lt; currExponent              &lt;&lt; std::endl  <span class="comment">// 3</span></div>
<div class="line"><a name="l02072"></a><span class="lineno"> 2072</span>&#160;            &lt;&lt; currEta                   &lt;&lt; std::endl  <span class="comment">// 4</span></div>
<div class="line"><a name="l02073"></a><span class="lineno"> 2073</span>&#160;            &lt;&lt; quantity1                 &lt;&lt; std::endl; <span class="comment">// 5</span></div>
<div class="line"><a name="l02074"></a><span class="lineno"> 2074</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> savedPrecision = ofsVar-&gt;precision();</div>
<div class="line"><a name="l02075"></a><span class="lineno"> 2075</span>&#160;    ofsVar-&gt;precision(16);</div>
<div class="line"><a name="l02076"></a><span class="lineno"> 2076</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a75f2ceab4a2c6774b3fa07d74221dbf3">m_logEvidenceFactors</a>.size(); ++i) {</div>
<div class="line"><a name="l02077"></a><span class="lineno"> 2077</span>&#160;      *ofsVar &lt;&lt; <a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a75f2ceab4a2c6774b3fa07d74221dbf3">m_logEvidenceFactors</a>[i] &lt;&lt; std::endl;</div>
<div class="line"><a name="l02078"></a><span class="lineno"> 2078</span>&#160;    }</div>
<div class="line"><a name="l02079"></a><span class="lineno"> 2079</span>&#160;    ofsVar-&gt;precision(savedPrecision);</div>
<div class="line"><a name="l02080"></a><span class="lineno"> 2080</span>&#160;    *ofsVar &lt;&lt; <span class="stringliteral">&quot;COMPLETE&quot;</span>                &lt;&lt; std::endl; <span class="comment">// 6 = ML_CHECKPOINT_FIXED_AMOUNT_OF_DATA</span></div>
<div class="line"><a name="l02081"></a><span class="lineno"> 2081</span>&#160;</div>
<div class="line"><a name="l02082"></a><span class="lineno"> 2082</span>&#160;    <span class="keyword">delete</span> ofsVar;</div>
<div class="line"><a name="l02083"></a><span class="lineno"> 2083</span>&#160;  }</div>
<div class="line"><a name="l02084"></a><span class="lineno"> 2084</span>&#160;  <a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#a0b0779b41ff304058856e97e1d16b4d4">fullComm</a>().<a class="code" href="class_q_u_e_s_o_1_1_mpi_comm.html#a4059971c30e023b272fccaa6aa00c426">Barrier</a>();</div>
<div class="line"><a name="l02085"></a><span class="lineno"> 2085</span>&#160;</div>
<div class="line"><a name="l02086"></a><span class="lineno"> 2086</span>&#160;  <span class="comment">//******************************************************************************</span></div>
<div class="line"><a name="l02087"></a><span class="lineno"> 2087</span>&#160;  <span class="comment">// Write three &#39;data&#39; files</span></div>
<div class="line"><a name="l02088"></a><span class="lineno"> 2088</span>&#160;  <span class="comment">//******************************************************************************</span></div>
<div class="line"><a name="l02089"></a><span class="lineno"> 2089</span>&#160;  <span class="keywordtype">char</span> levelSufix[256];</div>
<div class="line"><a name="l02090"></a><span class="lineno"> 2090</span>&#160;  sprintf(levelSufix,<span class="stringliteral">&quot;%d&quot;</span>,<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#af9416874c856e50f3b35270e801f17e4">m_currLevel</a>+<a class="code" href="_m_l_sampling_level_options_8h.html#a68d15eaf394d210effcf584b938206d3">LEVEL_REF_ID</a>); <span class="comment">// Yes, &#39;+0&#39;</span></div>
<div class="line"><a name="l02091"></a><span class="lineno"> 2091</span>&#160;</div>
<div class="line"><a name="l02092"></a><span class="lineno"> 2092</span>&#160;  <span class="keywordflow">if</span> ((<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#a8a0064746ae8dddfece4229b9ad374d6">subDisplayFile</a>()) &amp;&amp; (<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#a1fe5f244fc0316a0ab3e37463f108b96">displayVerbosity</a>() &gt;= 2)) {</div>
<div class="line"><a name="l02093"></a><span class="lineno"> 2093</span>&#160;    *<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#a8a0064746ae8dddfece4229b9ad374d6">subDisplayFile</a>() &lt;&lt; <span class="stringliteral">&quot;\n CHECKPOINTING chain at level &quot;</span> &lt;&lt; <a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#af9416874c856e50f3b35270e801f17e4">m_currLevel</a></div>
<div class="line"><a name="l02094"></a><span class="lineno"> 2094</span>&#160;                            &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l02095"></a><span class="lineno"> 2095</span>&#160;  }</div>
<div class="line"><a name="l02096"></a><span class="lineno"> 2096</span>&#160;  currChain.unifiedWriteContents(<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#af8504cc57ec72b3c52833826b2bfff8e">m_options</a>.m_restartOutput_baseNameForFiles + <span class="stringliteral">&quot;Chain_l&quot;</span> + levelSufix,</div>
<div class="line"><a name="l02097"></a><span class="lineno"> 2097</span>&#160;                                 <a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#af8504cc57ec72b3c52833826b2bfff8e">m_options</a>.m_restartOutput_fileType);</div>
<div class="line"><a name="l02098"></a><span class="lineno"> 2098</span>&#160;  <a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#a0b0779b41ff304058856e97e1d16b4d4">fullComm</a>().<a class="code" href="class_q_u_e_s_o_1_1_mpi_comm.html#a4059971c30e023b272fccaa6aa00c426">Barrier</a>();</div>
<div class="line"><a name="l02099"></a><span class="lineno"> 2099</span>&#160;</div>
<div class="line"><a name="l02100"></a><span class="lineno"> 2100</span>&#160;  <span class="keywordflow">if</span> ((<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#a8a0064746ae8dddfece4229b9ad374d6">subDisplayFile</a>()) &amp;&amp; (<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#a1fe5f244fc0316a0ab3e37463f108b96">displayVerbosity</a>() &gt;= 2)) {</div>
<div class="line"><a name="l02101"></a><span class="lineno"> 2101</span>&#160;    *<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#a8a0064746ae8dddfece4229b9ad374d6">subDisplayFile</a>() &lt;&lt; <span class="stringliteral">&quot;\n CHECKPOINTING like at level &quot;</span> &lt;&lt; <a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#af9416874c856e50f3b35270e801f17e4">m_currLevel</a></div>
<div class="line"><a name="l02102"></a><span class="lineno"> 2102</span>&#160;                            &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l02103"></a><span class="lineno"> 2103</span>&#160;  }</div>
<div class="line"><a name="l02104"></a><span class="lineno"> 2104</span>&#160;  currLogLikelihoodValues.<a class="code" href="class_q_u_e_s_o_1_1_scalar_sequence.html#a2f832dd5eda37df06eb52650ab8ce733">unifiedWriteContents</a>(<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#af8504cc57ec72b3c52833826b2bfff8e">m_options</a>.m_restartOutput_baseNameForFiles + <span class="stringliteral">&quot;LogLike_l&quot;</span> + levelSufix,</div>
<div class="line"><a name="l02105"></a><span class="lineno"> 2105</span>&#160;                                               <a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#af8504cc57ec72b3c52833826b2bfff8e">m_options</a>.m_restartOutput_fileType);</div>
<div class="line"><a name="l02106"></a><span class="lineno"> 2106</span>&#160;  <a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#a0b0779b41ff304058856e97e1d16b4d4">fullComm</a>().<a class="code" href="class_q_u_e_s_o_1_1_mpi_comm.html#a4059971c30e023b272fccaa6aa00c426">Barrier</a>();</div>
<div class="line"><a name="l02107"></a><span class="lineno"> 2107</span>&#160;</div>
<div class="line"><a name="l02108"></a><span class="lineno"> 2108</span>&#160;  <span class="keywordflow">if</span> ((<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#a8a0064746ae8dddfece4229b9ad374d6">subDisplayFile</a>()) &amp;&amp; (<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#a1fe5f244fc0316a0ab3e37463f108b96">displayVerbosity</a>() &gt;= 2)) {</div>
<div class="line"><a name="l02109"></a><span class="lineno"> 2109</span>&#160;    *<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#a8a0064746ae8dddfece4229b9ad374d6">subDisplayFile</a>() &lt;&lt; <span class="stringliteral">&quot;\n CHECKPOINTING target at level &quot;</span> &lt;&lt; <a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#af9416874c856e50f3b35270e801f17e4">m_currLevel</a></div>
<div class="line"><a name="l02110"></a><span class="lineno"> 2110</span>&#160;                            &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l02111"></a><span class="lineno"> 2111</span>&#160;  }</div>
<div class="line"><a name="l02112"></a><span class="lineno"> 2112</span>&#160;  currLogTargetValues.<a class="code" href="class_q_u_e_s_o_1_1_scalar_sequence.html#a2f832dd5eda37df06eb52650ab8ce733">unifiedWriteContents</a>(<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#af8504cc57ec72b3c52833826b2bfff8e">m_options</a>.m_restartOutput_baseNameForFiles + <span class="stringliteral">&quot;LogTarget_l&quot;</span> + levelSufix,</div>
<div class="line"><a name="l02113"></a><span class="lineno"> 2113</span>&#160;                                           <a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#af8504cc57ec72b3c52833826b2bfff8e">m_options</a>.m_restartOutput_fileType);</div>
<div class="line"><a name="l02114"></a><span class="lineno"> 2114</span>&#160;  <a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#a0b0779b41ff304058856e97e1d16b4d4">fullComm</a>().<a class="code" href="class_q_u_e_s_o_1_1_mpi_comm.html#a4059971c30e023b272fccaa6aa00c426">Barrier</a>();</div>
<div class="line"><a name="l02115"></a><span class="lineno"> 2115</span>&#160;</div>
<div class="line"><a name="l02116"></a><span class="lineno"> 2116</span>&#160;  <span class="comment">//******************************************************************************</span></div>
<div class="line"><a name="l02117"></a><span class="lineno"> 2117</span>&#160;  <span class="comment">// Write &#39;control&#39; file *with* &#39;level&#39; spefication in name</span></div>
<div class="line"><a name="l02118"></a><span class="lineno"> 2118</span>&#160;  <span class="comment">//******************************************************************************</span></div>
<div class="line"><a name="l02119"></a><span class="lineno"> 2119</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#a84a239e42ae443cf71db6e03e8159620">fullRank</a>() == 0) {</div>
<div class="line"><a name="l02120"></a><span class="lineno"> 2120</span>&#160;    std::ofstream* ofsVar = <span class="keyword">new</span> std::ofstream((<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#af8504cc57ec72b3c52833826b2bfff8e">m_options</a>.m_restartOutput_baseNameForFiles + <span class="stringliteral">&quot;Control_l&quot;</span> + levelSufix + <span class="stringliteral">&quot;.txt&quot;</span>).c_str(),</div>
<div class="line"><a name="l02121"></a><span class="lineno"> 2121</span>&#160;                                              std::ofstream::out | std::ofstream::trunc);</div>
<div class="line"><a name="l02122"></a><span class="lineno"> 2122</span>&#160;    *ofsVar &lt;&lt; <a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#af9416874c856e50f3b35270e801f17e4">m_currLevel</a>               &lt;&lt; std::endl  <span class="comment">// 1</span></div>
<div class="line"><a name="l02123"></a><span class="lineno"> 2123</span>&#160;            &lt;&lt; <a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a7bc4c72f65ba9166ed94a6e198b0915b">m_vectorSpace</a>.<a class="code" href="class_q_u_e_s_o_1_1_vector_space.html#acd4359dc120905c22ca1064e33787239">dimGlobal</a>() &lt;&lt; std::endl  <span class="comment">// 2</span></div>
<div class="line"><a name="l02124"></a><span class="lineno"> 2124</span>&#160;            &lt;&lt; currExponent              &lt;&lt; std::endl  <span class="comment">// 3</span></div>
<div class="line"><a name="l02125"></a><span class="lineno"> 2125</span>&#160;            &lt;&lt; currEta                   &lt;&lt; std::endl  <span class="comment">// 4</span></div>
<div class="line"><a name="l02126"></a><span class="lineno"> 2126</span>&#160;            &lt;&lt; quantity1                 &lt;&lt; std::endl; <span class="comment">// 5</span></div>
<div class="line"><a name="l02127"></a><span class="lineno"> 2127</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> savedPrecision = ofsVar-&gt;precision();</div>
<div class="line"><a name="l02128"></a><span class="lineno"> 2128</span>&#160;    ofsVar-&gt;precision(16);</div>
<div class="line"><a name="l02129"></a><span class="lineno"> 2129</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a75f2ceab4a2c6774b3fa07d74221dbf3">m_logEvidenceFactors</a>.size(); ++i) {</div>
<div class="line"><a name="l02130"></a><span class="lineno"> 2130</span>&#160;      *ofsVar &lt;&lt; <a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a75f2ceab4a2c6774b3fa07d74221dbf3">m_logEvidenceFactors</a>[i] &lt;&lt; std::endl;</div>
<div class="line"><a name="l02131"></a><span class="lineno"> 2131</span>&#160;    }</div>
<div class="line"><a name="l02132"></a><span class="lineno"> 2132</span>&#160;    ofsVar-&gt;precision(savedPrecision);</div>
<div class="line"><a name="l02133"></a><span class="lineno"> 2133</span>&#160;    *ofsVar &lt;&lt; <span class="stringliteral">&quot;COMPLETE&quot;</span>                &lt;&lt; std::endl; <span class="comment">// 6 = ML_CHECKPOINT_FIXED_AMOUNT_OF_DATA</span></div>
<div class="line"><a name="l02134"></a><span class="lineno"> 2134</span>&#160;</div>
<div class="line"><a name="l02135"></a><span class="lineno"> 2135</span>&#160;    <span class="keyword">delete</span> ofsVar;</div>
<div class="line"><a name="l02136"></a><span class="lineno"> 2136</span>&#160;  }</div>
<div class="line"><a name="l02137"></a><span class="lineno"> 2137</span>&#160;  <a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#a0b0779b41ff304058856e97e1d16b4d4">fullComm</a>().<a class="code" href="class_q_u_e_s_o_1_1_mpi_comm.html#a4059971c30e023b272fccaa6aa00c426">Barrier</a>();</div>
<div class="line"><a name="l02138"></a><span class="lineno"> 2138</span>&#160;</div>
<div class="line"><a name="l02139"></a><span class="lineno"> 2139</span>&#160;  <span class="keywordflow">if</span> ((<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#a8a0064746ae8dddfece4229b9ad374d6">subDisplayFile</a>()) &amp;&amp; (<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#a1fe5f244fc0316a0ab3e37463f108b96">displayVerbosity</a>() &gt;= 2)) {</div>
<div class="line"><a name="l02140"></a><span class="lineno"> 2140</span>&#160;    *<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#a8a0064746ae8dddfece4229b9ad374d6">subDisplayFile</a>() &lt;&lt; <span class="stringliteral">&quot;\n CHECKPOINTING done at level &quot;</span> &lt;&lt; <a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#af9416874c856e50f3b35270e801f17e4">m_currLevel</a></div>
<div class="line"><a name="l02141"></a><span class="lineno"> 2141</span>&#160;                            &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l02142"></a><span class="lineno"> 2142</span>&#160;  }</div>
<div class="line"><a name="l02143"></a><span class="lineno"> 2143</span>&#160;</div>
<div class="line"><a name="l02144"></a><span class="lineno"> 2144</span>&#160;  <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l02145"></a><span class="lineno"> 2145</span>&#160;}</div>
<div class="ttc" id="class_q_u_e_s_o_1_1_base_environment_html_a84a239e42ae443cf71db6e03e8159620"><div class="ttname"><a href="class_q_u_e_s_o_1_1_base_environment.html#a84a239e42ae443cf71db6e03e8159620">QUESO::BaseEnvironment::fullRank</a></div><div class="ttdeci">int fullRank() const </div><div class="ttdoc">Returns the process full rank. </div><div class="ttdef"><b>Definition:</b> <a href="_environment_8_c_source.html#l00241">Environment.C:241</a></div></div>
<div class="ttc" id="class_q_u_e_s_o_1_1_m_l_sampling_html_a13f1ca4fe9f94822fe572a743eaced1d"><div class="ttname"><a href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">QUESO::MLSampling::m_env</a></div><div class="ttdeci">const BaseEnvironment &amp; m_env</div><div class="ttdoc">Queso enviroment. </div><div class="ttdef"><b>Definition:</b> <a href="_m_l_sampling_8h_source.html#l00442">MLSampling.h:442</a></div></div>
<div class="ttc" id="class_q_u_e_s_o_1_1_mpi_comm_html_a4059971c30e023b272fccaa6aa00c426"><div class="ttname"><a href="class_q_u_e_s_o_1_1_mpi_comm.html#a4059971c30e023b272fccaa6aa00c426">QUESO::MpiComm::Barrier</a></div><div class="ttdeci">void Barrier() const </div><div class="ttdoc">Pause every process in *this communicator until all the processes reach this point. </div><div class="ttdef"><b>Definition:</b> <a href="_mpi_comm_8_c_source.html#l00143">MpiComm.C:143</a></div></div>
<div class="ttc" id="class_q_u_e_s_o_1_1_base_environment_html_a0b0779b41ff304058856e97e1d16b4d4"><div class="ttname"><a href="class_q_u_e_s_o_1_1_base_environment.html#a0b0779b41ff304058856e97e1d16b4d4">QUESO::BaseEnvironment::fullComm</a></div><div class="ttdeci">const MpiComm &amp; fullComm() const </div><div class="ttdoc">Access function for MpiComm full communicator. </div><div class="ttdef"><b>Definition:</b> <a href="_environment_8_c_source.html#l00247">Environment.C:247</a></div></div>
<div class="ttc" id="class_q_u_e_s_o_1_1_m_l_sampling_html_a75f2ceab4a2c6774b3fa07d74221dbf3"><div class="ttname"><a href="class_q_u_e_s_o_1_1_m_l_sampling.html#a75f2ceab4a2c6774b3fa07d74221dbf3">QUESO::MLSampling::m_logEvidenceFactors</a></div><div class="ttdeci">std::vector&lt; double &gt; m_logEvidenceFactors</div><div class="ttdef"><b>Definition:</b> <a href="_m_l_sampling_8h_source.html#l00471">MLSampling.h:471</a></div></div>
<div class="ttc" id="class_q_u_e_s_o_1_1_m_l_sampling_html_af8504cc57ec72b3c52833826b2bfff8e"><div class="ttname"><a href="class_q_u_e_s_o_1_1_m_l_sampling.html#af8504cc57ec72b3c52833826b2bfff8e">QUESO::MLSampling::m_options</a></div><div class="ttdeci">MLSamplingOptions m_options</div><div class="ttdoc">Options for the ML algorithm. </div><div class="ttdef"><b>Definition:</b> <a href="_m_l_sampling_8h_source.html#l00461">MLSampling.h:461</a></div></div>
<div class="ttc" id="class_q_u_e_s_o_1_1_vector_space_html_a67b0c3620662116f5a346fdaa5faf38e"><div class="ttname"><a href="class_q_u_e_s_o_1_1_vector_space.html#a67b0c3620662116f5a346fdaa5faf38e">QUESO::VectorSpace::numOfProcsForStorage</a></div><div class="ttdeci">unsigned int numOfProcsForStorage() const </div><div class="ttdoc">Returns total number of processes. </div><div class="ttdef"><b>Definition:</b> <a href="_vector_space_8_c_source.html#l00193">VectorSpace.C:193</a></div></div>
<div class="ttc" id="class_q_u_e_s_o_1_1_m_l_sampling_html_af9416874c856e50f3b35270e801f17e4"><div class="ttname"><a href="class_q_u_e_s_o_1_1_m_l_sampling.html#af9416874c856e50f3b35270e801f17e4">QUESO::MLSampling::m_currLevel</a></div><div class="ttdeci">unsigned int m_currLevel</div><div class="ttdoc">Current level. </div><div class="ttdef"><b>Definition:</b> <a href="_m_l_sampling_8h_source.html#l00464">MLSampling.h:464</a></div></div>
<div class="ttc" id="class_q_u_e_s_o_1_1_scalar_sequence_html_a2f832dd5eda37df06eb52650ab8ce733"><div class="ttname"><a href="class_q_u_e_s_o_1_1_scalar_sequence.html#a2f832dd5eda37df06eb52650ab8ce733">QUESO::ScalarSequence::unifiedWriteContents</a></div><div class="ttdeci">void unifiedWriteContents(const std::string &amp;fileName, const std::string &amp;fileType) const </div><div class="ttdoc">Writes the unified sequence to a file. </div><div class="ttdef"><b>Definition:</b> <a href="_scalar_sequence_8_c_source.html#l02799">ScalarSequence.C:2799</a></div></div>
<div class="ttc" id="class_q_u_e_s_o_1_1_vector_space_html_acd4359dc120905c22ca1064e33787239"><div class="ttname"><a href="class_q_u_e_s_o_1_1_vector_space.html#acd4359dc120905c22ca1064e33787239">QUESO::VectorSpace::dimGlobal</a></div><div class="ttdeci">unsigned int dimGlobal() const </div><div class="ttdef"><b>Definition:</b> <a href="_vector_space_8_c_source.html#l00205">VectorSpace.C:205</a></div></div>
<div class="ttc" id="_m_l_sampling_level_options_8h_html_a68d15eaf394d210effcf584b938206d3"><div class="ttname"><a href="_m_l_sampling_level_options_8h.html#a68d15eaf394d210effcf584b938206d3">LEVEL_REF_ID</a></div><div class="ttdeci">#define LEVEL_REF_ID</div><div class="ttdef"><b>Definition:</b> <a href="_m_l_sampling_level_options_8h_source.html#l00028">MLSamplingLevelOptions.h:28</a></div></div>
<div class="ttc" id="class_q_u_e_s_o_1_1_scalar_sequence_html_a52829afc95e5c36e9db44f40854153b0"><div class="ttname"><a href="class_q_u_e_s_o_1_1_scalar_sequence.html#a52829afc95e5c36e9db44f40854153b0">QUESO::ScalarSequence::unifiedSequenceSize</a></div><div class="ttdeci">unsigned int unifiedSequenceSize(bool useOnlyInter0Comm) const </div><div class="ttdoc">Size of the unified sequence of scalars. </div><div class="ttdef"><b>Definition:</b> <a href="_scalar_sequence_8_c_source.html#l00148">ScalarSequence.C:148</a></div></div>
<div class="ttc" id="class_q_u_e_s_o_1_1_m_l_sampling_html_a7bc4c72f65ba9166ed94a6e198b0915b"><div class="ttname"><a href="class_q_u_e_s_o_1_1_m_l_sampling.html#a7bc4c72f65ba9166ed94a6e198b0915b">QUESO::MLSampling::m_vectorSpace</a></div><div class="ttdeci">const VectorSpace&lt; P_V, P_M &gt; &amp; m_vectorSpace</div><div class="ttdoc">Vector space. </div><div class="ttdef"><b>Definition:</b> <a href="_m_l_sampling_8h_source.html#l00451">MLSampling.h:451</a></div></div>
<div class="ttc" id="class_q_u_e_s_o_1_1_base_environment_html_ae106b5bb8a80b655b88b3a26b1e7c185"><div class="ttname"><a href="class_q_u_e_s_o_1_1_base_environment.html#ae106b5bb8a80b655b88b3a26b1e7c185">QUESO::BaseEnvironment::inter0Rank</a></div><div class="ttdeci">int inter0Rank() const </div><div class="ttdoc">Returns the process inter0 rank. </div><div class="ttdef"><b>Definition:</b> <a href="_environment_8_c_source.html#l00289">Environment.C:289</a></div></div>
<div class="ttc" id="_defines_8h_html_a56d63d18d0a6d45757de47fcc06f574d"><div class="ttname"><a href="_defines_8h.html#a56d63d18d0a6d45757de47fcc06f574d">UQ_FATAL_TEST_MACRO</a></div><div class="ttdeci">#define UQ_FATAL_TEST_MACRO(test, givenRank, where, what)</div><div class="ttdef"><b>Definition:</b> <a href="_defines_8h_source.html#l00222">Defines.h:222</a></div></div>
<div class="ttc" id="class_q_u_e_s_o_1_1_base_environment_html_a1fe5f244fc0316a0ab3e37463f108b96"><div class="ttname"><a href="class_q_u_e_s_o_1_1_base_environment.html#a1fe5f244fc0316a0ab3e37463f108b96">QUESO::BaseEnvironment::displayVerbosity</a></div><div class="ttdeci">unsigned int displayVerbosity() const </div><div class="ttdef"><b>Definition:</b> <a href="_environment_8_c_source.html#l00436">Environment.C:436</a></div></div>
<div class="ttc" id="class_q_u_e_s_o_1_1_base_environment_html_a8a0064746ae8dddfece4229b9ad374d6"><div class="ttname"><a href="class_q_u_e_s_o_1_1_base_environment.html#a8a0064746ae8dddfece4229b9ad374d6">QUESO::BaseEnvironment::subDisplayFile</a></div><div class="ttdeci">std::ofstream * subDisplayFile() const </div><div class="ttdoc">Access function for m_subDisplayFile (displays file on stream). </div><div class="ttdef"><b>Definition:</b> <a href="_environment_8_c_source.html#l00305">Environment.C:305</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a0f6f7872635b9546b3215fee347601f6"></a>
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;class P_V , class P_M &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool <a class="el" href="class_q_u_e_s_o_1_1_m_l_sampling.html">QUESO::MLSampling</a>&lt; P_V, P_M &gt;::decideOnBalancedChains_all </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="class_q_u_e_s_o_1_1_m_l_sampling_level_options.html">MLSamplingLevelOptions</a> *&#160;</td>
          <td class="paramname"><em>currOptions</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned int&#160;</td>
          <td class="paramname"><em>indexOfFirstWeight</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned int&#160;</td>
          <td class="paramname"><em>indexOfLastWeight</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::vector&lt; unsigned int &gt; &amp;&#160;</td>
          <td class="paramname"><em>unifiedIndexCountersAtProc0Only</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::vector&lt; <a class="el" href="struct_q_u_e_s_o_1_1_exchange_info_struct.html">ExchangeInfoStruct</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>exchangeStdVec</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">currOptions,indexOfFirstWeight,indexOfLastWeight,unifiedIndexCountersAtProc0Only</td><td></td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">exchangeStdVec</td><td></td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="_m_l_sampling_8_c_source.html#l00147">147</a> of file <a class="el" href="_m_l_sampling_8_c_source.html">MLSampling.C</a>.</p>

<p>References <a class="el" href="_m_l_sampling_8h_source.html#l00068">QUESO::ExchangeInfoStruct::finalNodeOfInitialPosition</a>, <a class="el" href="_m_l_sampling_level_options_8h_source.html#l00028">LEVEL_REF_ID</a>, <a class="el" href="_m_l_sampling_level_options_8h_source.html#l00166">QUESO::MLSamplingLevelOptions::m_loadBalanceAlgorithmId</a>, <a class="el" href="_m_l_sampling_level_options_8h_source.html#l00169">QUESO::MLSamplingLevelOptions::m_loadBalanceTreshold</a>, <a class="el" href="_m_l_sampling_8h_source.html#l00069">QUESO::ExchangeInfoStruct::numberOfPositions</a>, <a class="el" href="_m_l_sampling_8h_source.html#l00067">QUESO::ExchangeInfoStruct::originalIndexOfInitialPosition</a>, <a class="el" href="_m_l_sampling_8h_source.html#l00066">QUESO::ExchangeInfoStruct::originalNodeOfInitialPosition</a>, <a class="el" href="_mpi_comm_8h_source.html#l00049">RawValue_MPI_UNSIGNED</a>, and <a class="el" href="_defines_8h_source.html#l00222">UQ_FATAL_TEST_MACRO</a>.</p>
<div class="fragment"><div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;{</div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;  <span class="keywordtype">bool</span> result = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;</div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;  <span class="keywordflow">if</span> ((<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#a8a0064746ae8dddfece4229b9ad374d6">subDisplayFile</a>()) &amp;&amp; (<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#a1fe5f244fc0316a0ab3e37463f108b96">displayVerbosity</a>() &gt;= 0)) {</div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;    *<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#a8a0064746ae8dddfece4229b9ad374d6">subDisplayFile</a>() &lt;&lt; <span class="stringliteral">&quot;Entering MLSampling&lt;P_V,P_M&gt;::decideOnBalancedChains_all()&quot;</span></div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;                            &lt;&lt; <span class="stringliteral">&quot;, level &quot;</span> &lt;&lt; <a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#af9416874c856e50f3b35270e801f17e4">m_currLevel</a>+<a class="code" href="_m_l_sampling_level_options_8h.html#a68d15eaf394d210effcf584b938206d3">LEVEL_REF_ID</a></div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;                            &lt;&lt; <span class="stringliteral">&quot;, step &quot;</span>  &lt;&lt; <a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a1b1f8ccb4823bdfa26ec652f0807c63e">m_currStep</a></div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;                            &lt;&lt; <span class="stringliteral">&quot;: indexOfFirstWeight = &quot;</span> &lt;&lt; indexOfFirstWeight</div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;                            &lt;&lt; <span class="stringliteral">&quot;, indexOfLastWeight = &quot;</span>  &lt;&lt; indexOfLastWeight</div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;                            &lt;&lt; std::endl;</div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;  }</div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;</div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;  <span class="keywordflow">if</span> (<span class="keyword">true</span>) {</div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> Np = 0;</div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#ae106b5bb8a80b655b88b3a26b1e7c185">inter0Rank</a>() &gt;= 0) { <span class="comment">// Yes, &#39;&gt;= 0&#39;</span></div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;      Np = (<span class="keywordtype">unsigned</span> int) <a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#a689e4d140c74d495d97eb498714a4b82">inter0Comm</a>().<a class="code" href="class_q_u_e_s_o_1_1_mpi_comm.html#aa780721ae0fdeabc5a15e04cb0cad964">NumProc</a>();</div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;    }</div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;    std::vector&lt;unsigned int&gt; allFirstIndexes(Np,0); <span class="comment">// &#39;0&#39; is already the correct value for recvcnts[0]</span></div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;    std::vector&lt;unsigned int&gt; allLastIndexes(Np,0);  <span class="comment">// &#39;0&#39; is NOT the correct value for recvcnts[0]</span></div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;</div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#ae106b5bb8a80b655b88b3a26b1e7c185">inter0Rank</a>() &gt;= 0) { <span class="comment">// Yes, &#39;&gt;= 0&#39;</span></div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;<span class="comment"></span>      <span class="comment">// Gather information at proc 0: number of chains and positions per node</span></div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;<span class="comment"></span>      <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> auxUInt = indexOfFirstWeight;</div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;      <a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#a689e4d140c74d495d97eb498714a4b82">inter0Comm</a>().<a class="code" href="class_q_u_e_s_o_1_1_mpi_comm.html#a184a5e411afcfb6dc41e99fca9435045">Gather</a>((<span class="keywordtype">void</span> *) &amp;auxUInt, 1, <a class="code" href="_mpi_comm_8h.html#a06cbfbc33436f6e0dc8a48ff3c49bdfc">RawValue_MPI_UNSIGNED</a>, (<span class="keywordtype">void</span> *) &amp;allFirstIndexes[0], (<span class="keywordtype">int</span>) 1, <a class="code" href="_mpi_comm_8h.html#a06cbfbc33436f6e0dc8a48ff3c49bdfc">RawValue_MPI_UNSIGNED</a>, 0, <span class="comment">// LOAD BALANCE</span></div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;                                <span class="stringliteral">&quot;MLSampling&lt;P_V,P_M&gt;::decideOnBalancedChains_all()&quot;</span>,</div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;                                <span class="stringliteral">&quot;failed MPI.Gather() for first indexes&quot;</span>);</div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;</div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#ae106b5bb8a80b655b88b3a26b1e7c185">inter0Rank</a>() == 0) {</div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;        <a class="code" href="_defines_8h.html#a56d63d18d0a6d45757de47fcc06f574d">UQ_FATAL_TEST_MACRO</a>(allFirstIndexes[0] != indexOfFirstWeight,</div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;                            <a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#a78b57112bbd0e6dd0e8afec00b40ffa7">worldRank</a>(),</div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;                            <span class="stringliteral">&quot;MLSampling&lt;P_V,P_M&gt;::decideOnBalancedChains_all()&quot;</span>,</div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;                            <span class="stringliteral">&quot;failed MPI.Gather() result for first indexes, at proc 0&quot;</span>);</div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;      }</div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;</div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;      auxUInt = indexOfLastWeight;</div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;      <a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#a689e4d140c74d495d97eb498714a4b82">inter0Comm</a>().<a class="code" href="class_q_u_e_s_o_1_1_mpi_comm.html#a184a5e411afcfb6dc41e99fca9435045">Gather</a>((<span class="keywordtype">void</span> *) &amp;auxUInt, 1, <a class="code" href="_mpi_comm_8h.html#a06cbfbc33436f6e0dc8a48ff3c49bdfc">RawValue_MPI_UNSIGNED</a>, (<span class="keywordtype">void</span> *) &amp;allLastIndexes[0], (<span class="keywordtype">int</span>) 1, <a class="code" href="_mpi_comm_8h.html#a06cbfbc33436f6e0dc8a48ff3c49bdfc">RawValue_MPI_UNSIGNED</a>, 0, <span class="comment">// LOAD BALANCE</span></div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;                                <span class="stringliteral">&quot;MLSampling&lt;P_V,P_M&gt;::decideOnBalancedChains_all()&quot;</span>,</div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;                                <span class="stringliteral">&quot;failed MPI.Gather() for last indexes&quot;</span>);</div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;</div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#ae106b5bb8a80b655b88b3a26b1e7c185">inter0Rank</a>() == 0) { <span class="comment">// Yes, &#39;== 0&#39;</span></div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;        <span class="comment">//allLastIndexes[0] = indexOfLastWeight; // FIX ME: really necessary????</span></div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;        <a class="code" href="_defines_8h.html#a56d63d18d0a6d45757de47fcc06f574d">UQ_FATAL_TEST_MACRO</a>(allLastIndexes[0] != indexOfLastWeight,</div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;                            <a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#a78b57112bbd0e6dd0e8afec00b40ffa7">worldRank</a>(),</div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;                            <span class="stringliteral">&quot;MLSampling&lt;P_V,P_M&gt;::decideOnBalancedChains_all()&quot;</span>,</div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;                            <span class="stringliteral">&quot;failed MPI.Gather() result for last indexes, at proc 0&quot;</span>);</div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;      }</div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;    }</div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;</div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;    <span class="comment">// Proc 0 prepares information to decide if load balancing is needed</span></div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;<span class="comment"></span>    <span class="keywordflow">if</span> (<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#ae106b5bb8a80b655b88b3a26b1e7c185">inter0Rank</a>() == 0) {</div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;      <span class="keywordflow">if</span> ((<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#a8a0064746ae8dddfece4229b9ad374d6">subDisplayFile</a>()) &amp;&amp; (<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#a1fe5f244fc0316a0ab3e37463f108b96">displayVerbosity</a>() &gt;= 0)) {</div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;        *<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#a8a0064746ae8dddfece4229b9ad374d6">subDisplayFile</a>() &lt;&lt; <span class="stringliteral">&quot;In MLSampling&lt;P_V,P_M&gt;::decideOnBalancedChains_all()&quot;</span></div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;                                &lt;&lt; <span class="stringliteral">&quot;, level &quot;</span> &lt;&lt; <a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#af9416874c856e50f3b35270e801f17e4">m_currLevel</a>+<a class="code" href="_m_l_sampling_level_options_8h.html#a68d15eaf394d210effcf584b938206d3">LEVEL_REF_ID</a></div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;                                &lt;&lt; <span class="stringliteral">&quot;, step &quot;</span>  &lt;&lt; <a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a1b1f8ccb4823bdfa26ec652f0807c63e">m_currStep</a></div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;                                &lt;&lt; <span class="stringliteral">&quot;: original distribution of unified indexes in &#39;inter0Comm&#39; is as follows&quot;</span></div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;                                &lt;&lt; std::endl;</div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> r = 0; r &lt; Np; ++r) {</div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;          *<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#a8a0064746ae8dddfece4229b9ad374d6">subDisplayFile</a>() &lt;&lt; <span class="stringliteral">&quot;  allFirstIndexes[&quot;</span> &lt;&lt; r &lt;&lt; <span class="stringliteral">&quot;] = &quot;</span> &lt;&lt; allFirstIndexes[r]</div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;                                  &lt;&lt; <span class="stringliteral">&quot;  allLastIndexes[&quot;</span>  &lt;&lt; r &lt;&lt; <span class="stringliteral">&quot;] = &quot;</span> &lt;&lt; allLastIndexes[r]</div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;                                  &lt;&lt; std::endl;</div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;        }</div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;      }</div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> r = 0; r &lt; (Np-1); ++r) { <span class="comment">// Yes, &#39;-1&#39;</span></div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;        <a class="code" href="_defines_8h.html#a56d63d18d0a6d45757de47fcc06f574d">UQ_FATAL_TEST_MACRO</a>(allFirstIndexes[r+1] != (allLastIndexes[r]+1),</div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;                            <a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#a78b57112bbd0e6dd0e8afec00b40ffa7">worldRank</a>(),</div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;                            <span class="stringliteral">&quot;MLSampling&lt;P_V,P_M&gt;::decideOnBalancedChains_all()&quot;</span>,</div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;                            <span class="stringliteral">&quot;wrong indexes&quot;</span>);</div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;      }</div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;</div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> r = 0; r &lt; (Np-1); ++r) { <span class="comment">// Yes, &#39;-1&#39;</span></div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;        <a class="code" href="_defines_8h.html#a56d63d18d0a6d45757de47fcc06f574d">UQ_FATAL_TEST_MACRO</a>(allFirstIndexes[r+1] != (allLastIndexes[r]+1),</div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;                            <a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#a78b57112bbd0e6dd0e8afec00b40ffa7">worldRank</a>(),</div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;                            <span class="stringliteral">&quot;MLSampling&lt;P_V,P_M&gt;::decideOnBalancedChains_all()&quot;</span>,</div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;                            <span class="stringliteral">&quot;wrong indexes&quot;</span>);</div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;      }</div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;</div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;      std::vector&lt;unsigned int&gt; origNumChainsPerNode   (Np,0);</div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;      std::vector&lt;unsigned int&gt; origNumPositionsPerNode(Np,0);</div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;      <span class="keywordtype">int</span> r = 0;</div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = 0; i &lt; unifiedIndexCountersAtProc0Only.size(); ++i) {</div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;        <span class="keywordflow">if</span> ((allFirstIndexes[r] &lt;= i) &amp;&amp; <span class="comment">// FIX ME: not a robust logic</span></div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;            (i &lt;= allLastIndexes[r] )) {</div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;          <span class="comment">// Ok</span></div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;        }</div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;        <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;          r++;</div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;          <span class="keywordflow">if</span> ((r &lt; (<span class="keywordtype">int</span>) Np           ) &amp;&amp;</div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;              (allFirstIndexes[r] &lt;= i) &amp;&amp;</div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;              (i &lt;= allLastIndexes[r] )) {</div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;            <span class="comment">// Ok</span></div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;          }</div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;          <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;      std::cerr &lt;&lt; <span class="stringliteral">&quot;In MLSampling&lt;P_V,P_M&gt;::decideOnBalancedChains_all()&quot;</span></div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;                      &lt;&lt; <span class="stringliteral">&quot;: i = &quot;</span> &lt;&lt; i</div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;                      &lt;&lt; <span class="stringliteral">&quot;, r = &quot;</span> &lt;&lt; r</div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;                      &lt;&lt; <span class="stringliteral">&quot;, allFirstIndexes[r] = &quot;</span> &lt;&lt; allFirstIndexes[r]</div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;                      &lt;&lt; <span class="stringliteral">&quot;, allLastIndexes[r] = &quot;</span>  &lt;&lt; allLastIndexes[r]</div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;                      &lt;&lt; std::endl;</div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;            <a class="code" href="_defines_8h.html#a56d63d18d0a6d45757de47fcc06f574d">UQ_FATAL_TEST_MACRO</a>(<span class="keyword">true</span>,</div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;                                <a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#a78b57112bbd0e6dd0e8afec00b40ffa7">worldRank</a>(),</div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;                                <span class="stringliteral">&quot;MLSampling&lt;P_V,P_M&gt;::decideOnBalancedChains_all()&quot;</span>,</div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;                                <span class="stringliteral">&quot;wrong indexes or &#39;r&#39; got too large&quot;</span>);</div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;          }</div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;        }</div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;        <span class="keywordflow">if</span> (unifiedIndexCountersAtProc0Only[i] != 0) {</div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;          origNumChainsPerNode   [r] += 1;</div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;          origNumPositionsPerNode[r] += unifiedIndexCountersAtProc0Only[i];</div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;</div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;          ExchangeInfoStruct auxInfo;</div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;          auxInfo.originalNodeOfInitialPosition  = r;</div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;          auxInfo.originalIndexOfInitialPosition = i - allFirstIndexes[r];</div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;          auxInfo.finalNodeOfInitialPosition     = -1; <span class="comment">// Yes, &#39;-1&#39; for now, important</span></div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;          auxInfo.numberOfPositions              = unifiedIndexCountersAtProc0Only[i];</div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;          exchangeStdVec.push_back(auxInfo);</div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;        }</div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;        <span class="comment">// FIX ME: swap trick to save memory</span></div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;      }</div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;</div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;      <span class="comment">// Check if number of procs is too large</span></div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;      <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> totalNumberOfChains = 0;</div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> r = 0; r &lt; Np; ++r) {</div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;        totalNumberOfChains += origNumChainsPerNode[r];</div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;      }</div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;      <span class="keywordflow">if</span> ((<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#a8a0064746ae8dddfece4229b9ad374d6">subDisplayFile</a>()) &amp;&amp; (<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#a1fe5f244fc0316a0ab3e37463f108b96">displayVerbosity</a>() &gt;= 0)) {</div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;        *<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#a8a0064746ae8dddfece4229b9ad374d6">subDisplayFile</a>() &lt;&lt; <span class="stringliteral">&quot;  KEY&quot;</span></div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;                                &lt;&lt; <span class="stringliteral">&quot;, level &quot;</span> &lt;&lt; <a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#af9416874c856e50f3b35270e801f17e4">m_currLevel</a>+<a class="code" href="_m_l_sampling_level_options_8h.html#a68d15eaf394d210effcf584b938206d3">LEVEL_REF_ID</a></div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;                                &lt;&lt; <span class="stringliteral">&quot;, step &quot;</span>  &lt;&lt; <a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a1b1f8ccb4823bdfa26ec652f0807c63e">m_currStep</a></div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;                                &lt;&lt; <span class="stringliteral">&quot;, Np = &quot;</span>  &lt;&lt; Np</div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;                                &lt;&lt; <span class="stringliteral">&quot;, totalNumberOfChains = &quot;</span> &lt;&lt; totalNumberOfChains</div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;                                &lt;&lt; std::endl;</div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;      }</div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;</div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;      <span class="comment">// Check if ratio max/min justifies optimization</span></div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;      <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> origMinPosPerNode  = *std::min_element(origNumPositionsPerNode.begin(), origNumPositionsPerNode.end());</div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;      <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> origMaxPosPerNode  = *std::max_element(origNumPositionsPerNode.begin(), origNumPositionsPerNode.end());</div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;      <span class="keywordflow">if</span> ((<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#a8a0064746ae8dddfece4229b9ad374d6">subDisplayFile</a>()) &amp;&amp; (<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#a1fe5f244fc0316a0ab3e37463f108b96">displayVerbosity</a>() &gt;= 0)) {</div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> nodeId = 0; nodeId &lt; Np; ++nodeId) {</div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;          *<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#a8a0064746ae8dddfece4229b9ad374d6">subDisplayFile</a>() &lt;&lt; <span class="stringliteral">&quot;  KEY&quot;</span></div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;                                  &lt;&lt; <span class="stringliteral">&quot;, level &quot;</span> &lt;&lt; <a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#af9416874c856e50f3b35270e801f17e4">m_currLevel</a>+<a class="code" href="_m_l_sampling_level_options_8h.html#a68d15eaf394d210effcf584b938206d3">LEVEL_REF_ID</a></div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;                                  &lt;&lt; <span class="stringliteral">&quot;, step &quot;</span>  &lt;&lt; <a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a1b1f8ccb4823bdfa26ec652f0807c63e">m_currStep</a></div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;                                  &lt;&lt; <span class="stringliteral">&quot;, origNumChainsPerNode[&quot;</span>     &lt;&lt; nodeId &lt;&lt; <span class="stringliteral">&quot;] = &quot;</span> &lt;&lt; origNumChainsPerNode[nodeId]</div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;                                  &lt;&lt; <span class="stringliteral">&quot;, origNumPositionsPerNode[&quot;</span>  &lt;&lt; nodeId &lt;&lt; <span class="stringliteral">&quot;] = &quot;</span> &lt;&lt; origNumPositionsPerNode[nodeId]</div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;                                  &lt;&lt; std::endl;</div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;        }</div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;      }</div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;      <span class="keywordtype">double</span> origRatioOfPosPerNode = ((double) origMaxPosPerNode ) / ((double) origMinPosPerNode);</div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;      <span class="keywordflow">if</span> ((<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#a8a0064746ae8dddfece4229b9ad374d6">subDisplayFile</a>()) &amp;&amp; (<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#a1fe5f244fc0316a0ab3e37463f108b96">displayVerbosity</a>() &gt;= 0)) {</div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;        *<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#a8a0064746ae8dddfece4229b9ad374d6">subDisplayFile</a>() &lt;&lt; <span class="stringliteral">&quot;  KEY&quot;</span></div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;                                &lt;&lt; <span class="stringliteral">&quot;, level &quot;</span> &lt;&lt; <a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#af9416874c856e50f3b35270e801f17e4">m_currLevel</a>+<a class="code" href="_m_l_sampling_level_options_8h.html#a68d15eaf394d210effcf584b938206d3">LEVEL_REF_ID</a></div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;                                &lt;&lt; <span class="stringliteral">&quot;, step &quot;</span>  &lt;&lt; <a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a1b1f8ccb4823bdfa26ec652f0807c63e">m_currStep</a></div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;                                &lt;&lt; <span class="stringliteral">&quot;, origRatioOfPosPerNode = &quot;</span>      &lt;&lt; origRatioOfPosPerNode</div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;                                &lt;&lt; <span class="stringliteral">&quot;, option loadBalanceTreshold = &quot;</span> &lt;&lt; currOptions-&gt;m_loadBalanceTreshold</div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;                                &lt;&lt; std::endl;</div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;      }</div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;</div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;      <span class="comment">// At this point, only proc 0 is running...</span></div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;      <span class="comment">// Set boolean &#39;result&#39; for good</span></div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;      <span class="keywordflow">if</span> ((currOptions-&gt;m_loadBalanceAlgorithmId &gt; 0                                 ) &amp;&amp;</div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;          (<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#ac0345f57e31ef7833e379ed972bd094d">numSubEnvironments</a>()            &gt; 1                                 ) &amp;&amp; <span class="comment">// Cannot use &#39;m_env.inter0Comm().NumProc()&#39;: not all nodes at this point of the code belong to &#39;inter0Comm&#39;</span></div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;          (Np                                    &lt; totalNumberOfChains               ) &amp;&amp;</div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;          (origRatioOfPosPerNode                 &gt; currOptions-&gt;m_loadBalanceTreshold)) {</div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;        result = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;      }</div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;    } <span class="comment">// if (m_env.inter0Rank() == 0)</span></div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;  } <span class="comment">// if (true)</span></div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;</div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;  <a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#a0b0779b41ff304058856e97e1d16b4d4">fullComm</a>().<a class="code" href="class_q_u_e_s_o_1_1_mpi_comm.html#a4059971c30e023b272fccaa6aa00c426">Barrier</a>();</div>
<div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;  <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> tmpValue = result;</div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;  <a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#a0b0779b41ff304058856e97e1d16b4d4">fullComm</a>().<a class="code" href="class_q_u_e_s_o_1_1_mpi_comm.html#abd6af8db8b0c7fd2f5b62e26477a9537">Bcast</a>((<span class="keywordtype">void</span> *) &amp;tmpValue, (<span class="keywordtype">int</span>) 1, <a class="code" href="_mpi_comm_8h.html#a06cbfbc33436f6e0dc8a48ff3c49bdfc">RawValue_MPI_UNSIGNED</a>, 0, <span class="comment">// LOAD BALANCE</span></div>
<div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;                         <span class="stringliteral">&quot;MLSampling&lt;P_V,P_M&gt;::decideOnBalancedChains_all()&quot;</span>,</div>
<div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;                         <span class="stringliteral">&quot;failed MPI.Bcast() for &#39;result&#39;&quot;</span>);</div>
<div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#ae106b5bb8a80b655b88b3a26b1e7c185">inter0Rank</a>() != 0) result = tmpValue;</div>
<div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;</div>
<div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;  <span class="keywordflow">if</span> ((<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#a8a0064746ae8dddfece4229b9ad374d6">subDisplayFile</a>()) &amp;&amp; (<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#a1fe5f244fc0316a0ab3e37463f108b96">displayVerbosity</a>() &gt;= 0)) {</div>
<div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;    *<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#a8a0064746ae8dddfece4229b9ad374d6">subDisplayFile</a>() &lt;&lt; <span class="stringliteral">&quot;Leaving MLSampling&lt;P_V,P_M&gt;::decideOnBalancedChains_all()&quot;</span></div>
<div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;                            &lt;&lt; <span class="stringliteral">&quot;, level &quot;</span>    &lt;&lt; <a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#af9416874c856e50f3b35270e801f17e4">m_currLevel</a>+<a class="code" href="_m_l_sampling_level_options_8h.html#a68d15eaf394d210effcf584b938206d3">LEVEL_REF_ID</a></div>
<div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;                            &lt;&lt; <span class="stringliteral">&quot;, step &quot;</span>     &lt;&lt; <a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a1b1f8ccb4823bdfa26ec652f0807c63e">m_currStep</a></div>
<div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;                            &lt;&lt; <span class="stringliteral">&quot;: result = &quot;</span> &lt;&lt; result</div>
<div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;                            &lt;&lt; std::endl;</div>
<div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;  }</div>
<div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;</div>
<div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;  <span class="keywordflow">return</span> result;</div>
<div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;}</div>
<div class="ttc" id="class_q_u_e_s_o_1_1_m_l_sampling_html_a13f1ca4fe9f94822fe572a743eaced1d"><div class="ttname"><a href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">QUESO::MLSampling::m_env</a></div><div class="ttdeci">const BaseEnvironment &amp; m_env</div><div class="ttdoc">Queso enviroment. </div><div class="ttdef"><b>Definition:</b> <a href="_m_l_sampling_8h_source.html#l00442">MLSampling.h:442</a></div></div>
<div class="ttc" id="class_q_u_e_s_o_1_1_mpi_comm_html_aa780721ae0fdeabc5a15e04cb0cad964"><div class="ttname"><a href="class_q_u_e_s_o_1_1_mpi_comm.html#aa780721ae0fdeabc5a15e04cb0cad964">QUESO::MpiComm::NumProc</a></div><div class="ttdeci">int NumProc() const </div><div class="ttdoc">Returns total number of processes. </div><div class="ttdef"><b>Definition:</b> <a href="_mpi_comm_8_c_source.html#l00121">MpiComm.C:121</a></div></div>
<div class="ttc" id="class_q_u_e_s_o_1_1_base_environment_html_a78b57112bbd0e6dd0e8afec00b40ffa7"><div class="ttname"><a href="class_q_u_e_s_o_1_1_base_environment.html#a78b57112bbd0e6dd0e8afec00b40ffa7">QUESO::BaseEnvironment::worldRank</a></div><div class="ttdeci">int worldRank() const </div><div class="ttdoc">Returns the process world rank. </div><div class="ttdef"><b>Definition:</b> <a href="_environment_8_c_source.html#l00235">Environment.C:235</a></div></div>
<div class="ttc" id="class_q_u_e_s_o_1_1_mpi_comm_html_a4059971c30e023b272fccaa6aa00c426"><div class="ttname"><a href="class_q_u_e_s_o_1_1_mpi_comm.html#a4059971c30e023b272fccaa6aa00c426">QUESO::MpiComm::Barrier</a></div><div class="ttdeci">void Barrier() const </div><div class="ttdoc">Pause every process in *this communicator until all the processes reach this point. </div><div class="ttdef"><b>Definition:</b> <a href="_mpi_comm_8_c_source.html#l00143">MpiComm.C:143</a></div></div>
<div class="ttc" id="class_q_u_e_s_o_1_1_base_environment_html_a0b0779b41ff304058856e97e1d16b4d4"><div class="ttname"><a href="class_q_u_e_s_o_1_1_base_environment.html#a0b0779b41ff304058856e97e1d16b4d4">QUESO::BaseEnvironment::fullComm</a></div><div class="ttdeci">const MpiComm &amp; fullComm() const </div><div class="ttdoc">Access function for MpiComm full communicator. </div><div class="ttdef"><b>Definition:</b> <a href="_environment_8_c_source.html#l00247">Environment.C:247</a></div></div>
<div class="ttc" id="class_q_u_e_s_o_1_1_mpi_comm_html_a184a5e411afcfb6dc41e99fca9435045"><div class="ttname"><a href="class_q_u_e_s_o_1_1_mpi_comm.html#a184a5e411afcfb6dc41e99fca9435045">QUESO::MpiComm::Gather</a></div><div class="ttdeci">void Gather(void *sendbuf, int sendcnt, RawType_MPI_Datatype sendtype, void *recvbuf, int recvcount, RawType_MPI_Datatype recvtype, int root, const char *whereMsg, const char *whatMsg) const </div><div class="ttdoc">Gather values from each process to collect on all processes. </div><div class="ttdef"><b>Definition:</b> <a href="_mpi_comm_8_c_source.html#l00168">MpiComm.C:168</a></div></div>
<div class="ttc" id="class_q_u_e_s_o_1_1_m_l_sampling_html_af9416874c856e50f3b35270e801f17e4"><div class="ttname"><a href="class_q_u_e_s_o_1_1_m_l_sampling.html#af9416874c856e50f3b35270e801f17e4">QUESO::MLSampling::m_currLevel</a></div><div class="ttdeci">unsigned int m_currLevel</div><div class="ttdoc">Current level. </div><div class="ttdef"><b>Definition:</b> <a href="_m_l_sampling_8h_source.html#l00464">MLSampling.h:464</a></div></div>
<div class="ttc" id="_m_l_sampling_level_options_8h_html_a68d15eaf394d210effcf584b938206d3"><div class="ttname"><a href="_m_l_sampling_level_options_8h.html#a68d15eaf394d210effcf584b938206d3">LEVEL_REF_ID</a></div><div class="ttdeci">#define LEVEL_REF_ID</div><div class="ttdef"><b>Definition:</b> <a href="_m_l_sampling_level_options_8h_source.html#l00028">MLSamplingLevelOptions.h:28</a></div></div>
<div class="ttc" id="class_q_u_e_s_o_1_1_mpi_comm_html_abd6af8db8b0c7fd2f5b62e26477a9537"><div class="ttname"><a href="class_q_u_e_s_o_1_1_mpi_comm.html#abd6af8db8b0c7fd2f5b62e26477a9537">QUESO::MpiComm::Bcast</a></div><div class="ttdeci">void Bcast(void *buffer, int count, RawType_MPI_Datatype datatype, int root, const char *whereMsg, const char *whatMsg) const </div><div class="ttdoc">Broadcast values from the root process to the slave processes. </div><div class="ttdef"><b>Definition:</b> <a href="_mpi_comm_8_c_source.html#l00157">MpiComm.C:157</a></div></div>
<div class="ttc" id="class_q_u_e_s_o_1_1_base_environment_html_ae106b5bb8a80b655b88b3a26b1e7c185"><div class="ttname"><a href="class_q_u_e_s_o_1_1_base_environment.html#ae106b5bb8a80b655b88b3a26b1e7c185">QUESO::BaseEnvironment::inter0Rank</a></div><div class="ttdeci">int inter0Rank() const </div><div class="ttdoc">Returns the process inter0 rank. </div><div class="ttdef"><b>Definition:</b> <a href="_environment_8_c_source.html#l00289">Environment.C:289</a></div></div>
<div class="ttc" id="_defines_8h_html_a56d63d18d0a6d45757de47fcc06f574d"><div class="ttname"><a href="_defines_8h.html#a56d63d18d0a6d45757de47fcc06f574d">UQ_FATAL_TEST_MACRO</a></div><div class="ttdeci">#define UQ_FATAL_TEST_MACRO(test, givenRank, where, what)</div><div class="ttdef"><b>Definition:</b> <a href="_defines_8h_source.html#l00222">Defines.h:222</a></div></div>
<div class="ttc" id="_mpi_comm_8h_html_a06cbfbc33436f6e0dc8a48ff3c49bdfc"><div class="ttname"><a href="_mpi_comm_8h.html#a06cbfbc33436f6e0dc8a48ff3c49bdfc">RawValue_MPI_UNSIGNED</a></div><div class="ttdeci">#define RawValue_MPI_UNSIGNED</div><div class="ttdef"><b>Definition:</b> <a href="_mpi_comm_8h_source.html#l00049">MpiComm.h:49</a></div></div>
<div class="ttc" id="class_q_u_e_s_o_1_1_m_l_sampling_html_a1b1f8ccb4823bdfa26ec652f0807c63e"><div class="ttname"><a href="class_q_u_e_s_o_1_1_m_l_sampling.html#a1b1f8ccb4823bdfa26ec652f0807c63e">QUESO::MLSampling::m_currStep</a></div><div class="ttdeci">unsigned int m_currStep</div><div class="ttdoc">Curret step. </div><div class="ttdef"><b>Definition:</b> <a href="_m_l_sampling_8h_source.html#l00467">MLSampling.h:467</a></div></div>
<div class="ttc" id="class_q_u_e_s_o_1_1_base_environment_html_a1fe5f244fc0316a0ab3e37463f108b96"><div class="ttname"><a href="class_q_u_e_s_o_1_1_base_environment.html#a1fe5f244fc0316a0ab3e37463f108b96">QUESO::BaseEnvironment::displayVerbosity</a></div><div class="ttdeci">unsigned int displayVerbosity() const </div><div class="ttdef"><b>Definition:</b> <a href="_environment_8_c_source.html#l00436">Environment.C:436</a></div></div>
<div class="ttc" id="class_q_u_e_s_o_1_1_base_environment_html_a8a0064746ae8dddfece4229b9ad374d6"><div class="ttname"><a href="class_q_u_e_s_o_1_1_base_environment.html#a8a0064746ae8dddfece4229b9ad374d6">QUESO::BaseEnvironment::subDisplayFile</a></div><div class="ttdeci">std::ofstream * subDisplayFile() const </div><div class="ttdoc">Access function for m_subDisplayFile (displays file on stream). </div><div class="ttdef"><b>Definition:</b> <a href="_environment_8_c_source.html#l00305">Environment.C:305</a></div></div>
<div class="ttc" id="class_q_u_e_s_o_1_1_base_environment_html_a689e4d140c74d495d97eb498714a4b82"><div class="ttname"><a href="class_q_u_e_s_o_1_1_base_environment.html#a689e4d140c74d495d97eb498714a4b82">QUESO::BaseEnvironment::inter0Comm</a></div><div class="ttdeci">const MpiComm &amp; inter0Comm() const </div><div class="ttdoc">Access function for MpiComm inter0-communicator. </div><div class="ttdef"><b>Definition:</b> <a href="_environment_8_c_source.html#l00295">Environment.C:295</a></div></div>
<div class="ttc" id="class_q_u_e_s_o_1_1_base_environment_html_ac0345f57e31ef7833e379ed972bd094d"><div class="ttname"><a href="class_q_u_e_s_o_1_1_base_environment.html#ac0345f57e31ef7833e379ed972bd094d">QUESO::BaseEnvironment::numSubEnvironments</a></div><div class="ttdeci">unsigned int numSubEnvironments() const </div><div class="ttdoc">Access function to the number of sub-environments. </div><div class="ttdef"><b>Definition:</b> <a href="_environment_8_c_source.html#l00319">Environment.C:319</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a31f7f977a3d42a06fdcd2918cc31bb40"></a>
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;class P_V , class P_M &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">double <a class="el" href="class_q_u_e_s_o_1_1_m_l_sampling.html">QUESO::MLSampling</a>&lt; P_V, P_M &gt;::eig </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calculates the expected information gain value, EIG. </p>
<p>The expected information gain is defined as the expected log ratio between the posterior and prior distribution for the parameters in the statistical model. Recalling the Bayes formula: </p>
<p class="formulaDsp">
<img class="formulaDsp" alt="\[ \pi (\theta|D, M_j) = \frac{f(D|\theta, M_j) \cdot \pi (\theta | M_j)}{\pi(D, M_j)} \]" src="form_129.png"/>
</p>
<p> where <img class="formulaInl" alt="$ \pi (\theta|D, M_j) $" src="form_130.png"/> is the posterior PDF, <img class="formulaInl" alt="$ \pi (\theta | M_j) $" src="form_131.png"/> is the prior, <img class="formulaInl" alt="$ f(D|\theta, M_j)$" src="form_132.png"/> is the likelihood function and <img class="formulaInl" alt="$ \pi(D, M_j) $" src="form_133.png"/> is the evidence for a given set of parameters <img class="formulaInl" alt="$ \theta $" src="form_134.png"/>, data <img class="formulaInl" alt="$ D $" src="form_135.png"/> and model class <img class="formulaInl" alt="$ M_j $" src="form_136.png"/>. Then the EIG can be calculated as: </p>
<p class="formulaDsp">
<img class="formulaDsp" alt="\[ EIG = log \left(\frac{ \pi (\theta|D, M_j)}{\pi (\theta | M_j) } \right) = log \left(\frac{f(D|\theta, M_j) }{\pi(D, M_j)} \right) = log \left(\frac{f(D|\theta, M_j) }{\pi(D, M_j)} \right) = log \left(f(D|\theta, M_j)\right) - log\left(f(D|\theta, M_j) \right) \]" src="form_137.png"/>
</p>
<dl class="section see"><dt>See Also</dt><dd>Long, Quan and Scavino, Marco and Tempone, Raul and Wang, Suojin, Fast estimation of expected information gains for Bayesian experimental designs based on Laplace approximations. Computer Methods In Applied Mechanics And Engineering, 259:24-39,2013. DOI = 10.1016/j.cma.2013.02.017. </dd></dl>

<p>Definition at line <a class="el" href="_m_l_sampling_8_c_source.html#l04884">4884</a> of file <a class="el" href="_m_l_sampling_8_c_source.html">MLSampling.C</a>.</p>
<div class="fragment"><div class="line"><a name="l04885"></a><span class="lineno"> 4885</span>&#160;{</div>
<div class="line"><a name="l04886"></a><span class="lineno"> 4886</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#abec7f8cf9da08bc5c0a20d99fa4570af">m_eig</a>;</div>
<div class="line"><a name="l04887"></a><span class="lineno"> 4887</span>&#160;}</div>
<div class="ttc" id="class_q_u_e_s_o_1_1_m_l_sampling_html_abec7f8cf9da08bc5c0a20d99fa4570af"><div class="ttname"><a href="class_q_u_e_s_o_1_1_m_l_sampling.html#abec7f8cf9da08bc5c0a20d99fa4570af">QUESO::MLSampling::m_eig</a></div><div class="ttdeci">double m_eig</div><div class="ttdef"><b>Definition:</b> <a href="_m_l_sampling_8h_source.html#l00474">MLSampling.h:474</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a8e9d7681d17623c726814d206c8be4b2"></a>
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;class P_V , class P_M &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="class_q_u_e_s_o_1_1_m_l_sampling.html">QUESO::MLSampling</a>&lt; P_V, P_M &gt;::generateBalLinkedChains_all </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_q_u_e_s_o_1_1_m_l_sampling_level_options.html">MLSamplingLevelOptions</a> &amp;&#160;</td>
          <td class="paramname"><em>inputOptions</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const P_M &amp;&#160;</td>
          <td class="paramname"><em>unifiedCovMatrix</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="class_q_u_e_s_o_1_1_generic_vector_r_v.html">GenericVectorRV</a>&lt; P_V, P_M &gt; &amp;&#160;</td>
          <td class="paramname"><em>rv</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="struct_q_u_e_s_o_1_1_balanced_linked_chains_per_node_struct.html">BalancedLinkedChainsPerNodeStruct</a>&lt; P_V &gt; &amp;&#160;</td>
          <td class="paramname"><em>balancedLinkControl</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_q_u_e_s_o_1_1_sequence_of_vectors.html">SequenceOfVectors</a>&lt; P_V, P_M &gt; &amp;&#160;</td>
          <td class="paramname"><em>workingChain</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double &amp;&#160;</td>
          <td class="paramname"><em>cumulativeRunTime</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned int &amp;&#160;</td>
          <td class="paramname"><em>cumulativeRejections</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_q_u_e_s_o_1_1_scalar_sequence.html">ScalarSequence</a>&lt; double &gt; *&#160;</td>
          <td class="paramname"><em>currLogLikelihoodValues</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_q_u_e_s_o_1_1_scalar_sequence.html">ScalarSequence</a>&lt; double &gt; *&#160;</td>
          <td class="paramname"><em>currLogTargetValues</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">inputOptions,unifiedCovMatrix,rv,balancedLinkControl,@param[out]</td><td>workingChain, cumulativeRunTime, cumulativeRejections, currLogLikelihoodValues, currLogTargetValues </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="_m_l_sampling_8_c_source.html#l00656">656</a> of file <a class="el" href="_m_l_sampling_8_c_source.html">MLSampling.C</a>.</p>

<p>References <a class="el" href="_vector_sequence_8_c_source.html#l00357">QUESO::BaseVectorSequence&lt; V, M &gt;::append()</a>, <a class="el" href="_scalar_sequence_8_c_source.html#l02649">QUESO::ScalarSequence&lt; T &gt;::append()</a>, <a class="el" href="_m_l_sampling_8h_source.html#l00084">QUESO::BalancedLinkedChainsPerNodeStruct&lt; P_V &gt;::balLinkedChains</a>, <a class="el" href="_metropolis_hastings_s_g_8_c_source.html#l00811">QUESO::MetropolisHastingsSG&lt; P_V, P_M &gt;::generateSequence()</a>, <a class="el" href="_sequence_of_vectors_8_c_source.html#l00197">QUESO::SequenceOfVectors&lt; V, M &gt;::getPositionValues()</a>, <a class="el" href="_metropolis_hastings_s_g_8_c_source.html#l01250">QUESO::MetropolisHastingsSG&lt; P_V, P_M &gt;::getRawChainInfo()</a>, <a class="el" href="_m_l_sampling_level_options_8h_source.html#l00028">LEVEL_REF_ID</a>, <a class="el" href="_m_l_sampling_level_options_8h_source.html#l00222">QUESO::MLSamplingLevelOptions::m_rawChainSize</a>, <a class="el" href="_miscellaneous_8_c_source.html#l00287">QUESO::MiscGetEllapsedSeconds()</a>, <a class="el" href="_metropolis_hastings_s_g_8h_source.html#l00102">QUESO::MHRawChainInfoStruct::numRejections</a>, <a class="el" href="_mpi_comm_8h_source.html#l00051">RawValue_MPI_MAX</a>, <a class="el" href="_mpi_comm_8h_source.html#l00050">RawValue_MPI_MIN</a>, <a class="el" href="_mpi_comm_8h_source.html#l00052">RawValue_MPI_SUM</a>, <a class="el" href="_mpi_comm_8h_source.html#l00049">RawValue_MPI_UNSIGNED</a>, <a class="el" href="_metropolis_hastings_s_g_8h_source.html#l00090">QUESO::MHRawChainInfoStruct::runTime</a>, <a class="el" href="_sequence_of_vectors_8_c_source.html#l00103">QUESO::SequenceOfVectors&lt; V, M &gt;::subSequenceSize()</a>, and <a class="el" href="_scalar_sequence_8_c_source.html#l00141">QUESO::ScalarSequence&lt; T &gt;::subSequenceSize()</a>.</p>
<div class="fragment"><div class="line"><a name="l00666"></a><span class="lineno">  666</span>&#160;{</div>
<div class="line"><a name="l00667"></a><span class="lineno">  667</span>&#160;  <a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#a0b0779b41ff304058856e97e1d16b4d4">fullComm</a>().<a class="code" href="class_q_u_e_s_o_1_1_mpi_comm.html#a4059971c30e023b272fccaa6aa00c426">Barrier</a>();</div>
<div class="line"><a name="l00668"></a><span class="lineno">  668</span>&#160;</div>
<div class="line"><a name="l00669"></a><span class="lineno">  669</span>&#160;  <span class="keywordflow">if</span> ((<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#a8a0064746ae8dddfece4229b9ad374d6">subDisplayFile</a>()) &amp;&amp; (<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#a1fe5f244fc0316a0ab3e37463f108b96">displayVerbosity</a>() &gt;= 0)) {</div>
<div class="line"><a name="l00670"></a><span class="lineno">  670</span>&#160;    *<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#a8a0064746ae8dddfece4229b9ad374d6">subDisplayFile</a>() &lt;&lt; <span class="stringliteral">&quot;Entering MLSampling&lt;P_V,P_M&gt;::generateBalLinkedChains_all()&quot;</span></div>
<div class="line"><a name="l00671"></a><span class="lineno">  671</span>&#160;                            &lt;&lt; <span class="stringliteral">&quot;: balancedLinkControl.balLinkedChains.size() = &quot;</span> &lt;&lt; balancedLinkControl.balLinkedChains.size()</div>
<div class="line"><a name="l00672"></a><span class="lineno">  672</span>&#160;                            &lt;&lt; std::endl;</div>
<div class="line"><a name="l00673"></a><span class="lineno">  673</span>&#160;  }</div>
<div class="line"><a name="l00674"></a><span class="lineno">  674</span>&#160;</div>
<div class="line"><a name="l00675"></a><span class="lineno">  675</span>&#160;  P_V auxInitialPosition(<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a7bc4c72f65ba9166ed94a6e198b0915b">m_vectorSpace</a>.<a class="code" href="class_q_u_e_s_o_1_1_vector_space.html#a92e963bb5cab3eecd290dfe4b8f03b04">zeroVector</a>());</div>
<div class="line"><a name="l00676"></a><span class="lineno">  676</span>&#160;</div>
<div class="line"><a name="l00677"></a><span class="lineno">  677</span>&#160;  <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> chainIdMax = 0;</div>
<div class="line"><a name="l00678"></a><span class="lineno">  678</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#ae106b5bb8a80b655b88b3a26b1e7c185">inter0Rank</a>() &gt;= 0) {</div>
<div class="line"><a name="l00679"></a><span class="lineno">  679</span>&#160;    chainIdMax = balancedLinkControl.balLinkedChains.size();</div>
<div class="line"><a name="l00680"></a><span class="lineno">  680</span>&#160;  }</div>
<div class="line"><a name="l00681"></a><span class="lineno">  681</span>&#160;  <span class="comment">// KAUST: all nodes in &#39;subComm&#39; should have the same &#39;chainIdMax&#39;</span></div>
<div class="line"><a name="l00682"></a><span class="lineno">  682</span>&#160;  <a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#affe39f53e3d5d678842413370af09145">subComm</a>().<a class="code" href="class_q_u_e_s_o_1_1_mpi_comm.html#abd6af8db8b0c7fd2f5b62e26477a9537">Bcast</a>((<span class="keywordtype">void</span> *) &amp;chainIdMax, (<span class="keywordtype">int</span>) 1, <a class="code" href="_mpi_comm_8h.html#a06cbfbc33436f6e0dc8a48ff3c49bdfc">RawValue_MPI_UNSIGNED</a>, 0, <span class="comment">// Yes, &#39;subComm&#39;, important // LOAD BALANCE</span></div>
<div class="line"><a name="l00683"></a><span class="lineno">  683</span>&#160;                        <span class="stringliteral">&quot;MLSampling&lt;P_V,P_M&gt;::generateBalLinkedChains_all()&quot;</span>,</div>
<div class="line"><a name="l00684"></a><span class="lineno">  684</span>&#160;                        <span class="stringliteral">&quot;failed MPI.Bcast() for chainIdMax&quot;</span>);</div>
<div class="line"><a name="l00685"></a><span class="lineno">  685</span>&#160;</div>
<div class="line"><a name="l00686"></a><span class="lineno">  686</span>&#160;  <span class="keyword">struct </span>timeval timevalEntering;</div>
<div class="line"><a name="l00687"></a><span class="lineno">  687</span>&#160;  <span class="keywordtype">int</span> iRC = 0;</div>
<div class="line"><a name="l00688"></a><span class="lineno">  688</span>&#160;  iRC = gettimeofday(&amp;timevalEntering, NULL);</div>
<div class="line"><a name="l00689"></a><span class="lineno">  689</span>&#160;  <span class="keywordflow">if</span> (iRC) {}; <span class="comment">// just to remove compiler warning</span></div>
<div class="line"><a name="l00690"></a><span class="lineno">  690</span>&#160;</div>
<div class="line"><a name="l00691"></a><span class="lineno">  691</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#ae106b5bb8a80b655b88b3a26b1e7c185">inter0Rank</a>() &gt;= 0) {</div>
<div class="line"><a name="l00692"></a><span class="lineno">  692</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> numberOfPositions = 0;</div>
<div class="line"><a name="l00693"></a><span class="lineno">  693</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> chainId = 0; chainId &lt; chainIdMax; ++chainId) {</div>
<div class="line"><a name="l00694"></a><span class="lineno">  694</span>&#160;      numberOfPositions += balancedLinkControl.balLinkedChains[chainId].numberOfPositions;</div>
<div class="line"><a name="l00695"></a><span class="lineno">  695</span>&#160;    }</div>
<div class="line"><a name="l00696"></a><span class="lineno">  696</span>&#160;</div>
<div class="line"><a name="l00697"></a><span class="lineno">  697</span>&#160;    std::vector&lt;unsigned int&gt; auxBuf(1,0);</div>
<div class="line"><a name="l00698"></a><span class="lineno">  698</span>&#160;</div>
<div class="line"><a name="l00699"></a><span class="lineno">  699</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> minNumberOfPositions = 0;</div>
<div class="line"><a name="l00700"></a><span class="lineno">  700</span>&#160;    auxBuf[0] = numberOfPositions;</div>
<div class="line"><a name="l00701"></a><span class="lineno">  701</span>&#160;    <a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#a689e4d140c74d495d97eb498714a4b82">inter0Comm</a>().<a class="code" href="class_q_u_e_s_o_1_1_mpi_comm.html#a72e137e60ef8060efb1ee5fc874fa4b8">Allreduce</a>((<span class="keywordtype">void</span> *) &amp;auxBuf[0], (<span class="keywordtype">void</span> *) &amp;minNumberOfPositions, (<span class="keywordtype">int</span>) auxBuf.size(), <a class="code" href="_mpi_comm_8h.html#a06cbfbc33436f6e0dc8a48ff3c49bdfc">RawValue_MPI_UNSIGNED</a>, <a class="code" href="_mpi_comm_8h.html#a8e30f42fdac116861205e83e2aa18042">RawValue_MPI_MIN</a>, <span class="comment">// LOAD BALANCE</span></div>
<div class="line"><a name="l00702"></a><span class="lineno">  702</span>&#160;                                 <span class="stringliteral">&quot;MLSampling&lt;P_V,P_M&gt;::generateBalLinkedChains_all()&quot;</span>,</div>
<div class="line"><a name="l00703"></a><span class="lineno">  703</span>&#160;                                 <span class="stringliteral">&quot;failed MPI.Allreduce() for min&quot;</span>);</div>
<div class="line"><a name="l00704"></a><span class="lineno">  704</span>&#160;</div>
<div class="line"><a name="l00705"></a><span class="lineno">  705</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> maxNumberOfPositions = 0;</div>
<div class="line"><a name="l00706"></a><span class="lineno">  706</span>&#160;    auxBuf[0] = numberOfPositions;</div>
<div class="line"><a name="l00707"></a><span class="lineno">  707</span>&#160;    <a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#a689e4d140c74d495d97eb498714a4b82">inter0Comm</a>().<a class="code" href="class_q_u_e_s_o_1_1_mpi_comm.html#a72e137e60ef8060efb1ee5fc874fa4b8">Allreduce</a>((<span class="keywordtype">void</span> *) &amp;auxBuf[0], (<span class="keywordtype">void</span> *) &amp;maxNumberOfPositions, (<span class="keywordtype">int</span>) auxBuf.size(), <a class="code" href="_mpi_comm_8h.html#a06cbfbc33436f6e0dc8a48ff3c49bdfc">RawValue_MPI_UNSIGNED</a>, <a class="code" href="_mpi_comm_8h.html#a68f3ac7ff71a6504e236b0c95de78178">RawValue_MPI_MAX</a>, <span class="comment">// LOAD BALANCE</span></div>
<div class="line"><a name="l00708"></a><span class="lineno">  708</span>&#160;                                 <span class="stringliteral">&quot;MLSampling&lt;P_V,P_M&gt;::generateBalLinkedChains_all()&quot;</span>,</div>
<div class="line"><a name="l00709"></a><span class="lineno">  709</span>&#160;                                 <span class="stringliteral">&quot;failed MPI.Allreduce() for max&quot;</span>);</div>
<div class="line"><a name="l00710"></a><span class="lineno">  710</span>&#160;</div>
<div class="line"><a name="l00711"></a><span class="lineno">  711</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> sumNumberOfPositions = 0;</div>
<div class="line"><a name="l00712"></a><span class="lineno">  712</span>&#160;    auxBuf[0] = numberOfPositions;</div>
<div class="line"><a name="l00713"></a><span class="lineno">  713</span>&#160;    <a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#a689e4d140c74d495d97eb498714a4b82">inter0Comm</a>().<a class="code" href="class_q_u_e_s_o_1_1_mpi_comm.html#a72e137e60ef8060efb1ee5fc874fa4b8">Allreduce</a>((<span class="keywordtype">void</span> *) &amp;auxBuf[0], (<span class="keywordtype">void</span> *) &amp;sumNumberOfPositions, (<span class="keywordtype">int</span>) auxBuf.size(), <a class="code" href="_mpi_comm_8h.html#a06cbfbc33436f6e0dc8a48ff3c49bdfc">RawValue_MPI_UNSIGNED</a>, <a class="code" href="_mpi_comm_8h.html#afbf78d291c032aa7f512bc566cee2bd1">RawValue_MPI_SUM</a>, <span class="comment">// LOAD BALANCE</span></div>
<div class="line"><a name="l00714"></a><span class="lineno">  714</span>&#160;                                 <span class="stringliteral">&quot;MLSampling&lt;P_V,P_M&gt;::generateBalLinkedChains_all()&quot;</span>,</div>
<div class="line"><a name="l00715"></a><span class="lineno">  715</span>&#160;                                 <span class="stringliteral">&quot;failed MPI.Allreduce() for sum&quot;</span>);</div>
<div class="line"><a name="l00716"></a><span class="lineno">  716</span>&#160;</div>
<div class="line"><a name="l00717"></a><span class="lineno">  717</span>&#160;    <span class="keywordflow">if</span> ((<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#a8a0064746ae8dddfece4229b9ad374d6">subDisplayFile</a>()) &amp;&amp; (<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#a1fe5f244fc0316a0ab3e37463f108b96">displayVerbosity</a>() &gt;= 0)) {</div>
<div class="line"><a name="l00718"></a><span class="lineno">  718</span>&#160;      *<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#a8a0064746ae8dddfece4229b9ad374d6">subDisplayFile</a>() &lt;&lt; <span class="stringliteral">&quot;KEY In MLSampling&lt;P_V,P_M&gt;::generateBalLinkedChains_all()&quot;</span></div>
<div class="line"><a name="l00719"></a><span class="lineno">  719</span>&#160;                              &lt;&lt; <span class="stringliteral">&quot;, level &quot;</span>               &lt;&lt; <a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#af9416874c856e50f3b35270e801f17e4">m_currLevel</a>+<a class="code" href="_m_l_sampling_level_options_8h.html#a68d15eaf394d210effcf584b938206d3">LEVEL_REF_ID</a></div>
<div class="line"><a name="l00720"></a><span class="lineno">  720</span>&#160;                              &lt;&lt; <span class="stringliteral">&quot;, step &quot;</span>                &lt;&lt; <a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a1b1f8ccb4823bdfa26ec652f0807c63e">m_currStep</a></div>
<div class="line"><a name="l00721"></a><span class="lineno">  721</span>&#160;                              &lt;&lt; <span class="stringliteral">&quot;: chainIdMax = &quot;</span>        &lt;&lt; chainIdMax</div>
<div class="line"><a name="l00722"></a><span class="lineno">  722</span>&#160;                              &lt;&lt; <span class="stringliteral">&quot;, numberOfPositions = &quot;</span> &lt;&lt; numberOfPositions</div>
<div class="line"><a name="l00723"></a><span class="lineno">  723</span>&#160;                              &lt;&lt; <span class="stringliteral">&quot;, at &quot;</span>                  &lt;&lt; ctime(&amp;timevalEntering.tv_sec)</div>
<div class="line"><a name="l00724"></a><span class="lineno">  724</span>&#160;                              &lt;&lt; std::endl;</div>
<div class="line"><a name="l00725"></a><span class="lineno">  725</span>&#160;      *<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#a8a0064746ae8dddfece4229b9ad374d6">subDisplayFile</a>() &lt;&lt; <span class="stringliteral">&quot;KEY In MLSampling&lt;P_V,P_M&gt;::generateBalLinkedChains_all()&quot;</span></div>
<div class="line"><a name="l00726"></a><span class="lineno">  726</span>&#160;                              &lt;&lt; <span class="stringliteral">&quot;, level &quot;</span>                  &lt;&lt; <a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#af9416874c856e50f3b35270e801f17e4">m_currLevel</a>+<a class="code" href="_m_l_sampling_level_options_8h.html#a68d15eaf394d210effcf584b938206d3">LEVEL_REF_ID</a></div>
<div class="line"><a name="l00727"></a><span class="lineno">  727</span>&#160;                              &lt;&lt; <span class="stringliteral">&quot;, step &quot;</span>                   &lt;&lt; <a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a1b1f8ccb4823bdfa26ec652f0807c63e">m_currStep</a></div>
<div class="line"><a name="l00728"></a><span class="lineno">  728</span>&#160;                              &lt;&lt; <span class="stringliteral">&quot;: minNumberOfPositions = &quot;</span> &lt;&lt; minNumberOfPositions</div>
<div class="line"><a name="l00729"></a><span class="lineno">  729</span>&#160;                              &lt;&lt; <span class="stringliteral">&quot;, avgNumberOfPositions = &quot;</span> &lt;&lt; ((double) sumNumberOfPositions)/((double) <a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#a689e4d140c74d495d97eb498714a4b82">inter0Comm</a>().<a class="code" href="class_q_u_e_s_o_1_1_mpi_comm.html#aa780721ae0fdeabc5a15e04cb0cad964">NumProc</a>())</div>
<div class="line"><a name="l00730"></a><span class="lineno">  730</span>&#160;                              &lt;&lt; <span class="stringliteral">&quot;, maxNumberOfPositions = &quot;</span> &lt;&lt; maxNumberOfPositions</div>
<div class="line"><a name="l00731"></a><span class="lineno">  731</span>&#160;                              &lt;&lt; std::endl;</div>
<div class="line"><a name="l00732"></a><span class="lineno">  732</span>&#160;    }</div>
<div class="line"><a name="l00733"></a><span class="lineno">  733</span>&#160;</div>
<div class="line"><a name="l00734"></a><span class="lineno">  734</span>&#160;    <span class="comment">// 2013-02-23: print sizes, and expected final size</span></div>
<div class="line"><a name="l00735"></a><span class="lineno">  735</span>&#160;  }</div>
<div class="line"><a name="l00736"></a><span class="lineno">  736</span>&#160;  <span class="keywordflow">if</span> ((<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#abdd5cd35419283c33cc40a77d0f4f07f">m_debugExponent</a> == 1.) &amp;&amp;</div>
<div class="line"><a name="l00737"></a><span class="lineno">  737</span>&#160;      (<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a1b1f8ccb4823bdfa26ec652f0807c63e">m_currStep</a>      == 10)) {</div>
<div class="line"><a name="l00738"></a><span class="lineno">  738</span>&#160;    <span class="comment">//m_env.setExceptionalCircumstance(true);</span></div>
<div class="line"><a name="l00739"></a><span class="lineno">  739</span>&#160;  }</div>
<div class="line"><a name="l00740"></a><span class="lineno">  740</span>&#160;  <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> cumulativeNumPositions = 0;</div>
<div class="line"><a name="l00741"></a><span class="lineno">  741</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> chainId = 0; chainId &lt; chainIdMax; ++chainId) {</div>
<div class="line"><a name="l00742"></a><span class="lineno">  742</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> tmpChainSize = 0;</div>
<div class="line"><a name="l00743"></a><span class="lineno">  743</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#ae106b5bb8a80b655b88b3a26b1e7c185">inter0Rank</a>() &gt;= 0) {</div>
<div class="line"><a name="l00744"></a><span class="lineno">  744</span>&#160;      <span class="comment">// aqui 4</span></div>
<div class="line"><a name="l00745"></a><span class="lineno">  745</span>&#160;      auxInitialPosition = *(balancedLinkControl.balLinkedChains[chainId].initialPosition); <span class="comment">// Round Rock</span></div>
<div class="line"><a name="l00746"></a><span class="lineno">  746</span>&#160;      tmpChainSize = balancedLinkControl.balLinkedChains[chainId].numberOfPositions+1; <span class="comment">// IMPORTANT: &#39;+1&#39; in order to discard initial position afterwards</span></div>
<div class="line"><a name="l00747"></a><span class="lineno">  747</span>&#160;      <span class="keywordflow">if</span> ((<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#a8a0064746ae8dddfece4229b9ad374d6">subDisplayFile</a>()       ) &amp;&amp;</div>
<div class="line"><a name="l00748"></a><span class="lineno">  748</span>&#160;          (<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#a1fe5f244fc0316a0ab3e37463f108b96">displayVerbosity</a>() &gt;= 3)) {</div>
<div class="line"><a name="l00749"></a><span class="lineno">  749</span>&#160;        *<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#a8a0064746ae8dddfece4229b9ad374d6">subDisplayFile</a>() &lt;&lt; <span class="stringliteral">&quot;In MLSampling&lt;P_V,P_M&gt;::generateBalLinkedChains_all()&quot;</span></div>
<div class="line"><a name="l00750"></a><span class="lineno">  750</span>&#160;                                &lt;&lt; <span class="stringliteral">&quot;, level &quot;</span>            &lt;&lt; <a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#af9416874c856e50f3b35270e801f17e4">m_currLevel</a>+<a class="code" href="_m_l_sampling_level_options_8h.html#a68d15eaf394d210effcf584b938206d3">LEVEL_REF_ID</a></div>
<div class="line"><a name="l00751"></a><span class="lineno">  751</span>&#160;                                &lt;&lt; <span class="stringliteral">&quot;, step &quot;</span>             &lt;&lt; <a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a1b1f8ccb4823bdfa26ec652f0807c63e">m_currStep</a></div>
<div class="line"><a name="l00752"></a><span class="lineno">  752</span>&#160;                                &lt;&lt; <span class="stringliteral">&quot;, chainId = &quot;</span>        &lt;&lt; chainId</div>
<div class="line"><a name="l00753"></a><span class="lineno">  753</span>&#160;                                &lt;&lt; <span class="stringliteral">&quot; &lt; &quot;</span>                 &lt;&lt; chainIdMax</div>
<div class="line"><a name="l00754"></a><span class="lineno">  754</span>&#160;                                &lt;&lt; <span class="stringliteral">&quot;: begin generating &quot;</span> &lt;&lt; tmpChainSize</div>
<div class="line"><a name="l00755"></a><span class="lineno">  755</span>&#160;                                &lt;&lt; <span class="stringliteral">&quot; chain positions&quot;</span></div>
<div class="line"><a name="l00756"></a><span class="lineno">  756</span>&#160;                                &lt;&lt; std::endl;</div>
<div class="line"><a name="l00757"></a><span class="lineno">  757</span>&#160;      }</div>
<div class="line"><a name="l00758"></a><span class="lineno">  758</span>&#160;    }</div>
<div class="line"><a name="l00759"></a><span class="lineno">  759</span>&#160;    auxInitialPosition.mpiBcast(0, <a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#affe39f53e3d5d678842413370af09145">subComm</a>()); <span class="comment">// Yes, &#39;subComm&#39;, important // KAUST</span></div>
<div class="line"><a name="l00760"></a><span class="lineno">  760</span>&#160;<span class="preprocessor">#if 0 // For debug only</span></div>
<div class="line"><a name="l00761"></a><span class="lineno">  761</span>&#160;<span class="preprocessor"></span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> r = 0; r &lt; <a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#affe39f53e3d5d678842413370af09145">subComm</a>().<a class="code" href="class_q_u_e_s_o_1_1_mpi_comm.html#aa780721ae0fdeabc5a15e04cb0cad964">NumProc</a>(); ++r) {</div>
<div class="line"><a name="l00762"></a><span class="lineno">  762</span>&#160;      <span class="keywordflow">if</span> (r == <a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#affe39f53e3d5d678842413370af09145">subComm</a>().<a class="code" href="class_q_u_e_s_o_1_1_mpi_comm.html#ab806f80f206210723fcb4df8185a55a8">MyPID</a>()) {</div>
<div class="line"><a name="l00763"></a><span class="lineno">  763</span>&#160;  std::cout &lt;&lt; <span class="stringliteral">&quot;Vector &#39;auxInitialPosition at rank &quot;</span> &lt;&lt; r</div>
<div class="line"><a name="l00764"></a><span class="lineno">  764</span>&#160;                  &lt;&lt; <span class="stringliteral">&quot; has contents &quot;</span>                      &lt;&lt; auxInitialPosition</div>
<div class="line"><a name="l00765"></a><span class="lineno">  765</span>&#160;                  &lt;&lt; std::endl;</div>
<div class="line"><a name="l00766"></a><span class="lineno">  766</span>&#160;      }</div>
<div class="line"><a name="l00767"></a><span class="lineno">  767</span>&#160;      <a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#affe39f53e3d5d678842413370af09145">subComm</a>().<a class="code" href="class_q_u_e_s_o_1_1_mpi_comm.html#a4059971c30e023b272fccaa6aa00c426">Barrier</a>();</div>
<div class="line"><a name="l00768"></a><span class="lineno">  768</span>&#160;    }</div>
<div class="line"><a name="l00769"></a><span class="lineno">  769</span>&#160;    sleep(1);</div>
<div class="line"><a name="l00770"></a><span class="lineno">  770</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00771"></a><span class="lineno">  771</span>&#160;<span class="preprocessor"></span></div>
<div class="line"><a name="l00772"></a><span class="lineno">  772</span>&#160;    <span class="comment">// KAUST: all nodes in &#39;subComm&#39; should have the same &#39;tmpChainSize&#39;</span></div>
<div class="line"><a name="l00773"></a><span class="lineno">  773</span>&#160;    <a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#affe39f53e3d5d678842413370af09145">subComm</a>().<a class="code" href="class_q_u_e_s_o_1_1_mpi_comm.html#abd6af8db8b0c7fd2f5b62e26477a9537">Bcast</a>((<span class="keywordtype">void</span> *) &amp;tmpChainSize, (<span class="keywordtype">int</span>) 1, <a class="code" href="_mpi_comm_8h.html#a06cbfbc33436f6e0dc8a48ff3c49bdfc">RawValue_MPI_UNSIGNED</a>, 0, <span class="comment">// Yes, &#39;subComm&#39;, important // LOAD BALANCE</span></div>
<div class="line"><a name="l00774"></a><span class="lineno">  774</span>&#160;                          <span class="stringliteral">&quot;MLSampling&lt;P_V,P_M&gt;::generateBalLinkedChains_all()&quot;</span>,</div>
<div class="line"><a name="l00775"></a><span class="lineno">  775</span>&#160;                          <span class="stringliteral">&quot;failed MPI.Bcast() for tmpChainSize&quot;</span>);</div>
<div class="line"><a name="l00776"></a><span class="lineno">  776</span>&#160;</div>
<div class="line"><a name="l00777"></a><span class="lineno">  777</span>&#160;    inputOptions.m_rawChainSize = tmpChainSize;</div>
<div class="line"><a name="l00778"></a><span class="lineno">  778</span>&#160;    SequenceOfVectors&lt;P_V,P_M&gt; tmpChain(<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a7bc4c72f65ba9166ed94a6e198b0915b">m_vectorSpace</a>,</div>
<div class="line"><a name="l00779"></a><span class="lineno">  779</span>&#160;                                               0,</div>
<div class="line"><a name="l00780"></a><span class="lineno">  780</span>&#160;                                               <a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#af8504cc57ec72b3c52833826b2bfff8e">m_options</a>.<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling_options.html#a1d3d48598e0b59b46337ce66a52671a5">m_prefix</a>+<span class="stringliteral">&quot;tmp_chain&quot;</span>);</div>
<div class="line"><a name="l00781"></a><span class="lineno">  781</span>&#160;    ScalarSequence&lt;double&gt; tmpLogLikelihoodValues(<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>,0,<span class="stringliteral">&quot;&quot;</span>);</div>
<div class="line"><a name="l00782"></a><span class="lineno">  782</span>&#160;    ScalarSequence&lt;double&gt; tmpLogTargetValues    (<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>,0,<span class="stringliteral">&quot;&quot;</span>);</div>
<div class="line"><a name="l00783"></a><span class="lineno">  783</span>&#160;</div>
<div class="line"><a name="l00784"></a><span class="lineno">  784</span>&#160;    <span class="comment">// KAUST: all nodes should call here</span></div>
<div class="line"><a name="l00785"></a><span class="lineno">  785</span>&#160;    MetropolisHastingsSG&lt;P_V,P_M&gt; mcSeqGenerator(inputOptions,</div>
<div class="line"><a name="l00786"></a><span class="lineno">  786</span>&#160;                                                        rv,</div>
<div class="line"><a name="l00787"></a><span class="lineno">  787</span>&#160;                                                        auxInitialPosition, <span class="comment">// KEY new: pass logPrior and logLikelihood</span></div>
<div class="line"><a name="l00788"></a><span class="lineno">  788</span>&#160;                                                        &amp;unifiedCovMatrix);</div>
<div class="line"><a name="l00789"></a><span class="lineno">  789</span>&#160;</div>
<div class="line"><a name="l00790"></a><span class="lineno">  790</span>&#160;    <span class="comment">// KAUST: all nodes should call here</span></div>
<div class="line"><a name="l00791"></a><span class="lineno">  791</span>&#160;    mcSeqGenerator.generateSequence(tmpChain,</div>
<div class="line"><a name="l00792"></a><span class="lineno">  792</span>&#160;                                    &amp;tmpLogLikelihoodValues, <span class="comment">// likelihood is IMPORTANT</span></div>
<div class="line"><a name="l00793"></a><span class="lineno">  793</span>&#160;                                    &amp;tmpLogTargetValues);</div>
<div class="line"><a name="l00794"></a><span class="lineno">  794</span>&#160;    MHRawChainInfoStruct mcRawInfo;</div>
<div class="line"><a name="l00795"></a><span class="lineno">  795</span>&#160;    mcSeqGenerator.getRawChainInfo(mcRawInfo);</div>
<div class="line"><a name="l00796"></a><span class="lineno">  796</span>&#160;    cumulativeRunTime    += mcRawInfo.runTime;</div>
<div class="line"><a name="l00797"></a><span class="lineno">  797</span>&#160;    cumulativeRejections += mcRawInfo.numRejections;</div>
<div class="line"><a name="l00798"></a><span class="lineno">  798</span>&#160;</div>
<div class="line"><a name="l00799"></a><span class="lineno">  799</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#ae106b5bb8a80b655b88b3a26b1e7c185">inter0Rank</a>() &gt;= 0) {</div>
<div class="line"><a name="l00800"></a><span class="lineno">  800</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#af0bc451b18302cfd5ee747c321e1c6e5">exceptionalCircumstance</a>()) {</div>
<div class="line"><a name="l00801"></a><span class="lineno">  801</span>&#160;        <span class="keywordflow">if</span> ((<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#a8a0064746ae8dddfece4229b9ad374d6">subDisplayFile</a>()       ) &amp;&amp;</div>
<div class="line"><a name="l00802"></a><span class="lineno">  802</span>&#160;            (<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#a1fe5f244fc0316a0ab3e37463f108b96">displayVerbosity</a>() &gt;= 0)) { <span class="comment">// detailed output debug</span></div>
<div class="line"><a name="l00803"></a><span class="lineno">  803</span>&#160;          P_V tmpVec(<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a7bc4c72f65ba9166ed94a6e198b0915b">m_vectorSpace</a>.<a class="code" href="class_q_u_e_s_o_1_1_vector_space.html#a92e963bb5cab3eecd290dfe4b8f03b04">zeroVector</a>());</div>
<div class="line"><a name="l00804"></a><span class="lineno">  804</span>&#160;          <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = 0; i &lt; tmpLogLikelihoodValues.subSequenceSize(); ++i) {</div>
<div class="line"><a name="l00805"></a><span class="lineno">  805</span>&#160;            tmpChain.getPositionValues(i,tmpVec);</div>
<div class="line"><a name="l00806"></a><span class="lineno">  806</span>&#160;            *<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#a8a0064746ae8dddfece4229b9ad374d6">subDisplayFile</a>() &lt;&lt; <span class="stringliteral">&quot;DEBUG finalChain[&quot;</span> &lt;&lt; cumulativeNumPositions+i &lt;&lt; <span class="stringliteral">&quot;] &quot;</span></div>
<div class="line"><a name="l00807"></a><span class="lineno">  807</span>&#160;                                    &lt;&lt; <span class="stringliteral">&quot;= tmpChain[&quot;</span>               &lt;&lt; i &lt;&lt; <span class="stringliteral">&quot;] = &quot;</span> &lt;&lt; tmpVec</div>
<div class="line"><a name="l00808"></a><span class="lineno">  808</span>&#160;                                    &lt;&lt; <span class="stringliteral">&quot;, tmpLogLikelihoodValues[&quot;</span> &lt;&lt; i &lt;&lt; <span class="stringliteral">&quot;] = &quot;</span> &lt;&lt; tmpLogLikelihoodValues[i]</div>
<div class="line"><a name="l00809"></a><span class="lineno">  809</span>&#160;                                    &lt;&lt; <span class="stringliteral">&quot;, tmpLogTargetValues[&quot;</span>     &lt;&lt; i &lt;&lt; <span class="stringliteral">&quot;] = &quot;</span> &lt;&lt; tmpLogTargetValues[i]</div>
<div class="line"><a name="l00810"></a><span class="lineno">  810</span>&#160;                                    &lt;&lt; std::endl;</div>
<div class="line"><a name="l00811"></a><span class="lineno">  811</span>&#160;          }</div>
<div class="line"><a name="l00812"></a><span class="lineno">  812</span>&#160;        }</div>
<div class="line"><a name="l00813"></a><span class="lineno">  813</span>&#160;      } <span class="comment">// exceptional</span></div>
<div class="line"><a name="l00814"></a><span class="lineno">  814</span>&#160;</div>
<div class="line"><a name="l00815"></a><span class="lineno">  815</span>&#160;      cumulativeNumPositions += tmpChainSize;</div>
<div class="line"><a name="l00816"></a><span class="lineno">  816</span>&#160;      <span class="keywordflow">if</span> (cumulativeNumPositions &gt; 100) <a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#abb2a6a8de19058957f856341fce2440e">setExceptionalCircumstance</a>(<span class="keyword">false</span>);</div>
<div class="line"><a name="l00817"></a><span class="lineno">  817</span>&#160;</div>
<div class="line"><a name="l00818"></a><span class="lineno">  818</span>&#160;      <span class="keywordflow">if</span> ((<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#a8a0064746ae8dddfece4229b9ad374d6">subDisplayFile</a>()       ) &amp;&amp;</div>
<div class="line"><a name="l00819"></a><span class="lineno">  819</span>&#160;          (<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#a1fe5f244fc0316a0ab3e37463f108b96">displayVerbosity</a>() &gt;= 3)) {</div>
<div class="line"><a name="l00820"></a><span class="lineno">  820</span>&#160;        *<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#a8a0064746ae8dddfece4229b9ad374d6">subDisplayFile</a>() &lt;&lt; <span class="stringliteral">&quot;In MLSampling&lt;P_V,P_M&gt;::generateBalLinkedChains_all()&quot;</span></div>
<div class="line"><a name="l00821"></a><span class="lineno">  821</span>&#160;                                &lt;&lt; <span class="stringliteral">&quot;, level &quot;</span>               &lt;&lt; <a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#af9416874c856e50f3b35270e801f17e4">m_currLevel</a>+<a class="code" href="_m_l_sampling_level_options_8h.html#a68d15eaf394d210effcf584b938206d3">LEVEL_REF_ID</a></div>
<div class="line"><a name="l00822"></a><span class="lineno">  822</span>&#160;                                &lt;&lt; <span class="stringliteral">&quot;, step &quot;</span>                &lt;&lt; <a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a1b1f8ccb4823bdfa26ec652f0807c63e">m_currStep</a></div>
<div class="line"><a name="l00823"></a><span class="lineno">  823</span>&#160;                                &lt;&lt; <span class="stringliteral">&quot;, chainId = &quot;</span>           &lt;&lt; chainId</div>
<div class="line"><a name="l00824"></a><span class="lineno">  824</span>&#160;                                &lt;&lt; <span class="stringliteral">&quot; &lt; &quot;</span>                    &lt;&lt; chainIdMax</div>
<div class="line"><a name="l00825"></a><span class="lineno">  825</span>&#160;                                &lt;&lt; <span class="stringliteral">&quot;: finished generating &quot;</span> &lt;&lt; tmpChain.subSequenceSize()</div>
<div class="line"><a name="l00826"></a><span class="lineno">  826</span>&#160;                                &lt;&lt; <span class="stringliteral">&quot; chain positions&quot;</span></div>
<div class="line"><a name="l00827"></a><span class="lineno">  827</span>&#160;                                &lt;&lt; std::endl;</div>
<div class="line"><a name="l00828"></a><span class="lineno">  828</span>&#160;      }</div>
<div class="line"><a name="l00829"></a><span class="lineno">  829</span>&#160;</div>
<div class="line"><a name="l00830"></a><span class="lineno">  830</span>&#160;      <span class="comment">// KAUST5: what if workingChain ends up with different size in different nodes? Important</span></div>
<div class="line"><a name="l00831"></a><span class="lineno">  831</span>&#160;      workingChain.append              (tmpChain,              1,tmpChain.subSequenceSize()-1              ); <span class="comment">// IMPORTANT: &#39;1&#39; in order to discard initial position</span></div>
<div class="line"><a name="l00832"></a><span class="lineno">  832</span>&#160;      <span class="keywordflow">if</span> (currLogLikelihoodValues) {</div>
<div class="line"><a name="l00833"></a><span class="lineno">  833</span>&#160;        currLogLikelihoodValues-&gt;<a class="code" href="class_q_u_e_s_o_1_1_scalar_sequence.html#a75cdd556cc417e35a6b9f7aff86896ae">append</a>(tmpLogLikelihoodValues,1,tmpLogLikelihoodValues.subSequenceSize()-1); <span class="comment">// IMPORTANT: &#39;1&#39; in order to discard initial position</span></div>
<div class="line"><a name="l00834"></a><span class="lineno">  834</span>&#160;        <span class="keywordflow">if</span> ((<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#a8a0064746ae8dddfece4229b9ad374d6">subDisplayFile</a>()        ) &amp;&amp;</div>
<div class="line"><a name="l00835"></a><span class="lineno">  835</span>&#160;            (<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#a1fe5f244fc0316a0ab3e37463f108b96">displayVerbosity</a>() &gt;= 99) &amp;&amp;</div>
<div class="line"><a name="l00836"></a><span class="lineno">  836</span>&#160;            (chainId == 0                  )) {</div>
<div class="line"><a name="l00837"></a><span class="lineno">  837</span>&#160;          *<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#a8a0064746ae8dddfece4229b9ad374d6">subDisplayFile</a>() &lt;&lt; <span class="stringliteral">&quot;In MLSampling&lt;P_V,P_M&gt;::generateBalLinkedChains_all()&quot;</span></div>
<div class="line"><a name="l00838"></a><span class="lineno">  838</span>&#160;                                  &lt;&lt; <span class="stringliteral">&quot;, level &quot;</span>     &lt;&lt; <a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#af9416874c856e50f3b35270e801f17e4">m_currLevel</a>+<a class="code" href="_m_l_sampling_level_options_8h.html#a68d15eaf394d210effcf584b938206d3">LEVEL_REF_ID</a></div>
<div class="line"><a name="l00839"></a><span class="lineno">  839</span>&#160;                                  &lt;&lt; <span class="stringliteral">&quot;, step &quot;</span>      &lt;&lt; <a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a1b1f8ccb4823bdfa26ec652f0807c63e">m_currStep</a></div>
<div class="line"><a name="l00840"></a><span class="lineno">  840</span>&#160;                                  &lt;&lt; <span class="stringliteral">&quot;, chainId = &quot;</span> &lt;&lt; chainId</div>
<div class="line"><a name="l00841"></a><span class="lineno">  841</span>&#160;                                  &lt;&lt; <span class="stringliteral">&quot;, tmpLogLikelihoodValues.subSequenceSize() = &quot;</span> &lt;&lt; tmpLogLikelihoodValues.subSequenceSize()</div>
<div class="line"><a name="l00842"></a><span class="lineno">  842</span>&#160;                                  &lt;&lt; <span class="stringliteral">&quot;, tmpLogLikelihoodValues[0] = &quot;</span>                &lt;&lt; tmpLogLikelihoodValues[0]</div>
<div class="line"><a name="l00843"></a><span class="lineno">  843</span>&#160;                                  &lt;&lt; <span class="stringliteral">&quot;, tmpLogLikelihoodValues[1] = &quot;</span>                &lt;&lt; tmpLogLikelihoodValues[1]</div>
<div class="line"><a name="l00844"></a><span class="lineno">  844</span>&#160;                                  &lt;&lt; <span class="stringliteral">&quot;, currLogLikelihoodValues[0] = &quot;</span>               &lt;&lt; (*currLogLikelihoodValues)[0]</div>
<div class="line"><a name="l00845"></a><span class="lineno">  845</span>&#160;                                  &lt;&lt; std::endl;</div>
<div class="line"><a name="l00846"></a><span class="lineno">  846</span>&#160;        }</div>
<div class="line"><a name="l00847"></a><span class="lineno">  847</span>&#160;      }</div>
<div class="line"><a name="l00848"></a><span class="lineno">  848</span>&#160;      <span class="keywordflow">if</span> (currLogTargetValues) {</div>
<div class="line"><a name="l00849"></a><span class="lineno">  849</span>&#160;        currLogTargetValues-&gt;<a class="code" href="class_q_u_e_s_o_1_1_scalar_sequence.html#a75cdd556cc417e35a6b9f7aff86896ae">append</a>    (tmpLogTargetValues,    1,tmpLogTargetValues.subSequenceSize()-1    ); <span class="comment">// IMPORTANT: &#39;1&#39; in order to discard initial position</span></div>
<div class="line"><a name="l00850"></a><span class="lineno">  850</span>&#160;      }</div>
<div class="line"><a name="l00851"></a><span class="lineno">  851</span>&#160;      <span class="comment">// 2013-02-23: print size just appended</span></div>
<div class="line"><a name="l00852"></a><span class="lineno">  852</span>&#160;    }</div>
<div class="line"><a name="l00853"></a><span class="lineno">  853</span>&#160;  } <span class="comment">// for &#39;chainId&#39;</span></div>
<div class="line"><a name="l00854"></a><span class="lineno">  854</span>&#160;</div>
<div class="line"><a name="l00855"></a><span class="lineno">  855</span>&#160;  <span class="comment">// 2013-02-23: print final size</span></div>
<div class="line"><a name="l00856"></a><span class="lineno">  856</span>&#160;</div>
<div class="line"><a name="l00857"></a><span class="lineno">  857</span>&#160;  <span class="keyword">struct </span>timeval timevalBarrier;</div>
<div class="line"><a name="l00858"></a><span class="lineno">  858</span>&#160;  iRC = gettimeofday(&amp;timevalBarrier, NULL);</div>
<div class="line"><a name="l00859"></a><span class="lineno">  859</span>&#160;  <span class="keywordflow">if</span> (iRC) {}; <span class="comment">// just to remove compiler warning</span></div>
<div class="line"><a name="l00860"></a><span class="lineno">  860</span>&#160;  <span class="keywordtype">double</span> loopTime = <a class="code" href="namespace_q_u_e_s_o.html#a424bc33f2e6e287fd468408d14b772ee">MiscGetEllapsedSeconds</a>(&amp;timevalEntering);</div>
<div class="line"><a name="l00861"></a><span class="lineno">  861</span>&#160;  <span class="keywordflow">if</span> ((<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#a8a0064746ae8dddfece4229b9ad374d6">subDisplayFile</a>()) &amp;&amp; (<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#a1fe5f244fc0316a0ab3e37463f108b96">displayVerbosity</a>() &gt;= 0)) {</div>
<div class="line"><a name="l00862"></a><span class="lineno">  862</span>&#160;    *<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#a8a0064746ae8dddfece4229b9ad374d6">subDisplayFile</a>() &lt;&lt; <span class="stringliteral">&quot;In MLSampling&lt;P_V,P_M&gt;::generateBalLinkedChains_all()&quot;</span></div>
<div class="line"><a name="l00863"></a><span class="lineno">  863</span>&#160;                            &lt;&lt; <span class="stringliteral">&quot;, level &quot;</span> &lt;&lt; <a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#af9416874c856e50f3b35270e801f17e4">m_currLevel</a>+<a class="code" href="_m_l_sampling_level_options_8h.html#a68d15eaf394d210effcf584b938206d3">LEVEL_REF_ID</a></div>
<div class="line"><a name="l00864"></a><span class="lineno">  864</span>&#160;                            &lt;&lt; <span class="stringliteral">&quot;, step &quot;</span>  &lt;&lt; <a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a1b1f8ccb4823bdfa26ec652f0807c63e">m_currStep</a></div>
<div class="line"><a name="l00865"></a><span class="lineno">  865</span>&#160;                            &lt;&lt; <span class="stringliteral">&quot;: ended chain loop after &quot;</span> &lt;&lt; loopTime &lt;&lt; <span class="stringliteral">&quot; seconds&quot;</span></div>
<div class="line"><a name="l00866"></a><span class="lineno">  866</span>&#160;                            &lt;&lt; <span class="stringliteral">&quot;, calling fullComm().Barrier() at &quot;</span> &lt;&lt; ctime(&amp;timevalBarrier.tv_sec)</div>
<div class="line"><a name="l00867"></a><span class="lineno">  867</span>&#160;                            &lt;&lt; std::endl;</div>
<div class="line"><a name="l00868"></a><span class="lineno">  868</span>&#160;  }</div>
<div class="line"><a name="l00869"></a><span class="lineno">  869</span>&#160;</div>
<div class="line"><a name="l00870"></a><span class="lineno">  870</span>&#160;  <a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#a0b0779b41ff304058856e97e1d16b4d4">fullComm</a>().<a class="code" href="class_q_u_e_s_o_1_1_mpi_comm.html#a4059971c30e023b272fccaa6aa00c426">Barrier</a>(); <span class="comment">// KAUST4</span></div>
<div class="line"><a name="l00871"></a><span class="lineno">  871</span>&#160;</div>
<div class="line"><a name="l00872"></a><span class="lineno">  872</span>&#160;  <span class="keyword">struct </span>timeval timevalLeaving;</div>
<div class="line"><a name="l00873"></a><span class="lineno">  873</span>&#160;  iRC = gettimeofday(&amp;timevalLeaving, NULL);</div>
<div class="line"><a name="l00874"></a><span class="lineno">  874</span>&#160;  <span class="keywordflow">if</span> (iRC) {}; <span class="comment">// just to remove compiler warning</span></div>
<div class="line"><a name="l00875"></a><span class="lineno">  875</span>&#160;  <span class="keywordtype">double</span> barrierTime = <a class="code" href="namespace_q_u_e_s_o.html#a424bc33f2e6e287fd468408d14b772ee">MiscGetEllapsedSeconds</a>(&amp;timevalBarrier);</div>
<div class="line"><a name="l00876"></a><span class="lineno">  876</span>&#160;  <span class="keywordflow">if</span> ((<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#a8a0064746ae8dddfece4229b9ad374d6">subDisplayFile</a>()) &amp;&amp; (<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#a1fe5f244fc0316a0ab3e37463f108b96">displayVerbosity</a>() &gt;= 0)) {</div>
<div class="line"><a name="l00877"></a><span class="lineno">  877</span>&#160;    *<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#a8a0064746ae8dddfece4229b9ad374d6">subDisplayFile</a>() &lt;&lt; <span class="stringliteral">&quot;Leaving MLSampling&lt;P_V,P_M&gt;::generateBalLinkedChains_all()&quot;</span></div>
<div class="line"><a name="l00878"></a><span class="lineno">  878</span>&#160;                            &lt;&lt; <span class="stringliteral">&quot;, level &quot;</span> &lt;&lt; <a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#af9416874c856e50f3b35270e801f17e4">m_currLevel</a>+<a class="code" href="_m_l_sampling_level_options_8h.html#a68d15eaf394d210effcf584b938206d3">LEVEL_REF_ID</a></div>
<div class="line"><a name="l00879"></a><span class="lineno">  879</span>&#160;                            &lt;&lt; <span class="stringliteral">&quot;, step &quot;</span>  &lt;&lt; <a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a1b1f8ccb4823bdfa26ec652f0807c63e">m_currStep</a></div>
<div class="line"><a name="l00880"></a><span class="lineno">  880</span>&#160;                            &lt;&lt; <span class="stringliteral">&quot;: after &quot;</span> &lt;&lt; barrierTime &lt;&lt; <span class="stringliteral">&quot; seconds in fullComm().Barrier()&quot;</span></div>
<div class="line"><a name="l00881"></a><span class="lineno">  881</span>&#160;                            &lt;&lt; <span class="stringliteral">&quot;, at &quot;</span> &lt;&lt; ctime(&amp;timevalLeaving.tv_sec)</div>
<div class="line"><a name="l00882"></a><span class="lineno">  882</span>&#160;                            &lt;&lt; std::endl;</div>
<div class="line"><a name="l00883"></a><span class="lineno">  883</span>&#160;  }</div>
<div class="line"><a name="l00884"></a><span class="lineno">  884</span>&#160;</div>
<div class="line"><a name="l00885"></a><span class="lineno">  885</span>&#160;  <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00886"></a><span class="lineno">  886</span>&#160;}</div>
<div class="ttc" id="class_q_u_e_s_o_1_1_m_l_sampling_html_a13f1ca4fe9f94822fe572a743eaced1d"><div class="ttname"><a href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">QUESO::MLSampling::m_env</a></div><div class="ttdeci">const BaseEnvironment &amp; m_env</div><div class="ttdoc">Queso enviroment. </div><div class="ttdef"><b>Definition:</b> <a href="_m_l_sampling_8h_source.html#l00442">MLSampling.h:442</a></div></div>
<div class="ttc" id="_mpi_comm_8h_html_afbf78d291c032aa7f512bc566cee2bd1"><div class="ttname"><a href="_mpi_comm_8h.html#afbf78d291c032aa7f512bc566cee2bd1">RawValue_MPI_SUM</a></div><div class="ttdeci">#define RawValue_MPI_SUM</div><div class="ttdef"><b>Definition:</b> <a href="_mpi_comm_8h_source.html#l00052">MpiComm.h:52</a></div></div>
<div class="ttc" id="class_q_u_e_s_o_1_1_mpi_comm_html_aa780721ae0fdeabc5a15e04cb0cad964"><div class="ttname"><a href="class_q_u_e_s_o_1_1_mpi_comm.html#aa780721ae0fdeabc5a15e04cb0cad964">QUESO::MpiComm::NumProc</a></div><div class="ttdeci">int NumProc() const </div><div class="ttdoc">Returns total number of processes. </div><div class="ttdef"><b>Definition:</b> <a href="_mpi_comm_8_c_source.html#l00121">MpiComm.C:121</a></div></div>
<div class="ttc" id="class_q_u_e_s_o_1_1_m_l_sampling_html_abdd5cd35419283c33cc40a77d0f4f07f"><div class="ttname"><a href="class_q_u_e_s_o_1_1_m_l_sampling.html#abdd5cd35419283c33cc40a77d0f4f07f">QUESO::MLSampling::m_debugExponent</a></div><div class="ttdeci">double m_debugExponent</div><div class="ttdoc">Exponent for debugging. </div><div class="ttdef"><b>Definition:</b> <a href="_m_l_sampling_8h_source.html#l00470">MLSampling.h:470</a></div></div>
<div class="ttc" id="class_q_u_e_s_o_1_1_mpi_comm_html_a4059971c30e023b272fccaa6aa00c426"><div class="ttname"><a href="class_q_u_e_s_o_1_1_mpi_comm.html#a4059971c30e023b272fccaa6aa00c426">QUESO::MpiComm::Barrier</a></div><div class="ttdeci">void Barrier() const </div><div class="ttdoc">Pause every process in *this communicator until all the processes reach this point. </div><div class="ttdef"><b>Definition:</b> <a href="_mpi_comm_8_c_source.html#l00143">MpiComm.C:143</a></div></div>
<div class="ttc" id="class_q_u_e_s_o_1_1_base_environment_html_affe39f53e3d5d678842413370af09145"><div class="ttname"><a href="class_q_u_e_s_o_1_1_base_environment.html#affe39f53e3d5d678842413370af09145">QUESO::BaseEnvironment::subComm</a></div><div class="ttdeci">const MpiComm &amp; subComm() const </div><div class="ttdoc">Access function for MpiComm sub communicator. </div><div class="ttdef"><b>Definition:</b> <a href="_environment_8_c_source.html#l00269">Environment.C:269</a></div></div>
<div class="ttc" id="class_q_u_e_s_o_1_1_base_environment_html_a0b0779b41ff304058856e97e1d16b4d4"><div class="ttname"><a href="class_q_u_e_s_o_1_1_base_environment.html#a0b0779b41ff304058856e97e1d16b4d4">QUESO::BaseEnvironment::fullComm</a></div><div class="ttdeci">const MpiComm &amp; fullComm() const </div><div class="ttdoc">Access function for MpiComm full communicator. </div><div class="ttdef"><b>Definition:</b> <a href="_environment_8_c_source.html#l00247">Environment.C:247</a></div></div>
<div class="ttc" id="class_q_u_e_s_o_1_1_m_l_sampling_html_af8504cc57ec72b3c52833826b2bfff8e"><div class="ttname"><a href="class_q_u_e_s_o_1_1_m_l_sampling.html#af8504cc57ec72b3c52833826b2bfff8e">QUESO::MLSampling::m_options</a></div><div class="ttdeci">MLSamplingOptions m_options</div><div class="ttdoc">Options for the ML algorithm. </div><div class="ttdef"><b>Definition:</b> <a href="_m_l_sampling_8h_source.html#l00461">MLSampling.h:461</a></div></div>
<div class="ttc" id="class_q_u_e_s_o_1_1_scalar_sequence_html_a75cdd556cc417e35a6b9f7aff86896ae"><div class="ttname"><a href="class_q_u_e_s_o_1_1_scalar_sequence.html#a75cdd556cc417e35a6b9f7aff86896ae">QUESO::ScalarSequence::append</a></div><div class="ttdeci">void append(const ScalarSequence&lt; T &gt; &amp;src, unsigned int srcInitialPos, unsigned int srcNumPos)</div><div class="ttdoc">Appends the scalar sequence src to this sequence. </div><div class="ttdef"><b>Definition:</b> <a href="_scalar_sequence_8_c_source.html#l02649">ScalarSequence.C:2649</a></div></div>
<div class="ttc" id="class_q_u_e_s_o_1_1_m_l_sampling_options_html_a1d3d48598e0b59b46337ce66a52671a5"><div class="ttname"><a href="class_q_u_e_s_o_1_1_m_l_sampling_options.html#a1d3d48598e0b59b46337ce66a52671a5">QUESO::MLSamplingOptions::m_prefix</a></div><div class="ttdeci">std::string m_prefix</div><div class="ttdoc">Class prefix. (ml) </div><div class="ttdef"><b>Definition:</b> <a href="_m_l_sampling_options_8h_source.html#l00090">MLSamplingOptions.h:90</a></div></div>
<div class="ttc" id="class_q_u_e_s_o_1_1_m_l_sampling_html_af9416874c856e50f3b35270e801f17e4"><div class="ttname"><a href="class_q_u_e_s_o_1_1_m_l_sampling.html#af9416874c856e50f3b35270e801f17e4">QUESO::MLSampling::m_currLevel</a></div><div class="ttdeci">unsigned int m_currLevel</div><div class="ttdoc">Current level. </div><div class="ttdef"><b>Definition:</b> <a href="_m_l_sampling_8h_source.html#l00464">MLSampling.h:464</a></div></div>
<div class="ttc" id="class_q_u_e_s_o_1_1_base_environment_html_af0bc451b18302cfd5ee747c321e1c6e5"><div class="ttname"><a href="class_q_u_e_s_o_1_1_base_environment.html#af0bc451b18302cfd5ee747c321e1c6e5">QUESO::BaseEnvironment::exceptionalCircumstance</a></div><div class="ttdeci">bool exceptionalCircumstance() const </div><div class="ttdoc">Decides whether there is an exceptional circumstance. </div><div class="ttdef"><b>Definition:</b> <a href="_environment_8_c_source.html#l01178">Environment.C:1178</a></div></div>
<div class="ttc" id="_m_l_sampling_level_options_8h_html_a68d15eaf394d210effcf584b938206d3"><div class="ttname"><a href="_m_l_sampling_level_options_8h.html#a68d15eaf394d210effcf584b938206d3">LEVEL_REF_ID</a></div><div class="ttdeci">#define LEVEL_REF_ID</div><div class="ttdef"><b>Definition:</b> <a href="_m_l_sampling_level_options_8h_source.html#l00028">MLSamplingLevelOptions.h:28</a></div></div>
<div class="ttc" id="class_q_u_e_s_o_1_1_mpi_comm_html_ab806f80f206210723fcb4df8185a55a8"><div class="ttname"><a href="class_q_u_e_s_o_1_1_mpi_comm.html#ab806f80f206210723fcb4df8185a55a8">QUESO::MpiComm::MyPID</a></div><div class="ttdeci">int MyPID() const </div><div class="ttdoc">Return my process ID. </div><div class="ttdef"><b>Definition:</b> <a href="_mpi_comm_8_c_source.html#l00112">MpiComm.C:112</a></div></div>
<div class="ttc" id="_mpi_comm_8h_html_a68f3ac7ff71a6504e236b0c95de78178"><div class="ttname"><a href="_mpi_comm_8h.html#a68f3ac7ff71a6504e236b0c95de78178">RawValue_MPI_MAX</a></div><div class="ttdeci">#define RawValue_MPI_MAX</div><div class="ttdef"><b>Definition:</b> <a href="_mpi_comm_8h_source.html#l00051">MpiComm.h:51</a></div></div>
<div class="ttc" id="class_q_u_e_s_o_1_1_vector_space_html_a92e963bb5cab3eecd290dfe4b8f03b04"><div class="ttname"><a href="class_q_u_e_s_o_1_1_vector_space.html#a92e963bb5cab3eecd290dfe4b8f03b04">QUESO::VectorSpace::zeroVector</a></div><div class="ttdeci">const V &amp; zeroVector() const </div><div class="ttdoc">Returns a vector filled with zeros. </div><div class="ttdef"><b>Definition:</b> <a href="_vector_space_8_c_source.html#l00218">VectorSpace.C:218</a></div></div>
<div class="ttc" id="class_q_u_e_s_o_1_1_mpi_comm_html_abd6af8db8b0c7fd2f5b62e26477a9537"><div class="ttname"><a href="class_q_u_e_s_o_1_1_mpi_comm.html#abd6af8db8b0c7fd2f5b62e26477a9537">QUESO::MpiComm::Bcast</a></div><div class="ttdeci">void Bcast(void *buffer, int count, RawType_MPI_Datatype datatype, int root, const char *whereMsg, const char *whatMsg) const </div><div class="ttdoc">Broadcast values from the root process to the slave processes. </div><div class="ttdef"><b>Definition:</b> <a href="_mpi_comm_8_c_source.html#l00157">MpiComm.C:157</a></div></div>
<div class="ttc" id="class_q_u_e_s_o_1_1_m_l_sampling_html_a7bc4c72f65ba9166ed94a6e198b0915b"><div class="ttname"><a href="class_q_u_e_s_o_1_1_m_l_sampling.html#a7bc4c72f65ba9166ed94a6e198b0915b">QUESO::MLSampling::m_vectorSpace</a></div><div class="ttdeci">const VectorSpace&lt; P_V, P_M &gt; &amp; m_vectorSpace</div><div class="ttdoc">Vector space. </div><div class="ttdef"><b>Definition:</b> <a href="_m_l_sampling_8h_source.html#l00451">MLSampling.h:451</a></div></div>
<div class="ttc" id="namespace_q_u_e_s_o_html_a424bc33f2e6e287fd468408d14b772ee"><div class="ttname"><a href="namespace_q_u_e_s_o.html#a424bc33f2e6e287fd468408d14b772ee">QUESO::MiscGetEllapsedSeconds</a></div><div class="ttdeci">double MiscGetEllapsedSeconds(struct timeval *timeval0)</div><div class="ttdef"><b>Definition:</b> <a href="_miscellaneous_8_c_source.html#l00287">Miscellaneous.C:287</a></div></div>
<div class="ttc" id="class_q_u_e_s_o_1_1_base_environment_html_ae106b5bb8a80b655b88b3a26b1e7c185"><div class="ttname"><a href="class_q_u_e_s_o_1_1_base_environment.html#ae106b5bb8a80b655b88b3a26b1e7c185">QUESO::BaseEnvironment::inter0Rank</a></div><div class="ttdeci">int inter0Rank() const </div><div class="ttdoc">Returns the process inter0 rank. </div><div class="ttdef"><b>Definition:</b> <a href="_environment_8_c_source.html#l00289">Environment.C:289</a></div></div>
<div class="ttc" id="class_q_u_e_s_o_1_1_mpi_comm_html_a72e137e60ef8060efb1ee5fc874fa4b8"><div class="ttname"><a href="class_q_u_e_s_o_1_1_mpi_comm.html#a72e137e60ef8060efb1ee5fc874fa4b8">QUESO::MpiComm::Allreduce</a></div><div class="ttdeci">void Allreduce(void *sendbuf, void *recvbuf, int count, RawType_MPI_Datatype datatype, RawType_MPI_Op op, const char *whereMsg, const char *whatMsg) const </div><div class="ttdoc">Combines values from all processes and distributes the result back to all processes. </div><div class="ttdef"><b>Definition:</b> <a href="_mpi_comm_8_c_source.html#l00131">MpiComm.C:131</a></div></div>
<div class="ttc" id="class_q_u_e_s_o_1_1_base_environment_html_abb2a6a8de19058957f856341fce2440e"><div class="ttname"><a href="class_q_u_e_s_o_1_1_base_environment.html#abb2a6a8de19058957f856341fce2440e">QUESO::BaseEnvironment::setExceptionalCircumstance</a></div><div class="ttdeci">void setExceptionalCircumstance(bool value) const </div><div class="ttdoc">Set an exceptional circumstance. </div><div class="ttdef"><b>Definition:</b> <a href="_environment_8_c_source.html#l01171">Environment.C:1171</a></div></div>
<div class="ttc" id="_mpi_comm_8h_html_a06cbfbc33436f6e0dc8a48ff3c49bdfc"><div class="ttname"><a href="_mpi_comm_8h.html#a06cbfbc33436f6e0dc8a48ff3c49bdfc">RawValue_MPI_UNSIGNED</a></div><div class="ttdeci">#define RawValue_MPI_UNSIGNED</div><div class="ttdef"><b>Definition:</b> <a href="_mpi_comm_8h_source.html#l00049">MpiComm.h:49</a></div></div>
<div class="ttc" id="class_q_u_e_s_o_1_1_m_l_sampling_html_a1b1f8ccb4823bdfa26ec652f0807c63e"><div class="ttname"><a href="class_q_u_e_s_o_1_1_m_l_sampling.html#a1b1f8ccb4823bdfa26ec652f0807c63e">QUESO::MLSampling::m_currStep</a></div><div class="ttdeci">unsigned int m_currStep</div><div class="ttdoc">Curret step. </div><div class="ttdef"><b>Definition:</b> <a href="_m_l_sampling_8h_source.html#l00467">MLSampling.h:467</a></div></div>
<div class="ttc" id="_mpi_comm_8h_html_a8e30f42fdac116861205e83e2aa18042"><div class="ttname"><a href="_mpi_comm_8h.html#a8e30f42fdac116861205e83e2aa18042">RawValue_MPI_MIN</a></div><div class="ttdeci">#define RawValue_MPI_MIN</div><div class="ttdef"><b>Definition:</b> <a href="_mpi_comm_8h_source.html#l00050">MpiComm.h:50</a></div></div>
<div class="ttc" id="class_q_u_e_s_o_1_1_base_environment_html_a1fe5f244fc0316a0ab3e37463f108b96"><div class="ttname"><a href="class_q_u_e_s_o_1_1_base_environment.html#a1fe5f244fc0316a0ab3e37463f108b96">QUESO::BaseEnvironment::displayVerbosity</a></div><div class="ttdeci">unsigned int displayVerbosity() const </div><div class="ttdef"><b>Definition:</b> <a href="_environment_8_c_source.html#l00436">Environment.C:436</a></div></div>
<div class="ttc" id="class_q_u_e_s_o_1_1_base_environment_html_a8a0064746ae8dddfece4229b9ad374d6"><div class="ttname"><a href="class_q_u_e_s_o_1_1_base_environment.html#a8a0064746ae8dddfece4229b9ad374d6">QUESO::BaseEnvironment::subDisplayFile</a></div><div class="ttdeci">std::ofstream * subDisplayFile() const </div><div class="ttdoc">Access function for m_subDisplayFile (displays file on stream). </div><div class="ttdef"><b>Definition:</b> <a href="_environment_8_c_source.html#l00305">Environment.C:305</a></div></div>
<div class="ttc" id="class_q_u_e_s_o_1_1_base_environment_html_a689e4d140c74d495d97eb498714a4b82"><div class="ttname"><a href="class_q_u_e_s_o_1_1_base_environment.html#a689e4d140c74d495d97eb498714a4b82">QUESO::BaseEnvironment::inter0Comm</a></div><div class="ttdeci">const MpiComm &amp; inter0Comm() const </div><div class="ttdoc">Access function for MpiComm inter0-communicator. </div><div class="ttdef"><b>Definition:</b> <a href="_environment_8_c_source.html#l00295">Environment.C:295</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a8d7296b30623c73ada38971cae27994a"></a>
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;class P_V , class P_M &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="class_q_u_e_s_o_1_1_m_l_sampling.html">QUESO::MLSampling</a>&lt; P_V, P_M &gt;::generateSequence </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_q_u_e_s_o_1_1_base_vector_sequence.html">BaseVectorSequence</a>&lt; P_V, P_M &gt; &amp;&#160;</td>
          <td class="paramname"><em>workingChain</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_q_u_e_s_o_1_1_scalar_sequence.html">ScalarSequence</a>&lt; double &gt; *&#160;</td>
          <td class="paramname"><em>workingLogLikelihoodValues</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_q_u_e_s_o_1_1_scalar_sequence.html">ScalarSequence</a>&lt; double &gt; *&#160;</td>
          <td class="paramname"><em>workingLogTargetValues</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Method to generate the chain. </p>
<pre class="fragment">Requirement: the vector space 'm_vectorSpace' should have dimension equal to the size of a
</pre><p> vector in 'workingChain'. If the requirement is satisfied, this operation sets the size and the contents of 'workingChain' using the algorithm options set in the constructor. If not NULL, 'workingLogLikelihoodValues' and 'workingLogTargetValues' are set accordingly. This operation currently implements the The Parallel Adaptive Multilevel Stochastic Simulation Algorithm (PAMSSA).<br/>
 It consists of 11 steps: </p>
<ol>
<li>
read options; </li>
<li>
save chain and corresponding target pdf values from previous level </li>
<li>
compute currExponent and sequence of weights for current level and update 'm_logEvidenceFactors' </li>
<li>
create covariance matrix for current level </li>
<li>
create <em>unified</em> finite distribution for current level </li>
<li>
decide on using balanced chains or not </li>
<li>
plan for number of linked chains for each node so that all nodes generate the closest possible to the same number of positions </li>
<li>
create vector RV for current level </li>
<li>
scale unified covariance matrix until min &lt;= rejection rate &lt;= max </li>
<li>
sample vector RV of current level </li>
<li>
filter chain if requested. </li>
</ol>
<p>At the end, the method computes information gain: <img class="formulaInl" alt="$ ln( \pi(D|M) ) = E[ln( \pi(D|\theta,M) )] - E[ln( \pi(\theta|D,M) / \pi(\theta|M) )] $" src="form_128.png"/></p>
<dl class="section see"><dt>See Also</dt><dd>S. H. Cheung and E. E. Prudencio. Parallel adaptive multilevel sampling algorithms for the Bayesian analysis of mathematical models. International Journal for Uncertainty Quantification, 2(3):215237, 2012. </dd></dl>

<p>Definition at line <a class="el" href="_m_l_sampling_8_c_source.html#l04080">4080</a> of file <a class="el" href="_m_l_sampling_8_c_source.html">MLSampling.C</a>.</p>

<p>References <a class="el" href="_m_l_sampling_8h_source.html#l00084">QUESO::BalancedLinkedChainsPerNodeStruct&lt; P_V &gt;::balLinkedChains</a>, <a class="el" href="_vector_sequence_8_c_source.html#l00136">QUESO::BaseVectorSequence&lt; V, M &gt;::clear()</a>, <a class="el" href="_vector_sequence_8_c_source.html#l00613">QUESO::BaseVectorSequence&lt; V, M &gt;::computeFilterParams()</a>, <a class="el" href="_sequence_of_vectors_8_c_source.html#l02079">QUESO::SequenceOfVectors&lt; V, M &gt;::filter()</a>, <a class="el" href="_scalar_sequence_8_c_source.html#l02575">QUESO::ScalarSequence&lt; T &gt;::filter()</a>, <a class="el" href="_sequence_of_vectors_8_c_source.html#l00197">QUESO::SequenceOfVectors&lt; V, M &gt;::getPositionValues()</a>, <a class="el" href="_m_l_sampling_level_options_8h_source.html#l00028">LEVEL_REF_ID</a>, <a class="el" href="_m_l_sampling_level_options_8h_source.html#l00191">QUESO::MLSamplingLevelOptions::m_minAcceptableEta</a>, <a class="el" href="_m_l_sampling_level_options_8h_source.html#l00209">QUESO::MLSamplingLevelOptions::m_parameterDisabledSet</a>, <a class="el" href="_m_l_sampling_level_options_8h_source.html#l00222">QUESO::MLSamplingLevelOptions::m_rawChainSize</a>, <a class="el" href="_m_l_sampling_level_options_8h_source.html#l00151">QUESO::MLSamplingLevelOptions::m_stopAtEnd</a>, <a class="el" href="_miscellaneous_8_c_source.html#l00287">QUESO::MiscGetEllapsedSeconds()</a>, <a class="el" href="_environment_8h_source.html#l00075">QUESO::FilePtrSetStruct::ofsVar</a>, <a class="el" href="_mpi_comm_8h_source.html#l00048">RawValue_MPI_DOUBLE</a>, <a class="el" href="_mpi_comm_8h_source.html#l00051">RawValue_MPI_MAX</a>, <a class="el" href="_mpi_comm_8h_source.html#l00050">RawValue_MPI_MIN</a>, <a class="el" href="_mpi_comm_8h_source.html#l00052">RawValue_MPI_SUM</a>, <a class="el" href="_mpi_comm_8h_source.html#l00049">RawValue_MPI_UNSIGNED</a>, <a class="el" href="class_q_u_e_s_o_1_1_base_vector_sequence.html#adc238af7f6e8af2402ab791de7d60af5">QUESO::BaseVectorSequence&lt; V, M &gt;::resizeSequence()</a>, <a class="el" href="_m_l_sampling_level_options_8_c_source.html#l00281">QUESO::MLSamplingLevelOptions::scanOptionsValues()</a>, <a class="el" href="_vector_sequence_8_c_source.html#l00128">QUESO::BaseVectorSequence&lt; V, M &gt;::setName()</a>, <a class="el" href="_scalar_sequence_8_c_source.html#l00120">QUESO::ScalarSequence&lt; T &gt;::setName()</a>, <a class="el" href="class_q_u_e_s_o_1_1_base_vector_sequence.html#a5bcce98b68e0e24c05136e7a3bb50c12">QUESO::BaseVectorSequence&lt; V, M &gt;::setPositionValues()</a>, <a class="el" href="_scalar_sequence_8_c_source.html#l01587">QUESO::ScalarSequence&lt; T &gt;::subMinMaxExtra()</a>, <a class="el" href="class_q_u_e_s_o_1_1_base_vector_sequence.html#afd6278702d40bdf1044697bbd6ad1957">QUESO::BaseVectorSequence&lt; V, M &gt;::subSequenceSize()</a>, <a class="el" href="_sequence_of_vectors_8_c_source.html#l00103">QUESO::SequenceOfVectors&lt; V, M &gt;::subSequenceSize()</a>, <a class="el" href="_scalar_sequence_8_c_source.html#l00141">QUESO::ScalarSequence&lt; T &gt;::subSequenceSize()</a>, <a class="el" href="_scalar_sequence_8_c_source.html#l00903">QUESO::ScalarSequence&lt; T &gt;::unifiedMeanExtra()</a>, <a class="el" href="_scalar_sequence_8_c_source.html#l00428">QUESO::ScalarSequence&lt; T &gt;::unifiedMeanPlain()</a>, <a class="el" href="_scalar_sequence_8_c_source.html#l01622">QUESO::ScalarSequence&lt; T &gt;::unifiedMinMaxExtra()</a>, <a class="el" href="_sequence_of_vectors_8_c_source.html#l01485">QUESO::SequenceOfVectors&lt; V, M &gt;::unifiedWriteContents()</a>, <a class="el" href="_scalar_sequence_8_c_source.html#l02799">QUESO::ScalarSequence&lt; T &gt;::unifiedWriteContents()</a>, <a class="el" href="_defines_8h_source.html#l00222">UQ_FATAL_TEST_MACRO</a>, <a class="el" href="_defines_8h_source.html#l00088">UQ_FILE_EXTENSION_FOR_MATLAB_FORMAT</a>, <a class="el" href="_metropolis_hastings_s_g_options_8h_source.html#l00035">UQ_MH_SG_FILENAME_FOR_NO_FILE</a>, and <a class="el" href="_defines_8h_source.html#l00075">QUESO::UQ_OK_RC</a>.</p>
<div class="fragment"><div class="line"><a name="l04084"></a><span class="lineno"> 4084</span>&#160;{</div>
<div class="line"><a name="l04085"></a><span class="lineno"> 4085</span>&#160;  <span class="keyword">struct </span>timeval timevalRoutineBegin;</div>
<div class="line"><a name="l04086"></a><span class="lineno"> 4086</span>&#160;  <span class="keywordtype">int</span> iRC = 0;</div>
<div class="line"><a name="l04087"></a><span class="lineno"> 4087</span>&#160;  iRC = gettimeofday(&amp;timevalRoutineBegin, NULL);</div>
<div class="line"><a name="l04088"></a><span class="lineno"> 4088</span>&#160;  <span class="keywordflow">if</span> (iRC) {}; <span class="comment">// just to remove compiler warning</span></div>
<div class="line"><a name="l04089"></a><span class="lineno"> 4089</span>&#160;</div>
<div class="line"><a name="l04090"></a><span class="lineno"> 4090</span>&#160;  <span class="keywordflow">if</span> ((<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#a8a0064746ae8dddfece4229b9ad374d6">subDisplayFile</a>()) &amp;&amp; (<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#a1fe5f244fc0316a0ab3e37463f108b96">displayVerbosity</a>() &gt;= 0)) {</div>
<div class="line"><a name="l04091"></a><span class="lineno"> 4091</span>&#160;    *<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#a8a0064746ae8dddfece4229b9ad374d6">subDisplayFile</a>() &lt;&lt; <span class="stringliteral">&quot;Entering MLSampling&lt;P_V,P_M&gt;::generateSequence()&quot;</span></div>
<div class="line"><a name="l04092"></a><span class="lineno"> 4092</span>&#160;                            &lt;&lt; <span class="stringliteral">&quot;, at  &quot;</span>   &lt;&lt; ctime(&amp;timevalRoutineBegin.tv_sec)</div>
<div class="line"><a name="l04093"></a><span class="lineno"> 4093</span>&#160;                            &lt;&lt; <span class="stringliteral">&quot;, after &quot;</span> &lt;&lt; timevalRoutineBegin.tv_sec - <a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#a1adcf7ca2d95e75a29360bcfe091cd65">timevalBegin</a>().tv_sec</div>
<div class="line"><a name="l04094"></a><span class="lineno"> 4094</span>&#160;                            &lt;&lt; <span class="stringliteral">&quot; seconds from queso environment instatiation...&quot;</span></div>
<div class="line"><a name="l04095"></a><span class="lineno"> 4095</span>&#160;                            &lt;&lt; std::endl;</div>
<div class="line"><a name="l04096"></a><span class="lineno"> 4096</span>&#160;  }</div>
<div class="line"><a name="l04097"></a><span class="lineno"> 4097</span>&#160;</div>
<div class="line"><a name="l04098"></a><span class="lineno"> 4098</span>&#160;  <span class="comment">//***********************************************************</span></div>
<div class="line"><a name="l04099"></a><span class="lineno"> 4099</span>&#160;  <span class="comment">// Declaration of Variables</span></div>
<div class="line"><a name="l04100"></a><span class="lineno"> 4100</span>&#160;  <span class="comment">//***********************************************************</span></div>
<div class="line"><a name="l04101"></a><span class="lineno"> 4101</span>&#160;  <span class="keywordtype">double</span>                            currExponent                   = 0.;   <span class="comment">// restate</span></div>
<div class="line"><a name="l04102"></a><span class="lineno"> 4102</span>&#160;  <span class="keywordtype">double</span>                            currEta                        = 1.;   <span class="comment">// restate</span></div>
<div class="line"><a name="l04103"></a><span class="lineno"> 4103</span>&#160;  <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>                      currUnifiedRequestedNumSamples = 0;</div>
<div class="line"><a name="l04104"></a><span class="lineno"> 4104</span>&#160;  SequenceOfVectors&lt;P_V,P_M&gt; currChain              (<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a7bc4c72f65ba9166ed94a6e198b0915b">m_vectorSpace</a>, <span class="comment">// restate</span></div>
<div class="line"><a name="l04105"></a><span class="lineno"> 4105</span>&#160;                                                            0,</div>
<div class="line"><a name="l04106"></a><span class="lineno"> 4106</span>&#160;                                                            <a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#af8504cc57ec72b3c52833826b2bfff8e">m_options</a>.<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling_options.html#a1d3d48598e0b59b46337ce66a52671a5">m_prefix</a>+<span class="stringliteral">&quot;curr_chain&quot;</span>);</div>
<div class="line"><a name="l04107"></a><span class="lineno"> 4107</span>&#160;  ScalarSequence&lt;double&gt;     currLogLikelihoodValues(<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>,         <span class="comment">// restate</span></div>
<div class="line"><a name="l04108"></a><span class="lineno"> 4108</span>&#160;                                                            0,</div>
<div class="line"><a name="l04109"></a><span class="lineno"> 4109</span>&#160;                                                            <span class="stringliteral">&quot;&quot;</span>);</div>
<div class="line"><a name="l04110"></a><span class="lineno"> 4110</span>&#160;  ScalarSequence&lt;double&gt;     currLogTargetValues    (<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>,         <span class="comment">// restate</span></div>
<div class="line"><a name="l04111"></a><span class="lineno"> 4111</span>&#160;                                                            0,</div>
<div class="line"><a name="l04112"></a><span class="lineno"> 4112</span>&#160;                                                            <span class="stringliteral">&quot;&quot;</span>);</div>
<div class="line"><a name="l04113"></a><span class="lineno"> 4113</span>&#160;</div>
<div class="line"><a name="l04114"></a><span class="lineno"> 4114</span>&#160;  <span class="keywordtype">bool</span> stopAtEndOfLevel = <span class="keyword">false</span>;</div>
<div class="line"><a name="l04115"></a><span class="lineno"> 4115</span>&#160;  <span class="keywordtype">char</span> levelPrefix[256];</div>
<div class="line"><a name="l04116"></a><span class="lineno"> 4116</span>&#160;</div>
<div class="line"><a name="l04117"></a><span class="lineno"> 4117</span>&#160;  <span class="comment">//***********************************************************</span></div>
<div class="line"><a name="l04118"></a><span class="lineno"> 4118</span>&#160;  <span class="comment">// Take care of first level (level &#39;0&#39;)</span></div>
<div class="line"><a name="l04119"></a><span class="lineno"> 4119</span>&#160;  <span class="comment">//***********************************************************</span></div>
<div class="line"><a name="l04120"></a><span class="lineno"> 4120</span>&#160;  MLSamplingLevelOptions defaultLevelOptions(<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>,(<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#af8504cc57ec72b3c52833826b2bfff8e">m_options</a>.<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling_options.html#a1d3d48598e0b59b46337ce66a52671a5">m_prefix</a> + <span class="stringliteral">&quot;default_&quot;</span>).c_str());</div>
<div class="line"><a name="l04121"></a><span class="lineno"> 4121</span>&#160;  defaultLevelOptions.scanOptionsValues(NULL);</div>
<div class="line"><a name="l04122"></a><span class="lineno"> 4122</span>&#160;</div>
<div class="line"><a name="l04123"></a><span class="lineno"> 4123</span>&#160;  MLSamplingLevelOptions lastLevelOptions(<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>,(<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#af8504cc57ec72b3c52833826b2bfff8e">m_options</a>.<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling_options.html#a1d3d48598e0b59b46337ce66a52671a5">m_prefix</a> + <span class="stringliteral">&quot;last_&quot;</span>).c_str());</div>
<div class="line"><a name="l04124"></a><span class="lineno"> 4124</span>&#160;  lastLevelOptions.scanOptionsValues(&amp;defaultLevelOptions);</div>
<div class="line"><a name="l04125"></a><span class="lineno"> 4125</span>&#160;</div>
<div class="line"><a name="l04126"></a><span class="lineno"> 4126</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#af8504cc57ec72b3c52833826b2bfff8e">m_options</a>.m_restartInput_baseNameForFiles != <span class="stringliteral">&quot;.&quot;</span>) {</div>
<div class="line"><a name="l04127"></a><span class="lineno"> 4127</span>&#160;    <a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#aa387be291dd763ce001ea769e87266c4">restartML</a>(currExponent,            <span class="comment">// output</span></div>
<div class="line"><a name="l04128"></a><span class="lineno"> 4128</span>&#160;              currEta,                 <span class="comment">// output</span></div>
<div class="line"><a name="l04129"></a><span class="lineno"> 4129</span>&#160;              currChain,               <span class="comment">// output</span></div>
<div class="line"><a name="l04130"></a><span class="lineno"> 4130</span>&#160;              currLogLikelihoodValues, <span class="comment">// output</span></div>
<div class="line"><a name="l04131"></a><span class="lineno"> 4131</span>&#160;              currLogTargetValues);    <span class="comment">// output</span></div>
<div class="line"><a name="l04132"></a><span class="lineno"> 4132</span>&#160;</div>
<div class="line"><a name="l04133"></a><span class="lineno"> 4133</span>&#160;    <span class="keywordflow">if</span> (currExponent == 1.) {</div>
<div class="line"><a name="l04134"></a><span class="lineno"> 4134</span>&#160;      <span class="keywordflow">if</span> (lastLevelOptions.m_parameterDisabledSet.size() &gt; 0) { <span class="comment">// gpmsa2</span></div>
<div class="line"><a name="l04135"></a><span class="lineno"> 4135</span>&#160;        <span class="keywordflow">for</span> (std::set&lt;unsigned int&gt;::iterator setIt = lastLevelOptions.m_parameterDisabledSet.begin(); setIt != lastLevelOptions.m_parameterDisabledSet.end(); ++setIt) {</div>
<div class="line"><a name="l04136"></a><span class="lineno"> 4136</span>&#160;          <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> paramId = *setIt;</div>
<div class="line"><a name="l04137"></a><span class="lineno"> 4137</span>&#160;          <span class="keywordflow">if</span> (paramId &lt; <a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a7bc4c72f65ba9166ed94a6e198b0915b">m_vectorSpace</a>.<a class="code" href="class_q_u_e_s_o_1_1_vector_space.html#a5829a1f4f996f8307c840b705144d666">dimLocal</a>()) {</div>
<div class="line"><a name="l04138"></a><span class="lineno"> 4138</span>&#160;            <a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#afbe27e6149562020663b72da6592d933">m_numDisabledParameters</a>++;</div>
<div class="line"><a name="l04139"></a><span class="lineno"> 4139</span>&#160;            <a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#ac76690384f70d74b8662faf7a051449e">m_parameterEnabledStatus</a>[paramId] = <span class="keyword">false</span>;</div>
<div class="line"><a name="l04140"></a><span class="lineno"> 4140</span>&#160;          }</div>
<div class="line"><a name="l04141"></a><span class="lineno"> 4141</span>&#160;        }</div>
<div class="line"><a name="l04142"></a><span class="lineno"> 4142</span>&#160;      }</div>
<div class="line"><a name="l04143"></a><span class="lineno"> 4143</span>&#160;</div>
<div class="line"><a name="l04144"></a><span class="lineno"> 4144</span>&#160;<span class="preprocessor">#ifdef QUESO_USES_SEQUENCE_STATISTICAL_OPTIONS</span></div>
<div class="line"><a name="l04145"></a><span class="lineno"> 4145</span>&#160;<span class="preprocessor"></span>      <span class="keywordflow">if</span> (lastLevelOptions.m_rawChainComputeStats) {</div>
<div class="line"><a name="l04146"></a><span class="lineno"> 4146</span>&#160;        FilePtrSetStruct filePtrSet;</div>
<div class="line"><a name="l04147"></a><span class="lineno"> 4147</span>&#160;        <a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#ab8fe853074f12ea34e18724119a2fc75">openOutputFile</a>(lastLevelOptions.m_dataOutputFileName,</div>
<div class="line"><a name="l04148"></a><span class="lineno"> 4148</span>&#160;                             <a class="code" href="_defines_8h.html#ac440026eff7deb1c1eed1eea0e8e36ba">UQ_FILE_EXTENSION_FOR_MATLAB_FORMAT</a>, <span class="comment">// Yes, always &quot;.m&quot;</span></div>
<div class="line"><a name="l04149"></a><span class="lineno"> 4149</span>&#160;                             lastLevelOptions.m_dataOutputAllowedSet,</div>
<div class="line"><a name="l04150"></a><span class="lineno"> 4150</span>&#160;                             <span class="keyword">false</span>,</div>
<div class="line"><a name="l04151"></a><span class="lineno"> 4151</span>&#160;                             filePtrSet);</div>
<div class="line"><a name="l04152"></a><span class="lineno"> 4152</span>&#160;</div>
<div class="line"><a name="l04153"></a><span class="lineno"> 4153</span>&#160;        currChain.computeStatistics(*lastLevelOptions.m_rawChainStatisticalOptionsObj,</div>
<div class="line"><a name="l04154"></a><span class="lineno"> 4154</span>&#160;                                    filePtrSet.ofsVar);</div>
<div class="line"><a name="l04155"></a><span class="lineno"> 4155</span>&#160;</div>
<div class="line"><a name="l04156"></a><span class="lineno"> 4156</span>&#160;        <a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#ab712bff194ddd91459d4ea8715c77e8b">closeFile</a>(filePtrSet,<a class="code" href="_defines_8h.html#ac440026eff7deb1c1eed1eea0e8e36ba">UQ_FILE_EXTENSION_FOR_MATLAB_FORMAT</a>);</div>
<div class="line"><a name="l04157"></a><span class="lineno"> 4157</span>&#160;      }</div>
<div class="line"><a name="l04158"></a><span class="lineno"> 4158</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l04159"></a><span class="lineno"> 4159</span>&#160;<span class="preprocessor"></span>      <span class="comment">// Compute MLE and MAP</span></div>
<div class="line"><a name="l04160"></a><span class="lineno"> 4160</span>&#160;      <span class="comment">// rr0</span></div>
<div class="line"><a name="l04161"></a><span class="lineno"> 4161</span>&#160;</div>
<div class="line"><a name="l04162"></a><span class="lineno"> 4162</span>&#160;      <span class="keywordflow">if</span> (lastLevelOptions.m_rawChainDataOutputFileName != <a class="code" href="_metropolis_hastings_s_g_options_8h.html#a75699ceb938d800e2b7f59ede3ea9a31">UQ_MH_SG_FILENAME_FOR_NO_FILE</a>) {</div>
<div class="line"><a name="l04163"></a><span class="lineno"> 4163</span>&#160;        currChain.unifiedWriteContents              (lastLevelOptions.m_rawChainDataOutputFileName,lastLevelOptions.m_rawChainDataOutputFileType);</div>
<div class="line"><a name="l04164"></a><span class="lineno"> 4164</span>&#160;        currLogLikelihoodValues.unifiedWriteContents(lastLevelOptions.m_rawChainDataOutputFileName,lastLevelOptions.m_rawChainDataOutputFileType);</div>
<div class="line"><a name="l04165"></a><span class="lineno"> 4165</span>&#160;        currLogTargetValues.unifiedWriteContents    (lastLevelOptions.m_rawChainDataOutputFileName,lastLevelOptions.m_rawChainDataOutputFileType);</div>
<div class="line"><a name="l04166"></a><span class="lineno"> 4166</span>&#160;      }</div>
<div class="line"><a name="l04167"></a><span class="lineno"> 4167</span>&#160;</div>
<div class="line"><a name="l04168"></a><span class="lineno"> 4168</span>&#160;      <span class="keywordflow">if</span> (lastLevelOptions.m_filteredChainGenerate) {</div>
<div class="line"><a name="l04169"></a><span class="lineno"> 4169</span>&#160;        FilePtrSetStruct filePtrSet;</div>
<div class="line"><a name="l04170"></a><span class="lineno"> 4170</span>&#160;        <a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#ab8fe853074f12ea34e18724119a2fc75">openOutputFile</a>(lastLevelOptions.m_dataOutputFileName,</div>
<div class="line"><a name="l04171"></a><span class="lineno"> 4171</span>&#160;                             <a class="code" href="_defines_8h.html#ac440026eff7deb1c1eed1eea0e8e36ba">UQ_FILE_EXTENSION_FOR_MATLAB_FORMAT</a>, <span class="comment">// Yes, always &quot;.m&quot;</span></div>
<div class="line"><a name="l04172"></a><span class="lineno"> 4172</span>&#160;                             lastLevelOptions.m_dataOutputAllowedSet,</div>
<div class="line"><a name="l04173"></a><span class="lineno"> 4173</span>&#160;                             <span class="keyword">false</span>,</div>
<div class="line"><a name="l04174"></a><span class="lineno"> 4174</span>&#160;                             filePtrSet);</div>
<div class="line"><a name="l04175"></a><span class="lineno"> 4175</span>&#160;</div>
<div class="line"><a name="l04176"></a><span class="lineno"> 4176</span>&#160;        <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> filterInitialPos = (<span class="keywordtype">unsigned</span> int) (lastLevelOptions.m_filteredChainDiscardedPortion * (<span class="keywordtype">double</span>) currChain.subSequenceSize());</div>
<div class="line"><a name="l04177"></a><span class="lineno"> 4177</span>&#160;        <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> filterSpacing    = lastLevelOptions.m_filteredChainLag;</div>
<div class="line"><a name="l04178"></a><span class="lineno"> 4178</span>&#160;        <span class="keywordflow">if</span> (filterSpacing == 0) {</div>
<div class="line"><a name="l04179"></a><span class="lineno"> 4179</span>&#160;          currChain.computeFilterParams(filePtrSet.ofsVar,</div>
<div class="line"><a name="l04180"></a><span class="lineno"> 4180</span>&#160;                                        filterInitialPos,</div>
<div class="line"><a name="l04181"></a><span class="lineno"> 4181</span>&#160;                                        filterSpacing);</div>
<div class="line"><a name="l04182"></a><span class="lineno"> 4182</span>&#160;        }</div>
<div class="line"><a name="l04183"></a><span class="lineno"> 4183</span>&#160;</div>
<div class="line"><a name="l04184"></a><span class="lineno"> 4184</span>&#160;        <span class="comment">// Filter positions from the converged portion of the chain</span></div>
<div class="line"><a name="l04185"></a><span class="lineno"> 4185</span>&#160;        currChain.filter(filterInitialPos,</div>
<div class="line"><a name="l04186"></a><span class="lineno"> 4186</span>&#160;                         filterSpacing);</div>
<div class="line"><a name="l04187"></a><span class="lineno"> 4187</span>&#160;        currChain.setName(lastLevelOptions.m_prefix + <span class="stringliteral">&quot;filtChain&quot;</span>);</div>
<div class="line"><a name="l04188"></a><span class="lineno"> 4188</span>&#160;</div>
<div class="line"><a name="l04189"></a><span class="lineno"> 4189</span>&#160;        currLogLikelihoodValues.filter(filterInitialPos,</div>
<div class="line"><a name="l04190"></a><span class="lineno"> 4190</span>&#160;                                       filterSpacing);</div>
<div class="line"><a name="l04191"></a><span class="lineno"> 4191</span>&#160;        currLogLikelihoodValues.setName(lastLevelOptions.m_prefix + <span class="stringliteral">&quot;filtLogLikelihood&quot;</span>);</div>
<div class="line"><a name="l04192"></a><span class="lineno"> 4192</span>&#160;</div>
<div class="line"><a name="l04193"></a><span class="lineno"> 4193</span>&#160;        currLogTargetValues.filter(filterInitialPos,</div>
<div class="line"><a name="l04194"></a><span class="lineno"> 4194</span>&#160;                                   filterSpacing);</div>
<div class="line"><a name="l04195"></a><span class="lineno"> 4195</span>&#160;        currLogTargetValues.setName(lastLevelOptions.m_prefix + <span class="stringliteral">&quot;filtLogTarget&quot;</span>);</div>
<div class="line"><a name="l04196"></a><span class="lineno"> 4196</span>&#160;</div>
<div class="line"><a name="l04197"></a><span class="lineno"> 4197</span>&#160;<span class="preprocessor">#ifdef QUESO_USES_SEQUENCE_STATISTICAL_OPTIONS</span></div>
<div class="line"><a name="l04198"></a><span class="lineno"> 4198</span>&#160;<span class="preprocessor"></span>        <span class="keywordflow">if</span> (lastLevelOptions.m_filteredChainComputeStats) {</div>
<div class="line"><a name="l04199"></a><span class="lineno"> 4199</span>&#160;          currChain.computeStatistics(*lastLevelOptions.m_filteredChainStatisticalOptionsObj,</div>
<div class="line"><a name="l04200"></a><span class="lineno"> 4200</span>&#160;                                      filePtrSet.ofsVar);</div>
<div class="line"><a name="l04201"></a><span class="lineno"> 4201</span>&#160;        }</div>
<div class="line"><a name="l04202"></a><span class="lineno"> 4202</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l04203"></a><span class="lineno"> 4203</span>&#160;<span class="preprocessor"></span>        <span class="comment">// Compute MLE and MAP</span></div>
<div class="line"><a name="l04204"></a><span class="lineno"> 4204</span>&#160;        <span class="comment">// rr0</span></div>
<div class="line"><a name="l04205"></a><span class="lineno"> 4205</span>&#160;        <a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#ab712bff194ddd91459d4ea8715c77e8b">closeFile</a>(filePtrSet,<a class="code" href="_defines_8h.html#ac440026eff7deb1c1eed1eea0e8e36ba">UQ_FILE_EXTENSION_FOR_MATLAB_FORMAT</a>);</div>
<div class="line"><a name="l04206"></a><span class="lineno"> 4206</span>&#160;</div>
<div class="line"><a name="l04207"></a><span class="lineno"> 4207</span>&#160;        <span class="keywordflow">if</span> (lastLevelOptions.m_filteredChainDataOutputFileName != <a class="code" href="_metropolis_hastings_s_g_options_8h.html#a75699ceb938d800e2b7f59ede3ea9a31">UQ_MH_SG_FILENAME_FOR_NO_FILE</a>) {</div>
<div class="line"><a name="l04208"></a><span class="lineno"> 4208</span>&#160;          currChain.unifiedWriteContents              (lastLevelOptions.m_filteredChainDataOutputFileName,lastLevelOptions.m_filteredChainDataOutputFileType);</div>
<div class="line"><a name="l04209"></a><span class="lineno"> 4209</span>&#160;          currLogLikelihoodValues.unifiedWriteContents(lastLevelOptions.m_filteredChainDataOutputFileName,lastLevelOptions.m_filteredChainDataOutputFileType);</div>
<div class="line"><a name="l04210"></a><span class="lineno"> 4210</span>&#160;          currLogTargetValues.unifiedWriteContents    (lastLevelOptions.m_filteredChainDataOutputFileName,lastLevelOptions.m_filteredChainDataOutputFileType);</div>
<div class="line"><a name="l04211"></a><span class="lineno"> 4211</span>&#160;        }</div>
<div class="line"><a name="l04212"></a><span class="lineno"> 4212</span>&#160;      } <span class="comment">// if (lastLevelOptions.m_filteredChainGenerate)</span></div>
<div class="line"><a name="l04213"></a><span class="lineno"> 4213</span>&#160;    }</div>
<div class="line"><a name="l04214"></a><span class="lineno"> 4214</span>&#160;  }</div>
<div class="line"><a name="l04215"></a><span class="lineno"> 4215</span>&#160;  <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l04216"></a><span class="lineno"> 4216</span>&#160;    sprintf(levelPrefix,<span class="stringliteral">&quot;%d_&quot;</span>,<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#af9416874c856e50f3b35270e801f17e4">m_currLevel</a>+<a class="code" href="_m_l_sampling_level_options_8h.html#a68d15eaf394d210effcf584b938206d3">LEVEL_REF_ID</a>); <span class="comment">// Yes, &#39;+0&#39;</span></div>
<div class="line"><a name="l04217"></a><span class="lineno"> 4217</span>&#160;    MLSamplingLevelOptions currOptions(<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>,(<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#af8504cc57ec72b3c52833826b2bfff8e">m_options</a>.<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling_options.html#a1d3d48598e0b59b46337ce66a52671a5">m_prefix</a> + levelPrefix).c_str());</div>
<div class="line"><a name="l04218"></a><span class="lineno"> 4218</span>&#160;    currOptions.scanOptionsValues(&amp;defaultLevelOptions);</div>
<div class="line"><a name="l04219"></a><span class="lineno"> 4219</span>&#160;</div>
<div class="line"><a name="l04220"></a><span class="lineno"> 4220</span>&#160;    <span class="keywordflow">if</span> (currOptions.m_parameterDisabledSet.size() &gt; 0) { <span class="comment">// gpmsa2</span></div>
<div class="line"><a name="l04221"></a><span class="lineno"> 4221</span>&#160;      <span class="keywordflow">for</span> (std::set&lt;unsigned int&gt;::iterator setIt = currOptions.m_parameterDisabledSet.begin(); setIt != currOptions.m_parameterDisabledSet.end(); ++setIt) {</div>
<div class="line"><a name="l04222"></a><span class="lineno"> 4222</span>&#160;        <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> paramId = *setIt;</div>
<div class="line"><a name="l04223"></a><span class="lineno"> 4223</span>&#160;        <span class="keywordflow">if</span> (paramId &lt; <a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a7bc4c72f65ba9166ed94a6e198b0915b">m_vectorSpace</a>.<a class="code" href="class_q_u_e_s_o_1_1_vector_space.html#a5829a1f4f996f8307c840b705144d666">dimLocal</a>()) {</div>
<div class="line"><a name="l04224"></a><span class="lineno"> 4224</span>&#160;          <a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#afbe27e6149562020663b72da6592d933">m_numDisabledParameters</a>++;</div>
<div class="line"><a name="l04225"></a><span class="lineno"> 4225</span>&#160;          <a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#ac76690384f70d74b8662faf7a051449e">m_parameterEnabledStatus</a>[paramId] = <span class="keyword">false</span>;</div>
<div class="line"><a name="l04226"></a><span class="lineno"> 4226</span>&#160;        }</div>
<div class="line"><a name="l04227"></a><span class="lineno"> 4227</span>&#160;      }</div>
<div class="line"><a name="l04228"></a><span class="lineno"> 4228</span>&#160;    }</div>
<div class="line"><a name="l04229"></a><span class="lineno"> 4229</span>&#160;</div>
<div class="line"><a name="l04230"></a><span class="lineno"> 4230</span>&#160;    <a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a0a2615d8f3627630d0cb62cb91614bd1">generateSequence_Level0_all</a>(currOptions,                    <span class="comment">// input</span></div>
<div class="line"><a name="l04231"></a><span class="lineno"> 4231</span>&#160;                                currUnifiedRequestedNumSamples, <span class="comment">// output</span></div>
<div class="line"><a name="l04232"></a><span class="lineno"> 4232</span>&#160;                                currChain,                      <span class="comment">// output</span></div>
<div class="line"><a name="l04233"></a><span class="lineno"> 4233</span>&#160;                                currLogLikelihoodValues,        <span class="comment">// output</span></div>
<div class="line"><a name="l04234"></a><span class="lineno"> 4234</span>&#160;                                currLogTargetValues);           <span class="comment">// output</span></div>
<div class="line"><a name="l04235"></a><span class="lineno"> 4235</span>&#160;</div>
<div class="line"><a name="l04236"></a><span class="lineno"> 4236</span>&#160;    stopAtEndOfLevel = currOptions.m_stopAtEnd;</div>
<div class="line"><a name="l04237"></a><span class="lineno"> 4237</span>&#160;    <span class="keywordtype">bool</span> performCheckpoint = stopAtEndOfLevel;</div>
<div class="line"><a name="l04238"></a><span class="lineno"> 4238</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#af8504cc57ec72b3c52833826b2bfff8e">m_options</a>.m_restartOutput_levelPeriod &gt; 0) {</div>
<div class="line"><a name="l04239"></a><span class="lineno"> 4239</span>&#160;      performCheckpoint = performCheckpoint || ( ((<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#af9416874c856e50f3b35270e801f17e4">m_currLevel</a> + 1) % <a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#af8504cc57ec72b3c52833826b2bfff8e">m_options</a>.m_restartOutput_levelPeriod) == 0 );</div>
<div class="line"><a name="l04240"></a><span class="lineno"> 4240</span>&#160;    }</div>
<div class="line"><a name="l04241"></a><span class="lineno"> 4241</span>&#160;    <span class="keywordflow">if</span> (performCheckpoint) {</div>
<div class="line"><a name="l04242"></a><span class="lineno"> 4242</span>&#160;      <a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#aa8e7bb1bd54ccafb9b276127a76eba71">checkpointML</a>(currExponent,            <span class="comment">// input</span></div>
<div class="line"><a name="l04243"></a><span class="lineno"> 4243</span>&#160;                   currEta,                 <span class="comment">// input</span></div>
<div class="line"><a name="l04244"></a><span class="lineno"> 4244</span>&#160;                   currChain,               <span class="comment">// input</span></div>
<div class="line"><a name="l04245"></a><span class="lineno"> 4245</span>&#160;                   currLogLikelihoodValues, <span class="comment">// input</span></div>
<div class="line"><a name="l04246"></a><span class="lineno"> 4246</span>&#160;                   currLogTargetValues);    <span class="comment">// input</span></div>
<div class="line"><a name="l04247"></a><span class="lineno"> 4247</span>&#160;    }</div>
<div class="line"><a name="l04248"></a><span class="lineno"> 4248</span>&#160;  }</div>
<div class="line"><a name="l04249"></a><span class="lineno"> 4249</span>&#160;  <span class="comment">//std::cout &lt;&lt; &quot;In QUESO: end of level 0. Exiting on purpose&quot; &lt;&lt; std::endl;</span></div>
<div class="line"><a name="l04250"></a><span class="lineno"> 4250</span>&#160;  <span class="comment">//exit(1);</span></div>
<div class="line"><a name="l04251"></a><span class="lineno"> 4251</span>&#160;</div>
<div class="line"><a name="l04252"></a><span class="lineno"> 4252</span>&#160;  <span class="keywordtype">double</span> minLogLike = -INFINITY;</div>
<div class="line"><a name="l04253"></a><span class="lineno"> 4253</span>&#160;  <span class="keywordtype">double</span> maxLogLike =  INFINITY;</div>
<div class="line"><a name="l04254"></a><span class="lineno"> 4254</span>&#160;  currLogLikelihoodValues.subMinMaxExtra(0,</div>
<div class="line"><a name="l04255"></a><span class="lineno"> 4255</span>&#160;                                         currLogLikelihoodValues.subSequenceSize(),</div>
<div class="line"><a name="l04256"></a><span class="lineno"> 4256</span>&#160;                                         minLogLike,</div>
<div class="line"><a name="l04257"></a><span class="lineno"> 4257</span>&#160;                                         maxLogLike);</div>
<div class="line"><a name="l04258"></a><span class="lineno"> 4258</span>&#160;  <span class="keywordflow">if</span> ((<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#a8a0064746ae8dddfece4229b9ad374d6">subDisplayFile</a>()) &amp;&amp; (<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#a1fe5f244fc0316a0ab3e37463f108b96">displayVerbosity</a>() &gt;= 0)) {</div>
<div class="line"><a name="l04259"></a><span class="lineno"> 4259</span>&#160;    *<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#a8a0064746ae8dddfece4229b9ad374d6">subDisplayFile</a>() &lt;&lt; <span class="stringliteral">&quot;In MLSampling&lt;P_V,P_M&gt;::generateSequence()&quot;</span></div>
<div class="line"><a name="l04260"></a><span class="lineno"> 4260</span>&#160;                            &lt;&lt; <span class="stringliteral">&quot;: at end of level &quot;</span>  &lt;&lt; <a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#af9416874c856e50f3b35270e801f17e4">m_currLevel</a>+<a class="code" href="_m_l_sampling_level_options_8h.html#a68d15eaf394d210effcf584b938206d3">LEVEL_REF_ID</a></div>
<div class="line"><a name="l04261"></a><span class="lineno"> 4261</span>&#160;                            &lt;&lt; <span class="stringliteral">&quot;, sub minLogLike = &quot;</span> &lt;&lt; minLogLike</div>
<div class="line"><a name="l04262"></a><span class="lineno"> 4262</span>&#160;                            &lt;&lt; <span class="stringliteral">&quot;, sub maxLogLike = &quot;</span> &lt;&lt; maxLogLike</div>
<div class="line"><a name="l04263"></a><span class="lineno"> 4263</span>&#160;                            &lt;&lt; std::endl;</div>
<div class="line"><a name="l04264"></a><span class="lineno"> 4264</span>&#160;  }</div>
<div class="line"><a name="l04265"></a><span class="lineno"> 4265</span>&#160;</div>
<div class="line"><a name="l04266"></a><span class="lineno"> 4266</span>&#160;  <a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#a0b0779b41ff304058856e97e1d16b4d4">fullComm</a>().<a class="code" href="class_q_u_e_s_o_1_1_mpi_comm.html#a4059971c30e023b272fccaa6aa00c426">Barrier</a>();</div>
<div class="line"><a name="l04267"></a><span class="lineno"> 4267</span>&#160;</div>
<div class="line"><a name="l04268"></a><span class="lineno"> 4268</span>&#160;  minLogLike = -INFINITY;</div>
<div class="line"><a name="l04269"></a><span class="lineno"> 4269</span>&#160;  maxLogLike =  INFINITY;</div>
<div class="line"><a name="l04270"></a><span class="lineno"> 4270</span>&#160;  currLogLikelihoodValues.unifiedMinMaxExtra(<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a7bc4c72f65ba9166ed94a6e198b0915b">m_vectorSpace</a>.<a class="code" href="class_q_u_e_s_o_1_1_vector_space.html#a67b0c3620662116f5a346fdaa5faf38e">numOfProcsForStorage</a>() == 1,</div>
<div class="line"><a name="l04271"></a><span class="lineno"> 4271</span>&#160;                                             0,</div>
<div class="line"><a name="l04272"></a><span class="lineno"> 4272</span>&#160;                                             currLogLikelihoodValues.subSequenceSize(),</div>
<div class="line"><a name="l04273"></a><span class="lineno"> 4273</span>&#160;                                             minLogLike,</div>
<div class="line"><a name="l04274"></a><span class="lineno"> 4274</span>&#160;                                             maxLogLike);</div>
<div class="line"><a name="l04275"></a><span class="lineno"> 4275</span>&#160;  <span class="keywordflow">if</span> ((<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#a8a0064746ae8dddfece4229b9ad374d6">subDisplayFile</a>()) &amp;&amp; (<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#a1fe5f244fc0316a0ab3e37463f108b96">displayVerbosity</a>() &gt;= 0)) {</div>
<div class="line"><a name="l04276"></a><span class="lineno"> 4276</span>&#160;    *<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#a8a0064746ae8dddfece4229b9ad374d6">subDisplayFile</a>() &lt;&lt; <span class="stringliteral">&quot;In MLSampling&lt;P_V,P_M&gt;::generateSequence()&quot;</span></div>
<div class="line"><a name="l04277"></a><span class="lineno"> 4277</span>&#160;                            &lt;&lt; <span class="stringliteral">&quot;: at end of level &quot;</span>      &lt;&lt; <a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#af9416874c856e50f3b35270e801f17e4">m_currLevel</a>+<a class="code" href="_m_l_sampling_level_options_8h.html#a68d15eaf394d210effcf584b938206d3">LEVEL_REF_ID</a></div>
<div class="line"><a name="l04278"></a><span class="lineno"> 4278</span>&#160;                            &lt;&lt; <span class="stringliteral">&quot;, unified minLogLike = &quot;</span> &lt;&lt; minLogLike</div>
<div class="line"><a name="l04279"></a><span class="lineno"> 4279</span>&#160;                            &lt;&lt; <span class="stringliteral">&quot;, unified maxLogLike = &quot;</span> &lt;&lt; maxLogLike</div>
<div class="line"><a name="l04280"></a><span class="lineno"> 4280</span>&#160;                            &lt;&lt; std::endl;</div>
<div class="line"><a name="l04281"></a><span class="lineno"> 4281</span>&#160;  }</div>
<div class="line"><a name="l04282"></a><span class="lineno"> 4282</span>&#160;</div>
<div class="line"><a name="l04283"></a><span class="lineno"> 4283</span>&#160;  <span class="comment">//***********************************************************</span></div>
<div class="line"><a name="l04284"></a><span class="lineno"> 4284</span>&#160;  <span class="comment">// Take care of next levels</span></div>
<div class="line"><a name="l04285"></a><span class="lineno"> 4285</span>&#160;  <span class="comment">//***********************************************************</span></div>
<div class="line"><a name="l04286"></a><span class="lineno"> 4286</span>&#160;  <span class="keywordflow">while</span> ((currExponent     &lt;  1.   ) &amp;&amp; <span class="comment">// begin level while</span></div>
<div class="line"><a name="l04287"></a><span class="lineno"> 4287</span>&#160;         (stopAtEndOfLevel == <span class="keyword">false</span>)) {</div>
<div class="line"><a name="l04288"></a><span class="lineno"> 4288</span>&#160;    <a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#af9416874c856e50f3b35270e801f17e4">m_currLevel</a>++; <span class="comment">// restate</span></div>
<div class="line"><a name="l04289"></a><span class="lineno"> 4289</span>&#160;</div>
<div class="line"><a name="l04290"></a><span class="lineno"> 4290</span>&#160;    <span class="keyword">struct </span>timeval timevalLevelBegin;</div>
<div class="line"><a name="l04291"></a><span class="lineno"> 4291</span>&#160;    iRC = 0;</div>
<div class="line"><a name="l04292"></a><span class="lineno"> 4292</span>&#160;    iRC = gettimeofday(&amp;timevalLevelBegin, NULL);</div>
<div class="line"><a name="l04293"></a><span class="lineno"> 4293</span>&#160;</div>
<div class="line"><a name="l04294"></a><span class="lineno"> 4294</span>&#160;    <span class="keywordflow">if</span> ((<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#a8a0064746ae8dddfece4229b9ad374d6">subDisplayFile</a>()) &amp;&amp; (<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#a1fe5f244fc0316a0ab3e37463f108b96">displayVerbosity</a>() &gt;= 0)) {</div>
<div class="line"><a name="l04295"></a><span class="lineno"> 4295</span>&#160;      *<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#a8a0064746ae8dddfece4229b9ad374d6">subDisplayFile</a>() &lt;&lt; <span class="stringliteral">&quot;In MLSampling&lt;P_V,P_M&gt;::generateSequence()&quot;</span></div>
<div class="line"><a name="l04296"></a><span class="lineno"> 4296</span>&#160;                              &lt;&lt; <span class="stringliteral">&quot;: beginning level &quot;</span> &lt;&lt; <a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#af9416874c856e50f3b35270e801f17e4">m_currLevel</a>+<a class="code" href="_m_l_sampling_level_options_8h.html#a68d15eaf394d210effcf584b938206d3">LEVEL_REF_ID</a></div>
<div class="line"><a name="l04297"></a><span class="lineno"> 4297</span>&#160;                              &lt;&lt; <span class="stringliteral">&quot;, at  &quot;</span>   &lt;&lt; ctime(&amp;timevalLevelBegin.tv_sec)</div>
<div class="line"><a name="l04298"></a><span class="lineno"> 4298</span>&#160;                              &lt;&lt; <span class="stringliteral">&quot;, after &quot;</span> &lt;&lt; timevalLevelBegin.tv_sec - timevalRoutineBegin.tv_sec</div>
<div class="line"><a name="l04299"></a><span class="lineno"> 4299</span>&#160;                              &lt;&lt; <span class="stringliteral">&quot; seconds from entering the routine&quot;</span></div>
<div class="line"><a name="l04300"></a><span class="lineno"> 4300</span>&#160;                              &lt;&lt; <span class="stringliteral">&quot;, after &quot;</span> &lt;&lt; timevalLevelBegin.tv_sec - <a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#a1adcf7ca2d95e75a29360bcfe091cd65">timevalBegin</a>().tv_sec</div>
<div class="line"><a name="l04301"></a><span class="lineno"> 4301</span>&#160;                              &lt;&lt; <span class="stringliteral">&quot; seconds from queso environment instatiation&quot;</span></div>
<div class="line"><a name="l04302"></a><span class="lineno"> 4302</span>&#160;                              &lt;&lt; std::endl;</div>
<div class="line"><a name="l04303"></a><span class="lineno"> 4303</span>&#160;    }</div>
<div class="line"><a name="l04304"></a><span class="lineno"> 4304</span>&#160;</div>
<div class="line"><a name="l04305"></a><span class="lineno"> 4305</span>&#160;    iRC = <a class="code" href="namespace_q_u_e_s_o.html#a8e909502900aecf24cedba022ea84471">UQ_OK_RC</a>;</div>
<div class="line"><a name="l04306"></a><span class="lineno"> 4306</span>&#160;    <span class="keyword">struct </span>timeval timevalLevel;</div>
<div class="line"><a name="l04307"></a><span class="lineno"> 4307</span>&#160;    iRC = gettimeofday(&amp;timevalLevel, NULL);</div>
<div class="line"><a name="l04308"></a><span class="lineno"> 4308</span>&#160;    <span class="keywordtype">double</span>       cumulativeRawChainRunTime    = 0.;</div>
<div class="line"><a name="l04309"></a><span class="lineno"> 4309</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> cumulativeRawChainRejections = 0;</div>
<div class="line"><a name="l04310"></a><span class="lineno"> 4310</span>&#160;</div>
<div class="line"><a name="l04311"></a><span class="lineno"> 4311</span>&#160;    <span class="keywordtype">bool</span>   tryExponentEta = <span class="keyword">true</span>; <span class="comment">// gpmsa1</span></div>
<div class="line"><a name="l04312"></a><span class="lineno"> 4312</span>&#160;    <span class="keywordtype">double</span> failedExponent = 0.;   <span class="comment">// gpmsa1</span></div>
<div class="line"><a name="l04313"></a><span class="lineno"> 4313</span>&#160;    <span class="keywordtype">double</span> failedEta      = 0.;   <span class="comment">// gpmsa1</span></div>
<div class="line"><a name="l04314"></a><span class="lineno"> 4314</span>&#160;</div>
<div class="line"><a name="l04315"></a><span class="lineno"> 4315</span>&#160;    MLSamplingLevelOptions*            currOptions           = NULL;  <span class="comment">// step 1</span></div>
<div class="line"><a name="l04316"></a><span class="lineno"> 4316</span>&#160;    SequenceOfVectors&lt;P_V,P_M&gt;*        prevChain             = NULL;  <span class="comment">// step 2</span></div>
<div class="line"><a name="l04317"></a><span class="lineno"> 4317</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>                              indexOfFirstWeight    = 0;     <span class="comment">// step 2</span></div>
<div class="line"><a name="l04318"></a><span class="lineno"> 4318</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>                              indexOfLastWeight     = 0;     <span class="comment">// step 2</span></div>
<div class="line"><a name="l04319"></a><span class="lineno"> 4319</span>&#160;    P_M*                                      unifiedCovMatrix      = NULL;  <span class="comment">// step 4</span></div>
<div class="line"><a name="l04320"></a><span class="lineno"> 4320</span>&#160;    <span class="keywordtype">bool</span>                                      useBalancedChains     = <span class="keyword">false</span>; <span class="comment">// step 6</span></div>
<div class="line"><a name="l04321"></a><span class="lineno"> 4321</span>&#160;    BalancedLinkedChainsPerNodeStruct&lt;P_V&gt;* balancedLinkControl   = NULL;  <span class="comment">// step 7</span></div>
<div class="line"><a name="l04322"></a><span class="lineno"> 4322</span>&#160;    UnbalancedLinkedChainsPerNodeStruct*    unbalancedLinkControl = NULL;  <span class="comment">// step 7</span></div>
<div class="line"><a name="l04323"></a><span class="lineno"> 4323</span>&#160;    BayesianJointPdf&lt;P_V,P_M&gt;*         currPdf               = NULL;  <span class="comment">// step 8</span></div>
<div class="line"><a name="l04324"></a><span class="lineno"> 4324</span>&#160;    GenericVectorRV&lt;P_V,P_M&gt;*          currRv                = NULL;  <span class="comment">// step 8</span></div>
<div class="line"><a name="l04325"></a><span class="lineno"> 4325</span>&#160;</div>
<div class="line"><a name="l04326"></a><span class="lineno"> 4326</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> exponentEtaTriedAmount = 0;</div>
<div class="line"><a name="l04327"></a><span class="lineno"> 4327</span>&#160;    <span class="keywordflow">while</span> (tryExponentEta) { <span class="comment">// gpmsa1</span></div>
<div class="line"><a name="l04328"></a><span class="lineno"> 4328</span>&#160;      <span class="keywordflow">if</span> ((<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#a8a0064746ae8dddfece4229b9ad374d6">subDisplayFile</a>()) &amp;&amp; (<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#a1fe5f244fc0316a0ab3e37463f108b96">displayVerbosity</a>() &gt;= 0)) {</div>
<div class="line"><a name="l04329"></a><span class="lineno"> 4329</span>&#160;        *<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#a8a0064746ae8dddfece4229b9ad374d6">subDisplayFile</a>() &lt;&lt; <span class="stringliteral">&quot;In IMLSampling&lt;P_V,P_M&gt;::generateSequence()&quot;</span></div>
<div class="line"><a name="l04330"></a><span class="lineno"> 4330</span>&#160;                                &lt;&lt; <span class="stringliteral">&quot;, level &quot;</span> &lt;&lt; <a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#af9416874c856e50f3b35270e801f17e4">m_currLevel</a>+<a class="code" href="_m_l_sampling_level_options_8h.html#a68d15eaf394d210effcf584b938206d3">LEVEL_REF_ID</a></div>
<div class="line"><a name="l04331"></a><span class="lineno"> 4331</span>&#160;                                &lt;&lt; <span class="stringliteral">&quot;, beginning &#39;do-while(tryExponentEta)&quot;</span></div>
<div class="line"><a name="l04332"></a><span class="lineno"> 4332</span>&#160;                                &lt;&lt; <span class="stringliteral">&quot;: failedExponent = &quot;</span> &lt;&lt; failedExponent</div>
<div class="line"><a name="l04333"></a><span class="lineno"> 4333</span>&#160;                                &lt;&lt; <span class="stringliteral">&quot;, failedEta = &quot;</span>      &lt;&lt; failedEta</div>
<div class="line"><a name="l04334"></a><span class="lineno"> 4334</span>&#160;                                &lt;&lt; std::endl;</div>
<div class="line"><a name="l04335"></a><span class="lineno"> 4335</span>&#160;      }</div>
<div class="line"><a name="l04336"></a><span class="lineno"> 4336</span>&#160;</div>
<div class="line"><a name="l04337"></a><span class="lineno"> 4337</span>&#160;    <span class="comment">//***********************************************************</span></div>
<div class="line"><a name="l04338"></a><span class="lineno"> 4338</span>&#160;    <span class="comment">// Step 1 of 11: read options</span></div>
<div class="line"><a name="l04339"></a><span class="lineno"> 4339</span>&#160;    <span class="comment">//***********************************************************</span></div>
<div class="line"><a name="l04340"></a><span class="lineno"> 4340</span>&#160;    <a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a1b1f8ccb4823bdfa26ec652f0807c63e">m_currStep</a> = 1;</div>
<div class="line"><a name="l04341"></a><span class="lineno"> 4341</span>&#160;    sprintf(levelPrefix,<span class="stringliteral">&quot;%d_&quot;</span>,<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#af9416874c856e50f3b35270e801f17e4">m_currLevel</a>+<a class="code" href="_m_l_sampling_level_options_8h.html#a68d15eaf394d210effcf584b938206d3">LEVEL_REF_ID</a>); <span class="comment">// Yes, &#39;+0&#39;</span></div>
<div class="line"><a name="l04342"></a><span class="lineno"> 4342</span>&#160;    currOptions = <span class="keyword">new</span> MLSamplingLevelOptions(<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>,(<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#af8504cc57ec72b3c52833826b2bfff8e">m_options</a>.<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling_options.html#a1d3d48598e0b59b46337ce66a52671a5">m_prefix</a> + levelPrefix).c_str());</div>
<div class="line"><a name="l04343"></a><span class="lineno"> 4343</span>&#160;    currOptions-&gt;scanOptionsValues(&amp;defaultLevelOptions);</div>
<div class="line"><a name="l04344"></a><span class="lineno"> 4344</span>&#160;</div>
<div class="line"><a name="l04345"></a><span class="lineno"> 4345</span>&#160;    <span class="keywordflow">if</span> (currOptions-&gt;m_parameterDisabledSet.size() &gt; 0) { <span class="comment">// gpmsa2</span></div>
<div class="line"><a name="l04346"></a><span class="lineno"> 4346</span>&#160;      <span class="keywordflow">for</span> (std::set&lt;unsigned int&gt;::iterator setIt = currOptions-&gt;m_parameterDisabledSet.begin(); setIt != currOptions-&gt;m_parameterDisabledSet.end(); ++setIt) {</div>
<div class="line"><a name="l04347"></a><span class="lineno"> 4347</span>&#160;        <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> paramId = *setIt;</div>
<div class="line"><a name="l04348"></a><span class="lineno"> 4348</span>&#160;        <span class="keywordflow">if</span> (paramId &lt; <a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a7bc4c72f65ba9166ed94a6e198b0915b">m_vectorSpace</a>.<a class="code" href="class_q_u_e_s_o_1_1_vector_space.html#a5829a1f4f996f8307c840b705144d666">dimLocal</a>()) {</div>
<div class="line"><a name="l04349"></a><span class="lineno"> 4349</span>&#160;          <a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#afbe27e6149562020663b72da6592d933">m_numDisabledParameters</a>++;</div>
<div class="line"><a name="l04350"></a><span class="lineno"> 4350</span>&#160;          <a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#ac76690384f70d74b8662faf7a051449e">m_parameterEnabledStatus</a>[paramId] = <span class="keyword">false</span>;</div>
<div class="line"><a name="l04351"></a><span class="lineno"> 4351</span>&#160;        }</div>
<div class="line"><a name="l04352"></a><span class="lineno"> 4352</span>&#160;      }</div>
<div class="line"><a name="l04353"></a><span class="lineno"> 4353</span>&#160;    }</div>
<div class="line"><a name="l04354"></a><span class="lineno"> 4354</span>&#160;</div>
<div class="line"><a name="l04355"></a><span class="lineno"> 4355</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#ae106b5bb8a80b655b88b3a26b1e7c185">inter0Rank</a>() &gt;= 0) {</div>
<div class="line"><a name="l04356"></a><span class="lineno"> 4356</span>&#160;      <a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#aea8da13aed5b04e64b8490ca5f107889">generateSequence_Step01_inter0</a>(currOptions,                     <span class="comment">// input</span></div>
<div class="line"><a name="l04357"></a><span class="lineno"> 4357</span>&#160;                                     currUnifiedRequestedNumSamples); <span class="comment">// output</span></div>
<div class="line"><a name="l04358"></a><span class="lineno"> 4358</span>&#160;    }</div>
<div class="line"><a name="l04359"></a><span class="lineno"> 4359</span>&#160;</div>
<div class="line"><a name="l04360"></a><span class="lineno"> 4360</span>&#160;    <span class="comment">//***********************************************************</span></div>
<div class="line"><a name="l04361"></a><span class="lineno"> 4361</span>&#160;    <span class="comment">// Step 2 of 11: save [chain and corresponding target pdf values] from previous level</span></div>
<div class="line"><a name="l04362"></a><span class="lineno"> 4362</span>&#160;    <span class="comment">//***********************************************************</span></div>
<div class="line"><a name="l04363"></a><span class="lineno"> 4363</span>&#160;    <a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a1b1f8ccb4823bdfa26ec652f0807c63e">m_currStep</a> = 2;</div>
<div class="line"><a name="l04364"></a><span class="lineno"> 4364</span>&#160;    <span class="keywordtype">double</span>       prevExponent                   = currExponent;</div>
<div class="line"><a name="l04365"></a><span class="lineno"> 4365</span>&#160;    <span class="keywordtype">double</span>       prevEta                        = currEta;</div>
<div class="line"><a name="l04366"></a><span class="lineno"> 4366</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> prevUnifiedRequestedNumSamples = currUnifiedRequestedNumSamples;</div>
<div class="line"><a name="l04367"></a><span class="lineno"> 4367</span>&#160;    prevChain = <span class="keyword">new</span> SequenceOfVectors&lt;P_V,P_M&gt;(<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a7bc4c72f65ba9166ed94a6e198b0915b">m_vectorSpace</a>,</div>
<div class="line"><a name="l04368"></a><span class="lineno"> 4368</span>&#160;                                                      0,</div>
<div class="line"><a name="l04369"></a><span class="lineno"> 4369</span>&#160;                                                      <a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#af8504cc57ec72b3c52833826b2bfff8e">m_options</a>.<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling_options.html#a1d3d48598e0b59b46337ce66a52671a5">m_prefix</a>+<span class="stringliteral">&quot;prev_chain&quot;</span>);</div>
<div class="line"><a name="l04370"></a><span class="lineno"> 4370</span>&#160;    ScalarSequence&lt;double&gt; prevLogLikelihoodValues(<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>,0,<span class="stringliteral">&quot;&quot;</span>);</div>
<div class="line"><a name="l04371"></a><span class="lineno"> 4371</span>&#160;    ScalarSequence&lt;double&gt; prevLogTargetValues    (<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>,0,<span class="stringliteral">&quot;&quot;</span>);</div>
<div class="line"><a name="l04372"></a><span class="lineno"> 4372</span>&#160;</div>
<div class="line"><a name="l04373"></a><span class="lineno"> 4373</span>&#160;    indexOfFirstWeight = 0;</div>
<div class="line"><a name="l04374"></a><span class="lineno"> 4374</span>&#160;    indexOfLastWeight  = 0;</div>
<div class="line"><a name="l04375"></a><span class="lineno"> 4375</span>&#160;</div>
<div class="line"><a name="l04376"></a><span class="lineno"> 4376</span>&#160;    <span class="comment">//std::cout &lt;&lt; &quot;m_env.inter0Rank() = &quot; &lt;&lt; m_env.inter0Rank() &lt;&lt; std::endl;</span></div>
<div class="line"><a name="l04377"></a><span class="lineno"> 4377</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#ae106b5bb8a80b655b88b3a26b1e7c185">inter0Rank</a>() &gt;= 0) {</div>
<div class="line"><a name="l04378"></a><span class="lineno"> 4378</span>&#160;      <a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a06c37730b943a1838d58475d322639b9">generateSequence_Step02_inter0</a>(currOptions,             <span class="comment">// input</span></div>
<div class="line"><a name="l04379"></a><span class="lineno"> 4379</span>&#160;                                     currChain,               <span class="comment">// input/output // restate</span></div>
<div class="line"><a name="l04380"></a><span class="lineno"> 4380</span>&#160;                                     currLogLikelihoodValues, <span class="comment">// input/output // restate</span></div>
<div class="line"><a name="l04381"></a><span class="lineno"> 4381</span>&#160;                                     currLogTargetValues,     <span class="comment">// input/output // restate</span></div>
<div class="line"><a name="l04382"></a><span class="lineno"> 4382</span>&#160;                                     *prevChain,              <span class="comment">// output</span></div>
<div class="line"><a name="l04383"></a><span class="lineno"> 4383</span>&#160;                                     prevLogLikelihoodValues, <span class="comment">// output</span></div>
<div class="line"><a name="l04384"></a><span class="lineno"> 4384</span>&#160;                                     prevLogTargetValues,     <span class="comment">// output</span></div>
<div class="line"><a name="l04385"></a><span class="lineno"> 4385</span>&#160;                                     indexOfFirstWeight,      <span class="comment">// output</span></div>
<div class="line"><a name="l04386"></a><span class="lineno"> 4386</span>&#160;                                     indexOfLastWeight);      <span class="comment">// output</span></div>
<div class="line"><a name="l04387"></a><span class="lineno"> 4387</span>&#160;    }</div>
<div class="line"><a name="l04388"></a><span class="lineno"> 4388</span>&#160;</div>
<div class="line"><a name="l04389"></a><span class="lineno"> 4389</span>&#160;    <span class="comment">//***********************************************************</span></div>
<div class="line"><a name="l04390"></a><span class="lineno"> 4390</span>&#160;    <span class="comment">// Step 3 of 11: compute [currExponent and sequence of weights] for current level</span></div>
<div class="line"><a name="l04391"></a><span class="lineno"> 4391</span>&#160;    <span class="comment">//               update &#39;m_logEvidenceFactors&#39;</span></div>
<div class="line"><a name="l04392"></a><span class="lineno"> 4392</span>&#160;    <span class="comment">//***********************************************************</span></div>
<div class="line"><a name="l04393"></a><span class="lineno"> 4393</span>&#160;    <a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a1b1f8ccb4823bdfa26ec652f0807c63e">m_currStep</a> = 3;</div>
<div class="line"><a name="l04394"></a><span class="lineno"> 4394</span>&#160;    ScalarSequence&lt;double&gt; weightSequence(<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>,prevLogLikelihoodValues.subSequenceSize(),<span class="stringliteral">&quot;&quot;</span>);</div>
<div class="line"><a name="l04395"></a><span class="lineno"> 4395</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#ae106b5bb8a80b655b88b3a26b1e7c185">inter0Rank</a>() &gt;= 0) {</div>
<div class="line"><a name="l04396"></a><span class="lineno"> 4396</span>&#160;      <a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#ae53e6bc0ec5d1f3d3ac9df268086cd75">generateSequence_Step03_inter0</a>(currOptions,             <span class="comment">// input</span></div>
<div class="line"><a name="l04397"></a><span class="lineno"> 4397</span>&#160;                                     prevLogLikelihoodValues, <span class="comment">// input</span></div>
<div class="line"><a name="l04398"></a><span class="lineno"> 4398</span>&#160;                                     prevExponent,            <span class="comment">// input</span></div>
<div class="line"><a name="l04399"></a><span class="lineno"> 4399</span>&#160;                                     failedExponent,          <span class="comment">// input // gpmsa1</span></div>
<div class="line"><a name="l04400"></a><span class="lineno"> 4400</span>&#160;                                     currExponent,            <span class="comment">// output</span></div>
<div class="line"><a name="l04401"></a><span class="lineno"> 4401</span>&#160;                                     weightSequence);         <span class="comment">// output</span></div>
<div class="line"><a name="l04402"></a><span class="lineno"> 4402</span>&#160;    }</div>
<div class="line"><a name="l04403"></a><span class="lineno"> 4403</span>&#160;</div>
<div class="line"><a name="l04404"></a><span class="lineno"> 4404</span>&#160;    <span class="comment">// All nodes in &#39;subComm&#39; should have the same &#39;currExponent&#39;</span></div>
<div class="line"><a name="l04405"></a><span class="lineno"> 4405</span>&#160;    <a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#affe39f53e3d5d678842413370af09145">subComm</a>().<a class="code" href="class_q_u_e_s_o_1_1_mpi_comm.html#abd6af8db8b0c7fd2f5b62e26477a9537">Bcast</a>((<span class="keywordtype">void</span> *) &amp;currExponent, (<span class="keywordtype">int</span>) 1, <a class="code" href="_mpi_comm_8h.html#ad0f503bd9fecfe4e570ca3d15aaf2518">RawValue_MPI_DOUBLE</a>, 0, <span class="comment">// Yes, &#39;subComm&#39;, important</span></div>
<div class="line"><a name="l04406"></a><span class="lineno"> 4406</span>&#160;                          <span class="stringliteral">&quot;MLSampling&lt;P_V,P_M&gt;::generateSequence()&quot;</span>,</div>
<div class="line"><a name="l04407"></a><span class="lineno"> 4407</span>&#160;                          <span class="stringliteral">&quot;failed MPI.Bcast() for currExponent&quot;</span>);</div>
<div class="line"><a name="l04408"></a><span class="lineno"> 4408</span>&#160;    <a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#abdd5cd35419283c33cc40a77d0f4f07f">m_debugExponent</a> = currExponent;</div>
<div class="line"><a name="l04409"></a><span class="lineno"> 4409</span>&#160;</div>
<div class="line"><a name="l04410"></a><span class="lineno"> 4410</span>&#160;    <span class="keywordflow">if</span> (currExponent == 1.) {</div>
<div class="line"><a name="l04411"></a><span class="lineno"> 4411</span>&#160;      <span class="keywordflow">if</span> ((<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#a8a0064746ae8dddfece4229b9ad374d6">subDisplayFile</a>()) &amp;&amp; (<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#a1fe5f244fc0316a0ab3e37463f108b96">displayVerbosity</a>() &gt;= 0)) {</div>
<div class="line"><a name="l04412"></a><span class="lineno"> 4412</span>&#160;        *<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#a8a0064746ae8dddfece4229b9ad374d6">subDisplayFile</a>() &lt;&lt; <span class="stringliteral">&quot;In MLSampling&lt;P_V,P_M&gt;::generateSequence()&quot;</span></div>
<div class="line"><a name="l04413"></a><span class="lineno"> 4413</span>&#160;                                &lt;&lt; <span class="stringliteral">&quot;, level &quot;</span> &lt;&lt; <a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#af9416874c856e50f3b35270e801f17e4">m_currLevel</a>+<a class="code" href="_m_l_sampling_level_options_8h.html#a68d15eaf394d210effcf584b938206d3">LEVEL_REF_ID</a></div>
<div class="line"><a name="l04414"></a><span class="lineno"> 4414</span>&#160;                                &lt;&lt; <span class="stringliteral">&quot;, step &quot;</span>  &lt;&lt; <a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a1b1f8ccb4823bdfa26ec652f0807c63e">m_currStep</a></div>
<div class="line"><a name="l04415"></a><span class="lineno"> 4415</span>&#160;                                &lt;&lt; <span class="stringliteral">&quot;: copying &#39;last&#39; level options to current options&quot;</span> <span class="comment">// In all nodes of &#39;subComm&#39;, important</span></div>
<div class="line"><a name="l04416"></a><span class="lineno"> 4416</span>&#160;                                &lt;&lt; std::endl;</div>
<div class="line"><a name="l04417"></a><span class="lineno"> 4417</span>&#160;      }</div>
<div class="line"><a name="l04418"></a><span class="lineno"> 4418</span>&#160;      <span class="keyword">delete</span> currOptions;</div>
<div class="line"><a name="l04419"></a><span class="lineno"> 4419</span>&#160;      currOptions = &amp;lastLevelOptions;</div>
<div class="line"><a name="l04420"></a><span class="lineno"> 4420</span>&#160;</div>
<div class="line"><a name="l04421"></a><span class="lineno"> 4421</span>&#160;      <span class="keywordflow">if</span> ((<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#a8a0064746ae8dddfece4229b9ad374d6">subDisplayFile</a>()) &amp;&amp; (<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#a1fe5f244fc0316a0ab3e37463f108b96">displayVerbosity</a>() &gt;= 0)) {</div>
<div class="line"><a name="l04422"></a><span class="lineno"> 4422</span>&#160;        *<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#a8a0064746ae8dddfece4229b9ad374d6">subDisplayFile</a>() &lt;&lt; <span class="stringliteral">&quot;In MLSampling&lt;P_V,P_M&gt;::generateSequence()&quot;</span></div>
<div class="line"><a name="l04423"></a><span class="lineno"> 4423</span>&#160;                                &lt;&lt; <span class="stringliteral">&quot;, level &quot;</span> &lt;&lt; <a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#af9416874c856e50f3b35270e801f17e4">m_currLevel</a>+<a class="code" href="_m_l_sampling_level_options_8h.html#a68d15eaf394d210effcf584b938206d3">LEVEL_REF_ID</a></div>
<div class="line"><a name="l04424"></a><span class="lineno"> 4424</span>&#160;                                &lt;&lt; <span class="stringliteral">&quot;, step &quot;</span>  &lt;&lt; <a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a1b1f8ccb4823bdfa26ec652f0807c63e">m_currStep</a></div>
<div class="line"><a name="l04425"></a><span class="lineno"> 4425</span>&#160;                                &lt;&lt; <span class="stringliteral">&quot;: after copying &#39;last&#39; level options to current options, the current options are&quot;</span></div>
<div class="line"><a name="l04426"></a><span class="lineno"> 4426</span>&#160;                                &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span> &lt;&lt; *currOptions</div>
<div class="line"><a name="l04427"></a><span class="lineno"> 4427</span>&#160;                                &lt;&lt; std::endl;</div>
<div class="line"><a name="l04428"></a><span class="lineno"> 4428</span>&#160;      }</div>
<div class="line"><a name="l04429"></a><span class="lineno"> 4429</span>&#160;</div>
<div class="line"><a name="l04430"></a><span class="lineno"> 4430</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#ae106b5bb8a80b655b88b3a26b1e7c185">inter0Rank</a>() &gt;= 0) {</div>
<div class="line"><a name="l04431"></a><span class="lineno"> 4431</span>&#160;        <span class="comment">// It is necessary to recompute &#39;currUnifiedRequestedNumSamples&#39; because</span></div>
<div class="line"><a name="l04432"></a><span class="lineno"> 4432</span>&#160;        <span class="comment">// &#39;currOptions&#39; has just been replaced by &#39;lastLevelOptions&#39;</span></div>
<div class="line"><a name="l04433"></a><span class="lineno"> 4433</span>&#160;        <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> tmpSize = currOptions-&gt;m_rawChainSize;</div>
<div class="line"><a name="l04434"></a><span class="lineno"> 4434</span>&#160;        <a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#a689e4d140c74d495d97eb498714a4b82">inter0Comm</a>().<a class="code" href="class_q_u_e_s_o_1_1_mpi_comm.html#a72e137e60ef8060efb1ee5fc874fa4b8">Allreduce</a>((<span class="keywordtype">void</span> *) &amp;tmpSize, (<span class="keywordtype">void</span> *) &amp;currUnifiedRequestedNumSamples, (<span class="keywordtype">int</span>) 1, <a class="code" href="_mpi_comm_8h.html#a06cbfbc33436f6e0dc8a48ff3c49bdfc">RawValue_MPI_UNSIGNED</a>, <a class="code" href="_mpi_comm_8h.html#afbf78d291c032aa7f512bc566cee2bd1">RawValue_MPI_SUM</a>,</div>
<div class="line"><a name="l04435"></a><span class="lineno"> 4435</span>&#160;                                     <span class="stringliteral">&quot;MLSampling&lt;P_V,P_M&gt;::generateSequence()&quot;</span>,</div>
<div class="line"><a name="l04436"></a><span class="lineno"> 4436</span>&#160;                                     <span class="stringliteral">&quot;failed MPI.Allreduce() for requested num samples in step 3&quot;</span>);</div>
<div class="line"><a name="l04437"></a><span class="lineno"> 4437</span>&#160;      }</div>
<div class="line"><a name="l04438"></a><span class="lineno"> 4438</span>&#160;    }</div>
<div class="line"><a name="l04439"></a><span class="lineno"> 4439</span>&#160;</div>
<div class="line"><a name="l04440"></a><span class="lineno"> 4440</span>&#160;    <span class="comment">//***********************************************************</span></div>
<div class="line"><a name="l04441"></a><span class="lineno"> 4441</span>&#160;    <span class="comment">// Step 4 of 11: create covariance matrix for current level</span></div>
<div class="line"><a name="l04442"></a><span class="lineno"> 4442</span>&#160;    <span class="comment">//***********************************************************</span></div>
<div class="line"><a name="l04443"></a><span class="lineno"> 4443</span>&#160;    <a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a1b1f8ccb4823bdfa26ec652f0807c63e">m_currStep</a> = 4;</div>
<div class="line"><a name="l04444"></a><span class="lineno"> 4444</span>&#160;    P_V oneVec(m_vectorSpace.zeroVector());</div>
<div class="line"><a name="l04445"></a><span class="lineno"> 4445</span>&#160;    oneVec.cwSet(1.);</div>
<div class="line"><a name="l04446"></a><span class="lineno"> 4446</span>&#160;</div>
<div class="line"><a name="l04447"></a><span class="lineno"> 4447</span>&#160;    unifiedCovMatrix = NULL;</div>
<div class="line"><a name="l04448"></a><span class="lineno"> 4448</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#ae106b5bb8a80b655b88b3a26b1e7c185">inter0Rank</a>() &gt;= 0) {</div>
<div class="line"><a name="l04449"></a><span class="lineno"> 4449</span>&#160;      unifiedCovMatrix = m_vectorSpace.newMatrix();</div>
<div class="line"><a name="l04450"></a><span class="lineno"> 4450</span>&#160;    }</div>
<div class="line"><a name="l04451"></a><span class="lineno"> 4451</span>&#160;    <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l04452"></a><span class="lineno"> 4452</span>&#160;      unifiedCovMatrix = <span class="keyword">new</span> P_M(oneVec);</div>
<div class="line"><a name="l04453"></a><span class="lineno"> 4453</span>&#160;    }</div>
<div class="line"><a name="l04454"></a><span class="lineno"> 4454</span>&#160;</div>
<div class="line"><a name="l04455"></a><span class="lineno"> 4455</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#ae106b5bb8a80b655b88b3a26b1e7c185">inter0Rank</a>() &gt;= 0) {</div>
<div class="line"><a name="l04456"></a><span class="lineno"> 4456</span>&#160;      <a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a955fb446652327edbc275e3d9145e2db">generateSequence_Step04_inter0</a>(*prevChain,         <span class="comment">// input</span></div>
<div class="line"><a name="l04457"></a><span class="lineno"> 4457</span>&#160;                                     weightSequence,     <span class="comment">// input</span></div>
<div class="line"><a name="l04458"></a><span class="lineno"> 4458</span>&#160;                                     *unifiedCovMatrix); <span class="comment">// output</span></div>
<div class="line"><a name="l04459"></a><span class="lineno"> 4459</span>&#160;    }</div>
<div class="line"><a name="l04460"></a><span class="lineno"> 4460</span>&#160;</div>
<div class="line"><a name="l04461"></a><span class="lineno"> 4461</span>&#160;    <span class="comment">//***********************************************************</span></div>
<div class="line"><a name="l04462"></a><span class="lineno"> 4462</span>&#160;    <span class="comment">// Step 5 of 11: create *unified* finite distribution for current level</span></div>
<div class="line"><a name="l04463"></a><span class="lineno"> 4463</span>&#160;    <span class="comment">//***********************************************************</span></div>
<div class="line"><a name="l04464"></a><span class="lineno"> 4464</span>&#160;    <a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a1b1f8ccb4823bdfa26ec652f0807c63e">m_currStep</a> = 5;</div>
<div class="line"><a name="l04465"></a><span class="lineno"> 4465</span>&#160;    std::vector&lt;unsigned int&gt; unifiedIndexCountersAtProc0Only(0);</div>
<div class="line"><a name="l04466"></a><span class="lineno"> 4466</span>&#160;    std::vector&lt;double&gt;       unifiedWeightStdVectorAtProc0Only(0); <span class="comment">// KAUST, to check</span></div>
<div class="line"><a name="l04467"></a><span class="lineno"> 4467</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#ae106b5bb8a80b655b88b3a26b1e7c185">inter0Rank</a>() &gt;= 0) {</div>
<div class="line"><a name="l04468"></a><span class="lineno"> 4468</span>&#160;      <a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a3db529d364d5bb47916066d7cc21cb00">generateSequence_Step05_inter0</a>(currUnifiedRequestedNumSamples,     <span class="comment">// input</span></div>
<div class="line"><a name="l04469"></a><span class="lineno"> 4469</span>&#160;                                     weightSequence,                     <span class="comment">// input</span></div>
<div class="line"><a name="l04470"></a><span class="lineno"> 4470</span>&#160;                                     unifiedIndexCountersAtProc0Only,    <span class="comment">// output</span></div>
<div class="line"><a name="l04471"></a><span class="lineno"> 4471</span>&#160;                                     unifiedWeightStdVectorAtProc0Only); <span class="comment">// output</span></div>
<div class="line"><a name="l04472"></a><span class="lineno"> 4472</span>&#160;    }</div>
<div class="line"><a name="l04473"></a><span class="lineno"> 4473</span>&#160;</div>
<div class="line"><a name="l04474"></a><span class="lineno"> 4474</span>&#160;    <span class="comment">//***********************************************************</span></div>
<div class="line"><a name="l04475"></a><span class="lineno"> 4475</span>&#160;    <span class="comment">// Step 6 of 11: decide on using balanced chains or not</span></div>
<div class="line"><a name="l04476"></a><span class="lineno"> 4476</span>&#160;    <span class="comment">//***********************************************************</span></div>
<div class="line"><a name="l04477"></a><span class="lineno"> 4477</span>&#160;    <a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a1b1f8ccb4823bdfa26ec652f0807c63e">m_currStep</a> = 6;</div>
<div class="line"><a name="l04478"></a><span class="lineno"> 4478</span>&#160;    useBalancedChains = <span class="keyword">false</span>;</div>
<div class="line"><a name="l04479"></a><span class="lineno"> 4479</span>&#160;    std::vector&lt;ExchangeInfoStruct&gt; exchangeStdVec(0);</div>
<div class="line"><a name="l04480"></a><span class="lineno"> 4480</span>&#160;    <span class="comment">// All processors should call this routine in order to have the same decision value</span></div>
<div class="line"><a name="l04481"></a><span class="lineno"> 4481</span>&#160;    <a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a21f642100e0690f65563e2c1f8bed816">generateSequence_Step06_all</a>(currOptions,                     <span class="comment">// input</span></div>
<div class="line"><a name="l04482"></a><span class="lineno"> 4482</span>&#160;                                indexOfFirstWeight,              <span class="comment">// input</span></div>
<div class="line"><a name="l04483"></a><span class="lineno"> 4483</span>&#160;                                indexOfLastWeight,               <span class="comment">// input</span></div>
<div class="line"><a name="l04484"></a><span class="lineno"> 4484</span>&#160;                                unifiedIndexCountersAtProc0Only, <span class="comment">// input</span></div>
<div class="line"><a name="l04485"></a><span class="lineno"> 4485</span>&#160;                                useBalancedChains,               <span class="comment">// output</span></div>
<div class="line"><a name="l04486"></a><span class="lineno"> 4486</span>&#160;                                exchangeStdVec);                 <span class="comment">// output</span></div>
<div class="line"><a name="l04487"></a><span class="lineno"> 4487</span>&#160;</div>
<div class="line"><a name="l04488"></a><span class="lineno"> 4488</span>&#160;    <span class="comment">//***********************************************************</span></div>
<div class="line"><a name="l04489"></a><span class="lineno"> 4489</span>&#160;    <span class="comment">// Step 7 of 11: plan for number of linked chains for each node so that all</span></div>
<div class="line"><a name="l04490"></a><span class="lineno"> 4490</span>&#160;    <span class="comment">//               nodes generate the closest possible to the same number of positions</span></div>
<div class="line"><a name="l04491"></a><span class="lineno"> 4491</span>&#160;    <span class="comment">//***********************************************************</span></div>
<div class="line"><a name="l04492"></a><span class="lineno"> 4492</span>&#160;    <a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a1b1f8ccb4823bdfa26ec652f0807c63e">m_currStep</a> = 7;</div>
<div class="line"><a name="l04493"></a><span class="lineno"> 4493</span>&#160;    balancedLinkControl   = <span class="keyword">new</span> BalancedLinkedChainsPerNodeStruct&lt;P_V&gt;();</div>
<div class="line"><a name="l04494"></a><span class="lineno"> 4494</span>&#160;    unbalancedLinkControl = <span class="keyword">new</span> UnbalancedLinkedChainsPerNodeStruct   ();</div>
<div class="line"><a name="l04495"></a><span class="lineno"> 4495</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#ae106b5bb8a80b655b88b3a26b1e7c185">inter0Rank</a>() &gt;= 0) {</div>
<div class="line"><a name="l04496"></a><span class="lineno"> 4496</span>&#160;      <a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a270d639f90f6f2c60d1af851eea63d41">generateSequence_Step07_inter0</a>(useBalancedChains,               <span class="comment">// input</span></div>
<div class="line"><a name="l04497"></a><span class="lineno"> 4497</span>&#160;                                     indexOfFirstWeight,              <span class="comment">// input</span></div>
<div class="line"><a name="l04498"></a><span class="lineno"> 4498</span>&#160;                                     indexOfLastWeight,               <span class="comment">// input</span></div>
<div class="line"><a name="l04499"></a><span class="lineno"> 4499</span>&#160;                                     unifiedIndexCountersAtProc0Only, <span class="comment">// input</span></div>
<div class="line"><a name="l04500"></a><span class="lineno"> 4500</span>&#160;                                     *unbalancedLinkControl,          <span class="comment">// (possible) output</span></div>
<div class="line"><a name="l04501"></a><span class="lineno"> 4501</span>&#160;                                     currOptions,                     <span class="comment">// input</span></div>
<div class="line"><a name="l04502"></a><span class="lineno"> 4502</span>&#160;                                     *prevChain,                      <span class="comment">// input</span></div>
<div class="line"><a name="l04503"></a><span class="lineno"> 4503</span>&#160;                                     exchangeStdVec,                  <span class="comment">// (possible) input/output</span></div>
<div class="line"><a name="l04504"></a><span class="lineno"> 4504</span>&#160;                                     *balancedLinkControl);           <span class="comment">// (possible) output</span></div>
<div class="line"><a name="l04505"></a><span class="lineno"> 4505</span>&#160;    }</div>
<div class="line"><a name="l04506"></a><span class="lineno"> 4506</span>&#160;</div>
<div class="line"><a name="l04507"></a><span class="lineno"> 4507</span>&#160;    <span class="comment">// aqui: prevChain might not be needed anymore. Delete it to save memory</span></div>
<div class="line"><a name="l04508"></a><span class="lineno"> 4508</span>&#160;</div>
<div class="line"><a name="l04509"></a><span class="lineno"> 4509</span>&#160;    <span class="comment">//***********************************************************</span></div>
<div class="line"><a name="l04510"></a><span class="lineno"> 4510</span>&#160;    <span class="comment">// Step 8 of 11: create vector RV for current level</span></div>
<div class="line"><a name="l04511"></a><span class="lineno"> 4511</span>&#160;    <span class="comment">//***********************************************************</span></div>
<div class="line"><a name="l04512"></a><span class="lineno"> 4512</span>&#160;    <a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a1b1f8ccb4823bdfa26ec652f0807c63e">m_currStep</a> = 8;</div>
<div class="line"><a name="l04513"></a><span class="lineno"> 4513</span>&#160;    currPdf = <span class="keyword">new</span> BayesianJointPdf&lt;P_V,P_M&gt; (<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#af8504cc57ec72b3c52833826b2bfff8e">m_options</a>.<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling_options.html#a1d3d48598e0b59b46337ce66a52671a5">m_prefix</a>.c_str(),</div>
<div class="line"><a name="l04514"></a><span class="lineno"> 4514</span>&#160;                                                    <a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#aa45e9c06bd51cae0dc2294af1831c158">m_priorRv</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_vector_r_v.html#a3206740e05e0c64a88273029e963b185">pdf</a>(),</div>
<div class="line"><a name="l04515"></a><span class="lineno"> 4515</span>&#160;                                                    <a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#ab08c3059d23460db49b229aa88bd4e70">m_likelihoodFunction</a>,</div>
<div class="line"><a name="l04516"></a><span class="lineno"> 4516</span>&#160;                                                    currExponent,</div>
<div class="line"><a name="l04517"></a><span class="lineno"> 4517</span>&#160;                                                    *<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a21525858e93a7d9654fdf68c8ac25576">m_targetDomain</a>);</div>
<div class="line"><a name="l04518"></a><span class="lineno"> 4518</span>&#160;</div>
<div class="line"><a name="l04519"></a><span class="lineno"> 4519</span>&#160;    currRv = <span class="keyword">new</span> GenericVectorRV&lt;P_V,P_M&gt; (<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#af8504cc57ec72b3c52833826b2bfff8e">m_options</a>.<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling_options.html#a1d3d48598e0b59b46337ce66a52671a5">m_prefix</a>.c_str(),</div>
<div class="line"><a name="l04520"></a><span class="lineno"> 4520</span>&#160;                                                  *<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a21525858e93a7d9654fdf68c8ac25576">m_targetDomain</a>);</div>
<div class="line"><a name="l04521"></a><span class="lineno"> 4521</span>&#160;</div>
<div class="line"><a name="l04522"></a><span class="lineno"> 4522</span>&#160;    <span class="comment">// All nodes should set &#39;currRv&#39;</span></div>
<div class="line"><a name="l04523"></a><span class="lineno"> 4523</span>&#160;    <a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a754bc11c7802f627fece9f063450739a">generateSequence_Step08_all</a>(*currPdf,</div>
<div class="line"><a name="l04524"></a><span class="lineno"> 4524</span>&#160;                                *currRv);</div>
<div class="line"><a name="l04525"></a><span class="lineno"> 4525</span>&#160;</div>
<div class="line"><a name="l04526"></a><span class="lineno"> 4526</span>&#160;    <span class="comment">//***********************************************************</span></div>
<div class="line"><a name="l04527"></a><span class="lineno"> 4527</span>&#160;    <span class="comment">// Step 9 of 11: scale unified covariance matrix until min &lt;= rejection rate &lt;= max</span></div>
<div class="line"><a name="l04528"></a><span class="lineno"> 4528</span>&#160;    <span class="comment">//***********************************************************</span></div>
<div class="line"><a name="l04529"></a><span class="lineno"> 4529</span>&#160;    <a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a1b1f8ccb4823bdfa26ec652f0807c63e">m_currStep</a> = 9;</div>
<div class="line"><a name="l04530"></a><span class="lineno"> 4530</span>&#160;    <a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a26892288f3b1902d78ba049b96579a08">generateSequence_Step09_all</a>(*prevChain,                        <span class="comment">// input</span></div>
<div class="line"><a name="l04531"></a><span class="lineno"> 4531</span>&#160;                                indexOfFirstWeight,                <span class="comment">// input</span></div>
<div class="line"><a name="l04532"></a><span class="lineno"> 4532</span>&#160;                                indexOfLastWeight,                 <span class="comment">// input</span></div>
<div class="line"><a name="l04533"></a><span class="lineno"> 4533</span>&#160;                                unifiedWeightStdVectorAtProc0Only, <span class="comment">// input</span></div>
<div class="line"><a name="l04534"></a><span class="lineno"> 4534</span>&#160;                                weightSequence,                    <span class="comment">// input</span></div>
<div class="line"><a name="l04535"></a><span class="lineno"> 4535</span>&#160;                                prevEta,                           <span class="comment">// input</span></div>
<div class="line"><a name="l04536"></a><span class="lineno"> 4536</span>&#160;                                *currRv,                           <span class="comment">// input</span></div>
<div class="line"><a name="l04537"></a><span class="lineno"> 4537</span>&#160;                                currOptions,                       <span class="comment">// input (changed temporarily internally)</span></div>
<div class="line"><a name="l04538"></a><span class="lineno"> 4538</span>&#160;                                *unifiedCovMatrix,                 <span class="comment">// input/output</span></div>
<div class="line"><a name="l04539"></a><span class="lineno"> 4539</span>&#160;                                currEta);                          <span class="comment">// output</span></div>
<div class="line"><a name="l04540"></a><span class="lineno"> 4540</span>&#160;</div>
<div class="line"><a name="l04541"></a><span class="lineno"> 4541</span>&#160;    tryExponentEta = <span class="keyword">false</span>; <span class="comment">// gpmsa1</span></div>
<div class="line"><a name="l04542"></a><span class="lineno"> 4542</span>&#160;    <span class="keywordflow">if</span> ((currOptions-&gt;m_minAcceptableEta &gt; 0.     ) &amp;&amp; <span class="comment">// gpmsa1</span></div>
<div class="line"><a name="l04543"></a><span class="lineno"> 4543</span>&#160;        (currEta &lt; currOptions-&gt;m_minAcceptableEta)) {</div>
<div class="line"><a name="l04544"></a><span class="lineno"> 4544</span>&#160;      <span class="keywordflow">if</span> ((<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#a8a0064746ae8dddfece4229b9ad374d6">subDisplayFile</a>()) &amp;&amp; (<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#a1fe5f244fc0316a0ab3e37463f108b96">displayVerbosity</a>() &gt;= 0)) {</div>
<div class="line"><a name="l04545"></a><span class="lineno"> 4545</span>&#160;        *<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#a8a0064746ae8dddfece4229b9ad374d6">subDisplayFile</a>() &lt;&lt; <span class="stringliteral">&quot;In MLSampling&lt;P_V,P_M&gt;::generateSequence()&quot;</span></div>
<div class="line"><a name="l04546"></a><span class="lineno"> 4546</span>&#160;                                &lt;&lt; <span class="stringliteral">&quot;, level &quot;</span> &lt;&lt; <a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#af9416874c856e50f3b35270e801f17e4">m_currLevel</a>+<a class="code" href="_m_l_sampling_level_options_8h.html#a68d15eaf394d210effcf584b938206d3">LEVEL_REF_ID</a></div>
<div class="line"><a name="l04547"></a><span class="lineno"> 4547</span>&#160;                                &lt;&lt; <span class="stringliteral">&quot;, preparing to retry ExponentEta&quot;</span></div>
<div class="line"><a name="l04548"></a><span class="lineno"> 4548</span>&#160;                                &lt;&lt; <span class="stringliteral">&quot;: currExponent = &quot;</span> &lt;&lt; currExponent</div>
<div class="line"><a name="l04549"></a><span class="lineno"> 4549</span>&#160;                                &lt;&lt; <span class="stringliteral">&quot;, currEta = &quot;</span>      &lt;&lt; currEta</div>
<div class="line"><a name="l04550"></a><span class="lineno"> 4550</span>&#160;                                &lt;&lt; std::endl;</div>
<div class="line"><a name="l04551"></a><span class="lineno"> 4551</span>&#160;      }</div>
<div class="line"><a name="l04552"></a><span class="lineno"> 4552</span>&#160;      exponentEtaTriedAmount++;</div>
<div class="line"><a name="l04553"></a><span class="lineno"> 4553</span>&#160;      tryExponentEta = <span class="keyword">true</span>;</div>
<div class="line"><a name="l04554"></a><span class="lineno"> 4554</span>&#160;      failedExponent = currExponent;</div>
<div class="line"><a name="l04555"></a><span class="lineno"> 4555</span>&#160;      failedEta      = currEta;</div>
<div class="line"><a name="l04556"></a><span class="lineno"> 4556</span>&#160;</div>
<div class="line"><a name="l04557"></a><span class="lineno"> 4557</span>&#160;      <span class="comment">// &quot;Return&quot; to previous level</span></div>
<div class="line"><a name="l04558"></a><span class="lineno"> 4558</span>&#160;      <span class="keyword">delete</span> currRv;                 <span class="comment">// Step 8</span></div>
<div class="line"><a name="l04559"></a><span class="lineno"> 4559</span>&#160;      currRv = NULL;                 <span class="comment">// Step 8</span></div>
<div class="line"><a name="l04560"></a><span class="lineno"> 4560</span>&#160;      <span class="keyword">delete</span> currPdf;                <span class="comment">// Step 8</span></div>
<div class="line"><a name="l04561"></a><span class="lineno"> 4561</span>&#160;      currPdf = NULL;                <span class="comment">// Step 8</span></div>
<div class="line"><a name="l04562"></a><span class="lineno"> 4562</span>&#160;</div>
<div class="line"><a name="l04563"></a><span class="lineno"> 4563</span>&#160;      <span class="keyword">delete</span> balancedLinkControl;    <span class="comment">// Step 7</span></div>
<div class="line"><a name="l04564"></a><span class="lineno"> 4564</span>&#160;      balancedLinkControl   = NULL;  <span class="comment">// Step 7</span></div>
<div class="line"><a name="l04565"></a><span class="lineno"> 4565</span>&#160;      <span class="keyword">delete</span> unbalancedLinkControl;  <span class="comment">// Step 7</span></div>
<div class="line"><a name="l04566"></a><span class="lineno"> 4566</span>&#160;      unbalancedLinkControl = NULL;  <span class="comment">// Step 7</span></div>
<div class="line"><a name="l04567"></a><span class="lineno"> 4567</span>&#160;</div>
<div class="line"><a name="l04568"></a><span class="lineno"> 4568</span>&#160;      <span class="keyword">delete</span> unifiedCovMatrix;       <span class="comment">// Step 4</span></div>
<div class="line"><a name="l04569"></a><span class="lineno"> 4569</span>&#160;      unifiedCovMatrix = NULL;       <span class="comment">// Step 4</span></div>
<div class="line"><a name="l04570"></a><span class="lineno"> 4570</span>&#160;</div>
<div class="line"><a name="l04571"></a><span class="lineno"> 4571</span>&#160;      currExponent                   = prevExponent;</div>
<div class="line"><a name="l04572"></a><span class="lineno"> 4572</span>&#160;      currEta                        = 1.; <span class="comment">// prevEta;</span></div>
<div class="line"><a name="l04573"></a><span class="lineno"> 4573</span>&#160;      currUnifiedRequestedNumSamples = prevUnifiedRequestedNumSamples;</div>
<div class="line"><a name="l04574"></a><span class="lineno"> 4574</span>&#160;</div>
<div class="line"><a name="l04575"></a><span class="lineno"> 4575</span>&#160;      currChain.clear();             <span class="comment">// Step 2</span></div>
<div class="line"><a name="l04576"></a><span class="lineno"> 4576</span>&#160;      currChain = (*prevChain);      <span class="comment">// Step 2</span></div>
<div class="line"><a name="l04577"></a><span class="lineno"> 4577</span>&#160;      <span class="keyword">delete</span> prevChain;              <span class="comment">// Step 2</span></div>
<div class="line"><a name="l04578"></a><span class="lineno"> 4578</span>&#160;      prevChain = NULL;              <span class="comment">// Step 2</span></div>
<div class="line"><a name="l04579"></a><span class="lineno"> 4579</span>&#160;</div>
<div class="line"><a name="l04580"></a><span class="lineno"> 4580</span>&#160;      currLogLikelihoodValues        = prevLogLikelihoodValues;</div>
<div class="line"><a name="l04581"></a><span class="lineno"> 4581</span>&#160;      currLogTargetValues            = prevLogTargetValues;</div>
<div class="line"><a name="l04582"></a><span class="lineno"> 4582</span>&#160;    }</div>
<div class="line"><a name="l04583"></a><span class="lineno"> 4583</span>&#160;    } <span class="comment">// while (tryExponentEta) // gpmsa1</span></div>
<div class="line"><a name="l04584"></a><span class="lineno"> 4584</span>&#160;</div>
<div class="line"><a name="l04585"></a><span class="lineno"> 4585</span>&#160;    <span class="keywordflow">if</span> ((<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#a8a0064746ae8dddfece4229b9ad374d6">subDisplayFile</a>()) &amp;&amp; (<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#a1fe5f244fc0316a0ab3e37463f108b96">displayVerbosity</a>() &gt;= 0)) { <span class="comment">// gpmsa1</span></div>
<div class="line"><a name="l04586"></a><span class="lineno"> 4586</span>&#160;      *<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#a8a0064746ae8dddfece4229b9ad374d6">subDisplayFile</a>() &lt;&lt; <span class="stringliteral">&quot;In MLSampling&lt;P_V,P_M&gt;::generateSequence()&quot;</span></div>
<div class="line"><a name="l04587"></a><span class="lineno"> 4587</span>&#160;                              &lt;&lt; <span class="stringliteral">&quot;, level &quot;</span> &lt;&lt; <a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#af9416874c856e50f3b35270e801f17e4">m_currLevel</a>+<a class="code" href="_m_l_sampling_level_options_8h.html#a68d15eaf394d210effcf584b938206d3">LEVEL_REF_ID</a></div>
<div class="line"><a name="l04588"></a><span class="lineno"> 4588</span>&#160;                              &lt;&lt; <span class="stringliteral">&quot;, exited &#39;do-while(tryExponentEta)&quot;</span></div>
<div class="line"><a name="l04589"></a><span class="lineno"> 4589</span>&#160;                              &lt;&lt; <span class="stringliteral">&quot;, failedExponent = &quot;</span> &lt;&lt; failedExponent</div>
<div class="line"><a name="l04590"></a><span class="lineno"> 4590</span>&#160;                              &lt;&lt; <span class="stringliteral">&quot;, failedEta = &quot;</span>      &lt;&lt; failedEta</div>
<div class="line"><a name="l04591"></a><span class="lineno"> 4591</span>&#160;                              &lt;&lt; std::endl;</div>
<div class="line"><a name="l04592"></a><span class="lineno"> 4592</span>&#160;    }</div>
<div class="line"><a name="l04593"></a><span class="lineno"> 4593</span>&#160;</div>
<div class="line"><a name="l04594"></a><span class="lineno"> 4594</span>&#160;    <span class="comment">//***********************************************************</span></div>
<div class="line"><a name="l04595"></a><span class="lineno"> 4595</span>&#160;    <span class="comment">// Step 10 of 11: sample vector RV of current level</span></div>
<div class="line"><a name="l04596"></a><span class="lineno"> 4596</span>&#160;    <span class="comment">//***********************************************************</span></div>
<div class="line"><a name="l04597"></a><span class="lineno"> 4597</span>&#160;    <a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a1b1f8ccb4823bdfa26ec652f0807c63e">m_currStep</a> = 10;</div>
<div class="line"><a name="l04598"></a><span class="lineno"> 4598</span>&#160;    <span class="comment">// All nodes should call here</span></div>
<div class="line"><a name="l04599"></a><span class="lineno"> 4599</span>&#160;    <a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a04322fda4c97eee6c6739fc007d642c1">generateSequence_Step10_all</a>(*currOptions,                 <span class="comment">// input (changed temporarily internally)</span></div>
<div class="line"><a name="l04600"></a><span class="lineno"> 4600</span>&#160;                                *unifiedCovMatrix,            <span class="comment">// input</span></div>
<div class="line"><a name="l04601"></a><span class="lineno"> 4601</span>&#160;                                *currRv,                      <span class="comment">// input</span></div>
<div class="line"><a name="l04602"></a><span class="lineno"> 4602</span>&#160;                                useBalancedChains,            <span class="comment">// input</span></div>
<div class="line"><a name="l04603"></a><span class="lineno"> 4603</span>&#160;                                *unbalancedLinkControl,       <span class="comment">// input // Round Rock</span></div>
<div class="line"><a name="l04604"></a><span class="lineno"> 4604</span>&#160;                                indexOfFirstWeight,           <span class="comment">// input // Round Rock</span></div>
<div class="line"><a name="l04605"></a><span class="lineno"> 4605</span>&#160;                                *prevChain,                   <span class="comment">// input // Round Rock</span></div>
<div class="line"><a name="l04606"></a><span class="lineno"> 4606</span>&#160;                                *balancedLinkControl,         <span class="comment">// input // Round Rock</span></div>
<div class="line"><a name="l04607"></a><span class="lineno"> 4607</span>&#160;                                currChain,                    <span class="comment">// output</span></div>
<div class="line"><a name="l04608"></a><span class="lineno"> 4608</span>&#160;                                cumulativeRawChainRunTime,    <span class="comment">// output</span></div>
<div class="line"><a name="l04609"></a><span class="lineno"> 4609</span>&#160;                                cumulativeRawChainRejections, <span class="comment">// output</span></div>
<div class="line"><a name="l04610"></a><span class="lineno"> 4610</span>&#160;                                &amp;currLogLikelihoodValues,     <span class="comment">// output // likelihood is important</span></div>
<div class="line"><a name="l04611"></a><span class="lineno"> 4611</span>&#160;                                &amp;currLogTargetValues);        <span class="comment">// output);</span></div>
<div class="line"><a name="l04612"></a><span class="lineno"> 4612</span>&#160;</div>
<div class="line"><a name="l04613"></a><span class="lineno"> 4613</span>&#160;    <span class="comment">//***********************************************************</span></div>
<div class="line"><a name="l04614"></a><span class="lineno"> 4614</span>&#160;    <span class="comment">// Perform checkpoint if necessary</span></div>
<div class="line"><a name="l04615"></a><span class="lineno"> 4615</span>&#160;    <span class="comment">//***********************************************************</span></div>
<div class="line"><a name="l04616"></a><span class="lineno"> 4616</span>&#160;    stopAtEndOfLevel = currOptions-&gt;m_stopAtEnd;</div>
<div class="line"><a name="l04617"></a><span class="lineno"> 4617</span>&#160;    <span class="keywordtype">bool</span> performCheckpoint = stopAtEndOfLevel;</div>
<div class="line"><a name="l04618"></a><span class="lineno"> 4618</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#af8504cc57ec72b3c52833826b2bfff8e">m_options</a>.m_restartOutput_levelPeriod &gt; 0) {</div>
<div class="line"><a name="l04619"></a><span class="lineno"> 4619</span>&#160;      performCheckpoint = performCheckpoint || ( ((<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#af9416874c856e50f3b35270e801f17e4">m_currLevel</a> + 1) % <a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#af8504cc57ec72b3c52833826b2bfff8e">m_options</a>.m_restartOutput_levelPeriod) == 0 );</div>
<div class="line"><a name="l04620"></a><span class="lineno"> 4620</span>&#160;      <span class="keywordflow">if</span> (currExponent == 1.) {</div>
<div class="line"><a name="l04621"></a><span class="lineno"> 4621</span>&#160;        performCheckpoint = <span class="keyword">true</span>;</div>
<div class="line"><a name="l04622"></a><span class="lineno"> 4622</span>&#160;      }</div>
<div class="line"><a name="l04623"></a><span class="lineno"> 4623</span>&#160;    }</div>
<div class="line"><a name="l04624"></a><span class="lineno"> 4624</span>&#160;    <span class="keywordflow">if</span> (performCheckpoint) {</div>
<div class="line"><a name="l04625"></a><span class="lineno"> 4625</span>&#160;      <a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#aa8e7bb1bd54ccafb9b276127a76eba71">checkpointML</a>(currExponent,            <span class="comment">// input</span></div>
<div class="line"><a name="l04626"></a><span class="lineno"> 4626</span>&#160;                   currEta,                 <span class="comment">// input</span></div>
<div class="line"><a name="l04627"></a><span class="lineno"> 4627</span>&#160;                   currChain,               <span class="comment">// input</span></div>
<div class="line"><a name="l04628"></a><span class="lineno"> 4628</span>&#160;                   currLogLikelihoodValues, <span class="comment">// input</span></div>
<div class="line"><a name="l04629"></a><span class="lineno"> 4629</span>&#160;                   currLogTargetValues);    <span class="comment">// input</span></div>
<div class="line"><a name="l04630"></a><span class="lineno"> 4630</span>&#160;    }</div>
<div class="line"><a name="l04631"></a><span class="lineno"> 4631</span>&#160;</div>
<div class="line"><a name="l04632"></a><span class="lineno"> 4632</span>&#160;    <span class="comment">//***********************************************************</span></div>
<div class="line"><a name="l04633"></a><span class="lineno"> 4633</span>&#160;    <span class="comment">// Just free some memory</span></div>
<div class="line"><a name="l04634"></a><span class="lineno"> 4634</span>&#160;    <span class="comment">//***********************************************************</span></div>
<div class="line"><a name="l04635"></a><span class="lineno"> 4635</span>&#160;    {</div>
<div class="line"><a name="l04636"></a><span class="lineno"> 4636</span>&#160;      <span class="keyword">delete</span> unifiedCovMatrix;</div>
<div class="line"><a name="l04637"></a><span class="lineno"> 4637</span>&#160;</div>
<div class="line"><a name="l04638"></a><span class="lineno"> 4638</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = 0; i &lt; balancedLinkControl-&gt;balLinkedChains.size(); ++i) {</div>
<div class="line"><a name="l04639"></a><span class="lineno"> 4639</span>&#160;        <a class="code" href="_defines_8h.html#a56d63d18d0a6d45757de47fcc06f574d">UQ_FATAL_TEST_MACRO</a>(balancedLinkControl-&gt;balLinkedChains[i].initialPosition == NULL,</div>
<div class="line"><a name="l04640"></a><span class="lineno"> 4640</span>&#160;                            <a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#a78b57112bbd0e6dd0e8afec00b40ffa7">worldRank</a>(),</div>
<div class="line"><a name="l04641"></a><span class="lineno"> 4641</span>&#160;                            <span class="stringliteral">&quot;MLSampling&lt;P_V,P_M&gt;::generateSequence()&quot;</span>,</div>
<div class="line"><a name="l04642"></a><span class="lineno"> 4642</span>&#160;                            <span class="stringliteral">&quot;Initial position pointer in step 9 should not be NULL&quot;</span>);</div>
<div class="line"><a name="l04643"></a><span class="lineno"> 4643</span>&#160;        <span class="keyword">delete</span> balancedLinkControl-&gt;balLinkedChains[i].initialPosition;</div>
<div class="line"><a name="l04644"></a><span class="lineno"> 4644</span>&#160;        balancedLinkControl-&gt;balLinkedChains[i].initialPosition = NULL;</div>
<div class="line"><a name="l04645"></a><span class="lineno"> 4645</span>&#160;      }</div>
<div class="line"><a name="l04646"></a><span class="lineno"> 4646</span>&#160;      balancedLinkControl-&gt;balLinkedChains.clear();</div>
<div class="line"><a name="l04647"></a><span class="lineno"> 4647</span>&#160;    }</div>
<div class="line"><a name="l04648"></a><span class="lineno"> 4648</span>&#160;</div>
<div class="line"><a name="l04649"></a><span class="lineno"> 4649</span>&#160;    <span class="comment">//***********************************************************</span></div>
<div class="line"><a name="l04650"></a><span class="lineno"> 4650</span>&#160;    <span class="comment">// Step 11 of 11: filter chain if requested</span></div>
<div class="line"><a name="l04651"></a><span class="lineno"> 4651</span>&#160;    <span class="comment">//***********************************************************</span></div>
<div class="line"><a name="l04652"></a><span class="lineno"> 4652</span>&#160;    <a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a1b1f8ccb4823bdfa26ec652f0807c63e">m_currStep</a> = 11;</div>
<div class="line"><a name="l04653"></a><span class="lineno"> 4653</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> unifiedNumberOfRejections = 0;</div>
<div class="line"><a name="l04654"></a><span class="lineno"> 4654</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#ae106b5bb8a80b655b88b3a26b1e7c185">inter0Rank</a>() &gt;= 0) {</div>
<div class="line"><a name="l04655"></a><span class="lineno"> 4655</span>&#160;      <a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#aae527304bc1012a91ffc396e94fbab11">generateSequence_Step11_inter0</a>(currOptions,                      <span class="comment">// input</span></div>
<div class="line"><a name="l04656"></a><span class="lineno"> 4656</span>&#160;                                     currUnifiedRequestedNumSamples,   <span class="comment">// input</span></div>
<div class="line"><a name="l04657"></a><span class="lineno"> 4657</span>&#160;                                     cumulativeRawChainRejections,     <span class="comment">// input</span></div>
<div class="line"><a name="l04658"></a><span class="lineno"> 4658</span>&#160;                                     currChain,                        <span class="comment">// input/output</span></div>
<div class="line"><a name="l04659"></a><span class="lineno"> 4659</span>&#160;                                     currLogLikelihoodValues,          <span class="comment">// input/output</span></div>
<div class="line"><a name="l04660"></a><span class="lineno"> 4660</span>&#160;                                     currLogTargetValues,              <span class="comment">// input/output</span></div>
<div class="line"><a name="l04661"></a><span class="lineno"> 4661</span>&#160;                                     unifiedNumberOfRejections);       <span class="comment">// output</span></div>
<div class="line"><a name="l04662"></a><span class="lineno"> 4662</span>&#160;    }</div>
<div class="line"><a name="l04663"></a><span class="lineno"> 4663</span>&#160;</div>
<div class="line"><a name="l04664"></a><span class="lineno"> 4664</span>&#160;    minLogLike = -INFINITY;</div>
<div class="line"><a name="l04665"></a><span class="lineno"> 4665</span>&#160;    maxLogLike =  INFINITY;</div>
<div class="line"><a name="l04666"></a><span class="lineno"> 4666</span>&#160;    currLogLikelihoodValues.subMinMaxExtra(0,</div>
<div class="line"><a name="l04667"></a><span class="lineno"> 4667</span>&#160;                                           currLogLikelihoodValues.subSequenceSize(),</div>
<div class="line"><a name="l04668"></a><span class="lineno"> 4668</span>&#160;                                           minLogLike,</div>
<div class="line"><a name="l04669"></a><span class="lineno"> 4669</span>&#160;                                           maxLogLike);</div>
<div class="line"><a name="l04670"></a><span class="lineno"> 4670</span>&#160;    <span class="keywordflow">if</span> ((<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#a8a0064746ae8dddfece4229b9ad374d6">subDisplayFile</a>()) &amp;&amp; (<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#a1fe5f244fc0316a0ab3e37463f108b96">displayVerbosity</a>() &gt;= 0)) {</div>
<div class="line"><a name="l04671"></a><span class="lineno"> 4671</span>&#160;      *<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#a8a0064746ae8dddfece4229b9ad374d6">subDisplayFile</a>() &lt;&lt; <span class="stringliteral">&quot;In MLSampling&lt;P_V,P_M&gt;::generateSequence()&quot;</span></div>
<div class="line"><a name="l04672"></a><span class="lineno"> 4672</span>&#160;                              &lt;&lt; <span class="stringliteral">&quot;: at end of level &quot;</span>  &lt;&lt; <a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#af9416874c856e50f3b35270e801f17e4">m_currLevel</a>+<a class="code" href="_m_l_sampling_level_options_8h.html#a68d15eaf394d210effcf584b938206d3">LEVEL_REF_ID</a></div>
<div class="line"><a name="l04673"></a><span class="lineno"> 4673</span>&#160;                              &lt;&lt; <span class="stringliteral">&quot;, sub minLogLike = &quot;</span> &lt;&lt; minLogLike</div>
<div class="line"><a name="l04674"></a><span class="lineno"> 4674</span>&#160;                              &lt;&lt; <span class="stringliteral">&quot;, sub maxLogLike = &quot;</span> &lt;&lt; maxLogLike</div>
<div class="line"><a name="l04675"></a><span class="lineno"> 4675</span>&#160;                              &lt;&lt; std::endl;</div>
<div class="line"><a name="l04676"></a><span class="lineno"> 4676</span>&#160;    }</div>
<div class="line"><a name="l04677"></a><span class="lineno"> 4677</span>&#160;</div>
<div class="line"><a name="l04678"></a><span class="lineno"> 4678</span>&#160;    <a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#a0b0779b41ff304058856e97e1d16b4d4">fullComm</a>().<a class="code" href="class_q_u_e_s_o_1_1_mpi_comm.html#a4059971c30e023b272fccaa6aa00c426">Barrier</a>();</div>
<div class="line"><a name="l04679"></a><span class="lineno"> 4679</span>&#160;</div>
<div class="line"><a name="l04680"></a><span class="lineno"> 4680</span>&#160;    minLogLike = -INFINITY;</div>
<div class="line"><a name="l04681"></a><span class="lineno"> 4681</span>&#160;    maxLogLike =  INFINITY;</div>
<div class="line"><a name="l04682"></a><span class="lineno"> 4682</span>&#160;    currLogLikelihoodValues.unifiedMinMaxExtra(m_vectorSpace.numOfProcsForStorage() == 1,</div>
<div class="line"><a name="l04683"></a><span class="lineno"> 4683</span>&#160;                                               0,</div>
<div class="line"><a name="l04684"></a><span class="lineno"> 4684</span>&#160;                                               currLogLikelihoodValues.subSequenceSize(),</div>
<div class="line"><a name="l04685"></a><span class="lineno"> 4685</span>&#160;                                               minLogLike,</div>
<div class="line"><a name="l04686"></a><span class="lineno"> 4686</span>&#160;                                               maxLogLike);</div>
<div class="line"><a name="l04687"></a><span class="lineno"> 4687</span>&#160;    <span class="keywordflow">if</span> ((<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#a8a0064746ae8dddfece4229b9ad374d6">subDisplayFile</a>()) &amp;&amp; (<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#a1fe5f244fc0316a0ab3e37463f108b96">displayVerbosity</a>() &gt;= 0)) {</div>
<div class="line"><a name="l04688"></a><span class="lineno"> 4688</span>&#160;      *<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#a8a0064746ae8dddfece4229b9ad374d6">subDisplayFile</a>() &lt;&lt; <span class="stringliteral">&quot;In MLSampling&lt;P_V,P_M&gt;::generateSequence()&quot;</span></div>
<div class="line"><a name="l04689"></a><span class="lineno"> 4689</span>&#160;                              &lt;&lt; <span class="stringliteral">&quot;: at end of level &quot;</span>      &lt;&lt; <a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#af9416874c856e50f3b35270e801f17e4">m_currLevel</a>+<a class="code" href="_m_l_sampling_level_options_8h.html#a68d15eaf394d210effcf584b938206d3">LEVEL_REF_ID</a></div>
<div class="line"><a name="l04690"></a><span class="lineno"> 4690</span>&#160;                              &lt;&lt; <span class="stringliteral">&quot;, unified minLogLike = &quot;</span> &lt;&lt; minLogLike</div>
<div class="line"><a name="l04691"></a><span class="lineno"> 4691</span>&#160;                              &lt;&lt; <span class="stringliteral">&quot;, unified maxLogLike = &quot;</span> &lt;&lt; maxLogLike</div>
<div class="line"><a name="l04692"></a><span class="lineno"> 4692</span>&#160;                              &lt;&lt; std::endl;</div>
<div class="line"><a name="l04693"></a><span class="lineno"> 4693</span>&#160;    }</div>
<div class="line"><a name="l04694"></a><span class="lineno"> 4694</span>&#160;</div>
<div class="line"><a name="l04695"></a><span class="lineno"> 4695</span>&#160;    <span class="comment">//***********************************************************</span></div>
<div class="line"><a name="l04696"></a><span class="lineno"> 4696</span>&#160;    <span class="comment">// Prepare to end current level</span></div>
<div class="line"><a name="l04697"></a><span class="lineno"> 4697</span>&#160;    <span class="comment">//***********************************************************</span></div>
<div class="line"><a name="l04698"></a><span class="lineno"> 4698</span>&#160;    <span class="keywordtype">double</span> levelRunTime = <a class="code" href="namespace_q_u_e_s_o.html#a424bc33f2e6e287fd468408d14b772ee">MiscGetEllapsedSeconds</a>(&amp;timevalLevel);</div>
<div class="line"><a name="l04699"></a><span class="lineno"> 4699</span>&#160;    <span class="keywordflow">if</span> ((<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#a8a0064746ae8dddfece4229b9ad374d6">subDisplayFile</a>()) &amp;&amp; (<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#a1fe5f244fc0316a0ab3e37463f108b96">displayVerbosity</a>() &gt;= 0)) {</div>
<div class="line"><a name="l04700"></a><span class="lineno"> 4700</span>&#160;      *<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#a8a0064746ae8dddfece4229b9ad374d6">subDisplayFile</a>() &lt;&lt; <span class="stringliteral">&quot;In MLSampling&lt;P_V,P_M&gt;::generateSequence()&quot;</span></div>
<div class="line"><a name="l04701"></a><span class="lineno"> 4701</span>&#160;                              &lt;&lt; <span class="stringliteral">&quot;: ending level &quot;</span>                   &lt;&lt; <a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#af9416874c856e50f3b35270e801f17e4">m_currLevel</a>+<a class="code" href="_m_l_sampling_level_options_8h.html#a68d15eaf394d210effcf584b938206d3">LEVEL_REF_ID</a></div>
<div class="line"><a name="l04702"></a><span class="lineno"> 4702</span>&#160;                              &lt;&lt; <span class="stringliteral">&quot;, having generated &quot;</span>               &lt;&lt; currChain.subSequenceSize()</div>
<div class="line"><a name="l04703"></a><span class="lineno"> 4703</span>&#160;                              &lt;&lt; <span class="stringliteral">&quot; chain positions&quot;</span></div>
<div class="line"><a name="l04704"></a><span class="lineno"> 4704</span>&#160;                              &lt;&lt; <span class="stringliteral">&quot;, cumulativeRawChainRunTime = &quot;</span>    &lt;&lt; cumulativeRawChainRunTime &lt;&lt; <span class="stringliteral">&quot; seconds&quot;</span></div>
<div class="line"><a name="l04705"></a><span class="lineno"> 4705</span>&#160;                              &lt;&lt; <span class="stringliteral">&quot;, total level time = &quot;</span>             &lt;&lt; levelRunTime              &lt;&lt; <span class="stringliteral">&quot; seconds&quot;</span></div>
<div class="line"><a name="l04706"></a><span class="lineno"> 4706</span>&#160;                              &lt;&lt; <span class="stringliteral">&quot;, cumulativeRawChainRejections = &quot;</span> &lt;&lt; cumulativeRawChainRejections</div>
<div class="line"><a name="l04707"></a><span class="lineno"> 4707</span>&#160;                              &lt;&lt; <span class="stringliteral">&quot; (&quot;</span> &lt;&lt; 100.*((double) cumulativeRawChainRejections)/((double) currOptions-&gt;m_rawChainSize)</div>
<div class="line"><a name="l04708"></a><span class="lineno"> 4708</span>&#160;                              &lt;&lt; <span class="stringliteral">&quot;% at this processor)&quot;</span></div>
<div class="line"><a name="l04709"></a><span class="lineno"> 4709</span>&#160;                              &lt;&lt; <span class="stringliteral">&quot; (&quot;</span> &lt;&lt; 100.*((double) unifiedNumberOfRejections)/((double) currUnifiedRequestedNumSamples)</div>
<div class="line"><a name="l04710"></a><span class="lineno"> 4710</span>&#160;                              &lt;&lt; <span class="stringliteral">&quot;% over all processors)&quot;</span></div>
<div class="line"><a name="l04711"></a><span class="lineno"> 4711</span>&#160;                              &lt;&lt; <span class="stringliteral">&quot;, stopAtEndOfLevel = &quot;</span> &lt;&lt; stopAtEndOfLevel</div>
<div class="line"><a name="l04712"></a><span class="lineno"> 4712</span>&#160;                              &lt;&lt; std::endl;</div>
<div class="line"><a name="l04713"></a><span class="lineno"> 4713</span>&#160;    }</div>
<div class="line"><a name="l04714"></a><span class="lineno"> 4714</span>&#160;</div>
<div class="line"><a name="l04715"></a><span class="lineno"> 4715</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#ae106b5bb8a80b655b88b3a26b1e7c185">inter0Rank</a>() &gt;= 0) {</div>
<div class="line"><a name="l04716"></a><span class="lineno"> 4716</span>&#160;      <span class="keywordtype">double</span> minCumulativeRawChainRunTime = 0.;</div>
<div class="line"><a name="l04717"></a><span class="lineno"> 4717</span>&#160;      <a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#a689e4d140c74d495d97eb498714a4b82">inter0Comm</a>().<a class="code" href="class_q_u_e_s_o_1_1_mpi_comm.html#a72e137e60ef8060efb1ee5fc874fa4b8">Allreduce</a>((<span class="keywordtype">void</span> *) &amp;cumulativeRawChainRunTime, (<span class="keywordtype">void</span> *) &amp;minCumulativeRawChainRunTime, (<span class="keywordtype">int</span>) 1, <a class="code" href="_mpi_comm_8h.html#ad0f503bd9fecfe4e570ca3d15aaf2518">RawValue_MPI_DOUBLE</a>, <a class="code" href="_mpi_comm_8h.html#a8e30f42fdac116861205e83e2aa18042">RawValue_MPI_MIN</a>,</div>
<div class="line"><a name="l04718"></a><span class="lineno"> 4718</span>&#160;                                   <span class="stringliteral">&quot;MLSampling&lt;P_V,P_M&gt;::generateSequence()&quot;</span>,</div>
<div class="line"><a name="l04719"></a><span class="lineno"> 4719</span>&#160;                                   <span class="stringliteral">&quot;failed MPI.Allreduce() for min cumulative raw chain run time&quot;</span>);</div>
<div class="line"><a name="l04720"></a><span class="lineno"> 4720</span>&#160;</div>
<div class="line"><a name="l04721"></a><span class="lineno"> 4721</span>&#160;      <span class="keywordtype">double</span> maxCumulativeRawChainRunTime = 0.;</div>
<div class="line"><a name="l04722"></a><span class="lineno"> 4722</span>&#160;      <a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#a689e4d140c74d495d97eb498714a4b82">inter0Comm</a>().<a class="code" href="class_q_u_e_s_o_1_1_mpi_comm.html#a72e137e60ef8060efb1ee5fc874fa4b8">Allreduce</a>((<span class="keywordtype">void</span> *) &amp;cumulativeRawChainRunTime, (<span class="keywordtype">void</span> *) &amp;maxCumulativeRawChainRunTime, (<span class="keywordtype">int</span>) 1, <a class="code" href="_mpi_comm_8h.html#ad0f503bd9fecfe4e570ca3d15aaf2518">RawValue_MPI_DOUBLE</a>, <a class="code" href="_mpi_comm_8h.html#a68f3ac7ff71a6504e236b0c95de78178">RawValue_MPI_MAX</a>,</div>
<div class="line"><a name="l04723"></a><span class="lineno"> 4723</span>&#160;                                   <span class="stringliteral">&quot;MLSampling&lt;P_V,P_M&gt;::generateSequence()&quot;</span>,</div>
<div class="line"><a name="l04724"></a><span class="lineno"> 4724</span>&#160;                                   <span class="stringliteral">&quot;failed MPI.Allreduce() for max cumulative raw chain run time&quot;</span>);</div>
<div class="line"><a name="l04725"></a><span class="lineno"> 4725</span>&#160;</div>
<div class="line"><a name="l04726"></a><span class="lineno"> 4726</span>&#160;      <span class="keywordtype">double</span> avgCumulativeRawChainRunTime = 0.;</div>
<div class="line"><a name="l04727"></a><span class="lineno"> 4727</span>&#160;      <a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#a689e4d140c74d495d97eb498714a4b82">inter0Comm</a>().<a class="code" href="class_q_u_e_s_o_1_1_mpi_comm.html#a72e137e60ef8060efb1ee5fc874fa4b8">Allreduce</a>((<span class="keywordtype">void</span> *) &amp;cumulativeRawChainRunTime, (<span class="keywordtype">void</span> *) &amp;avgCumulativeRawChainRunTime, (<span class="keywordtype">int</span>) 1, <a class="code" href="_mpi_comm_8h.html#ad0f503bd9fecfe4e570ca3d15aaf2518">RawValue_MPI_DOUBLE</a>, <a class="code" href="_mpi_comm_8h.html#afbf78d291c032aa7f512bc566cee2bd1">RawValue_MPI_SUM</a>,</div>
<div class="line"><a name="l04728"></a><span class="lineno"> 4728</span>&#160;                                   <span class="stringliteral">&quot;MLSampling&lt;P_V,P_M&gt;::generateSequence()&quot;</span>,</div>
<div class="line"><a name="l04729"></a><span class="lineno"> 4729</span>&#160;                                   <span class="stringliteral">&quot;failed MPI.Allreduce() for sum cumulative raw chain run time&quot;</span>);</div>
<div class="line"><a name="l04730"></a><span class="lineno"> 4730</span>&#160;      avgCumulativeRawChainRunTime /= ((double) <a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#a689e4d140c74d495d97eb498714a4b82">inter0Comm</a>().<a class="code" href="class_q_u_e_s_o_1_1_mpi_comm.html#aa780721ae0fdeabc5a15e04cb0cad964">NumProc</a>());</div>
<div class="line"><a name="l04731"></a><span class="lineno"> 4731</span>&#160;</div>
<div class="line"><a name="l04732"></a><span class="lineno"> 4732</span>&#160;      <span class="keywordtype">double</span> minLevelRunTime = 0.;</div>
<div class="line"><a name="l04733"></a><span class="lineno"> 4733</span>&#160;      <a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#a689e4d140c74d495d97eb498714a4b82">inter0Comm</a>().<a class="code" href="class_q_u_e_s_o_1_1_mpi_comm.html#a72e137e60ef8060efb1ee5fc874fa4b8">Allreduce</a>((<span class="keywordtype">void</span> *) &amp;levelRunTime, (<span class="keywordtype">void</span> *) &amp;minLevelRunTime, (<span class="keywordtype">int</span>) 1, <a class="code" href="_mpi_comm_8h.html#ad0f503bd9fecfe4e570ca3d15aaf2518">RawValue_MPI_DOUBLE</a>, <a class="code" href="_mpi_comm_8h.html#a8e30f42fdac116861205e83e2aa18042">RawValue_MPI_MIN</a>,</div>
<div class="line"><a name="l04734"></a><span class="lineno"> 4734</span>&#160;                                   <span class="stringliteral">&quot;MLSampling&lt;P_V,P_M&gt;::generateSequence()&quot;</span>,</div>
<div class="line"><a name="l04735"></a><span class="lineno"> 4735</span>&#160;                                   <span class="stringliteral">&quot;failed MPI.Allreduce() for min level run time&quot;</span>);</div>
<div class="line"><a name="l04736"></a><span class="lineno"> 4736</span>&#160;</div>
<div class="line"><a name="l04737"></a><span class="lineno"> 4737</span>&#160;      <span class="keywordtype">double</span> maxLevelRunTime = 0.;</div>
<div class="line"><a name="l04738"></a><span class="lineno"> 4738</span>&#160;      <a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#a689e4d140c74d495d97eb498714a4b82">inter0Comm</a>().<a class="code" href="class_q_u_e_s_o_1_1_mpi_comm.html#a72e137e60ef8060efb1ee5fc874fa4b8">Allreduce</a>((<span class="keywordtype">void</span> *) &amp;levelRunTime, (<span class="keywordtype">void</span> *) &amp;maxLevelRunTime, (<span class="keywordtype">int</span>) 1, <a class="code" href="_mpi_comm_8h.html#ad0f503bd9fecfe4e570ca3d15aaf2518">RawValue_MPI_DOUBLE</a>, <a class="code" href="_mpi_comm_8h.html#a68f3ac7ff71a6504e236b0c95de78178">RawValue_MPI_MAX</a>,</div>
<div class="line"><a name="l04739"></a><span class="lineno"> 4739</span>&#160;                                   <span class="stringliteral">&quot;MLSampling&lt;P_V,P_M&gt;::generateSequence()&quot;</span>,</div>
<div class="line"><a name="l04740"></a><span class="lineno"> 4740</span>&#160;                                   <span class="stringliteral">&quot;failed MPI.Allreduce() for max level run time&quot;</span>);</div>
<div class="line"><a name="l04741"></a><span class="lineno"> 4741</span>&#160;</div>
<div class="line"><a name="l04742"></a><span class="lineno"> 4742</span>&#160;      <span class="keywordtype">double</span> avgLevelRunTime = 0.;</div>
<div class="line"><a name="l04743"></a><span class="lineno"> 4743</span>&#160;      <a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#a689e4d140c74d495d97eb498714a4b82">inter0Comm</a>().<a class="code" href="class_q_u_e_s_o_1_1_mpi_comm.html#a72e137e60ef8060efb1ee5fc874fa4b8">Allreduce</a>((<span class="keywordtype">void</span> *) &amp;levelRunTime, (<span class="keywordtype">void</span> *) &amp;avgLevelRunTime, (<span class="keywordtype">int</span>) 1, <a class="code" href="_mpi_comm_8h.html#ad0f503bd9fecfe4e570ca3d15aaf2518">RawValue_MPI_DOUBLE</a>, <a class="code" href="_mpi_comm_8h.html#afbf78d291c032aa7f512bc566cee2bd1">RawValue_MPI_SUM</a>,</div>
<div class="line"><a name="l04744"></a><span class="lineno"> 4744</span>&#160;                                   <span class="stringliteral">&quot;MLSampling&lt;P_V,P_M&gt;::generateSequence()&quot;</span>,</div>
<div class="line"><a name="l04745"></a><span class="lineno"> 4745</span>&#160;                                   <span class="stringliteral">&quot;failed MPI.Allreduce() for sum level run time&quot;</span>);</div>
<div class="line"><a name="l04746"></a><span class="lineno"> 4746</span>&#160;      avgLevelRunTime /= ((double) <a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#a689e4d140c74d495d97eb498714a4b82">inter0Comm</a>().<a class="code" href="class_q_u_e_s_o_1_1_mpi_comm.html#aa780721ae0fdeabc5a15e04cb0cad964">NumProc</a>());</div>
<div class="line"><a name="l04747"></a><span class="lineno"> 4747</span>&#160;</div>
<div class="line"><a name="l04748"></a><span class="lineno"> 4748</span>&#160;      <span class="keywordflow">if</span> ((<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#a8a0064746ae8dddfece4229b9ad374d6">subDisplayFile</a>()) &amp;&amp; (<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#a1fe5f244fc0316a0ab3e37463f108b96">displayVerbosity</a>() &gt;= 0)) {</div>
<div class="line"><a name="l04749"></a><span class="lineno"> 4749</span>&#160;        *<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#a8a0064746ae8dddfece4229b9ad374d6">subDisplayFile</a>() &lt;&lt; <span class="stringliteral">&quot;In MLSampling&lt;P_V,P_M&gt;::generateSequence()&quot;</span></div>
<div class="line"><a name="l04750"></a><span class="lineno"> 4750</span>&#160;                                &lt;&lt; <span class="stringliteral">&quot;, level &quot;</span>               &lt;&lt; <a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#af9416874c856e50f3b35270e801f17e4">m_currLevel</a>+<a class="code" href="_m_l_sampling_level_options_8h.html#a68d15eaf394d210effcf584b938206d3">LEVEL_REF_ID</a></div>
<div class="line"><a name="l04751"></a><span class="lineno"> 4751</span>&#160;                                &lt;&lt; <span class="stringliteral">&quot;: min cumul seconds = &quot;</span> &lt;&lt; minCumulativeRawChainRunTime</div>
<div class="line"><a name="l04752"></a><span class="lineno"> 4752</span>&#160;                                &lt;&lt; <span class="stringliteral">&quot;, avg cumul seconds = &quot;</span> &lt;&lt; avgCumulativeRawChainRunTime</div>
<div class="line"><a name="l04753"></a><span class="lineno"> 4753</span>&#160;                                &lt;&lt; <span class="stringliteral">&quot;, max cumul seconds = &quot;</span> &lt;&lt; maxCumulativeRawChainRunTime</div>
<div class="line"><a name="l04754"></a><span class="lineno"> 4754</span>&#160;                                &lt;&lt; <span class="stringliteral">&quot;, min level seconds = &quot;</span> &lt;&lt; minLevelRunTime</div>
<div class="line"><a name="l04755"></a><span class="lineno"> 4755</span>&#160;                                &lt;&lt; <span class="stringliteral">&quot;, avg level seconds = &quot;</span> &lt;&lt; avgLevelRunTime</div>
<div class="line"><a name="l04756"></a><span class="lineno"> 4756</span>&#160;                                &lt;&lt; <span class="stringliteral">&quot;, max level seconds = &quot;</span> &lt;&lt; maxLevelRunTime</div>
<div class="line"><a name="l04757"></a><span class="lineno"> 4757</span>&#160;                                &lt;&lt; std::endl;</div>
<div class="line"><a name="l04758"></a><span class="lineno"> 4758</span>&#160;      }</div>
<div class="line"><a name="l04759"></a><span class="lineno"> 4759</span>&#160;    }</div>
<div class="line"><a name="l04760"></a><span class="lineno"> 4760</span>&#160;</div>
<div class="line"><a name="l04761"></a><span class="lineno"> 4761</span>&#160;    <span class="keywordflow">if</span> (currExponent != 1.) <span class="keyword">delete</span> currOptions;</div>
<div class="line"><a name="l04762"></a><span class="lineno"> 4762</span>&#160;</div>
<div class="line"><a name="l04763"></a><span class="lineno"> 4763</span>&#160;    <span class="keyword">struct </span>timeval timevalLevelEnd;</div>
<div class="line"><a name="l04764"></a><span class="lineno"> 4764</span>&#160;    iRC = 0;</div>
<div class="line"><a name="l04765"></a><span class="lineno"> 4765</span>&#160;    iRC = gettimeofday(&amp;timevalLevelEnd, NULL);</div>
<div class="line"><a name="l04766"></a><span class="lineno"> 4766</span>&#160;</div>
<div class="line"><a name="l04767"></a><span class="lineno"> 4767</span>&#160;    <span class="keywordflow">if</span> ((<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#a8a0064746ae8dddfece4229b9ad374d6">subDisplayFile</a>()) &amp;&amp; (<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#a1fe5f244fc0316a0ab3e37463f108b96">displayVerbosity</a>() &gt;= 0)) {</div>
<div class="line"><a name="l04768"></a><span class="lineno"> 4768</span>&#160;      *<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#a8a0064746ae8dddfece4229b9ad374d6">subDisplayFile</a>() &lt;&lt; <span class="stringliteral">&quot;Getting at the end of level &quot;</span> &lt;&lt; <a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#af9416874c856e50f3b35270e801f17e4">m_currLevel</a>+<a class="code" href="_m_l_sampling_level_options_8h.html#a68d15eaf394d210effcf584b938206d3">LEVEL_REF_ID</a></div>
<div class="line"><a name="l04769"></a><span class="lineno"> 4769</span>&#160;                              &lt;&lt; <span class="stringliteral">&quot;, as part of a &#39;while&#39; on levels&quot;</span></div>
<div class="line"><a name="l04770"></a><span class="lineno"> 4770</span>&#160;                              &lt;&lt; <span class="stringliteral">&quot;, at  &quot;</span>   &lt;&lt; ctime(&amp;timevalLevelEnd.tv_sec)</div>
<div class="line"><a name="l04771"></a><span class="lineno"> 4771</span>&#160;                              &lt;&lt; <span class="stringliteral">&quot;, after &quot;</span> &lt;&lt; timevalLevelEnd.tv_sec - timevalRoutineBegin.tv_sec</div>
<div class="line"><a name="l04772"></a><span class="lineno"> 4772</span>&#160;                              &lt;&lt; <span class="stringliteral">&quot; seconds from entering the routine&quot;</span></div>
<div class="line"><a name="l04773"></a><span class="lineno"> 4773</span>&#160;                              &lt;&lt; <span class="stringliteral">&quot;, after &quot;</span> &lt;&lt; timevalLevelEnd.tv_sec - <a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#a1adcf7ca2d95e75a29360bcfe091cd65">timevalBegin</a>().tv_sec</div>
<div class="line"><a name="l04774"></a><span class="lineno"> 4774</span>&#160;                              &lt;&lt; <span class="stringliteral">&quot; seconds from queso environment instatiation&quot;</span></div>
<div class="line"><a name="l04775"></a><span class="lineno"> 4775</span>&#160;                              &lt;&lt; std::endl;</div>
<div class="line"><a name="l04776"></a><span class="lineno"> 4776</span>&#160;    }</div>
<div class="line"><a name="l04777"></a><span class="lineno"> 4777</span>&#160;  } <span class="comment">// end of level while</span></div>
<div class="line"><a name="l04778"></a><span class="lineno"> 4778</span>&#160;</div>
<div class="line"><a name="l04779"></a><span class="lineno"> 4779</span>&#160;  <span class="comment">//UQ_FATAL_TEST_MACRO((currExponent &lt; 1.),</span></div>
<div class="line"><a name="l04780"></a><span class="lineno"> 4780</span>&#160;  <span class="comment">//                    m_env.worldRank(),</span></div>
<div class="line"><a name="l04781"></a><span class="lineno"> 4781</span>&#160;  <span class="comment">//                    &quot;MLSampling&lt;P_V,P_M&gt;::generateSequence()&quot;,</span></div>
<div class="line"><a name="l04782"></a><span class="lineno"> 4782</span>&#160;  <span class="comment">//                    &quot;exponent has not achieved value &#39;1&#39; even after exiting level loop&quot;);</span></div>
<div class="line"><a name="l04783"></a><span class="lineno"> 4783</span>&#160;</div>
<div class="line"><a name="l04784"></a><span class="lineno"> 4784</span>&#160;  <span class="comment">//***********************************************************</span></div>
<div class="line"><a name="l04785"></a><span class="lineno"> 4785</span>&#160;  <span class="comment">// Compute information gain</span></div>
<div class="line"><a name="l04786"></a><span class="lineno"> 4786</span>&#160;  <span class="comment">// ln( \pi(D|M) ) = E[ln( \pi(D|\theta,M) )] - E[ln( \pi(\theta|D,M) / \pi(\theta|M) )]</span></div>
<div class="line"><a name="l04787"></a><span class="lineno"> 4787</span>&#160;  <span class="comment">//***********************************************************</span></div>
<div class="line"><a name="l04788"></a><span class="lineno"> 4788</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#ae106b5bb8a80b655b88b3a26b1e7c185">inter0Rank</a>() &gt;= 0) { <span class="comment">// KAUST</span></div>
<div class="line"><a name="l04789"></a><span class="lineno"> 4789</span>&#160;    <a class="code" href="_defines_8h.html#a56d63d18d0a6d45757de47fcc06f574d">UQ_FATAL_TEST_MACRO</a>((<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#af9416874c856e50f3b35270e801f17e4">m_currLevel</a> != <a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a75f2ceab4a2c6774b3fa07d74221dbf3">m_logEvidenceFactors</a>.size()),</div>
<div class="line"><a name="l04790"></a><span class="lineno"> 4790</span>&#160;                        <a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#a78b57112bbd0e6dd0e8afec00b40ffa7">worldRank</a>(),</div>
<div class="line"><a name="l04791"></a><span class="lineno"> 4791</span>&#160;                        <span class="stringliteral">&quot;MLSampling&lt;P_V,P_M&gt;::generateSequence()&quot;</span>,</div>
<div class="line"><a name="l04792"></a><span class="lineno"> 4792</span>&#160;                        <span class="stringliteral">&quot;invalid m_currLevel at the exit of the level loop&quot;</span>);</div>
<div class="line"><a name="l04793"></a><span class="lineno"> 4793</span>&#160;    <a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#afad63c42dccb1518319bf677f2bffde0">m_logEvidence</a> = 0.;</div>
<div class="line"><a name="l04794"></a><span class="lineno"> 4794</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a75f2ceab4a2c6774b3fa07d74221dbf3">m_logEvidenceFactors</a>.size(); ++i) {</div>
<div class="line"><a name="l04795"></a><span class="lineno"> 4795</span>&#160;      m_logEvidence += <a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a75f2ceab4a2c6774b3fa07d74221dbf3">m_logEvidenceFactors</a>[i];</div>
<div class="line"><a name="l04796"></a><span class="lineno"> 4796</span>&#160;    }</div>
<div class="line"><a name="l04797"></a><span class="lineno"> 4797</span>&#160;</div>
<div class="line"><a name="l04798"></a><span class="lineno"> 4798</span>&#160;<span class="preprocessor">#if 1 // prudenci-2012-07-06</span></div>
<div class="line"><a name="l04799"></a><span class="lineno"> 4799</span>&#160;<span class="preprocessor"></span>    <a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#aec4229773274b58e3eaa49a77738389f">m_meanLogLikelihood</a> = currLogLikelihoodValues.unifiedMeanPlain(m_vectorSpace.numOfProcsForStorage() == 1);</div>
<div class="line"><a name="l04800"></a><span class="lineno"> 4800</span>&#160;<span class="preprocessor">#else</span></div>
<div class="line"><a name="l04801"></a><span class="lineno"> 4801</span>&#160;<span class="preprocessor"></span>    <a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#aec4229773274b58e3eaa49a77738389f">m_meanLogLikelihood</a> = currLogLikelihoodValues.unifiedMeanExtra(m_vectorSpace.numOfProcsForStorage() == 1,</div>
<div class="line"><a name="l04802"></a><span class="lineno"> 4802</span>&#160;                                                                   0,</div>
<div class="line"><a name="l04803"></a><span class="lineno"> 4803</span>&#160;                                                                   currLogLikelihoodValues.subSequenceSize());</div>
<div class="line"><a name="l04804"></a><span class="lineno"> 4804</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l04805"></a><span class="lineno"> 4805</span>&#160;<span class="preprocessor"></span></div>
<div class="line"><a name="l04806"></a><span class="lineno"> 4806</span>&#160;    <a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#abec7f8cf9da08bc5c0a20d99fa4570af">m_eig</a> = <a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#aec4229773274b58e3eaa49a77738389f">m_meanLogLikelihood</a> - <a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#afad63c42dccb1518319bf677f2bffde0">m_logEvidence</a>;</div>
<div class="line"><a name="l04807"></a><span class="lineno"> 4807</span>&#160;</div>
<div class="line"><a name="l04808"></a><span class="lineno"> 4808</span>&#160;    <span class="keywordflow">if</span> ((<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#a8a0064746ae8dddfece4229b9ad374d6">subDisplayFile</a>()) &amp;&amp; (<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#a1fe5f244fc0316a0ab3e37463f108b96">displayVerbosity</a>() &gt;= 0)) {</div>
<div class="line"><a name="l04809"></a><span class="lineno"> 4809</span>&#160;      *<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#a8a0064746ae8dddfece4229b9ad374d6">subDisplayFile</a>() &lt;&lt; <span class="stringliteral">&quot;In MLSampling&lt;P_V,P_M&gt;::generateSequence()&quot;</span></div>
<div class="line"><a name="l04810"></a><span class="lineno"> 4810</span>&#160;                              &lt;&lt; <span class="stringliteral">&quot;, log(evidence) = &quot;</span>     &lt;&lt; m_logEvidence</div>
<div class="line"><a name="l04811"></a><span class="lineno"> 4811</span>&#160;                              &lt;&lt; <span class="stringliteral">&quot;, evidence = &quot;</span>          &lt;&lt; exp(m_logEvidence)</div>
<div class="line"><a name="l04812"></a><span class="lineno"> 4812</span>&#160;                              &lt;&lt; <span class="stringliteral">&quot;, meanLogLikelihood = &quot;</span> &lt;&lt; <a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#aec4229773274b58e3eaa49a77738389f">m_meanLogLikelihood</a></div>
<div class="line"><a name="l04813"></a><span class="lineno"> 4813</span>&#160;                              &lt;&lt; <span class="stringliteral">&quot;, eig = &quot;</span>               &lt;&lt; <a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#abec7f8cf9da08bc5c0a20d99fa4570af">m_eig</a></div>
<div class="line"><a name="l04814"></a><span class="lineno"> 4814</span>&#160;                              &lt;&lt; std::endl;</div>
<div class="line"><a name="l04815"></a><span class="lineno"> 4815</span>&#160;    }</div>
<div class="line"><a name="l04816"></a><span class="lineno"> 4816</span>&#160;  }</div>
<div class="line"><a name="l04817"></a><span class="lineno"> 4817</span>&#160;</div>
<div class="line"><a name="l04818"></a><span class="lineno"> 4818</span>&#160;  <a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#affe39f53e3d5d678842413370af09145">subComm</a>().<a class="code" href="class_q_u_e_s_o_1_1_mpi_comm.html#abd6af8db8b0c7fd2f5b62e26477a9537">Bcast</a>((<span class="keywordtype">void</span> *) &amp;m_logEvidence, (<span class="keywordtype">int</span>) 1, <a class="code" href="_mpi_comm_8h.html#ad0f503bd9fecfe4e570ca3d15aaf2518">RawValue_MPI_DOUBLE</a>, 0, <span class="comment">// Yes, &#39;subComm&#39;</span></div>
<div class="line"><a name="l04819"></a><span class="lineno"> 4819</span>&#160;                        <span class="stringliteral">&quot;MLSampling&lt;P_V,P_M&gt;::generateSequence()&quot;</span>,</div>
<div class="line"><a name="l04820"></a><span class="lineno"> 4820</span>&#160;                        <span class="stringliteral">&quot;failed MPI.Bcast() for m_logEvidence&quot;</span>);</div>
<div class="line"><a name="l04821"></a><span class="lineno"> 4821</span>&#160;</div>
<div class="line"><a name="l04822"></a><span class="lineno"> 4822</span>&#160;  <a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#affe39f53e3d5d678842413370af09145">subComm</a>().<a class="code" href="class_q_u_e_s_o_1_1_mpi_comm.html#abd6af8db8b0c7fd2f5b62e26477a9537">Bcast</a>((<span class="keywordtype">void</span> *) &amp;<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#aec4229773274b58e3eaa49a77738389f">m_meanLogLikelihood</a>, (<span class="keywordtype">int</span>) 1, <a class="code" href="_mpi_comm_8h.html#ad0f503bd9fecfe4e570ca3d15aaf2518">RawValue_MPI_DOUBLE</a>, 0, <span class="comment">// Yes, &#39;subComm&#39;</span></div>
<div class="line"><a name="l04823"></a><span class="lineno"> 4823</span>&#160;                        <span class="stringliteral">&quot;MLSampling&lt;P_V,P_M&gt;::generateSequence()&quot;</span>,</div>
<div class="line"><a name="l04824"></a><span class="lineno"> 4824</span>&#160;                        <span class="stringliteral">&quot;failed MPI.Bcast() for m_meanLogLikelihood&quot;</span>);</div>
<div class="line"><a name="l04825"></a><span class="lineno"> 4825</span>&#160;</div>
<div class="line"><a name="l04826"></a><span class="lineno"> 4826</span>&#160;  <a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#affe39f53e3d5d678842413370af09145">subComm</a>().<a class="code" href="class_q_u_e_s_o_1_1_mpi_comm.html#abd6af8db8b0c7fd2f5b62e26477a9537">Bcast</a>((<span class="keywordtype">void</span> *) &amp;<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#abec7f8cf9da08bc5c0a20d99fa4570af">m_eig</a>, (<span class="keywordtype">int</span>) 1, <a class="code" href="_mpi_comm_8h.html#ad0f503bd9fecfe4e570ca3d15aaf2518">RawValue_MPI_DOUBLE</a>, 0, <span class="comment">// Yes, &#39;subComm&#39;</span></div>
<div class="line"><a name="l04827"></a><span class="lineno"> 4827</span>&#160;                        <span class="stringliteral">&quot;MLSampling&lt;P_V,P_M&gt;::generateSequence()&quot;</span>,</div>
<div class="line"><a name="l04828"></a><span class="lineno"> 4828</span>&#160;                        <span class="stringliteral">&quot;failed MPI.Bcast() for m_eig&quot;</span>);</div>
<div class="line"><a name="l04829"></a><span class="lineno"> 4829</span>&#160;</div>
<div class="line"><a name="l04830"></a><span class="lineno"> 4830</span>&#160;  <span class="comment">//***********************************************************</span></div>
<div class="line"><a name="l04831"></a><span class="lineno"> 4831</span>&#160;  <span class="comment">// Prepare to return</span></div>
<div class="line"><a name="l04832"></a><span class="lineno"> 4832</span>&#160;  <span class="comment">//***********************************************************</span></div>
<div class="line"><a name="l04833"></a><span class="lineno"> 4833</span>&#160;  workingChain.<a class="code" href="class_q_u_e_s_o_1_1_base_vector_sequence.html#aae0804eacc51b37e84b1bd329ce1711c">clear</a>();</div>
<div class="line"><a name="l04834"></a><span class="lineno"> 4834</span>&#160;  workingChain.<a class="code" href="class_q_u_e_s_o_1_1_base_vector_sequence.html#adc238af7f6e8af2402ab791de7d60af5">resizeSequence</a>(currChain.subSequenceSize());</div>
<div class="line"><a name="l04835"></a><span class="lineno"> 4835</span>&#160;  P_V auxVec(m_vectorSpace.zeroVector());</div>
<div class="line"><a name="l04836"></a><span class="lineno"> 4836</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = 0; i &lt; workingChain.<a class="code" href="class_q_u_e_s_o_1_1_base_vector_sequence.html#afd6278702d40bdf1044697bbd6ad1957">subSequenceSize</a>(); ++i) {</div>
<div class="line"><a name="l04837"></a><span class="lineno"> 4837</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#ae106b5bb8a80b655b88b3a26b1e7c185">inter0Rank</a>() &gt;= 0) {</div>
<div class="line"><a name="l04838"></a><span class="lineno"> 4838</span>&#160;      currChain.getPositionValues(i,auxVec);</div>
<div class="line"><a name="l04839"></a><span class="lineno"> 4839</span>&#160;    }</div>
<div class="line"><a name="l04840"></a><span class="lineno"> 4840</span>&#160;    workingChain.<a class="code" href="class_q_u_e_s_o_1_1_base_vector_sequence.html#a5bcce98b68e0e24c05136e7a3bb50c12">setPositionValues</a>(i,auxVec);</div>
<div class="line"><a name="l04841"></a><span class="lineno"> 4841</span>&#160;  }</div>
<div class="line"><a name="l04842"></a><span class="lineno"> 4842</span>&#160;</div>
<div class="line"><a name="l04843"></a><span class="lineno"> 4843</span>&#160;  <span class="keywordflow">if</span> (workingLogLikelihoodValues) *workingLogLikelihoodValues = currLogLikelihoodValues;</div>
<div class="line"><a name="l04844"></a><span class="lineno"> 4844</span>&#160;  <span class="keywordflow">if</span> (workingLogTargetValues    ) *workingLogTargetValues     = currLogTargetValues;</div>
<div class="line"><a name="l04845"></a><span class="lineno"> 4845</span>&#160;</div>
<div class="line"><a name="l04846"></a><span class="lineno"> 4846</span>&#160;  <span class="keyword">struct </span>timeval timevalRoutineEnd;</div>
<div class="line"><a name="l04847"></a><span class="lineno"> 4847</span>&#160;  iRC = 0;</div>
<div class="line"><a name="l04848"></a><span class="lineno"> 4848</span>&#160;  iRC = gettimeofday(&amp;timevalRoutineEnd, NULL);</div>
<div class="line"><a name="l04849"></a><span class="lineno"> 4849</span>&#160;</div>
<div class="line"><a name="l04850"></a><span class="lineno"> 4850</span>&#160;  <span class="keywordflow">if</span> ((<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#a8a0064746ae8dddfece4229b9ad374d6">subDisplayFile</a>()) &amp;&amp; (<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#a1fe5f244fc0316a0ab3e37463f108b96">displayVerbosity</a>() &gt;= 0)) {</div>
<div class="line"><a name="l04851"></a><span class="lineno"> 4851</span>&#160;    *<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#a8a0064746ae8dddfece4229b9ad374d6">subDisplayFile</a>() &lt;&lt; <span class="stringliteral">&quot;Leaving MLSampling&lt;P_V,P_M&gt;::generateSequence()&quot;</span></div>
<div class="line"><a name="l04852"></a><span class="lineno"> 4852</span>&#160;                            &lt;&lt; <span class="stringliteral">&quot;, at  &quot;</span>   &lt;&lt; ctime(&amp;timevalRoutineEnd.tv_sec)</div>
<div class="line"><a name="l04853"></a><span class="lineno"> 4853</span>&#160;                            &lt;&lt; <span class="stringliteral">&quot;, after &quot;</span> &lt;&lt; timevalRoutineEnd.tv_sec - timevalRoutineBegin.tv_sec</div>
<div class="line"><a name="l04854"></a><span class="lineno"> 4854</span>&#160;                            &lt;&lt; <span class="stringliteral">&quot; seconds from entering the routine&quot;</span></div>
<div class="line"><a name="l04855"></a><span class="lineno"> 4855</span>&#160;                            &lt;&lt; <span class="stringliteral">&quot;, after &quot;</span> &lt;&lt; timevalRoutineEnd.tv_sec - <a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#a1adcf7ca2d95e75a29360bcfe091cd65">timevalBegin</a>().tv_sec</div>
<div class="line"><a name="l04856"></a><span class="lineno"> 4856</span>&#160;                            &lt;&lt; <span class="stringliteral">&quot; seconds from queso environment instatiation&quot;</span></div>
<div class="line"><a name="l04857"></a><span class="lineno"> 4857</span>&#160;                            &lt;&lt; std::endl;</div>
<div class="line"><a name="l04858"></a><span class="lineno"> 4858</span>&#160;  }</div>
<div class="line"><a name="l04859"></a><span class="lineno"> 4859</span>&#160;</div>
<div class="line"><a name="l04860"></a><span class="lineno"> 4860</span>&#160;  <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l04861"></a><span class="lineno"> 4861</span>&#160;}</div>
<div class="ttc" id="class_q_u_e_s_o_1_1_m_l_sampling_html_abec7f8cf9da08bc5c0a20d99fa4570af"><div class="ttname"><a href="class_q_u_e_s_o_1_1_m_l_sampling.html#abec7f8cf9da08bc5c0a20d99fa4570af">QUESO::MLSampling::m_eig</a></div><div class="ttdeci">double m_eig</div><div class="ttdef"><b>Definition:</b> <a href="_m_l_sampling_8h_source.html#l00474">MLSampling.h:474</a></div></div>
<div class="ttc" id="class_q_u_e_s_o_1_1_base_environment_html_ab712bff194ddd91459d4ea8715c77e8b"><div class="ttname"><a href="class_q_u_e_s_o_1_1_base_environment.html#ab712bff194ddd91459d4ea8715c77e8b">QUESO::BaseEnvironment::closeFile</a></div><div class="ttdeci">void closeFile(FilePtrSetStruct &amp;filePtrSet, const std::string &amp;fileType) const </div><div class="ttdoc">Closes the file. </div><div class="ttdef"><b>Definition:</b> <a href="_environment_8_c_source.html#l01117">Environment.C:1117</a></div></div>
<div class="ttc" id="class_q_u_e_s_o_1_1_base_vector_sequence_html_a5bcce98b68e0e24c05136e7a3bb50c12"><div class="ttname"><a href="class_q_u_e_s_o_1_1_base_vector_sequence.html#a5bcce98b68e0e24c05136e7a3bb50c12">QUESO::BaseVectorSequence::setPositionValues</a></div><div class="ttdeci">virtual void setPositionValues(unsigned int posId, const V &amp;vec)=0</div><div class="ttdoc">Set the values in vec at position posId of the sequence. See template specialization. </div></div>
<div class="ttc" id="class_q_u_e_s_o_1_1_m_l_sampling_html_a13f1ca4fe9f94822fe572a743eaced1d"><div class="ttname"><a href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">QUESO::MLSampling::m_env</a></div><div class="ttdeci">const BaseEnvironment &amp; m_env</div><div class="ttdoc">Queso enviroment. </div><div class="ttdef"><b>Definition:</b> <a href="_m_l_sampling_8h_source.html#l00442">MLSampling.h:442</a></div></div>
<div class="ttc" id="_mpi_comm_8h_html_afbf78d291c032aa7f512bc566cee2bd1"><div class="ttname"><a href="_mpi_comm_8h.html#afbf78d291c032aa7f512bc566cee2bd1">RawValue_MPI_SUM</a></div><div class="ttdeci">#define RawValue_MPI_SUM</div><div class="ttdef"><b>Definition:</b> <a href="_mpi_comm_8h_source.html#l00052">MpiComm.h:52</a></div></div>
<div class="ttc" id="_metropolis_hastings_s_g_options_8h_html_a75699ceb938d800e2b7f59ede3ea9a31"><div class="ttname"><a href="_metropolis_hastings_s_g_options_8h.html#a75699ceb938d800e2b7f59ede3ea9a31">UQ_MH_SG_FILENAME_FOR_NO_FILE</a></div><div class="ttdeci">#define UQ_MH_SG_FILENAME_FOR_NO_FILE</div><div class="ttdef"><b>Definition:</b> <a href="_metropolis_hastings_s_g_options_8h_source.html#l00035">MetropolisHastingsSGOptions.h:35</a></div></div>
<div class="ttc" id="class_q_u_e_s_o_1_1_m_l_sampling_html_aa8e7bb1bd54ccafb9b276127a76eba71"><div class="ttname"><a href="class_q_u_e_s_o_1_1_m_l_sampling.html#aa8e7bb1bd54ccafb9b276127a76eba71">QUESO::MLSampling::checkpointML</a></div><div class="ttdeci">void checkpointML(double currExponent, double currEta, const SequenceOfVectors&lt; P_V, P_M &gt; &amp;currChain, const ScalarSequence&lt; double &gt; &amp;currLogLikelihoodValues, const ScalarSequence&lt; double &gt; &amp;currLogTargetValues)</div><div class="ttdoc">Writes checkpoint data for the ML method. </div><div class="ttdef"><b>Definition:</b> <a href="_m_l_sampling_8_c_source.html#l02033">MLSampling.C:2033</a></div></div>
<div class="ttc" id="class_q_u_e_s_o_1_1_vector_space_html_a5829a1f4f996f8307c840b705144d666"><div class="ttname"><a href="class_q_u_e_s_o_1_1_vector_space.html#a5829a1f4f996f8307c840b705144d666">QUESO::VectorSpace::dimLocal</a></div><div class="ttdeci">unsigned int dimLocal() const </div><div class="ttdef"><b>Definition:</b> <a href="_vector_space_8_c_source.html#l00199">VectorSpace.C:199</a></div></div>
<div class="ttc" id="class_q_u_e_s_o_1_1_mpi_comm_html_aa780721ae0fdeabc5a15e04cb0cad964"><div class="ttname"><a href="class_q_u_e_s_o_1_1_mpi_comm.html#aa780721ae0fdeabc5a15e04cb0cad964">QUESO::MpiComm::NumProc</a></div><div class="ttdeci">int NumProc() const </div><div class="ttdoc">Returns total number of processes. </div><div class="ttdef"><b>Definition:</b> <a href="_mpi_comm_8_c_source.html#l00121">MpiComm.C:121</a></div></div>
<div class="ttc" id="class_q_u_e_s_o_1_1_m_l_sampling_html_abdd5cd35419283c33cc40a77d0f4f07f"><div class="ttname"><a href="class_q_u_e_s_o_1_1_m_l_sampling.html#abdd5cd35419283c33cc40a77d0f4f07f">QUESO::MLSampling::m_debugExponent</a></div><div class="ttdeci">double m_debugExponent</div><div class="ttdoc">Exponent for debugging. </div><div class="ttdef"><b>Definition:</b> <a href="_m_l_sampling_8h_source.html#l00470">MLSampling.h:470</a></div></div>
<div class="ttc" id="class_q_u_e_s_o_1_1_base_environment_html_a78b57112bbd0e6dd0e8afec00b40ffa7"><div class="ttname"><a href="class_q_u_e_s_o_1_1_base_environment.html#a78b57112bbd0e6dd0e8afec00b40ffa7">QUESO::BaseEnvironment::worldRank</a></div><div class="ttdeci">int worldRank() const </div><div class="ttdoc">Returns the process world rank. </div><div class="ttdef"><b>Definition:</b> <a href="_environment_8_c_source.html#l00235">Environment.C:235</a></div></div>
<div class="ttc" id="class_q_u_e_s_o_1_1_mpi_comm_html_a4059971c30e023b272fccaa6aa00c426"><div class="ttname"><a href="class_q_u_e_s_o_1_1_mpi_comm.html#a4059971c30e023b272fccaa6aa00c426">QUESO::MpiComm::Barrier</a></div><div class="ttdeci">void Barrier() const </div><div class="ttdoc">Pause every process in *this communicator until all the processes reach this point. </div><div class="ttdef"><b>Definition:</b> <a href="_mpi_comm_8_c_source.html#l00143">MpiComm.C:143</a></div></div>
<div class="ttc" id="class_q_u_e_s_o_1_1_m_l_sampling_html_a0a2615d8f3627630d0cb62cb91614bd1"><div class="ttname"><a href="class_q_u_e_s_o_1_1_m_l_sampling.html#a0a2615d8f3627630d0cb62cb91614bd1">QUESO::MLSampling::generateSequence_Level0_all</a></div><div class="ttdeci">void generateSequence_Level0_all(const MLSamplingLevelOptions &amp;currOptions, unsigned int &amp;unifiedRequestedNumSamples, SequenceOfVectors&lt; P_V, P_M &gt; &amp;currChain, ScalarSequence&lt; double &gt; &amp;currLogLikelihoodValues, ScalarSequence&lt; double &gt; &amp;currLogTargetValues)</div><div class="ttdoc">Generates the sequence at the level 0. </div><div class="ttdef"><b>Definition:</b> <a href="_m_l_sampling_8_c_source.html#l02344">MLSampling.C:2344</a></div></div>
<div class="ttc" id="namespace_q_u_e_s_o_html_a8e909502900aecf24cedba022ea84471"><div class="ttname"><a href="namespace_q_u_e_s_o.html#a8e909502900aecf24cedba022ea84471">QUESO::UQ_OK_RC</a></div><div class="ttdeci">const int UQ_OK_RC</div><div class="ttdef"><b>Definition:</b> <a href="_defines_8h_source.html#l00075">Defines.h:75</a></div></div>
<div class="ttc" id="class_q_u_e_s_o_1_1_m_l_sampling_html_aa387be291dd763ce001ea769e87266c4"><div class="ttname"><a href="class_q_u_e_s_o_1_1_m_l_sampling.html#aa387be291dd763ce001ea769e87266c4">QUESO::MLSampling::restartML</a></div><div class="ttdeci">void restartML(double &amp;currExponent, double &amp;currEta, SequenceOfVectors&lt; P_V, P_M &gt; &amp;currChain, ScalarSequence&lt; double &gt; &amp;currLogLikelihoodValues, ScalarSequence&lt; double &gt; &amp;currLogTargetValues)</div><div class="ttdoc">Restarts ML algorithm. </div><div class="ttdef"><b>Definition:</b> <a href="_m_l_sampling_8_c_source.html#l02149">MLSampling.C:2149</a></div></div>
<div class="ttc" id="class_q_u_e_s_o_1_1_base_environment_html_affe39f53e3d5d678842413370af09145"><div class="ttname"><a href="class_q_u_e_s_o_1_1_base_environment.html#affe39f53e3d5d678842413370af09145">QUESO::BaseEnvironment::subComm</a></div><div class="ttdeci">const MpiComm &amp; subComm() const </div><div class="ttdoc">Access function for MpiComm sub communicator. </div><div class="ttdef"><b>Definition:</b> <a href="_environment_8_c_source.html#l00269">Environment.C:269</a></div></div>
<div class="ttc" id="class_q_u_e_s_o_1_1_base_vector_r_v_html_a3206740e05e0c64a88273029e963b185"><div class="ttname"><a href="class_q_u_e_s_o_1_1_base_vector_r_v.html#a3206740e05e0c64a88273029e963b185">QUESO::BaseVectorRV::pdf</a></div><div class="ttdeci">const BaseJointPdf&lt; V, M &gt; &amp; pdf() const </div><div class="ttdoc">Posterior Density Function of the vector RV; access to private attribute m_pdf. </div><div class="ttdef"><b>Definition:</b> <a href="_vector_r_v_8_c_source.html#l00086">VectorRV.C:86</a></div></div>
<div class="ttc" id="class_q_u_e_s_o_1_1_m_l_sampling_html_a21f642100e0690f65563e2c1f8bed816"><div class="ttname"><a href="class_q_u_e_s_o_1_1_m_l_sampling.html#a21f642100e0690f65563e2c1f8bed816">QUESO::MLSampling::generateSequence_Step06_all</a></div><div class="ttdeci">void generateSequence_Step06_all(const MLSamplingLevelOptions *currOptions, unsigned int indexOfFirstWeight, unsigned int indexOfLastWeight, const std::vector&lt; unsigned int &gt; &amp;unifiedIndexCountersAtProc0Only, bool &amp;useBalancedChains, std::vector&lt; ExchangeInfoStruct &gt; &amp;exchangeStdVec)</div><div class="ttdoc">Decides on wheter or not to use balanced chains (Step 06 from ML algorithm). </div><div class="ttdef"><b>Definition:</b> <a href="_m_l_sampling_8_c_source.html#l03162">MLSampling.C:3162</a></div></div>
<div class="ttc" id="class_q_u_e_s_o_1_1_m_l_sampling_html_a06c37730b943a1838d58475d322639b9"><div class="ttname"><a href="class_q_u_e_s_o_1_1_m_l_sampling.html#a06c37730b943a1838d58475d322639b9">QUESO::MLSampling::generateSequence_Step02_inter0</a></div><div class="ttdeci">void generateSequence_Step02_inter0(const MLSamplingLevelOptions *currOptions, SequenceOfVectors&lt; P_V, P_M &gt; &amp;currChain, ScalarSequence&lt; double &gt; &amp;currLogLikelihoodValues, ScalarSequence&lt; double &gt; &amp;currLogTargetValues, SequenceOfVectors&lt; P_V, P_M &gt; &amp;prevChain, ScalarSequence&lt; double &gt; &amp;prevLogLikelihoodValues, ScalarSequence&lt; double &gt; &amp;prevLogTargetValues, unsigned int &amp;indexOfFirstWeight, unsigned int &amp;indexOfLastWeight)</div><div class="ttdoc">Saves chain and corresponding target pdf values from previous level (Step 02 from ML algorithm)...</div><div class="ttdef"><b>Definition:</b> <a href="_m_l_sampling_8_c_source.html#l02540">MLSampling.C:2540</a></div></div>
<div class="ttc" id="class_q_u_e_s_o_1_1_base_environment_html_a0b0779b41ff304058856e97e1d16b4d4"><div class="ttname"><a href="class_q_u_e_s_o_1_1_base_environment.html#a0b0779b41ff304058856e97e1d16b4d4">QUESO::BaseEnvironment::fullComm</a></div><div class="ttdeci">const MpiComm &amp; fullComm() const </div><div class="ttdoc">Access function for MpiComm full communicator. </div><div class="ttdef"><b>Definition:</b> <a href="_environment_8_c_source.html#l00247">Environment.C:247</a></div></div>
<div class="ttc" id="class_q_u_e_s_o_1_1_m_l_sampling_html_a21525858e93a7d9654fdf68c8ac25576"><div class="ttname"><a href="class_q_u_e_s_o_1_1_m_l_sampling.html#a21525858e93a7d9654fdf68c8ac25576">QUESO::MLSampling::m_targetDomain</a></div><div class="ttdeci">VectorSet&lt; P_V, P_M &gt; * m_targetDomain</div><div class="ttdoc">Domain of the target PDF: intersection of the domains of the prior PDf and likelihood function...</div><div class="ttdef"><b>Definition:</b> <a href="_m_l_sampling_8h_source.html#l00454">MLSampling.h:454</a></div></div>
<div class="ttc" id="class_q_u_e_s_o_1_1_m_l_sampling_html_afbe27e6149562020663b72da6592d933"><div class="ttname"><a href="class_q_u_e_s_o_1_1_m_l_sampling.html#afbe27e6149562020663b72da6592d933">QUESO::MLSampling::m_numDisabledParameters</a></div><div class="ttdeci">unsigned int m_numDisabledParameters</div><div class="ttdef"><b>Definition:</b> <a href="_m_l_sampling_8h_source.html#l00456">MLSampling.h:456</a></div></div>
<div class="ttc" id="class_q_u_e_s_o_1_1_m_l_sampling_html_a75f2ceab4a2c6774b3fa07d74221dbf3"><div class="ttname"><a href="class_q_u_e_s_o_1_1_m_l_sampling.html#a75f2ceab4a2c6774b3fa07d74221dbf3">QUESO::MLSampling::m_logEvidenceFactors</a></div><div class="ttdeci">std::vector&lt; double &gt; m_logEvidenceFactors</div><div class="ttdef"><b>Definition:</b> <a href="_m_l_sampling_8h_source.html#l00471">MLSampling.h:471</a></div></div>
<div class="ttc" id="class_q_u_e_s_o_1_1_base_environment_html_ab8fe853074f12ea34e18724119a2fc75"><div class="ttname"><a href="class_q_u_e_s_o_1_1_base_environment.html#ab8fe853074f12ea34e18724119a2fc75">QUESO::BaseEnvironment::openOutputFile</a></div><div class="ttdeci">bool openOutputFile(const std::string &amp;fileName, const std::string &amp;fileType, const std::set&lt; unsigned int &gt; &amp;allowedSubEnvIds, bool writeOver, FilePtrSetStruct &amp;filePtrSet) const </div><div class="ttdoc">Opens an output file for each sub-environment that was chosen to send data to the file...</div><div class="ttdef"><b>Definition:</b> <a href="_environment_8_c_source.html#l00516">Environment.C:516</a></div></div>
<div class="ttc" id="class_q_u_e_s_o_1_1_m_l_sampling_html_af8504cc57ec72b3c52833826b2bfff8e"><div class="ttname"><a href="class_q_u_e_s_o_1_1_m_l_sampling.html#af8504cc57ec72b3c52833826b2bfff8e">QUESO::MLSampling::m_options</a></div><div class="ttdeci">MLSamplingOptions m_options</div><div class="ttdoc">Options for the ML algorithm. </div><div class="ttdef"><b>Definition:</b> <a href="_m_l_sampling_8h_source.html#l00461">MLSampling.h:461</a></div></div>
<div class="ttc" id="class_q_u_e_s_o_1_1_m_l_sampling_html_a754bc11c7802f627fece9f063450739a"><div class="ttname"><a href="class_q_u_e_s_o_1_1_m_l_sampling.html#a754bc11c7802f627fece9f063450739a">QUESO::MLSampling::generateSequence_Step08_all</a></div><div class="ttdeci">void generateSequence_Step08_all(BayesianJointPdf&lt; P_V, P_M &gt; &amp;currPdf, GenericVectorRV&lt; P_V, P_M &gt; &amp;currRv)</div><div class="ttdoc">Creates a vector RV for current level (Step 08 from ML algorithm). </div><div class="ttdef"><b>Definition:</b> <a href="_m_l_sampling_8_c_source.html#l03255">MLSampling.C:3255</a></div></div>
<div class="ttc" id="class_q_u_e_s_o_1_1_m_l_sampling_html_ae53e6bc0ec5d1f3d3ac9df268086cd75"><div class="ttname"><a href="class_q_u_e_s_o_1_1_m_l_sampling.html#ae53e6bc0ec5d1f3d3ac9df268086cd75">QUESO::MLSampling::generateSequence_Step03_inter0</a></div><div class="ttdeci">void generateSequence_Step03_inter0(const MLSamplingLevelOptions *currOptions, const ScalarSequence&lt; double &gt; &amp;prevLogLikelihoodValues, double prevExponent, double failedExponent, double &amp;currExponent, ScalarSequence&lt; double &gt; &amp;weightSequence)</div><div class="ttdoc">Computes currExponent and sequence of weights for current level and update &amp;#39;m_logEvidenceFactors&amp;#39; (St...</div><div class="ttdef"><b>Definition:</b> <a href="_m_l_sampling_8_c_source.html#l02678">MLSampling.C:2678</a></div></div>
<div class="ttc" id="class_q_u_e_s_o_1_1_m_l_sampling_html_ab08c3059d23460db49b229aa88bd4e70"><div class="ttname"><a href="class_q_u_e_s_o_1_1_m_l_sampling.html#ab08c3059d23460db49b229aa88bd4e70">QUESO::MLSampling::m_likelihoodFunction</a></div><div class="ttdeci">const BaseScalarFunction&lt; P_V, P_M &gt; &amp; m_likelihoodFunction</div><div class="ttdoc">Likelihood function. </div><div class="ttdef"><b>Definition:</b> <a href="_m_l_sampling_8h_source.html#l00448">MLSampling.h:448</a></div></div>
<div class="ttc" id="class_q_u_e_s_o_1_1_m_l_sampling_html_aec4229773274b58e3eaa49a77738389f"><div class="ttname"><a href="class_q_u_e_s_o_1_1_m_l_sampling.html#aec4229773274b58e3eaa49a77738389f">QUESO::MLSampling::m_meanLogLikelihood</a></div><div class="ttdeci">double m_meanLogLikelihood</div><div class="ttdef"><b>Definition:</b> <a href="_m_l_sampling_8h_source.html#l00473">MLSampling.h:473</a></div></div>
<div class="ttc" id="class_q_u_e_s_o_1_1_m_l_sampling_html_a955fb446652327edbc275e3d9145e2db"><div class="ttname"><a href="class_q_u_e_s_o_1_1_m_l_sampling.html#a955fb446652327edbc275e3d9145e2db">QUESO::MLSampling::generateSequence_Step04_inter0</a></div><div class="ttdeci">void generateSequence_Step04_inter0(const SequenceOfVectors&lt; P_V, P_M &gt; &amp;prevChain, const ScalarSequence&lt; double &gt; &amp;weightSequence, P_M &amp;unifiedCovMatrix)</div><div class="ttdoc">Creates covariance matrix for current level (Step 04 from ML algorithm). </div><div class="ttdef"><b>Definition:</b> <a href="_m_l_sampling_8_c_source.html#l02985">MLSampling.C:2985</a></div></div>
<div class="ttc" id="class_q_u_e_s_o_1_1_m_l_sampling_html_ac76690384f70d74b8662faf7a051449e"><div class="ttname"><a href="class_q_u_e_s_o_1_1_m_l_sampling.html#ac76690384f70d74b8662faf7a051449e">QUESO::MLSampling::m_parameterEnabledStatus</a></div><div class="ttdeci">std::vector&lt; bool &gt; m_parameterEnabledStatus</div><div class="ttdef"><b>Definition:</b> <a href="_m_l_sampling_8h_source.html#l00458">MLSampling.h:458</a></div></div>
<div class="ttc" id="class_q_u_e_s_o_1_1_vector_space_html_a67b0c3620662116f5a346fdaa5faf38e"><div class="ttname"><a href="class_q_u_e_s_o_1_1_vector_space.html#a67b0c3620662116f5a346fdaa5faf38e">QUESO::VectorSpace::numOfProcsForStorage</a></div><div class="ttdeci">unsigned int numOfProcsForStorage() const </div><div class="ttdoc">Returns total number of processes. </div><div class="ttdef"><b>Definition:</b> <a href="_vector_space_8_c_source.html#l00193">VectorSpace.C:193</a></div></div>
<div class="ttc" id="class_q_u_e_s_o_1_1_m_l_sampling_html_a26892288f3b1902d78ba049b96579a08"><div class="ttname"><a href="class_q_u_e_s_o_1_1_m_l_sampling.html#a26892288f3b1902d78ba049b96579a08">QUESO::MLSampling::generateSequence_Step09_all</a></div><div class="ttdeci">void generateSequence_Step09_all(const SequenceOfVectors&lt; P_V, P_M &gt; &amp;prevChain, unsigned int indexOfFirstWeight, unsigned int indexOfLastWeight, const std::vector&lt; double &gt; &amp;unifiedWeightStdVectorAtProc0Only, const ScalarSequence&lt; double &gt; &amp;weightSequence, double prevEta, const GenericVectorRV&lt; P_V, P_M &gt; &amp;currRv, MLSamplingLevelOptions *currOptions, P_M &amp;unifiedCovMatrix, double &amp;currEta)</div><div class="ttdoc">Scales the unified covariance matrix until min &amp;lt;= rejection rate &amp;lt;= max (Step 09 from ML algorithm)...</div><div class="ttdef"><b>Definition:</b> <a href="_m_l_sampling_8_c_source.html#l03288">MLSampling.C:3288</a></div></div>
<div class="ttc" id="class_q_u_e_s_o_1_1_m_l_sampling_html_aa45e9c06bd51cae0dc2294af1831c158"><div class="ttname"><a href="class_q_u_e_s_o_1_1_m_l_sampling.html#aa45e9c06bd51cae0dc2294af1831c158">QUESO::MLSampling::m_priorRv</a></div><div class="ttdeci">const BaseVectorRV&lt; P_V, P_M &gt; &amp; m_priorRv</div><div class="ttdoc">Prior RV. </div><div class="ttdef"><b>Definition:</b> <a href="_m_l_sampling_8h_source.html#l00445">MLSampling.h:445</a></div></div>
<div class="ttc" id="class_q_u_e_s_o_1_1_m_l_sampling_options_html_a1d3d48598e0b59b46337ce66a52671a5"><div class="ttname"><a href="class_q_u_e_s_o_1_1_m_l_sampling_options.html#a1d3d48598e0b59b46337ce66a52671a5">QUESO::MLSamplingOptions::m_prefix</a></div><div class="ttdeci">std::string m_prefix</div><div class="ttdoc">Class prefix. (ml) </div><div class="ttdef"><b>Definition:</b> <a href="_m_l_sampling_options_8h_source.html#l00090">MLSamplingOptions.h:90</a></div></div>
<div class="ttc" id="class_q_u_e_s_o_1_1_m_l_sampling_html_af9416874c856e50f3b35270e801f17e4"><div class="ttname"><a href="class_q_u_e_s_o_1_1_m_l_sampling.html#af9416874c856e50f3b35270e801f17e4">QUESO::MLSampling::m_currLevel</a></div><div class="ttdeci">unsigned int m_currLevel</div><div class="ttdoc">Current level. </div><div class="ttdef"><b>Definition:</b> <a href="_m_l_sampling_8h_source.html#l00464">MLSampling.h:464</a></div></div>
<div class="ttc" id="class_q_u_e_s_o_1_1_m_l_sampling_html_a3db529d364d5bb47916066d7cc21cb00"><div class="ttname"><a href="class_q_u_e_s_o_1_1_m_l_sampling.html#a3db529d364d5bb47916066d7cc21cb00">QUESO::MLSampling::generateSequence_Step05_inter0</a></div><div class="ttdeci">void generateSequence_Step05_inter0(unsigned int unifiedRequestedNumSamples, const ScalarSequence&lt; double &gt; &amp;weightSequence, std::vector&lt; unsigned int &gt; &amp;unifiedIndexCountersAtProc0Only, std::vector&lt; double &gt; &amp;unifiedWeightStdVectorAtProc0Only)</div><div class="ttdoc">Creates unified finite distribution for current level (Step 05 from ML algorithm). </div><div class="ttdef"><b>Definition:</b> <a href="_m_l_sampling_8_c_source.html#l03079">MLSampling.C:3079</a></div></div>
<div class="ttc" id="class_q_u_e_s_o_1_1_base_vector_sequence_html_adc238af7f6e8af2402ab791de7d60af5"><div class="ttname"><a href="class_q_u_e_s_o_1_1_base_vector_sequence.html#adc238af7f6e8af2402ab791de7d60af5">QUESO::BaseVectorSequence::resizeSequence</a></div><div class="ttdeci">virtual void resizeSequence(unsigned int newSubSequenceSize)=0</div><div class="ttdoc">Resize the sequence. See template specialization. </div></div>
<div class="ttc" id="class_q_u_e_s_o_1_1_base_vector_sequence_html_afd6278702d40bdf1044697bbd6ad1957"><div class="ttname"><a href="class_q_u_e_s_o_1_1_base_vector_sequence.html#afd6278702d40bdf1044697bbd6ad1957">QUESO::BaseVectorSequence::subSequenceSize</a></div><div class="ttdeci">virtual unsigned int subSequenceSize() const =0</div><div class="ttdoc">Size of the sub-sequence of vectors. See template specialization. </div></div>
<div class="ttc" id="_m_l_sampling_level_options_8h_html_a68d15eaf394d210effcf584b938206d3"><div class="ttname"><a href="_m_l_sampling_level_options_8h.html#a68d15eaf394d210effcf584b938206d3">LEVEL_REF_ID</a></div><div class="ttdeci">#define LEVEL_REF_ID</div><div class="ttdef"><b>Definition:</b> <a href="_m_l_sampling_level_options_8h_source.html#l00028">MLSamplingLevelOptions.h:28</a></div></div>
<div class="ttc" id="_mpi_comm_8h_html_a68f3ac7ff71a6504e236b0c95de78178"><div class="ttname"><a href="_mpi_comm_8h.html#a68f3ac7ff71a6504e236b0c95de78178">RawValue_MPI_MAX</a></div><div class="ttdeci">#define RawValue_MPI_MAX</div><div class="ttdef"><b>Definition:</b> <a href="_mpi_comm_8h_source.html#l00051">MpiComm.h:51</a></div></div>
<div class="ttc" id="_defines_8h_html_ac440026eff7deb1c1eed1eea0e8e36ba"><div class="ttname"><a href="_defines_8h.html#ac440026eff7deb1c1eed1eea0e8e36ba">UQ_FILE_EXTENSION_FOR_MATLAB_FORMAT</a></div><div class="ttdeci">#define UQ_FILE_EXTENSION_FOR_MATLAB_FORMAT</div><div class="ttdef"><b>Definition:</b> <a href="_defines_8h_source.html#l00088">Defines.h:88</a></div></div>
<div class="ttc" id="class_q_u_e_s_o_1_1_m_l_sampling_html_aae527304bc1012a91ffc396e94fbab11"><div class="ttname"><a href="class_q_u_e_s_o_1_1_m_l_sampling.html#aae527304bc1012a91ffc396e94fbab11">QUESO::MLSampling::generateSequence_Step11_inter0</a></div><div class="ttdeci">void generateSequence_Step11_inter0(const MLSamplingLevelOptions *currOptions, unsigned int unifiedRequestedNumSamples, unsigned int cumulativeRawChainRejections, SequenceOfVectors&lt; P_V, P_M &gt; &amp;currChain, ScalarSequence&lt; double &gt; &amp;currLogLikelihoodValues, ScalarSequence&lt; double &gt; &amp;currLogTargetValues, unsigned int &amp;unifiedNumberOfRejections)</div><div class="ttdoc">Filters chain (Step 11 from ML algorithm). </div><div class="ttdef"><b>Definition:</b> <a href="_m_l_sampling_8_c_source.html#l03864">MLSampling.C:3864</a></div></div>
<div class="ttc" id="class_q_u_e_s_o_1_1_mpi_comm_html_abd6af8db8b0c7fd2f5b62e26477a9537"><div class="ttname"><a href="class_q_u_e_s_o_1_1_mpi_comm.html#abd6af8db8b0c7fd2f5b62e26477a9537">QUESO::MpiComm::Bcast</a></div><div class="ttdeci">void Bcast(void *buffer, int count, RawType_MPI_Datatype datatype, int root, const char *whereMsg, const char *whatMsg) const </div><div class="ttdoc">Broadcast values from the root process to the slave processes. </div><div class="ttdef"><b>Definition:</b> <a href="_mpi_comm_8_c_source.html#l00157">MpiComm.C:157</a></div></div>
<div class="ttc" id="class_q_u_e_s_o_1_1_m_l_sampling_html_a7bc4c72f65ba9166ed94a6e198b0915b"><div class="ttname"><a href="class_q_u_e_s_o_1_1_m_l_sampling.html#a7bc4c72f65ba9166ed94a6e198b0915b">QUESO::MLSampling::m_vectorSpace</a></div><div class="ttdeci">const VectorSpace&lt; P_V, P_M &gt; &amp; m_vectorSpace</div><div class="ttdoc">Vector space. </div><div class="ttdef"><b>Definition:</b> <a href="_m_l_sampling_8h_source.html#l00451">MLSampling.h:451</a></div></div>
<div class="ttc" id="namespace_q_u_e_s_o_html_a424bc33f2e6e287fd468408d14b772ee"><div class="ttname"><a href="namespace_q_u_e_s_o.html#a424bc33f2e6e287fd468408d14b772ee">QUESO::MiscGetEllapsedSeconds</a></div><div class="ttdeci">double MiscGetEllapsedSeconds(struct timeval *timeval0)</div><div class="ttdef"><b>Definition:</b> <a href="_miscellaneous_8_c_source.html#l00287">Miscellaneous.C:287</a></div></div>
<div class="ttc" id="class_q_u_e_s_o_1_1_base_environment_html_ae106b5bb8a80b655b88b3a26b1e7c185"><div class="ttname"><a href="class_q_u_e_s_o_1_1_base_environment.html#ae106b5bb8a80b655b88b3a26b1e7c185">QUESO::BaseEnvironment::inter0Rank</a></div><div class="ttdeci">int inter0Rank() const </div><div class="ttdoc">Returns the process inter0 rank. </div><div class="ttdef"><b>Definition:</b> <a href="_environment_8_c_source.html#l00289">Environment.C:289</a></div></div>
<div class="ttc" id="class_q_u_e_s_o_1_1_m_l_sampling_html_aea8da13aed5b04e64b8490ca5f107889"><div class="ttname"><a href="class_q_u_e_s_o_1_1_m_l_sampling.html#aea8da13aed5b04e64b8490ca5f107889">QUESO::MLSampling::generateSequence_Step01_inter0</a></div><div class="ttdeci">void generateSequence_Step01_inter0(const MLSamplingLevelOptions *currOptions, unsigned int &amp;unifiedRequestedNumSamples)</div><div class="ttdoc">Reads options for the ML algorithm (Step 01 from ML algorithm). </div><div class="ttdef"><b>Definition:</b> <a href="_m_l_sampling_8_c_source.html#l02494">MLSampling.C:2494</a></div></div>
<div class="ttc" id="class_q_u_e_s_o_1_1_mpi_comm_html_a72e137e60ef8060efb1ee5fc874fa4b8"><div class="ttname"><a href="class_q_u_e_s_o_1_1_mpi_comm.html#a72e137e60ef8060efb1ee5fc874fa4b8">QUESO::MpiComm::Allreduce</a></div><div class="ttdeci">void Allreduce(void *sendbuf, void *recvbuf, int count, RawType_MPI_Datatype datatype, RawType_MPI_Op op, const char *whereMsg, const char *whatMsg) const </div><div class="ttdoc">Combines values from all processes and distributes the result back to all processes. </div><div class="ttdef"><b>Definition:</b> <a href="_mpi_comm_8_c_source.html#l00131">MpiComm.C:131</a></div></div>
<div class="ttc" id="_mpi_comm_8h_html_ad0f503bd9fecfe4e570ca3d15aaf2518"><div class="ttname"><a href="_mpi_comm_8h.html#ad0f503bd9fecfe4e570ca3d15aaf2518">RawValue_MPI_DOUBLE</a></div><div class="ttdeci">#define RawValue_MPI_DOUBLE</div><div class="ttdef"><b>Definition:</b> <a href="_mpi_comm_8h_source.html#l00048">MpiComm.h:48</a></div></div>
<div class="ttc" id="_defines_8h_html_a56d63d18d0a6d45757de47fcc06f574d"><div class="ttname"><a href="_defines_8h.html#a56d63d18d0a6d45757de47fcc06f574d">UQ_FATAL_TEST_MACRO</a></div><div class="ttdeci">#define UQ_FATAL_TEST_MACRO(test, givenRank, where, what)</div><div class="ttdef"><b>Definition:</b> <a href="_defines_8h_source.html#l00222">Defines.h:222</a></div></div>
<div class="ttc" id="_mpi_comm_8h_html_a06cbfbc33436f6e0dc8a48ff3c49bdfc"><div class="ttname"><a href="_mpi_comm_8h.html#a06cbfbc33436f6e0dc8a48ff3c49bdfc">RawValue_MPI_UNSIGNED</a></div><div class="ttdeci">#define RawValue_MPI_UNSIGNED</div><div class="ttdef"><b>Definition:</b> <a href="_mpi_comm_8h_source.html#l00049">MpiComm.h:49</a></div></div>
<div class="ttc" id="class_q_u_e_s_o_1_1_m_l_sampling_html_a1b1f8ccb4823bdfa26ec652f0807c63e"><div class="ttname"><a href="class_q_u_e_s_o_1_1_m_l_sampling.html#a1b1f8ccb4823bdfa26ec652f0807c63e">QUESO::MLSampling::m_currStep</a></div><div class="ttdeci">unsigned int m_currStep</div><div class="ttdoc">Curret step. </div><div class="ttdef"><b>Definition:</b> <a href="_m_l_sampling_8h_source.html#l00467">MLSampling.h:467</a></div></div>
<div class="ttc" id="_mpi_comm_8h_html_a8e30f42fdac116861205e83e2aa18042"><div class="ttname"><a href="_mpi_comm_8h.html#a8e30f42fdac116861205e83e2aa18042">RawValue_MPI_MIN</a></div><div class="ttdeci">#define RawValue_MPI_MIN</div><div class="ttdef"><b>Definition:</b> <a href="_mpi_comm_8h_source.html#l00050">MpiComm.h:50</a></div></div>
<div class="ttc" id="class_q_u_e_s_o_1_1_base_vector_sequence_html_aae0804eacc51b37e84b1bd329ce1711c"><div class="ttname"><a href="class_q_u_e_s_o_1_1_base_vector_sequence.html#aae0804eacc51b37e84b1bd329ce1711c">QUESO::BaseVectorSequence::clear</a></div><div class="ttdeci">void clear()</div><div class="ttdoc">Reset the values and the size of the sequence of vectors. </div><div class="ttdef"><b>Definition:</b> <a href="_vector_sequence_8_c_source.html#l00136">VectorSequence.C:136</a></div></div>
<div class="ttc" id="class_q_u_e_s_o_1_1_m_l_sampling_html_a270d639f90f6f2c60d1af851eea63d41"><div class="ttname"><a href="class_q_u_e_s_o_1_1_m_l_sampling.html#a270d639f90f6f2c60d1af851eea63d41">QUESO::MLSampling::generateSequence_Step07_inter0</a></div><div class="ttdeci">void generateSequence_Step07_inter0(bool useBalancedChains, unsigned int indexOfFirstWeight, unsigned int indexOfLastWeight, const std::vector&lt; unsigned int &gt; &amp;unifiedIndexCountersAtProc0Only, UnbalancedLinkedChainsPerNodeStruct &amp;unbalancedLinkControl, const MLSamplingLevelOptions *currOptions, const SequenceOfVectors&lt; P_V, P_M &gt; &amp;prevChain, std::vector&lt; ExchangeInfoStruct &gt; &amp;exchangeStdVec, BalancedLinkedChainsPerNodeStruct&lt; P_V &gt; &amp;balancedLinkControl)</div><div class="ttdoc">Plans for number of linked chains for each node so that all nodes generate the closest possible to th...</div><div class="ttdef"><b>Definition:</b> <a href="_m_l_sampling_8_c_source.html#l03195">MLSampling.C:3195</a></div></div>
<div class="ttc" id="class_q_u_e_s_o_1_1_base_environment_html_a1adcf7ca2d95e75a29360bcfe091cd65"><div class="ttname"><a href="class_q_u_e_s_o_1_1_base_environment.html#a1adcf7ca2d95e75a29360bcfe091cd65">QUESO::BaseEnvironment::timevalBegin</a></div><div class="ttdeci">struct timeval timevalBegin() const </div><div class="ttdoc">Used to save the time when the combo `QUESO+user&amp;#39;s application&amp;#39; started to run. </div><div class="ttdef"><b>Definition:</b> <a href="_environment_8_c_source.html#l00510">Environment.C:510</a></div></div>
<div class="ttc" id="class_q_u_e_s_o_1_1_base_environment_html_a1fe5f244fc0316a0ab3e37463f108b96"><div class="ttname"><a href="class_q_u_e_s_o_1_1_base_environment.html#a1fe5f244fc0316a0ab3e37463f108b96">QUESO::BaseEnvironment::displayVerbosity</a></div><div class="ttdeci">unsigned int displayVerbosity() const </div><div class="ttdef"><b>Definition:</b> <a href="_environment_8_c_source.html#l00436">Environment.C:436</a></div></div>
<div class="ttc" id="class_q_u_e_s_o_1_1_base_environment_html_a8a0064746ae8dddfece4229b9ad374d6"><div class="ttname"><a href="class_q_u_e_s_o_1_1_base_environment.html#a8a0064746ae8dddfece4229b9ad374d6">QUESO::BaseEnvironment::subDisplayFile</a></div><div class="ttdeci">std::ofstream * subDisplayFile() const </div><div class="ttdoc">Access function for m_subDisplayFile (displays file on stream). </div><div class="ttdef"><b>Definition:</b> <a href="_environment_8_c_source.html#l00305">Environment.C:305</a></div></div>
<div class="ttc" id="class_q_u_e_s_o_1_1_base_environment_html_a689e4d140c74d495d97eb498714a4b82"><div class="ttname"><a href="class_q_u_e_s_o_1_1_base_environment.html#a689e4d140c74d495d97eb498714a4b82">QUESO::BaseEnvironment::inter0Comm</a></div><div class="ttdeci">const MpiComm &amp; inter0Comm() const </div><div class="ttdoc">Access function for MpiComm inter0-communicator. </div><div class="ttdef"><b>Definition:</b> <a href="_environment_8_c_source.html#l00295">Environment.C:295</a></div></div>
<div class="ttc" id="class_q_u_e_s_o_1_1_m_l_sampling_html_afad63c42dccb1518319bf677f2bffde0"><div class="ttname"><a href="class_q_u_e_s_o_1_1_m_l_sampling.html#afad63c42dccb1518319bf677f2bffde0">QUESO::MLSampling::m_logEvidence</a></div><div class="ttdeci">double m_logEvidence</div><div class="ttdef"><b>Definition:</b> <a href="_m_l_sampling_8h_source.html#l00472">MLSampling.h:472</a></div></div>
<div class="ttc" id="class_q_u_e_s_o_1_1_m_l_sampling_html_a04322fda4c97eee6c6739fc007d642c1"><div class="ttname"><a href="class_q_u_e_s_o_1_1_m_l_sampling.html#a04322fda4c97eee6c6739fc007d642c1">QUESO::MLSampling::generateSequence_Step10_all</a></div><div class="ttdeci">void generateSequence_Step10_all(MLSamplingLevelOptions &amp;currOptions, const P_M &amp;unifiedCovMatrix, const GenericVectorRV&lt; P_V, P_M &gt; &amp;currRv, bool useBalancedChains, const UnbalancedLinkedChainsPerNodeStruct &amp;unbalancedLinkControl, unsigned int indexOfFirstWeight, const SequenceOfVectors&lt; P_V, P_M &gt; &amp;prevChain, const BalancedLinkedChainsPerNodeStruct&lt; P_V &gt; &amp;balancedLinkControl, SequenceOfVectors&lt; P_V, P_M &gt; &amp;currChain, double &amp;cumulativeRawChainRunTime, unsigned int &amp;cumulativeRawChainRejections, ScalarSequence&lt; double &gt; *currLogLikelihoodValues, ScalarSequence&lt; double &gt; *currLogTargetValues)</div><div class="ttdoc">Samples the vector RV of current level (Step 10 from ML algorithm). </div><div class="ttdef"><b>Definition:</b> <a href="_m_l_sampling_8_c_source.html#l03758">MLSampling.C:3758</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a0a2615d8f3627630d0cb62cb91614bd1"></a>
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;class P_V , class P_M &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="class_q_u_e_s_o_1_1_m_l_sampling.html">QUESO::MLSampling</a>&lt; P_V, P_M &gt;::generateSequence_Level0_all </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="class_q_u_e_s_o_1_1_m_l_sampling_level_options.html">MLSamplingLevelOptions</a> &amp;&#160;</td>
          <td class="paramname"><em>currOptions</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned int &amp;&#160;</td>
          <td class="paramname"><em>unifiedRequestedNumSamples</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_q_u_e_s_o_1_1_sequence_of_vectors.html">SequenceOfVectors</a>&lt; P_V, P_M &gt; &amp;&#160;</td>
          <td class="paramname"><em>currChain</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_q_u_e_s_o_1_1_scalar_sequence.html">ScalarSequence</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>currLogLikelihoodValues</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_q_u_e_s_o_1_1_scalar_sequence.html">ScalarSequence</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>currLogTargetValues</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Generates the sequence at the level 0. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">currOptions</td><td></td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">unifiedRequestedNumSamples,currChain,currLogLikelihoodValues,currLogTargetValues</td><td></td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="_m_l_sampling_8_c_source.html#l02344">2344</a> of file <a class="el" href="_m_l_sampling_8_c_source.html">MLSampling.C</a>.</p>

<p>References <a class="el" href="_m_l_sampling_level_options_8h_source.html#l00028">LEVEL_REF_ID</a>, <a class="el" href="_m_l_sampling_level_options_8h_source.html#l00160">QUESO::MLSamplingLevelOptions::m_dataOutputAllowedSet</a>, <a class="el" href="_m_l_sampling_level_options_8h_source.html#l00154">QUESO::MLSamplingLevelOptions::m_dataOutputFileName</a>, <a class="el" href="_m_l_sampling_level_options_8h_source.html#l00256">QUESO::MLSamplingLevelOptions::m_filteredChainGenerate</a>, <a class="el" href="_m_l_sampling_level_options_8h_source.html#l00211">QUESO::MLSamplingLevelOptions::m_initialValuesOfDisabledParameters</a>, <a class="el" href="_m_l_sampling_level_options_8h_source.html#l00143">QUESO::MLSamplingLevelOptions::m_prefix</a>, <a class="el" href="_m_l_sampling_level_options_8h_source.html#l00237">QUESO::MLSamplingLevelOptions::m_rawChainDataOutputFileName</a>, <a class="el" href="_m_l_sampling_level_options_8h_source.html#l00240">QUESO::MLSamplingLevelOptions::m_rawChainDataOutputFileType</a>, <a class="el" href="_m_l_sampling_level_options_8h_source.html#l00222">QUESO::MLSamplingLevelOptions::m_rawChainSize</a>, <a class="el" href="_miscellaneous_8_c_source.html#l00287">QUESO::MiscGetEllapsedSeconds()</a>, <a class="el" href="_environment_8h_source.html#l00075">QUESO::FilePtrSetStruct::ofsVar</a>, <a class="el" href="_mpi_comm_8h_source.html#l00052">RawValue_MPI_SUM</a>, <a class="el" href="_mpi_comm_8h_source.html#l00049">RawValue_MPI_UNSIGNED</a>, <a class="el" href="_sequence_of_vectors_8_c_source.html#l00110">QUESO::SequenceOfVectors&lt; V, M &gt;::resizeSequence()</a>, <a class="el" href="_scalar_sequence_8_c_source.html#l00181">QUESO::ScalarSequence&lt; T &gt;::resizeSequence()</a>, <a class="el" href="_vector_sequence_8_c_source.html#l00128">QUESO::BaseVectorSequence&lt; V, M &gt;::setName()</a>, <a class="el" href="_scalar_sequence_8_c_source.html#l00120">QUESO::ScalarSequence&lt; T &gt;::setName()</a>, <a class="el" href="_sequence_of_vectors_8_c_source.html#l00221">QUESO::SequenceOfVectors&lt; V, M &gt;::setPositionValues()</a>, <a class="el" href="_sequence_of_vectors_8_c_source.html#l00103">QUESO::SequenceOfVectors&lt; V, M &gt;::subSequenceSize()</a>, <a class="el" href="_sequence_of_vectors_8_c_source.html#l01485">QUESO::SequenceOfVectors&lt; V, M &gt;::unifiedWriteContents()</a>, <a class="el" href="_scalar_sequence_8_c_source.html#l02799">QUESO::ScalarSequence&lt; T &gt;::unifiedWriteContents()</a>, <a class="el" href="_defines_8h_source.html#l00222">UQ_FATAL_TEST_MACRO</a>, <a class="el" href="_defines_8h_source.html#l00088">UQ_FILE_EXTENSION_FOR_MATLAB_FORMAT</a>, <a class="el" href="_metropolis_hastings_s_g_options_8h_source.html#l00035">UQ_MH_SG_FILENAME_FOR_NO_FILE</a>, and <a class="el" href="_defines_8h_source.html#l00075">QUESO::UQ_OK_RC</a>.</p>
<div class="fragment"><div class="line"><a name="l02350"></a><span class="lineno"> 2350</span>&#160;{</div>
<div class="line"><a name="l02351"></a><span class="lineno"> 2351</span>&#160;    <span class="keywordflow">if</span> ((<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#a8a0064746ae8dddfece4229b9ad374d6">subDisplayFile</a>()) &amp;&amp; (<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#a1fe5f244fc0316a0ab3e37463f108b96">displayVerbosity</a>() &gt;= 0)) {</div>
<div class="line"><a name="l02352"></a><span class="lineno"> 2352</span>&#160;      *<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#a8a0064746ae8dddfece4229b9ad374d6">subDisplayFile</a>() &lt;&lt; <span class="stringliteral">&quot;KEY In MLSampling&lt;P_V,P_M&gt;::generateSequence()&quot;</span></div>
<div class="line"><a name="l02353"></a><span class="lineno"> 2353</span>&#160;                              &lt;&lt; <span class="stringliteral">&quot;: beginning level &quot;</span>              &lt;&lt; <a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#af9416874c856e50f3b35270e801f17e4">m_currLevel</a>+<a class="code" href="_m_l_sampling_level_options_8h.html#a68d15eaf394d210effcf584b938206d3">LEVEL_REF_ID</a></div>
<div class="line"><a name="l02354"></a><span class="lineno"> 2354</span>&#160;                              &lt;&lt; <span class="stringliteral">&quot;, currOptions.m_rawChainSize = &quot;</span> &lt;&lt; currOptions.m_rawChainSize <span class="comment">// Ok to use rawChainSize</span></div>
<div class="line"><a name="l02355"></a><span class="lineno"> 2355</span>&#160;                              &lt;&lt; std::endl;</div>
<div class="line"><a name="l02356"></a><span class="lineno"> 2356</span>&#160;    }</div>
<div class="line"><a name="l02357"></a><span class="lineno"> 2357</span>&#160;</div>
<div class="line"><a name="l02358"></a><span class="lineno"> 2358</span>&#160;    <span class="keywordtype">int</span> iRC = <a class="code" href="namespace_q_u_e_s_o.html#a8e909502900aecf24cedba022ea84471">UQ_OK_RC</a>;</div>
<div class="line"><a name="l02359"></a><span class="lineno"> 2359</span>&#160;    <span class="keyword">struct </span>timeval timevalLevel;</div>
<div class="line"><a name="l02360"></a><span class="lineno"> 2360</span>&#160;    iRC = gettimeofday(&amp;timevalLevel, NULL);</div>
<div class="line"><a name="l02361"></a><span class="lineno"> 2361</span>&#160;    <span class="keywordflow">if</span> (iRC) {}; <span class="comment">// just to remove compiler warning</span></div>
<div class="line"><a name="l02362"></a><span class="lineno"> 2362</span>&#160;</div>
<div class="line"><a name="l02363"></a><span class="lineno"> 2363</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#ae106b5bb8a80b655b88b3a26b1e7c185">inter0Rank</a>() &gt;= 0) {</div>
<div class="line"><a name="l02364"></a><span class="lineno"> 2364</span>&#160;      <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> tmpSize = currOptions.m_rawChainSize;</div>
<div class="line"><a name="l02365"></a><span class="lineno"> 2365</span>&#160;      <a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#a689e4d140c74d495d97eb498714a4b82">inter0Comm</a>().<a class="code" href="class_q_u_e_s_o_1_1_mpi_comm.html#a72e137e60ef8060efb1ee5fc874fa4b8">Allreduce</a>((<span class="keywordtype">void</span> *) &amp;tmpSize, (<span class="keywordtype">void</span> *) &amp;unifiedRequestedNumSamples, (<span class="keywordtype">int</span>) 1, <a class="code" href="_mpi_comm_8h.html#a06cbfbc33436f6e0dc8a48ff3c49bdfc">RawValue_MPI_UNSIGNED</a>, <a class="code" href="_mpi_comm_8h.html#afbf78d291c032aa7f512bc566cee2bd1">RawValue_MPI_SUM</a>,</div>
<div class="line"><a name="l02366"></a><span class="lineno"> 2366</span>&#160;                                   <span class="stringliteral">&quot;MLSampling&lt;P_V,P_M&gt;::generateSequence()&quot;</span>,</div>
<div class="line"><a name="l02367"></a><span class="lineno"> 2367</span>&#160;                                   <span class="stringliteral">&quot;failed MPI.Allreduce() for requested num samples in level 0&quot;</span>);</div>
<div class="line"><a name="l02368"></a><span class="lineno"> 2368</span>&#160;    }</div>
<div class="line"><a name="l02369"></a><span class="lineno"> 2369</span>&#160;    <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l02370"></a><span class="lineno"> 2370</span>&#160;      unifiedRequestedNumSamples = currOptions.m_rawChainSize;</div>
<div class="line"><a name="l02371"></a><span class="lineno"> 2371</span>&#160;    }</div>
<div class="line"><a name="l02372"></a><span class="lineno"> 2372</span>&#160;</div>
<div class="line"><a name="l02373"></a><span class="lineno"> 2373</span>&#160;    currChain.setName              (currOptions.m_prefix + <span class="stringliteral">&quot;rawChain&quot;</span>        );</div>
<div class="line"><a name="l02374"></a><span class="lineno"> 2374</span>&#160;    currLogLikelihoodValues.<a class="code" href="class_q_u_e_s_o_1_1_scalar_sequence.html#a198b72423333bc5aa1722b830b64a263">setName</a>(currOptions.m_prefix + <span class="stringliteral">&quot;rawLogLikelihood&quot;</span>);</div>
<div class="line"><a name="l02375"></a><span class="lineno"> 2375</span>&#160;    currLogTargetValues.<a class="code" href="class_q_u_e_s_o_1_1_scalar_sequence.html#a198b72423333bc5aa1722b830b64a263">setName</a>    (currOptions.m_prefix + <span class="stringliteral">&quot;rawLogTarget&quot;</span>    );</div>
<div class="line"><a name="l02376"></a><span class="lineno"> 2376</span>&#160;</div>
<div class="line"><a name="l02377"></a><span class="lineno"> 2377</span>&#160;    currChain.resizeSequence              (currOptions.m_rawChainSize); <span class="comment">// Ok to use rawChainSize</span></div>
<div class="line"><a name="l02378"></a><span class="lineno"> 2378</span>&#160;    currLogLikelihoodValues.<a class="code" href="class_q_u_e_s_o_1_1_scalar_sequence.html#a2aa8d77c39927060227275b12b6d3dd0">resizeSequence</a>(currOptions.m_rawChainSize); <span class="comment">// Ok to use rawChainSize</span></div>
<div class="line"><a name="l02379"></a><span class="lineno"> 2379</span>&#160;    currLogTargetValues.<a class="code" href="class_q_u_e_s_o_1_1_scalar_sequence.html#a2aa8d77c39927060227275b12b6d3dd0">resizeSequence</a>    (currOptions.m_rawChainSize); <span class="comment">// Ok to use rawChainSize</span></div>
<div class="line"><a name="l02380"></a><span class="lineno"> 2380</span>&#160;</div>
<div class="line"><a name="l02381"></a><span class="lineno"> 2381</span>&#160;    P_V auxVec(<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a7bc4c72f65ba9166ed94a6e198b0915b">m_vectorSpace</a>.<a class="code" href="class_q_u_e_s_o_1_1_vector_space.html#a92e963bb5cab3eecd290dfe4b8f03b04">zeroVector</a>());</div>
<div class="line"><a name="l02382"></a><span class="lineno"> 2382</span>&#160;    ScalarFunctionSynchronizer&lt;P_V,P_M&gt; likelihoodSynchronizer(<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#ab08c3059d23460db49b229aa88bd4e70">m_likelihoodFunction</a>,auxVec); <span class="comment">// prudencio 2010-08-01</span></div>
<div class="line"><a name="l02383"></a><span class="lineno"> 2383</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = 0; i &lt; currChain.subSequenceSize(); ++i) {</div>
<div class="line"><a name="l02384"></a><span class="lineno"> 2384</span>&#160;      <span class="comment">//std::cout &lt;&lt; &quot;In QUESO: before prior realizer with i = &quot; &lt;&lt; i &lt;&lt; std::endl;</span></div>
<div class="line"><a name="l02385"></a><span class="lineno"> 2385</span>&#160;      <span class="keywordtype">bool</span> outOfSupport = <span class="keyword">true</span>;</div>
<div class="line"><a name="l02386"></a><span class="lineno"> 2386</span>&#160;      <span class="keywordflow">do</span> {</div>
<div class="line"><a name="l02387"></a><span class="lineno"> 2387</span>&#160;</div>
<div class="line"><a name="l02388"></a><span class="lineno"> 2388</span>&#160;        <a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#aa45e9c06bd51cae0dc2294af1831c158">m_priorRv</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_vector_r_v.html#aea4b01eef0baf36944d14459a7b9ccf4">realizer</a>().<a class="code" href="class_q_u_e_s_o_1_1_base_vector_realizer.html#a6845173dd79a80ae11c86cde26e55817">realization</a>(auxVec);  <span class="comment">// gpmsa2</span></div>
<div class="line"><a name="l02389"></a><span class="lineno"> 2389</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#afbe27e6149562020663b72da6592d933">m_numDisabledParameters</a> &gt; 0) { <span class="comment">// gpmsa2</span></div>
<div class="line"><a name="l02390"></a><span class="lineno"> 2390</span>&#160;          <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> disabledCounter = 0;</div>
<div class="line"><a name="l02391"></a><span class="lineno"> 2391</span>&#160;          <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> paramId = 0; paramId &lt; <a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a7bc4c72f65ba9166ed94a6e198b0915b">m_vectorSpace</a>.<a class="code" href="class_q_u_e_s_o_1_1_vector_space.html#a5829a1f4f996f8307c840b705144d666">dimLocal</a>(); ++paramId) {</div>
<div class="line"><a name="l02392"></a><span class="lineno"> 2392</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#ac76690384f70d74b8662faf7a051449e">m_parameterEnabledStatus</a>[paramId] == <span class="keyword">false</span>) {</div>
<div class="line"><a name="l02393"></a><span class="lineno"> 2393</span>&#160;              auxVec[paramId] = currOptions.m_initialValuesOfDisabledParameters[disabledCounter];</div>
<div class="line"><a name="l02394"></a><span class="lineno"> 2394</span>&#160;              disabledCounter++;</div>
<div class="line"><a name="l02395"></a><span class="lineno"> 2395</span>&#160;            }</div>
<div class="line"><a name="l02396"></a><span class="lineno"> 2396</span>&#160;          }</div>
<div class="line"><a name="l02397"></a><span class="lineno"> 2397</span>&#160;        }</div>
<div class="line"><a name="l02398"></a><span class="lineno"> 2398</span>&#160;        auxVec.mpiBcast(0, <a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#affe39f53e3d5d678842413370af09145">subComm</a>()); <span class="comment">// prudencio 2010-08-01</span></div>
<div class="line"><a name="l02399"></a><span class="lineno"> 2399</span>&#160;</div>
<div class="line"><a name="l02400"></a><span class="lineno"> 2400</span>&#160;        outOfSupport = !(<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a21525858e93a7d9654fdf68c8ac25576">m_targetDomain</a>-&gt;<a class="code" href="class_q_u_e_s_o_1_1_vector_set.html#ab59fe6ca67647f58920681e05165a9d0">contains</a>(auxVec));</div>
<div class="line"><a name="l02401"></a><span class="lineno"> 2401</span>&#160;      } <span class="keywordflow">while</span> (outOfSupport); <span class="comment">// prudenci 2011-Oct-04</span></div>
<div class="line"><a name="l02402"></a><span class="lineno"> 2402</span>&#160;</div>
<div class="line"><a name="l02403"></a><span class="lineno"> 2403</span>&#160;      currChain.setPositionValues(i,auxVec);</div>
<div class="line"><a name="l02404"></a><span class="lineno"> 2404</span>&#160;      <span class="comment">// KAUST: all nodes should call likelihood</span></div>
<div class="line"><a name="l02405"></a><span class="lineno"> 2405</span>&#160;<span class="preprocessor">#if 1 // prudencio 2010-08-01</span></div>
<div class="line"><a name="l02406"></a><span class="lineno"> 2406</span>&#160;<span class="preprocessor"></span>      currLogLikelihoodValues[i] = likelihoodSynchronizer.callFunction(&amp;auxVec,NULL,NULL,NULL,NULL,NULL,NULL); <span class="comment">// likelihood is important</span></div>
<div class="line"><a name="l02407"></a><span class="lineno"> 2407</span>&#160;<span class="preprocessor">#else</span></div>
<div class="line"><a name="l02408"></a><span class="lineno"> 2408</span>&#160;<span class="preprocessor"></span>      currLogLikelihoodValues[i] = <a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#ab08c3059d23460db49b229aa88bd4e70">m_likelihoodFunction</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_scalar_function.html#acf2f92adac2df2a0d750dc62cd3a4d0a">lnValue</a>(auxVec,NULL,NULL,NULL,NULL); <span class="comment">// likelihood is important</span></div>
<div class="line"><a name="l02409"></a><span class="lineno"> 2409</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l02410"></a><span class="lineno"> 2410</span>&#160;<span class="preprocessor"></span>      currLogTargetValues[i]     = <a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#aa45e9c06bd51cae0dc2294af1831c158">m_priorRv</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_vector_r_v.html#a3206740e05e0c64a88273029e963b185">pdf</a>().<a class="code" href="class_q_u_e_s_o_1_1_base_joint_pdf.html#aaeb1d91fd791399a502f451b07bb1bfe">lnValue</a>(auxVec,NULL,NULL,NULL,NULL) + currLogLikelihoodValues[i];</div>
<div class="line"><a name="l02411"></a><span class="lineno"> 2411</span>&#160;      <span class="comment">//std::cout &lt;&lt; &quot;In QUESO: currLogTargetValues[&quot; &lt;&lt; i &lt;&lt; &quot;] = &quot; &lt;&lt; currLogTargetValues[i] &lt;&lt; std::endl;</span></div>
<div class="line"><a name="l02412"></a><span class="lineno"> 2412</span>&#160;    }</div>
<div class="line"><a name="l02413"></a><span class="lineno"> 2413</span>&#160;</div>
<div class="line"><a name="l02414"></a><span class="lineno"> 2414</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#ae106b5bb8a80b655b88b3a26b1e7c185">inter0Rank</a>() &gt;= 0) { <span class="comment">// KAUST</span></div>
<div class="line"><a name="l02415"></a><span class="lineno"> 2415</span>&#160;<span class="preprocessor">#ifdef QUESO_USES_SEQUENCE_STATISTICAL_OPTIONS</span></div>
<div class="line"><a name="l02416"></a><span class="lineno"> 2416</span>&#160;<span class="preprocessor"></span>      <span class="keywordflow">if</span> (currOptions.m_rawChainComputeStats) {</div>
<div class="line"><a name="l02417"></a><span class="lineno"> 2417</span>&#160;        FilePtrSetStruct filePtrSet;</div>
<div class="line"><a name="l02418"></a><span class="lineno"> 2418</span>&#160;        <a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#ab8fe853074f12ea34e18724119a2fc75">openOutputFile</a>(currOptions.m_dataOutputFileName,</div>
<div class="line"><a name="l02419"></a><span class="lineno"> 2419</span>&#160;                             <a class="code" href="_defines_8h.html#ac440026eff7deb1c1eed1eea0e8e36ba">UQ_FILE_EXTENSION_FOR_MATLAB_FORMAT</a>, <span class="comment">// Yes, always &quot;.m&quot;</span></div>
<div class="line"><a name="l02420"></a><span class="lineno"> 2420</span>&#160;                             currOptions.m_dataOutputAllowedSet,</div>
<div class="line"><a name="l02421"></a><span class="lineno"> 2421</span>&#160;                             <span class="keyword">false</span>,</div>
<div class="line"><a name="l02422"></a><span class="lineno"> 2422</span>&#160;                             filePtrSet);</div>
<div class="line"><a name="l02423"></a><span class="lineno"> 2423</span>&#160;</div>
<div class="line"><a name="l02424"></a><span class="lineno"> 2424</span>&#160;        <span class="comment">//m_env.syncPrintDebugMsg(&quot;At level 0, calling computeStatistics for chain&quot;,1,10,m_env.inter0Comm()); // output debug</span></div>
<div class="line"><a name="l02425"></a><span class="lineno"> 2425</span>&#160;        currChain.computeStatistics(*currOptions.m_rawChainStatisticalOptionsObj,</div>
<div class="line"><a name="l02426"></a><span class="lineno"> 2426</span>&#160;                                    filePtrSet.ofsVar);</div>
<div class="line"><a name="l02427"></a><span class="lineno"> 2427</span>&#160;</div>
<div class="line"><a name="l02428"></a><span class="lineno"> 2428</span>&#160;        <a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#ab712bff194ddd91459d4ea8715c77e8b">closeFile</a>(filePtrSet,<a class="code" href="_defines_8h.html#ac440026eff7deb1c1eed1eea0e8e36ba">UQ_FILE_EXTENSION_FOR_MATLAB_FORMAT</a>);</div>
<div class="line"><a name="l02429"></a><span class="lineno"> 2429</span>&#160;      }</div>
<div class="line"><a name="l02430"></a><span class="lineno"> 2430</span>&#160;      <span class="comment">// Compute MLE and MAP</span></div>
<div class="line"><a name="l02431"></a><span class="lineno"> 2431</span>&#160;      <span class="comment">// rr0</span></div>
<div class="line"><a name="l02432"></a><span class="lineno"> 2432</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l02433"></a><span class="lineno"> 2433</span>&#160;<span class="preprocessor"></span>      <span class="keywordflow">if</span> (currOptions.m_rawChainDataOutputFileName != <a class="code" href="_metropolis_hastings_s_g_options_8h.html#a75699ceb938d800e2b7f59ede3ea9a31">UQ_MH_SG_FILENAME_FOR_NO_FILE</a>) {</div>
<div class="line"><a name="l02434"></a><span class="lineno"> 2434</span>&#160;        currChain.unifiedWriteContents              (currOptions.m_rawChainDataOutputFileName,</div>
<div class="line"><a name="l02435"></a><span class="lineno"> 2435</span>&#160;                                                     currOptions.m_rawChainDataOutputFileType);</div>
<div class="line"><a name="l02436"></a><span class="lineno"> 2436</span>&#160;        currLogLikelihoodValues.<a class="code" href="class_q_u_e_s_o_1_1_scalar_sequence.html#a2f832dd5eda37df06eb52650ab8ce733">unifiedWriteContents</a>(currOptions.m_rawChainDataOutputFileName,</div>
<div class="line"><a name="l02437"></a><span class="lineno"> 2437</span>&#160;                                                     currOptions.m_rawChainDataOutputFileType);</div>
<div class="line"><a name="l02438"></a><span class="lineno"> 2438</span>&#160;        currLogTargetValues.<a class="code" href="class_q_u_e_s_o_1_1_scalar_sequence.html#a2f832dd5eda37df06eb52650ab8ce733">unifiedWriteContents</a>    (currOptions.m_rawChainDataOutputFileName,</div>
<div class="line"><a name="l02439"></a><span class="lineno"> 2439</span>&#160;                                                     currOptions.m_rawChainDataOutputFileType);</div>
<div class="line"><a name="l02440"></a><span class="lineno"> 2440</span>&#160;      }</div>
<div class="line"><a name="l02441"></a><span class="lineno"> 2441</span>&#160;</div>
<div class="line"><a name="l02442"></a><span class="lineno"> 2442</span>&#160;      <span class="keywordflow">if</span> ((<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#a8a0064746ae8dddfece4229b9ad374d6">subDisplayFile</a>()) &amp;&amp; (<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#a1fe5f244fc0316a0ab3e37463f108b96">displayVerbosity</a>() &gt;= 0)) {</div>
<div class="line"><a name="l02443"></a><span class="lineno"> 2443</span>&#160;        *<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#a8a0064746ae8dddfece4229b9ad374d6">subDisplayFile</a>() &lt;&lt; <span class="stringliteral">&quot;In MLSampling&lt;P_V,P_M&gt;::generateSequence()&quot;</span></div>
<div class="line"><a name="l02444"></a><span class="lineno"> 2444</span>&#160;                                &lt;&lt; <span class="stringliteral">&quot;, level &quot;</span> &lt;&lt; <a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#af9416874c856e50f3b35270e801f17e4">m_currLevel</a>+<a class="code" href="_m_l_sampling_level_options_8h.html#a68d15eaf394d210effcf584b938206d3">LEVEL_REF_ID</a></div>
<div class="line"><a name="l02445"></a><span class="lineno"> 2445</span>&#160;                                &lt;&lt; <span class="stringliteral">&quot;: finished generating &quot;</span> &lt;&lt; currChain.subSequenceSize()</div>
<div class="line"><a name="l02446"></a><span class="lineno"> 2446</span>&#160;                                &lt;&lt; <span class="stringliteral">&quot; chain positions&quot;</span></div>
<div class="line"><a name="l02447"></a><span class="lineno"> 2447</span>&#160;                                &lt;&lt; std::endl;</div>
<div class="line"><a name="l02448"></a><span class="lineno"> 2448</span>&#160;</div>
<div class="line"><a name="l02449"></a><span class="lineno"> 2449</span>&#160;        <span class="comment">//unsigned int numZeros = 0;</span></div>
<div class="line"><a name="l02450"></a><span class="lineno"> 2450</span>&#160;        <span class="comment">//for (unsigned int i = 0; i &lt; currTargetValues.subSequenceSize(); ++i) {</span></div>
<div class="line"><a name="l02451"></a><span class="lineno"> 2451</span>&#160;        <span class="comment">//  *m_env.subDisplayFile() &lt;&lt; &quot;currTargetValues[&quot; &lt;&lt; i</span></div>
<div class="line"><a name="l02452"></a><span class="lineno"> 2452</span>&#160;        <span class="comment">//                          &lt;&lt; &quot;] = &quot; &lt;&lt; currTargetValues[i]</span></div>
<div class="line"><a name="l02453"></a><span class="lineno"> 2453</span>&#160;        <span class="comment">//                          &lt;&lt; std::endl;</span></div>
<div class="line"><a name="l02454"></a><span class="lineno"> 2454</span>&#160;        <span class="comment">//  if (currTargetValues[i] == 0.) numZeros++;</span></div>
<div class="line"><a name="l02455"></a><span class="lineno"> 2455</span>&#160;        <span class="comment">//}</span></div>
<div class="line"><a name="l02456"></a><span class="lineno"> 2456</span>&#160;        <span class="comment">//*m_env.subDisplayFile() &lt;&lt; &quot;Number of zeros in currTargetValues = &quot; &lt;&lt; numZeros</span></div>
<div class="line"><a name="l02457"></a><span class="lineno"> 2457</span>&#160;        <span class="comment">//                        &lt;&lt; std::endl;</span></div>
<div class="line"><a name="l02458"></a><span class="lineno"> 2458</span>&#160;      }</div>
<div class="line"><a name="l02459"></a><span class="lineno"> 2459</span>&#160;</div>
<div class="line"><a name="l02460"></a><span class="lineno"> 2460</span>&#160;      <span class="keywordflow">if</span> (currOptions.m_filteredChainGenerate) {</div>
<div class="line"><a name="l02461"></a><span class="lineno"> 2461</span>&#160;        <span class="comment">// todo</span></div>
<div class="line"><a name="l02462"></a><span class="lineno"> 2462</span>&#160;<span class="preprocessor">#ifdef QUESO_USES_SEQUENCE_STATISTICAL_OPTIONS</span></div>
<div class="line"><a name="l02463"></a><span class="lineno"> 2463</span>&#160;<span class="preprocessor"></span>        <span class="keywordflow">if</span> (currOptions.m_filteredChainComputeStats) {</div>
<div class="line"><a name="l02464"></a><span class="lineno"> 2464</span>&#160;          <span class="comment">// todo</span></div>
<div class="line"><a name="l02465"></a><span class="lineno"> 2465</span>&#160;</div>
<div class="line"><a name="l02466"></a><span class="lineno"> 2466</span>&#160;          <span class="comment">//currChain.computeStatistics(*currOptions.m_filteredChainStatisticalOptionsObj,</span></div>
<div class="line"><a name="l02467"></a><span class="lineno"> 2467</span>&#160;          <span class="comment">//                            filePtrSet.ofsVar);</span></div>
<div class="line"><a name="l02468"></a><span class="lineno"> 2468</span>&#160;        }</div>
<div class="line"><a name="l02469"></a><span class="lineno"> 2469</span>&#160;        <span class="comment">// Compute MLE and MAP</span></div>
<div class="line"><a name="l02470"></a><span class="lineno"> 2470</span>&#160;        <span class="comment">// rr0</span></div>
<div class="line"><a name="l02471"></a><span class="lineno"> 2471</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l02472"></a><span class="lineno"> 2472</span>&#160;<span class="preprocessor"></span>      }</div>
<div class="line"><a name="l02473"></a><span class="lineno"> 2473</span>&#160;</div>
<div class="line"><a name="l02474"></a><span class="lineno"> 2474</span>&#160;    } <span class="comment">// KAUST</span></div>
<div class="line"><a name="l02475"></a><span class="lineno"> 2475</span>&#160;</div>
<div class="line"><a name="l02476"></a><span class="lineno"> 2476</span>&#160;    <a class="code" href="_defines_8h.html#a56d63d18d0a6d45757de47fcc06f574d">UQ_FATAL_TEST_MACRO</a>((currChain.subSequenceSize() != currOptions.m_rawChainSize), <span class="comment">// Ok to use rawChainSize</span></div>
<div class="line"><a name="l02477"></a><span class="lineno"> 2477</span>&#160;                        <a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#a78b57112bbd0e6dd0e8afec00b40ffa7">worldRank</a>(),</div>
<div class="line"><a name="l02478"></a><span class="lineno"> 2478</span>&#160;                        <span class="stringliteral">&quot;MLSampling&lt;P_V,P_M&gt;::generateSequence()&quot;</span>,</div>
<div class="line"><a name="l02479"></a><span class="lineno"> 2479</span>&#160;                        <span class="stringliteral">&quot;currChain (first one) has been generated with invalid size&quot;</span>);</div>
<div class="line"><a name="l02480"></a><span class="lineno"> 2480</span>&#160;</div>
<div class="line"><a name="l02481"></a><span class="lineno"> 2481</span>&#160;    <span class="keywordtype">double</span> levelRunTime = <a class="code" href="namespace_q_u_e_s_o.html#a424bc33f2e6e287fd468408d14b772ee">MiscGetEllapsedSeconds</a>(&amp;timevalLevel);</div>
<div class="line"><a name="l02482"></a><span class="lineno"> 2482</span>&#160;    <span class="keywordflow">if</span> ((<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#a8a0064746ae8dddfece4229b9ad374d6">subDisplayFile</a>()) &amp;&amp; (<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#a1fe5f244fc0316a0ab3e37463f108b96">displayVerbosity</a>() &gt;= 0)) {</div>
<div class="line"><a name="l02483"></a><span class="lineno"> 2483</span>&#160;      *<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#a8a0064746ae8dddfece4229b9ad374d6">subDisplayFile</a>() &lt;&lt; <span class="stringliteral">&quot;In MLSampling&lt;P_V,P_M&gt;::generateSequence()&quot;</span></div>
<div class="line"><a name="l02484"></a><span class="lineno"> 2484</span>&#160;                              &lt;&lt; <span class="stringliteral">&quot;: ending level &quot;</span> &lt;&lt; <a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#af9416874c856e50f3b35270e801f17e4">m_currLevel</a>+<a class="code" href="_m_l_sampling_level_options_8h.html#a68d15eaf394d210effcf584b938206d3">LEVEL_REF_ID</a></div>
<div class="line"><a name="l02485"></a><span class="lineno"> 2485</span>&#160;                              &lt;&lt; <span class="stringliteral">&quot;, total level time = &quot;</span> &lt;&lt; levelRunTime &lt;&lt; <span class="stringliteral">&quot; seconds&quot;</span></div>
<div class="line"><a name="l02486"></a><span class="lineno"> 2486</span>&#160;                              &lt;&lt; std::endl;</div>
<div class="line"><a name="l02487"></a><span class="lineno"> 2487</span>&#160;    }</div>
<div class="line"><a name="l02488"></a><span class="lineno"> 2488</span>&#160;</div>
<div class="line"><a name="l02489"></a><span class="lineno"> 2489</span>&#160;  <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l02490"></a><span class="lineno"> 2490</span>&#160;}</div>
<div class="ttc" id="class_q_u_e_s_o_1_1_base_environment_html_ab712bff194ddd91459d4ea8715c77e8b"><div class="ttname"><a href="class_q_u_e_s_o_1_1_base_environment.html#ab712bff194ddd91459d4ea8715c77e8b">QUESO::BaseEnvironment::closeFile</a></div><div class="ttdeci">void closeFile(FilePtrSetStruct &amp;filePtrSet, const std::string &amp;fileType) const </div><div class="ttdoc">Closes the file. </div><div class="ttdef"><b>Definition:</b> <a href="_environment_8_c_source.html#l01117">Environment.C:1117</a></div></div>
<div class="ttc" id="class_q_u_e_s_o_1_1_m_l_sampling_html_a13f1ca4fe9f94822fe572a743eaced1d"><div class="ttname"><a href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">QUESO::MLSampling::m_env</a></div><div class="ttdeci">const BaseEnvironment &amp; m_env</div><div class="ttdoc">Queso enviroment. </div><div class="ttdef"><b>Definition:</b> <a href="_m_l_sampling_8h_source.html#l00442">MLSampling.h:442</a></div></div>
<div class="ttc" id="_mpi_comm_8h_html_afbf78d291c032aa7f512bc566cee2bd1"><div class="ttname"><a href="_mpi_comm_8h.html#afbf78d291c032aa7f512bc566cee2bd1">RawValue_MPI_SUM</a></div><div class="ttdeci">#define RawValue_MPI_SUM</div><div class="ttdef"><b>Definition:</b> <a href="_mpi_comm_8h_source.html#l00052">MpiComm.h:52</a></div></div>
<div class="ttc" id="_metropolis_hastings_s_g_options_8h_html_a75699ceb938d800e2b7f59ede3ea9a31"><div class="ttname"><a href="_metropolis_hastings_s_g_options_8h.html#a75699ceb938d800e2b7f59ede3ea9a31">UQ_MH_SG_FILENAME_FOR_NO_FILE</a></div><div class="ttdeci">#define UQ_MH_SG_FILENAME_FOR_NO_FILE</div><div class="ttdef"><b>Definition:</b> <a href="_metropolis_hastings_s_g_options_8h_source.html#l00035">MetropolisHastingsSGOptions.h:35</a></div></div>
<div class="ttc" id="class_q_u_e_s_o_1_1_vector_space_html_a5829a1f4f996f8307c840b705144d666"><div class="ttname"><a href="class_q_u_e_s_o_1_1_vector_space.html#a5829a1f4f996f8307c840b705144d666">QUESO::VectorSpace::dimLocal</a></div><div class="ttdeci">unsigned int dimLocal() const </div><div class="ttdef"><b>Definition:</b> <a href="_vector_space_8_c_source.html#l00199">VectorSpace.C:199</a></div></div>
<div class="ttc" id="class_q_u_e_s_o_1_1_base_environment_html_a78b57112bbd0e6dd0e8afec00b40ffa7"><div class="ttname"><a href="class_q_u_e_s_o_1_1_base_environment.html#a78b57112bbd0e6dd0e8afec00b40ffa7">QUESO::BaseEnvironment::worldRank</a></div><div class="ttdeci">int worldRank() const </div><div class="ttdoc">Returns the process world rank. </div><div class="ttdef"><b>Definition:</b> <a href="_environment_8_c_source.html#l00235">Environment.C:235</a></div></div>
<div class="ttc" id="namespace_q_u_e_s_o_html_a8e909502900aecf24cedba022ea84471"><div class="ttname"><a href="namespace_q_u_e_s_o.html#a8e909502900aecf24cedba022ea84471">QUESO::UQ_OK_RC</a></div><div class="ttdeci">const int UQ_OK_RC</div><div class="ttdef"><b>Definition:</b> <a href="_defines_8h_source.html#l00075">Defines.h:75</a></div></div>
<div class="ttc" id="class_q_u_e_s_o_1_1_base_environment_html_affe39f53e3d5d678842413370af09145"><div class="ttname"><a href="class_q_u_e_s_o_1_1_base_environment.html#affe39f53e3d5d678842413370af09145">QUESO::BaseEnvironment::subComm</a></div><div class="ttdeci">const MpiComm &amp; subComm() const </div><div class="ttdoc">Access function for MpiComm sub communicator. </div><div class="ttdef"><b>Definition:</b> <a href="_environment_8_c_source.html#l00269">Environment.C:269</a></div></div>
<div class="ttc" id="class_q_u_e_s_o_1_1_base_vector_r_v_html_a3206740e05e0c64a88273029e963b185"><div class="ttname"><a href="class_q_u_e_s_o_1_1_base_vector_r_v.html#a3206740e05e0c64a88273029e963b185">QUESO::BaseVectorRV::pdf</a></div><div class="ttdeci">const BaseJointPdf&lt; V, M &gt; &amp; pdf() const </div><div class="ttdoc">Posterior Density Function of the vector RV; access to private attribute m_pdf. </div><div class="ttdef"><b>Definition:</b> <a href="_vector_r_v_8_c_source.html#l00086">VectorRV.C:86</a></div></div>
<div class="ttc" id="class_q_u_e_s_o_1_1_m_l_sampling_html_a21525858e93a7d9654fdf68c8ac25576"><div class="ttname"><a href="class_q_u_e_s_o_1_1_m_l_sampling.html#a21525858e93a7d9654fdf68c8ac25576">QUESO::MLSampling::m_targetDomain</a></div><div class="ttdeci">VectorSet&lt; P_V, P_M &gt; * m_targetDomain</div><div class="ttdoc">Domain of the target PDF: intersection of the domains of the prior PDf and likelihood function...</div><div class="ttdef"><b>Definition:</b> <a href="_m_l_sampling_8h_source.html#l00454">MLSampling.h:454</a></div></div>
<div class="ttc" id="class_q_u_e_s_o_1_1_m_l_sampling_html_afbe27e6149562020663b72da6592d933"><div class="ttname"><a href="class_q_u_e_s_o_1_1_m_l_sampling.html#afbe27e6149562020663b72da6592d933">QUESO::MLSampling::m_numDisabledParameters</a></div><div class="ttdeci">unsigned int m_numDisabledParameters</div><div class="ttdef"><b>Definition:</b> <a href="_m_l_sampling_8h_source.html#l00456">MLSampling.h:456</a></div></div>
<div class="ttc" id="class_q_u_e_s_o_1_1_scalar_sequence_html_a198b72423333bc5aa1722b830b64a263"><div class="ttname"><a href="class_q_u_e_s_o_1_1_scalar_sequence.html#a198b72423333bc5aa1722b830b64a263">QUESO::ScalarSequence::setName</a></div><div class="ttdeci">void setName(const std::string &amp;newName)</div><div class="ttdoc">Sets a new name to the sequence of scalars. </div><div class="ttdef"><b>Definition:</b> <a href="_scalar_sequence_8_c_source.html#l00120">ScalarSequence.C:120</a></div></div>
<div class="ttc" id="class_q_u_e_s_o_1_1_base_environment_html_ab8fe853074f12ea34e18724119a2fc75"><div class="ttname"><a href="class_q_u_e_s_o_1_1_base_environment.html#ab8fe853074f12ea34e18724119a2fc75">QUESO::BaseEnvironment::openOutputFile</a></div><div class="ttdeci">bool openOutputFile(const std::string &amp;fileName, const std::string &amp;fileType, const std::set&lt; unsigned int &gt; &amp;allowedSubEnvIds, bool writeOver, FilePtrSetStruct &amp;filePtrSet) const </div><div class="ttdoc">Opens an output file for each sub-environment that was chosen to send data to the file...</div><div class="ttdef"><b>Definition:</b> <a href="_environment_8_c_source.html#l00516">Environment.C:516</a></div></div>
<div class="ttc" id="class_q_u_e_s_o_1_1_m_l_sampling_html_ab08c3059d23460db49b229aa88bd4e70"><div class="ttname"><a href="class_q_u_e_s_o_1_1_m_l_sampling.html#ab08c3059d23460db49b229aa88bd4e70">QUESO::MLSampling::m_likelihoodFunction</a></div><div class="ttdeci">const BaseScalarFunction&lt; P_V, P_M &gt; &amp; m_likelihoodFunction</div><div class="ttdoc">Likelihood function. </div><div class="ttdef"><b>Definition:</b> <a href="_m_l_sampling_8h_source.html#l00448">MLSampling.h:448</a></div></div>
<div class="ttc" id="class_q_u_e_s_o_1_1_base_scalar_function_html_acf2f92adac2df2a0d750dc62cd3a4d0a"><div class="ttname"><a href="class_q_u_e_s_o_1_1_base_scalar_function.html#acf2f92adac2df2a0d750dc62cd3a4d0a">QUESO::BaseScalarFunction::lnValue</a></div><div class="ttdeci">virtual double lnValue(const V &amp;domainVector, const V *domainDirection, V *gradVector, M *hessianMatrix, V *hessianEffect) const =0</div><div class="ttdoc">Logarithm of the value of the scalar function. </div></div>
<div class="ttc" id="class_q_u_e_s_o_1_1_base_joint_pdf_html_aaeb1d91fd791399a502f451b07bb1bfe"><div class="ttname"><a href="class_q_u_e_s_o_1_1_base_joint_pdf.html#aaeb1d91fd791399a502f451b07bb1bfe">QUESO::BaseJointPdf::lnValue</a></div><div class="ttdeci">virtual double lnValue(const V &amp;domainVector, const V *domainDirection, V *gradVector, M *hessianMatrix, V *hessianEffect) const =0</div><div class="ttdoc">Logarithm of the value of the function. </div></div>
<div class="ttc" id="class_q_u_e_s_o_1_1_m_l_sampling_html_ac76690384f70d74b8662faf7a051449e"><div class="ttname"><a href="class_q_u_e_s_o_1_1_m_l_sampling.html#ac76690384f70d74b8662faf7a051449e">QUESO::MLSampling::m_parameterEnabledStatus</a></div><div class="ttdeci">std::vector&lt; bool &gt; m_parameterEnabledStatus</div><div class="ttdef"><b>Definition:</b> <a href="_m_l_sampling_8h_source.html#l00458">MLSampling.h:458</a></div></div>
<div class="ttc" id="class_q_u_e_s_o_1_1_m_l_sampling_html_aa45e9c06bd51cae0dc2294af1831c158"><div class="ttname"><a href="class_q_u_e_s_o_1_1_m_l_sampling.html#aa45e9c06bd51cae0dc2294af1831c158">QUESO::MLSampling::m_priorRv</a></div><div class="ttdeci">const BaseVectorRV&lt; P_V, P_M &gt; &amp; m_priorRv</div><div class="ttdoc">Prior RV. </div><div class="ttdef"><b>Definition:</b> <a href="_m_l_sampling_8h_source.html#l00445">MLSampling.h:445</a></div></div>
<div class="ttc" id="class_q_u_e_s_o_1_1_m_l_sampling_html_af9416874c856e50f3b35270e801f17e4"><div class="ttname"><a href="class_q_u_e_s_o_1_1_m_l_sampling.html#af9416874c856e50f3b35270e801f17e4">QUESO::MLSampling::m_currLevel</a></div><div class="ttdeci">unsigned int m_currLevel</div><div class="ttdoc">Current level. </div><div class="ttdef"><b>Definition:</b> <a href="_m_l_sampling_8h_source.html#l00464">MLSampling.h:464</a></div></div>
<div class="ttc" id="class_q_u_e_s_o_1_1_scalar_sequence_html_a2f832dd5eda37df06eb52650ab8ce733"><div class="ttname"><a href="class_q_u_e_s_o_1_1_scalar_sequence.html#a2f832dd5eda37df06eb52650ab8ce733">QUESO::ScalarSequence::unifiedWriteContents</a></div><div class="ttdeci">void unifiedWriteContents(const std::string &amp;fileName, const std::string &amp;fileType) const </div><div class="ttdoc">Writes the unified sequence to a file. </div><div class="ttdef"><b>Definition:</b> <a href="_scalar_sequence_8_c_source.html#l02799">ScalarSequence.C:2799</a></div></div>
<div class="ttc" id="_m_l_sampling_level_options_8h_html_a68d15eaf394d210effcf584b938206d3"><div class="ttname"><a href="_m_l_sampling_level_options_8h.html#a68d15eaf394d210effcf584b938206d3">LEVEL_REF_ID</a></div><div class="ttdeci">#define LEVEL_REF_ID</div><div class="ttdef"><b>Definition:</b> <a href="_m_l_sampling_level_options_8h_source.html#l00028">MLSamplingLevelOptions.h:28</a></div></div>
<div class="ttc" id="_defines_8h_html_ac440026eff7deb1c1eed1eea0e8e36ba"><div class="ttname"><a href="_defines_8h.html#ac440026eff7deb1c1eed1eea0e8e36ba">UQ_FILE_EXTENSION_FOR_MATLAB_FORMAT</a></div><div class="ttdeci">#define UQ_FILE_EXTENSION_FOR_MATLAB_FORMAT</div><div class="ttdef"><b>Definition:</b> <a href="_defines_8h_source.html#l00088">Defines.h:88</a></div></div>
<div class="ttc" id="class_q_u_e_s_o_1_1_vector_space_html_a92e963bb5cab3eecd290dfe4b8f03b04"><div class="ttname"><a href="class_q_u_e_s_o_1_1_vector_space.html#a92e963bb5cab3eecd290dfe4b8f03b04">QUESO::VectorSpace::zeroVector</a></div><div class="ttdeci">const V &amp; zeroVector() const </div><div class="ttdoc">Returns a vector filled with zeros. </div><div class="ttdef"><b>Definition:</b> <a href="_vector_space_8_c_source.html#l00218">VectorSpace.C:218</a></div></div>
<div class="ttc" id="class_q_u_e_s_o_1_1_m_l_sampling_html_a7bc4c72f65ba9166ed94a6e198b0915b"><div class="ttname"><a href="class_q_u_e_s_o_1_1_m_l_sampling.html#a7bc4c72f65ba9166ed94a6e198b0915b">QUESO::MLSampling::m_vectorSpace</a></div><div class="ttdeci">const VectorSpace&lt; P_V, P_M &gt; &amp; m_vectorSpace</div><div class="ttdoc">Vector space. </div><div class="ttdef"><b>Definition:</b> <a href="_m_l_sampling_8h_source.html#l00451">MLSampling.h:451</a></div></div>
<div class="ttc" id="namespace_q_u_e_s_o_html_a424bc33f2e6e287fd468408d14b772ee"><div class="ttname"><a href="namespace_q_u_e_s_o.html#a424bc33f2e6e287fd468408d14b772ee">QUESO::MiscGetEllapsedSeconds</a></div><div class="ttdeci">double MiscGetEllapsedSeconds(struct timeval *timeval0)</div><div class="ttdef"><b>Definition:</b> <a href="_miscellaneous_8_c_source.html#l00287">Miscellaneous.C:287</a></div></div>
<div class="ttc" id="class_q_u_e_s_o_1_1_base_vector_realizer_html_a6845173dd79a80ae11c86cde26e55817"><div class="ttname"><a href="class_q_u_e_s_o_1_1_base_vector_realizer.html#a6845173dd79a80ae11c86cde26e55817">QUESO::BaseVectorRealizer::realization</a></div><div class="ttdeci">virtual void realization(V &amp;nextValues) const =0</div><div class="ttdoc">Performs a realization (sample) from a probability density function. See template specialization...</div></div>
<div class="ttc" id="class_q_u_e_s_o_1_1_base_environment_html_ae106b5bb8a80b655b88b3a26b1e7c185"><div class="ttname"><a href="class_q_u_e_s_o_1_1_base_environment.html#ae106b5bb8a80b655b88b3a26b1e7c185">QUESO::BaseEnvironment::inter0Rank</a></div><div class="ttdeci">int inter0Rank() const </div><div class="ttdoc">Returns the process inter0 rank. </div><div class="ttdef"><b>Definition:</b> <a href="_environment_8_c_source.html#l00289">Environment.C:289</a></div></div>
<div class="ttc" id="class_q_u_e_s_o_1_1_mpi_comm_html_a72e137e60ef8060efb1ee5fc874fa4b8"><div class="ttname"><a href="class_q_u_e_s_o_1_1_mpi_comm.html#a72e137e60ef8060efb1ee5fc874fa4b8">QUESO::MpiComm::Allreduce</a></div><div class="ttdeci">void Allreduce(void *sendbuf, void *recvbuf, int count, RawType_MPI_Datatype datatype, RawType_MPI_Op op, const char *whereMsg, const char *whatMsg) const </div><div class="ttdoc">Combines values from all processes and distributes the result back to all processes. </div><div class="ttdef"><b>Definition:</b> <a href="_mpi_comm_8_c_source.html#l00131">MpiComm.C:131</a></div></div>
<div class="ttc" id="_defines_8h_html_a56d63d18d0a6d45757de47fcc06f574d"><div class="ttname"><a href="_defines_8h.html#a56d63d18d0a6d45757de47fcc06f574d">UQ_FATAL_TEST_MACRO</a></div><div class="ttdeci">#define UQ_FATAL_TEST_MACRO(test, givenRank, where, what)</div><div class="ttdef"><b>Definition:</b> <a href="_defines_8h_source.html#l00222">Defines.h:222</a></div></div>
<div class="ttc" id="_mpi_comm_8h_html_a06cbfbc33436f6e0dc8a48ff3c49bdfc"><div class="ttname"><a href="_mpi_comm_8h.html#a06cbfbc33436f6e0dc8a48ff3c49bdfc">RawValue_MPI_UNSIGNED</a></div><div class="ttdeci">#define RawValue_MPI_UNSIGNED</div><div class="ttdef"><b>Definition:</b> <a href="_mpi_comm_8h_source.html#l00049">MpiComm.h:49</a></div></div>
<div class="ttc" id="class_q_u_e_s_o_1_1_scalar_sequence_html_a2aa8d77c39927060227275b12b6d3dd0"><div class="ttname"><a href="class_q_u_e_s_o_1_1_scalar_sequence.html#a2aa8d77c39927060227275b12b6d3dd0">QUESO::ScalarSequence::resizeSequence</a></div><div class="ttdeci">void resizeSequence(unsigned int newSequenceSize)</div><div class="ttdoc">Resizes the size of the sequence of scalars. </div><div class="ttdef"><b>Definition:</b> <a href="_scalar_sequence_8_c_source.html#l00181">ScalarSequence.C:181</a></div></div>
<div class="ttc" id="class_q_u_e_s_o_1_1_base_environment_html_a1fe5f244fc0316a0ab3e37463f108b96"><div class="ttname"><a href="class_q_u_e_s_o_1_1_base_environment.html#a1fe5f244fc0316a0ab3e37463f108b96">QUESO::BaseEnvironment::displayVerbosity</a></div><div class="ttdeci">unsigned int displayVerbosity() const </div><div class="ttdef"><b>Definition:</b> <a href="_environment_8_c_source.html#l00436">Environment.C:436</a></div></div>
<div class="ttc" id="class_q_u_e_s_o_1_1_base_environment_html_a8a0064746ae8dddfece4229b9ad374d6"><div class="ttname"><a href="class_q_u_e_s_o_1_1_base_environment.html#a8a0064746ae8dddfece4229b9ad374d6">QUESO::BaseEnvironment::subDisplayFile</a></div><div class="ttdeci">std::ofstream * subDisplayFile() const </div><div class="ttdoc">Access function for m_subDisplayFile (displays file on stream). </div><div class="ttdef"><b>Definition:</b> <a href="_environment_8_c_source.html#l00305">Environment.C:305</a></div></div>
<div class="ttc" id="class_q_u_e_s_o_1_1_base_environment_html_a689e4d140c74d495d97eb498714a4b82"><div class="ttname"><a href="class_q_u_e_s_o_1_1_base_environment.html#a689e4d140c74d495d97eb498714a4b82">QUESO::BaseEnvironment::inter0Comm</a></div><div class="ttdeci">const MpiComm &amp; inter0Comm() const </div><div class="ttdoc">Access function for MpiComm inter0-communicator. </div><div class="ttdef"><b>Definition:</b> <a href="_environment_8_c_source.html#l00295">Environment.C:295</a></div></div>
<div class="ttc" id="class_q_u_e_s_o_1_1_vector_set_html_ab59fe6ca67647f58920681e05165a9d0"><div class="ttname"><a href="class_q_u_e_s_o_1_1_vector_set.html#ab59fe6ca67647f58920681e05165a9d0">QUESO::VectorSet::contains</a></div><div class="ttdeci">virtual bool contains(const V &amp;vec) const =0</div><div class="ttdoc">Checks whether a set contains vector vec. See template specialization. </div></div>
<div class="ttc" id="class_q_u_e_s_o_1_1_base_vector_r_v_html_aea4b01eef0baf36944d14459a7b9ccf4"><div class="ttname"><a href="class_q_u_e_s_o_1_1_base_vector_r_v.html#aea4b01eef0baf36944d14459a7b9ccf4">QUESO::BaseVectorRV::realizer</a></div><div class="ttdeci">const BaseVectorRealizer&lt; V, M &gt; &amp; realizer() const </div><div class="ttdoc">Finds a realization (sample) of the PDF of this vector RV; access to private attribute m_realizer...</div><div class="ttdef"><b>Definition:</b> <a href="_vector_r_v_8_c_source.html#l00098">VectorRV.C:98</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="aea8da13aed5b04e64b8490ca5f107889"></a>
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;class P_V , class P_M &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="class_q_u_e_s_o_1_1_m_l_sampling.html">QUESO::MLSampling</a>&lt; P_V, P_M &gt;::generateSequence_Step01_inter0 </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="class_q_u_e_s_o_1_1_m_l_sampling_level_options.html">MLSamplingLevelOptions</a> *&#160;</td>
          <td class="paramname"><em>currOptions</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned int &amp;&#160;</td>
          <td class="paramname"><em>unifiedRequestedNumSamples</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Reads options for the ML algorithm (Step 01 from ML algorithm). </p>
<p>This method is responsible for the Step 01 in the ML algorithm implemented/described in the method <a class="el" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a8d7296b30623c73ada38971cae27994a" title="Method to generate the chain. ">MLSampling&lt;P_V,P_M&gt;::generateSequence</a>.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">currOptions</td><td></td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">unifiedRequestedNumSamples</td><td></td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="_m_l_sampling_8_c_source.html#l02494">2494</a> of file <a class="el" href="_m_l_sampling_8_c_source.html">MLSampling.C</a>.</p>

<p>References <a class="el" href="_m_l_sampling_level_options_8h_source.html#l00028">LEVEL_REF_ID</a>, <a class="el" href="_m_l_sampling_level_options_8h_source.html#l00222">QUESO::MLSamplingLevelOptions::m_rawChainSize</a>, <a class="el" href="_miscellaneous_8_c_source.html#l00287">QUESO::MiscGetEllapsedSeconds()</a>, <a class="el" href="_mpi_comm_8h_source.html#l00052">RawValue_MPI_SUM</a>, <a class="el" href="_mpi_comm_8h_source.html#l00049">RawValue_MPI_UNSIGNED</a>, and <a class="el" href="_defines_8h_source.html#l00075">QUESO::UQ_OK_RC</a>.</p>
<div class="fragment"><div class="line"><a name="l02497"></a><span class="lineno"> 2497</span>&#160;{</div>
<div class="line"><a name="l02498"></a><span class="lineno"> 2498</span>&#160;  <span class="keywordtype">int</span> iRC = <a class="code" href="namespace_q_u_e_s_o.html#a8e909502900aecf24cedba022ea84471">UQ_OK_RC</a>;</div>
<div class="line"><a name="l02499"></a><span class="lineno"> 2499</span>&#160;  <span class="keyword">struct </span>timeval timevalStep;</div>
<div class="line"><a name="l02500"></a><span class="lineno"> 2500</span>&#160;  iRC = gettimeofday(&amp;timevalStep, NULL);</div>
<div class="line"><a name="l02501"></a><span class="lineno"> 2501</span>&#160;  <span class="keywordflow">if</span> (iRC) {}; <span class="comment">// just to remove compiler warning</span></div>
<div class="line"><a name="l02502"></a><span class="lineno"> 2502</span>&#160;</div>
<div class="line"><a name="l02503"></a><span class="lineno"> 2503</span>&#160;      <span class="keywordflow">if</span> ((<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#a8a0064746ae8dddfece4229b9ad374d6">subDisplayFile</a>()) &amp;&amp; (<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#a1fe5f244fc0316a0ab3e37463f108b96">displayVerbosity</a>() &gt;= 0)) {</div>
<div class="line"><a name="l02504"></a><span class="lineno"> 2504</span>&#160;        *<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#a8a0064746ae8dddfece4229b9ad374d6">subDisplayFile</a>() &lt;&lt; <span class="stringliteral">&quot;In MLSampling&lt;P_V,P_M&gt;::generateSequence()&quot;</span></div>
<div class="line"><a name="l02505"></a><span class="lineno"> 2505</span>&#160;                                &lt;&lt; <span class="stringliteral">&quot;, level &quot;</span> &lt;&lt; <a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#af9416874c856e50f3b35270e801f17e4">m_currLevel</a>+<a class="code" href="_m_l_sampling_level_options_8h.html#a68d15eaf394d210effcf584b938206d3">LEVEL_REF_ID</a></div>
<div class="line"><a name="l02506"></a><span class="lineno"> 2506</span>&#160;                                &lt;&lt; <span class="stringliteral">&quot;, step &quot;</span>  &lt;&lt; <a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a1b1f8ccb4823bdfa26ec652f0807c63e">m_currStep</a></div>
<div class="line"><a name="l02507"></a><span class="lineno"> 2507</span>&#160;                                &lt;&lt; <span class="stringliteral">&quot;: beginning step 1 of 11&quot;</span></div>
<div class="line"><a name="l02508"></a><span class="lineno"> 2508</span>&#160;                                &lt;&lt; std::endl;</div>
<div class="line"><a name="l02509"></a><span class="lineno"> 2509</span>&#160;      }</div>
<div class="line"><a name="l02510"></a><span class="lineno"> 2510</span>&#160;</div>
<div class="line"><a name="l02511"></a><span class="lineno"> 2511</span>&#160;      <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> tmpSize = currOptions-&gt;m_rawChainSize;</div>
<div class="line"><a name="l02512"></a><span class="lineno"> 2512</span>&#160;      <span class="comment">// This computed &#39;unifiedRequestedNumSamples&#39; needs to be recomputed only at the last</span></div>
<div class="line"><a name="l02513"></a><span class="lineno"> 2513</span>&#160;      <span class="comment">// level, when &#39;currOptions&#39; is replaced by &#39;lastLevelOptions&#39; (see step 3 of 11)</span></div>
<div class="line"><a name="l02514"></a><span class="lineno"> 2514</span>&#160;      <a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#a689e4d140c74d495d97eb498714a4b82">inter0Comm</a>().<a class="code" href="class_q_u_e_s_o_1_1_mpi_comm.html#a72e137e60ef8060efb1ee5fc874fa4b8">Allreduce</a>((<span class="keywordtype">void</span> *) &amp;tmpSize, (<span class="keywordtype">void</span> *) &amp;unifiedRequestedNumSamples, (<span class="keywordtype">int</span>) 1, <a class="code" href="_mpi_comm_8h.html#a06cbfbc33436f6e0dc8a48ff3c49bdfc">RawValue_MPI_UNSIGNED</a>, <a class="code" href="_mpi_comm_8h.html#afbf78d291c032aa7f512bc566cee2bd1">RawValue_MPI_SUM</a>,</div>
<div class="line"><a name="l02515"></a><span class="lineno"> 2515</span>&#160;                                   <span class="stringliteral">&quot;MLSampling&lt;P_V,P_M&gt;::generateSequence()&quot;</span>,</div>
<div class="line"><a name="l02516"></a><span class="lineno"> 2516</span>&#160;                                   <span class="stringliteral">&quot;failed MPI.Allreduce() for requested num samples in step 1&quot;</span>);</div>
<div class="line"><a name="l02517"></a><span class="lineno"> 2517</span>&#160;</div>
<div class="line"><a name="l02518"></a><span class="lineno"> 2518</span>&#160;      <span class="keywordflow">if</span> ((<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#a8a0064746ae8dddfece4229b9ad374d6">subDisplayFile</a>()) &amp;&amp; (<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#a1fe5f244fc0316a0ab3e37463f108b96">displayVerbosity</a>() &gt;= 0)) {</div>
<div class="line"><a name="l02519"></a><span class="lineno"> 2519</span>&#160;        *<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#a8a0064746ae8dddfece4229b9ad374d6">subDisplayFile</a>() &lt;&lt; <span class="stringliteral">&quot;KEY In MLSampling&lt;P_V,P_M&gt;::generateSequence()&quot;</span></div>
<div class="line"><a name="l02520"></a><span class="lineno"> 2520</span>&#160;                                &lt;&lt; <span class="stringliteral">&quot;, level &quot;</span> &lt;&lt; <a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#af9416874c856e50f3b35270e801f17e4">m_currLevel</a>+<a class="code" href="_m_l_sampling_level_options_8h.html#a68d15eaf394d210effcf584b938206d3">LEVEL_REF_ID</a></div>
<div class="line"><a name="l02521"></a><span class="lineno"> 2521</span>&#160;                                &lt;&lt; <span class="stringliteral">&quot;, step &quot;</span>  &lt;&lt; <a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a1b1f8ccb4823bdfa26ec652f0807c63e">m_currStep</a></div>
<div class="line"><a name="l02522"></a><span class="lineno"> 2522</span>&#160;                                &lt;&lt; <span class="stringliteral">&quot;, currOptions-&gt;m_rawChainSize = &quot;</span> &lt;&lt; currOptions-&gt;m_rawChainSize <span class="comment">// Ok to use rawChainSize</span></div>
<div class="line"><a name="l02523"></a><span class="lineno"> 2523</span>&#160;                                &lt;&lt; std::endl;</div>
<div class="line"><a name="l02524"></a><span class="lineno"> 2524</span>&#160;      }</div>
<div class="line"><a name="l02525"></a><span class="lineno"> 2525</span>&#160;</div>
<div class="line"><a name="l02526"></a><span class="lineno"> 2526</span>&#160;  <span class="keywordtype">double</span> stepRunTime = <a class="code" href="namespace_q_u_e_s_o.html#a424bc33f2e6e287fd468408d14b772ee">MiscGetEllapsedSeconds</a>(&amp;timevalStep);</div>
<div class="line"><a name="l02527"></a><span class="lineno"> 2527</span>&#160;  <span class="keywordflow">if</span> ((<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#a8a0064746ae8dddfece4229b9ad374d6">subDisplayFile</a>()) &amp;&amp; (<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#a1fe5f244fc0316a0ab3e37463f108b96">displayVerbosity</a>() &gt;= 0)) {</div>
<div class="line"><a name="l02528"></a><span class="lineno"> 2528</span>&#160;    *<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#a8a0064746ae8dddfece4229b9ad374d6">subDisplayFile</a>() &lt;&lt; <span class="stringliteral">&quot;Leaving MLSampling&lt;P_V,P_M&gt;::generateSequence_Step()&quot;</span></div>
<div class="line"><a name="l02529"></a><span class="lineno"> 2529</span>&#160;                            &lt;&lt; <span class="stringliteral">&quot;, level &quot;</span> &lt;&lt; <a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#af9416874c856e50f3b35270e801f17e4">m_currLevel</a>+<a class="code" href="_m_l_sampling_level_options_8h.html#a68d15eaf394d210effcf584b938206d3">LEVEL_REF_ID</a></div>
<div class="line"><a name="l02530"></a><span class="lineno"> 2530</span>&#160;                            &lt;&lt; <span class="stringliteral">&quot;, step &quot;</span>  &lt;&lt; <a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a1b1f8ccb4823bdfa26ec652f0807c63e">m_currStep</a></div>
<div class="line"><a name="l02531"></a><span class="lineno"> 2531</span>&#160;                            &lt;&lt; <span class="stringliteral">&quot;, after &quot;</span> &lt;&lt; stepRunTime &lt;&lt; <span class="stringliteral">&quot; seconds&quot;</span></div>
<div class="line"><a name="l02532"></a><span class="lineno"> 2532</span>&#160;                            &lt;&lt; std::endl;</div>
<div class="line"><a name="l02533"></a><span class="lineno"> 2533</span>&#160;  }</div>
<div class="line"><a name="l02534"></a><span class="lineno"> 2534</span>&#160;</div>
<div class="line"><a name="l02535"></a><span class="lineno"> 2535</span>&#160;  <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l02536"></a><span class="lineno"> 2536</span>&#160;}</div>
<div class="ttc" id="class_q_u_e_s_o_1_1_m_l_sampling_html_a13f1ca4fe9f94822fe572a743eaced1d"><div class="ttname"><a href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">QUESO::MLSampling::m_env</a></div><div class="ttdeci">const BaseEnvironment &amp; m_env</div><div class="ttdoc">Queso enviroment. </div><div class="ttdef"><b>Definition:</b> <a href="_m_l_sampling_8h_source.html#l00442">MLSampling.h:442</a></div></div>
<div class="ttc" id="_mpi_comm_8h_html_afbf78d291c032aa7f512bc566cee2bd1"><div class="ttname"><a href="_mpi_comm_8h.html#afbf78d291c032aa7f512bc566cee2bd1">RawValue_MPI_SUM</a></div><div class="ttdeci">#define RawValue_MPI_SUM</div><div class="ttdef"><b>Definition:</b> <a href="_mpi_comm_8h_source.html#l00052">MpiComm.h:52</a></div></div>
<div class="ttc" id="namespace_q_u_e_s_o_html_a8e909502900aecf24cedba022ea84471"><div class="ttname"><a href="namespace_q_u_e_s_o.html#a8e909502900aecf24cedba022ea84471">QUESO::UQ_OK_RC</a></div><div class="ttdeci">const int UQ_OK_RC</div><div class="ttdef"><b>Definition:</b> <a href="_defines_8h_source.html#l00075">Defines.h:75</a></div></div>
<div class="ttc" id="class_q_u_e_s_o_1_1_m_l_sampling_html_af9416874c856e50f3b35270e801f17e4"><div class="ttname"><a href="class_q_u_e_s_o_1_1_m_l_sampling.html#af9416874c856e50f3b35270e801f17e4">QUESO::MLSampling::m_currLevel</a></div><div class="ttdeci">unsigned int m_currLevel</div><div class="ttdoc">Current level. </div><div class="ttdef"><b>Definition:</b> <a href="_m_l_sampling_8h_source.html#l00464">MLSampling.h:464</a></div></div>
<div class="ttc" id="_m_l_sampling_level_options_8h_html_a68d15eaf394d210effcf584b938206d3"><div class="ttname"><a href="_m_l_sampling_level_options_8h.html#a68d15eaf394d210effcf584b938206d3">LEVEL_REF_ID</a></div><div class="ttdeci">#define LEVEL_REF_ID</div><div class="ttdef"><b>Definition:</b> <a href="_m_l_sampling_level_options_8h_source.html#l00028">MLSamplingLevelOptions.h:28</a></div></div>
<div class="ttc" id="namespace_q_u_e_s_o_html_a424bc33f2e6e287fd468408d14b772ee"><div class="ttname"><a href="namespace_q_u_e_s_o.html#a424bc33f2e6e287fd468408d14b772ee">QUESO::MiscGetEllapsedSeconds</a></div><div class="ttdeci">double MiscGetEllapsedSeconds(struct timeval *timeval0)</div><div class="ttdef"><b>Definition:</b> <a href="_miscellaneous_8_c_source.html#l00287">Miscellaneous.C:287</a></div></div>
<div class="ttc" id="class_q_u_e_s_o_1_1_mpi_comm_html_a72e137e60ef8060efb1ee5fc874fa4b8"><div class="ttname"><a href="class_q_u_e_s_o_1_1_mpi_comm.html#a72e137e60ef8060efb1ee5fc874fa4b8">QUESO::MpiComm::Allreduce</a></div><div class="ttdeci">void Allreduce(void *sendbuf, void *recvbuf, int count, RawType_MPI_Datatype datatype, RawType_MPI_Op op, const char *whereMsg, const char *whatMsg) const </div><div class="ttdoc">Combines values from all processes and distributes the result back to all processes. </div><div class="ttdef"><b>Definition:</b> <a href="_mpi_comm_8_c_source.html#l00131">MpiComm.C:131</a></div></div>
<div class="ttc" id="_mpi_comm_8h_html_a06cbfbc33436f6e0dc8a48ff3c49bdfc"><div class="ttname"><a href="_mpi_comm_8h.html#a06cbfbc33436f6e0dc8a48ff3c49bdfc">RawValue_MPI_UNSIGNED</a></div><div class="ttdeci">#define RawValue_MPI_UNSIGNED</div><div class="ttdef"><b>Definition:</b> <a href="_mpi_comm_8h_source.html#l00049">MpiComm.h:49</a></div></div>
<div class="ttc" id="class_q_u_e_s_o_1_1_m_l_sampling_html_a1b1f8ccb4823bdfa26ec652f0807c63e"><div class="ttname"><a href="class_q_u_e_s_o_1_1_m_l_sampling.html#a1b1f8ccb4823bdfa26ec652f0807c63e">QUESO::MLSampling::m_currStep</a></div><div class="ttdeci">unsigned int m_currStep</div><div class="ttdoc">Curret step. </div><div class="ttdef"><b>Definition:</b> <a href="_m_l_sampling_8h_source.html#l00467">MLSampling.h:467</a></div></div>
<div class="ttc" id="class_q_u_e_s_o_1_1_base_environment_html_a1fe5f244fc0316a0ab3e37463f108b96"><div class="ttname"><a href="class_q_u_e_s_o_1_1_base_environment.html#a1fe5f244fc0316a0ab3e37463f108b96">QUESO::BaseEnvironment::displayVerbosity</a></div><div class="ttdeci">unsigned int displayVerbosity() const </div><div class="ttdef"><b>Definition:</b> <a href="_environment_8_c_source.html#l00436">Environment.C:436</a></div></div>
<div class="ttc" id="class_q_u_e_s_o_1_1_base_environment_html_a8a0064746ae8dddfece4229b9ad374d6"><div class="ttname"><a href="class_q_u_e_s_o_1_1_base_environment.html#a8a0064746ae8dddfece4229b9ad374d6">QUESO::BaseEnvironment::subDisplayFile</a></div><div class="ttdeci">std::ofstream * subDisplayFile() const </div><div class="ttdoc">Access function for m_subDisplayFile (displays file on stream). </div><div class="ttdef"><b>Definition:</b> <a href="_environment_8_c_source.html#l00305">Environment.C:305</a></div></div>
<div class="ttc" id="class_q_u_e_s_o_1_1_base_environment_html_a689e4d140c74d495d97eb498714a4b82"><div class="ttname"><a href="class_q_u_e_s_o_1_1_base_environment.html#a689e4d140c74d495d97eb498714a4b82">QUESO::BaseEnvironment::inter0Comm</a></div><div class="ttdeci">const MpiComm &amp; inter0Comm() const </div><div class="ttdoc">Access function for MpiComm inter0-communicator. </div><div class="ttdef"><b>Definition:</b> <a href="_environment_8_c_source.html#l00295">Environment.C:295</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a06c37730b943a1838d58475d322639b9"></a>
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;class P_V , class P_M &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="class_q_u_e_s_o_1_1_m_l_sampling.html">QUESO::MLSampling</a>&lt; P_V, P_M &gt;::generateSequence_Step02_inter0 </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="class_q_u_e_s_o_1_1_m_l_sampling_level_options.html">MLSamplingLevelOptions</a> *&#160;</td>
          <td class="paramname"><em>currOptions</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_q_u_e_s_o_1_1_sequence_of_vectors.html">SequenceOfVectors</a>&lt; P_V, P_M &gt; &amp;&#160;</td>
          <td class="paramname"><em>currChain</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_q_u_e_s_o_1_1_scalar_sequence.html">ScalarSequence</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>currLogLikelihoodValues</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_q_u_e_s_o_1_1_scalar_sequence.html">ScalarSequence</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>currLogTargetValues</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_q_u_e_s_o_1_1_sequence_of_vectors.html">SequenceOfVectors</a>&lt; P_V, P_M &gt; &amp;&#160;</td>
          <td class="paramname"><em>prevChain</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_q_u_e_s_o_1_1_scalar_sequence.html">ScalarSequence</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>prevLogLikelihoodValues</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_q_u_e_s_o_1_1_scalar_sequence.html">ScalarSequence</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>prevLogTargetValues</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned int &amp;&#160;</td>
          <td class="paramname"><em>indexOfFirstWeight</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned int &amp;&#160;</td>
          <td class="paramname"><em>indexOfLastWeight</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Saves chain and corresponding target pdf values from previous level (Step 02 from ML algorithm). </p>
<p>This method is responsible for the Step 02 in the ML algorithm implemented/described in the method <a class="el" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a8d7296b30623c73ada38971cae27994a" title="Method to generate the chain. ">MLSampling&lt;P_V,P_M&gt;::generateSequence</a>.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">currOptions</td><td></td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">currChain,currLogLikelihoodValues,currLogTargetValues</td><td></td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">prevChain,prevLogLikelihoodValues,prevLogTargetValues,indexOfFirstWeight,indexOfLastWeight</td><td></td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="_m_l_sampling_8_c_source.html#l02540">2540</a> of file <a class="el" href="_m_l_sampling_8_c_source.html">MLSampling.C</a>.</p>

<p>References <a class="el" href="_vector_sequence_8_c_source.html#l00136">QUESO::BaseVectorSequence&lt; V, M &gt;::clear()</a>, <a class="el" href="_scalar_sequence_8_c_source.html#l00128">QUESO::ScalarSequence&lt; T &gt;::clear()</a>, <a class="el" href="_sequence_of_vectors_8_c_source.html#l00197">QUESO::SequenceOfVectors&lt; V, M &gt;::getPositionValues()</a>, <a class="el" href="_m_l_sampling_level_options_8h_source.html#l00028">LEVEL_REF_ID</a>, <a class="el" href="_m_l_sampling_level_options_8h_source.html#l00143">QUESO::MLSamplingLevelOptions::m_prefix</a>, <a class="el" href="_miscellaneous_8_c_source.html#l00287">QUESO::MiscGetEllapsedSeconds()</a>, <a class="el" href="_mpi_comm_8h_source.html#l00049">RawValue_MPI_UNSIGNED</a>, <a class="el" href="_vector_sequence_8_c_source.html#l00128">QUESO::BaseVectorSequence&lt; V, M &gt;::setName()</a>, <a class="el" href="_scalar_sequence_8_c_source.html#l00120">QUESO::ScalarSequence&lt; T &gt;::setName()</a>, <a class="el" href="_sequence_of_vectors_8_c_source.html#l00103">QUESO::SequenceOfVectors&lt; V, M &gt;::subSequenceSize()</a>, <a class="el" href="_scalar_sequence_8_c_source.html#l00141">QUESO::ScalarSequence&lt; T &gt;::subSequenceSize()</a>, <a class="el" href="_vector_sequence_8_c_source.html#l00070">QUESO::BaseVectorSequence&lt; V, M &gt;::unifiedSequenceSize()</a>, <a class="el" href="_scalar_sequence_8_c_source.html#l00148">QUESO::ScalarSequence&lt; T &gt;::unifiedSequenceSize()</a>, <a class="el" href="_defines_8h_source.html#l00222">UQ_FATAL_TEST_MACRO</a>, and <a class="el" href="_defines_8h_source.html#l00075">QUESO::UQ_OK_RC</a>.</p>
<div class="fragment"><div class="line"><a name="l02550"></a><span class="lineno"> 2550</span>&#160;{</div>
<div class="line"><a name="l02551"></a><span class="lineno"> 2551</span>&#160;  <span class="keywordtype">int</span> iRC = <a class="code" href="namespace_q_u_e_s_o.html#a8e909502900aecf24cedba022ea84471">UQ_OK_RC</a>;</div>
<div class="line"><a name="l02552"></a><span class="lineno"> 2552</span>&#160;  <span class="keyword">struct </span>timeval timevalStep;</div>
<div class="line"><a name="l02553"></a><span class="lineno"> 2553</span>&#160;  iRC = gettimeofday(&amp;timevalStep, NULL);</div>
<div class="line"><a name="l02554"></a><span class="lineno"> 2554</span>&#160;  <span class="keywordflow">if</span> (iRC) {}; <span class="comment">// just to remove compiler warning</span></div>
<div class="line"><a name="l02555"></a><span class="lineno"> 2555</span>&#160;</div>
<div class="line"><a name="l02556"></a><span class="lineno"> 2556</span>&#160;      <span class="keywordflow">if</span> ((<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#a8a0064746ae8dddfece4229b9ad374d6">subDisplayFile</a>()) &amp;&amp; (<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#a1fe5f244fc0316a0ab3e37463f108b96">displayVerbosity</a>() &gt;= 0)) {</div>
<div class="line"><a name="l02557"></a><span class="lineno"> 2557</span>&#160;        *<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#a8a0064746ae8dddfece4229b9ad374d6">subDisplayFile</a>() &lt;&lt; <span class="stringliteral">&quot;In MLSampling&lt;P_V,P_M&gt;::generateSequence()&quot;</span></div>
<div class="line"><a name="l02558"></a><span class="lineno"> 2558</span>&#160;                                &lt;&lt; <span class="stringliteral">&quot;, level &quot;</span> &lt;&lt; <a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#af9416874c856e50f3b35270e801f17e4">m_currLevel</a>+<a class="code" href="_m_l_sampling_level_options_8h.html#a68d15eaf394d210effcf584b938206d3">LEVEL_REF_ID</a></div>
<div class="line"><a name="l02559"></a><span class="lineno"> 2559</span>&#160;                                &lt;&lt; <span class="stringliteral">&quot;, step &quot;</span>  &lt;&lt; <a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a1b1f8ccb4823bdfa26ec652f0807c63e">m_currStep</a></div>
<div class="line"><a name="l02560"></a><span class="lineno"> 2560</span>&#160;                                &lt;&lt; <span class="stringliteral">&quot;: beginning step 2 of 11&quot;</span></div>
<div class="line"><a name="l02561"></a><span class="lineno"> 2561</span>&#160;                                &lt;&lt; std::endl;</div>
<div class="line"><a name="l02562"></a><span class="lineno"> 2562</span>&#160;      }</div>
<div class="line"><a name="l02563"></a><span class="lineno"> 2563</span>&#160;</div>
<div class="line"><a name="l02564"></a><span class="lineno"> 2564</span>&#160;      prevChain = currChain;</div>
<div class="line"><a name="l02565"></a><span class="lineno"> 2565</span>&#160;      currChain.clear();</div>
<div class="line"><a name="l02566"></a><span class="lineno"> 2566</span>&#160;      currChain.setName(currOptions-&gt;m_prefix + <span class="stringliteral">&quot;rawChain&quot;</span>);</div>
<div class="line"><a name="l02567"></a><span class="lineno"> 2567</span>&#160;</div>
<div class="line"><a name="l02568"></a><span class="lineno"> 2568</span>&#160;      prevLogLikelihoodValues = currLogLikelihoodValues; <span class="comment">// likelihood is important</span></div>
<div class="line"><a name="l02569"></a><span class="lineno"> 2569</span>&#160;      <span class="keywordflow">if</span> ((<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#a8a0064746ae8dddfece4229b9ad374d6">subDisplayFile</a>()) &amp;&amp; (<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#a1fe5f244fc0316a0ab3e37463f108b96">displayVerbosity</a>() &gt;= 0)) {</div>
<div class="line"><a name="l02570"></a><span class="lineno"> 2570</span>&#160;        *<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#a8a0064746ae8dddfece4229b9ad374d6">subDisplayFile</a>() &lt;&lt; <span class="stringliteral">&quot;In MLSampling&lt;P_V,P_M&gt;::generateSequence_Step()&quot;</span></div>
<div class="line"><a name="l02571"></a><span class="lineno"> 2571</span>&#160;                                &lt;&lt; <span class="stringliteral">&quot;, level &quot;</span> &lt;&lt; <a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#af9416874c856e50f3b35270e801f17e4">m_currLevel</a>+<a class="code" href="_m_l_sampling_level_options_8h.html#a68d15eaf394d210effcf584b938206d3">LEVEL_REF_ID</a></div>
<div class="line"><a name="l02572"></a><span class="lineno"> 2572</span>&#160;                                &lt;&lt; <span class="stringliteral">&quot;, step &quot;</span>  &lt;&lt; <a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a1b1f8ccb4823bdfa26ec652f0807c63e">m_currStep</a></div>
<div class="line"><a name="l02573"></a><span class="lineno"> 2573</span>&#160;                                &lt;&lt; <span class="stringliteral">&quot;, prevLogLikelihoodValues[0] = &quot;</span> &lt;&lt; prevLogLikelihoodValues[0]</div>
<div class="line"><a name="l02574"></a><span class="lineno"> 2574</span>&#160;                                &lt;&lt; std::endl;</div>
<div class="line"><a name="l02575"></a><span class="lineno"> 2575</span>&#160;      }</div>
<div class="line"><a name="l02576"></a><span class="lineno"> 2576</span>&#160;      prevLogTargetValues     = currLogTargetValues;</div>
<div class="line"><a name="l02577"></a><span class="lineno"> 2577</span>&#160;</div>
<div class="line"><a name="l02578"></a><span class="lineno"> 2578</span>&#160;      currLogLikelihoodValues.<a class="code" href="class_q_u_e_s_o_1_1_scalar_sequence.html#aa5449ca2f03f5e6025d35804bee19ee0">clear</a>();</div>
<div class="line"><a name="l02579"></a><span class="lineno"> 2579</span>&#160;      currLogLikelihoodValues.<a class="code" href="class_q_u_e_s_o_1_1_scalar_sequence.html#a198b72423333bc5aa1722b830b64a263">setName</a>(currOptions-&gt;m_prefix + <span class="stringliteral">&quot;rawLogLikelihood&quot;</span>);</div>
<div class="line"><a name="l02580"></a><span class="lineno"> 2580</span>&#160;</div>
<div class="line"><a name="l02581"></a><span class="lineno"> 2581</span>&#160;      currLogTargetValues.<a class="code" href="class_q_u_e_s_o_1_1_scalar_sequence.html#aa5449ca2f03f5e6025d35804bee19ee0">clear</a>();</div>
<div class="line"><a name="l02582"></a><span class="lineno"> 2582</span>&#160;      currLogTargetValues.<a class="code" href="class_q_u_e_s_o_1_1_scalar_sequence.html#a198b72423333bc5aa1722b830b64a263">setName</a>(currOptions-&gt;m_prefix + <span class="stringliteral">&quot;rawLogTarget&quot;</span>);</div>
<div class="line"><a name="l02583"></a><span class="lineno"> 2583</span>&#160;</div>
<div class="line"><a name="l02584"></a><span class="lineno"> 2584</span>&#160;<span class="preprocessor">#if 0 // For debug only</span></div>
<div class="line"><a name="l02585"></a><span class="lineno"> 2585</span>&#160;<span class="preprocessor"></span>      <span class="keywordflow">if</span> ((<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#a8a0064746ae8dddfece4229b9ad374d6">subDisplayFile</a>()) &amp;&amp; (<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#a1fe5f244fc0316a0ab3e37463f108b96">displayVerbosity</a>() &gt;= 0)) {</div>
<div class="line"><a name="l02586"></a><span class="lineno"> 2586</span>&#160;        P_V prevPosition(<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a7bc4c72f65ba9166ed94a6e198b0915b">m_vectorSpace</a>.<a class="code" href="class_q_u_e_s_o_1_1_vector_space.html#a92e963bb5cab3eecd290dfe4b8f03b04">zeroVector</a>());</div>
<div class="line"><a name="l02587"></a><span class="lineno"> 2587</span>&#160;        *<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#a8a0064746ae8dddfece4229b9ad374d6">subDisplayFile</a>() &lt;&lt; <span class="stringliteral">&quot;In MLSampling&lt;P_V,P_M&gt;::generateSequence()&quot;</span></div>
<div class="line"><a name="l02588"></a><span class="lineno"> 2588</span>&#160;                                &lt;&lt; <span class="stringliteral">&quot;, level &quot;</span> &lt;&lt; <a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#af9416874c856e50f3b35270e801f17e4">m_currLevel</a>+<a class="code" href="_m_l_sampling_level_options_8h.html#a68d15eaf394d210effcf584b938206d3">LEVEL_REF_ID</a></div>
<div class="line"><a name="l02589"></a><span class="lineno"> 2589</span>&#160;                                &lt;&lt; <span class="stringliteral">&quot;, step &quot;</span>  &lt;&lt; <a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a1b1f8ccb4823bdfa26ec652f0807c63e">m_currStep</a></div>
<div class="line"><a name="l02590"></a><span class="lineno"> 2590</span>&#160;                                &lt;&lt; <span class="stringliteral">&quot;:&quot;</span></div>
<div class="line"><a name="l02591"></a><span class="lineno"> 2591</span>&#160;                                &lt;&lt; std::endl;</div>
<div class="line"><a name="l02592"></a><span class="lineno"> 2592</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = 0; i &lt; prevChain.subSequenceSize(); ++i) {</div>
<div class="line"><a name="l02593"></a><span class="lineno"> 2593</span>&#160;          prevChain.getPositionValues(i,prevPosition);</div>
<div class="line"><a name="l02594"></a><span class="lineno"> 2594</span>&#160;          *<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#a8a0064746ae8dddfece4229b9ad374d6">subDisplayFile</a>() &lt;&lt; <span class="stringliteral">&quot;  prevChain[&quot;</span> &lt;&lt; i</div>
<div class="line"><a name="l02595"></a><span class="lineno"> 2595</span>&#160;                                  &lt;&lt; <span class="stringliteral">&quot;] = &quot;</span> &lt;&lt; prevPosition</div>
<div class="line"><a name="l02596"></a><span class="lineno"> 2596</span>&#160;                                  &lt;&lt; <span class="stringliteral">&quot;, prevLogLikelihoodValues[&quot;</span> &lt;&lt; i</div>
<div class="line"><a name="l02597"></a><span class="lineno"> 2597</span>&#160;                                  &lt;&lt; <span class="stringliteral">&quot;] = &quot;</span> &lt;&lt; prevLogLikelihoodValues[i]</div>
<div class="line"><a name="l02598"></a><span class="lineno"> 2598</span>&#160;                                  &lt;&lt; <span class="stringliteral">&quot;, prevLogTargetValues[&quot;</span> &lt;&lt; i</div>
<div class="line"><a name="l02599"></a><span class="lineno"> 2599</span>&#160;                                  &lt;&lt; <span class="stringliteral">&quot;] = &quot;</span> &lt;&lt; prevLogTargetValues[i]</div>
<div class="line"><a name="l02600"></a><span class="lineno"> 2600</span>&#160;                                  &lt;&lt; std::endl;</div>
<div class="line"><a name="l02601"></a><span class="lineno"> 2601</span>&#160;        }</div>
<div class="line"><a name="l02602"></a><span class="lineno"> 2602</span>&#160;      }</div>
<div class="line"><a name="l02603"></a><span class="lineno"> 2603</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l02604"></a><span class="lineno"> 2604</span>&#160;<span class="preprocessor"></span></div>
<div class="line"><a name="l02605"></a><span class="lineno"> 2605</span>&#160;      <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> quantity1 = prevChain.<a class="code" href="class_q_u_e_s_o_1_1_scalar_sequence.html#a52829afc95e5c36e9db44f40854153b0">unifiedSequenceSize</a>();</div>
<div class="line"><a name="l02606"></a><span class="lineno"> 2606</span>&#160;      <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> quantity2 = currChain.unifiedSequenceSize();</div>
<div class="line"><a name="l02607"></a><span class="lineno"> 2607</span>&#160;      <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> quantity3 = prevLogLikelihoodValues.<a class="code" href="class_q_u_e_s_o_1_1_scalar_sequence.html#a52829afc95e5c36e9db44f40854153b0">unifiedSequenceSize</a>(<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a7bc4c72f65ba9166ed94a6e198b0915b">m_vectorSpace</a>.<a class="code" href="class_q_u_e_s_o_1_1_vector_space.html#a67b0c3620662116f5a346fdaa5faf38e">numOfProcsForStorage</a>() == 1);</div>
<div class="line"><a name="l02608"></a><span class="lineno"> 2608</span>&#160;      <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> quantity4 = currLogLikelihoodValues.<a class="code" href="class_q_u_e_s_o_1_1_scalar_sequence.html#a52829afc95e5c36e9db44f40854153b0">unifiedSequenceSize</a>(<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a7bc4c72f65ba9166ed94a6e198b0915b">m_vectorSpace</a>.<a class="code" href="class_q_u_e_s_o_1_1_vector_space.html#a67b0c3620662116f5a346fdaa5faf38e">numOfProcsForStorage</a>() == 1);</div>
<div class="line"><a name="l02609"></a><span class="lineno"> 2609</span>&#160;      <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> quantity5 = prevLogTargetValues.<a class="code" href="class_q_u_e_s_o_1_1_scalar_sequence.html#a52829afc95e5c36e9db44f40854153b0">unifiedSequenceSize</a>(<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a7bc4c72f65ba9166ed94a6e198b0915b">m_vectorSpace</a>.<a class="code" href="class_q_u_e_s_o_1_1_vector_space.html#a67b0c3620662116f5a346fdaa5faf38e">numOfProcsForStorage</a>() == 1);</div>
<div class="line"><a name="l02610"></a><span class="lineno"> 2610</span>&#160;      <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> quantity6 = currLogTargetValues.<a class="code" href="class_q_u_e_s_o_1_1_scalar_sequence.html#a52829afc95e5c36e9db44f40854153b0">unifiedSequenceSize</a>(<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a7bc4c72f65ba9166ed94a6e198b0915b">m_vectorSpace</a>.<a class="code" href="class_q_u_e_s_o_1_1_vector_space.html#a67b0c3620662116f5a346fdaa5faf38e">numOfProcsForStorage</a>() == 1);</div>
<div class="line"><a name="l02611"></a><span class="lineno"> 2611</span>&#160;      <span class="keywordflow">if</span> ((<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#a8a0064746ae8dddfece4229b9ad374d6">subDisplayFile</a>()) &amp;&amp; (<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#a1fe5f244fc0316a0ab3e37463f108b96">displayVerbosity</a>() &gt;= 0)) {</div>
<div class="line"><a name="l02612"></a><span class="lineno"> 2612</span>&#160;        *<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#a8a0064746ae8dddfece4229b9ad374d6">subDisplayFile</a>() &lt;&lt; <span class="stringliteral">&quot;In MLSampling&lt;P_V,P_M&gt;::generateSequence()&quot;</span></div>
<div class="line"><a name="l02613"></a><span class="lineno"> 2613</span>&#160;                                &lt;&lt; <span class="stringliteral">&quot;, level &quot;</span> &lt;&lt; <a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#af9416874c856e50f3b35270e801f17e4">m_currLevel</a>+<a class="code" href="_m_l_sampling_level_options_8h.html#a68d15eaf394d210effcf584b938206d3">LEVEL_REF_ID</a></div>
<div class="line"><a name="l02614"></a><span class="lineno"> 2614</span>&#160;                                &lt;&lt; <span class="stringliteral">&quot;, step &quot;</span>  &lt;&lt; <a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a1b1f8ccb4823bdfa26ec652f0807c63e">m_currStep</a></div>
<div class="line"><a name="l02615"></a><span class="lineno"> 2615</span>&#160;                                &lt;&lt; <span class="stringliteral">&quot;: prevChain.unifiedSequenceSize() = &quot;</span> &lt;&lt; quantity1</div>
<div class="line"><a name="l02616"></a><span class="lineno"> 2616</span>&#160;                                &lt;&lt; <span class="stringliteral">&quot;, currChain.unifiedSequenceSize() = &quot;</span> &lt;&lt; quantity2</div>
<div class="line"><a name="l02617"></a><span class="lineno"> 2617</span>&#160;                                &lt;&lt; <span class="stringliteral">&quot;, prevLogLikelihoodValues.unifiedSequenceSize() = &quot;</span> &lt;&lt; quantity3</div>
<div class="line"><a name="l02618"></a><span class="lineno"> 2618</span>&#160;                                &lt;&lt; <span class="stringliteral">&quot;, currLogLikelihoodValues.unifiedSequenceSize() = &quot;</span> &lt;&lt; quantity4</div>
<div class="line"><a name="l02619"></a><span class="lineno"> 2619</span>&#160;                                &lt;&lt; <span class="stringliteral">&quot;, prevLogTargetValues.unifiedSequenceSize() = &quot;</span> &lt;&lt; quantity5</div>
<div class="line"><a name="l02620"></a><span class="lineno"> 2620</span>&#160;                                &lt;&lt; <span class="stringliteral">&quot;, currLogTargetValues.unifiedSequenceSize() = &quot;</span> &lt;&lt; quantity6</div>
<div class="line"><a name="l02621"></a><span class="lineno"> 2621</span>&#160;                                &lt;&lt; std::endl;</div>
<div class="line"><a name="l02622"></a><span class="lineno"> 2622</span>&#160;      }</div>
<div class="line"><a name="l02623"></a><span class="lineno"> 2623</span>&#160;</div>
<div class="line"><a name="l02624"></a><span class="lineno"> 2624</span>&#160;      <a class="code" href="_defines_8h.html#a56d63d18d0a6d45757de47fcc06f574d">UQ_FATAL_TEST_MACRO</a>((prevChain.subSequenceSize() != prevLogLikelihoodValues.<a class="code" href="class_q_u_e_s_o_1_1_scalar_sequence.html#a0288ea295eedc216a1617b3286f6f3a0">subSequenceSize</a>()),</div>
<div class="line"><a name="l02625"></a><span class="lineno"> 2625</span>&#160;                          <a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#a78b57112bbd0e6dd0e8afec00b40ffa7">worldRank</a>(),</div>
<div class="line"><a name="l02626"></a><span class="lineno"> 2626</span>&#160;                          <span class="stringliteral">&quot;MLSampling&lt;P_V,P_M&gt;::generateSequence()&quot;</span>,</div>
<div class="line"><a name="l02627"></a><span class="lineno"> 2627</span>&#160;                          <span class="stringliteral">&quot;different sizes between previous chain and previous sequence of likelihood values&quot;</span>);</div>
<div class="line"><a name="l02628"></a><span class="lineno"> 2628</span>&#160;</div>
<div class="line"><a name="l02629"></a><span class="lineno"> 2629</span>&#160;      <a class="code" href="_defines_8h.html#a56d63d18d0a6d45757de47fcc06f574d">UQ_FATAL_TEST_MACRO</a>((prevChain.subSequenceSize() != prevLogTargetValues.<a class="code" href="class_q_u_e_s_o_1_1_scalar_sequence.html#a0288ea295eedc216a1617b3286f6f3a0">subSequenceSize</a>()),</div>
<div class="line"><a name="l02630"></a><span class="lineno"> 2630</span>&#160;                          <a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#a78b57112bbd0e6dd0e8afec00b40ffa7">worldRank</a>(),</div>
<div class="line"><a name="l02631"></a><span class="lineno"> 2631</span>&#160;                          <span class="stringliteral">&quot;MLSampling&lt;P_V,P_M&gt;::generateSequence()&quot;</span>,</div>
<div class="line"><a name="l02632"></a><span class="lineno"> 2632</span>&#160;                          <span class="stringliteral">&quot;different sizes between previous chain and previous sequence of target values&quot;</span>);</div>
<div class="line"><a name="l02633"></a><span class="lineno"> 2633</span>&#160;</div>
<div class="line"><a name="l02634"></a><span class="lineno"> 2634</span>&#160;      <span class="comment">// Set &#39;indexOfFirstWeight&#39; and &#39;indexOfLastWeight&#39; // KAUST</span></div>
<div class="line"><a name="l02635"></a><span class="lineno"> 2635</span>&#160;      indexOfFirstWeight = 0;</div>
<div class="line"><a name="l02636"></a><span class="lineno"> 2636</span>&#160;      indexOfLastWeight  = indexOfFirstWeight + prevChain.subSequenceSize()-1;</div>
<div class="line"><a name="l02637"></a><span class="lineno"> 2637</span>&#160;      {</div>
<div class="line"><a name="l02638"></a><span class="lineno"> 2638</span>&#160;        <span class="comment">//std::cout &lt;&lt; &quot;m_env.inter0Comm().NumProc() = &quot; &lt;&lt; m_env.inter0Comm().NumProc() &lt;&lt; std::endl;</span></div>
<div class="line"><a name="l02639"></a><span class="lineno"> 2639</span>&#160;        <span class="keywordtype">int</span> r = <a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#ae106b5bb8a80b655b88b3a26b1e7c185">inter0Rank</a>();</div>
<div class="line"><a name="l02640"></a><span class="lineno"> 2640</span>&#160;        <span class="comment">//std::cout &lt;&lt; &quot;r = &quot; &lt;&lt; r &lt;&lt; std::endl;</span></div>
<div class="line"><a name="l02641"></a><span class="lineno"> 2641</span>&#160;        <a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#a689e4d140c74d495d97eb498714a4b82">inter0Comm</a>().<a class="code" href="class_q_u_e_s_o_1_1_mpi_comm.html#a4059971c30e023b272fccaa6aa00c426">Barrier</a>();</div>
<div class="line"><a name="l02642"></a><span class="lineno"> 2642</span>&#160;        <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> auxUint = 0;</div>
<div class="line"><a name="l02643"></a><span class="lineno"> 2643</span>&#160;        <span class="keywordflow">if</span> (r &gt; 0) {</div>
<div class="line"><a name="l02644"></a><span class="lineno"> 2644</span>&#160;          <a class="code" href="namespace_q_u_e_s_o.html#af3c313103c6396188748a1d534577ff7">RawType_MPI_Status</a> status;</div>
<div class="line"><a name="l02645"></a><span class="lineno"> 2645</span>&#160;    <span class="comment">//std::cout &lt;&lt; &quot;Rank &quot; &lt;&lt; r &lt;&lt; &quot; is entering MPI_Recv()&quot; &lt;&lt; std::endl;</span></div>
<div class="line"><a name="l02646"></a><span class="lineno"> 2646</span>&#160;          <a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#a689e4d140c74d495d97eb498714a4b82">inter0Comm</a>().<a class="code" href="class_q_u_e_s_o_1_1_mpi_comm.html#a12d7a87a4407e442c35a17d3caaf46c1">Recv</a>((<span class="keywordtype">void</span>*) &amp;auxUint, 1, <a class="code" href="_mpi_comm_8h.html#a06cbfbc33436f6e0dc8a48ff3c49bdfc">RawValue_MPI_UNSIGNED</a>, r-1, r-1, &amp;status,</div>
<div class="line"><a name="l02647"></a><span class="lineno"> 2647</span>&#160;                                  <span class="stringliteral">&quot;MLSampling&lt;P_V,P_M&gt;::generateSequence()&quot;</span>,</div>
<div class="line"><a name="l02648"></a><span class="lineno"> 2648</span>&#160;                                  <span class="stringliteral">&quot;failed MPI.Recv()&quot;</span>);</div>
<div class="line"><a name="l02649"></a><span class="lineno"> 2649</span>&#160;    <span class="comment">//std::cout &lt;&lt; &quot;Rank &quot; &lt;&lt; r &lt;&lt; &quot; received auxUint = &quot; &lt;&lt; auxUint &lt;&lt; std::endl;</span></div>
<div class="line"><a name="l02650"></a><span class="lineno"> 2650</span>&#160;          indexOfFirstWeight = auxUint;</div>
<div class="line"><a name="l02651"></a><span class="lineno"> 2651</span>&#160;          indexOfLastWeight = indexOfFirstWeight + prevChain.subSequenceSize()-1;</div>
<div class="line"><a name="l02652"></a><span class="lineno"> 2652</span>&#160;        }</div>
<div class="line"><a name="l02653"></a><span class="lineno"> 2653</span>&#160;        <span class="keywordflow">if</span> (r &lt; (<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#a689e4d140c74d495d97eb498714a4b82">inter0Comm</a>().<a class="code" href="class_q_u_e_s_o_1_1_mpi_comm.html#aa780721ae0fdeabc5a15e04cb0cad964">NumProc</a>()-1)) {</div>
<div class="line"><a name="l02654"></a><span class="lineno"> 2654</span>&#160;          auxUint = indexOfLastWeight + 1;</div>
<div class="line"><a name="l02655"></a><span class="lineno"> 2655</span>&#160;    <span class="comment">//std::cout &lt;&lt; &quot;Rank &quot; &lt;&lt; r &lt;&lt; &quot; is sending auxUint = &quot; &lt;&lt; auxUint &lt;&lt; std::endl;</span></div>
<div class="line"><a name="l02656"></a><span class="lineno"> 2656</span>&#160;          <a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#a689e4d140c74d495d97eb498714a4b82">inter0Comm</a>().<a class="code" href="class_q_u_e_s_o_1_1_mpi_comm.html#a1ecdbeac992a2ab1ff12e45e0c1b53b4">Send</a>((<span class="keywordtype">void</span>*) &amp;auxUint, 1, <a class="code" href="_mpi_comm_8h.html#a06cbfbc33436f6e0dc8a48ff3c49bdfc">RawValue_MPI_UNSIGNED</a>, r+1, r,</div>
<div class="line"><a name="l02657"></a><span class="lineno"> 2657</span>&#160;                                  <span class="stringliteral">&quot;MLSampling&lt;P_V,P_M&gt;::generateSequence()&quot;</span>,</div>
<div class="line"><a name="l02658"></a><span class="lineno"> 2658</span>&#160;                                  <span class="stringliteral">&quot;failed MPI.Send()&quot;</span>);</div>
<div class="line"><a name="l02659"></a><span class="lineno"> 2659</span>&#160;    <span class="comment">//std::cout &lt;&lt; &quot;Rank &quot; &lt;&lt; r &lt;&lt; &quot; sent auxUint = &quot; &lt;&lt; auxUint &lt;&lt; std::endl;</span></div>
<div class="line"><a name="l02660"></a><span class="lineno"> 2660</span>&#160;        }</div>
<div class="line"><a name="l02661"></a><span class="lineno"> 2661</span>&#160;        <a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#a689e4d140c74d495d97eb498714a4b82">inter0Comm</a>().<a class="code" href="class_q_u_e_s_o_1_1_mpi_comm.html#a4059971c30e023b272fccaa6aa00c426">Barrier</a>();</div>
<div class="line"><a name="l02662"></a><span class="lineno"> 2662</span>&#160;      }</div>
<div class="line"><a name="l02663"></a><span class="lineno"> 2663</span>&#160;</div>
<div class="line"><a name="l02664"></a><span class="lineno"> 2664</span>&#160;  <span class="keywordtype">double</span> stepRunTime = <a class="code" href="namespace_q_u_e_s_o.html#a424bc33f2e6e287fd468408d14b772ee">MiscGetEllapsedSeconds</a>(&amp;timevalStep);</div>
<div class="line"><a name="l02665"></a><span class="lineno"> 2665</span>&#160;  <span class="keywordflow">if</span> ((<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#a8a0064746ae8dddfece4229b9ad374d6">subDisplayFile</a>()) &amp;&amp; (<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#a1fe5f244fc0316a0ab3e37463f108b96">displayVerbosity</a>() &gt;= 0)) {</div>
<div class="line"><a name="l02666"></a><span class="lineno"> 2666</span>&#160;    *<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#a8a0064746ae8dddfece4229b9ad374d6">subDisplayFile</a>() &lt;&lt; <span class="stringliteral">&quot;Leaving MLSampling&lt;P_V,P_M&gt;::generateSequence_Step()&quot;</span></div>
<div class="line"><a name="l02667"></a><span class="lineno"> 2667</span>&#160;                            &lt;&lt; <span class="stringliteral">&quot;, level &quot;</span> &lt;&lt; <a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#af9416874c856e50f3b35270e801f17e4">m_currLevel</a>+<a class="code" href="_m_l_sampling_level_options_8h.html#a68d15eaf394d210effcf584b938206d3">LEVEL_REF_ID</a></div>
<div class="line"><a name="l02668"></a><span class="lineno"> 2668</span>&#160;                            &lt;&lt; <span class="stringliteral">&quot;, step &quot;</span>  &lt;&lt; <a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a1b1f8ccb4823bdfa26ec652f0807c63e">m_currStep</a></div>
<div class="line"><a name="l02669"></a><span class="lineno"> 2669</span>&#160;                            &lt;&lt; <span class="stringliteral">&quot;, after &quot;</span> &lt;&lt; stepRunTime &lt;&lt; <span class="stringliteral">&quot; seconds&quot;</span></div>
<div class="line"><a name="l02670"></a><span class="lineno"> 2670</span>&#160;                            &lt;&lt; std::endl;</div>
<div class="line"><a name="l02671"></a><span class="lineno"> 2671</span>&#160;  }</div>
<div class="line"><a name="l02672"></a><span class="lineno"> 2672</span>&#160;</div>
<div class="line"><a name="l02673"></a><span class="lineno"> 2673</span>&#160;  <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l02674"></a><span class="lineno"> 2674</span>&#160;}</div>
<div class="ttc" id="class_q_u_e_s_o_1_1_m_l_sampling_html_a13f1ca4fe9f94822fe572a743eaced1d"><div class="ttname"><a href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">QUESO::MLSampling::m_env</a></div><div class="ttdeci">const BaseEnvironment &amp; m_env</div><div class="ttdoc">Queso enviroment. </div><div class="ttdef"><b>Definition:</b> <a href="_m_l_sampling_8h_source.html#l00442">MLSampling.h:442</a></div></div>
<div class="ttc" id="class_q_u_e_s_o_1_1_mpi_comm_html_aa780721ae0fdeabc5a15e04cb0cad964"><div class="ttname"><a href="class_q_u_e_s_o_1_1_mpi_comm.html#aa780721ae0fdeabc5a15e04cb0cad964">QUESO::MpiComm::NumProc</a></div><div class="ttdeci">int NumProc() const </div><div class="ttdoc">Returns total number of processes. </div><div class="ttdef"><b>Definition:</b> <a href="_mpi_comm_8_c_source.html#l00121">MpiComm.C:121</a></div></div>
<div class="ttc" id="class_q_u_e_s_o_1_1_base_environment_html_a78b57112bbd0e6dd0e8afec00b40ffa7"><div class="ttname"><a href="class_q_u_e_s_o_1_1_base_environment.html#a78b57112bbd0e6dd0e8afec00b40ffa7">QUESO::BaseEnvironment::worldRank</a></div><div class="ttdeci">int worldRank() const </div><div class="ttdoc">Returns the process world rank. </div><div class="ttdef"><b>Definition:</b> <a href="_environment_8_c_source.html#l00235">Environment.C:235</a></div></div>
<div class="ttc" id="class_q_u_e_s_o_1_1_mpi_comm_html_a4059971c30e023b272fccaa6aa00c426"><div class="ttname"><a href="class_q_u_e_s_o_1_1_mpi_comm.html#a4059971c30e023b272fccaa6aa00c426">QUESO::MpiComm::Barrier</a></div><div class="ttdeci">void Barrier() const </div><div class="ttdoc">Pause every process in *this communicator until all the processes reach this point. </div><div class="ttdef"><b>Definition:</b> <a href="_mpi_comm_8_c_source.html#l00143">MpiComm.C:143</a></div></div>
<div class="ttc" id="namespace_q_u_e_s_o_html_a8e909502900aecf24cedba022ea84471"><div class="ttname"><a href="namespace_q_u_e_s_o.html#a8e909502900aecf24cedba022ea84471">QUESO::UQ_OK_RC</a></div><div class="ttdeci">const int UQ_OK_RC</div><div class="ttdef"><b>Definition:</b> <a href="_defines_8h_source.html#l00075">Defines.h:75</a></div></div>
<div class="ttc" id="class_q_u_e_s_o_1_1_scalar_sequence_html_a198b72423333bc5aa1722b830b64a263"><div class="ttname"><a href="class_q_u_e_s_o_1_1_scalar_sequence.html#a198b72423333bc5aa1722b830b64a263">QUESO::ScalarSequence::setName</a></div><div class="ttdeci">void setName(const std::string &amp;newName)</div><div class="ttdoc">Sets a new name to the sequence of scalars. </div><div class="ttdef"><b>Definition:</b> <a href="_scalar_sequence_8_c_source.html#l00120">ScalarSequence.C:120</a></div></div>
<div class="ttc" id="class_q_u_e_s_o_1_1_mpi_comm_html_a1ecdbeac992a2ab1ff12e45e0c1b53b4"><div class="ttname"><a href="class_q_u_e_s_o_1_1_mpi_comm.html#a1ecdbeac992a2ab1ff12e45e0c1b53b4">QUESO::MpiComm::Send</a></div><div class="ttdeci">void Send(void *buf, int count, RawType_MPI_Datatype datatype, int dest, int tag, const char *whereMsg, const char *whatMsg) const </div><div class="ttdoc">Possibly blocking send of data from this process to another process. </div><div class="ttdef"><b>Definition:</b> <a href="_mpi_comm_8_c_source.html#l00221">MpiComm.C:221</a></div></div>
<div class="ttc" id="namespace_q_u_e_s_o_html_af3c313103c6396188748a1d534577ff7"><div class="ttname"><a href="namespace_q_u_e_s_o.html#af3c313103c6396188748a1d534577ff7">QUESO::RawType_MPI_Status</a></div><div class="ttdeci">MPI_Status RawType_MPI_Status</div><div class="ttdef"><b>Definition:</b> <a href="_mpi_comm_8h_source.html#l00042">MpiComm.h:42</a></div></div>
<div class="ttc" id="class_q_u_e_s_o_1_1_vector_space_html_a67b0c3620662116f5a346fdaa5faf38e"><div class="ttname"><a href="class_q_u_e_s_o_1_1_vector_space.html#a67b0c3620662116f5a346fdaa5faf38e">QUESO::VectorSpace::numOfProcsForStorage</a></div><div class="ttdeci">unsigned int numOfProcsForStorage() const </div><div class="ttdoc">Returns total number of processes. </div><div class="ttdef"><b>Definition:</b> <a href="_vector_space_8_c_source.html#l00193">VectorSpace.C:193</a></div></div>
<div class="ttc" id="class_q_u_e_s_o_1_1_m_l_sampling_html_af9416874c856e50f3b35270e801f17e4"><div class="ttname"><a href="class_q_u_e_s_o_1_1_m_l_sampling.html#af9416874c856e50f3b35270e801f17e4">QUESO::MLSampling::m_currLevel</a></div><div class="ttdeci">unsigned int m_currLevel</div><div class="ttdoc">Current level. </div><div class="ttdef"><b>Definition:</b> <a href="_m_l_sampling_8h_source.html#l00464">MLSampling.h:464</a></div></div>
<div class="ttc" id="_m_l_sampling_level_options_8h_html_a68d15eaf394d210effcf584b938206d3"><div class="ttname"><a href="_m_l_sampling_level_options_8h.html#a68d15eaf394d210effcf584b938206d3">LEVEL_REF_ID</a></div><div class="ttdeci">#define LEVEL_REF_ID</div><div class="ttdef"><b>Definition:</b> <a href="_m_l_sampling_level_options_8h_source.html#l00028">MLSamplingLevelOptions.h:28</a></div></div>
<div class="ttc" id="class_q_u_e_s_o_1_1_scalar_sequence_html_a0288ea295eedc216a1617b3286f6f3a0"><div class="ttname"><a href="class_q_u_e_s_o_1_1_scalar_sequence.html#a0288ea295eedc216a1617b3286f6f3a0">QUESO::ScalarSequence::subSequenceSize</a></div><div class="ttdeci">unsigned int subSequenceSize() const </div><div class="ttdoc">Size of the sub-sequence of scalars. </div><div class="ttdef"><b>Definition:</b> <a href="_scalar_sequence_8_c_source.html#l00141">ScalarSequence.C:141</a></div></div>
<div class="ttc" id="class_q_u_e_s_o_1_1_vector_space_html_a92e963bb5cab3eecd290dfe4b8f03b04"><div class="ttname"><a href="class_q_u_e_s_o_1_1_vector_space.html#a92e963bb5cab3eecd290dfe4b8f03b04">QUESO::VectorSpace::zeroVector</a></div><div class="ttdeci">const V &amp; zeroVector() const </div><div class="ttdoc">Returns a vector filled with zeros. </div><div class="ttdef"><b>Definition:</b> <a href="_vector_space_8_c_source.html#l00218">VectorSpace.C:218</a></div></div>
<div class="ttc" id="class_q_u_e_s_o_1_1_scalar_sequence_html_a52829afc95e5c36e9db44f40854153b0"><div class="ttname"><a href="class_q_u_e_s_o_1_1_scalar_sequence.html#a52829afc95e5c36e9db44f40854153b0">QUESO::ScalarSequence::unifiedSequenceSize</a></div><div class="ttdeci">unsigned int unifiedSequenceSize(bool useOnlyInter0Comm) const </div><div class="ttdoc">Size of the unified sequence of scalars. </div><div class="ttdef"><b>Definition:</b> <a href="_scalar_sequence_8_c_source.html#l00148">ScalarSequence.C:148</a></div></div>
<div class="ttc" id="class_q_u_e_s_o_1_1_m_l_sampling_html_a7bc4c72f65ba9166ed94a6e198b0915b"><div class="ttname"><a href="class_q_u_e_s_o_1_1_m_l_sampling.html#a7bc4c72f65ba9166ed94a6e198b0915b">QUESO::MLSampling::m_vectorSpace</a></div><div class="ttdeci">const VectorSpace&lt; P_V, P_M &gt; &amp; m_vectorSpace</div><div class="ttdoc">Vector space. </div><div class="ttdef"><b>Definition:</b> <a href="_m_l_sampling_8h_source.html#l00451">MLSampling.h:451</a></div></div>
<div class="ttc" id="namespace_q_u_e_s_o_html_a424bc33f2e6e287fd468408d14b772ee"><div class="ttname"><a href="namespace_q_u_e_s_o.html#a424bc33f2e6e287fd468408d14b772ee">QUESO::MiscGetEllapsedSeconds</a></div><div class="ttdeci">double MiscGetEllapsedSeconds(struct timeval *timeval0)</div><div class="ttdef"><b>Definition:</b> <a href="_miscellaneous_8_c_source.html#l00287">Miscellaneous.C:287</a></div></div>
<div class="ttc" id="class_q_u_e_s_o_1_1_base_environment_html_ae106b5bb8a80b655b88b3a26b1e7c185"><div class="ttname"><a href="class_q_u_e_s_o_1_1_base_environment.html#ae106b5bb8a80b655b88b3a26b1e7c185">QUESO::BaseEnvironment::inter0Rank</a></div><div class="ttdeci">int inter0Rank() const </div><div class="ttdoc">Returns the process inter0 rank. </div><div class="ttdef"><b>Definition:</b> <a href="_environment_8_c_source.html#l00289">Environment.C:289</a></div></div>
<div class="ttc" id="_defines_8h_html_a56d63d18d0a6d45757de47fcc06f574d"><div class="ttname"><a href="_defines_8h.html#a56d63d18d0a6d45757de47fcc06f574d">UQ_FATAL_TEST_MACRO</a></div><div class="ttdeci">#define UQ_FATAL_TEST_MACRO(test, givenRank, where, what)</div><div class="ttdef"><b>Definition:</b> <a href="_defines_8h_source.html#l00222">Defines.h:222</a></div></div>
<div class="ttc" id="_mpi_comm_8h_html_a06cbfbc33436f6e0dc8a48ff3c49bdfc"><div class="ttname"><a href="_mpi_comm_8h.html#a06cbfbc33436f6e0dc8a48ff3c49bdfc">RawValue_MPI_UNSIGNED</a></div><div class="ttdeci">#define RawValue_MPI_UNSIGNED</div><div class="ttdef"><b>Definition:</b> <a href="_mpi_comm_8h_source.html#l00049">MpiComm.h:49</a></div></div>
<div class="ttc" id="class_q_u_e_s_o_1_1_mpi_comm_html_a12d7a87a4407e442c35a17d3caaf46c1"><div class="ttname"><a href="class_q_u_e_s_o_1_1_mpi_comm.html#a12d7a87a4407e442c35a17d3caaf46c1">QUESO::MpiComm::Recv</a></div><div class="ttdeci">void Recv(void *buf, int count, RawType_MPI_Datatype datatype, int source, int tag, RawType_MPI_Status *status, const char *whereMsg, const char *whatMsg) const </div><div class="ttdoc">Blocking receive of data from this process to another process. </div><div class="ttdef"><b>Definition:</b> <a href="_mpi_comm_8_c_source.html#l00208">MpiComm.C:208</a></div></div>
<div class="ttc" id="class_q_u_e_s_o_1_1_m_l_sampling_html_a1b1f8ccb4823bdfa26ec652f0807c63e"><div class="ttname"><a href="class_q_u_e_s_o_1_1_m_l_sampling.html#a1b1f8ccb4823bdfa26ec652f0807c63e">QUESO::MLSampling::m_currStep</a></div><div class="ttdeci">unsigned int m_currStep</div><div class="ttdoc">Curret step. </div><div class="ttdef"><b>Definition:</b> <a href="_m_l_sampling_8h_source.html#l00467">MLSampling.h:467</a></div></div>
<div class="ttc" id="class_q_u_e_s_o_1_1_base_environment_html_a1fe5f244fc0316a0ab3e37463f108b96"><div class="ttname"><a href="class_q_u_e_s_o_1_1_base_environment.html#a1fe5f244fc0316a0ab3e37463f108b96">QUESO::BaseEnvironment::displayVerbosity</a></div><div class="ttdeci">unsigned int displayVerbosity() const </div><div class="ttdef"><b>Definition:</b> <a href="_environment_8_c_source.html#l00436">Environment.C:436</a></div></div>
<div class="ttc" id="class_q_u_e_s_o_1_1_base_environment_html_a8a0064746ae8dddfece4229b9ad374d6"><div class="ttname"><a href="class_q_u_e_s_o_1_1_base_environment.html#a8a0064746ae8dddfece4229b9ad374d6">QUESO::BaseEnvironment::subDisplayFile</a></div><div class="ttdeci">std::ofstream * subDisplayFile() const </div><div class="ttdoc">Access function for m_subDisplayFile (displays file on stream). </div><div class="ttdef"><b>Definition:</b> <a href="_environment_8_c_source.html#l00305">Environment.C:305</a></div></div>
<div class="ttc" id="class_q_u_e_s_o_1_1_base_environment_html_a689e4d140c74d495d97eb498714a4b82"><div class="ttname"><a href="class_q_u_e_s_o_1_1_base_environment.html#a689e4d140c74d495d97eb498714a4b82">QUESO::BaseEnvironment::inter0Comm</a></div><div class="ttdeci">const MpiComm &amp; inter0Comm() const </div><div class="ttdoc">Access function for MpiComm inter0-communicator. </div><div class="ttdef"><b>Definition:</b> <a href="_environment_8_c_source.html#l00295">Environment.C:295</a></div></div>
<div class="ttc" id="class_q_u_e_s_o_1_1_scalar_sequence_html_aa5449ca2f03f5e6025d35804bee19ee0"><div class="ttname"><a href="class_q_u_e_s_o_1_1_scalar_sequence.html#aa5449ca2f03f5e6025d35804bee19ee0">QUESO::ScalarSequence::clear</a></div><div class="ttdeci">void clear()</div><div class="ttdoc">Clears the sequence of scalars. </div><div class="ttdef"><b>Definition:</b> <a href="_scalar_sequence_8_c_source.html#l00128">ScalarSequence.C:128</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ae53e6bc0ec5d1f3d3ac9df268086cd75"></a>
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;class P_V , class P_M &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="class_q_u_e_s_o_1_1_m_l_sampling.html">QUESO::MLSampling</a>&lt; P_V, P_M &gt;::generateSequence_Step03_inter0 </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="class_q_u_e_s_o_1_1_m_l_sampling_level_options.html">MLSamplingLevelOptions</a> *&#160;</td>
          <td class="paramname"><em>currOptions</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="class_q_u_e_s_o_1_1_scalar_sequence.html">ScalarSequence</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>prevLogLikelihoodValues</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>prevExponent</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>failedExponent</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double &amp;&#160;</td>
          <td class="paramname"><em>currExponent</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_q_u_e_s_o_1_1_scalar_sequence.html">ScalarSequence</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>weightSequence</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Computes <code>currExponent</code> and sequence of weights for current level and update 'm_logEvidenceFactors' (Step 03 from ML algorithm). </p>
<p>This method is responsible for the Step 03 in the ML algorithm implemented/described in the method <a class="el" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a8d7296b30623c73ada38971cae27994a" title="Method to generate the chain. ">MLSampling&lt;P_V,P_M&gt;::generateSequence</a>.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">currOptions,prevLogLikelihoodValues,prevExponent,failedExponent</td><td></td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">currExponent,weightSequence</td><td></td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="_m_l_sampling_8_c_source.html#l02678">2678</a> of file <a class="el" href="_m_l_sampling_8_c_source.html">MLSampling.C</a>.</p>

<p>References <a class="el" href="_m_l_sampling_level_options_8h_source.html#l00028">LEVEL_REF_ID</a>, <a class="el" href="_m_l_sampling_level_options_8h_source.html#l00175">QUESO::MLSamplingLevelOptions::m_maxEffectiveSizeRatio</a>, <a class="el" href="_m_l_sampling_level_options_8h_source.html#l00172">QUESO::MLSamplingLevelOptions::m_minEffectiveSizeRatio</a>, <a class="el" href="_miscellaneous_8_c_source.html#l00484">QUESO::MiscCheckForSameValueInAllNodes()</a>, <a class="el" href="_miscellaneous_8_c_source.html#l00287">QUESO::MiscGetEllapsedSeconds()</a>, <a class="el" href="_mpi_comm_8h_source.html#l00048">RawValue_MPI_DOUBLE</a>, <a class="el" href="_mpi_comm_8h_source.html#l00052">RawValue_MPI_SUM</a>, <a class="el" href="_scalar_sequence_8_c_source.html#l00141">QUESO::ScalarSequence&lt; T &gt;::subSequenceSize()</a>, <a class="el" href="_scalar_sequence_8_c_source.html#l00403">QUESO::ScalarSequence&lt; T &gt;::unifiedMaxPlain()</a>, <a class="el" href="_scalar_sequence_8_c_source.html#l00148">QUESO::ScalarSequence&lt; T &gt;::unifiedSequenceSize()</a>, <a class="el" href="_defines_8h_source.html#l00222">UQ_FATAL_TEST_MACRO</a>, and <a class="el" href="_defines_8h_source.html#l00075">QUESO::UQ_OK_RC</a>.</p>
<div class="fragment"><div class="line"><a name="l02685"></a><span class="lineno"> 2685</span>&#160;{</div>
<div class="line"><a name="l02686"></a><span class="lineno"> 2686</span>&#160;  <span class="keywordtype">int</span> iRC = <a class="code" href="namespace_q_u_e_s_o.html#a8e909502900aecf24cedba022ea84471">UQ_OK_RC</a>;</div>
<div class="line"><a name="l02687"></a><span class="lineno"> 2687</span>&#160;  <span class="keyword">struct </span>timeval timevalStep;</div>
<div class="line"><a name="l02688"></a><span class="lineno"> 2688</span>&#160;  iRC = gettimeofday(&amp;timevalStep, NULL);</div>
<div class="line"><a name="l02689"></a><span class="lineno"> 2689</span>&#160;  <span class="keywordflow">if</span> (iRC) {}; <span class="comment">// just to remove compiler warning</span></div>
<div class="line"><a name="l02690"></a><span class="lineno"> 2690</span>&#160;</div>
<div class="line"><a name="l02691"></a><span class="lineno"> 2691</span>&#160;      <span class="keywordflow">if</span> ((<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#a8a0064746ae8dddfece4229b9ad374d6">subDisplayFile</a>()) &amp;&amp; (<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#a1fe5f244fc0316a0ab3e37463f108b96">displayVerbosity</a>() &gt;= 0)) {</div>
<div class="line"><a name="l02692"></a><span class="lineno"> 2692</span>&#160;        *<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#a8a0064746ae8dddfece4229b9ad374d6">subDisplayFile</a>() &lt;&lt; <span class="stringliteral">&quot;In MLSampling&lt;P_V,P_M&gt;::generateSequence()&quot;</span></div>
<div class="line"><a name="l02693"></a><span class="lineno"> 2693</span>&#160;                                &lt;&lt; <span class="stringliteral">&quot;, level &quot;</span> &lt;&lt; <a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#af9416874c856e50f3b35270e801f17e4">m_currLevel</a>+<a class="code" href="_m_l_sampling_level_options_8h.html#a68d15eaf394d210effcf584b938206d3">LEVEL_REF_ID</a></div>
<div class="line"><a name="l02694"></a><span class="lineno"> 2694</span>&#160;                                &lt;&lt; <span class="stringliteral">&quot;, step &quot;</span>  &lt;&lt; <a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a1b1f8ccb4823bdfa26ec652f0807c63e">m_currStep</a></div>
<div class="line"><a name="l02695"></a><span class="lineno"> 2695</span>&#160;                                &lt;&lt; <span class="stringliteral">&quot;, failedExponent = &quot;</span> &lt;&lt; failedExponent <span class="comment">// gpmsa1</span></div>
<div class="line"><a name="l02696"></a><span class="lineno"> 2696</span>&#160;                                &lt;&lt; <span class="stringliteral">&quot;: beginning step 3 of 11&quot;</span></div>
<div class="line"><a name="l02697"></a><span class="lineno"> 2697</span>&#160;                                &lt;&lt; std::endl;</div>
<div class="line"><a name="l02698"></a><span class="lineno"> 2698</span>&#160;      }</div>
<div class="line"><a name="l02699"></a><span class="lineno"> 2699</span>&#160;</div>
<div class="line"><a name="l02700"></a><span class="lineno"> 2700</span>&#160;      std::vector&lt;double&gt; exponents(2,0.);</div>
<div class="line"><a name="l02701"></a><span class="lineno"> 2701</span>&#160;      exponents[0] = prevExponent;</div>
<div class="line"><a name="l02702"></a><span class="lineno"> 2702</span>&#160;      exponents[1] = 1.;</div>
<div class="line"><a name="l02703"></a><span class="lineno"> 2703</span>&#160;</div>
<div class="line"><a name="l02704"></a><span class="lineno"> 2704</span>&#160;      <span class="keywordtype">double</span> nowExponent = 1.; <span class="comment">// Try &#39;1.&#39; right away</span></div>
<div class="line"><a name="l02705"></a><span class="lineno"> 2705</span>&#160;      <span class="keywordtype">double</span> nowEffectiveSizeRatio = 0.; <span class="comment">// To be computed</span></div>
<div class="line"><a name="l02706"></a><span class="lineno"> 2706</span>&#160;</div>
<div class="line"><a name="l02707"></a><span class="lineno"> 2707</span>&#160;      <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> nowAttempt = 0;</div>
<div class="line"><a name="l02708"></a><span class="lineno"> 2708</span>&#160;      <span class="keywordtype">bool</span> testResult = <span class="keyword">false</span>;</div>
<div class="line"><a name="l02709"></a><span class="lineno"> 2709</span>&#160;      <span class="keywordtype">double</span> meanEffectiveSizeRatio = .5*(currOptions-&gt;m_minEffectiveSizeRatio + currOptions-&gt;m_maxEffectiveSizeRatio);</div>
<div class="line"><a name="l02710"></a><span class="lineno"> 2710</span>&#160;      ScalarSequence&lt;double&gt; omegaLnDiffSequence(<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>,prevLogLikelihoodValues.<a class="code" href="class_q_u_e_s_o_1_1_scalar_sequence.html#a0288ea295eedc216a1617b3286f6f3a0">subSequenceSize</a>(),<span class="stringliteral">&quot;&quot;</span>);</div>
<div class="line"><a name="l02711"></a><span class="lineno"> 2711</span>&#160;</div>
<div class="line"><a name="l02712"></a><span class="lineno"> 2712</span>&#160;      <span class="keywordtype">double</span> nowUnifiedEvidenceLnFactor = 0.;</div>
<div class="line"><a name="l02713"></a><span class="lineno"> 2713</span>&#160;      <span class="keywordflow">do</span> {</div>
<div class="line"><a name="l02714"></a><span class="lineno"> 2714</span>&#160;        <span class="keywordflow">if</span> ((<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#a8a0064746ae8dddfece4229b9ad374d6">subDisplayFile</a>()) &amp;&amp; (<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#a1fe5f244fc0316a0ab3e37463f108b96">displayVerbosity</a>() &gt;= 0)) {</div>
<div class="line"><a name="l02715"></a><span class="lineno"> 2715</span>&#160;          *<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#a8a0064746ae8dddfece4229b9ad374d6">subDisplayFile</a>() &lt;&lt; <span class="stringliteral">&quot;In MLSampling&lt;P_V,P_M&gt;::generateSequence()&quot;</span></div>
<div class="line"><a name="l02716"></a><span class="lineno"> 2716</span>&#160;                                  &lt;&lt; <span class="stringliteral">&quot;, level &quot;</span> &lt;&lt; <a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#af9416874c856e50f3b35270e801f17e4">m_currLevel</a>+<a class="code" href="_m_l_sampling_level_options_8h.html#a68d15eaf394d210effcf584b938206d3">LEVEL_REF_ID</a></div>
<div class="line"><a name="l02717"></a><span class="lineno"> 2717</span>&#160;                                  &lt;&lt; <span class="stringliteral">&quot;, step &quot;</span>  &lt;&lt; <a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a1b1f8ccb4823bdfa26ec652f0807c63e">m_currStep</a></div>
<div class="line"><a name="l02718"></a><span class="lineno"> 2718</span>&#160;                                  &lt;&lt; <span class="stringliteral">&quot;, failedExponent = &quot;</span> &lt;&lt; failedExponent <span class="comment">// gpmsa1</span></div>
<div class="line"><a name="l02719"></a><span class="lineno"> 2719</span>&#160;                                  &lt;&lt; <span class="stringliteral">&quot;: entering loop for computing next exponent&quot;</span></div>
<div class="line"><a name="l02720"></a><span class="lineno"> 2720</span>&#160;                                  &lt;&lt; <span class="stringliteral">&quot;, with nowAttempt = &quot;</span> &lt;&lt; nowAttempt</div>
<div class="line"><a name="l02721"></a><span class="lineno"> 2721</span>&#160;                                  &lt;&lt; std::endl;</div>
<div class="line"><a name="l02722"></a><span class="lineno"> 2722</span>&#160;        }</div>
<div class="line"><a name="l02723"></a><span class="lineno"> 2723</span>&#160;</div>
<div class="line"><a name="l02724"></a><span class="lineno"> 2724</span>&#160;        <span class="keywordflow">if</span> (failedExponent &gt; 0.) { <span class="comment">// gpmsa1</span></div>
<div class="line"><a name="l02725"></a><span class="lineno"> 2725</span>&#160;          nowExponent = .5*(prevExponent+failedExponent);</div>
<div class="line"><a name="l02726"></a><span class="lineno"> 2726</span>&#160;        }</div>
<div class="line"><a name="l02727"></a><span class="lineno"> 2727</span>&#160;        <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l02728"></a><span class="lineno"> 2728</span>&#160;          <span class="keywordflow">if</span> (nowAttempt &gt; 0) {</div>
<div class="line"><a name="l02729"></a><span class="lineno"> 2729</span>&#160;            <span class="keywordflow">if</span> (nowEffectiveSizeRatio &gt; meanEffectiveSizeRatio) {</div>
<div class="line"><a name="l02730"></a><span class="lineno"> 2730</span>&#160;              exponents[0] = nowExponent;</div>
<div class="line"><a name="l02731"></a><span class="lineno"> 2731</span>&#160;            }</div>
<div class="line"><a name="l02732"></a><span class="lineno"> 2732</span>&#160;            <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l02733"></a><span class="lineno"> 2733</span>&#160;              exponents[1] = nowExponent;</div>
<div class="line"><a name="l02734"></a><span class="lineno"> 2734</span>&#160;            }</div>
<div class="line"><a name="l02735"></a><span class="lineno"> 2735</span>&#160;            nowExponent = .5*(exponents[0] + exponents[1]);</div>
<div class="line"><a name="l02736"></a><span class="lineno"> 2736</span>&#160;          }</div>
<div class="line"><a name="l02737"></a><span class="lineno"> 2737</span>&#160;        }</div>
<div class="line"><a name="l02738"></a><span class="lineno"> 2738</span>&#160;        <span class="keywordtype">double</span> auxExponent = nowExponent;</div>
<div class="line"><a name="l02739"></a><span class="lineno"> 2739</span>&#160;        <span class="keywordflow">if</span> (prevExponent != 0.) {</div>
<div class="line"><a name="l02740"></a><span class="lineno"> 2740</span>&#160;          auxExponent /= prevExponent;</div>
<div class="line"><a name="l02741"></a><span class="lineno"> 2741</span>&#160;          auxExponent -= 1.;</div>
<div class="line"><a name="l02742"></a><span class="lineno"> 2742</span>&#160;        }</div>
<div class="line"><a name="l02743"></a><span class="lineno"> 2743</span>&#160;        <span class="keywordtype">double</span> subWeightRatioSum     = 0.;</div>
<div class="line"><a name="l02744"></a><span class="lineno"> 2744</span>&#160;        <span class="keywordtype">double</span> unifiedWeightRatioSum = 0.;</div>
<div class="line"><a name="l02745"></a><span class="lineno"> 2745</span>&#160;</div>
<div class="line"><a name="l02746"></a><span class="lineno"> 2746</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = 0; i &lt; weightSequence.<a class="code" href="class_q_u_e_s_o_1_1_scalar_sequence.html#a0288ea295eedc216a1617b3286f6f3a0">subSequenceSize</a>(); ++i) {</div>
<div class="line"><a name="l02747"></a><span class="lineno"> 2747</span>&#160;          omegaLnDiffSequence[i] = prevLogLikelihoodValues[i]*auxExponent; <span class="comment">// likelihood is important</span></div>
<div class="line"><a name="l02748"></a><span class="lineno"> 2748</span>&#160;        }</div>
<div class="line"><a name="l02749"></a><span class="lineno"> 2749</span>&#160;</div>
<div class="line"><a name="l02750"></a><span class="lineno"> 2750</span>&#160;<span class="preprocessor">#if 1 // prudenci-2012-07-06</span></div>
<div class="line"><a name="l02751"></a><span class="lineno"> 2751</span>&#160;<span class="preprocessor"></span>      <span class="comment">//double unifiedOmegaLnMin = omegaLnDiffSequence.unifiedMinPlain(m_vectorSpace.numOfProcsForStorage() == 1);</span></div>
<div class="line"><a name="l02752"></a><span class="lineno"> 2752</span>&#160;        <span class="keywordtype">double</span> unifiedOmegaLnMax = omegaLnDiffSequence.<a class="code" href="class_q_u_e_s_o_1_1_scalar_sequence.html#a70dd5db8c036d364ac56e3cb9c2c7d04">unifiedMaxPlain</a>(<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a7bc4c72f65ba9166ed94a6e198b0915b">m_vectorSpace</a>.<a class="code" href="class_q_u_e_s_o_1_1_vector_space.html#a67b0c3620662116f5a346fdaa5faf38e">numOfProcsForStorage</a>() == 1);</div>
<div class="line"><a name="l02753"></a><span class="lineno"> 2753</span>&#160;<span class="preprocessor">#else</span></div>
<div class="line"><a name="l02754"></a><span class="lineno"> 2754</span>&#160;<span class="preprocessor"></span>        <span class="keywordtype">double</span> unifiedOmegaLnMin = 0.;</div>
<div class="line"><a name="l02755"></a><span class="lineno"> 2755</span>&#160;        <span class="keywordtype">double</span> unifiedOmegaLnMax = 0.;</div>
<div class="line"><a name="l02756"></a><span class="lineno"> 2756</span>&#160;        omegaLnDiffSequence.unifiedMinMaxExtra(<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a7bc4c72f65ba9166ed94a6e198b0915b">m_vectorSpace</a>.<a class="code" href="class_q_u_e_s_o_1_1_vector_space.html#a67b0c3620662116f5a346fdaa5faf38e">numOfProcsForStorage</a>() == 1, <span class="comment">// KAUST3</span></div>
<div class="line"><a name="l02757"></a><span class="lineno"> 2757</span>&#160;                                               0,</div>
<div class="line"><a name="l02758"></a><span class="lineno"> 2758</span>&#160;                                               omegaLnDiffSequence.subSequenceSize(),</div>
<div class="line"><a name="l02759"></a><span class="lineno"> 2759</span>&#160;                                               unifiedOmegaLnMin,</div>
<div class="line"><a name="l02760"></a><span class="lineno"> 2760</span>&#160;                                               unifiedOmegaLnMax);</div>
<div class="line"><a name="l02761"></a><span class="lineno"> 2761</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l02762"></a><span class="lineno"> 2762</span>&#160;<span class="preprocessor"></span>        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = 0; i &lt; weightSequence.<a class="code" href="class_q_u_e_s_o_1_1_scalar_sequence.html#a0288ea295eedc216a1617b3286f6f3a0">subSequenceSize</a>(); ++i) {</div>
<div class="line"><a name="l02763"></a><span class="lineno"> 2763</span>&#160;          omegaLnDiffSequence[i] -= unifiedOmegaLnMax;</div>
<div class="line"><a name="l02764"></a><span class="lineno"> 2764</span>&#160;          weightSequence[i] = exp(omegaLnDiffSequence[i]);</div>
<div class="line"><a name="l02765"></a><span class="lineno"> 2765</span>&#160;          subWeightRatioSum += weightSequence[i];</div>
<div class="line"><a name="l02766"></a><span class="lineno"> 2766</span>&#160;<span class="preprocessor">#if 0 // For debug only</span></div>
<div class="line"><a name="l02767"></a><span class="lineno"> 2767</span>&#160;<span class="preprocessor"></span>          <span class="keywordflow">if</span> ((<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#af9416874c856e50f3b35270e801f17e4">m_currLevel</a> == 1) &amp;&amp; (nowAttempt == 6))  {</div>
<div class="line"><a name="l02768"></a><span class="lineno"> 2768</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#a8a0064746ae8dddfece4229b9ad374d6">subDisplayFile</a>() &amp;&amp; (<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#a1fe5f244fc0316a0ab3e37463f108b96">displayVerbosity</a>() &gt;= 99)) {</div>
<div class="line"><a name="l02769"></a><span class="lineno"> 2769</span>&#160;              *<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#a8a0064746ae8dddfece4229b9ad374d6">subDisplayFile</a>() &lt;&lt; <span class="stringliteral">&quot;In MLSampling&lt;P_V,P_M&gt;::generateSequence()&quot;</span></div>
<div class="line"><a name="l02770"></a><span class="lineno"> 2770</span>&#160;                                      &lt;&lt; <span class="stringliteral">&quot;, level &quot;</span>                        &lt;&lt; <a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#af9416874c856e50f3b35270e801f17e4">m_currLevel</a>+<a class="code" href="_m_l_sampling_level_options_8h.html#a68d15eaf394d210effcf584b938206d3">LEVEL_REF_ID</a></div>
<div class="line"><a name="l02771"></a><span class="lineno"> 2771</span>&#160;                                      &lt;&lt; <span class="stringliteral">&quot;, step &quot;</span>                         &lt;&lt; <a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a1b1f8ccb4823bdfa26ec652f0807c63e">m_currStep</a></div>
<div class="line"><a name="l02772"></a><span class="lineno"> 2772</span>&#160;                                      &lt;&lt; <span class="stringliteral">&quot;, i = &quot;</span>                          &lt;&lt; i</div>
<div class="line"><a name="l02773"></a><span class="lineno"> 2773</span>&#160;                                      &lt;&lt; <span class="stringliteral">&quot;, prevLogLikelihoodValues[i] = &quot;</span> &lt;&lt; prevLogLikelihoodValues[i]</div>
<div class="line"><a name="l02774"></a><span class="lineno"> 2774</span>&#160;                                      &lt;&lt; <span class="stringliteral">&quot;, omegaLnDiffSequence[i] = &quot;</span>     &lt;&lt; omegaLnDiffSequence[i]</div>
<div class="line"><a name="l02775"></a><span class="lineno"> 2775</span>&#160;                                      &lt;&lt; <span class="stringliteral">&quot;, weightSequence[i] = &quot;</span>          &lt;&lt; weightSequence[i]</div>
<div class="line"><a name="l02776"></a><span class="lineno"> 2776</span>&#160;    <span class="comment">//&lt;&lt; &quot;, subWeightRatioSum = &quot;          &lt;&lt; subWeightRatioSum</span></div>
<div class="line"><a name="l02777"></a><span class="lineno"> 2777</span>&#160;                                      &lt;&lt; std::endl;</div>
<div class="line"><a name="l02778"></a><span class="lineno"> 2778</span>&#160;            }</div>
<div class="line"><a name="l02779"></a><span class="lineno"> 2779</span>&#160;          }</div>
<div class="line"><a name="l02780"></a><span class="lineno"> 2780</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l02781"></a><span class="lineno"> 2781</span>&#160;<span class="preprocessor"></span>        }</div>
<div class="line"><a name="l02782"></a><span class="lineno"> 2782</span>&#160;        <a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#a689e4d140c74d495d97eb498714a4b82">inter0Comm</a>().<a class="code" href="class_q_u_e_s_o_1_1_mpi_comm.html#a72e137e60ef8060efb1ee5fc874fa4b8">Allreduce</a>((<span class="keywordtype">void</span> *) &amp;subWeightRatioSum, (<span class="keywordtype">void</span> *) &amp;unifiedWeightRatioSum, (<span class="keywordtype">int</span>) 1, <a class="code" href="_mpi_comm_8h.html#ad0f503bd9fecfe4e570ca3d15aaf2518">RawValue_MPI_DOUBLE</a>, <a class="code" href="_mpi_comm_8h.html#afbf78d291c032aa7f512bc566cee2bd1">RawValue_MPI_SUM</a>,</div>
<div class="line"><a name="l02783"></a><span class="lineno"> 2783</span>&#160;                                     <span class="stringliteral">&quot;MLSampling&lt;P_V,P_M&gt;::generateSequence()&quot;</span>,</div>
<div class="line"><a name="l02784"></a><span class="lineno"> 2784</span>&#160;                                     <span class="stringliteral">&quot;failed MPI.Allreduce() for weight ratio sum&quot;</span>);</div>
<div class="line"><a name="l02785"></a><span class="lineno"> 2785</span>&#160;</div>
<div class="line"><a name="l02786"></a><span class="lineno"> 2786</span>&#160;        <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> auxQuantity = weightSequence.<a class="code" href="class_q_u_e_s_o_1_1_scalar_sequence.html#a52829afc95e5c36e9db44f40854153b0">unifiedSequenceSize</a>(<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a7bc4c72f65ba9166ed94a6e198b0915b">m_vectorSpace</a>.<a class="code" href="class_q_u_e_s_o_1_1_vector_space.html#a67b0c3620662116f5a346fdaa5faf38e">numOfProcsForStorage</a>() == 1);</div>
<div class="line"><a name="l02787"></a><span class="lineno"> 2787</span>&#160;        nowUnifiedEvidenceLnFactor = log(unifiedWeightRatioSum) + unifiedOmegaLnMax - log(auxQuantity);</div>
<div class="line"><a name="l02788"></a><span class="lineno"> 2788</span>&#160;</div>
<div class="line"><a name="l02789"></a><span class="lineno"> 2789</span>&#160;        <span class="keywordtype">double</span> effectiveSampleSize = 0.;</div>
<div class="line"><a name="l02790"></a><span class="lineno"> 2790</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = 0; i &lt; weightSequence.<a class="code" href="class_q_u_e_s_o_1_1_scalar_sequence.html#a0288ea295eedc216a1617b3286f6f3a0">subSequenceSize</a>(); ++i) {</div>
<div class="line"><a name="l02791"></a><span class="lineno"> 2791</span>&#160;          weightSequence[i] /= unifiedWeightRatioSum;</div>
<div class="line"><a name="l02792"></a><span class="lineno"> 2792</span>&#160;          effectiveSampleSize += weightSequence[i]*weightSequence[i];</div>
<div class="line"><a name="l02793"></a><span class="lineno"> 2793</span>&#160;          <span class="comment">//if ((m_env.subDisplayFile()) &amp;&amp; (m_env.displayVerbosity() &gt;= 0)) {</span></div>
<div class="line"><a name="l02794"></a><span class="lineno"> 2794</span>&#160;          <span class="comment">//  *m_env.subDisplayFile() &lt;&lt; &quot;In MLSampling&lt;P_V,P_M&gt;::generateSequence()&quot;</span></div>
<div class="line"><a name="l02795"></a><span class="lineno"> 2795</span>&#160;          <span class="comment">//                          &lt;&lt; &quot;, level &quot;                 &lt;&lt; m_currLevel+LEVEL_REF_ID</span></div>
<div class="line"><a name="l02796"></a><span class="lineno"> 2796</span>&#160;          <span class="comment">//                          &lt;&lt; &quot;, step &quot;                  &lt;&lt; m_currStep</span></div>
<div class="line"><a name="l02797"></a><span class="lineno"> 2797</span>&#160;          <span class="comment">//                          &lt;&lt; &quot;: i = &quot;                   &lt;&lt; i</span></div>
<div class="line"><a name="l02798"></a><span class="lineno"> 2798</span>&#160;          <span class="comment">//                          &lt;&lt; &quot;, effectiveSampleSize = &quot; &lt;&lt; effectiveSampleSize</span></div>
<div class="line"><a name="l02799"></a><span class="lineno"> 2799</span>&#160;          <span class="comment">//                          &lt;&lt; std::endl;</span></div>
<div class="line"><a name="l02800"></a><span class="lineno"> 2800</span>&#160;          <span class="comment">//}</span></div>
<div class="line"><a name="l02801"></a><span class="lineno"> 2801</span>&#160;        }</div>
<div class="line"><a name="l02802"></a><span class="lineno"> 2802</span>&#160;</div>
<div class="line"><a name="l02803"></a><span class="lineno"> 2803</span>&#160;        <span class="keywordflow">if</span> ((<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#a8a0064746ae8dddfece4229b9ad374d6">subDisplayFile</a>()) &amp;&amp; (<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#a1fe5f244fc0316a0ab3e37463f108b96">displayVerbosity</a>() &gt;= 0)) {</div>
<div class="line"><a name="l02804"></a><span class="lineno"> 2804</span>&#160;          *<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#a8a0064746ae8dddfece4229b9ad374d6">subDisplayFile</a>() &lt;&lt; <span class="stringliteral">&quot;In MLSampling&lt;P_V,P_M&gt;::generateSequence()&quot;</span></div>
<div class="line"><a name="l02805"></a><span class="lineno"> 2805</span>&#160;                                  &lt;&lt; <span class="stringliteral">&quot;, level &quot;</span>                                  &lt;&lt; <a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#af9416874c856e50f3b35270e801f17e4">m_currLevel</a>+<a class="code" href="_m_l_sampling_level_options_8h.html#a68d15eaf394d210effcf584b938206d3">LEVEL_REF_ID</a></div>
<div class="line"><a name="l02806"></a><span class="lineno"> 2806</span>&#160;                                  &lt;&lt; <span class="stringliteral">&quot;, step &quot;</span>                                   &lt;&lt; <a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a1b1f8ccb4823bdfa26ec652f0807c63e">m_currStep</a></div>
<div class="line"><a name="l02807"></a><span class="lineno"> 2807</span>&#160;                                  &lt;&lt; <span class="stringliteral">&quot;: nowAttempt = &quot;</span>                           &lt;&lt; nowAttempt</div>
<div class="line"><a name="l02808"></a><span class="lineno"> 2808</span>&#160;                                  &lt;&lt; <span class="stringliteral">&quot;, prevExponent = &quot;</span>                         &lt;&lt; prevExponent</div>
<div class="line"><a name="l02809"></a><span class="lineno"> 2809</span>&#160;                                  &lt;&lt; <span class="stringliteral">&quot;, exponents[0] = &quot;</span>                         &lt;&lt; exponents[0]</div>
<div class="line"><a name="l02810"></a><span class="lineno"> 2810</span>&#160;                                  &lt;&lt; <span class="stringliteral">&quot;, nowExponent = &quot;</span>                          &lt;&lt; nowExponent</div>
<div class="line"><a name="l02811"></a><span class="lineno"> 2811</span>&#160;                                  &lt;&lt; <span class="stringliteral">&quot;, exponents[1] = &quot;</span>                         &lt;&lt; exponents[1]</div>
<div class="line"><a name="l02812"></a><span class="lineno"> 2812</span>&#160;                                  &lt;&lt; <span class="stringliteral">&quot;, subWeightRatioSum = &quot;</span>                    &lt;&lt; subWeightRatioSum</div>
<div class="line"><a name="l02813"></a><span class="lineno"> 2813</span>&#160;                                  &lt;&lt; <span class="stringliteral">&quot;, unifiedWeightRatioSum = &quot;</span>                &lt;&lt; unifiedWeightRatioSum</div>
<div class="line"><a name="l02814"></a><span class="lineno"> 2814</span>&#160;                                  &lt;&lt; <span class="stringliteral">&quot;, unifiedOmegaLnMax = &quot;</span>                    &lt;&lt; unifiedOmegaLnMax</div>
<div class="line"><a name="l02815"></a><span class="lineno"> 2815</span>&#160;                                  &lt;&lt; <span class="stringliteral">&quot;, weightSequence.unifiedSequenceSize() = &quot;</span> &lt;&lt; auxQuantity</div>
<div class="line"><a name="l02816"></a><span class="lineno"> 2816</span>&#160;                                  &lt;&lt; <span class="stringliteral">&quot;, nowUnifiedEvidenceLnFactor = &quot;</span>           &lt;&lt; nowUnifiedEvidenceLnFactor</div>
<div class="line"><a name="l02817"></a><span class="lineno"> 2817</span>&#160;                                  &lt;&lt; <span class="stringliteral">&quot;, effectiveSampleSize = &quot;</span>                  &lt;&lt; effectiveSampleSize</div>
<div class="line"><a name="l02818"></a><span class="lineno"> 2818</span>&#160;                                  &lt;&lt; std::endl;</div>
<div class="line"><a name="l02819"></a><span class="lineno"> 2819</span>&#160;        }</div>
<div class="line"><a name="l02820"></a><span class="lineno"> 2820</span>&#160;</div>
<div class="line"><a name="l02821"></a><span class="lineno"> 2821</span>&#160;<span class="preprocessor">#if 0 // For debug only</span></div>
<div class="line"><a name="l02822"></a><span class="lineno"> 2822</span>&#160;<span class="preprocessor"></span>        <span class="keywordflow">if</span> ((<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#a8a0064746ae8dddfece4229b9ad374d6">subDisplayFile</a>()) &amp;&amp; (<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#a1fe5f244fc0316a0ab3e37463f108b96">displayVerbosity</a>() &gt;= 0)) {</div>
<div class="line"><a name="l02823"></a><span class="lineno"> 2823</span>&#160;          *<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#a8a0064746ae8dddfece4229b9ad374d6">subDisplayFile</a>() &lt;&lt; <span class="stringliteral">&quot;In MLSampling&lt;P_V,P_M&gt;::generateSequence()&quot;</span></div>
<div class="line"><a name="l02824"></a><span class="lineno"> 2824</span>&#160;                                  &lt;&lt; <span class="stringliteral">&quot;, level &quot;</span> &lt;&lt; <a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#af9416874c856e50f3b35270e801f17e4">m_currLevel</a>+<a class="code" href="_m_l_sampling_level_options_8h.html#a68d15eaf394d210effcf584b938206d3">LEVEL_REF_ID</a></div>
<div class="line"><a name="l02825"></a><span class="lineno"> 2825</span>&#160;                                  &lt;&lt; <span class="stringliteral">&quot;, step &quot;</span>  &lt;&lt; <a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a1b1f8ccb4823bdfa26ec652f0807c63e">m_currStep</a></div>
<div class="line"><a name="l02826"></a><span class="lineno"> 2826</span>&#160;                                  &lt;&lt; <span class="stringliteral">&quot;:&quot;</span></div>
<div class="line"><a name="l02827"></a><span class="lineno"> 2827</span>&#160;                                  &lt;&lt; std::endl;</div>
<div class="line"><a name="l02828"></a><span class="lineno"> 2828</span>&#160;        }</div>
<div class="line"><a name="l02829"></a><span class="lineno"> 2829</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = 0; i &lt; weightSequence.<a class="code" href="class_q_u_e_s_o_1_1_scalar_sequence.html#a0288ea295eedc216a1617b3286f6f3a0">subSequenceSize</a>(); ++i) {</div>
<div class="line"><a name="l02830"></a><span class="lineno"> 2830</span>&#160;          <span class="keywordflow">if</span> ((<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#a8a0064746ae8dddfece4229b9ad374d6">subDisplayFile</a>()) &amp;&amp; (<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#a1fe5f244fc0316a0ab3e37463f108b96">displayVerbosity</a>() &gt;= 0)) {</div>
<div class="line"><a name="l02831"></a><span class="lineno"> 2831</span>&#160;            *<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#a8a0064746ae8dddfece4229b9ad374d6">subDisplayFile</a>() &lt;&lt; <span class="stringliteral">&quot;  weightSequence[&quot;</span> &lt;&lt; i</div>
<div class="line"><a name="l02832"></a><span class="lineno"> 2832</span>&#160;                                    &lt;&lt; <span class="stringliteral">&quot;] = &quot;</span>              &lt;&lt; weightSequence[i]</div>
<div class="line"><a name="l02833"></a><span class="lineno"> 2833</span>&#160;                                    &lt;&lt; std::endl;</div>
<div class="line"><a name="l02834"></a><span class="lineno"> 2834</span>&#160;          }</div>
<div class="line"><a name="l02835"></a><span class="lineno"> 2835</span>&#160;        }</div>
<div class="line"><a name="l02836"></a><span class="lineno"> 2836</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l02837"></a><span class="lineno"> 2837</span>&#160;<span class="preprocessor"></span></div>
<div class="line"><a name="l02838"></a><span class="lineno"> 2838</span>&#160;        <span class="keywordtype">double</span> subQuantity = effectiveSampleSize;</div>
<div class="line"><a name="l02839"></a><span class="lineno"> 2839</span>&#160;        effectiveSampleSize = 0.;</div>
<div class="line"><a name="l02840"></a><span class="lineno"> 2840</span>&#160;        <a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#a689e4d140c74d495d97eb498714a4b82">inter0Comm</a>().<a class="code" href="class_q_u_e_s_o_1_1_mpi_comm.html#a72e137e60ef8060efb1ee5fc874fa4b8">Allreduce</a>((<span class="keywordtype">void</span> *) &amp;subQuantity, (<span class="keywordtype">void</span> *) &amp;effectiveSampleSize, (<span class="keywordtype">int</span>) 1, <a class="code" href="_mpi_comm_8h.html#ad0f503bd9fecfe4e570ca3d15aaf2518">RawValue_MPI_DOUBLE</a>, <a class="code" href="_mpi_comm_8h.html#afbf78d291c032aa7f512bc566cee2bd1">RawValue_MPI_SUM</a>,</div>
<div class="line"><a name="l02841"></a><span class="lineno"> 2841</span>&#160;                                     <span class="stringliteral">&quot;MLSampling&lt;P_V,P_M&gt;::generateSequence()&quot;</span>,</div>
<div class="line"><a name="l02842"></a><span class="lineno"> 2842</span>&#160;                                     <span class="stringliteral">&quot;failed MPI.Allreduce() for effective sample size&quot;</span>);</div>
<div class="line"><a name="l02843"></a><span class="lineno"> 2843</span>&#160;</div>
<div class="line"><a name="l02844"></a><span class="lineno"> 2844</span>&#160;        effectiveSampleSize = 1./effectiveSampleSize;</div>
<div class="line"><a name="l02845"></a><span class="lineno"> 2845</span>&#160;        nowEffectiveSizeRatio = effectiveSampleSize/((double) weightSequence.<a class="code" href="class_q_u_e_s_o_1_1_scalar_sequence.html#a52829afc95e5c36e9db44f40854153b0">unifiedSequenceSize</a>(<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a7bc4c72f65ba9166ed94a6e198b0915b">m_vectorSpace</a>.<a class="code" href="class_q_u_e_s_o_1_1_vector_space.html#a67b0c3620662116f5a346fdaa5faf38e">numOfProcsForStorage</a>() == 1));</div>
<div class="line"><a name="l02846"></a><span class="lineno"> 2846</span>&#160;        <a class="code" href="_defines_8h.html#a56d63d18d0a6d45757de47fcc06f574d">UQ_FATAL_TEST_MACRO</a>((nowEffectiveSizeRatio &gt; (1.+1.e-8)),</div>
<div class="line"><a name="l02847"></a><span class="lineno"> 2847</span>&#160;                            <a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#a78b57112bbd0e6dd0e8afec00b40ffa7">worldRank</a>(),</div>
<div class="line"><a name="l02848"></a><span class="lineno"> 2848</span>&#160;                            <span class="stringliteral">&quot;MLSampling&lt;P_V,P_M&gt;::generateSequence()&quot;</span>,</div>
<div class="line"><a name="l02849"></a><span class="lineno"> 2849</span>&#160;                            <span class="stringliteral">&quot;effective sample size ratio cannot be &gt; 1&quot;</span>);</div>
<div class="line"><a name="l02850"></a><span class="lineno"> 2850</span>&#160;        <span class="comment">//UQ_FATAL_TEST_MACRO((nowEffectiveSizeRatio &lt; (1.-1.e-8)),</span></div>
<div class="line"><a name="l02851"></a><span class="lineno"> 2851</span>&#160;        <span class="comment">//                    m_env.worldRank(),</span></div>
<div class="line"><a name="l02852"></a><span class="lineno"> 2852</span>&#160;        <span class="comment">//                    &quot;MLSampling&lt;P_V,P_M&gt;::generateSequence()&quot;,</span></div>
<div class="line"><a name="l02853"></a><span class="lineno"> 2853</span>&#160;        <span class="comment">//                    &quot;effective sample size ratio cannot be &lt; 1&quot;);</span></div>
<div class="line"><a name="l02854"></a><span class="lineno"> 2854</span>&#160;</div>
<div class="line"><a name="l02855"></a><span class="lineno"> 2855</span>&#160;        <span class="keywordflow">if</span> (failedExponent &gt; 0.) { <span class="comment">// gpmsa1</span></div>
<div class="line"><a name="l02856"></a><span class="lineno"> 2856</span>&#160;          testResult = <span class="keyword">true</span>;</div>
<div class="line"><a name="l02857"></a><span class="lineno"> 2857</span>&#160;        }</div>
<div class="line"><a name="l02858"></a><span class="lineno"> 2858</span>&#160;        <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l02859"></a><span class="lineno"> 2859</span>&#160;          <span class="comment">//bool aux1 = (nowEffectiveSizeRatio == meanEffectiveSizeRatio);</span></div>
<div class="line"><a name="l02860"></a><span class="lineno"> 2860</span>&#160;          <span class="keywordtype">bool</span> aux2 = (nowExponent == 1.                             )</div>
<div class="line"><a name="l02861"></a><span class="lineno"> 2861</span>&#160;                      &amp;&amp;</div>
<div class="line"><a name="l02862"></a><span class="lineno"> 2862</span>&#160;                      (nowEffectiveSizeRatio &gt; meanEffectiveSizeRatio);</div>
<div class="line"><a name="l02863"></a><span class="lineno"> 2863</span>&#160;          <span class="keywordtype">bool</span> aux3 = (nowEffectiveSizeRatio &gt;= currOptions-&gt;m_minEffectiveSizeRatio)</div>
<div class="line"><a name="l02864"></a><span class="lineno"> 2864</span>&#160;                      &amp;&amp;</div>
<div class="line"><a name="l02865"></a><span class="lineno"> 2865</span>&#160;                      (nowEffectiveSizeRatio &lt;= currOptions-&gt;m_maxEffectiveSizeRatio);</div>
<div class="line"><a name="l02866"></a><span class="lineno"> 2866</span>&#160;          testResult = aux2 || aux3;</div>
<div class="line"><a name="l02867"></a><span class="lineno"> 2867</span>&#160;        }</div>
<div class="line"><a name="l02868"></a><span class="lineno"> 2868</span>&#160;</div>
<div class="line"><a name="l02869"></a><span class="lineno"> 2869</span>&#160;        <span class="keywordflow">if</span> ((<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#a8a0064746ae8dddfece4229b9ad374d6">subDisplayFile</a>()) &amp;&amp; (<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#a1fe5f244fc0316a0ab3e37463f108b96">displayVerbosity</a>() &gt;= 0)) {</div>
<div class="line"><a name="l02870"></a><span class="lineno"> 2870</span>&#160;          *<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#a8a0064746ae8dddfece4229b9ad374d6">subDisplayFile</a>() &lt;&lt; <span class="stringliteral">&quot;In MLSampling&lt;P_V,P_M&gt;::generateSequence()&quot;</span></div>
<div class="line"><a name="l02871"></a><span class="lineno"> 2871</span>&#160;                                  &lt;&lt; <span class="stringliteral">&quot;, level &quot;</span>                   &lt;&lt; <a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#af9416874c856e50f3b35270e801f17e4">m_currLevel</a>+<a class="code" href="_m_l_sampling_level_options_8h.html#a68d15eaf394d210effcf584b938206d3">LEVEL_REF_ID</a></div>
<div class="line"><a name="l02872"></a><span class="lineno"> 2872</span>&#160;                                  &lt;&lt; <span class="stringliteral">&quot;, step &quot;</span>                    &lt;&lt; <a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a1b1f8ccb4823bdfa26ec652f0807c63e">m_currStep</a></div>
<div class="line"><a name="l02873"></a><span class="lineno"> 2873</span>&#160;                                  &lt;&lt; <span class="stringliteral">&quot;: nowAttempt = &quot;</span>            &lt;&lt; nowAttempt</div>
<div class="line"><a name="l02874"></a><span class="lineno"> 2874</span>&#160;                                  &lt;&lt; <span class="stringliteral">&quot;, prevExponent = &quot;</span>          &lt;&lt; prevExponent</div>
<div class="line"><a name="l02875"></a><span class="lineno"> 2875</span>&#160;                                  &lt;&lt; <span class="stringliteral">&quot;, failedExponent = &quot;</span>        &lt;&lt; failedExponent <span class="comment">// gpmsa1</span></div>
<div class="line"><a name="l02876"></a><span class="lineno"> 2876</span>&#160;                                  &lt;&lt; <span class="stringliteral">&quot;, exponents[0] = &quot;</span>          &lt;&lt; exponents[0]</div>
<div class="line"><a name="l02877"></a><span class="lineno"> 2877</span>&#160;                                  &lt;&lt; <span class="stringliteral">&quot;, nowExponent = &quot;</span>           &lt;&lt; nowExponent</div>
<div class="line"><a name="l02878"></a><span class="lineno"> 2878</span>&#160;                                  &lt;&lt; <span class="stringliteral">&quot;, exponents[1] = &quot;</span>          &lt;&lt; exponents[1]</div>
<div class="line"><a name="l02879"></a><span class="lineno"> 2879</span>&#160;                                  &lt;&lt; <span class="stringliteral">&quot;, effectiveSampleSize = &quot;</span>   &lt;&lt; effectiveSampleSize</div>
<div class="line"><a name="l02880"></a><span class="lineno"> 2880</span>&#160;                                  &lt;&lt; <span class="stringliteral">&quot;, weightSequenceSize = &quot;</span>    &lt;&lt; weightSequence.<a class="code" href="class_q_u_e_s_o_1_1_scalar_sequence.html#a0288ea295eedc216a1617b3286f6f3a0">subSequenceSize</a>()</div>
<div class="line"><a name="l02881"></a><span class="lineno"> 2881</span>&#160;                                  &lt;&lt; <span class="stringliteral">&quot;, minEffectiveSizeRatio = &quot;</span> &lt;&lt; currOptions-&gt;m_minEffectiveSizeRatio</div>
<div class="line"><a name="l02882"></a><span class="lineno"> 2882</span>&#160;                                  &lt;&lt; <span class="stringliteral">&quot;, nowEffectiveSizeRatio = &quot;</span> &lt;&lt; nowEffectiveSizeRatio</div>
<div class="line"><a name="l02883"></a><span class="lineno"> 2883</span>&#160;                                  &lt;&lt; <span class="stringliteral">&quot;, maxEffectiveSizeRatio = &quot;</span> &lt;&lt; currOptions-&gt;m_maxEffectiveSizeRatio</div>
<div class="line"><a name="l02884"></a><span class="lineno"> 2884</span>&#160;      <span class="comment">//&lt;&lt; &quot;, aux2 = &quot;                  &lt;&lt; aux2</span></div>
<div class="line"><a name="l02885"></a><span class="lineno"> 2885</span>&#160;      <span class="comment">//&lt;&lt; &quot;, aux3 = &quot;                  &lt;&lt; aux3</span></div>
<div class="line"><a name="l02886"></a><span class="lineno"> 2886</span>&#160;                                  &lt;&lt; <span class="stringliteral">&quot;, testResult = &quot;</span>            &lt;&lt; testResult</div>
<div class="line"><a name="l02887"></a><span class="lineno"> 2887</span>&#160;                                  &lt;&lt; std::endl;</div>
<div class="line"><a name="l02888"></a><span class="lineno"> 2888</span>&#160;        }</div>
<div class="line"><a name="l02889"></a><span class="lineno"> 2889</span>&#160;        nowAttempt++;</div>
<div class="line"><a name="l02890"></a><span class="lineno"> 2890</span>&#160;</div>
<div class="line"><a name="l02891"></a><span class="lineno"> 2891</span>&#160;        <span class="comment">// Make sure all nodes in &#39;inter0Comm&#39; have the same value of &#39;nowExponent&#39;</span></div>
<div class="line"><a name="l02892"></a><span class="lineno"> 2892</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="namespace_q_u_e_s_o.html#a4166a375c5adbea35afaaf20775bc519">MiscCheckForSameValueInAllNodes</a>(nowExponent,</div>
<div class="line"><a name="l02893"></a><span class="lineno"> 2893</span>&#160;                                              0., <span class="comment">// kept &#39;zero&#39; on 2010/03/05</span></div>
<div class="line"><a name="l02894"></a><span class="lineno"> 2894</span>&#160;                                              <a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#a689e4d140c74d495d97eb498714a4b82">inter0Comm</a>(),</div>
<div class="line"><a name="l02895"></a><span class="lineno"> 2895</span>&#160;                                              <span class="stringliteral">&quot;MLSampling&lt;P_V,P_M&gt;::generateSequence(), step 3, nowExponent&quot;</span>) == <span class="keyword">false</span>) {</div>
<div class="line"><a name="l02896"></a><span class="lineno"> 2896</span>&#160;          <span class="keywordflow">if</span> ((<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#a8a0064746ae8dddfece4229b9ad374d6">subDisplayFile</a>()) &amp;&amp; (<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#a1fe5f244fc0316a0ab3e37463f108b96">displayVerbosity</a>() &gt;= 0)) {</div>
<div class="line"><a name="l02897"></a><span class="lineno"> 2897</span>&#160;            *<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#a8a0064746ae8dddfece4229b9ad374d6">subDisplayFile</a>() &lt;&lt; <span class="stringliteral">&quot;WARNING, In MLSampling&lt;P_V,P_M&gt;::generateSequence()&quot;</span></div>
<div class="line"><a name="l02898"></a><span class="lineno"> 2898</span>&#160;                                    &lt;&lt; <span class="stringliteral">&quot;, level &quot;</span>        &lt;&lt; <a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#af9416874c856e50f3b35270e801f17e4">m_currLevel</a>+<a class="code" href="_m_l_sampling_level_options_8h.html#a68d15eaf394d210effcf584b938206d3">LEVEL_REF_ID</a></div>
<div class="line"><a name="l02899"></a><span class="lineno"> 2899</span>&#160;                                    &lt;&lt; <span class="stringliteral">&quot;, step &quot;</span>         &lt;&lt; <a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a1b1f8ccb4823bdfa26ec652f0807c63e">m_currStep</a></div>
<div class="line"><a name="l02900"></a><span class="lineno"> 2900</span>&#160;                                    &lt;&lt; <span class="stringliteral">&quot;: nowAttempt = &quot;</span> &lt;&lt; nowAttempt</div>
<div class="line"><a name="l02901"></a><span class="lineno"> 2901</span>&#160;                                    &lt;&lt; <span class="stringliteral">&quot;, MiscCheck for &#39;nowExponent&#39; detected a problem&quot;</span></div>
<div class="line"><a name="l02902"></a><span class="lineno"> 2902</span>&#160;                                    &lt;&lt; std::endl;</div>
<div class="line"><a name="l02903"></a><span class="lineno"> 2903</span>&#160;          }</div>
<div class="line"><a name="l02904"></a><span class="lineno"> 2904</span>&#160;        }</div>
<div class="line"><a name="l02905"></a><span class="lineno"> 2905</span>&#160;</div>
<div class="line"><a name="l02906"></a><span class="lineno"> 2906</span>&#160;        <span class="comment">// Make sure all nodes in &#39;inter0Comm&#39; have the same value of &#39;testResult&#39;</span></div>
<div class="line"><a name="l02907"></a><span class="lineno"> 2907</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="namespace_q_u_e_s_o.html#a4166a375c5adbea35afaaf20775bc519">MiscCheckForSameValueInAllNodes</a>(testResult,</div>
<div class="line"><a name="l02908"></a><span class="lineno"> 2908</span>&#160;                                              0., <span class="comment">// kept &#39;zero&#39; on 2010/03/05</span></div>
<div class="line"><a name="l02909"></a><span class="lineno"> 2909</span>&#160;                                              <a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#a689e4d140c74d495d97eb498714a4b82">inter0Comm</a>(),</div>
<div class="line"><a name="l02910"></a><span class="lineno"> 2910</span>&#160;                                              <span class="stringliteral">&quot;MLSampling&lt;P_V,P_M&gt;::generateSequence(), step 3, testResult&quot;</span>) == <span class="keyword">false</span>) {</div>
<div class="line"><a name="l02911"></a><span class="lineno"> 2911</span>&#160;          <span class="keywordflow">if</span> ((<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#a8a0064746ae8dddfece4229b9ad374d6">subDisplayFile</a>()) &amp;&amp; (<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#a1fe5f244fc0316a0ab3e37463f108b96">displayVerbosity</a>() &gt;= 0)) {</div>
<div class="line"><a name="l02912"></a><span class="lineno"> 2912</span>&#160;            *<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#a8a0064746ae8dddfece4229b9ad374d6">subDisplayFile</a>() &lt;&lt; <span class="stringliteral">&quot;WARNING, In MLSampling&lt;P_V,P_M&gt;::generateSequence()&quot;</span></div>
<div class="line"><a name="l02913"></a><span class="lineno"> 2913</span>&#160;                                    &lt;&lt; <span class="stringliteral">&quot;, level &quot;</span>        &lt;&lt; <a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#af9416874c856e50f3b35270e801f17e4">m_currLevel</a>+<a class="code" href="_m_l_sampling_level_options_8h.html#a68d15eaf394d210effcf584b938206d3">LEVEL_REF_ID</a></div>
<div class="line"><a name="l02914"></a><span class="lineno"> 2914</span>&#160;                                    &lt;&lt; <span class="stringliteral">&quot;, step &quot;</span>         &lt;&lt; <a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a1b1f8ccb4823bdfa26ec652f0807c63e">m_currStep</a></div>
<div class="line"><a name="l02915"></a><span class="lineno"> 2915</span>&#160;                                    &lt;&lt; <span class="stringliteral">&quot;: nowAttempt = &quot;</span> &lt;&lt; nowAttempt</div>
<div class="line"><a name="l02916"></a><span class="lineno"> 2916</span>&#160;                                    &lt;&lt; <span class="stringliteral">&quot;, MiscCheck for &#39;testResult&#39; detected a problem&quot;</span></div>
<div class="line"><a name="l02917"></a><span class="lineno"> 2917</span>&#160;                                    &lt;&lt; std::endl;</div>
<div class="line"><a name="l02918"></a><span class="lineno"> 2918</span>&#160;          }</div>
<div class="line"><a name="l02919"></a><span class="lineno"> 2919</span>&#160;        }</div>
<div class="line"><a name="l02920"></a><span class="lineno"> 2920</span>&#160;      } <span class="keywordflow">while</span> (testResult == <span class="keyword">false</span>);</div>
<div class="line"><a name="l02921"></a><span class="lineno"> 2921</span>&#160;      currExponent = nowExponent;</div>
<div class="line"><a name="l02922"></a><span class="lineno"> 2922</span>&#160;      <span class="keywordflow">if</span> (failedExponent &gt; 0.) { <span class="comment">// gpmsa1</span></div>
<div class="line"><a name="l02923"></a><span class="lineno"> 2923</span>&#160;        <a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a75f2ceab4a2c6774b3fa07d74221dbf3">m_logEvidenceFactors</a>[<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a75f2ceab4a2c6774b3fa07d74221dbf3">m_logEvidenceFactors</a>.size()-1] = nowUnifiedEvidenceLnFactor;</div>
<div class="line"><a name="l02924"></a><span class="lineno"> 2924</span>&#160;      }</div>
<div class="line"><a name="l02925"></a><span class="lineno"> 2925</span>&#160;      <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l02926"></a><span class="lineno"> 2926</span>&#160;        <a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a75f2ceab4a2c6774b3fa07d74221dbf3">m_logEvidenceFactors</a>.push_back(nowUnifiedEvidenceLnFactor); <span class="comment">// restart</span></div>
<div class="line"><a name="l02927"></a><span class="lineno"> 2927</span>&#160;      }</div>
<div class="line"><a name="l02928"></a><span class="lineno"> 2928</span>&#160;</div>
<div class="line"><a name="l02929"></a><span class="lineno"> 2929</span>&#160;      <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> quantity1 = weightSequence.<a class="code" href="class_q_u_e_s_o_1_1_scalar_sequence.html#a52829afc95e5c36e9db44f40854153b0">unifiedSequenceSize</a>(<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a7bc4c72f65ba9166ed94a6e198b0915b">m_vectorSpace</a>.<a class="code" href="class_q_u_e_s_o_1_1_vector_space.html#a67b0c3620662116f5a346fdaa5faf38e">numOfProcsForStorage</a>() == 1);</div>
<div class="line"><a name="l02930"></a><span class="lineno"> 2930</span>&#160;      <span class="keywordflow">if</span> ((<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#a8a0064746ae8dddfece4229b9ad374d6">subDisplayFile</a>()) &amp;&amp; (<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#a1fe5f244fc0316a0ab3e37463f108b96">displayVerbosity</a>() &gt;= 0)) {</div>
<div class="line"><a name="l02931"></a><span class="lineno"> 2931</span>&#160;        *<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#a8a0064746ae8dddfece4229b9ad374d6">subDisplayFile</a>() &lt;&lt; <span class="stringliteral">&quot;In MLSampling&lt;P_V,P_M&gt;::generateSequence()&quot;</span></div>
<div class="line"><a name="l02932"></a><span class="lineno"> 2932</span>&#160;                                &lt;&lt; <span class="stringliteral">&quot;, level &quot;</span>                                  &lt;&lt; <a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#af9416874c856e50f3b35270e801f17e4">m_currLevel</a>+<a class="code" href="_m_l_sampling_level_options_8h.html#a68d15eaf394d210effcf584b938206d3">LEVEL_REF_ID</a></div>
<div class="line"><a name="l02933"></a><span class="lineno"> 2933</span>&#160;                                &lt;&lt; <span class="stringliteral">&quot;, step &quot;</span>                                   &lt;&lt; <a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a1b1f8ccb4823bdfa26ec652f0807c63e">m_currStep</a></div>
<div class="line"><a name="l02934"></a><span class="lineno"> 2934</span>&#160;                                &lt;&lt; <span class="stringliteral">&quot;: weightSequence.subSequenceSize() = &quot;</span>     &lt;&lt; weightSequence.<a class="code" href="class_q_u_e_s_o_1_1_scalar_sequence.html#a0288ea295eedc216a1617b3286f6f3a0">subSequenceSize</a>()</div>
<div class="line"><a name="l02935"></a><span class="lineno"> 2935</span>&#160;                                &lt;&lt; <span class="stringliteral">&quot;, weightSequence.unifiedSequenceSize() = &quot;</span> &lt;&lt; quantity1</div>
<div class="line"><a name="l02936"></a><span class="lineno"> 2936</span>&#160;                                &lt;&lt; <span class="stringliteral">&quot;, failedExponent = &quot;</span>                       &lt;&lt; failedExponent <span class="comment">// gpmsa1</span></div>
<div class="line"><a name="l02937"></a><span class="lineno"> 2937</span>&#160;                                &lt;&lt; <span class="stringliteral">&quot;, currExponent = &quot;</span>                         &lt;&lt; currExponent</div>
<div class="line"><a name="l02938"></a><span class="lineno"> 2938</span>&#160;                                &lt;&lt; <span class="stringliteral">&quot;, effective ratio = &quot;</span>                      &lt;&lt; nowEffectiveSizeRatio</div>
<div class="line"><a name="l02939"></a><span class="lineno"> 2939</span>&#160;                                &lt;&lt; <span class="stringliteral">&quot;, log(evidence factor) = &quot;</span>                 &lt;&lt; <a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a75f2ceab4a2c6774b3fa07d74221dbf3">m_logEvidenceFactors</a>[<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a75f2ceab4a2c6774b3fa07d74221dbf3">m_logEvidenceFactors</a>.size()-1]</div>
<div class="line"><a name="l02940"></a><span class="lineno"> 2940</span>&#160;                                &lt;&lt; <span class="stringliteral">&quot;, evidence factor = &quot;</span>                      &lt;&lt; exp(<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a75f2ceab4a2c6774b3fa07d74221dbf3">m_logEvidenceFactors</a>[<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a75f2ceab4a2c6774b3fa07d74221dbf3">m_logEvidenceFactors</a>.size()-1])</div>
<div class="line"><a name="l02941"></a><span class="lineno"> 2941</span>&#160;                                &lt;&lt; std::endl;</div>
<div class="line"><a name="l02942"></a><span class="lineno"> 2942</span>&#160;</div>
<div class="line"><a name="l02943"></a><span class="lineno"> 2943</span>&#160;        <span class="comment">//unsigned int numZeros = 0;</span></div>
<div class="line"><a name="l02944"></a><span class="lineno"> 2944</span>&#160;        <span class="comment">//for (unsigned int i = 0; i &lt; weightSequence.subSequenceSize(); ++i) {</span></div>
<div class="line"><a name="l02945"></a><span class="lineno"> 2945</span>&#160;        <span class="comment">//  *m_env.subDisplayFile() &lt;&lt; &quot;weightSequence[&quot; &lt;&lt; i</span></div>
<div class="line"><a name="l02946"></a><span class="lineno"> 2946</span>&#160;        <span class="comment">//                          &lt;&lt; &quot;] = &quot; &lt;&lt; weightSequence[i]</span></div>
<div class="line"><a name="l02947"></a><span class="lineno"> 2947</span>&#160;        <span class="comment">//                         &lt;&lt; std::endl;</span></div>
<div class="line"><a name="l02948"></a><span class="lineno"> 2948</span>&#160;        <span class="comment">//  if (weightSequence[i] == 0.) numZeros++;</span></div>
<div class="line"><a name="l02949"></a><span class="lineno"> 2949</span>&#160;        <span class="comment">//}</span></div>
<div class="line"><a name="l02950"></a><span class="lineno"> 2950</span>&#160;        <span class="comment">//*m_env.subDisplayFile() &lt;&lt; &quot;Number of zeros in weightSequence = &quot; &lt;&lt; numZeros</span></div>
<div class="line"><a name="l02951"></a><span class="lineno"> 2951</span>&#160;        <span class="comment">//                        &lt;&lt; std::endl;</span></div>
<div class="line"><a name="l02952"></a><span class="lineno"> 2952</span>&#160;      }</div>
<div class="line"><a name="l02953"></a><span class="lineno"> 2953</span>&#160;</div>
<div class="line"><a name="l02954"></a><span class="lineno"> 2954</span>&#160;      <span class="comment">// Make sure all nodes in &#39;inter0Comm&#39; have the same value of &#39;logEvidenceFactor&#39;</span></div>
<div class="line"><a name="l02955"></a><span class="lineno"> 2955</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="namespace_q_u_e_s_o.html#a4166a375c5adbea35afaaf20775bc519">MiscCheckForSameValueInAllNodes</a>(<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a75f2ceab4a2c6774b3fa07d74221dbf3">m_logEvidenceFactors</a>[<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a75f2ceab4a2c6774b3fa07d74221dbf3">m_logEvidenceFactors</a>.size()-1],</div>
<div class="line"><a name="l02956"></a><span class="lineno"> 2956</span>&#160;                                            3.0e-16, <span class="comment">// changed from &#39;zero&#39; on 2010/03/03</span></div>
<div class="line"><a name="l02957"></a><span class="lineno"> 2957</span>&#160;                                            <a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#a689e4d140c74d495d97eb498714a4b82">inter0Comm</a>(),</div>
<div class="line"><a name="l02958"></a><span class="lineno"> 2958</span>&#160;                                            <span class="stringliteral">&quot;MLSampling&lt;P_V,P_M&gt;::generateSequence(), step 3, logEvidenceFactor&quot;</span>) == <span class="keyword">false</span>) {</div>
<div class="line"><a name="l02959"></a><span class="lineno"> 2959</span>&#160;        <span class="keywordflow">if</span> ((<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#a8a0064746ae8dddfece4229b9ad374d6">subDisplayFile</a>()) &amp;&amp; (<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#a1fe5f244fc0316a0ab3e37463f108b96">displayVerbosity</a>() &gt;= 0)) {</div>
<div class="line"><a name="l02960"></a><span class="lineno"> 2960</span>&#160;          *<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#a8a0064746ae8dddfece4229b9ad374d6">subDisplayFile</a>() &lt;&lt; <span class="stringliteral">&quot;WARNING, In MLSampling&lt;P_V,P_M&gt;::generateSequence()&quot;</span></div>
<div class="line"><a name="l02961"></a><span class="lineno"> 2961</span>&#160;                                  &lt;&lt; <span class="stringliteral">&quot;, level &quot;</span>        &lt;&lt; <a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#af9416874c856e50f3b35270e801f17e4">m_currLevel</a>+<a class="code" href="_m_l_sampling_level_options_8h.html#a68d15eaf394d210effcf584b938206d3">LEVEL_REF_ID</a></div>
<div class="line"><a name="l02962"></a><span class="lineno"> 2962</span>&#160;                                  &lt;&lt; <span class="stringliteral">&quot;, step &quot;</span>         &lt;&lt; <a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a1b1f8ccb4823bdfa26ec652f0807c63e">m_currStep</a></div>
<div class="line"><a name="l02963"></a><span class="lineno"> 2963</span>&#160;                                  &lt;&lt; <span class="stringliteral">&quot;, failedExponent = &quot;</span> &lt;&lt; failedExponent <span class="comment">// gpmsa1</span></div>
<div class="line"><a name="l02964"></a><span class="lineno"> 2964</span>&#160;                                  &lt;&lt; <span class="stringliteral">&quot;: nowAttempt = &quot;</span> &lt;&lt; nowAttempt</div>
<div class="line"><a name="l02965"></a><span class="lineno"> 2965</span>&#160;                                  &lt;&lt; <span class="stringliteral">&quot;, MiscCheck for &#39;logEvidenceFactor&#39; detected a problem&quot;</span></div>
<div class="line"><a name="l02966"></a><span class="lineno"> 2966</span>&#160;                                  &lt;&lt; std::endl;</div>
<div class="line"><a name="l02967"></a><span class="lineno"> 2967</span>&#160;        }</div>
<div class="line"><a name="l02968"></a><span class="lineno"> 2968</span>&#160;      }</div>
<div class="line"><a name="l02969"></a><span class="lineno"> 2969</span>&#160;</div>
<div class="line"><a name="l02970"></a><span class="lineno"> 2970</span>&#160;  <span class="keywordtype">double</span> stepRunTime = <a class="code" href="namespace_q_u_e_s_o.html#a424bc33f2e6e287fd468408d14b772ee">MiscGetEllapsedSeconds</a>(&amp;timevalStep);</div>
<div class="line"><a name="l02971"></a><span class="lineno"> 2971</span>&#160;  <span class="keywordflow">if</span> ((<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#a8a0064746ae8dddfece4229b9ad374d6">subDisplayFile</a>()) &amp;&amp; (<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#a1fe5f244fc0316a0ab3e37463f108b96">displayVerbosity</a>() &gt;= 0)) {</div>
<div class="line"><a name="l02972"></a><span class="lineno"> 2972</span>&#160;    *<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#a8a0064746ae8dddfece4229b9ad374d6">subDisplayFile</a>() &lt;&lt; <span class="stringliteral">&quot;Leaving MLSampling&lt;P_V,P_M&gt;::generateSequence_Step()&quot;</span></div>
<div class="line"><a name="l02973"></a><span class="lineno"> 2973</span>&#160;                            &lt;&lt; <span class="stringliteral">&quot;, level &quot;</span> &lt;&lt; <a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#af9416874c856e50f3b35270e801f17e4">m_currLevel</a>+<a class="code" href="_m_l_sampling_level_options_8h.html#a68d15eaf394d210effcf584b938206d3">LEVEL_REF_ID</a></div>
<div class="line"><a name="l02974"></a><span class="lineno"> 2974</span>&#160;                            &lt;&lt; <span class="stringliteral">&quot;, step &quot;</span>  &lt;&lt; <a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a1b1f8ccb4823bdfa26ec652f0807c63e">m_currStep</a></div>
<div class="line"><a name="l02975"></a><span class="lineno"> 2975</span>&#160;                            &lt;&lt; <span class="stringliteral">&quot;, failedExponent = &quot;</span> &lt;&lt; failedExponent <span class="comment">// gpmsa</span></div>
<div class="line"><a name="l02976"></a><span class="lineno"> 2976</span>&#160;                            &lt;&lt; <span class="stringliteral">&quot;, after &quot;</span> &lt;&lt; stepRunTime &lt;&lt; <span class="stringliteral">&quot; seconds&quot;</span></div>
<div class="line"><a name="l02977"></a><span class="lineno"> 2977</span>&#160;                            &lt;&lt; std::endl;</div>
<div class="line"><a name="l02978"></a><span class="lineno"> 2978</span>&#160;  }</div>
<div class="line"><a name="l02979"></a><span class="lineno"> 2979</span>&#160;</div>
<div class="line"><a name="l02980"></a><span class="lineno"> 2980</span>&#160;  <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l02981"></a><span class="lineno"> 2981</span>&#160;}</div>
<div class="ttc" id="class_q_u_e_s_o_1_1_m_l_sampling_html_a13f1ca4fe9f94822fe572a743eaced1d"><div class="ttname"><a href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">QUESO::MLSampling::m_env</a></div><div class="ttdeci">const BaseEnvironment &amp; m_env</div><div class="ttdoc">Queso enviroment. </div><div class="ttdef"><b>Definition:</b> <a href="_m_l_sampling_8h_source.html#l00442">MLSampling.h:442</a></div></div>
<div class="ttc" id="_mpi_comm_8h_html_afbf78d291c032aa7f512bc566cee2bd1"><div class="ttname"><a href="_mpi_comm_8h.html#afbf78d291c032aa7f512bc566cee2bd1">RawValue_MPI_SUM</a></div><div class="ttdeci">#define RawValue_MPI_SUM</div><div class="ttdef"><b>Definition:</b> <a href="_mpi_comm_8h_source.html#l00052">MpiComm.h:52</a></div></div>
<div class="ttc" id="class_q_u_e_s_o_1_1_base_environment_html_a78b57112bbd0e6dd0e8afec00b40ffa7"><div class="ttname"><a href="class_q_u_e_s_o_1_1_base_environment.html#a78b57112bbd0e6dd0e8afec00b40ffa7">QUESO::BaseEnvironment::worldRank</a></div><div class="ttdeci">int worldRank() const </div><div class="ttdoc">Returns the process world rank. </div><div class="ttdef"><b>Definition:</b> <a href="_environment_8_c_source.html#l00235">Environment.C:235</a></div></div>
<div class="ttc" id="namespace_q_u_e_s_o_html_a8e909502900aecf24cedba022ea84471"><div class="ttname"><a href="namespace_q_u_e_s_o.html#a8e909502900aecf24cedba022ea84471">QUESO::UQ_OK_RC</a></div><div class="ttdeci">const int UQ_OK_RC</div><div class="ttdef"><b>Definition:</b> <a href="_defines_8h_source.html#l00075">Defines.h:75</a></div></div>
<div class="ttc" id="class_q_u_e_s_o_1_1_m_l_sampling_html_a75f2ceab4a2c6774b3fa07d74221dbf3"><div class="ttname"><a href="class_q_u_e_s_o_1_1_m_l_sampling.html#a75f2ceab4a2c6774b3fa07d74221dbf3">QUESO::MLSampling::m_logEvidenceFactors</a></div><div class="ttdeci">std::vector&lt; double &gt; m_logEvidenceFactors</div><div class="ttdef"><b>Definition:</b> <a href="_m_l_sampling_8h_source.html#l00471">MLSampling.h:471</a></div></div>
<div class="ttc" id="class_q_u_e_s_o_1_1_vector_space_html_a67b0c3620662116f5a346fdaa5faf38e"><div class="ttname"><a href="class_q_u_e_s_o_1_1_vector_space.html#a67b0c3620662116f5a346fdaa5faf38e">QUESO::VectorSpace::numOfProcsForStorage</a></div><div class="ttdeci">unsigned int numOfProcsForStorage() const </div><div class="ttdoc">Returns total number of processes. </div><div class="ttdef"><b>Definition:</b> <a href="_vector_space_8_c_source.html#l00193">VectorSpace.C:193</a></div></div>
<div class="ttc" id="class_q_u_e_s_o_1_1_m_l_sampling_html_af9416874c856e50f3b35270e801f17e4"><div class="ttname"><a href="class_q_u_e_s_o_1_1_m_l_sampling.html#af9416874c856e50f3b35270e801f17e4">QUESO::MLSampling::m_currLevel</a></div><div class="ttdeci">unsigned int m_currLevel</div><div class="ttdoc">Current level. </div><div class="ttdef"><b>Definition:</b> <a href="_m_l_sampling_8h_source.html#l00464">MLSampling.h:464</a></div></div>
<div class="ttc" id="_m_l_sampling_level_options_8h_html_a68d15eaf394d210effcf584b938206d3"><div class="ttname"><a href="_m_l_sampling_level_options_8h.html#a68d15eaf394d210effcf584b938206d3">LEVEL_REF_ID</a></div><div class="ttdeci">#define LEVEL_REF_ID</div><div class="ttdef"><b>Definition:</b> <a href="_m_l_sampling_level_options_8h_source.html#l00028">MLSamplingLevelOptions.h:28</a></div></div>
<div class="ttc" id="class_q_u_e_s_o_1_1_scalar_sequence_html_a0288ea295eedc216a1617b3286f6f3a0"><div class="ttname"><a href="class_q_u_e_s_o_1_1_scalar_sequence.html#a0288ea295eedc216a1617b3286f6f3a0">QUESO::ScalarSequence::subSequenceSize</a></div><div class="ttdeci">unsigned int subSequenceSize() const </div><div class="ttdoc">Size of the sub-sequence of scalars. </div><div class="ttdef"><b>Definition:</b> <a href="_scalar_sequence_8_c_source.html#l00141">ScalarSequence.C:141</a></div></div>
<div class="ttc" id="namespace_q_u_e_s_o_html_a4166a375c5adbea35afaaf20775bc519"><div class="ttname"><a href="namespace_q_u_e_s_o.html#a4166a375c5adbea35afaaf20775bc519">QUESO::MiscCheckForSameValueInAllNodes</a></div><div class="ttdeci">bool MiscCheckForSameValueInAllNodes(T &amp;inputValue, double acceptableTreshold, const MpiComm &amp;comm, const char *whereString)</div><div class="ttdef"><b>Definition:</b> <a href="_miscellaneous_8_c_source.html#l00484">Miscellaneous.C:484</a></div></div>
<div class="ttc" id="class_q_u_e_s_o_1_1_scalar_sequence_html_a70dd5db8c036d364ac56e3cb9c2c7d04"><div class="ttname"><a href="class_q_u_e_s_o_1_1_scalar_sequence.html#a70dd5db8c036d364ac56e3cb9c2c7d04">QUESO::ScalarSequence::unifiedMaxPlain</a></div><div class="ttdeci">const T &amp; unifiedMaxPlain(bool useOnlyInter0Comm) const </div><div class="ttdoc">Finds the maximum value of the unified sequence of scalars. </div><div class="ttdef"><b>Definition:</b> <a href="_scalar_sequence_8_c_source.html#l00403">ScalarSequence.C:403</a></div></div>
<div class="ttc" id="class_q_u_e_s_o_1_1_scalar_sequence_html_a52829afc95e5c36e9db44f40854153b0"><div class="ttname"><a href="class_q_u_e_s_o_1_1_scalar_sequence.html#a52829afc95e5c36e9db44f40854153b0">QUESO::ScalarSequence::unifiedSequenceSize</a></div><div class="ttdeci">unsigned int unifiedSequenceSize(bool useOnlyInter0Comm) const </div><div class="ttdoc">Size of the unified sequence of scalars. </div><div class="ttdef"><b>Definition:</b> <a href="_scalar_sequence_8_c_source.html#l00148">ScalarSequence.C:148</a></div></div>
<div class="ttc" id="class_q_u_e_s_o_1_1_m_l_sampling_html_a7bc4c72f65ba9166ed94a6e198b0915b"><div class="ttname"><a href="class_q_u_e_s_o_1_1_m_l_sampling.html#a7bc4c72f65ba9166ed94a6e198b0915b">QUESO::MLSampling::m_vectorSpace</a></div><div class="ttdeci">const VectorSpace&lt; P_V, P_M &gt; &amp; m_vectorSpace</div><div class="ttdoc">Vector space. </div><div class="ttdef"><b>Definition:</b> <a href="_m_l_sampling_8h_source.html#l00451">MLSampling.h:451</a></div></div>
<div class="ttc" id="namespace_q_u_e_s_o_html_a424bc33f2e6e287fd468408d14b772ee"><div class="ttname"><a href="namespace_q_u_e_s_o.html#a424bc33f2e6e287fd468408d14b772ee">QUESO::MiscGetEllapsedSeconds</a></div><div class="ttdeci">double MiscGetEllapsedSeconds(struct timeval *timeval0)</div><div class="ttdef"><b>Definition:</b> <a href="_miscellaneous_8_c_source.html#l00287">Miscellaneous.C:287</a></div></div>
<div class="ttc" id="class_q_u_e_s_o_1_1_mpi_comm_html_a72e137e60ef8060efb1ee5fc874fa4b8"><div class="ttname"><a href="class_q_u_e_s_o_1_1_mpi_comm.html#a72e137e60ef8060efb1ee5fc874fa4b8">QUESO::MpiComm::Allreduce</a></div><div class="ttdeci">void Allreduce(void *sendbuf, void *recvbuf, int count, RawType_MPI_Datatype datatype, RawType_MPI_Op op, const char *whereMsg, const char *whatMsg) const </div><div class="ttdoc">Combines values from all processes and distributes the result back to all processes. </div><div class="ttdef"><b>Definition:</b> <a href="_mpi_comm_8_c_source.html#l00131">MpiComm.C:131</a></div></div>
<div class="ttc" id="_mpi_comm_8h_html_ad0f503bd9fecfe4e570ca3d15aaf2518"><div class="ttname"><a href="_mpi_comm_8h.html#ad0f503bd9fecfe4e570ca3d15aaf2518">RawValue_MPI_DOUBLE</a></div><div class="ttdeci">#define RawValue_MPI_DOUBLE</div><div class="ttdef"><b>Definition:</b> <a href="_mpi_comm_8h_source.html#l00048">MpiComm.h:48</a></div></div>
<div class="ttc" id="_defines_8h_html_a56d63d18d0a6d45757de47fcc06f574d"><div class="ttname"><a href="_defines_8h.html#a56d63d18d0a6d45757de47fcc06f574d">UQ_FATAL_TEST_MACRO</a></div><div class="ttdeci">#define UQ_FATAL_TEST_MACRO(test, givenRank, where, what)</div><div class="ttdef"><b>Definition:</b> <a href="_defines_8h_source.html#l00222">Defines.h:222</a></div></div>
<div class="ttc" id="class_q_u_e_s_o_1_1_m_l_sampling_html_a1b1f8ccb4823bdfa26ec652f0807c63e"><div class="ttname"><a href="class_q_u_e_s_o_1_1_m_l_sampling.html#a1b1f8ccb4823bdfa26ec652f0807c63e">QUESO::MLSampling::m_currStep</a></div><div class="ttdeci">unsigned int m_currStep</div><div class="ttdoc">Curret step. </div><div class="ttdef"><b>Definition:</b> <a href="_m_l_sampling_8h_source.html#l00467">MLSampling.h:467</a></div></div>
<div class="ttc" id="class_q_u_e_s_o_1_1_base_environment_html_a1fe5f244fc0316a0ab3e37463f108b96"><div class="ttname"><a href="class_q_u_e_s_o_1_1_base_environment.html#a1fe5f244fc0316a0ab3e37463f108b96">QUESO::BaseEnvironment::displayVerbosity</a></div><div class="ttdeci">unsigned int displayVerbosity() const </div><div class="ttdef"><b>Definition:</b> <a href="_environment_8_c_source.html#l00436">Environment.C:436</a></div></div>
<div class="ttc" id="class_q_u_e_s_o_1_1_base_environment_html_a8a0064746ae8dddfece4229b9ad374d6"><div class="ttname"><a href="class_q_u_e_s_o_1_1_base_environment.html#a8a0064746ae8dddfece4229b9ad374d6">QUESO::BaseEnvironment::subDisplayFile</a></div><div class="ttdeci">std::ofstream * subDisplayFile() const </div><div class="ttdoc">Access function for m_subDisplayFile (displays file on stream). </div><div class="ttdef"><b>Definition:</b> <a href="_environment_8_c_source.html#l00305">Environment.C:305</a></div></div>
<div class="ttc" id="class_q_u_e_s_o_1_1_base_environment_html_a689e4d140c74d495d97eb498714a4b82"><div class="ttname"><a href="class_q_u_e_s_o_1_1_base_environment.html#a689e4d140c74d495d97eb498714a4b82">QUESO::BaseEnvironment::inter0Comm</a></div><div class="ttdeci">const MpiComm &amp; inter0Comm() const </div><div class="ttdoc">Access function for MpiComm inter0-communicator. </div><div class="ttdef"><b>Definition:</b> <a href="_environment_8_c_source.html#l00295">Environment.C:295</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a955fb446652327edbc275e3d9145e2db"></a>
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;class P_V , class P_M &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="class_q_u_e_s_o_1_1_m_l_sampling.html">QUESO::MLSampling</a>&lt; P_V, P_M &gt;::generateSequence_Step04_inter0 </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="class_q_u_e_s_o_1_1_sequence_of_vectors.html">SequenceOfVectors</a>&lt; P_V, P_M &gt; &amp;&#160;</td>
          <td class="paramname"><em>prevChain</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="class_q_u_e_s_o_1_1_scalar_sequence.html">ScalarSequence</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>weightSequence</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">P_M &amp;&#160;</td>
          <td class="paramname"><em>unifiedCovMatrix</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Creates covariance matrix for current level (Step 04 from ML algorithm). </p>
<p>This method is responsible for the Step 04 in the ML algorithm implemented/described in the method <a class="el" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a8d7296b30623c73ada38971cae27994a" title="Method to generate the chain. ">MLSampling&lt;P_V,P_M&gt;::generateSequence</a>.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">prevChain,weightSequence</td><td></td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">unifiedCovMatrix</td><td></td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="_m_l_sampling_8_c_source.html#l02985">2985</a> of file <a class="el" href="_m_l_sampling_8_c_source.html">MLSampling.C</a>.</p>

<p>References <a class="el" href="_sequence_of_vectors_8_c_source.html#l00197">QUESO::SequenceOfVectors&lt; V, M &gt;::getPositionValues()</a>, <a class="el" href="_m_l_sampling_level_options_8h_source.html#l00028">LEVEL_REF_ID</a>, <a class="el" href="_gsl_matrix_8_c_source.html#l02409">QUESO::matrixProduct()</a>, <a class="el" href="_miscellaneous_8_c_source.html#l00287">QUESO::MiscGetEllapsedSeconds()</a>, <a class="el" href="_mpi_comm_8h_source.html#l00048">RawValue_MPI_DOUBLE</a>, <a class="el" href="_mpi_comm_8h_source.html#l00052">RawValue_MPI_SUM</a>, <a class="el" href="_scalar_sequence_8_c_source.html#l00141">QUESO::ScalarSequence&lt; T &gt;::subSequenceSize()</a>, and <a class="el" href="_defines_8h_source.html#l00075">QUESO::UQ_OK_RC</a>.</p>
<div class="fragment"><div class="line"><a name="l02989"></a><span class="lineno"> 2989</span>&#160;{</div>
<div class="line"><a name="l02990"></a><span class="lineno"> 2990</span>&#160;  <span class="keywordtype">int</span> iRC = <a class="code" href="namespace_q_u_e_s_o.html#a8e909502900aecf24cedba022ea84471">UQ_OK_RC</a>;</div>
<div class="line"><a name="l02991"></a><span class="lineno"> 2991</span>&#160;  <span class="keyword">struct </span>timeval timevalStep;</div>
<div class="line"><a name="l02992"></a><span class="lineno"> 2992</span>&#160;  iRC = gettimeofday(&amp;timevalStep, NULL);</div>
<div class="line"><a name="l02993"></a><span class="lineno"> 2993</span>&#160;  <span class="keywordflow">if</span> (iRC) {}; <span class="comment">// just to remove compiler warning</span></div>
<div class="line"><a name="l02994"></a><span class="lineno"> 2994</span>&#160;</div>
<div class="line"><a name="l02995"></a><span class="lineno"> 2995</span>&#160;      <span class="keywordflow">if</span> ((<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#a8a0064746ae8dddfece4229b9ad374d6">subDisplayFile</a>()) &amp;&amp; (<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#a1fe5f244fc0316a0ab3e37463f108b96">displayVerbosity</a>() &gt;= 0)) {</div>
<div class="line"><a name="l02996"></a><span class="lineno"> 2996</span>&#160;        *<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#a8a0064746ae8dddfece4229b9ad374d6">subDisplayFile</a>() &lt;&lt; <span class="stringliteral">&quot;In MLSampling&lt;P_V,P_M&gt;::generateSequence()&quot;</span></div>
<div class="line"><a name="l02997"></a><span class="lineno"> 2997</span>&#160;                                &lt;&lt; <span class="stringliteral">&quot;, level &quot;</span> &lt;&lt; <a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#af9416874c856e50f3b35270e801f17e4">m_currLevel</a>+<a class="code" href="_m_l_sampling_level_options_8h.html#a68d15eaf394d210effcf584b938206d3">LEVEL_REF_ID</a></div>
<div class="line"><a name="l02998"></a><span class="lineno"> 2998</span>&#160;                                &lt;&lt; <span class="stringliteral">&quot;, step &quot;</span>  &lt;&lt; <a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a1b1f8ccb4823bdfa26ec652f0807c63e">m_currStep</a></div>
<div class="line"><a name="l02999"></a><span class="lineno"> 2999</span>&#160;                                &lt;&lt; <span class="stringliteral">&quot;: beginning step 4 of 11&quot;</span></div>
<div class="line"><a name="l03000"></a><span class="lineno"> 3000</span>&#160;                                &lt;&lt; std::endl;</div>
<div class="line"><a name="l03001"></a><span class="lineno"> 3001</span>&#160;      }</div>
<div class="line"><a name="l03002"></a><span class="lineno"> 3002</span>&#160;</div>
<div class="line"><a name="l03003"></a><span class="lineno"> 3003</span>&#160;      P_V auxVec(<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a7bc4c72f65ba9166ed94a6e198b0915b">m_vectorSpace</a>.<a class="code" href="class_q_u_e_s_o_1_1_vector_space.html#a92e963bb5cab3eecd290dfe4b8f03b04">zeroVector</a>());</div>
<div class="line"><a name="l03004"></a><span class="lineno"> 3004</span>&#160;      P_V subWeightedMeanVec(<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a7bc4c72f65ba9166ed94a6e198b0915b">m_vectorSpace</a>.<a class="code" href="class_q_u_e_s_o_1_1_vector_space.html#a92e963bb5cab3eecd290dfe4b8f03b04">zeroVector</a>());</div>
<div class="line"><a name="l03005"></a><span class="lineno"> 3005</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = 0; i &lt; weightSequence.<a class="code" href="class_q_u_e_s_o_1_1_scalar_sequence.html#a0288ea295eedc216a1617b3286f6f3a0">subSequenceSize</a>(); ++i) {</div>
<div class="line"><a name="l03006"></a><span class="lineno"> 3006</span>&#160;        prevChain.getPositionValues(i,auxVec);</div>
<div class="line"><a name="l03007"></a><span class="lineno"> 3007</span>&#160;        subWeightedMeanVec += weightSequence[i]*auxVec;</div>
<div class="line"><a name="l03008"></a><span class="lineno"> 3008</span>&#160;      }</div>
<div class="line"><a name="l03009"></a><span class="lineno"> 3009</span>&#160;</div>
<div class="line"><a name="l03010"></a><span class="lineno"> 3010</span>&#160;      <span class="comment">// Todd Oliver 2010-09-07: compute weighted mean over all processors</span></div>
<div class="line"><a name="l03011"></a><span class="lineno"> 3011</span>&#160;      P_V unifiedWeightedMeanVec(<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a7bc4c72f65ba9166ed94a6e198b0915b">m_vectorSpace</a>.<a class="code" href="class_q_u_e_s_o_1_1_vector_space.html#a92e963bb5cab3eecd290dfe4b8f03b04">zeroVector</a>());</div>
<div class="line"><a name="l03012"></a><span class="lineno"> 3012</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#ae106b5bb8a80b655b88b3a26b1e7c185">inter0Rank</a>() &gt;= 0) {</div>
<div class="line"><a name="l03013"></a><span class="lineno"> 3013</span>&#160;        subWeightedMeanVec.mpiAllReduce(<a class="code" href="_mpi_comm_8h.html#afbf78d291c032aa7f512bc566cee2bd1">RawValue_MPI_SUM</a>,<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#a689e4d140c74d495d97eb498714a4b82">inter0Comm</a>(),unifiedWeightedMeanVec);</div>
<div class="line"><a name="l03014"></a><span class="lineno"> 3014</span>&#160;      }</div>
<div class="line"><a name="l03015"></a><span class="lineno"> 3015</span>&#160;      <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l03016"></a><span class="lineno"> 3016</span>&#160;        unifiedWeightedMeanVec = subWeightedMeanVec;</div>
<div class="line"><a name="l03017"></a><span class="lineno"> 3017</span>&#160;      }</div>
<div class="line"><a name="l03018"></a><span class="lineno"> 3018</span>&#160;</div>
<div class="line"><a name="l03019"></a><span class="lineno"> 3019</span>&#160;      P_V diffVec(<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a7bc4c72f65ba9166ed94a6e198b0915b">m_vectorSpace</a>.<a class="code" href="class_q_u_e_s_o_1_1_vector_space.html#a92e963bb5cab3eecd290dfe4b8f03b04">zeroVector</a>());</div>
<div class="line"><a name="l03020"></a><span class="lineno"> 3020</span>&#160;      P_M subCovMatrix(<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a7bc4c72f65ba9166ed94a6e198b0915b">m_vectorSpace</a>.<a class="code" href="class_q_u_e_s_o_1_1_vector_space.html#a92e963bb5cab3eecd290dfe4b8f03b04">zeroVector</a>());</div>
<div class="line"><a name="l03021"></a><span class="lineno"> 3021</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = 0; i &lt; weightSequence.<a class="code" href="class_q_u_e_s_o_1_1_scalar_sequence.html#a0288ea295eedc216a1617b3286f6f3a0">subSequenceSize</a>(); ++i) {</div>
<div class="line"><a name="l03022"></a><span class="lineno"> 3022</span>&#160;        prevChain.getPositionValues(i,auxVec);</div>
<div class="line"><a name="l03023"></a><span class="lineno"> 3023</span>&#160;        diffVec = auxVec - unifiedWeightedMeanVec;</div>
<div class="line"><a name="l03024"></a><span class="lineno"> 3024</span>&#160;        subCovMatrix += weightSequence[i]*<a class="code" href="namespace_q_u_e_s_o.html#aea04e232d5d3dd76349a85bb8acf9e17">matrixProduct</a>(diffVec,diffVec);</div>
<div class="line"><a name="l03025"></a><span class="lineno"> 3025</span>&#160;      }</div>
<div class="line"><a name="l03026"></a><span class="lineno"> 3026</span>&#160;</div>
<div class="line"><a name="l03027"></a><span class="lineno"> 3027</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = 0; i &lt; unifiedCovMatrix.numRowsLocal(); ++i) { <span class="comment">// KAUST5</span></div>
<div class="line"><a name="l03028"></a><span class="lineno"> 3028</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> j = 0; j &lt; unifiedCovMatrix.numCols(); ++j) {</div>
<div class="line"><a name="l03029"></a><span class="lineno"> 3029</span>&#160;          <span class="keywordtype">double</span> localValue = subCovMatrix(i,j);</div>
<div class="line"><a name="l03030"></a><span class="lineno"> 3030</span>&#160;          <span class="keywordtype">double</span> sumValue = 0.;</div>
<div class="line"><a name="l03031"></a><span class="lineno"> 3031</span>&#160;          <span class="keywordflow">if</span> (<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#ae106b5bb8a80b655b88b3a26b1e7c185">inter0Rank</a>() &gt;= 0) {</div>
<div class="line"><a name="l03032"></a><span class="lineno"> 3032</span>&#160;            <a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#a689e4d140c74d495d97eb498714a4b82">inter0Comm</a>().<a class="code" href="class_q_u_e_s_o_1_1_mpi_comm.html#a72e137e60ef8060efb1ee5fc874fa4b8">Allreduce</a>((<span class="keywordtype">void</span> *) &amp;localValue, (<span class="keywordtype">void</span> *) &amp;sumValue, (<span class="keywordtype">int</span>) 1, <a class="code" href="_mpi_comm_8h.html#ad0f503bd9fecfe4e570ca3d15aaf2518">RawValue_MPI_DOUBLE</a>, <a class="code" href="_mpi_comm_8h.html#afbf78d291c032aa7f512bc566cee2bd1">RawValue_MPI_SUM</a>,</div>
<div class="line"><a name="l03033"></a><span class="lineno"> 3033</span>&#160;                                         <span class="stringliteral">&quot;MLSampling&lt;P_V,P_M&gt;::generateSequence()&quot;</span>,</div>
<div class="line"><a name="l03034"></a><span class="lineno"> 3034</span>&#160;                                         <span class="stringliteral">&quot;failed MPI.Allreduce() for cov matrix&quot;</span>);</div>
<div class="line"><a name="l03035"></a><span class="lineno"> 3035</span>&#160;          }</div>
<div class="line"><a name="l03036"></a><span class="lineno"> 3036</span>&#160;          <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l03037"></a><span class="lineno"> 3037</span>&#160;            sumValue = localValue;</div>
<div class="line"><a name="l03038"></a><span class="lineno"> 3038</span>&#160;          }</div>
<div class="line"><a name="l03039"></a><span class="lineno"> 3039</span>&#160;          unifiedCovMatrix(i,j) = sumValue;</div>
<div class="line"><a name="l03040"></a><span class="lineno"> 3040</span>&#160;        }</div>
<div class="line"><a name="l03041"></a><span class="lineno"> 3041</span>&#160;      }</div>
<div class="line"><a name="l03042"></a><span class="lineno"> 3042</span>&#160;</div>
<div class="line"><a name="l03043"></a><span class="lineno"> 3043</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#afbe27e6149562020663b72da6592d933">m_numDisabledParameters</a> &gt; 0) { <span class="comment">// gpmsa2</span></div>
<div class="line"><a name="l03044"></a><span class="lineno"> 3044</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> paramId = 0; paramId &lt; <a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a7bc4c72f65ba9166ed94a6e198b0915b">m_vectorSpace</a>.<a class="code" href="class_q_u_e_s_o_1_1_vector_space.html#a5829a1f4f996f8307c840b705144d666">dimLocal</a>(); ++paramId) {</div>
<div class="line"><a name="l03045"></a><span class="lineno"> 3045</span>&#160;          <span class="keywordflow">if</span> (<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#ac76690384f70d74b8662faf7a051449e">m_parameterEnabledStatus</a>[paramId] == <span class="keyword">false</span>) {</div>
<div class="line"><a name="l03046"></a><span class="lineno"> 3046</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a7bc4c72f65ba9166ed94a6e198b0915b">m_vectorSpace</a>.<a class="code" href="class_q_u_e_s_o_1_1_vector_space.html#a5829a1f4f996f8307c840b705144d666">dimLocal</a>(); ++i) {</div>
<div class="line"><a name="l03047"></a><span class="lineno"> 3047</span>&#160;              unifiedCovMatrix(i,paramId) = 0.;</div>
<div class="line"><a name="l03048"></a><span class="lineno"> 3048</span>&#160;            }</div>
<div class="line"><a name="l03049"></a><span class="lineno"> 3049</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> j = 0; j &lt; <a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a7bc4c72f65ba9166ed94a6e198b0915b">m_vectorSpace</a>.<a class="code" href="class_q_u_e_s_o_1_1_vector_space.html#a5829a1f4f996f8307c840b705144d666">dimLocal</a>(); ++j) {</div>
<div class="line"><a name="l03050"></a><span class="lineno"> 3050</span>&#160;              unifiedCovMatrix(paramId,j) = 0.;</div>
<div class="line"><a name="l03051"></a><span class="lineno"> 3051</span>&#160;            }</div>
<div class="line"><a name="l03052"></a><span class="lineno"> 3052</span>&#160;            unifiedCovMatrix(paramId,paramId) = 1.;</div>
<div class="line"><a name="l03053"></a><span class="lineno"> 3053</span>&#160;          }</div>
<div class="line"><a name="l03054"></a><span class="lineno"> 3054</span>&#160;        }</div>
<div class="line"><a name="l03055"></a><span class="lineno"> 3055</span>&#160;      }</div>
<div class="line"><a name="l03056"></a><span class="lineno"> 3056</span>&#160;</div>
<div class="line"><a name="l03057"></a><span class="lineno"> 3057</span>&#160;      <span class="keywordflow">if</span> ((<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#a8a0064746ae8dddfece4229b9ad374d6">subDisplayFile</a>()) &amp;&amp; (<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#a1fe5f244fc0316a0ab3e37463f108b96">displayVerbosity</a>() &gt;= 0)) {</div>
<div class="line"><a name="l03058"></a><span class="lineno"> 3058</span>&#160;        *<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#a8a0064746ae8dddfece4229b9ad374d6">subDisplayFile</a>() &lt;&lt; <span class="stringliteral">&quot;In MLSampling&lt;P_V,P_M&gt;::generateSequence()&quot;</span></div>
<div class="line"><a name="l03059"></a><span class="lineno"> 3059</span>&#160;                                &lt;&lt; <span class="stringliteral">&quot;, level &quot;</span>              &lt;&lt; <a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#af9416874c856e50f3b35270e801f17e4">m_currLevel</a>+<a class="code" href="_m_l_sampling_level_options_8h.html#a68d15eaf394d210effcf584b938206d3">LEVEL_REF_ID</a></div>
<div class="line"><a name="l03060"></a><span class="lineno"> 3060</span>&#160;                                &lt;&lt; <span class="stringliteral">&quot;, step &quot;</span>               &lt;&lt; <a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a1b1f8ccb4823bdfa26ec652f0807c63e">m_currStep</a></div>
<div class="line"><a name="l03061"></a><span class="lineno"> 3061</span>&#160;                                &lt;&lt; <span class="stringliteral">&quot;: unifiedCovMatrix = &quot;</span> &lt;&lt; unifiedCovMatrix</div>
<div class="line"><a name="l03062"></a><span class="lineno"> 3062</span>&#160;                                &lt;&lt; std::endl;</div>
<div class="line"><a name="l03063"></a><span class="lineno"> 3063</span>&#160;      }</div>
<div class="line"><a name="l03064"></a><span class="lineno"> 3064</span>&#160;</div>
<div class="line"><a name="l03065"></a><span class="lineno"> 3065</span>&#160;  <span class="keywordtype">double</span> stepRunTime = <a class="code" href="namespace_q_u_e_s_o.html#a424bc33f2e6e287fd468408d14b772ee">MiscGetEllapsedSeconds</a>(&amp;timevalStep);</div>
<div class="line"><a name="l03066"></a><span class="lineno"> 3066</span>&#160;  <span class="keywordflow">if</span> ((<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#a8a0064746ae8dddfece4229b9ad374d6">subDisplayFile</a>()) &amp;&amp; (<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#a1fe5f244fc0316a0ab3e37463f108b96">displayVerbosity</a>() &gt;= 0)) {</div>
<div class="line"><a name="l03067"></a><span class="lineno"> 3067</span>&#160;    *<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#a8a0064746ae8dddfece4229b9ad374d6">subDisplayFile</a>() &lt;&lt; <span class="stringliteral">&quot;Leaving MLSampling&lt;P_V,P_M&gt;::generateSequence_Step()&quot;</span></div>
<div class="line"><a name="l03068"></a><span class="lineno"> 3068</span>&#160;                            &lt;&lt; <span class="stringliteral">&quot;, level &quot;</span> &lt;&lt; <a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#af9416874c856e50f3b35270e801f17e4">m_currLevel</a>+<a class="code" href="_m_l_sampling_level_options_8h.html#a68d15eaf394d210effcf584b938206d3">LEVEL_REF_ID</a></div>
<div class="line"><a name="l03069"></a><span class="lineno"> 3069</span>&#160;                            &lt;&lt; <span class="stringliteral">&quot;, step &quot;</span>  &lt;&lt; <a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a1b1f8ccb4823bdfa26ec652f0807c63e">m_currStep</a></div>
<div class="line"><a name="l03070"></a><span class="lineno"> 3070</span>&#160;                            &lt;&lt; <span class="stringliteral">&quot;, after &quot;</span> &lt;&lt; stepRunTime &lt;&lt; <span class="stringliteral">&quot; seconds&quot;</span></div>
<div class="line"><a name="l03071"></a><span class="lineno"> 3071</span>&#160;                            &lt;&lt; std::endl;</div>
<div class="line"><a name="l03072"></a><span class="lineno"> 3072</span>&#160;  }</div>
<div class="line"><a name="l03073"></a><span class="lineno"> 3073</span>&#160;</div>
<div class="line"><a name="l03074"></a><span class="lineno"> 3074</span>&#160;  <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l03075"></a><span class="lineno"> 3075</span>&#160;}</div>
<div class="ttc" id="class_q_u_e_s_o_1_1_m_l_sampling_html_a13f1ca4fe9f94822fe572a743eaced1d"><div class="ttname"><a href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">QUESO::MLSampling::m_env</a></div><div class="ttdeci">const BaseEnvironment &amp; m_env</div><div class="ttdoc">Queso enviroment. </div><div class="ttdef"><b>Definition:</b> <a href="_m_l_sampling_8h_source.html#l00442">MLSampling.h:442</a></div></div>
<div class="ttc" id="_mpi_comm_8h_html_afbf78d291c032aa7f512bc566cee2bd1"><div class="ttname"><a href="_mpi_comm_8h.html#afbf78d291c032aa7f512bc566cee2bd1">RawValue_MPI_SUM</a></div><div class="ttdeci">#define RawValue_MPI_SUM</div><div class="ttdef"><b>Definition:</b> <a href="_mpi_comm_8h_source.html#l00052">MpiComm.h:52</a></div></div>
<div class="ttc" id="class_q_u_e_s_o_1_1_vector_space_html_a5829a1f4f996f8307c840b705144d666"><div class="ttname"><a href="class_q_u_e_s_o_1_1_vector_space.html#a5829a1f4f996f8307c840b705144d666">QUESO::VectorSpace::dimLocal</a></div><div class="ttdeci">unsigned int dimLocal() const </div><div class="ttdef"><b>Definition:</b> <a href="_vector_space_8_c_source.html#l00199">VectorSpace.C:199</a></div></div>
<div class="ttc" id="namespace_q_u_e_s_o_html_a8e909502900aecf24cedba022ea84471"><div class="ttname"><a href="namespace_q_u_e_s_o.html#a8e909502900aecf24cedba022ea84471">QUESO::UQ_OK_RC</a></div><div class="ttdeci">const int UQ_OK_RC</div><div class="ttdef"><b>Definition:</b> <a href="_defines_8h_source.html#l00075">Defines.h:75</a></div></div>
<div class="ttc" id="class_q_u_e_s_o_1_1_m_l_sampling_html_afbe27e6149562020663b72da6592d933"><div class="ttname"><a href="class_q_u_e_s_o_1_1_m_l_sampling.html#afbe27e6149562020663b72da6592d933">QUESO::MLSampling::m_numDisabledParameters</a></div><div class="ttdeci">unsigned int m_numDisabledParameters</div><div class="ttdef"><b>Definition:</b> <a href="_m_l_sampling_8h_source.html#l00456">MLSampling.h:456</a></div></div>
<div class="ttc" id="class_q_u_e_s_o_1_1_m_l_sampling_html_ac76690384f70d74b8662faf7a051449e"><div class="ttname"><a href="class_q_u_e_s_o_1_1_m_l_sampling.html#ac76690384f70d74b8662faf7a051449e">QUESO::MLSampling::m_parameterEnabledStatus</a></div><div class="ttdeci">std::vector&lt; bool &gt; m_parameterEnabledStatus</div><div class="ttdef"><b>Definition:</b> <a href="_m_l_sampling_8h_source.html#l00458">MLSampling.h:458</a></div></div>
<div class="ttc" id="class_q_u_e_s_o_1_1_m_l_sampling_html_af9416874c856e50f3b35270e801f17e4"><div class="ttname"><a href="class_q_u_e_s_o_1_1_m_l_sampling.html#af9416874c856e50f3b35270e801f17e4">QUESO::MLSampling::m_currLevel</a></div><div class="ttdeci">unsigned int m_currLevel</div><div class="ttdoc">Current level. </div><div class="ttdef"><b>Definition:</b> <a href="_m_l_sampling_8h_source.html#l00464">MLSampling.h:464</a></div></div>
<div class="ttc" id="_m_l_sampling_level_options_8h_html_a68d15eaf394d210effcf584b938206d3"><div class="ttname"><a href="_m_l_sampling_level_options_8h.html#a68d15eaf394d210effcf584b938206d3">LEVEL_REF_ID</a></div><div class="ttdeci">#define LEVEL_REF_ID</div><div class="ttdef"><b>Definition:</b> <a href="_m_l_sampling_level_options_8h_source.html#l00028">MLSamplingLevelOptions.h:28</a></div></div>
<div class="ttc" id="class_q_u_e_s_o_1_1_scalar_sequence_html_a0288ea295eedc216a1617b3286f6f3a0"><div class="ttname"><a href="class_q_u_e_s_o_1_1_scalar_sequence.html#a0288ea295eedc216a1617b3286f6f3a0">QUESO::ScalarSequence::subSequenceSize</a></div><div class="ttdeci">unsigned int subSequenceSize() const </div><div class="ttdoc">Size of the sub-sequence of scalars. </div><div class="ttdef"><b>Definition:</b> <a href="_scalar_sequence_8_c_source.html#l00141">ScalarSequence.C:141</a></div></div>
<div class="ttc" id="namespace_q_u_e_s_o_html_aea04e232d5d3dd76349a85bb8acf9e17"><div class="ttname"><a href="namespace_q_u_e_s_o.html#aea04e232d5d3dd76349a85bb8acf9e17">QUESO::matrixProduct</a></div><div class="ttdeci">GslMatrix matrixProduct(const GslVector &amp;v1, const GslVector &amp;v2)</div><div class="ttdef"><b>Definition:</b> <a href="_gsl_matrix_8_c_source.html#l02409">GslMatrix.C:2409</a></div></div>
<div class="ttc" id="class_q_u_e_s_o_1_1_vector_space_html_a92e963bb5cab3eecd290dfe4b8f03b04"><div class="ttname"><a href="class_q_u_e_s_o_1_1_vector_space.html#a92e963bb5cab3eecd290dfe4b8f03b04">QUESO::VectorSpace::zeroVector</a></div><div class="ttdeci">const V &amp; zeroVector() const </div><div class="ttdoc">Returns a vector filled with zeros. </div><div class="ttdef"><b>Definition:</b> <a href="_vector_space_8_c_source.html#l00218">VectorSpace.C:218</a></div></div>
<div class="ttc" id="class_q_u_e_s_o_1_1_m_l_sampling_html_a7bc4c72f65ba9166ed94a6e198b0915b"><div class="ttname"><a href="class_q_u_e_s_o_1_1_m_l_sampling.html#a7bc4c72f65ba9166ed94a6e198b0915b">QUESO::MLSampling::m_vectorSpace</a></div><div class="ttdeci">const VectorSpace&lt; P_V, P_M &gt; &amp; m_vectorSpace</div><div class="ttdoc">Vector space. </div><div class="ttdef"><b>Definition:</b> <a href="_m_l_sampling_8h_source.html#l00451">MLSampling.h:451</a></div></div>
<div class="ttc" id="namespace_q_u_e_s_o_html_a424bc33f2e6e287fd468408d14b772ee"><div class="ttname"><a href="namespace_q_u_e_s_o.html#a424bc33f2e6e287fd468408d14b772ee">QUESO::MiscGetEllapsedSeconds</a></div><div class="ttdeci">double MiscGetEllapsedSeconds(struct timeval *timeval0)</div><div class="ttdef"><b>Definition:</b> <a href="_miscellaneous_8_c_source.html#l00287">Miscellaneous.C:287</a></div></div>
<div class="ttc" id="class_q_u_e_s_o_1_1_base_environment_html_ae106b5bb8a80b655b88b3a26b1e7c185"><div class="ttname"><a href="class_q_u_e_s_o_1_1_base_environment.html#ae106b5bb8a80b655b88b3a26b1e7c185">QUESO::BaseEnvironment::inter0Rank</a></div><div class="ttdeci">int inter0Rank() const </div><div class="ttdoc">Returns the process inter0 rank. </div><div class="ttdef"><b>Definition:</b> <a href="_environment_8_c_source.html#l00289">Environment.C:289</a></div></div>
<div class="ttc" id="class_q_u_e_s_o_1_1_mpi_comm_html_a72e137e60ef8060efb1ee5fc874fa4b8"><div class="ttname"><a href="class_q_u_e_s_o_1_1_mpi_comm.html#a72e137e60ef8060efb1ee5fc874fa4b8">QUESO::MpiComm::Allreduce</a></div><div class="ttdeci">void Allreduce(void *sendbuf, void *recvbuf, int count, RawType_MPI_Datatype datatype, RawType_MPI_Op op, const char *whereMsg, const char *whatMsg) const </div><div class="ttdoc">Combines values from all processes and distributes the result back to all processes. </div><div class="ttdef"><b>Definition:</b> <a href="_mpi_comm_8_c_source.html#l00131">MpiComm.C:131</a></div></div>
<div class="ttc" id="_mpi_comm_8h_html_ad0f503bd9fecfe4e570ca3d15aaf2518"><div class="ttname"><a href="_mpi_comm_8h.html#ad0f503bd9fecfe4e570ca3d15aaf2518">RawValue_MPI_DOUBLE</a></div><div class="ttdeci">#define RawValue_MPI_DOUBLE</div><div class="ttdef"><b>Definition:</b> <a href="_mpi_comm_8h_source.html#l00048">MpiComm.h:48</a></div></div>
<div class="ttc" id="class_q_u_e_s_o_1_1_m_l_sampling_html_a1b1f8ccb4823bdfa26ec652f0807c63e"><div class="ttname"><a href="class_q_u_e_s_o_1_1_m_l_sampling.html#a1b1f8ccb4823bdfa26ec652f0807c63e">QUESO::MLSampling::m_currStep</a></div><div class="ttdeci">unsigned int m_currStep</div><div class="ttdoc">Curret step. </div><div class="ttdef"><b>Definition:</b> <a href="_m_l_sampling_8h_source.html#l00467">MLSampling.h:467</a></div></div>
<div class="ttc" id="class_q_u_e_s_o_1_1_base_environment_html_a1fe5f244fc0316a0ab3e37463f108b96"><div class="ttname"><a href="class_q_u_e_s_o_1_1_base_environment.html#a1fe5f244fc0316a0ab3e37463f108b96">QUESO::BaseEnvironment::displayVerbosity</a></div><div class="ttdeci">unsigned int displayVerbosity() const </div><div class="ttdef"><b>Definition:</b> <a href="_environment_8_c_source.html#l00436">Environment.C:436</a></div></div>
<div class="ttc" id="class_q_u_e_s_o_1_1_base_environment_html_a8a0064746ae8dddfece4229b9ad374d6"><div class="ttname"><a href="class_q_u_e_s_o_1_1_base_environment.html#a8a0064746ae8dddfece4229b9ad374d6">QUESO::BaseEnvironment::subDisplayFile</a></div><div class="ttdeci">std::ofstream * subDisplayFile() const </div><div class="ttdoc">Access function for m_subDisplayFile (displays file on stream). </div><div class="ttdef"><b>Definition:</b> <a href="_environment_8_c_source.html#l00305">Environment.C:305</a></div></div>
<div class="ttc" id="class_q_u_e_s_o_1_1_base_environment_html_a689e4d140c74d495d97eb498714a4b82"><div class="ttname"><a href="class_q_u_e_s_o_1_1_base_environment.html#a689e4d140c74d495d97eb498714a4b82">QUESO::BaseEnvironment::inter0Comm</a></div><div class="ttdeci">const MpiComm &amp; inter0Comm() const </div><div class="ttdoc">Access function for MpiComm inter0-communicator. </div><div class="ttdef"><b>Definition:</b> <a href="_environment_8_c_source.html#l00295">Environment.C:295</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a3db529d364d5bb47916066d7cc21cb00"></a>
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;class P_V , class P_M &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="class_q_u_e_s_o_1_1_m_l_sampling.html">QUESO::MLSampling</a>&lt; P_V, P_M &gt;::generateSequence_Step05_inter0 </td>
          <td>(</td>
          <td class="paramtype">unsigned int&#160;</td>
          <td class="paramname"><em>unifiedRequestedNumSamples</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="class_q_u_e_s_o_1_1_scalar_sequence.html">ScalarSequence</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>weightSequence</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::vector&lt; unsigned int &gt; &amp;&#160;</td>
          <td class="paramname"><em>unifiedIndexCountersAtProc0Only</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::vector&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>unifiedWeightStdVectorAtProc0Only</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Creates <b>unified</b> finite distribution for current level (Step 05 from ML algorithm). </p>
<p>This method is responsible for the Step 05 in the ML algorithm implemented/described in the method <a class="el" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a8d7296b30623c73ada38971cae27994a" title="Method to generate the chain. ">MLSampling&lt;P_V,P_M&gt;::generateSequence</a>.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">unifiedRequestedNumSamples,weightSequence</td><td></td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">unifiedIndexCountersAtProc0Only,unifiedWeightStdVectorAtProc0Only</td><td></td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="_m_l_sampling_8_c_source.html#l03079">3079</a> of file <a class="el" href="_m_l_sampling_8_c_source.html">MLSampling.C</a>.</p>

<p>References <a class="el" href="_scalar_sequence_8_c_source.html#l00252">QUESO::ScalarSequence&lt; T &gt;::getUnifiedContentsAtProc0Only()</a>, <a class="el" href="_m_l_sampling_level_options_8h_source.html#l00028">LEVEL_REF_ID</a>, <a class="el" href="_miscellaneous_8_c_source.html#l00287">QUESO::MiscGetEllapsedSeconds()</a>, <a class="el" href="_scalar_sequence_8_c_source.html#l00141">QUESO::ScalarSequence&lt; T &gt;::subSequenceSize()</a>, <a class="el" href="_scalar_sequence_8_c_source.html#l00148">QUESO::ScalarSequence&lt; T &gt;::unifiedSequenceSize()</a>, <a class="el" href="_defines_8h_source.html#l00222">UQ_FATAL_TEST_MACRO</a>, and <a class="el" href="_defines_8h_source.html#l00075">QUESO::UQ_OK_RC</a>.</p>
<div class="fragment"><div class="line"><a name="l03084"></a><span class="lineno"> 3084</span>&#160;{</div>
<div class="line"><a name="l03085"></a><span class="lineno"> 3085</span>&#160;  <span class="keywordtype">int</span> iRC = <a class="code" href="namespace_q_u_e_s_o.html#a8e909502900aecf24cedba022ea84471">UQ_OK_RC</a>;</div>
<div class="line"><a name="l03086"></a><span class="lineno"> 3086</span>&#160;  <span class="keyword">struct </span>timeval timevalStep;</div>
<div class="line"><a name="l03087"></a><span class="lineno"> 3087</span>&#160;  iRC = gettimeofday(&amp;timevalStep, NULL);</div>
<div class="line"><a name="l03088"></a><span class="lineno"> 3088</span>&#160;  <span class="keywordflow">if</span> (iRC) {}; <span class="comment">// just to remove compiler warning</span></div>
<div class="line"><a name="l03089"></a><span class="lineno"> 3089</span>&#160;</div>
<div class="line"><a name="l03090"></a><span class="lineno"> 3090</span>&#160;      <span class="keywordflow">if</span> ((<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#a8a0064746ae8dddfece4229b9ad374d6">subDisplayFile</a>()) &amp;&amp; (<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#a1fe5f244fc0316a0ab3e37463f108b96">displayVerbosity</a>() &gt;= 0)) {</div>
<div class="line"><a name="l03091"></a><span class="lineno"> 3091</span>&#160;        *<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#a8a0064746ae8dddfece4229b9ad374d6">subDisplayFile</a>() &lt;&lt; <span class="stringliteral">&quot;In MLSampling&lt;P_V,P_M&gt;::generateSequence()&quot;</span></div>
<div class="line"><a name="l03092"></a><span class="lineno"> 3092</span>&#160;                                &lt;&lt; <span class="stringliteral">&quot;, level &quot;</span> &lt;&lt; <a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#af9416874c856e50f3b35270e801f17e4">m_currLevel</a>+<a class="code" href="_m_l_sampling_level_options_8h.html#a68d15eaf394d210effcf584b938206d3">LEVEL_REF_ID</a></div>
<div class="line"><a name="l03093"></a><span class="lineno"> 3093</span>&#160;                                &lt;&lt; <span class="stringliteral">&quot;, step &quot;</span>  &lt;&lt; <a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a1b1f8ccb4823bdfa26ec652f0807c63e">m_currStep</a></div>
<div class="line"><a name="l03094"></a><span class="lineno"> 3094</span>&#160;                                &lt;&lt; <span class="stringliteral">&quot;: beginning step 5 of 11&quot;</span></div>
<div class="line"><a name="l03095"></a><span class="lineno"> 3095</span>&#160;                                &lt;&lt; std::endl;</div>
<div class="line"><a name="l03096"></a><span class="lineno"> 3096</span>&#160;      }</div>
<div class="line"><a name="l03097"></a><span class="lineno"> 3097</span>&#160;</div>
<div class="line"><a name="l03098"></a><span class="lineno"> 3098</span>&#160;<span class="preprocessor">#if 0 // For debug only</span></div>
<div class="line"><a name="l03099"></a><span class="lineno"> 3099</span>&#160;<span class="preprocessor"></span>      <span class="keywordflow">if</span> ((<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#a8a0064746ae8dddfece4229b9ad374d6">subDisplayFile</a>()) &amp;&amp; (<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#a1fe5f244fc0316a0ab3e37463f108b96">displayVerbosity</a>() &gt;= 0)) {</div>
<div class="line"><a name="l03100"></a><span class="lineno"> 3100</span>&#160;        *<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#a8a0064746ae8dddfece4229b9ad374d6">subDisplayFile</a>() &lt;&lt; <span class="stringliteral">&quot;In MLSampling&lt;P_V,P_M&gt;::generateSequence()&quot;</span></div>
<div class="line"><a name="l03101"></a><span class="lineno"> 3101</span>&#160;                                &lt;&lt; <span class="stringliteral">&quot;, level &quot;</span> &lt;&lt; <a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#af9416874c856e50f3b35270e801f17e4">m_currLevel</a>+<a class="code" href="_m_l_sampling_level_options_8h.html#a68d15eaf394d210effcf584b938206d3">LEVEL_REF_ID</a></div>
<div class="line"><a name="l03102"></a><span class="lineno"> 3102</span>&#160;                                &lt;&lt; <span class="stringliteral">&quot;, step &quot;</span>  &lt;&lt; <a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a1b1f8ccb4823bdfa26ec652f0807c63e">m_currStep</a></div>
<div class="line"><a name="l03103"></a><span class="lineno"> 3103</span>&#160;                                &lt;&lt; <span class="stringliteral">&quot;, before weightSequence.getUnifiedContentsAtProc0Only()&quot;</span></div>
<div class="line"><a name="l03104"></a><span class="lineno"> 3104</span>&#160;                                &lt;&lt; <span class="stringliteral">&quot;:&quot;</span></div>
<div class="line"><a name="l03105"></a><span class="lineno"> 3105</span>&#160;                                &lt;&lt; std::endl;</div>
<div class="line"><a name="l03106"></a><span class="lineno"> 3106</span>&#160;      }</div>
<div class="line"><a name="l03107"></a><span class="lineno"> 3107</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = 0; i &lt; weightSequence.<a class="code" href="class_q_u_e_s_o_1_1_scalar_sequence.html#a0288ea295eedc216a1617b3286f6f3a0">subSequenceSize</a>(); ++i) {</div>
<div class="line"><a name="l03108"></a><span class="lineno"> 3108</span>&#160;        <span class="keywordflow">if</span> ((<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#a8a0064746ae8dddfece4229b9ad374d6">subDisplayFile</a>()) &amp;&amp; (<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#a1fe5f244fc0316a0ab3e37463f108b96">displayVerbosity</a>() &gt;= 0)) {</div>
<div class="line"><a name="l03109"></a><span class="lineno"> 3109</span>&#160;          *<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#a8a0064746ae8dddfece4229b9ad374d6">subDisplayFile</a>() &lt;&lt; <span class="stringliteral">&quot;, weightSequence[&quot;</span> &lt;&lt; i</div>
<div class="line"><a name="l03110"></a><span class="lineno"> 3110</span>&#160;                                  &lt;&lt; <span class="stringliteral">&quot;] = &quot;</span>              &lt;&lt; weightSequence[i]</div>
<div class="line"><a name="l03111"></a><span class="lineno"> 3111</span>&#160;                                  &lt;&lt; std::endl;</div>
<div class="line"><a name="l03112"></a><span class="lineno"> 3112</span>&#160;        }</div>
<div class="line"><a name="l03113"></a><span class="lineno"> 3113</span>&#160;      }</div>
<div class="line"><a name="l03114"></a><span class="lineno"> 3114</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l03115"></a><span class="lineno"> 3115</span>&#160;<span class="preprocessor"></span></div>
<div class="line"><a name="l03116"></a><span class="lineno"> 3116</span>&#160;      weightSequence.<a class="code" href="class_q_u_e_s_o_1_1_scalar_sequence.html#ab8802412461496eb72f6c1267507c28c">getUnifiedContentsAtProc0Only</a>(<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a7bc4c72f65ba9166ed94a6e198b0915b">m_vectorSpace</a>.<a class="code" href="class_q_u_e_s_o_1_1_vector_space.html#a67b0c3620662116f5a346fdaa5faf38e">numOfProcsForStorage</a>() == 1,</div>
<div class="line"><a name="l03117"></a><span class="lineno"> 3117</span>&#160;                                                   unifiedWeightStdVectorAtProc0Only);</div>
<div class="line"><a name="l03118"></a><span class="lineno"> 3118</span>&#160;</div>
<div class="line"><a name="l03119"></a><span class="lineno"> 3119</span>&#160;<span class="preprocessor">#if 0 // For debug only</span></div>
<div class="line"><a name="l03120"></a><span class="lineno"> 3120</span>&#160;<span class="preprocessor"></span>      <span class="keywordflow">if</span> ((<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#a8a0064746ae8dddfece4229b9ad374d6">subDisplayFile</a>()) &amp;&amp; (<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#a1fe5f244fc0316a0ab3e37463f108b96">displayVerbosity</a>() &gt;= 0)) {</div>
<div class="line"><a name="l03121"></a><span class="lineno"> 3121</span>&#160;        *<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#a8a0064746ae8dddfece4229b9ad374d6">subDisplayFile</a>() &lt;&lt; <span class="stringliteral">&quot;In MLSampling&lt;P_V,P_M&gt;::generateSequence()&quot;</span></div>
<div class="line"><a name="l03122"></a><span class="lineno"> 3122</span>&#160;                                &lt;&lt; <span class="stringliteral">&quot;, level &quot;</span> &lt;&lt; <a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#af9416874c856e50f3b35270e801f17e4">m_currLevel</a>+<a class="code" href="_m_l_sampling_level_options_8h.html#a68d15eaf394d210effcf584b938206d3">LEVEL_REF_ID</a></div>
<div class="line"><a name="l03123"></a><span class="lineno"> 3123</span>&#160;                                &lt;&lt; <span class="stringliteral">&quot;, step &quot;</span>  &lt;&lt; <a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a1b1f8ccb4823bdfa26ec652f0807c63e">m_currStep</a></div>
<div class="line"><a name="l03124"></a><span class="lineno"> 3124</span>&#160;                                &lt;&lt; <span class="stringliteral">&quot;, after weightSequence.getUnifiedContentsAtProc0Only()&quot;</span></div>
<div class="line"><a name="l03125"></a><span class="lineno"> 3125</span>&#160;                                &lt;&lt; <span class="stringliteral">&quot;:&quot;</span></div>
<div class="line"><a name="l03126"></a><span class="lineno"> 3126</span>&#160;                                &lt;&lt; std::endl;</div>
<div class="line"><a name="l03127"></a><span class="lineno"> 3127</span>&#160;      }</div>
<div class="line"><a name="l03128"></a><span class="lineno"> 3128</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = 0; i &lt; unifiedWeightStdVectorAtProc0Only.size(); ++i) {</div>
<div class="line"><a name="l03129"></a><span class="lineno"> 3129</span>&#160;        <span class="keywordflow">if</span> ((<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#a8a0064746ae8dddfece4229b9ad374d6">subDisplayFile</a>()) &amp;&amp; (<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#a1fe5f244fc0316a0ab3e37463f108b96">displayVerbosity</a>() &gt;= 0)) {</div>
<div class="line"><a name="l03130"></a><span class="lineno"> 3130</span>&#160;          *<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#a8a0064746ae8dddfece4229b9ad374d6">subDisplayFile</a>() &lt;&lt; <span class="stringliteral">&quot;  unifiedWeightStdVectorAtProc0Only[&quot;</span> &lt;&lt; i</div>
<div class="line"><a name="l03131"></a><span class="lineno"> 3131</span>&#160;                                  &lt;&lt; <span class="stringliteral">&quot;] = &quot;</span>                                 &lt;&lt; unifiedWeightStdVectorAtProc0Only[i]</div>
<div class="line"><a name="l03132"></a><span class="lineno"> 3132</span>&#160;                                  &lt;&lt; std::endl;</div>
<div class="line"><a name="l03133"></a><span class="lineno"> 3133</span>&#160;        }</div>
<div class="line"><a name="l03134"></a><span class="lineno"> 3134</span>&#160;      }</div>
<div class="line"><a name="l03135"></a><span class="lineno"> 3135</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l03136"></a><span class="lineno"> 3136</span>&#160;<span class="preprocessor"></span>      <a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#af71979655e46135b6a3c97b8909321f0">sampleIndexes_proc0</a>(unifiedRequestedNumSamples,        <span class="comment">// input</span></div>
<div class="line"><a name="l03137"></a><span class="lineno"> 3137</span>&#160;                          unifiedWeightStdVectorAtProc0Only, <span class="comment">// input</span></div>
<div class="line"><a name="l03138"></a><span class="lineno"> 3138</span>&#160;                          unifiedIndexCountersAtProc0Only);  <span class="comment">// output</span></div>
<div class="line"><a name="l03139"></a><span class="lineno"> 3139</span>&#160;</div>
<div class="line"><a name="l03140"></a><span class="lineno"> 3140</span>&#160;      <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> auxUnifiedSize = weightSequence.<a class="code" href="class_q_u_e_s_o_1_1_scalar_sequence.html#a52829afc95e5c36e9db44f40854153b0">unifiedSequenceSize</a>(<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a7bc4c72f65ba9166ed94a6e198b0915b">m_vectorSpace</a>.<a class="code" href="class_q_u_e_s_o_1_1_vector_space.html#a67b0c3620662116f5a346fdaa5faf38e">numOfProcsForStorage</a>() == 1);</div>
<div class="line"><a name="l03141"></a><span class="lineno"> 3141</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#ae106b5bb8a80b655b88b3a26b1e7c185">inter0Rank</a>() == 0) {</div>
<div class="line"><a name="l03142"></a><span class="lineno"> 3142</span>&#160;        <a class="code" href="_defines_8h.html#a56d63d18d0a6d45757de47fcc06f574d">UQ_FATAL_TEST_MACRO</a>(unifiedIndexCountersAtProc0Only.size() != auxUnifiedSize,</div>
<div class="line"><a name="l03143"></a><span class="lineno"> 3143</span>&#160;                            <a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#a78b57112bbd0e6dd0e8afec00b40ffa7">worldRank</a>(),</div>
<div class="line"><a name="l03144"></a><span class="lineno"> 3144</span>&#160;                            <span class="stringliteral">&quot;MLSampling&lt;P_V,P_M&gt;::generateSequence()&quot;</span>,</div>
<div class="line"><a name="l03145"></a><span class="lineno"> 3145</span>&#160;                            <span class="stringliteral">&quot;wrong output from sampleIndexesAtProc0() in step 5&quot;</span>);</div>
<div class="line"><a name="l03146"></a><span class="lineno"> 3146</span>&#160;      }</div>
<div class="line"><a name="l03147"></a><span class="lineno"> 3147</span>&#160;</div>
<div class="line"><a name="l03148"></a><span class="lineno"> 3148</span>&#160;  <span class="keywordtype">double</span> stepRunTime = <a class="code" href="namespace_q_u_e_s_o.html#a424bc33f2e6e287fd468408d14b772ee">MiscGetEllapsedSeconds</a>(&amp;timevalStep);</div>
<div class="line"><a name="l03149"></a><span class="lineno"> 3149</span>&#160;  <span class="keywordflow">if</span> ((<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#a8a0064746ae8dddfece4229b9ad374d6">subDisplayFile</a>()) &amp;&amp; (<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#a1fe5f244fc0316a0ab3e37463f108b96">displayVerbosity</a>() &gt;= 0)) {</div>
<div class="line"><a name="l03150"></a><span class="lineno"> 3150</span>&#160;    *<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#a8a0064746ae8dddfece4229b9ad374d6">subDisplayFile</a>() &lt;&lt; <span class="stringliteral">&quot;Leaving MLSampling&lt;P_V,P_M&gt;::generateSequence_Step()&quot;</span></div>
<div class="line"><a name="l03151"></a><span class="lineno"> 3151</span>&#160;                            &lt;&lt; <span class="stringliteral">&quot;, level &quot;</span> &lt;&lt; <a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#af9416874c856e50f3b35270e801f17e4">m_currLevel</a>+<a class="code" href="_m_l_sampling_level_options_8h.html#a68d15eaf394d210effcf584b938206d3">LEVEL_REF_ID</a></div>
<div class="line"><a name="l03152"></a><span class="lineno"> 3152</span>&#160;                            &lt;&lt; <span class="stringliteral">&quot;, step &quot;</span>  &lt;&lt; <a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a1b1f8ccb4823bdfa26ec652f0807c63e">m_currStep</a></div>
<div class="line"><a name="l03153"></a><span class="lineno"> 3153</span>&#160;                            &lt;&lt; <span class="stringliteral">&quot;, after &quot;</span> &lt;&lt; stepRunTime &lt;&lt; <span class="stringliteral">&quot; seconds&quot;</span></div>
<div class="line"><a name="l03154"></a><span class="lineno"> 3154</span>&#160;                            &lt;&lt; std::endl;</div>
<div class="line"><a name="l03155"></a><span class="lineno"> 3155</span>&#160;  }</div>
<div class="line"><a name="l03156"></a><span class="lineno"> 3156</span>&#160;</div>
<div class="line"><a name="l03157"></a><span class="lineno"> 3157</span>&#160;  <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l03158"></a><span class="lineno"> 3158</span>&#160;}</div>
<div class="ttc" id="class_q_u_e_s_o_1_1_m_l_sampling_html_a13f1ca4fe9f94822fe572a743eaced1d"><div class="ttname"><a href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">QUESO::MLSampling::m_env</a></div><div class="ttdeci">const BaseEnvironment &amp; m_env</div><div class="ttdoc">Queso enviroment. </div><div class="ttdef"><b>Definition:</b> <a href="_m_l_sampling_8h_source.html#l00442">MLSampling.h:442</a></div></div>
<div class="ttc" id="class_q_u_e_s_o_1_1_base_environment_html_a78b57112bbd0e6dd0e8afec00b40ffa7"><div class="ttname"><a href="class_q_u_e_s_o_1_1_base_environment.html#a78b57112bbd0e6dd0e8afec00b40ffa7">QUESO::BaseEnvironment::worldRank</a></div><div class="ttdeci">int worldRank() const </div><div class="ttdoc">Returns the process world rank. </div><div class="ttdef"><b>Definition:</b> <a href="_environment_8_c_source.html#l00235">Environment.C:235</a></div></div>
<div class="ttc" id="namespace_q_u_e_s_o_html_a8e909502900aecf24cedba022ea84471"><div class="ttname"><a href="namespace_q_u_e_s_o.html#a8e909502900aecf24cedba022ea84471">QUESO::UQ_OK_RC</a></div><div class="ttdeci">const int UQ_OK_RC</div><div class="ttdef"><b>Definition:</b> <a href="_defines_8h_source.html#l00075">Defines.h:75</a></div></div>
<div class="ttc" id="class_q_u_e_s_o_1_1_m_l_sampling_html_af71979655e46135b6a3c97b8909321f0"><div class="ttname"><a href="class_q_u_e_s_o_1_1_m_l_sampling.html#af71979655e46135b6a3c97b8909321f0">QUESO::MLSampling::sampleIndexes_proc0</a></div><div class="ttdeci">void sampleIndexes_proc0(unsigned int unifiedRequestedNumSamples, const std::vector&lt; double &gt; &amp;unifiedWeightStdVectorAtProc0Only, std::vector&lt; unsigned int &gt; &amp;unifiedIndexCountersAtProc0Only)</div><div class="ttdef"><b>Definition:</b> <a href="_m_l_sampling_8_c_source.html#l00093">MLSampling.C:93</a></div></div>
<div class="ttc" id="class_q_u_e_s_o_1_1_vector_space_html_a67b0c3620662116f5a346fdaa5faf38e"><div class="ttname"><a href="class_q_u_e_s_o_1_1_vector_space.html#a67b0c3620662116f5a346fdaa5faf38e">QUESO::VectorSpace::numOfProcsForStorage</a></div><div class="ttdeci">unsigned int numOfProcsForStorage() const </div><div class="ttdoc">Returns total number of processes. </div><div class="ttdef"><b>Definition:</b> <a href="_vector_space_8_c_source.html#l00193">VectorSpace.C:193</a></div></div>
<div class="ttc" id="class_q_u_e_s_o_1_1_scalar_sequence_html_ab8802412461496eb72f6c1267507c28c"><div class="ttname"><a href="class_q_u_e_s_o_1_1_scalar_sequence.html#ab8802412461496eb72f6c1267507c28c">QUESO::ScalarSequence::getUnifiedContentsAtProc0Only</a></div><div class="ttdeci">void getUnifiedContentsAtProc0Only(bool useOnlyInter0Comm, std::vector&lt; T &gt; &amp;outputVec) const </div><div class="ttdoc">Gets the unified contents of processor of rank equals to 0. </div><div class="ttdef"><b>Definition:</b> <a href="_scalar_sequence_8_c_source.html#l00252">ScalarSequence.C:252</a></div></div>
<div class="ttc" id="class_q_u_e_s_o_1_1_m_l_sampling_html_af9416874c856e50f3b35270e801f17e4"><div class="ttname"><a href="class_q_u_e_s_o_1_1_m_l_sampling.html#af9416874c856e50f3b35270e801f17e4">QUESO::MLSampling::m_currLevel</a></div><div class="ttdeci">unsigned int m_currLevel</div><div class="ttdoc">Current level. </div><div class="ttdef"><b>Definition:</b> <a href="_m_l_sampling_8h_source.html#l00464">MLSampling.h:464</a></div></div>
<div class="ttc" id="_m_l_sampling_level_options_8h_html_a68d15eaf394d210effcf584b938206d3"><div class="ttname"><a href="_m_l_sampling_level_options_8h.html#a68d15eaf394d210effcf584b938206d3">LEVEL_REF_ID</a></div><div class="ttdeci">#define LEVEL_REF_ID</div><div class="ttdef"><b>Definition:</b> <a href="_m_l_sampling_level_options_8h_source.html#l00028">MLSamplingLevelOptions.h:28</a></div></div>
<div class="ttc" id="class_q_u_e_s_o_1_1_scalar_sequence_html_a0288ea295eedc216a1617b3286f6f3a0"><div class="ttname"><a href="class_q_u_e_s_o_1_1_scalar_sequence.html#a0288ea295eedc216a1617b3286f6f3a0">QUESO::ScalarSequence::subSequenceSize</a></div><div class="ttdeci">unsigned int subSequenceSize() const </div><div class="ttdoc">Size of the sub-sequence of scalars. </div><div class="ttdef"><b>Definition:</b> <a href="_scalar_sequence_8_c_source.html#l00141">ScalarSequence.C:141</a></div></div>
<div class="ttc" id="class_q_u_e_s_o_1_1_scalar_sequence_html_a52829afc95e5c36e9db44f40854153b0"><div class="ttname"><a href="class_q_u_e_s_o_1_1_scalar_sequence.html#a52829afc95e5c36e9db44f40854153b0">QUESO::ScalarSequence::unifiedSequenceSize</a></div><div class="ttdeci">unsigned int unifiedSequenceSize(bool useOnlyInter0Comm) const </div><div class="ttdoc">Size of the unified sequence of scalars. </div><div class="ttdef"><b>Definition:</b> <a href="_scalar_sequence_8_c_source.html#l00148">ScalarSequence.C:148</a></div></div>
<div class="ttc" id="class_q_u_e_s_o_1_1_m_l_sampling_html_a7bc4c72f65ba9166ed94a6e198b0915b"><div class="ttname"><a href="class_q_u_e_s_o_1_1_m_l_sampling.html#a7bc4c72f65ba9166ed94a6e198b0915b">QUESO::MLSampling::m_vectorSpace</a></div><div class="ttdeci">const VectorSpace&lt; P_V, P_M &gt; &amp; m_vectorSpace</div><div class="ttdoc">Vector space. </div><div class="ttdef"><b>Definition:</b> <a href="_m_l_sampling_8h_source.html#l00451">MLSampling.h:451</a></div></div>
<div class="ttc" id="namespace_q_u_e_s_o_html_a424bc33f2e6e287fd468408d14b772ee"><div class="ttname"><a href="namespace_q_u_e_s_o.html#a424bc33f2e6e287fd468408d14b772ee">QUESO::MiscGetEllapsedSeconds</a></div><div class="ttdeci">double MiscGetEllapsedSeconds(struct timeval *timeval0)</div><div class="ttdef"><b>Definition:</b> <a href="_miscellaneous_8_c_source.html#l00287">Miscellaneous.C:287</a></div></div>
<div class="ttc" id="class_q_u_e_s_o_1_1_base_environment_html_ae106b5bb8a80b655b88b3a26b1e7c185"><div class="ttname"><a href="class_q_u_e_s_o_1_1_base_environment.html#ae106b5bb8a80b655b88b3a26b1e7c185">QUESO::BaseEnvironment::inter0Rank</a></div><div class="ttdeci">int inter0Rank() const </div><div class="ttdoc">Returns the process inter0 rank. </div><div class="ttdef"><b>Definition:</b> <a href="_environment_8_c_source.html#l00289">Environment.C:289</a></div></div>
<div class="ttc" id="_defines_8h_html_a56d63d18d0a6d45757de47fcc06f574d"><div class="ttname"><a href="_defines_8h.html#a56d63d18d0a6d45757de47fcc06f574d">UQ_FATAL_TEST_MACRO</a></div><div class="ttdeci">#define UQ_FATAL_TEST_MACRO(test, givenRank, where, what)</div><div class="ttdef"><b>Definition:</b> <a href="_defines_8h_source.html#l00222">Defines.h:222</a></div></div>
<div class="ttc" id="class_q_u_e_s_o_1_1_m_l_sampling_html_a1b1f8ccb4823bdfa26ec652f0807c63e"><div class="ttname"><a href="class_q_u_e_s_o_1_1_m_l_sampling.html#a1b1f8ccb4823bdfa26ec652f0807c63e">QUESO::MLSampling::m_currStep</a></div><div class="ttdeci">unsigned int m_currStep</div><div class="ttdoc">Curret step. </div><div class="ttdef"><b>Definition:</b> <a href="_m_l_sampling_8h_source.html#l00467">MLSampling.h:467</a></div></div>
<div class="ttc" id="class_q_u_e_s_o_1_1_base_environment_html_a1fe5f244fc0316a0ab3e37463f108b96"><div class="ttname"><a href="class_q_u_e_s_o_1_1_base_environment.html#a1fe5f244fc0316a0ab3e37463f108b96">QUESO::BaseEnvironment::displayVerbosity</a></div><div class="ttdeci">unsigned int displayVerbosity() const </div><div class="ttdef"><b>Definition:</b> <a href="_environment_8_c_source.html#l00436">Environment.C:436</a></div></div>
<div class="ttc" id="class_q_u_e_s_o_1_1_base_environment_html_a8a0064746ae8dddfece4229b9ad374d6"><div class="ttname"><a href="class_q_u_e_s_o_1_1_base_environment.html#a8a0064746ae8dddfece4229b9ad374d6">QUESO::BaseEnvironment::subDisplayFile</a></div><div class="ttdeci">std::ofstream * subDisplayFile() const </div><div class="ttdoc">Access function for m_subDisplayFile (displays file on stream). </div><div class="ttdef"><b>Definition:</b> <a href="_environment_8_c_source.html#l00305">Environment.C:305</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a21f642100e0690f65563e2c1f8bed816"></a>
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;class P_V , class P_M &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="class_q_u_e_s_o_1_1_m_l_sampling.html">QUESO::MLSampling</a>&lt; P_V, P_M &gt;::generateSequence_Step06_all </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="class_q_u_e_s_o_1_1_m_l_sampling_level_options.html">MLSamplingLevelOptions</a> *&#160;</td>
          <td class="paramname"><em>currOptions</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned int&#160;</td>
          <td class="paramname"><em>indexOfFirstWeight</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned int&#160;</td>
          <td class="paramname"><em>indexOfLastWeight</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::vector&lt; unsigned int &gt; &amp;&#160;</td>
          <td class="paramname"><em>unifiedIndexCountersAtProc0Only</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool &amp;&#160;</td>
          <td class="paramname"><em>useBalancedChains</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::vector&lt; <a class="el" href="struct_q_u_e_s_o_1_1_exchange_info_struct.html">ExchangeInfoStruct</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>exchangeStdVec</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Decides on wheter or not to use balanced chains (Step 06 from ML algorithm). </p>
<p>This method is responsible for the Step 06 in the ML algorithm implemented/described in the method <a class="el" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a8d7296b30623c73ada38971cae27994a" title="Method to generate the chain. ">MLSampling&lt;P_V,P_M&gt;::generateSequence</a>.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">currOptions,indexOfFirstWeight,indexOfLastWeight,unifiedIndexCountersAtProc0Only</td><td></td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">useBalancedChains,exchangeStdVec</td><td></td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="_m_l_sampling_8_c_source.html#l03162">3162</a> of file <a class="el" href="_m_l_sampling_8_c_source.html">MLSampling.C</a>.</p>

<p>References <a class="el" href="_m_l_sampling_level_options_8h_source.html#l00028">LEVEL_REF_ID</a>, <a class="el" href="_miscellaneous_8_c_source.html#l00287">QUESO::MiscGetEllapsedSeconds()</a>, and <a class="el" href="_defines_8h_source.html#l00075">QUESO::UQ_OK_RC</a>.</p>
<div class="fragment"><div class="line"><a name="l03169"></a><span class="lineno"> 3169</span>&#160;{</div>
<div class="line"><a name="l03170"></a><span class="lineno"> 3170</span>&#160;  <span class="keywordtype">int</span> iRC = <a class="code" href="namespace_q_u_e_s_o.html#a8e909502900aecf24cedba022ea84471">UQ_OK_RC</a>;</div>
<div class="line"><a name="l03171"></a><span class="lineno"> 3171</span>&#160;  <span class="keyword">struct </span>timeval timevalStep;</div>
<div class="line"><a name="l03172"></a><span class="lineno"> 3172</span>&#160;  iRC = gettimeofday(&amp;timevalStep, NULL);</div>
<div class="line"><a name="l03173"></a><span class="lineno"> 3173</span>&#160;  <span class="keywordflow">if</span> (iRC) {}; <span class="comment">// just to remove compiler warning</span></div>
<div class="line"><a name="l03174"></a><span class="lineno"> 3174</span>&#160;</div>
<div class="line"><a name="l03175"></a><span class="lineno"> 3175</span>&#160;  useBalancedChains = <a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a0f6f7872635b9546b3215fee347601f6">decideOnBalancedChains_all</a>(currOptions,                     <span class="comment">// input</span></div>
<div class="line"><a name="l03176"></a><span class="lineno"> 3176</span>&#160;                                                 indexOfFirstWeight,              <span class="comment">// input</span></div>
<div class="line"><a name="l03177"></a><span class="lineno"> 3177</span>&#160;                                                 indexOfLastWeight,               <span class="comment">// input</span></div>
<div class="line"><a name="l03178"></a><span class="lineno"> 3178</span>&#160;                                                 unifiedIndexCountersAtProc0Only, <span class="comment">// input</span></div>
<div class="line"><a name="l03179"></a><span class="lineno"> 3179</span>&#160;                                                 exchangeStdVec);                 <span class="comment">// output</span></div>
<div class="line"><a name="l03180"></a><span class="lineno"> 3180</span>&#160;</div>
<div class="line"><a name="l03181"></a><span class="lineno"> 3181</span>&#160;  <span class="keywordtype">double</span> stepRunTime = <a class="code" href="namespace_q_u_e_s_o.html#a424bc33f2e6e287fd468408d14b772ee">MiscGetEllapsedSeconds</a>(&amp;timevalStep);</div>
<div class="line"><a name="l03182"></a><span class="lineno"> 3182</span>&#160;  <span class="keywordflow">if</span> ((<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#a8a0064746ae8dddfece4229b9ad374d6">subDisplayFile</a>()) &amp;&amp; (<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#a1fe5f244fc0316a0ab3e37463f108b96">displayVerbosity</a>() &gt;= 0)) {</div>
<div class="line"><a name="l03183"></a><span class="lineno"> 3183</span>&#160;    *<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#a8a0064746ae8dddfece4229b9ad374d6">subDisplayFile</a>() &lt;&lt; <span class="stringliteral">&quot;Leaving MLSampling&lt;P_V,P_M&gt;::generateSequence_Step()&quot;</span></div>
<div class="line"><a name="l03184"></a><span class="lineno"> 3184</span>&#160;                            &lt;&lt; <span class="stringliteral">&quot;, level &quot;</span> &lt;&lt; <a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#af9416874c856e50f3b35270e801f17e4">m_currLevel</a>+<a class="code" href="_m_l_sampling_level_options_8h.html#a68d15eaf394d210effcf584b938206d3">LEVEL_REF_ID</a></div>
<div class="line"><a name="l03185"></a><span class="lineno"> 3185</span>&#160;                            &lt;&lt; <span class="stringliteral">&quot;, step &quot;</span>  &lt;&lt; <a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a1b1f8ccb4823bdfa26ec652f0807c63e">m_currStep</a></div>
<div class="line"><a name="l03186"></a><span class="lineno"> 3186</span>&#160;                            &lt;&lt; <span class="stringliteral">&quot;, after &quot;</span> &lt;&lt; stepRunTime &lt;&lt; <span class="stringliteral">&quot; seconds&quot;</span></div>
<div class="line"><a name="l03187"></a><span class="lineno"> 3187</span>&#160;                            &lt;&lt; std::endl;</div>
<div class="line"><a name="l03188"></a><span class="lineno"> 3188</span>&#160;  }</div>
<div class="line"><a name="l03189"></a><span class="lineno"> 3189</span>&#160;</div>
<div class="line"><a name="l03190"></a><span class="lineno"> 3190</span>&#160;  <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l03191"></a><span class="lineno"> 3191</span>&#160;}</div>
<div class="ttc" id="class_q_u_e_s_o_1_1_m_l_sampling_html_a13f1ca4fe9f94822fe572a743eaced1d"><div class="ttname"><a href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">QUESO::MLSampling::m_env</a></div><div class="ttdeci">const BaseEnvironment &amp; m_env</div><div class="ttdoc">Queso enviroment. </div><div class="ttdef"><b>Definition:</b> <a href="_m_l_sampling_8h_source.html#l00442">MLSampling.h:442</a></div></div>
<div class="ttc" id="namespace_q_u_e_s_o_html_a8e909502900aecf24cedba022ea84471"><div class="ttname"><a href="namespace_q_u_e_s_o.html#a8e909502900aecf24cedba022ea84471">QUESO::UQ_OK_RC</a></div><div class="ttdeci">const int UQ_OK_RC</div><div class="ttdef"><b>Definition:</b> <a href="_defines_8h_source.html#l00075">Defines.h:75</a></div></div>
<div class="ttc" id="class_q_u_e_s_o_1_1_m_l_sampling_html_a0f6f7872635b9546b3215fee347601f6"><div class="ttname"><a href="class_q_u_e_s_o_1_1_m_l_sampling.html#a0f6f7872635b9546b3215fee347601f6">QUESO::MLSampling::decideOnBalancedChains_all</a></div><div class="ttdeci">bool decideOnBalancedChains_all(const MLSamplingLevelOptions *currOptions, unsigned int indexOfFirstWeight, unsigned int indexOfLastWeight, const std::vector&lt; unsigned int &gt; &amp;unifiedIndexCountersAtProc0Only, std::vector&lt; ExchangeInfoStruct &gt; &amp;exchangeStdVec)</div><div class="ttdef"><b>Definition:</b> <a href="_m_l_sampling_8_c_source.html#l00147">MLSampling.C:147</a></div></div>
<div class="ttc" id="class_q_u_e_s_o_1_1_m_l_sampling_html_af9416874c856e50f3b35270e801f17e4"><div class="ttname"><a href="class_q_u_e_s_o_1_1_m_l_sampling.html#af9416874c856e50f3b35270e801f17e4">QUESO::MLSampling::m_currLevel</a></div><div class="ttdeci">unsigned int m_currLevel</div><div class="ttdoc">Current level. </div><div class="ttdef"><b>Definition:</b> <a href="_m_l_sampling_8h_source.html#l00464">MLSampling.h:464</a></div></div>
<div class="ttc" id="_m_l_sampling_level_options_8h_html_a68d15eaf394d210effcf584b938206d3"><div class="ttname"><a href="_m_l_sampling_level_options_8h.html#a68d15eaf394d210effcf584b938206d3">LEVEL_REF_ID</a></div><div class="ttdeci">#define LEVEL_REF_ID</div><div class="ttdef"><b>Definition:</b> <a href="_m_l_sampling_level_options_8h_source.html#l00028">MLSamplingLevelOptions.h:28</a></div></div>
<div class="ttc" id="namespace_q_u_e_s_o_html_a424bc33f2e6e287fd468408d14b772ee"><div class="ttname"><a href="namespace_q_u_e_s_o.html#a424bc33f2e6e287fd468408d14b772ee">QUESO::MiscGetEllapsedSeconds</a></div><div class="ttdeci">double MiscGetEllapsedSeconds(struct timeval *timeval0)</div><div class="ttdef"><b>Definition:</b> <a href="_miscellaneous_8_c_source.html#l00287">Miscellaneous.C:287</a></div></div>
<div class="ttc" id="class_q_u_e_s_o_1_1_m_l_sampling_html_a1b1f8ccb4823bdfa26ec652f0807c63e"><div class="ttname"><a href="class_q_u_e_s_o_1_1_m_l_sampling.html#a1b1f8ccb4823bdfa26ec652f0807c63e">QUESO::MLSampling::m_currStep</a></div><div class="ttdeci">unsigned int m_currStep</div><div class="ttdoc">Curret step. </div><div class="ttdef"><b>Definition:</b> <a href="_m_l_sampling_8h_source.html#l00467">MLSampling.h:467</a></div></div>
<div class="ttc" id="class_q_u_e_s_o_1_1_base_environment_html_a1fe5f244fc0316a0ab3e37463f108b96"><div class="ttname"><a href="class_q_u_e_s_o_1_1_base_environment.html#a1fe5f244fc0316a0ab3e37463f108b96">QUESO::BaseEnvironment::displayVerbosity</a></div><div class="ttdeci">unsigned int displayVerbosity() const </div><div class="ttdef"><b>Definition:</b> <a href="_environment_8_c_source.html#l00436">Environment.C:436</a></div></div>
<div class="ttc" id="class_q_u_e_s_o_1_1_base_environment_html_a8a0064746ae8dddfece4229b9ad374d6"><div class="ttname"><a href="class_q_u_e_s_o_1_1_base_environment.html#a8a0064746ae8dddfece4229b9ad374d6">QUESO::BaseEnvironment::subDisplayFile</a></div><div class="ttdeci">std::ofstream * subDisplayFile() const </div><div class="ttdoc">Access function for m_subDisplayFile (displays file on stream). </div><div class="ttdef"><b>Definition:</b> <a href="_environment_8_c_source.html#l00305">Environment.C:305</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a270d639f90f6f2c60d1af851eea63d41"></a>
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;class P_V , class P_M &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="class_q_u_e_s_o_1_1_m_l_sampling.html">QUESO::MLSampling</a>&lt; P_V, P_M &gt;::generateSequence_Step07_inter0 </td>
          <td>(</td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>useBalancedChains</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned int&#160;</td>
          <td class="paramname"><em>indexOfFirstWeight</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned int&#160;</td>
          <td class="paramname"><em>indexOfLastWeight</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::vector&lt; unsigned int &gt; &amp;&#160;</td>
          <td class="paramname"><em>unifiedIndexCountersAtProc0Only</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct_q_u_e_s_o_1_1_unbalanced_linked_chains_per_node_struct.html">UnbalancedLinkedChainsPerNodeStruct</a> &amp;&#160;</td>
          <td class="paramname"><em>unbalancedLinkControl</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="class_q_u_e_s_o_1_1_m_l_sampling_level_options.html">MLSamplingLevelOptions</a> *&#160;</td>
          <td class="paramname"><em>currOptions</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="class_q_u_e_s_o_1_1_sequence_of_vectors.html">SequenceOfVectors</a>&lt; P_V, P_M &gt; &amp;&#160;</td>
          <td class="paramname"><em>prevChain</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::vector&lt; <a class="el" href="struct_q_u_e_s_o_1_1_exchange_info_struct.html">ExchangeInfoStruct</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>exchangeStdVec</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct_q_u_e_s_o_1_1_balanced_linked_chains_per_node_struct.html">BalancedLinkedChainsPerNodeStruct</a>&lt; P_V &gt; &amp;&#160;</td>
          <td class="paramname"><em>balancedLinkControl</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Plans for number of linked chains for each node so that all nodes generate the closest possible to the same number of positions (Step 07 from ML algorithm). </p>
<p>This method is responsible for the Step 07 in the ML algorithm implemented/described in the method <a class="el" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a8d7296b30623c73ada38971cae27994a" title="Method to generate the chain. ">MLSampling&lt;P_V,P_M&gt;::generateSequence</a>.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">useBalancedChains,indexOfFirstWeight,indexOfLastWeight,unifiedIndexCountersAtProc0Only,currOptions,prevChain</td><td></td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">exchangeStdVec</td><td></td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">unbalancedLinkControl,balancedLinkControl</td><td></td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="_m_l_sampling_8_c_source.html#l03195">3195</a> of file <a class="el" href="_m_l_sampling_8_c_source.html">MLSampling.C</a>.</p>

<p>References <a class="el" href="_m_l_sampling_8h_source.html#l00084">QUESO::BalancedLinkedChainsPerNodeStruct&lt; P_V &gt;::balLinkedChains</a>, <a class="el" href="_m_l_sampling_level_options_8h_source.html#l00028">LEVEL_REF_ID</a>, <a class="el" href="_miscellaneous_8_c_source.html#l00287">QUESO::MiscGetEllapsedSeconds()</a>, <a class="el" href="_m_l_sampling_8h_source.html#l00097">QUESO::UnbalancedLinkedChainsPerNodeStruct::unbLinkedChains</a>, and <a class="el" href="_defines_8h_source.html#l00075">QUESO::UQ_OK_RC</a>.</p>
<div class="fragment"><div class="line"><a name="l03205"></a><span class="lineno"> 3205</span>&#160;{</div>
<div class="line"><a name="l03206"></a><span class="lineno"> 3206</span>&#160;  <span class="keywordtype">int</span> iRC = <a class="code" href="namespace_q_u_e_s_o.html#a8e909502900aecf24cedba022ea84471">UQ_OK_RC</a>;</div>
<div class="line"><a name="l03207"></a><span class="lineno"> 3207</span>&#160;  <span class="keyword">struct </span>timeval timevalStep;</div>
<div class="line"><a name="l03208"></a><span class="lineno"> 3208</span>&#160;  iRC = gettimeofday(&amp;timevalStep, NULL);</div>
<div class="line"><a name="l03209"></a><span class="lineno"> 3209</span>&#160;  <span class="keywordflow">if</span> (iRC) {}; <span class="comment">// just to remove compiler warning</span></div>
<div class="line"><a name="l03210"></a><span class="lineno"> 3210</span>&#160;</div>
<div class="line"><a name="l03211"></a><span class="lineno"> 3211</span>&#160;      <span class="keywordflow">if</span> ((<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#a8a0064746ae8dddfece4229b9ad374d6">subDisplayFile</a>()) &amp;&amp; (<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#a1fe5f244fc0316a0ab3e37463f108b96">displayVerbosity</a>() &gt;= 0)) {</div>
<div class="line"><a name="l03212"></a><span class="lineno"> 3212</span>&#160;        *<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#a8a0064746ae8dddfece4229b9ad374d6">subDisplayFile</a>() &lt;&lt; <span class="stringliteral">&quot;In MLSampling&lt;P_V,P_M&gt;::generateSequence()&quot;</span></div>
<div class="line"><a name="l03213"></a><span class="lineno"> 3213</span>&#160;                                &lt;&lt; <span class="stringliteral">&quot;, level &quot;</span> &lt;&lt; <a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#af9416874c856e50f3b35270e801f17e4">m_currLevel</a>+<a class="code" href="_m_l_sampling_level_options_8h.html#a68d15eaf394d210effcf584b938206d3">LEVEL_REF_ID</a></div>
<div class="line"><a name="l03214"></a><span class="lineno"> 3214</span>&#160;                                &lt;&lt; <span class="stringliteral">&quot;, step &quot;</span>  &lt;&lt; <a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a1b1f8ccb4823bdfa26ec652f0807c63e">m_currStep</a></div>
<div class="line"><a name="l03215"></a><span class="lineno"> 3215</span>&#160;                                &lt;&lt; <span class="stringliteral">&quot;: beginning step 7 of 11&quot;</span></div>
<div class="line"><a name="l03216"></a><span class="lineno"> 3216</span>&#160;                                &lt;&lt; std::endl;</div>
<div class="line"><a name="l03217"></a><span class="lineno"> 3217</span>&#160;      }</div>
<div class="line"><a name="l03218"></a><span class="lineno"> 3218</span>&#160;</div>
<div class="line"><a name="l03219"></a><span class="lineno"> 3219</span>&#160;      <span class="keywordflow">if</span> (useBalancedChains) {</div>
<div class="line"><a name="l03220"></a><span class="lineno"> 3220</span>&#160;        <a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a75b2d73a0b07f594951a89cc1bc96849">prepareBalLinkedChains_inter0</a>(currOptions,                     <span class="comment">// input</span></div>
<div class="line"><a name="l03221"></a><span class="lineno"> 3221</span>&#160;                                      prevChain,                       <span class="comment">// input</span></div>
<div class="line"><a name="l03222"></a><span class="lineno"> 3222</span>&#160;                                      exchangeStdVec,                  <span class="comment">// input/output</span></div>
<div class="line"><a name="l03223"></a><span class="lineno"> 3223</span>&#160;                                      balancedLinkControl);            <span class="comment">// output</span></div>
<div class="line"><a name="l03224"></a><span class="lineno"> 3224</span>&#160;      }</div>
<div class="line"><a name="l03225"></a><span class="lineno"> 3225</span>&#160;      <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l03226"></a><span class="lineno"> 3226</span>&#160;        <a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a37dcf4d893b6c8f67fe077892bada773">prepareUnbLinkedChains_inter0</a>(indexOfFirstWeight,              <span class="comment">// input</span></div>
<div class="line"><a name="l03227"></a><span class="lineno"> 3227</span>&#160;                                      indexOfLastWeight,               <span class="comment">// input</span></div>
<div class="line"><a name="l03228"></a><span class="lineno"> 3228</span>&#160;                                      unifiedIndexCountersAtProc0Only, <span class="comment">// input</span></div>
<div class="line"><a name="l03229"></a><span class="lineno"> 3229</span>&#160;                                      unbalancedLinkControl);          <span class="comment">// output</span></div>
<div class="line"><a name="l03230"></a><span class="lineno"> 3230</span>&#160;      }</div>
<div class="line"><a name="l03231"></a><span class="lineno"> 3231</span>&#160;</div>
<div class="line"><a name="l03232"></a><span class="lineno"> 3232</span>&#160;      <span class="keywordflow">if</span> ((<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#a8a0064746ae8dddfece4229b9ad374d6">subDisplayFile</a>()) &amp;&amp; (<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#a1fe5f244fc0316a0ab3e37463f108b96">displayVerbosity</a>() &gt;= 0)) {</div>
<div class="line"><a name="l03233"></a><span class="lineno"> 3233</span>&#160;        *<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#a8a0064746ae8dddfece4229b9ad374d6">subDisplayFile</a>() &lt;&lt; <span class="stringliteral">&quot;In MLSampling&lt;P_V,P_M&gt;::generateSequence()&quot;</span></div>
<div class="line"><a name="l03234"></a><span class="lineno"> 3234</span>&#160;                                &lt;&lt; <span class="stringliteral">&quot;, level &quot;</span> &lt;&lt; <a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#af9416874c856e50f3b35270e801f17e4">m_currLevel</a>+<a class="code" href="_m_l_sampling_level_options_8h.html#a68d15eaf394d210effcf584b938206d3">LEVEL_REF_ID</a></div>
<div class="line"><a name="l03235"></a><span class="lineno"> 3235</span>&#160;                                &lt;&lt; <span class="stringliteral">&quot;, step &quot;</span>  &lt;&lt; <a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a1b1f8ccb4823bdfa26ec652f0807c63e">m_currStep</a></div>
<div class="line"><a name="l03236"></a><span class="lineno"> 3236</span>&#160;                                &lt;&lt; <span class="stringliteral">&quot;: balancedLinkControl.balLinkedChains.size() = &quot;</span>   &lt;&lt; balancedLinkControl.balLinkedChains.size()</div>
<div class="line"><a name="l03237"></a><span class="lineno"> 3237</span>&#160;                                &lt;&lt; <span class="stringliteral">&quot;, unbalancedLinkControl.unbLinkedChains.size() = &quot;</span> &lt;&lt; unbalancedLinkControl.unbLinkedChains.size()</div>
<div class="line"><a name="l03238"></a><span class="lineno"> 3238</span>&#160;                                &lt;&lt; std::endl;</div>
<div class="line"><a name="l03239"></a><span class="lineno"> 3239</span>&#160;      }</div>
<div class="line"><a name="l03240"></a><span class="lineno"> 3240</span>&#160;</div>
<div class="line"><a name="l03241"></a><span class="lineno"> 3241</span>&#160;  <span class="keywordtype">double</span> stepRunTime = <a class="code" href="namespace_q_u_e_s_o.html#a424bc33f2e6e287fd468408d14b772ee">MiscGetEllapsedSeconds</a>(&amp;timevalStep);</div>
<div class="line"><a name="l03242"></a><span class="lineno"> 3242</span>&#160;  <span class="keywordflow">if</span> ((<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#a8a0064746ae8dddfece4229b9ad374d6">subDisplayFile</a>()) &amp;&amp; (<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#a1fe5f244fc0316a0ab3e37463f108b96">displayVerbosity</a>() &gt;= 0)) {</div>
<div class="line"><a name="l03243"></a><span class="lineno"> 3243</span>&#160;    *<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#a8a0064746ae8dddfece4229b9ad374d6">subDisplayFile</a>() &lt;&lt; <span class="stringliteral">&quot;Leaving MLSampling&lt;P_V,P_M&gt;::generateSequence_Step()&quot;</span></div>
<div class="line"><a name="l03244"></a><span class="lineno"> 3244</span>&#160;                            &lt;&lt; <span class="stringliteral">&quot;, level &quot;</span> &lt;&lt; <a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#af9416874c856e50f3b35270e801f17e4">m_currLevel</a>+<a class="code" href="_m_l_sampling_level_options_8h.html#a68d15eaf394d210effcf584b938206d3">LEVEL_REF_ID</a></div>
<div class="line"><a name="l03245"></a><span class="lineno"> 3245</span>&#160;                            &lt;&lt; <span class="stringliteral">&quot;, step &quot;</span>  &lt;&lt; <a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a1b1f8ccb4823bdfa26ec652f0807c63e">m_currStep</a></div>
<div class="line"><a name="l03246"></a><span class="lineno"> 3246</span>&#160;                            &lt;&lt; <span class="stringliteral">&quot;, after &quot;</span> &lt;&lt; stepRunTime &lt;&lt; <span class="stringliteral">&quot; seconds&quot;</span></div>
<div class="line"><a name="l03247"></a><span class="lineno"> 3247</span>&#160;                            &lt;&lt; std::endl;</div>
<div class="line"><a name="l03248"></a><span class="lineno"> 3248</span>&#160;  }</div>
<div class="line"><a name="l03249"></a><span class="lineno"> 3249</span>&#160;</div>
<div class="line"><a name="l03250"></a><span class="lineno"> 3250</span>&#160;  <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l03251"></a><span class="lineno"> 3251</span>&#160;}</div>
<div class="ttc" id="class_q_u_e_s_o_1_1_m_l_sampling_html_a13f1ca4fe9f94822fe572a743eaced1d"><div class="ttname"><a href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">QUESO::MLSampling::m_env</a></div><div class="ttdeci">const BaseEnvironment &amp; m_env</div><div class="ttdoc">Queso enviroment. </div><div class="ttdef"><b>Definition:</b> <a href="_m_l_sampling_8h_source.html#l00442">MLSampling.h:442</a></div></div>
<div class="ttc" id="namespace_q_u_e_s_o_html_a8e909502900aecf24cedba022ea84471"><div class="ttname"><a href="namespace_q_u_e_s_o.html#a8e909502900aecf24cedba022ea84471">QUESO::UQ_OK_RC</a></div><div class="ttdeci">const int UQ_OK_RC</div><div class="ttdef"><b>Definition:</b> <a href="_defines_8h_source.html#l00075">Defines.h:75</a></div></div>
<div class="ttc" id="class_q_u_e_s_o_1_1_m_l_sampling_html_a37dcf4d893b6c8f67fe077892bada773"><div class="ttname"><a href="class_q_u_e_s_o_1_1_m_l_sampling.html#a37dcf4d893b6c8f67fe077892bada773">QUESO::MLSampling::prepareUnbLinkedChains_inter0</a></div><div class="ttdeci">void prepareUnbLinkedChains_inter0(unsigned int indexOfFirstWeight, unsigned int indexOfLastWeight, const std::vector&lt; unsigned int &gt; &amp;unifiedIndexCountersAtProc0Only, UnbalancedLinkedChainsPerNodeStruct &amp;unbalancedLinkControl)</div><div class="ttdef"><b>Definition:</b> <a href="_m_l_sampling_8_c_source.html#l00481">MLSampling.C:481</a></div></div>
<div class="ttc" id="class_q_u_e_s_o_1_1_m_l_sampling_html_af9416874c856e50f3b35270e801f17e4"><div class="ttname"><a href="class_q_u_e_s_o_1_1_m_l_sampling.html#af9416874c856e50f3b35270e801f17e4">QUESO::MLSampling::m_currLevel</a></div><div class="ttdeci">unsigned int m_currLevel</div><div class="ttdoc">Current level. </div><div class="ttdef"><b>Definition:</b> <a href="_m_l_sampling_8h_source.html#l00464">MLSampling.h:464</a></div></div>
<div class="ttc" id="_m_l_sampling_level_options_8h_html_a68d15eaf394d210effcf584b938206d3"><div class="ttname"><a href="_m_l_sampling_level_options_8h.html#a68d15eaf394d210effcf584b938206d3">LEVEL_REF_ID</a></div><div class="ttdeci">#define LEVEL_REF_ID</div><div class="ttdef"><b>Definition:</b> <a href="_m_l_sampling_level_options_8h_source.html#l00028">MLSamplingLevelOptions.h:28</a></div></div>
<div class="ttc" id="class_q_u_e_s_o_1_1_m_l_sampling_html_a75b2d73a0b07f594951a89cc1bc96849"><div class="ttname"><a href="class_q_u_e_s_o_1_1_m_l_sampling.html#a75b2d73a0b07f594951a89cc1bc96849">QUESO::MLSampling::prepareBalLinkedChains_inter0</a></div><div class="ttdeci">void prepareBalLinkedChains_inter0(const MLSamplingLevelOptions *currOptions, const SequenceOfVectors&lt; P_V, P_M &gt; &amp;prevChain, std::vector&lt; ExchangeInfoStruct &gt; &amp;exchangeStdVec, BalancedLinkedChainsPerNodeStruct&lt; P_V &gt; &amp;balancedLinkControl)</div><div class="ttdef"><b>Definition:</b> <a href="_m_l_sampling_8_c_source.html#l00343">MLSampling.C:343</a></div></div>
<div class="ttc" id="namespace_q_u_e_s_o_html_a424bc33f2e6e287fd468408d14b772ee"><div class="ttname"><a href="namespace_q_u_e_s_o.html#a424bc33f2e6e287fd468408d14b772ee">QUESO::MiscGetEllapsedSeconds</a></div><div class="ttdeci">double MiscGetEllapsedSeconds(struct timeval *timeval0)</div><div class="ttdef"><b>Definition:</b> <a href="_miscellaneous_8_c_source.html#l00287">Miscellaneous.C:287</a></div></div>
<div class="ttc" id="class_q_u_e_s_o_1_1_m_l_sampling_html_a1b1f8ccb4823bdfa26ec652f0807c63e"><div class="ttname"><a href="class_q_u_e_s_o_1_1_m_l_sampling.html#a1b1f8ccb4823bdfa26ec652f0807c63e">QUESO::MLSampling::m_currStep</a></div><div class="ttdeci">unsigned int m_currStep</div><div class="ttdoc">Curret step. </div><div class="ttdef"><b>Definition:</b> <a href="_m_l_sampling_8h_source.html#l00467">MLSampling.h:467</a></div></div>
<div class="ttc" id="class_q_u_e_s_o_1_1_base_environment_html_a1fe5f244fc0316a0ab3e37463f108b96"><div class="ttname"><a href="class_q_u_e_s_o_1_1_base_environment.html#a1fe5f244fc0316a0ab3e37463f108b96">QUESO::BaseEnvironment::displayVerbosity</a></div><div class="ttdeci">unsigned int displayVerbosity() const </div><div class="ttdef"><b>Definition:</b> <a href="_environment_8_c_source.html#l00436">Environment.C:436</a></div></div>
<div class="ttc" id="class_q_u_e_s_o_1_1_base_environment_html_a8a0064746ae8dddfece4229b9ad374d6"><div class="ttname"><a href="class_q_u_e_s_o_1_1_base_environment.html#a8a0064746ae8dddfece4229b9ad374d6">QUESO::BaseEnvironment::subDisplayFile</a></div><div class="ttdeci">std::ofstream * subDisplayFile() const </div><div class="ttdoc">Access function for m_subDisplayFile (displays file on stream). </div><div class="ttdef"><b>Definition:</b> <a href="_environment_8_c_source.html#l00305">Environment.C:305</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a754bc11c7802f627fece9f063450739a"></a>
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;class P_V , class P_M &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="class_q_u_e_s_o_1_1_m_l_sampling.html">QUESO::MLSampling</a>&lt; P_V, P_M &gt;::generateSequence_Step08_all </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_q_u_e_s_o_1_1_bayesian_joint_pdf.html">BayesianJointPdf</a>&lt; P_V, P_M &gt; &amp;&#160;</td>
          <td class="paramname"><em>currPdf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_q_u_e_s_o_1_1_generic_vector_r_v.html">GenericVectorRV</a>&lt; P_V, P_M &gt; &amp;&#160;</td>
          <td class="paramname"><em>currRv</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Creates a vector RV for current level (Step 08 from ML algorithm). </p>
<p>This method is responsible for the Step 08 in the ML algorithm implemented/described in the method <a class="el" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a8d7296b30623c73ada38971cae27994a" title="Method to generate the chain. ">MLSampling&lt;P_V,P_M&gt;::generateSequence</a>.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">currPdf</td><td></td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">currRv</td><td></td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="_m_l_sampling_8_c_source.html#l03255">3255</a> of file <a class="el" href="_m_l_sampling_8_c_source.html">MLSampling.C</a>.</p>

<p>References <a class="el" href="_m_l_sampling_level_options_8h_source.html#l00028">LEVEL_REF_ID</a>, <a class="el" href="_miscellaneous_8_c_source.html#l00287">QUESO::MiscGetEllapsedSeconds()</a>, <a class="el" href="_generic_vector_r_v_8_c_source.html#l00090">QUESO::GenericVectorRV&lt; V, M &gt;::setPdf()</a>, and <a class="el" href="_defines_8h_source.html#l00075">QUESO::UQ_OK_RC</a>.</p>
<div class="fragment"><div class="line"><a name="l03258"></a><span class="lineno"> 3258</span>&#160;{</div>
<div class="line"><a name="l03259"></a><span class="lineno"> 3259</span>&#160;  <span class="keywordtype">int</span> iRC = <a class="code" href="namespace_q_u_e_s_o.html#a8e909502900aecf24cedba022ea84471">UQ_OK_RC</a>;</div>
<div class="line"><a name="l03260"></a><span class="lineno"> 3260</span>&#160;  <span class="keyword">struct </span>timeval timevalStep;</div>
<div class="line"><a name="l03261"></a><span class="lineno"> 3261</span>&#160;  iRC = gettimeofday(&amp;timevalStep, NULL);</div>
<div class="line"><a name="l03262"></a><span class="lineno"> 3262</span>&#160;  <span class="keywordflow">if</span> (iRC) {}; <span class="comment">// just to remove compiler warning</span></div>
<div class="line"><a name="l03263"></a><span class="lineno"> 3263</span>&#160;</div>
<div class="line"><a name="l03264"></a><span class="lineno"> 3264</span>&#160;      <span class="keywordflow">if</span> ((<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#a8a0064746ae8dddfece4229b9ad374d6">subDisplayFile</a>()) &amp;&amp; (<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#a1fe5f244fc0316a0ab3e37463f108b96">displayVerbosity</a>() &gt;= 0)) {</div>
<div class="line"><a name="l03265"></a><span class="lineno"> 3265</span>&#160;        *<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#a8a0064746ae8dddfece4229b9ad374d6">subDisplayFile</a>() &lt;&lt; <span class="stringliteral">&quot;In MLSampling&lt;P_V,P_M&gt;::generateSequence()&quot;</span></div>
<div class="line"><a name="l03266"></a><span class="lineno"> 3266</span>&#160;                                &lt;&lt; <span class="stringliteral">&quot;, level &quot;</span> &lt;&lt; <a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#af9416874c856e50f3b35270e801f17e4">m_currLevel</a>+<a class="code" href="_m_l_sampling_level_options_8h.html#a68d15eaf394d210effcf584b938206d3">LEVEL_REF_ID</a></div>
<div class="line"><a name="l03267"></a><span class="lineno"> 3267</span>&#160;                                &lt;&lt; <span class="stringliteral">&quot;, step &quot;</span>  &lt;&lt; <a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a1b1f8ccb4823bdfa26ec652f0807c63e">m_currStep</a></div>
<div class="line"><a name="l03268"></a><span class="lineno"> 3268</span>&#160;                                &lt;&lt; <span class="stringliteral">&quot;: beginning step 8 of 11&quot;</span></div>
<div class="line"><a name="l03269"></a><span class="lineno"> 3269</span>&#160;                                &lt;&lt; std::endl;</div>
<div class="line"><a name="l03270"></a><span class="lineno"> 3270</span>&#160;      }</div>
<div class="line"><a name="l03271"></a><span class="lineno"> 3271</span>&#160;</div>
<div class="line"><a name="l03272"></a><span class="lineno"> 3272</span>&#160;      currRv.<a class="code" href="class_q_u_e_s_o_1_1_generic_vector_r_v.html#a1645a2db9e84b44df65faefda9921277">setPdf</a>(currPdf);</div>
<div class="line"><a name="l03273"></a><span class="lineno"> 3273</span>&#160;</div>
<div class="line"><a name="l03274"></a><span class="lineno"> 3274</span>&#160;  <span class="keywordtype">double</span> stepRunTime = <a class="code" href="namespace_q_u_e_s_o.html#a424bc33f2e6e287fd468408d14b772ee">MiscGetEllapsedSeconds</a>(&amp;timevalStep);</div>
<div class="line"><a name="l03275"></a><span class="lineno"> 3275</span>&#160;  <span class="keywordflow">if</span> ((<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#a8a0064746ae8dddfece4229b9ad374d6">subDisplayFile</a>()) &amp;&amp; (<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#a1fe5f244fc0316a0ab3e37463f108b96">displayVerbosity</a>() &gt;= 0)) {</div>
<div class="line"><a name="l03276"></a><span class="lineno"> 3276</span>&#160;    *<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#a8a0064746ae8dddfece4229b9ad374d6">subDisplayFile</a>() &lt;&lt; <span class="stringliteral">&quot;Leaving MLSampling&lt;P_V,P_M&gt;::generateSequence_Step()&quot;</span></div>
<div class="line"><a name="l03277"></a><span class="lineno"> 3277</span>&#160;                            &lt;&lt; <span class="stringliteral">&quot;, level &quot;</span> &lt;&lt; <a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#af9416874c856e50f3b35270e801f17e4">m_currLevel</a>+<a class="code" href="_m_l_sampling_level_options_8h.html#a68d15eaf394d210effcf584b938206d3">LEVEL_REF_ID</a></div>
<div class="line"><a name="l03278"></a><span class="lineno"> 3278</span>&#160;                            &lt;&lt; <span class="stringliteral">&quot;, step &quot;</span>  &lt;&lt; <a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a1b1f8ccb4823bdfa26ec652f0807c63e">m_currStep</a></div>
<div class="line"><a name="l03279"></a><span class="lineno"> 3279</span>&#160;                            &lt;&lt; <span class="stringliteral">&quot;, after &quot;</span> &lt;&lt; stepRunTime &lt;&lt; <span class="stringliteral">&quot; seconds&quot;</span></div>
<div class="line"><a name="l03280"></a><span class="lineno"> 3280</span>&#160;                            &lt;&lt; std::endl;</div>
<div class="line"><a name="l03281"></a><span class="lineno"> 3281</span>&#160;  }</div>
<div class="line"><a name="l03282"></a><span class="lineno"> 3282</span>&#160;</div>
<div class="line"><a name="l03283"></a><span class="lineno"> 3283</span>&#160;  <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l03284"></a><span class="lineno"> 3284</span>&#160;}</div>
<div class="ttc" id="class_q_u_e_s_o_1_1_m_l_sampling_html_a13f1ca4fe9f94822fe572a743eaced1d"><div class="ttname"><a href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">QUESO::MLSampling::m_env</a></div><div class="ttdeci">const BaseEnvironment &amp; m_env</div><div class="ttdoc">Queso enviroment. </div><div class="ttdef"><b>Definition:</b> <a href="_m_l_sampling_8h_source.html#l00442">MLSampling.h:442</a></div></div>
<div class="ttc" id="namespace_q_u_e_s_o_html_a8e909502900aecf24cedba022ea84471"><div class="ttname"><a href="namespace_q_u_e_s_o.html#a8e909502900aecf24cedba022ea84471">QUESO::UQ_OK_RC</a></div><div class="ttdeci">const int UQ_OK_RC</div><div class="ttdef"><b>Definition:</b> <a href="_defines_8h_source.html#l00075">Defines.h:75</a></div></div>
<div class="ttc" id="class_q_u_e_s_o_1_1_m_l_sampling_html_af9416874c856e50f3b35270e801f17e4"><div class="ttname"><a href="class_q_u_e_s_o_1_1_m_l_sampling.html#af9416874c856e50f3b35270e801f17e4">QUESO::MLSampling::m_currLevel</a></div><div class="ttdeci">unsigned int m_currLevel</div><div class="ttdoc">Current level. </div><div class="ttdef"><b>Definition:</b> <a href="_m_l_sampling_8h_source.html#l00464">MLSampling.h:464</a></div></div>
<div class="ttc" id="_m_l_sampling_level_options_8h_html_a68d15eaf394d210effcf584b938206d3"><div class="ttname"><a href="_m_l_sampling_level_options_8h.html#a68d15eaf394d210effcf584b938206d3">LEVEL_REF_ID</a></div><div class="ttdeci">#define LEVEL_REF_ID</div><div class="ttdef"><b>Definition:</b> <a href="_m_l_sampling_level_options_8h_source.html#l00028">MLSamplingLevelOptions.h:28</a></div></div>
<div class="ttc" id="namespace_q_u_e_s_o_html_a424bc33f2e6e287fd468408d14b772ee"><div class="ttname"><a href="namespace_q_u_e_s_o.html#a424bc33f2e6e287fd468408d14b772ee">QUESO::MiscGetEllapsedSeconds</a></div><div class="ttdeci">double MiscGetEllapsedSeconds(struct timeval *timeval0)</div><div class="ttdef"><b>Definition:</b> <a href="_miscellaneous_8_c_source.html#l00287">Miscellaneous.C:287</a></div></div>
<div class="ttc" id="class_q_u_e_s_o_1_1_m_l_sampling_html_a1b1f8ccb4823bdfa26ec652f0807c63e"><div class="ttname"><a href="class_q_u_e_s_o_1_1_m_l_sampling.html#a1b1f8ccb4823bdfa26ec652f0807c63e">QUESO::MLSampling::m_currStep</a></div><div class="ttdeci">unsigned int m_currStep</div><div class="ttdoc">Curret step. </div><div class="ttdef"><b>Definition:</b> <a href="_m_l_sampling_8h_source.html#l00467">MLSampling.h:467</a></div></div>
<div class="ttc" id="class_q_u_e_s_o_1_1_generic_vector_r_v_html_a1645a2db9e84b44df65faefda9921277"><div class="ttname"><a href="class_q_u_e_s_o_1_1_generic_vector_r_v.html#a1645a2db9e84b44df65faefda9921277">QUESO::GenericVectorRV::setPdf</a></div><div class="ttdeci">void setPdf(BaseJointPdf&lt; V, M &gt; &amp;pdf)</div><div class="ttdoc">Sets the PDF of this vector RV to pdf. </div><div class="ttdef"><b>Definition:</b> <a href="_generic_vector_r_v_8_c_source.html#l00090">GenericVectorRV.C:90</a></div></div>
<div class="ttc" id="class_q_u_e_s_o_1_1_base_environment_html_a1fe5f244fc0316a0ab3e37463f108b96"><div class="ttname"><a href="class_q_u_e_s_o_1_1_base_environment.html#a1fe5f244fc0316a0ab3e37463f108b96">QUESO::BaseEnvironment::displayVerbosity</a></div><div class="ttdeci">unsigned int displayVerbosity() const </div><div class="ttdef"><b>Definition:</b> <a href="_environment_8_c_source.html#l00436">Environment.C:436</a></div></div>
<div class="ttc" id="class_q_u_e_s_o_1_1_base_environment_html_a8a0064746ae8dddfece4229b9ad374d6"><div class="ttname"><a href="class_q_u_e_s_o_1_1_base_environment.html#a8a0064746ae8dddfece4229b9ad374d6">QUESO::BaseEnvironment::subDisplayFile</a></div><div class="ttdeci">std::ofstream * subDisplayFile() const </div><div class="ttdoc">Access function for m_subDisplayFile (displays file on stream). </div><div class="ttdef"><b>Definition:</b> <a href="_environment_8_c_source.html#l00305">Environment.C:305</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a26892288f3b1902d78ba049b96579a08"></a>
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;class P_V , class P_M &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="class_q_u_e_s_o_1_1_m_l_sampling.html">QUESO::MLSampling</a>&lt; P_V, P_M &gt;::generateSequence_Step09_all </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="class_q_u_e_s_o_1_1_sequence_of_vectors.html">SequenceOfVectors</a>&lt; P_V, P_M &gt; &amp;&#160;</td>
          <td class="paramname"><em>prevChain</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned int&#160;</td>
          <td class="paramname"><em>indexOfFirstWeight</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned int&#160;</td>
          <td class="paramname"><em>indexOfLastWeight</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::vector&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>unifiedWeightStdVectorAtProc0Only</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="class_q_u_e_s_o_1_1_scalar_sequence.html">ScalarSequence</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>weightSequence</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>prevEta</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="class_q_u_e_s_o_1_1_generic_vector_r_v.html">GenericVectorRV</a>&lt; P_V, P_M &gt; &amp;&#160;</td>
          <td class="paramname"><em>currRv</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_q_u_e_s_o_1_1_m_l_sampling_level_options.html">MLSamplingLevelOptions</a> *&#160;</td>
          <td class="paramname"><em>currOptions</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">P_M &amp;&#160;</td>
          <td class="paramname"><em>unifiedCovMatrix</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double &amp;&#160;</td>
          <td class="paramname"><em>currEta</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Scales the unified covariance matrix until min &lt;= rejection rate &lt;= max (Step 09 from ML algorithm). </p>
<p>This method is responsible for the Step 09 in the ML algorithm implemented/described in the method <a class="el" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a8d7296b30623c73ada38971cae27994a" title="Method to generate the chain. ">MLSampling&lt;P_V,P_M&gt;::generateSequence</a>.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">prevChain,indexOfFirstWeight,indexOfLastWeight,unifiedWeightStdVectorAtProc0Only,weightSequence,prevEta,currRv,currOptions,@param[in,out]</td><td>unifiedCovMatrix </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">currEta</td><td></td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="_m_l_sampling_8_c_source.html#l03288">3288</a> of file <a class="el" href="_m_l_sampling_8_c_source.html">MLSampling.C</a>.</p>

<p>References <a class="el" href="_m_l_sampling_8h_source.html#l00084">QUESO::BalancedLinkedChainsPerNodeStruct&lt; P_V &gt;::balLinkedChains</a>, <a class="el" href="_scalar_sequence_8_c_source.html#l00252">QUESO::ScalarSequence&lt; T &gt;::getUnifiedContentsAtProc0Only()</a>, <a class="el" href="_m_l_sampling_level_options_8h_source.html#l00028">LEVEL_REF_ID</a>, <a class="el" href="_m_l_sampling_level_options_8h_source.html#l00312">QUESO::MLSamplingLevelOptions::m_amAdaptInterval</a>, <a class="el" href="_m_l_sampling_level_options_8h_source.html#l00187">QUESO::MLSamplingLevelOptions::m_covRejectionRate</a>, <a class="el" href="_m_l_sampling_level_options_8h_source.html#l00296">QUESO::MLSamplingLevelOptions::m_drMaxNumExtraStages</a>, <a class="el" href="_m_l_sampling_level_options_8h_source.html#l00256">QUESO::MLSamplingLevelOptions::m_filteredChainGenerate</a>, <a class="el" href="_m_l_sampling_level_options_8h_source.html#l00184">QUESO::MLSamplingLevelOptions::m_maxRejectionRate</a>, <a class="el" href="_m_l_sampling_level_options_8h_source.html#l00181">QUESO::MLSamplingLevelOptions::m_minRejectionRate</a>, <a class="el" href="_m_l_sampling_level_options_8h_source.html#l00222">QUESO::MLSamplingLevelOptions::m_rawChainSize</a>, <a class="el" href="_m_l_sampling_level_options_8h_source.html#l00178">QUESO::MLSamplingLevelOptions::m_scaleCovMatrix</a>, <a class="el" href="_m_l_sampling_level_options_8h_source.html#l00194">QUESO::MLSamplingLevelOptions::m_totallyMute</a>, <a class="el" href="_miscellaneous_8_c_source.html#l00484">QUESO::MiscCheckForSameValueInAllNodes()</a>, <a class="el" href="_miscellaneous_8_c_source.html#l00287">QUESO::MiscGetEllapsedSeconds()</a>, <a class="el" href="_mpi_comm_8h_source.html#l00052">RawValue_MPI_SUM</a>, <a class="el" href="_mpi_comm_8h_source.html#l00049">RawValue_MPI_UNSIGNED</a>, <a class="el" href="_scalar_sequence_8_c_source.html#l00141">QUESO::ScalarSequence&lt; T &gt;::subSequenceSize()</a>, <a class="el" href="_scalar_sequence_8_c_source.html#l00148">QUESO::ScalarSequence&lt; T &gt;::unifiedSequenceSize()</a>, <a class="el" href="_defines_8h_source.html#l00222">UQ_FATAL_TEST_MACRO</a>, and <a class="el" href="_defines_8h_source.html#l00075">QUESO::UQ_OK_RC</a>.</p>
<div class="fragment"><div class="line"><a name="l03299"></a><span class="lineno"> 3299</span>&#160;{</div>
<div class="line"><a name="l03300"></a><span class="lineno"> 3300</span>&#160;  <span class="keywordtype">int</span> iRC = <a class="code" href="namespace_q_u_e_s_o.html#a8e909502900aecf24cedba022ea84471">UQ_OK_RC</a>;</div>
<div class="line"><a name="l03301"></a><span class="lineno"> 3301</span>&#160;  <span class="keyword">struct </span>timeval timevalStep;</div>
<div class="line"><a name="l03302"></a><span class="lineno"> 3302</span>&#160;  iRC = gettimeofday(&amp;timevalStep, NULL);</div>
<div class="line"><a name="l03303"></a><span class="lineno"> 3303</span>&#160;  <span class="keywordflow">if</span> (iRC) {}; <span class="comment">// just to remove compiler warning</span></div>
<div class="line"><a name="l03304"></a><span class="lineno"> 3304</span>&#160;</div>
<div class="line"><a name="l03305"></a><span class="lineno"> 3305</span>&#160;    <span class="keywordflow">if</span> (currOptions-&gt;m_scaleCovMatrix == <span class="keyword">false</span>) {</div>
<div class="line"><a name="l03306"></a><span class="lineno"> 3306</span>&#160;      <span class="keywordflow">if</span> ((<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#a8a0064746ae8dddfece4229b9ad374d6">subDisplayFile</a>()) &amp;&amp; (<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#a1fe5f244fc0316a0ab3e37463f108b96">displayVerbosity</a>() &gt;= 0)) {</div>
<div class="line"><a name="l03307"></a><span class="lineno"> 3307</span>&#160;        *<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#a8a0064746ae8dddfece4229b9ad374d6">subDisplayFile</a>() &lt;&lt; <span class="stringliteral">&quot;In MLSampling&lt;P_V,P_M&gt;::generateSequence()&quot;</span></div>
<div class="line"><a name="l03308"></a><span class="lineno"> 3308</span>&#160;                                &lt;&lt; <span class="stringliteral">&quot;, level &quot;</span> &lt;&lt; <a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#af9416874c856e50f3b35270e801f17e4">m_currLevel</a>+<a class="code" href="_m_l_sampling_level_options_8h.html#a68d15eaf394d210effcf584b938206d3">LEVEL_REF_ID</a></div>
<div class="line"><a name="l03309"></a><span class="lineno"> 3309</span>&#160;                                &lt;&lt; <span class="stringliteral">&quot;, step &quot;</span>  &lt;&lt; <a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a1b1f8ccb4823bdfa26ec652f0807c63e">m_currStep</a></div>
<div class="line"><a name="l03310"></a><span class="lineno"> 3310</span>&#160;                                &lt;&lt; <span class="stringliteral">&quot;: skipping step 9 of 11&quot;</span></div>
<div class="line"><a name="l03311"></a><span class="lineno"> 3311</span>&#160;                                &lt;&lt; std::endl;</div>
<div class="line"><a name="l03312"></a><span class="lineno"> 3312</span>&#160;      }</div>
<div class="line"><a name="l03313"></a><span class="lineno"> 3313</span>&#160;    }</div>
<div class="line"><a name="l03314"></a><span class="lineno"> 3314</span>&#160;    <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l03315"></a><span class="lineno"> 3315</span>&#160;      <span class="keywordflow">if</span> ((<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#a8a0064746ae8dddfece4229b9ad374d6">subDisplayFile</a>()) &amp;&amp; (<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#a1fe5f244fc0316a0ab3e37463f108b96">displayVerbosity</a>() &gt;= 0)) {</div>
<div class="line"><a name="l03316"></a><span class="lineno"> 3316</span>&#160;        *<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#a8a0064746ae8dddfece4229b9ad374d6">subDisplayFile</a>() &lt;&lt; <span class="stringliteral">&quot;In MLSampling&lt;P_V,P_M&gt;::generateSequence_Step09_all()&quot;</span></div>
<div class="line"><a name="l03317"></a><span class="lineno"> 3317</span>&#160;                                &lt;&lt; <span class="stringliteral">&quot;, level &quot;</span> &lt;&lt; <a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#af9416874c856e50f3b35270e801f17e4">m_currLevel</a>+<a class="code" href="_m_l_sampling_level_options_8h.html#a68d15eaf394d210effcf584b938206d3">LEVEL_REF_ID</a></div>
<div class="line"><a name="l03318"></a><span class="lineno"> 3318</span>&#160;                                &lt;&lt; <span class="stringliteral">&quot;, step &quot;</span>  &lt;&lt; <a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a1b1f8ccb4823bdfa26ec652f0807c63e">m_currStep</a></div>
<div class="line"><a name="l03319"></a><span class="lineno"> 3319</span>&#160;                                &lt;&lt; <span class="stringliteral">&quot;: beginning step 9 of 11&quot;</span></div>
<div class="line"><a name="l03320"></a><span class="lineno"> 3320</span>&#160;                                &lt;&lt; std::endl;</div>
<div class="line"><a name="l03321"></a><span class="lineno"> 3321</span>&#160;      }</div>
<div class="line"><a name="l03322"></a><span class="lineno"> 3322</span>&#160;</div>
<div class="line"><a name="l03323"></a><span class="lineno"> 3323</span>&#160;      <span class="keywordtype">double</span> beforeEta           = prevEta;</div>
<div class="line"><a name="l03324"></a><span class="lineno"> 3324</span>&#160;      <span class="keywordtype">double</span> beforeRejectionRate = 0.;               <span class="comment">// To be updated</span></div>
<div class="line"><a name="l03325"></a><span class="lineno"> 3325</span>&#160;      <span class="keywordtype">bool</span>   beforeRejectionRateIsBelowRange = <span class="keyword">true</span>; <span class="comment">// To be updated</span></div>
<div class="line"><a name="l03326"></a><span class="lineno"> 3326</span>&#160;</div>
<div class="line"><a name="l03327"></a><span class="lineno"> 3327</span>&#160;      <span class="keywordtype">double</span> nowEta           = prevEta;</div>
<div class="line"><a name="l03328"></a><span class="lineno"> 3328</span>&#160;      <span class="keywordtype">double</span> nowRejectionRate = 0.;               <span class="comment">// To be computed</span></div>
<div class="line"><a name="l03329"></a><span class="lineno"> 3329</span>&#160;      <span class="keywordtype">bool</span>   nowRejectionRateIsBelowRange = <span class="keyword">true</span>; <span class="comment">// To be computed</span></div>
<div class="line"><a name="l03330"></a><span class="lineno"> 3330</span>&#160;</div>
<div class="line"><a name="l03331"></a><span class="lineno"> 3331</span>&#160;      std::vector&lt;double&gt; etas(2,0.);</div>
<div class="line"><a name="l03332"></a><span class="lineno"> 3332</span>&#160;      etas[0] = beforeEta;</div>
<div class="line"><a name="l03333"></a><span class="lineno"> 3333</span>&#160;      etas[1] = 1.;</div>
<div class="line"><a name="l03334"></a><span class="lineno"> 3334</span>&#160;</div>
<div class="line"><a name="l03335"></a><span class="lineno"> 3335</span>&#160;      std::vector&lt;double&gt; rejs(2,0.);</div>
<div class="line"><a name="l03336"></a><span class="lineno"> 3336</span>&#160;      rejs[0] = 0.; <span class="comment">// To be computed</span></div>
<div class="line"><a name="l03337"></a><span class="lineno"> 3337</span>&#160;      rejs[1] = 0.; <span class="comment">// To be computed</span></div>
<div class="line"><a name="l03338"></a><span class="lineno"> 3338</span>&#160;</div>
<div class="line"><a name="l03339"></a><span class="lineno"> 3339</span>&#160;      <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> nowAttempt = 0;</div>
<div class="line"><a name="l03340"></a><span class="lineno"> 3340</span>&#160;      <span class="keywordtype">bool</span> testResult = <span class="keyword">false</span>;</div>
<div class="line"><a name="l03341"></a><span class="lineno"> 3341</span>&#160;      <span class="keywordtype">double</span> meanRejectionRate = .5*(currOptions-&gt;m_minRejectionRate + currOptions-&gt;m_maxRejectionRate);</div>
<div class="line"><a name="l03342"></a><span class="lineno"> 3342</span>&#160;      <span class="keywordtype">bool</span> useMiddlePointLogicForEta = <span class="keyword">false</span>;</div>
<div class="line"><a name="l03343"></a><span class="lineno"> 3343</span>&#160;      P_M nowCovMatrix(unifiedCovMatrix);</div>
<div class="line"><a name="l03344"></a><span class="lineno"> 3344</span>&#160;<span class="preprocessor">#if 0 // KAUST, to check</span></div>
<div class="line"><a name="l03345"></a><span class="lineno"> 3345</span>&#160;<span class="preprocessor"></span>      std::vector&lt;double&gt; unifiedWeightStdVectorAtProc0Only(0);</div>
<div class="line"><a name="l03346"></a><span class="lineno"> 3346</span>&#160;      weightSequence.<a class="code" href="class_q_u_e_s_o_1_1_scalar_sequence.html#ab8802412461496eb72f6c1267507c28c">getUnifiedContentsAtProc0Only</a>(<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a7bc4c72f65ba9166ed94a6e198b0915b">m_vectorSpace</a>.<a class="code" href="class_q_u_e_s_o_1_1_vector_space.html#a67b0c3620662116f5a346fdaa5faf38e">numOfProcsForStorage</a>() == 1,</div>
<div class="line"><a name="l03347"></a><span class="lineno"> 3347</span>&#160;                                                   unifiedWeightStdVectorAtProc0Only);</div>
<div class="line"><a name="l03348"></a><span class="lineno"> 3348</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l03349"></a><span class="lineno"> 3349</span>&#160;<span class="preprocessor"></span>      <span class="keywordflow">do</span> {</div>
<div class="line"><a name="l03350"></a><span class="lineno"> 3350</span>&#160;        <span class="keywordflow">if</span> ((<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#a8a0064746ae8dddfece4229b9ad374d6">subDisplayFile</a>()) &amp;&amp; (<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#a1fe5f244fc0316a0ab3e37463f108b96">displayVerbosity</a>() &gt;= 0)) {</div>
<div class="line"><a name="l03351"></a><span class="lineno"> 3351</span>&#160;          *<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#a8a0064746ae8dddfece4229b9ad374d6">subDisplayFile</a>() &lt;&lt; <span class="stringliteral">&quot;In MLSampling&lt;P_V,P_M&gt;::generateSequence_Step09_all()&quot;</span></div>
<div class="line"><a name="l03352"></a><span class="lineno"> 3352</span>&#160;                                  &lt;&lt; <span class="stringliteral">&quot;, level &quot;</span> &lt;&lt; <a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#af9416874c856e50f3b35270e801f17e4">m_currLevel</a>+<a class="code" href="_m_l_sampling_level_options_8h.html#a68d15eaf394d210effcf584b938206d3">LEVEL_REF_ID</a></div>
<div class="line"><a name="l03353"></a><span class="lineno"> 3353</span>&#160;                                  &lt;&lt; <span class="stringliteral">&quot;, step &quot;</span>  &lt;&lt; <a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a1b1f8ccb4823bdfa26ec652f0807c63e">m_currStep</a></div>
<div class="line"><a name="l03354"></a><span class="lineno"> 3354</span>&#160;                                  &lt;&lt; <span class="stringliteral">&quot;: entering loop for assessing rejection rate&quot;</span></div>
<div class="line"><a name="l03355"></a><span class="lineno"> 3355</span>&#160;                                  &lt;&lt; <span class="stringliteral">&quot;, with nowAttempt = &quot;</span>  &lt;&lt; nowAttempt</div>
<div class="line"><a name="l03356"></a><span class="lineno"> 3356</span>&#160;                                  &lt;&lt; <span class="stringliteral">&quot;, nowRejectionRate = &quot;</span> &lt;&lt; nowRejectionRate</div>
<div class="line"><a name="l03357"></a><span class="lineno"> 3357</span>&#160;                                  &lt;&lt; std::endl;</div>
<div class="line"><a name="l03358"></a><span class="lineno"> 3358</span>&#160;        }</div>
<div class="line"><a name="l03359"></a><span class="lineno"> 3359</span>&#160;        nowCovMatrix = unifiedCovMatrix;</div>
<div class="line"><a name="l03360"></a><span class="lineno"> 3360</span>&#160;</div>
<div class="line"><a name="l03361"></a><span class="lineno"> 3361</span>&#160;        <span class="keywordflow">if</span> (nowRejectionRate &lt; currOptions-&gt;m_minRejectionRate) {</div>
<div class="line"><a name="l03362"></a><span class="lineno"> 3362</span>&#160;          nowRejectionRateIsBelowRange = <span class="keyword">true</span>;</div>
<div class="line"><a name="l03363"></a><span class="lineno"> 3363</span>&#160;        }</div>
<div class="line"><a name="l03364"></a><span class="lineno"> 3364</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (nowRejectionRate &gt; currOptions-&gt;m_maxRejectionRate) {</div>
<div class="line"><a name="l03365"></a><span class="lineno"> 3365</span>&#160;          nowRejectionRateIsBelowRange = <span class="keyword">false</span>;</div>
<div class="line"><a name="l03366"></a><span class="lineno"> 3366</span>&#160;        }</div>
<div class="line"><a name="l03367"></a><span class="lineno"> 3367</span>&#160;        <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l03368"></a><span class="lineno"> 3368</span>&#160;          <a class="code" href="_defines_8h.html#a56d63d18d0a6d45757de47fcc06f574d">UQ_FATAL_TEST_MACRO</a>(<span class="keyword">true</span>,</div>
<div class="line"><a name="l03369"></a><span class="lineno"> 3369</span>&#160;                              <a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#a78b57112bbd0e6dd0e8afec00b40ffa7">worldRank</a>(),</div>
<div class="line"><a name="l03370"></a><span class="lineno"> 3370</span>&#160;                              <span class="stringliteral">&quot;MLSampling&lt;P_V,P_M&gt;::generateSequence_Step09_all()&quot;</span>,</div>
<div class="line"><a name="l03371"></a><span class="lineno"> 3371</span>&#160;                              <span class="stringliteral">&quot;nowRejectionRate should be out of the requested range at this point of the logic&quot;</span>);</div>
<div class="line"><a name="l03372"></a><span class="lineno"> 3372</span>&#160;        }</div>
<div class="line"><a name="l03373"></a><span class="lineno"> 3373</span>&#160;</div>
<div class="line"><a name="l03374"></a><span class="lineno"> 3374</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#ae106b5bb8a80b655b88b3a26b1e7c185">inter0Rank</a>() &gt;= 0) { <span class="comment">// KAUST</span></div>
<div class="line"><a name="l03375"></a><span class="lineno"> 3375</span>&#160;          <span class="keywordflow">if</span> (nowAttempt &gt; 0) {</div>
<div class="line"><a name="l03376"></a><span class="lineno"> 3376</span>&#160;            <span class="keywordflow">if</span> (useMiddlePointLogicForEta == <span class="keyword">false</span>) {</div>
<div class="line"><a name="l03377"></a><span class="lineno"> 3377</span>&#160;              <span class="keywordflow">if</span> (nowAttempt == 1) {</div>
<div class="line"><a name="l03378"></a><span class="lineno"> 3378</span>&#160;                <span class="comment">// Ok, keep useMiddlePointLogicForEta = false</span></div>
<div class="line"><a name="l03379"></a><span class="lineno"> 3379</span>&#160;              }</div>
<div class="line"><a name="l03380"></a><span class="lineno"> 3380</span>&#160;              <span class="keywordflow">else</span> <span class="keywordflow">if</span> ((beforeRejectionRateIsBelowRange == <span class="keyword">true</span>) &amp;&amp;</div>
<div class="line"><a name="l03381"></a><span class="lineno"> 3381</span>&#160;                       (nowRejectionRateIsBelowRange    == <span class="keyword">true</span>)) {</div>
<div class="line"><a name="l03382"></a><span class="lineno"> 3382</span>&#160;                <span class="comment">// Ok</span></div>
<div class="line"><a name="l03383"></a><span class="lineno"> 3383</span>&#160;              }</div>
<div class="line"><a name="l03384"></a><span class="lineno"> 3384</span>&#160;              <span class="keywordflow">else</span> <span class="keywordflow">if</span> ((beforeRejectionRateIsBelowRange == <span class="keyword">false</span>) &amp;&amp;</div>
<div class="line"><a name="l03385"></a><span class="lineno"> 3385</span>&#160;                       (nowRejectionRateIsBelowRange    == <span class="keyword">false</span>)) {</div>
<div class="line"><a name="l03386"></a><span class="lineno"> 3386</span>&#160;                <span class="comment">// Ok</span></div>
<div class="line"><a name="l03387"></a><span class="lineno"> 3387</span>&#160;              }</div>
<div class="line"><a name="l03388"></a><span class="lineno"> 3388</span>&#160;              <span class="keywordflow">else</span> <span class="keywordflow">if</span> ((beforeRejectionRateIsBelowRange == <span class="keyword">true</span> ) &amp;&amp;</div>
<div class="line"><a name="l03389"></a><span class="lineno"> 3389</span>&#160;                       (nowRejectionRateIsBelowRange    == <span class="keyword">false</span>)) {</div>
<div class="line"><a name="l03390"></a><span class="lineno"> 3390</span>&#160;                useMiddlePointLogicForEta = <span class="keyword">true</span>;</div>
<div class="line"><a name="l03391"></a><span class="lineno"> 3391</span>&#160;</div>
<div class="line"><a name="l03392"></a><span class="lineno"> 3392</span>&#160;                <span class="comment">// This is the first time the middle point logic will be used below</span></div>
<div class="line"><a name="l03393"></a><span class="lineno"> 3393</span>&#160;                etas[0] = std::min(beforeEta,nowEta);</div>
<div class="line"><a name="l03394"></a><span class="lineno"> 3394</span>&#160;                etas[1] = std::max(beforeEta,nowEta);</div>
<div class="line"><a name="l03395"></a><span class="lineno"> 3395</span>&#160;</div>
<div class="line"><a name="l03396"></a><span class="lineno"> 3396</span>&#160;                <span class="keywordflow">if</span> (etas[0] == beforeEta) {</div>
<div class="line"><a name="l03397"></a><span class="lineno"> 3397</span>&#160;                  rejs[0] = beforeRejectionRate;</div>
<div class="line"><a name="l03398"></a><span class="lineno"> 3398</span>&#160;                  rejs[1] = nowRejectionRate;</div>
<div class="line"><a name="l03399"></a><span class="lineno"> 3399</span>&#160;                }</div>
<div class="line"><a name="l03400"></a><span class="lineno"> 3400</span>&#160;                <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l03401"></a><span class="lineno"> 3401</span>&#160;                  rejs[0] = nowRejectionRate;</div>
<div class="line"><a name="l03402"></a><span class="lineno"> 3402</span>&#160;                  rejs[1] = beforeRejectionRate;</div>
<div class="line"><a name="l03403"></a><span class="lineno"> 3403</span>&#160;                }</div>
<div class="line"><a name="l03404"></a><span class="lineno"> 3404</span>&#160;              }</div>
<div class="line"><a name="l03405"></a><span class="lineno"> 3405</span>&#160;              <span class="keywordflow">else</span> <span class="keywordflow">if</span> ((beforeRejectionRateIsBelowRange == <span class="keyword">false</span>) &amp;&amp;</div>
<div class="line"><a name="l03406"></a><span class="lineno"> 3406</span>&#160;                       (nowRejectionRateIsBelowRange    == <span class="keyword">true</span> )) {</div>
<div class="line"><a name="l03407"></a><span class="lineno"> 3407</span>&#160;                useMiddlePointLogicForEta = <span class="keyword">true</span>;</div>
<div class="line"><a name="l03408"></a><span class="lineno"> 3408</span>&#160;</div>
<div class="line"><a name="l03409"></a><span class="lineno"> 3409</span>&#160;                <span class="comment">// This is the first time the middle point logic will be used below</span></div>
<div class="line"><a name="l03410"></a><span class="lineno"> 3410</span>&#160;                etas[0] = std::min(beforeEta,nowEta);</div>
<div class="line"><a name="l03411"></a><span class="lineno"> 3411</span>&#160;                etas[1] = std::max(beforeEta,nowEta);</div>
<div class="line"><a name="l03412"></a><span class="lineno"> 3412</span>&#160;              }</div>
<div class="line"><a name="l03413"></a><span class="lineno"> 3413</span>&#160;              <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l03414"></a><span class="lineno"> 3414</span>&#160;                <a class="code" href="_defines_8h.html#a56d63d18d0a6d45757de47fcc06f574d">UQ_FATAL_TEST_MACRO</a>(<span class="keyword">true</span>,</div>
<div class="line"><a name="l03415"></a><span class="lineno"> 3415</span>&#160;                                    <a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#a78b57112bbd0e6dd0e8afec00b40ffa7">worldRank</a>(),</div>
<div class="line"><a name="l03416"></a><span class="lineno"> 3416</span>&#160;                                    <span class="stringliteral">&quot;MLSampling&lt;P_V,P_M&gt;::generateSequence_Step09_all()&quot;</span>,</div>
<div class="line"><a name="l03417"></a><span class="lineno"> 3417</span>&#160;                                    <span class="stringliteral">&quot;before and now range flags are inconsistent&quot;</span>);</div>
<div class="line"><a name="l03418"></a><span class="lineno"> 3418</span>&#160;              }</div>
<div class="line"><a name="l03419"></a><span class="lineno"> 3419</span>&#160;            } <span class="comment">// if (useMiddlePointLogicForEta == false)</span></div>
<div class="line"><a name="l03420"></a><span class="lineno"> 3420</span>&#160;</div>
<div class="line"><a name="l03421"></a><span class="lineno"> 3421</span>&#160;            beforeEta                       = nowEta;</div>
<div class="line"><a name="l03422"></a><span class="lineno"> 3422</span>&#160;            beforeRejectionRate             = nowRejectionRate;</div>
<div class="line"><a name="l03423"></a><span class="lineno"> 3423</span>&#160;            beforeRejectionRateIsBelowRange = nowRejectionRateIsBelowRange;</div>
<div class="line"><a name="l03424"></a><span class="lineno"> 3424</span>&#160;            <span class="keywordflow">if</span> (useMiddlePointLogicForEta == <span class="keyword">false</span>) {</div>
<div class="line"><a name="l03425"></a><span class="lineno"> 3425</span>&#160;              <span class="keywordflow">if</span> (beforeRejectionRateIsBelowRange) nowEta *= 4.;</div>
<div class="line"><a name="l03426"></a><span class="lineno"> 3426</span>&#160;              <span class="keywordflow">else</span>                                 nowEta /= 4.;</div>
<div class="line"><a name="l03427"></a><span class="lineno"> 3427</span>&#160;              <span class="keywordflow">if</span> ((<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#a8a0064746ae8dddfece4229b9ad374d6">subDisplayFile</a>()) &amp;&amp; (<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#a1fe5f244fc0316a0ab3e37463f108b96">displayVerbosity</a>() &gt;= 0)) {</div>
<div class="line"><a name="l03428"></a><span class="lineno"> 3428</span>&#160;                *<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#a8a0064746ae8dddfece4229b9ad374d6">subDisplayFile</a>() &lt;&lt; <span class="stringliteral">&quot;In MLSampling&lt;P_V,P_M&gt;::generateSequence_Step09_all()&quot;</span></div>
<div class="line"><a name="l03429"></a><span class="lineno"> 3429</span>&#160;                                        &lt;&lt; <span class="stringliteral">&quot;, level &quot;</span> &lt;&lt; <a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#af9416874c856e50f3b35270e801f17e4">m_currLevel</a>+<a class="code" href="_m_l_sampling_level_options_8h.html#a68d15eaf394d210effcf584b938206d3">LEVEL_REF_ID</a></div>
<div class="line"><a name="l03430"></a><span class="lineno"> 3430</span>&#160;                                        &lt;&lt; <span class="stringliteral">&quot;, step &quot;</span>  &lt;&lt; <a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a1b1f8ccb4823bdfa26ec652f0807c63e">m_currStep</a></div>
<div class="line"><a name="l03431"></a><span class="lineno"> 3431</span>&#160;                                        &lt;&lt; <span class="stringliteral">&quot;: in loop for assessing rejection rate&quot;</span></div>
<div class="line"><a name="l03432"></a><span class="lineno"> 3432</span>&#160;                                        &lt;&lt; <span class="stringliteral">&quot;, with nowAttempt = &quot;</span>  &lt;&lt; nowAttempt</div>
<div class="line"><a name="l03433"></a><span class="lineno"> 3433</span>&#160;                                        &lt;&lt; <span class="stringliteral">&quot;, useMiddlePointLogicForEta = false&quot;</span></div>
<div class="line"><a name="l03434"></a><span class="lineno"> 3434</span>&#160;                                        &lt;&lt; <span class="stringliteral">&quot;, nowEta just updated to value (to be tested) &quot;</span> &lt;&lt; nowEta</div>
<div class="line"><a name="l03435"></a><span class="lineno"> 3435</span>&#160;                                        &lt;&lt; std::endl;</div>
<div class="line"><a name="l03436"></a><span class="lineno"> 3436</span>&#160;              }</div>
<div class="line"><a name="l03437"></a><span class="lineno"> 3437</span>&#160;            }</div>
<div class="line"><a name="l03438"></a><span class="lineno"> 3438</span>&#160;            <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l03439"></a><span class="lineno"> 3439</span>&#160;              <span class="keywordflow">if</span> (nowRejectionRate &gt; meanRejectionRate) {</div>
<div class="line"><a name="l03440"></a><span class="lineno"> 3440</span>&#160;                <span class="keywordflow">if</span> (rejs[0] &gt; meanRejectionRate) {</div>
<div class="line"><a name="l03441"></a><span class="lineno"> 3441</span>&#160;                  etas[0] = nowEta;</div>
<div class="line"><a name="l03442"></a><span class="lineno"> 3442</span>&#160;                  etas[1] = etas[1];</div>
<div class="line"><a name="l03443"></a><span class="lineno"> 3443</span>&#160;                }</div>
<div class="line"><a name="l03444"></a><span class="lineno"> 3444</span>&#160;                <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l03445"></a><span class="lineno"> 3445</span>&#160;                  etas[0] = etas[0];</div>
<div class="line"><a name="l03446"></a><span class="lineno"> 3446</span>&#160;                  etas[1] = nowEta;</div>
<div class="line"><a name="l03447"></a><span class="lineno"> 3447</span>&#160;                }</div>
<div class="line"><a name="l03448"></a><span class="lineno"> 3448</span>&#160;              }</div>
<div class="line"><a name="l03449"></a><span class="lineno"> 3449</span>&#160;              <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l03450"></a><span class="lineno"> 3450</span>&#160;                <span class="keywordflow">if</span> (rejs[0] &lt; meanRejectionRate) {</div>
<div class="line"><a name="l03451"></a><span class="lineno"> 3451</span>&#160;                  etas[0] = nowEta;</div>
<div class="line"><a name="l03452"></a><span class="lineno"> 3452</span>&#160;                  etas[1] = etas[1];</div>
<div class="line"><a name="l03453"></a><span class="lineno"> 3453</span>&#160;                }</div>
<div class="line"><a name="l03454"></a><span class="lineno"> 3454</span>&#160;                <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l03455"></a><span class="lineno"> 3455</span>&#160;                  etas[0] = etas[0];</div>
<div class="line"><a name="l03456"></a><span class="lineno"> 3456</span>&#160;                  etas[1] = nowEta;</div>
<div class="line"><a name="l03457"></a><span class="lineno"> 3457</span>&#160;                }</div>
<div class="line"><a name="l03458"></a><span class="lineno"> 3458</span>&#160;              }</div>
<div class="line"><a name="l03459"></a><span class="lineno"> 3459</span>&#160;              nowEta = .5*(etas[0] + etas[1]);</div>
<div class="line"><a name="l03460"></a><span class="lineno"> 3460</span>&#160;              <span class="keywordflow">if</span> ((<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#a8a0064746ae8dddfece4229b9ad374d6">subDisplayFile</a>()) &amp;&amp; (<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#a1fe5f244fc0316a0ab3e37463f108b96">displayVerbosity</a>() &gt;= 0)) {</div>
<div class="line"><a name="l03461"></a><span class="lineno"> 3461</span>&#160;                *<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#a8a0064746ae8dddfece4229b9ad374d6">subDisplayFile</a>() &lt;&lt; <span class="stringliteral">&quot;In MLSampling&lt;P_V,P_M&gt;::generateSequence_Step09_all()&quot;</span></div>
<div class="line"><a name="l03462"></a><span class="lineno"> 3462</span>&#160;                                        &lt;&lt; <span class="stringliteral">&quot;, level &quot;</span> &lt;&lt; <a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#af9416874c856e50f3b35270e801f17e4">m_currLevel</a>+<a class="code" href="_m_l_sampling_level_options_8h.html#a68d15eaf394d210effcf584b938206d3">LEVEL_REF_ID</a></div>
<div class="line"><a name="l03463"></a><span class="lineno"> 3463</span>&#160;                                        &lt;&lt; <span class="stringliteral">&quot;, step &quot;</span>  &lt;&lt; <a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a1b1f8ccb4823bdfa26ec652f0807c63e">m_currStep</a></div>
<div class="line"><a name="l03464"></a><span class="lineno"> 3464</span>&#160;                                        &lt;&lt; <span class="stringliteral">&quot;: in loop for assessing rejection rate&quot;</span></div>
<div class="line"><a name="l03465"></a><span class="lineno"> 3465</span>&#160;                                        &lt;&lt; <span class="stringliteral">&quot;, with nowAttempt = &quot;</span> &lt;&lt; nowAttempt</div>
<div class="line"><a name="l03466"></a><span class="lineno"> 3466</span>&#160;                                        &lt;&lt; <span class="stringliteral">&quot;, useMiddlePointLogicForEta = true&quot;</span></div>
<div class="line"><a name="l03467"></a><span class="lineno"> 3467</span>&#160;                                        &lt;&lt; <span class="stringliteral">&quot;, nowEta just updated to value (to be tested) &quot;</span> &lt;&lt; nowEta</div>
<div class="line"><a name="l03468"></a><span class="lineno"> 3468</span>&#160;                                        &lt;&lt; <span class="stringliteral">&quot;, etas[0] = &quot;</span> &lt;&lt; etas[0]</div>
<div class="line"><a name="l03469"></a><span class="lineno"> 3469</span>&#160;                                        &lt;&lt; <span class="stringliteral">&quot;, etas[1] = &quot;</span> &lt;&lt; etas[1]</div>
<div class="line"><a name="l03470"></a><span class="lineno"> 3470</span>&#160;                                        &lt;&lt; std::endl;</div>
<div class="line"><a name="l03471"></a><span class="lineno"> 3471</span>&#160;              }</div>
<div class="line"><a name="l03472"></a><span class="lineno"> 3472</span>&#160;            }</div>
<div class="line"><a name="l03473"></a><span class="lineno"> 3473</span>&#160;          } <span class="comment">// if (nowAttempt &gt; 0)</span></div>
<div class="line"><a name="l03474"></a><span class="lineno"> 3474</span>&#160;        } <span class="comment">// if (m_env.inter0Rank() &gt;= 0) // KAUST</span></div>
<div class="line"><a name="l03475"></a><span class="lineno"> 3475</span>&#160;</div>
<div class="line"><a name="l03476"></a><span class="lineno"> 3476</span>&#160;        nowCovMatrix *= nowEta;</div>
<div class="line"><a name="l03477"></a><span class="lineno"> 3477</span>&#160;</div>
<div class="line"><a name="l03478"></a><span class="lineno"> 3478</span>&#160;        <span class="comment">// prudencio 2010-12-09: logic &#39;originalSubNumSamples += 1&#39; added because of the difference of results between GNU and INTEL compiled codes</span></div>
<div class="line"><a name="l03479"></a><span class="lineno"> 3479</span>&#160;        <span class="keywordtype">double</span>       doubSubNumSamples     = (1.-meanRejectionRate)/meanRejectionRate/currOptions-&gt;m_covRejectionRate/currOptions-&gt;m_covRejectionRate; <span class="comment">// e.g. 19.99...; or 20.0; or 20.1; or 20.9</span></div>
<div class="line"><a name="l03480"></a><span class="lineno"> 3480</span>&#160;        <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> originalSubNumSamples = 1 + (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>) (doubSubNumSamples); <span class="comment">// e.g. 20; or 21; or 21; or 21</span></div>
<div class="line"><a name="l03481"></a><span class="lineno"> 3481</span>&#160;        <span class="keywordtype">double</span>       auxDouble             = (double) originalSubNumSamples; <span class="comment">// e.g. 20.0; or 21.0; or 21.0; or 21.0</span></div>
<div class="line"><a name="l03482"></a><span class="lineno"> 3482</span>&#160;        <span class="keywordflow">if</span> ((auxDouble - doubSubNumSamples) &lt; 1.e-8) { <span class="comment">// e.g. 0.00...01; or 1.0; or 0.9; or 0.1</span></div>
<div class="line"><a name="l03483"></a><span class="lineno"> 3483</span>&#160;          originalSubNumSamples += 1;</div>
<div class="line"><a name="l03484"></a><span class="lineno"> 3484</span>&#160;        }</div>
<div class="line"><a name="l03485"></a><span class="lineno"> 3485</span>&#160;</div>
<div class="line"><a name="l03486"></a><span class="lineno"> 3486</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#ae106b5bb8a80b655b88b3a26b1e7c185">inter0Rank</a>() &gt;= 0) { <span class="comment">// KAUST</span></div>
<div class="line"><a name="l03487"></a><span class="lineno"> 3487</span>&#160;          <span class="keywordflow">if</span> ((<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#a8a0064746ae8dddfece4229b9ad374d6">subDisplayFile</a>()) &amp;&amp; (<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#a1fe5f244fc0316a0ab3e37463f108b96">displayVerbosity</a>() &gt;= 0)) {</div>
<div class="line"><a name="l03488"></a><span class="lineno"> 3488</span>&#160;            *<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#a8a0064746ae8dddfece4229b9ad374d6">subDisplayFile</a>() &lt;&lt; <span class="stringliteral">&quot;In MLSampling&lt;P_V,P_M&gt;::generateSequence_Step09_all()&quot;</span></div>
<div class="line"><a name="l03489"></a><span class="lineno"> 3489</span>&#160;                                    &lt;&lt; <span class="stringliteral">&quot;, level &quot;</span> &lt;&lt; <a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#af9416874c856e50f3b35270e801f17e4">m_currLevel</a>+<a class="code" href="_m_l_sampling_level_options_8h.html#a68d15eaf394d210effcf584b938206d3">LEVEL_REF_ID</a></div>
<div class="line"><a name="l03490"></a><span class="lineno"> 3490</span>&#160;                                    &lt;&lt; <span class="stringliteral">&quot;, step &quot;</span>  &lt;&lt; <a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a1b1f8ccb4823bdfa26ec652f0807c63e">m_currStep</a></div>
<div class="line"><a name="l03491"></a><span class="lineno"> 3491</span>&#160;                                    &lt;&lt; <span class="stringliteral">&quot;: in loop for assessing rejection rate&quot;</span></div>
<div class="line"><a name="l03492"></a><span class="lineno"> 3492</span>&#160;                                    &lt;&lt; <span class="stringliteral">&quot;, about to sample &quot;</span>     &lt;&lt; originalSubNumSamples &lt;&lt; <span class="stringliteral">&quot; indexes&quot;</span></div>
<div class="line"><a name="l03493"></a><span class="lineno"> 3493</span>&#160;                                    &lt;&lt; <span class="stringliteral">&quot;, meanRejectionRate = &quot;</span> &lt;&lt; meanRejectionRate</div>
<div class="line"><a name="l03494"></a><span class="lineno"> 3494</span>&#160;                                    &lt;&lt; <span class="stringliteral">&quot;, covRejectionRate = &quot;</span>  &lt;&lt; currOptions-&gt;m_covRejectionRate</div>
<div class="line"><a name="l03495"></a><span class="lineno"> 3495</span>&#160;                                    &lt;&lt; std::endl;</div>
<div class="line"><a name="l03496"></a><span class="lineno"> 3496</span>&#160;          }</div>
<div class="line"><a name="l03497"></a><span class="lineno"> 3497</span>&#160;        } <span class="comment">// KAUST</span></div>
<div class="line"><a name="l03498"></a><span class="lineno"> 3498</span>&#160;</div>
<div class="line"><a name="l03499"></a><span class="lineno"> 3499</span>&#160;        std::vector&lt;unsigned int&gt; nowUnifiedIndexCountersAtProc0Only(0); <span class="comment">// It will be resized by &#39;sampleIndexes_proc0()&#39; below</span></div>
<div class="line"><a name="l03500"></a><span class="lineno"> 3500</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#ae106b5bb8a80b655b88b3a26b1e7c185">inter0Rank</a>() &gt;= 0) { <span class="comment">// KAUST</span></div>
<div class="line"><a name="l03501"></a><span class="lineno"> 3501</span>&#160;          <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> tmpUnifiedNumSamples = originalSubNumSamples*<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#a689e4d140c74d495d97eb498714a4b82">inter0Comm</a>().<a class="code" href="class_q_u_e_s_o_1_1_mpi_comm.html#aa780721ae0fdeabc5a15e04cb0cad964">NumProc</a>();</div>
<div class="line"><a name="l03502"></a><span class="lineno"> 3502</span>&#160;          <a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#af71979655e46135b6a3c97b8909321f0">sampleIndexes_proc0</a>(tmpUnifiedNumSamples,                <span class="comment">// input</span></div>
<div class="line"><a name="l03503"></a><span class="lineno"> 3503</span>&#160;                              unifiedWeightStdVectorAtProc0Only,   <span class="comment">// input</span></div>
<div class="line"><a name="l03504"></a><span class="lineno"> 3504</span>&#160;                              nowUnifiedIndexCountersAtProc0Only); <span class="comment">// output</span></div>
<div class="line"><a name="l03505"></a><span class="lineno"> 3505</span>&#160;</div>
<div class="line"><a name="l03506"></a><span class="lineno"> 3506</span>&#160;          <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> auxUnifiedSize = weightSequence.<a class="code" href="class_q_u_e_s_o_1_1_scalar_sequence.html#a52829afc95e5c36e9db44f40854153b0">unifiedSequenceSize</a>(<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a7bc4c72f65ba9166ed94a6e198b0915b">m_vectorSpace</a>.<a class="code" href="class_q_u_e_s_o_1_1_vector_space.html#a67b0c3620662116f5a346fdaa5faf38e">numOfProcsForStorage</a>() == 1);</div>
<div class="line"><a name="l03507"></a><span class="lineno"> 3507</span>&#160;          <span class="keywordflow">if</span> (<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#ae106b5bb8a80b655b88b3a26b1e7c185">inter0Rank</a>() == 0) {</div>
<div class="line"><a name="l03508"></a><span class="lineno"> 3508</span>&#160;            <a class="code" href="_defines_8h.html#a56d63d18d0a6d45757de47fcc06f574d">UQ_FATAL_TEST_MACRO</a>(nowUnifiedIndexCountersAtProc0Only.size() != auxUnifiedSize,</div>
<div class="line"><a name="l03509"></a><span class="lineno"> 3509</span>&#160;                                <a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#a78b57112bbd0e6dd0e8afec00b40ffa7">worldRank</a>(),</div>
<div class="line"><a name="l03510"></a><span class="lineno"> 3510</span>&#160;                                <span class="stringliteral">&quot;MLSampling&lt;P_V,P_M&gt;::generateSequence_Step09_all()&quot;</span>,</div>
<div class="line"><a name="l03511"></a><span class="lineno"> 3511</span>&#160;                                <span class="stringliteral">&quot;wrong output from sampleIndexesAtProc0() in step 9&quot;</span>);</div>
<div class="line"><a name="l03512"></a><span class="lineno"> 3512</span>&#160;          }</div>
<div class="line"><a name="l03513"></a><span class="lineno"> 3513</span>&#160;</div>
<div class="line"><a name="l03514"></a><span class="lineno"> 3514</span>&#160;          <span class="keywordflow">if</span> ((<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#a8a0064746ae8dddfece4229b9ad374d6">subDisplayFile</a>()) &amp;&amp; (<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#a1fe5f244fc0316a0ab3e37463f108b96">displayVerbosity</a>() &gt;= 0)) {</div>
<div class="line"><a name="l03515"></a><span class="lineno"> 3515</span>&#160;            *<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#a8a0064746ae8dddfece4229b9ad374d6">subDisplayFile</a>() &lt;&lt; <span class="stringliteral">&quot;In MLSampling&lt;P_V,P_M&gt;::generateSequence_Step09_all()&quot;</span></div>
<div class="line"><a name="l03516"></a><span class="lineno"> 3516</span>&#160;                                    &lt;&lt; <span class="stringliteral">&quot;, level &quot;</span> &lt;&lt; <a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#af9416874c856e50f3b35270e801f17e4">m_currLevel</a>+<a class="code" href="_m_l_sampling_level_options_8h.html#a68d15eaf394d210effcf584b938206d3">LEVEL_REF_ID</a></div>
<div class="line"><a name="l03517"></a><span class="lineno"> 3517</span>&#160;                                    &lt;&lt; <span class="stringliteral">&quot;, step &quot;</span>  &lt;&lt; <a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a1b1f8ccb4823bdfa26ec652f0807c63e">m_currStep</a></div>
<div class="line"><a name="l03518"></a><span class="lineno"> 3518</span>&#160;                                    &lt;&lt; <span class="stringliteral">&quot;: in loop for assessing rejection rate&quot;</span></div>
<div class="line"><a name="l03519"></a><span class="lineno"> 3519</span>&#160;                                    &lt;&lt; <span class="stringliteral">&quot;, about to distribute sampled assessment indexes&quot;</span></div>
<div class="line"><a name="l03520"></a><span class="lineno"> 3520</span>&#160;                                    &lt;&lt; std::endl;</div>
<div class="line"><a name="l03521"></a><span class="lineno"> 3521</span>&#160;          }</div>
<div class="line"><a name="l03522"></a><span class="lineno"> 3522</span>&#160;        } <span class="comment">// KAUST</span></div>
<div class="line"><a name="l03523"></a><span class="lineno"> 3523</span>&#160;</div>
<div class="line"><a name="l03524"></a><span class="lineno"> 3524</span>&#160;        std::vector&lt;ExchangeInfoStruct&gt;        exchangeStdVec(0);</div>
<div class="line"><a name="l03525"></a><span class="lineno"> 3525</span>&#160;        BalancedLinkedChainsPerNodeStruct&lt;P_V&gt; nowBalLinkControl;</div>
<div class="line"><a name="l03526"></a><span class="lineno"> 3526</span>&#160;        UnbalancedLinkedChainsPerNodeStruct    nowUnbLinkControl; <span class="comment">// KAUST</span></div>
<div class="line"><a name="l03527"></a><span class="lineno"> 3527</span>&#160;</div>
<div class="line"><a name="l03528"></a><span class="lineno"> 3528</span>&#160;        <span class="comment">// All processors should call this routine in order to have the same decision value</span></div>
<div class="line"><a name="l03529"></a><span class="lineno"> 3529</span>&#160;        <span class="keywordtype">bool</span> useBalancedChains = <a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a0f6f7872635b9546b3215fee347601f6">decideOnBalancedChains_all</a>(currOptions,                        <span class="comment">// input</span></div>
<div class="line"><a name="l03530"></a><span class="lineno"> 3530</span>&#160;                                                            indexOfFirstWeight,                 <span class="comment">// input</span></div>
<div class="line"><a name="l03531"></a><span class="lineno"> 3531</span>&#160;                                                            indexOfLastWeight,                  <span class="comment">// input</span></div>
<div class="line"><a name="l03532"></a><span class="lineno"> 3532</span>&#160;                                                            nowUnifiedIndexCountersAtProc0Only, <span class="comment">// input</span></div>
<div class="line"><a name="l03533"></a><span class="lineno"> 3533</span>&#160;                                                            exchangeStdVec);                    <span class="comment">// output</span></div>
<div class="line"><a name="l03534"></a><span class="lineno"> 3534</span>&#160;</div>
<div class="line"><a name="l03535"></a><span class="lineno"> 3535</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#ae106b5bb8a80b655b88b3a26b1e7c185">inter0Rank</a>() &gt;= 0) { <span class="comment">// KAUST</span></div>
<div class="line"><a name="l03536"></a><span class="lineno"> 3536</span>&#160;          <span class="keywordflow">if</span> (useBalancedChains) {</div>
<div class="line"><a name="l03537"></a><span class="lineno"> 3537</span>&#160;            <a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a75b2d73a0b07f594951a89cc1bc96849">prepareBalLinkedChains_inter0</a>(currOptions,                        <span class="comment">// input</span></div>
<div class="line"><a name="l03538"></a><span class="lineno"> 3538</span>&#160;                                          prevChain,                          <span class="comment">// input</span></div>
<div class="line"><a name="l03539"></a><span class="lineno"> 3539</span>&#160;                                          exchangeStdVec,                     <span class="comment">// input/output</span></div>
<div class="line"><a name="l03540"></a><span class="lineno"> 3540</span>&#160;                                          nowBalLinkControl);                 <span class="comment">// output</span></div>
<div class="line"><a name="l03541"></a><span class="lineno"> 3541</span>&#160;          }</div>
<div class="line"><a name="l03542"></a><span class="lineno"> 3542</span>&#160;          <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l03543"></a><span class="lineno"> 3543</span>&#160;            <a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a37dcf4d893b6c8f67fe077892bada773">prepareUnbLinkedChains_inter0</a>(indexOfFirstWeight,                 <span class="comment">// input</span></div>
<div class="line"><a name="l03544"></a><span class="lineno"> 3544</span>&#160;                                          indexOfLastWeight,                  <span class="comment">// input</span></div>
<div class="line"><a name="l03545"></a><span class="lineno"> 3545</span>&#160;                                          nowUnifiedIndexCountersAtProc0Only, <span class="comment">// input</span></div>
<div class="line"><a name="l03546"></a><span class="lineno"> 3546</span>&#160;                                          nowUnbLinkControl);                 <span class="comment">// output</span></div>
<div class="line"><a name="l03547"></a><span class="lineno"> 3547</span>&#160;          }</div>
<div class="line"><a name="l03548"></a><span class="lineno"> 3548</span>&#160;        } <span class="comment">// KAUST</span></div>
<div class="line"><a name="l03549"></a><span class="lineno"> 3549</span>&#160;</div>
<div class="line"><a name="l03550"></a><span class="lineno"> 3550</span>&#160;        <span class="keywordflow">if</span> ((<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#a8a0064746ae8dddfece4229b9ad374d6">subDisplayFile</a>()) &amp;&amp; (<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#a1fe5f244fc0316a0ab3e37463f108b96">displayVerbosity</a>() &gt;= 0)) {</div>
<div class="line"><a name="l03551"></a><span class="lineno"> 3551</span>&#160;          *<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#a8a0064746ae8dddfece4229b9ad374d6">subDisplayFile</a>() &lt;&lt; <span class="stringliteral">&quot;In MLSampling&lt;P_V,P_M&gt;::generateSequence_Step09_all()&quot;</span></div>
<div class="line"><a name="l03552"></a><span class="lineno"> 3552</span>&#160;                                  &lt;&lt; <span class="stringliteral">&quot;, level &quot;</span> &lt;&lt; <a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#af9416874c856e50f3b35270e801f17e4">m_currLevel</a>+<a class="code" href="_m_l_sampling_level_options_8h.html#a68d15eaf394d210effcf584b938206d3">LEVEL_REF_ID</a></div>
<div class="line"><a name="l03553"></a><span class="lineno"> 3553</span>&#160;                                  &lt;&lt; <span class="stringliteral">&quot;, step &quot;</span>  &lt;&lt; <a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a1b1f8ccb4823bdfa26ec652f0807c63e">m_currStep</a></div>
<div class="line"><a name="l03554"></a><span class="lineno"> 3554</span>&#160;                                  &lt;&lt; <span class="stringliteral">&quot;: in loop for assessing rejection rate&quot;</span></div>
<div class="line"><a name="l03555"></a><span class="lineno"> 3555</span>&#160;                                  &lt;&lt; <span class="stringliteral">&quot;, about to generate assessment chain&quot;</span></div>
<div class="line"><a name="l03556"></a><span class="lineno"> 3556</span>&#160;                                  &lt;&lt; std::endl;</div>
<div class="line"><a name="l03557"></a><span class="lineno"> 3557</span>&#160;        }</div>
<div class="line"><a name="l03558"></a><span class="lineno"> 3558</span>&#160;</div>
<div class="line"><a name="l03559"></a><span class="lineno"> 3559</span>&#160;        SequenceOfVectors&lt;P_V,P_M&gt; nowChain(<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a7bc4c72f65ba9166ed94a6e198b0915b">m_vectorSpace</a>,</div>
<div class="line"><a name="l03560"></a><span class="lineno"> 3560</span>&#160;                                                   0,</div>
<div class="line"><a name="l03561"></a><span class="lineno"> 3561</span>&#160;                                                   <a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#af8504cc57ec72b3c52833826b2bfff8e">m_options</a>.<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling_options.html#a1d3d48598e0b59b46337ce66a52671a5">m_prefix</a>+<span class="stringliteral">&quot;now_chain&quot;</span>);</div>
<div class="line"><a name="l03562"></a><span class="lineno"> 3562</span>&#160;        <span class="keywordtype">double</span>       nowRunTime    = 0.;</div>
<div class="line"><a name="l03563"></a><span class="lineno"> 3563</span>&#160;        <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> nowRejections = 0;</div>
<div class="line"><a name="l03564"></a><span class="lineno"> 3564</span>&#160;</div>
<div class="line"><a name="l03565"></a><span class="lineno"> 3565</span>&#160;        <span class="comment">// KAUST: all nodes should call here</span></div>
<div class="line"><a name="l03566"></a><span class="lineno"> 3566</span>&#160;        <span class="keywordtype">bool</span>         savedTotallyMute           = currOptions-&gt;m_totallyMute; <span class="comment">// HERE - ENHANCEMENT</span></div>
<div class="line"><a name="l03567"></a><span class="lineno"> 3567</span>&#160;        <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> savedRawChainSize          = currOptions-&gt;m_rawChainSize; <span class="comment">// Ok to use rawChainSize</span></div>
<div class="line"><a name="l03568"></a><span class="lineno"> 3568</span>&#160;<span class="preprocessor">#ifdef QUESO_USES_SEQUENCE_STATISTICAL_OPTIONS</span></div>
<div class="line"><a name="l03569"></a><span class="lineno"> 3569</span>&#160;<span class="preprocessor"></span>        <span class="keywordtype">bool</span>         savedRawChainComputeStats  = currOptions-&gt;m_rawChainComputeStats;</div>
<div class="line"><a name="l03570"></a><span class="lineno"> 3570</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l03571"></a><span class="lineno"> 3571</span>&#160;<span class="preprocessor"></span>        <span class="keywordtype">bool</span>         savedFilteredChainGenerate = currOptions-&gt;m_filteredChainGenerate;</div>
<div class="line"><a name="l03572"></a><span class="lineno"> 3572</span>&#160;        <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> savedDrMaxNumExtraStages   = currOptions-&gt;m_drMaxNumExtraStages;</div>
<div class="line"><a name="l03573"></a><span class="lineno"> 3573</span>&#160;        <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> savedAmAdaptInterval       = currOptions-&gt;m_amAdaptInterval;</div>
<div class="line"><a name="l03574"></a><span class="lineno"> 3574</span>&#160;</div>
<div class="line"><a name="l03575"></a><span class="lineno"> 3575</span>&#160;        currOptions-&gt;m_totallyMute = <span class="keyword">true</span>;</div>
<div class="line"><a name="l03576"></a><span class="lineno"> 3576</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#a1fe5f244fc0316a0ab3e37463f108b96">displayVerbosity</a>() &gt;= 999999) {</div>
<div class="line"><a name="l03577"></a><span class="lineno"> 3577</span>&#160;          currOptions-&gt;m_totallyMute = <span class="keyword">false</span>;</div>
<div class="line"><a name="l03578"></a><span class="lineno"> 3578</span>&#160;        }</div>
<div class="line"><a name="l03579"></a><span class="lineno"> 3579</span>&#160;        currOptions-&gt;m_rawChainSize          = 0; <span class="comment">// will be set inside generateXYZLinkedChains()</span></div>
<div class="line"><a name="l03580"></a><span class="lineno"> 3580</span>&#160;<span class="preprocessor">#ifdef QUESO_USES_SEQUENCE_STATISTICAL_OPTIONS</span></div>
<div class="line"><a name="l03581"></a><span class="lineno"> 3581</span>&#160;<span class="preprocessor"></span>        currOptions-&gt;m_rawChainComputeStats  = <span class="keyword">false</span>;</div>
<div class="line"><a name="l03582"></a><span class="lineno"> 3582</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l03583"></a><span class="lineno"> 3583</span>&#160;<span class="preprocessor"></span>        currOptions-&gt;m_filteredChainGenerate = <span class="keyword">false</span>;</div>
<div class="line"><a name="l03584"></a><span class="lineno"> 3584</span>&#160;        currOptions-&gt;m_drMaxNumExtraStages   = 0;</div>
<div class="line"><a name="l03585"></a><span class="lineno"> 3585</span>&#160;        currOptions-&gt;m_amAdaptInterval       = 0;</div>
<div class="line"><a name="l03586"></a><span class="lineno"> 3586</span>&#160;</div>
<div class="line"><a name="l03587"></a><span class="lineno"> 3587</span>&#160;        <span class="comment">// KAUST: all nodes in &#39;subComm&#39; should call here, important</span></div>
<div class="line"><a name="l03588"></a><span class="lineno"> 3588</span>&#160;        <span class="keywordflow">if</span> (useBalancedChains) {</div>
<div class="line"><a name="l03589"></a><span class="lineno"> 3589</span>&#160;          <a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a8e9d7681d17623c726814d206c8be4b2">generateBalLinkedChains_all</a>(*currOptions,       <span class="comment">// input, only m_rawChainSize changes</span></div>
<div class="line"><a name="l03590"></a><span class="lineno"> 3590</span>&#160;                                      nowCovMatrix,       <span class="comment">// input</span></div>
<div class="line"><a name="l03591"></a><span class="lineno"> 3591</span>&#160;                                      currRv,             <span class="comment">// input</span></div>
<div class="line"><a name="l03592"></a><span class="lineno"> 3592</span>&#160;                                      nowBalLinkControl,  <span class="comment">// input // Round Rock</span></div>
<div class="line"><a name="l03593"></a><span class="lineno"> 3593</span>&#160;                                      nowChain,           <span class="comment">// output</span></div>
<div class="line"><a name="l03594"></a><span class="lineno"> 3594</span>&#160;                                      nowRunTime,         <span class="comment">// output</span></div>
<div class="line"><a name="l03595"></a><span class="lineno"> 3595</span>&#160;                                      nowRejections,      <span class="comment">// output</span></div>
<div class="line"><a name="l03596"></a><span class="lineno"> 3596</span>&#160;                                      NULL,               <span class="comment">// output</span></div>
<div class="line"><a name="l03597"></a><span class="lineno"> 3597</span>&#160;                                      NULL);              <span class="comment">// output</span></div>
<div class="line"><a name="l03598"></a><span class="lineno"> 3598</span>&#160;        }</div>
<div class="line"><a name="l03599"></a><span class="lineno"> 3599</span>&#160;        <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l03600"></a><span class="lineno"> 3600</span>&#160;          <a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a04b0d797b321bb5c4047aab89a445e3c">generateUnbLinkedChains_all</a>(*currOptions,       <span class="comment">// input, only m_rawChainSize changes</span></div>
<div class="line"><a name="l03601"></a><span class="lineno"> 3601</span>&#160;                                      nowCovMatrix,       <span class="comment">// input</span></div>
<div class="line"><a name="l03602"></a><span class="lineno"> 3602</span>&#160;                                      currRv,             <span class="comment">// input</span></div>
<div class="line"><a name="l03603"></a><span class="lineno"> 3603</span>&#160;                                      nowUnbLinkControl,  <span class="comment">// input // Round Rock</span></div>
<div class="line"><a name="l03604"></a><span class="lineno"> 3604</span>&#160;                                      indexOfFirstWeight, <span class="comment">// input // Round Rock</span></div>
<div class="line"><a name="l03605"></a><span class="lineno"> 3605</span>&#160;                                      prevChain,          <span class="comment">// input // Round Rock</span></div>
<div class="line"><a name="l03606"></a><span class="lineno"> 3606</span>&#160;                                      nowChain,           <span class="comment">// output</span></div>
<div class="line"><a name="l03607"></a><span class="lineno"> 3607</span>&#160;                                      nowRunTime,         <span class="comment">// output</span></div>
<div class="line"><a name="l03608"></a><span class="lineno"> 3608</span>&#160;                                      nowRejections,      <span class="comment">// output</span></div>
<div class="line"><a name="l03609"></a><span class="lineno"> 3609</span>&#160;                                      NULL,               <span class="comment">// output</span></div>
<div class="line"><a name="l03610"></a><span class="lineno"> 3610</span>&#160;                                      NULL);              <span class="comment">// output</span></div>
<div class="line"><a name="l03611"></a><span class="lineno"> 3611</span>&#160;        }</div>
<div class="line"><a name="l03612"></a><span class="lineno"> 3612</span>&#160;</div>
<div class="line"><a name="l03613"></a><span class="lineno"> 3613</span>&#160;        <span class="comment">// KAUST: all nodes should call here</span></div>
<div class="line"><a name="l03614"></a><span class="lineno"> 3614</span>&#160;        currOptions-&gt;m_totallyMute           = savedTotallyMute;</div>
<div class="line"><a name="l03615"></a><span class="lineno"> 3615</span>&#160;        currOptions-&gt;m_rawChainSize          = savedRawChainSize;</div>
<div class="line"><a name="l03616"></a><span class="lineno"> 3616</span>&#160;<span class="preprocessor">#ifdef QUESO_USES_SEQUENCE_STATISTICAL_OPTIONS</span></div>
<div class="line"><a name="l03617"></a><span class="lineno"> 3617</span>&#160;<span class="preprocessor"></span>        currOptions-&gt;m_rawChainComputeStats  = savedRawChainComputeStats;</div>
<div class="line"><a name="l03618"></a><span class="lineno"> 3618</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l03619"></a><span class="lineno"> 3619</span>&#160;<span class="preprocessor"></span>        currOptions-&gt;m_filteredChainGenerate = savedFilteredChainGenerate; <span class="comment">// FIX ME</span></div>
<div class="line"><a name="l03620"></a><span class="lineno"> 3620</span>&#160;        currOptions-&gt;m_drMaxNumExtraStages   = savedDrMaxNumExtraStages;</div>
<div class="line"><a name="l03621"></a><span class="lineno"> 3621</span>&#160;        currOptions-&gt;m_amAdaptInterval       = savedAmAdaptInterval;</div>
<div class="line"><a name="l03622"></a><span class="lineno"> 3622</span>&#160;</div>
<div class="line"><a name="l03623"></a><span class="lineno"> 3623</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = 0; i &lt; nowBalLinkControl.balLinkedChains.size(); ++i) {</div>
<div class="line"><a name="l03624"></a><span class="lineno"> 3624</span>&#160;          <a class="code" href="_defines_8h.html#a56d63d18d0a6d45757de47fcc06f574d">UQ_FATAL_TEST_MACRO</a>(nowBalLinkControl.balLinkedChains[i].initialPosition == NULL,</div>
<div class="line"><a name="l03625"></a><span class="lineno"> 3625</span>&#160;                              <a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#a78b57112bbd0e6dd0e8afec00b40ffa7">worldRank</a>(),</div>
<div class="line"><a name="l03626"></a><span class="lineno"> 3626</span>&#160;                              <span class="stringliteral">&quot;MLSampling&lt;P_V,P_M&gt;::generateSequence_Step09_all()&quot;</span>,</div>
<div class="line"><a name="l03627"></a><span class="lineno"> 3627</span>&#160;                              <span class="stringliteral">&quot;Initial position pointer in step 9 should not be NULL&quot;</span>);</div>
<div class="line"><a name="l03628"></a><span class="lineno"> 3628</span>&#160;          <span class="keyword">delete</span> nowBalLinkControl.balLinkedChains[i].initialPosition;</div>
<div class="line"><a name="l03629"></a><span class="lineno"> 3629</span>&#160;          nowBalLinkControl.balLinkedChains[i].initialPosition = NULL;</div>
<div class="line"><a name="l03630"></a><span class="lineno"> 3630</span>&#160;        }</div>
<div class="line"><a name="l03631"></a><span class="lineno"> 3631</span>&#160;        nowBalLinkControl.balLinkedChains.clear();</div>
<div class="line"><a name="l03632"></a><span class="lineno"> 3632</span>&#160;</div>
<div class="line"><a name="l03633"></a><span class="lineno"> 3633</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#ae106b5bb8a80b655b88b3a26b1e7c185">inter0Rank</a>() &gt;= 0) { <span class="comment">// KAUST</span></div>
<div class="line"><a name="l03634"></a><span class="lineno"> 3634</span>&#160;          <span class="comment">// If only one cov matrix is used, then the rejection should be assessed among all inter0Comm nodes // KAUST3</span></div>
<div class="line"><a name="l03635"></a><span class="lineno"> 3635</span>&#160;          <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> nowUnifiedRejections = 0;</div>
<div class="line"><a name="l03636"></a><span class="lineno"> 3636</span>&#160;          <a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#a689e4d140c74d495d97eb498714a4b82">inter0Comm</a>().<a class="code" href="class_q_u_e_s_o_1_1_mpi_comm.html#a72e137e60ef8060efb1ee5fc874fa4b8">Allreduce</a>((<span class="keywordtype">void</span> *) &amp;nowRejections, (<span class="keywordtype">void</span> *) &amp;nowUnifiedRejections, (<span class="keywordtype">int</span>) 1, <a class="code" href="_mpi_comm_8h.html#a06cbfbc33436f6e0dc8a48ff3c49bdfc">RawValue_MPI_UNSIGNED</a>, <a class="code" href="_mpi_comm_8h.html#afbf78d291c032aa7f512bc566cee2bd1">RawValue_MPI_SUM</a>,</div>
<div class="line"><a name="l03637"></a><span class="lineno"> 3637</span>&#160;                                       <span class="stringliteral">&quot;MLSampling&lt;P_V,P_M&gt;::generateSequence_Step09_all()&quot;</span>,</div>
<div class="line"><a name="l03638"></a><span class="lineno"> 3638</span>&#160;                                       <span class="stringliteral">&quot;failed MPI.Allreduce() for now rejections&quot;</span>);</div>
<div class="line"><a name="l03639"></a><span class="lineno"> 3639</span>&#160;</div>
<div class="line"><a name="l03640"></a><span class="lineno"> 3640</span>&#160;<span class="preprocessor">#if 0 // Round Rock 2009 12 29</span></div>
<div class="line"><a name="l03641"></a><span class="lineno"> 3641</span>&#160;<span class="preprocessor"></span>          <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> tmpUnifiedNumSamples = 0;</div>
<div class="line"><a name="l03642"></a><span class="lineno"> 3642</span>&#160;          <a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#a689e4d140c74d495d97eb498714a4b82">inter0Comm</a>().<a class="code" href="class_q_u_e_s_o_1_1_mpi_comm.html#a72e137e60ef8060efb1ee5fc874fa4b8">Allreduce</a>((<span class="keywordtype">void</span> *) &amp;tmpSubNumSamples, (<span class="keywordtype">void</span> *) &amp;tmpUnifiedNumSamples, (<span class="keywordtype">int</span>) 1, <a class="code" href="_mpi_comm_8h.html#a06cbfbc33436f6e0dc8a48ff3c49bdfc">RawValue_MPI_UNSIGNED</a>, <a class="code" href="_mpi_comm_8h.html#afbf78d291c032aa7f512bc566cee2bd1">RawValue_MPI_SUM</a>,</div>
<div class="line"><a name="l03643"></a><span class="lineno"> 3643</span>&#160;                                       <span class="stringliteral">&quot;MLSampling&lt;P_V,P_M&gt;::generateSequence_Step09_all()&quot;</span>,</div>
<div class="line"><a name="l03644"></a><span class="lineno"> 3644</span>&#160;                                       <span class="stringliteral">&quot;failed MPI.Allreduce() for num samples in step 9&quot;</span>);</div>
<div class="line"><a name="l03645"></a><span class="lineno"> 3645</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l03646"></a><span class="lineno"> 3646</span>&#160;<span class="preprocessor"></span></div>
<div class="line"><a name="l03647"></a><span class="lineno"> 3647</span>&#160;          <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> tmpUnifiedNumSamples = originalSubNumSamples*<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#a689e4d140c74d495d97eb498714a4b82">inter0Comm</a>().<a class="code" href="class_q_u_e_s_o_1_1_mpi_comm.html#aa780721ae0fdeabc5a15e04cb0cad964">NumProc</a>();</div>
<div class="line"><a name="l03648"></a><span class="lineno"> 3648</span>&#160;          nowRejectionRate = ((double) nowUnifiedRejections) / ((double) tmpUnifiedNumSamples);</div>
<div class="line"><a name="l03649"></a><span class="lineno"> 3649</span>&#160;</div>
<div class="line"><a name="l03650"></a><span class="lineno"> 3650</span>&#160;          <span class="comment">//bool aux1 = (nowRejectionRate == meanRejectionRate);</span></div>
<div class="line"><a name="l03651"></a><span class="lineno"> 3651</span>&#160;          <span class="keywordtype">bool</span> aux2 = (nowRejectionRate &gt;= currOptions-&gt;m_minRejectionRate)</div>
<div class="line"><a name="l03652"></a><span class="lineno"> 3652</span>&#160;                      &amp;&amp;</div>
<div class="line"><a name="l03653"></a><span class="lineno"> 3653</span>&#160;                      (nowRejectionRate &lt;= currOptions-&gt;m_maxRejectionRate);</div>
<div class="line"><a name="l03654"></a><span class="lineno"> 3654</span>&#160;          testResult = aux2;</div>
<div class="line"><a name="l03655"></a><span class="lineno"> 3655</span>&#160;</div>
<div class="line"><a name="l03656"></a><span class="lineno"> 3656</span>&#160;          <span class="comment">// Make sure all nodes in &#39;inter0Comm&#39; have the same value of &#39;testResult&#39;</span></div>
<div class="line"><a name="l03657"></a><span class="lineno"> 3657</span>&#160;          <span class="keywordflow">if</span> (<a class="code" href="namespace_q_u_e_s_o.html#a4166a375c5adbea35afaaf20775bc519">MiscCheckForSameValueInAllNodes</a>(testResult,</div>
<div class="line"><a name="l03658"></a><span class="lineno"> 3658</span>&#160;                                                0., <span class="comment">// kept &#39;zero&#39; on 2010/03/03</span></div>
<div class="line"><a name="l03659"></a><span class="lineno"> 3659</span>&#160;                                                <a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#a689e4d140c74d495d97eb498714a4b82">inter0Comm</a>(),</div>
<div class="line"><a name="l03660"></a><span class="lineno"> 3660</span>&#160;                                                <span class="stringliteral">&quot;MLSampling&lt;P_V,P_M&gt;::generateSequence_Step09_all(), step 9, testResult&quot;</span>) == <span class="keyword">false</span>) {</div>
<div class="line"><a name="l03661"></a><span class="lineno"> 3661</span>&#160;            <span class="keywordflow">if</span> ((<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#a8a0064746ae8dddfece4229b9ad374d6">subDisplayFile</a>()) &amp;&amp; (<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#a1fe5f244fc0316a0ab3e37463f108b96">displayVerbosity</a>() &gt;= 0)) {</div>
<div class="line"><a name="l03662"></a><span class="lineno"> 3662</span>&#160;              *<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#a8a0064746ae8dddfece4229b9ad374d6">subDisplayFile</a>() &lt;&lt; <span class="stringliteral">&quot;WARNING, In MLSampling&lt;P_V,P_M&gt;::generateSequence()&quot;</span></div>
<div class="line"><a name="l03663"></a><span class="lineno"> 3663</span>&#160;                                      &lt;&lt; <span class="stringliteral">&quot;, level &quot;</span>        &lt;&lt; <a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#af9416874c856e50f3b35270e801f17e4">m_currLevel</a>+<a class="code" href="_m_l_sampling_level_options_8h.html#a68d15eaf394d210effcf584b938206d3">LEVEL_REF_ID</a></div>
<div class="line"><a name="l03664"></a><span class="lineno"> 3664</span>&#160;                                      &lt;&lt; <span class="stringliteral">&quot;, step &quot;</span>         &lt;&lt; <a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a1b1f8ccb4823bdfa26ec652f0807c63e">m_currStep</a></div>
<div class="line"><a name="l03665"></a><span class="lineno"> 3665</span>&#160;                                      &lt;&lt; <span class="stringliteral">&quot;: nowAttempt = &quot;</span> &lt;&lt; nowAttempt</div>
<div class="line"><a name="l03666"></a><span class="lineno"> 3666</span>&#160;                                      &lt;&lt; <span class="stringliteral">&quot;, MiscCheck for &#39;testResult&#39; detected a problem&quot;</span></div>
<div class="line"><a name="l03667"></a><span class="lineno"> 3667</span>&#160;                                      &lt;&lt; std::endl;</div>
<div class="line"><a name="l03668"></a><span class="lineno"> 3668</span>&#160;            }</div>
<div class="line"><a name="l03669"></a><span class="lineno"> 3669</span>&#160;    }</div>
<div class="line"><a name="l03670"></a><span class="lineno"> 3670</span>&#160;        } <span class="comment">// if (m_env.inter0Rank() &gt;= 0) { // KAUST</span></div>
<div class="line"><a name="l03671"></a><span class="lineno"> 3671</span>&#160;</div>
<div class="line"><a name="l03672"></a><span class="lineno"> 3672</span>&#160;        <span class="comment">// KAUST: all nodes in &#39;subComm&#39; should have the same &#39;testResult&#39;</span></div>
<div class="line"><a name="l03673"></a><span class="lineno"> 3673</span>&#160;        <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> tmpUint = (<span class="keywordtype">unsigned</span> int) testResult;</div>
<div class="line"><a name="l03674"></a><span class="lineno"> 3674</span>&#160;        <a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#affe39f53e3d5d678842413370af09145">subComm</a>().<a class="code" href="class_q_u_e_s_o_1_1_mpi_comm.html#abd6af8db8b0c7fd2f5b62e26477a9537">Bcast</a>((<span class="keywordtype">void</span> *) &amp;tmpUint, (<span class="keywordtype">int</span>) 1, <a class="code" href="_mpi_comm_8h.html#a06cbfbc33436f6e0dc8a48ff3c49bdfc">RawValue_MPI_UNSIGNED</a>, 0, <span class="comment">// Yes, &#39;subComm&#39;, important</span></div>
<div class="line"><a name="l03675"></a><span class="lineno"> 3675</span>&#160;                              <span class="stringliteral">&quot;MLSampling&lt;P_V,P_M&gt;::generateSequence_Step09_all()&quot;</span>,</div>
<div class="line"><a name="l03676"></a><span class="lineno"> 3676</span>&#160;                              <span class="stringliteral">&quot;failed MPI.Bcast() for testResult&quot;</span>);</div>
<div class="line"><a name="l03677"></a><span class="lineno"> 3677</span>&#160;        testResult = (bool) tmpUint;</div>
<div class="line"><a name="l03678"></a><span class="lineno"> 3678</span>&#160;</div>
<div class="line"><a name="l03679"></a><span class="lineno"> 3679</span>&#160;        <span class="keywordflow">if</span> ((<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#a8a0064746ae8dddfece4229b9ad374d6">subDisplayFile</a>()) &amp;&amp; (<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#a1fe5f244fc0316a0ab3e37463f108b96">displayVerbosity</a>() &gt;= 0)) {</div>
<div class="line"><a name="l03680"></a><span class="lineno"> 3680</span>&#160;          *<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#a8a0064746ae8dddfece4229b9ad374d6">subDisplayFile</a>() &lt;&lt; <span class="stringliteral">&quot;In MLSampling&lt;P_V,P_M&gt;::generateSequence_Step09_all()&quot;</span></div>
<div class="line"><a name="l03681"></a><span class="lineno"> 3681</span>&#160;                                  &lt;&lt; <span class="stringliteral">&quot;, level &quot;</span>              &lt;&lt; <a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#af9416874c856e50f3b35270e801f17e4">m_currLevel</a>+<a class="code" href="_m_l_sampling_level_options_8h.html#a68d15eaf394d210effcf584b938206d3">LEVEL_REF_ID</a></div>
<div class="line"><a name="l03682"></a><span class="lineno"> 3682</span>&#160;                                  &lt;&lt; <span class="stringliteral">&quot;, step &quot;</span>               &lt;&lt; <a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a1b1f8ccb4823bdfa26ec652f0807c63e">m_currStep</a></div>
<div class="line"><a name="l03683"></a><span class="lineno"> 3683</span>&#160;                                  &lt;&lt; <span class="stringliteral">&quot;: in loop for assessing rejection rate&quot;</span></div>
<div class="line"><a name="l03684"></a><span class="lineno"> 3684</span>&#160;                                  &lt;&lt; <span class="stringliteral">&quot;, nowAttempt = &quot;</span>       &lt;&lt; nowAttempt</div>
<div class="line"><a name="l03685"></a><span class="lineno"> 3685</span>&#160;                                  &lt;&lt; <span class="stringliteral">&quot;, beforeEta = &quot;</span>        &lt;&lt; beforeEta</div>
<div class="line"><a name="l03686"></a><span class="lineno"> 3686</span>&#160;                                  &lt;&lt; <span class="stringliteral">&quot;, etas[0] = &quot;</span>          &lt;&lt; etas[0]</div>
<div class="line"><a name="l03687"></a><span class="lineno"> 3687</span>&#160;                                  &lt;&lt; <span class="stringliteral">&quot;, nowEta = &quot;</span>           &lt;&lt; nowEta</div>
<div class="line"><a name="l03688"></a><span class="lineno"> 3688</span>&#160;                                  &lt;&lt; <span class="stringliteral">&quot;, etas[1] = &quot;</span>          &lt;&lt; etas[1]</div>
<div class="line"><a name="l03689"></a><span class="lineno"> 3689</span>&#160;                                  &lt;&lt; <span class="stringliteral">&quot;, minRejectionRate = &quot;</span> &lt;&lt; currOptions-&gt;m_minRejectionRate</div>
<div class="line"><a name="l03690"></a><span class="lineno"> 3690</span>&#160;                                  &lt;&lt; <span class="stringliteral">&quot;, nowRejectionRate = &quot;</span> &lt;&lt; nowRejectionRate</div>
<div class="line"><a name="l03691"></a><span class="lineno"> 3691</span>&#160;                                  &lt;&lt; <span class="stringliteral">&quot;, maxRejectionRate = &quot;</span> &lt;&lt; currOptions-&gt;m_maxRejectionRate</div>
<div class="line"><a name="l03692"></a><span class="lineno"> 3692</span>&#160;                                  &lt;&lt; std::endl;</div>
<div class="line"><a name="l03693"></a><span class="lineno"> 3693</span>&#160;        }</div>
<div class="line"><a name="l03694"></a><span class="lineno"> 3694</span>&#160;        nowAttempt++;</div>
<div class="line"><a name="l03695"></a><span class="lineno"> 3695</span>&#160;</div>
<div class="line"><a name="l03696"></a><span class="lineno"> 3696</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#ae106b5bb8a80b655b88b3a26b1e7c185">inter0Rank</a>() &gt;= 0) { <span class="comment">// KAUST</span></div>
<div class="line"><a name="l03697"></a><span class="lineno"> 3697</span>&#160;          <span class="comment">// Make sure all nodes in &#39;inter0Comm&#39; have the same value of &#39;nowEta&#39;</span></div>
<div class="line"><a name="l03698"></a><span class="lineno"> 3698</span>&#160;          <span class="keywordflow">if</span> (<a class="code" href="namespace_q_u_e_s_o.html#a4166a375c5adbea35afaaf20775bc519">MiscCheckForSameValueInAllNodes</a>(nowEta,</div>
<div class="line"><a name="l03699"></a><span class="lineno"> 3699</span>&#160;                                                1.0e-16, <span class="comment">// changed from &#39;zero&#39; on 2009/11/dd</span></div>
<div class="line"><a name="l03700"></a><span class="lineno"> 3700</span>&#160;                                                <a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#a689e4d140c74d495d97eb498714a4b82">inter0Comm</a>(),</div>
<div class="line"><a name="l03701"></a><span class="lineno"> 3701</span>&#160;                                                <span class="stringliteral">&quot;MLSampling&lt;P_V,P_M&gt;::generateSequence_Step09_all(), step 9, nowEta&quot;</span>) == <span class="keyword">false</span>) {</div>
<div class="line"><a name="l03702"></a><span class="lineno"> 3702</span>&#160;            <span class="keywordflow">if</span> ((<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#a8a0064746ae8dddfece4229b9ad374d6">subDisplayFile</a>()) &amp;&amp; (<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#a1fe5f244fc0316a0ab3e37463f108b96">displayVerbosity</a>() &gt;= 0)) {</div>
<div class="line"><a name="l03703"></a><span class="lineno"> 3703</span>&#160;              *<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#a8a0064746ae8dddfece4229b9ad374d6">subDisplayFile</a>() &lt;&lt; <span class="stringliteral">&quot;WARNING, In MLSampling&lt;P_V,P_M&gt;::generateSequence()&quot;</span></div>
<div class="line"><a name="l03704"></a><span class="lineno"> 3704</span>&#160;                                      &lt;&lt; <span class="stringliteral">&quot;, level &quot;</span>        &lt;&lt; <a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#af9416874c856e50f3b35270e801f17e4">m_currLevel</a>+<a class="code" href="_m_l_sampling_level_options_8h.html#a68d15eaf394d210effcf584b938206d3">LEVEL_REF_ID</a></div>
<div class="line"><a name="l03705"></a><span class="lineno"> 3705</span>&#160;                                      &lt;&lt; <span class="stringliteral">&quot;, step &quot;</span>         &lt;&lt; <a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a1b1f8ccb4823bdfa26ec652f0807c63e">m_currStep</a></div>
<div class="line"><a name="l03706"></a><span class="lineno"> 3706</span>&#160;                                      &lt;&lt; <span class="stringliteral">&quot;: nowAttempt = &quot;</span> &lt;&lt; nowAttempt</div>
<div class="line"><a name="l03707"></a><span class="lineno"> 3707</span>&#160;                                      &lt;&lt; <span class="stringliteral">&quot;, MiscCheck for &#39;nowEta&#39; detected a problem&quot;</span></div>
<div class="line"><a name="l03708"></a><span class="lineno"> 3708</span>&#160;                                      &lt;&lt; std::endl;</div>
<div class="line"><a name="l03709"></a><span class="lineno"> 3709</span>&#160;            }</div>
<div class="line"><a name="l03710"></a><span class="lineno"> 3710</span>&#160;          }</div>
<div class="line"><a name="l03711"></a><span class="lineno"> 3711</span>&#160;        }</div>
<div class="line"><a name="l03712"></a><span class="lineno"> 3712</span>&#160;      } <span class="keywordflow">while</span> (testResult == <span class="keyword">false</span>);</div>
<div class="line"><a name="l03713"></a><span class="lineno"> 3713</span>&#160;      currEta = nowEta;</div>
<div class="line"><a name="l03714"></a><span class="lineno"> 3714</span>&#160;      <span class="keywordflow">if</span> (currEta != 1.) {</div>
<div class="line"><a name="l03715"></a><span class="lineno"> 3715</span>&#160;        unifiedCovMatrix *= currEta;</div>
<div class="line"><a name="l03716"></a><span class="lineno"> 3716</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#afbe27e6149562020663b72da6592d933">m_numDisabledParameters</a> &gt; 0) { <span class="comment">// gpmsa2</span></div>
<div class="line"><a name="l03717"></a><span class="lineno"> 3717</span>&#160;          <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> paramId = 0; paramId &lt; <a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a7bc4c72f65ba9166ed94a6e198b0915b">m_vectorSpace</a>.<a class="code" href="class_q_u_e_s_o_1_1_vector_space.html#a5829a1f4f996f8307c840b705144d666">dimLocal</a>(); ++paramId) {</div>
<div class="line"><a name="l03718"></a><span class="lineno"> 3718</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#ac76690384f70d74b8662faf7a051449e">m_parameterEnabledStatus</a>[paramId] == <span class="keyword">false</span>) {</div>
<div class="line"><a name="l03719"></a><span class="lineno"> 3719</span>&#160;              <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a7bc4c72f65ba9166ed94a6e198b0915b">m_vectorSpace</a>.<a class="code" href="class_q_u_e_s_o_1_1_vector_space.html#a5829a1f4f996f8307c840b705144d666">dimLocal</a>(); ++i) {</div>
<div class="line"><a name="l03720"></a><span class="lineno"> 3720</span>&#160;                unifiedCovMatrix(i,paramId) = 0.;</div>
<div class="line"><a name="l03721"></a><span class="lineno"> 3721</span>&#160;              }</div>
<div class="line"><a name="l03722"></a><span class="lineno"> 3722</span>&#160;              <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> j = 0; j &lt; <a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a7bc4c72f65ba9166ed94a6e198b0915b">m_vectorSpace</a>.<a class="code" href="class_q_u_e_s_o_1_1_vector_space.html#a5829a1f4f996f8307c840b705144d666">dimLocal</a>(); ++j) {</div>
<div class="line"><a name="l03723"></a><span class="lineno"> 3723</span>&#160;                unifiedCovMatrix(paramId,j) = 0.;</div>
<div class="line"><a name="l03724"></a><span class="lineno"> 3724</span>&#160;              }</div>
<div class="line"><a name="l03725"></a><span class="lineno"> 3725</span>&#160;              unifiedCovMatrix(paramId,paramId) = 1.;</div>
<div class="line"><a name="l03726"></a><span class="lineno"> 3726</span>&#160;            }</div>
<div class="line"><a name="l03727"></a><span class="lineno"> 3727</span>&#160;          }</div>
<div class="line"><a name="l03728"></a><span class="lineno"> 3728</span>&#160;        }</div>
<div class="line"><a name="l03729"></a><span class="lineno"> 3729</span>&#160;      }</div>
<div class="line"><a name="l03730"></a><span class="lineno"> 3730</span>&#160;</div>
<div class="line"><a name="l03731"></a><span class="lineno"> 3731</span>&#160;      <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> quantity1 = weightSequence.<a class="code" href="class_q_u_e_s_o_1_1_scalar_sequence.html#a52829afc95e5c36e9db44f40854153b0">unifiedSequenceSize</a>(<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a7bc4c72f65ba9166ed94a6e198b0915b">m_vectorSpace</a>.<a class="code" href="class_q_u_e_s_o_1_1_vector_space.html#a67b0c3620662116f5a346fdaa5faf38e">numOfProcsForStorage</a>() == 1);</div>
<div class="line"><a name="l03732"></a><span class="lineno"> 3732</span>&#160;      <span class="keywordflow">if</span> ((<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#a8a0064746ae8dddfece4229b9ad374d6">subDisplayFile</a>()) &amp;&amp; (<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#a1fe5f244fc0316a0ab3e37463f108b96">displayVerbosity</a>() &gt;= 0)) {</div>
<div class="line"><a name="l03733"></a><span class="lineno"> 3733</span>&#160;        *<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#a8a0064746ae8dddfece4229b9ad374d6">subDisplayFile</a>() &lt;&lt; <span class="stringliteral">&quot;In MLSampling&lt;P_V,P_M&gt;::generateSequence_Step09_all()&quot;</span></div>
<div class="line"><a name="l03734"></a><span class="lineno"> 3734</span>&#160;                                &lt;&lt; <span class="stringliteral">&quot;, level &quot;</span>                                  &lt;&lt; <a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#af9416874c856e50f3b35270e801f17e4">m_currLevel</a>+<a class="code" href="_m_l_sampling_level_options_8h.html#a68d15eaf394d210effcf584b938206d3">LEVEL_REF_ID</a></div>
<div class="line"><a name="l03735"></a><span class="lineno"> 3735</span>&#160;                                &lt;&lt; <span class="stringliteral">&quot;, step &quot;</span>                                   &lt;&lt; <a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a1b1f8ccb4823bdfa26ec652f0807c63e">m_currStep</a></div>
<div class="line"><a name="l03736"></a><span class="lineno"> 3736</span>&#160;                                &lt;&lt; <span class="stringliteral">&quot;: weightSequence.subSequenceSize() = &quot;</span>     &lt;&lt; weightSequence.<a class="code" href="class_q_u_e_s_o_1_1_scalar_sequence.html#a0288ea295eedc216a1617b3286f6f3a0">subSequenceSize</a>()</div>
<div class="line"><a name="l03737"></a><span class="lineno"> 3737</span>&#160;                                &lt;&lt; <span class="stringliteral">&quot;, weightSequence.unifiedSequenceSize() = &quot;</span> &lt;&lt; quantity1</div>
<div class="line"><a name="l03738"></a><span class="lineno"> 3738</span>&#160;                                &lt;&lt; <span class="stringliteral">&quot;, currEta = &quot;</span>                              &lt;&lt; currEta</div>
<div class="line"><a name="l03739"></a><span class="lineno"> 3739</span>&#160;                                &lt;&lt; <span class="stringliteral">&quot;, assessed rejection rate = &quot;</span>              &lt;&lt; nowRejectionRate</div>
<div class="line"><a name="l03740"></a><span class="lineno"> 3740</span>&#160;                                &lt;&lt; std::endl;</div>
<div class="line"><a name="l03741"></a><span class="lineno"> 3741</span>&#160;      }</div>
<div class="line"><a name="l03742"></a><span class="lineno"> 3742</span>&#160;    }</div>
<div class="line"><a name="l03743"></a><span class="lineno"> 3743</span>&#160;</div>
<div class="line"><a name="l03744"></a><span class="lineno"> 3744</span>&#160;  <span class="keywordtype">double</span> stepRunTime = <a class="code" href="namespace_q_u_e_s_o.html#a424bc33f2e6e287fd468408d14b772ee">MiscGetEllapsedSeconds</a>(&amp;timevalStep);</div>
<div class="line"><a name="l03745"></a><span class="lineno"> 3745</span>&#160;  <span class="keywordflow">if</span> ((<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#a8a0064746ae8dddfece4229b9ad374d6">subDisplayFile</a>()) &amp;&amp; (<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#a1fe5f244fc0316a0ab3e37463f108b96">displayVerbosity</a>() &gt;= 0)) {</div>
<div class="line"><a name="l03746"></a><span class="lineno"> 3746</span>&#160;    *<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#a8a0064746ae8dddfece4229b9ad374d6">subDisplayFile</a>() &lt;&lt; <span class="stringliteral">&quot;Leaving MLSampling&lt;P_V,P_M&gt;::generateSequence_Step()&quot;</span></div>
<div class="line"><a name="l03747"></a><span class="lineno"> 3747</span>&#160;                            &lt;&lt; <span class="stringliteral">&quot;, level &quot;</span> &lt;&lt; <a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#af9416874c856e50f3b35270e801f17e4">m_currLevel</a>+<a class="code" href="_m_l_sampling_level_options_8h.html#a68d15eaf394d210effcf584b938206d3">LEVEL_REF_ID</a></div>
<div class="line"><a name="l03748"></a><span class="lineno"> 3748</span>&#160;                            &lt;&lt; <span class="stringliteral">&quot;, step &quot;</span>  &lt;&lt; <a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a1b1f8ccb4823bdfa26ec652f0807c63e">m_currStep</a></div>
<div class="line"><a name="l03749"></a><span class="lineno"> 3749</span>&#160;                            &lt;&lt; <span class="stringliteral">&quot;, after &quot;</span> &lt;&lt; stepRunTime &lt;&lt; <span class="stringliteral">&quot; seconds&quot;</span></div>
<div class="line"><a name="l03750"></a><span class="lineno"> 3750</span>&#160;                            &lt;&lt; std::endl;</div>
<div class="line"><a name="l03751"></a><span class="lineno"> 3751</span>&#160;  }</div>
<div class="line"><a name="l03752"></a><span class="lineno"> 3752</span>&#160;</div>
<div class="line"><a name="l03753"></a><span class="lineno"> 3753</span>&#160;  <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l03754"></a><span class="lineno"> 3754</span>&#160;}</div>
<div class="ttc" id="class_q_u_e_s_o_1_1_m_l_sampling_html_a13f1ca4fe9f94822fe572a743eaced1d"><div class="ttname"><a href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">QUESO::MLSampling::m_env</a></div><div class="ttdeci">const BaseEnvironment &amp; m_env</div><div class="ttdoc">Queso enviroment. </div><div class="ttdef"><b>Definition:</b> <a href="_m_l_sampling_8h_source.html#l00442">MLSampling.h:442</a></div></div>
<div class="ttc" id="_mpi_comm_8h_html_afbf78d291c032aa7f512bc566cee2bd1"><div class="ttname"><a href="_mpi_comm_8h.html#afbf78d291c032aa7f512bc566cee2bd1">RawValue_MPI_SUM</a></div><div class="ttdeci">#define RawValue_MPI_SUM</div><div class="ttdef"><b>Definition:</b> <a href="_mpi_comm_8h_source.html#l00052">MpiComm.h:52</a></div></div>
<div class="ttc" id="class_q_u_e_s_o_1_1_vector_space_html_a5829a1f4f996f8307c840b705144d666"><div class="ttname"><a href="class_q_u_e_s_o_1_1_vector_space.html#a5829a1f4f996f8307c840b705144d666">QUESO::VectorSpace::dimLocal</a></div><div class="ttdeci">unsigned int dimLocal() const </div><div class="ttdef"><b>Definition:</b> <a href="_vector_space_8_c_source.html#l00199">VectorSpace.C:199</a></div></div>
<div class="ttc" id="class_q_u_e_s_o_1_1_mpi_comm_html_aa780721ae0fdeabc5a15e04cb0cad964"><div class="ttname"><a href="class_q_u_e_s_o_1_1_mpi_comm.html#aa780721ae0fdeabc5a15e04cb0cad964">QUESO::MpiComm::NumProc</a></div><div class="ttdeci">int NumProc() const </div><div class="ttdoc">Returns total number of processes. </div><div class="ttdef"><b>Definition:</b> <a href="_mpi_comm_8_c_source.html#l00121">MpiComm.C:121</a></div></div>
<div class="ttc" id="class_q_u_e_s_o_1_1_base_environment_html_a78b57112bbd0e6dd0e8afec00b40ffa7"><div class="ttname"><a href="class_q_u_e_s_o_1_1_base_environment.html#a78b57112bbd0e6dd0e8afec00b40ffa7">QUESO::BaseEnvironment::worldRank</a></div><div class="ttdeci">int worldRank() const </div><div class="ttdoc">Returns the process world rank. </div><div class="ttdef"><b>Definition:</b> <a href="_environment_8_c_source.html#l00235">Environment.C:235</a></div></div>
<div class="ttc" id="class_q_u_e_s_o_1_1_m_l_sampling_html_a04b0d797b321bb5c4047aab89a445e3c"><div class="ttname"><a href="class_q_u_e_s_o_1_1_m_l_sampling.html#a04b0d797b321bb5c4047aab89a445e3c">QUESO::MLSampling::generateUnbLinkedChains_all</a></div><div class="ttdeci">void generateUnbLinkedChains_all(MLSamplingLevelOptions &amp;inputOptions, const P_M &amp;unifiedCovMatrix, const GenericVectorRV&lt; P_V, P_M &gt; &amp;rv, const UnbalancedLinkedChainsPerNodeStruct &amp;unbalancedLinkControl, unsigned int indexOfFirstWeight, const SequenceOfVectors&lt; P_V, P_M &gt; &amp;prevChain, SequenceOfVectors&lt; P_V, P_M &gt; &amp;workingChain, double &amp;cumulativeRunTime, unsigned int &amp;cumulativeRejections, ScalarSequence&lt; double &gt; *currLogLikelihoodValues, ScalarSequence&lt; double &gt; *currLogTargetValues)</div><div class="ttdef"><b>Definition:</b> <a href="_m_l_sampling_8_c_source.html#l00890">MLSampling.C:890</a></div></div>
<div class="ttc" id="namespace_q_u_e_s_o_html_a8e909502900aecf24cedba022ea84471"><div class="ttname"><a href="namespace_q_u_e_s_o.html#a8e909502900aecf24cedba022ea84471">QUESO::UQ_OK_RC</a></div><div class="ttdeci">const int UQ_OK_RC</div><div class="ttdef"><b>Definition:</b> <a href="_defines_8h_source.html#l00075">Defines.h:75</a></div></div>
<div class="ttc" id="class_q_u_e_s_o_1_1_base_environment_html_affe39f53e3d5d678842413370af09145"><div class="ttname"><a href="class_q_u_e_s_o_1_1_base_environment.html#affe39f53e3d5d678842413370af09145">QUESO::BaseEnvironment::subComm</a></div><div class="ttdeci">const MpiComm &amp; subComm() const </div><div class="ttdoc">Access function for MpiComm sub communicator. </div><div class="ttdef"><b>Definition:</b> <a href="_environment_8_c_source.html#l00269">Environment.C:269</a></div></div>
<div class="ttc" id="class_q_u_e_s_o_1_1_m_l_sampling_html_a37dcf4d893b6c8f67fe077892bada773"><div class="ttname"><a href="class_q_u_e_s_o_1_1_m_l_sampling.html#a37dcf4d893b6c8f67fe077892bada773">QUESO::MLSampling::prepareUnbLinkedChains_inter0</a></div><div class="ttdeci">void prepareUnbLinkedChains_inter0(unsigned int indexOfFirstWeight, unsigned int indexOfLastWeight, const std::vector&lt; unsigned int &gt; &amp;unifiedIndexCountersAtProc0Only, UnbalancedLinkedChainsPerNodeStruct &amp;unbalancedLinkControl)</div><div class="ttdef"><b>Definition:</b> <a href="_m_l_sampling_8_c_source.html#l00481">MLSampling.C:481</a></div></div>
<div class="ttc" id="class_q_u_e_s_o_1_1_m_l_sampling_html_afbe27e6149562020663b72da6592d933"><div class="ttname"><a href="class_q_u_e_s_o_1_1_m_l_sampling.html#afbe27e6149562020663b72da6592d933">QUESO::MLSampling::m_numDisabledParameters</a></div><div class="ttdeci">unsigned int m_numDisabledParameters</div><div class="ttdef"><b>Definition:</b> <a href="_m_l_sampling_8h_source.html#l00456">MLSampling.h:456</a></div></div>
<div class="ttc" id="class_q_u_e_s_o_1_1_m_l_sampling_html_a0f6f7872635b9546b3215fee347601f6"><div class="ttname"><a href="class_q_u_e_s_o_1_1_m_l_sampling.html#a0f6f7872635b9546b3215fee347601f6">QUESO::MLSampling::decideOnBalancedChains_all</a></div><div class="ttdeci">bool decideOnBalancedChains_all(const MLSamplingLevelOptions *currOptions, unsigned int indexOfFirstWeight, unsigned int indexOfLastWeight, const std::vector&lt; unsigned int &gt; &amp;unifiedIndexCountersAtProc0Only, std::vector&lt; ExchangeInfoStruct &gt; &amp;exchangeStdVec)</div><div class="ttdef"><b>Definition:</b> <a href="_m_l_sampling_8_c_source.html#l00147">MLSampling.C:147</a></div></div>
<div class="ttc" id="class_q_u_e_s_o_1_1_m_l_sampling_html_af8504cc57ec72b3c52833826b2bfff8e"><div class="ttname"><a href="class_q_u_e_s_o_1_1_m_l_sampling.html#af8504cc57ec72b3c52833826b2bfff8e">QUESO::MLSampling::m_options</a></div><div class="ttdeci">MLSamplingOptions m_options</div><div class="ttdoc">Options for the ML algorithm. </div><div class="ttdef"><b>Definition:</b> <a href="_m_l_sampling_8h_source.html#l00461">MLSampling.h:461</a></div></div>
<div class="ttc" id="class_q_u_e_s_o_1_1_m_l_sampling_html_af71979655e46135b6a3c97b8909321f0"><div class="ttname"><a href="class_q_u_e_s_o_1_1_m_l_sampling.html#af71979655e46135b6a3c97b8909321f0">QUESO::MLSampling::sampleIndexes_proc0</a></div><div class="ttdeci">void sampleIndexes_proc0(unsigned int unifiedRequestedNumSamples, const std::vector&lt; double &gt; &amp;unifiedWeightStdVectorAtProc0Only, std::vector&lt; unsigned int &gt; &amp;unifiedIndexCountersAtProc0Only)</div><div class="ttdef"><b>Definition:</b> <a href="_m_l_sampling_8_c_source.html#l00093">MLSampling.C:93</a></div></div>
<div class="ttc" id="class_q_u_e_s_o_1_1_m_l_sampling_html_ac76690384f70d74b8662faf7a051449e"><div class="ttname"><a href="class_q_u_e_s_o_1_1_m_l_sampling.html#ac76690384f70d74b8662faf7a051449e">QUESO::MLSampling::m_parameterEnabledStatus</a></div><div class="ttdeci">std::vector&lt; bool &gt; m_parameterEnabledStatus</div><div class="ttdef"><b>Definition:</b> <a href="_m_l_sampling_8h_source.html#l00458">MLSampling.h:458</a></div></div>
<div class="ttc" id="class_q_u_e_s_o_1_1_vector_space_html_a67b0c3620662116f5a346fdaa5faf38e"><div class="ttname"><a href="class_q_u_e_s_o_1_1_vector_space.html#a67b0c3620662116f5a346fdaa5faf38e">QUESO::VectorSpace::numOfProcsForStorage</a></div><div class="ttdeci">unsigned int numOfProcsForStorage() const </div><div class="ttdoc">Returns total number of processes. </div><div class="ttdef"><b>Definition:</b> <a href="_vector_space_8_c_source.html#l00193">VectorSpace.C:193</a></div></div>
<div class="ttc" id="class_q_u_e_s_o_1_1_scalar_sequence_html_ab8802412461496eb72f6c1267507c28c"><div class="ttname"><a href="class_q_u_e_s_o_1_1_scalar_sequence.html#ab8802412461496eb72f6c1267507c28c">QUESO::ScalarSequence::getUnifiedContentsAtProc0Only</a></div><div class="ttdeci">void getUnifiedContentsAtProc0Only(bool useOnlyInter0Comm, std::vector&lt; T &gt; &amp;outputVec) const </div><div class="ttdoc">Gets the unified contents of processor of rank equals to 0. </div><div class="ttdef"><b>Definition:</b> <a href="_scalar_sequence_8_c_source.html#l00252">ScalarSequence.C:252</a></div></div>
<div class="ttc" id="class_q_u_e_s_o_1_1_m_l_sampling_options_html_a1d3d48598e0b59b46337ce66a52671a5"><div class="ttname"><a href="class_q_u_e_s_o_1_1_m_l_sampling_options.html#a1d3d48598e0b59b46337ce66a52671a5">QUESO::MLSamplingOptions::m_prefix</a></div><div class="ttdeci">std::string m_prefix</div><div class="ttdoc">Class prefix. (ml) </div><div class="ttdef"><b>Definition:</b> <a href="_m_l_sampling_options_8h_source.html#l00090">MLSamplingOptions.h:90</a></div></div>
<div class="ttc" id="class_q_u_e_s_o_1_1_m_l_sampling_html_af9416874c856e50f3b35270e801f17e4"><div class="ttname"><a href="class_q_u_e_s_o_1_1_m_l_sampling.html#af9416874c856e50f3b35270e801f17e4">QUESO::MLSampling::m_currLevel</a></div><div class="ttdeci">unsigned int m_currLevel</div><div class="ttdoc">Current level. </div><div class="ttdef"><b>Definition:</b> <a href="_m_l_sampling_8h_source.html#l00464">MLSampling.h:464</a></div></div>
<div class="ttc" id="_m_l_sampling_level_options_8h_html_a68d15eaf394d210effcf584b938206d3"><div class="ttname"><a href="_m_l_sampling_level_options_8h.html#a68d15eaf394d210effcf584b938206d3">LEVEL_REF_ID</a></div><div class="ttdeci">#define LEVEL_REF_ID</div><div class="ttdef"><b>Definition:</b> <a href="_m_l_sampling_level_options_8h_source.html#l00028">MLSamplingLevelOptions.h:28</a></div></div>
<div class="ttc" id="class_q_u_e_s_o_1_1_scalar_sequence_html_a0288ea295eedc216a1617b3286f6f3a0"><div class="ttname"><a href="class_q_u_e_s_o_1_1_scalar_sequence.html#a0288ea295eedc216a1617b3286f6f3a0">QUESO::ScalarSequence::subSequenceSize</a></div><div class="ttdeci">unsigned int subSequenceSize() const </div><div class="ttdoc">Size of the sub-sequence of scalars. </div><div class="ttdef"><b>Definition:</b> <a href="_scalar_sequence_8_c_source.html#l00141">ScalarSequence.C:141</a></div></div>
<div class="ttc" id="namespace_q_u_e_s_o_html_a4166a375c5adbea35afaaf20775bc519"><div class="ttname"><a href="namespace_q_u_e_s_o.html#a4166a375c5adbea35afaaf20775bc519">QUESO::MiscCheckForSameValueInAllNodes</a></div><div class="ttdeci">bool MiscCheckForSameValueInAllNodes(T &amp;inputValue, double acceptableTreshold, const MpiComm &amp;comm, const char *whereString)</div><div class="ttdef"><b>Definition:</b> <a href="_miscellaneous_8_c_source.html#l00484">Miscellaneous.C:484</a></div></div>
<div class="ttc" id="class_q_u_e_s_o_1_1_mpi_comm_html_abd6af8db8b0c7fd2f5b62e26477a9537"><div class="ttname"><a href="class_q_u_e_s_o_1_1_mpi_comm.html#abd6af8db8b0c7fd2f5b62e26477a9537">QUESO::MpiComm::Bcast</a></div><div class="ttdeci">void Bcast(void *buffer, int count, RawType_MPI_Datatype datatype, int root, const char *whereMsg, const char *whatMsg) const </div><div class="ttdoc">Broadcast values from the root process to the slave processes. </div><div class="ttdef"><b>Definition:</b> <a href="_mpi_comm_8_c_source.html#l00157">MpiComm.C:157</a></div></div>
<div class="ttc" id="class_q_u_e_s_o_1_1_scalar_sequence_html_a52829afc95e5c36e9db44f40854153b0"><div class="ttname"><a href="class_q_u_e_s_o_1_1_scalar_sequence.html#a52829afc95e5c36e9db44f40854153b0">QUESO::ScalarSequence::unifiedSequenceSize</a></div><div class="ttdeci">unsigned int unifiedSequenceSize(bool useOnlyInter0Comm) const </div><div class="ttdoc">Size of the unified sequence of scalars. </div><div class="ttdef"><b>Definition:</b> <a href="_scalar_sequence_8_c_source.html#l00148">ScalarSequence.C:148</a></div></div>
<div class="ttc" id="class_q_u_e_s_o_1_1_m_l_sampling_html_a7bc4c72f65ba9166ed94a6e198b0915b"><div class="ttname"><a href="class_q_u_e_s_o_1_1_m_l_sampling.html#a7bc4c72f65ba9166ed94a6e198b0915b">QUESO::MLSampling::m_vectorSpace</a></div><div class="ttdeci">const VectorSpace&lt; P_V, P_M &gt; &amp; m_vectorSpace</div><div class="ttdoc">Vector space. </div><div class="ttdef"><b>Definition:</b> <a href="_m_l_sampling_8h_source.html#l00451">MLSampling.h:451</a></div></div>
<div class="ttc" id="class_q_u_e_s_o_1_1_m_l_sampling_html_a75b2d73a0b07f594951a89cc1bc96849"><div class="ttname"><a href="class_q_u_e_s_o_1_1_m_l_sampling.html#a75b2d73a0b07f594951a89cc1bc96849">QUESO::MLSampling::prepareBalLinkedChains_inter0</a></div><div class="ttdeci">void prepareBalLinkedChains_inter0(const MLSamplingLevelOptions *currOptions, const SequenceOfVectors&lt; P_V, P_M &gt; &amp;prevChain, std::vector&lt; ExchangeInfoStruct &gt; &amp;exchangeStdVec, BalancedLinkedChainsPerNodeStruct&lt; P_V &gt; &amp;balancedLinkControl)</div><div class="ttdef"><b>Definition:</b> <a href="_m_l_sampling_8_c_source.html#l00343">MLSampling.C:343</a></div></div>
<div class="ttc" id="namespace_q_u_e_s_o_html_a424bc33f2e6e287fd468408d14b772ee"><div class="ttname"><a href="namespace_q_u_e_s_o.html#a424bc33f2e6e287fd468408d14b772ee">QUESO::MiscGetEllapsedSeconds</a></div><div class="ttdeci">double MiscGetEllapsedSeconds(struct timeval *timeval0)</div><div class="ttdef"><b>Definition:</b> <a href="_miscellaneous_8_c_source.html#l00287">Miscellaneous.C:287</a></div></div>
<div class="ttc" id="class_q_u_e_s_o_1_1_base_environment_html_ae106b5bb8a80b655b88b3a26b1e7c185"><div class="ttname"><a href="class_q_u_e_s_o_1_1_base_environment.html#ae106b5bb8a80b655b88b3a26b1e7c185">QUESO::BaseEnvironment::inter0Rank</a></div><div class="ttdeci">int inter0Rank() const </div><div class="ttdoc">Returns the process inter0 rank. </div><div class="ttdef"><b>Definition:</b> <a href="_environment_8_c_source.html#l00289">Environment.C:289</a></div></div>
<div class="ttc" id="class_q_u_e_s_o_1_1_mpi_comm_html_a72e137e60ef8060efb1ee5fc874fa4b8"><div class="ttname"><a href="class_q_u_e_s_o_1_1_mpi_comm.html#a72e137e60ef8060efb1ee5fc874fa4b8">QUESO::MpiComm::Allreduce</a></div><div class="ttdeci">void Allreduce(void *sendbuf, void *recvbuf, int count, RawType_MPI_Datatype datatype, RawType_MPI_Op op, const char *whereMsg, const char *whatMsg) const </div><div class="ttdoc">Combines values from all processes and distributes the result back to all processes. </div><div class="ttdef"><b>Definition:</b> <a href="_mpi_comm_8_c_source.html#l00131">MpiComm.C:131</a></div></div>
<div class="ttc" id="_defines_8h_html_a56d63d18d0a6d45757de47fcc06f574d"><div class="ttname"><a href="_defines_8h.html#a56d63d18d0a6d45757de47fcc06f574d">UQ_FATAL_TEST_MACRO</a></div><div class="ttdeci">#define UQ_FATAL_TEST_MACRO(test, givenRank, where, what)</div><div class="ttdef"><b>Definition:</b> <a href="_defines_8h_source.html#l00222">Defines.h:222</a></div></div>
<div class="ttc" id="_mpi_comm_8h_html_a06cbfbc33436f6e0dc8a48ff3c49bdfc"><div class="ttname"><a href="_mpi_comm_8h.html#a06cbfbc33436f6e0dc8a48ff3c49bdfc">RawValue_MPI_UNSIGNED</a></div><div class="ttdeci">#define RawValue_MPI_UNSIGNED</div><div class="ttdef"><b>Definition:</b> <a href="_mpi_comm_8h_source.html#l00049">MpiComm.h:49</a></div></div>
<div class="ttc" id="class_q_u_e_s_o_1_1_m_l_sampling_html_a8e9d7681d17623c726814d206c8be4b2"><div class="ttname"><a href="class_q_u_e_s_o_1_1_m_l_sampling.html#a8e9d7681d17623c726814d206c8be4b2">QUESO::MLSampling::generateBalLinkedChains_all</a></div><div class="ttdeci">void generateBalLinkedChains_all(MLSamplingLevelOptions &amp;inputOptions, const P_M &amp;unifiedCovMatrix, const GenericVectorRV&lt; P_V, P_M &gt; &amp;rv, const BalancedLinkedChainsPerNodeStruct&lt; P_V &gt; &amp;balancedLinkControl, SequenceOfVectors&lt; P_V, P_M &gt; &amp;workingChain, double &amp;cumulativeRunTime, unsigned int &amp;cumulativeRejections, ScalarSequence&lt; double &gt; *currLogLikelihoodValues, ScalarSequence&lt; double &gt; *currLogTargetValues)</div><div class="ttdef"><b>Definition:</b> <a href="_m_l_sampling_8_c_source.html#l00656">MLSampling.C:656</a></div></div>
<div class="ttc" id="class_q_u_e_s_o_1_1_m_l_sampling_html_a1b1f8ccb4823bdfa26ec652f0807c63e"><div class="ttname"><a href="class_q_u_e_s_o_1_1_m_l_sampling.html#a1b1f8ccb4823bdfa26ec652f0807c63e">QUESO::MLSampling::m_currStep</a></div><div class="ttdeci">unsigned int m_currStep</div><div class="ttdoc">Curret step. </div><div class="ttdef"><b>Definition:</b> <a href="_m_l_sampling_8h_source.html#l00467">MLSampling.h:467</a></div></div>
<div class="ttc" id="class_q_u_e_s_o_1_1_base_environment_html_a1fe5f244fc0316a0ab3e37463f108b96"><div class="ttname"><a href="class_q_u_e_s_o_1_1_base_environment.html#a1fe5f244fc0316a0ab3e37463f108b96">QUESO::BaseEnvironment::displayVerbosity</a></div><div class="ttdeci">unsigned int displayVerbosity() const </div><div class="ttdef"><b>Definition:</b> <a href="_environment_8_c_source.html#l00436">Environment.C:436</a></div></div>
<div class="ttc" id="class_q_u_e_s_o_1_1_base_environment_html_a8a0064746ae8dddfece4229b9ad374d6"><div class="ttname"><a href="class_q_u_e_s_o_1_1_base_environment.html#a8a0064746ae8dddfece4229b9ad374d6">QUESO::BaseEnvironment::subDisplayFile</a></div><div class="ttdeci">std::ofstream * subDisplayFile() const </div><div class="ttdoc">Access function for m_subDisplayFile (displays file on stream). </div><div class="ttdef"><b>Definition:</b> <a href="_environment_8_c_source.html#l00305">Environment.C:305</a></div></div>
<div class="ttc" id="class_q_u_e_s_o_1_1_base_environment_html_a689e4d140c74d495d97eb498714a4b82"><div class="ttname"><a href="class_q_u_e_s_o_1_1_base_environment.html#a689e4d140c74d495d97eb498714a4b82">QUESO::BaseEnvironment::inter0Comm</a></div><div class="ttdeci">const MpiComm &amp; inter0Comm() const </div><div class="ttdoc">Access function for MpiComm inter0-communicator. </div><div class="ttdef"><b>Definition:</b> <a href="_environment_8_c_source.html#l00295">Environment.C:295</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a04322fda4c97eee6c6739fc007d642c1"></a>
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;class P_V , class P_M &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="class_q_u_e_s_o_1_1_m_l_sampling.html">QUESO::MLSampling</a>&lt; P_V, P_M &gt;::generateSequence_Step10_all </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_q_u_e_s_o_1_1_m_l_sampling_level_options.html">MLSamplingLevelOptions</a> &amp;&#160;</td>
          <td class="paramname"><em>currOptions</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const P_M &amp;&#160;</td>
          <td class="paramname"><em>unifiedCovMatrix</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="class_q_u_e_s_o_1_1_generic_vector_r_v.html">GenericVectorRV</a>&lt; P_V, P_M &gt; &amp;&#160;</td>
          <td class="paramname"><em>currRv</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>useBalancedChains</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="struct_q_u_e_s_o_1_1_unbalanced_linked_chains_per_node_struct.html">UnbalancedLinkedChainsPerNodeStruct</a> &amp;&#160;</td>
          <td class="paramname"><em>unbalancedLinkControl</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned int&#160;</td>
          <td class="paramname"><em>indexOfFirstWeight</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="class_q_u_e_s_o_1_1_sequence_of_vectors.html">SequenceOfVectors</a>&lt; P_V, P_M &gt; &amp;&#160;</td>
          <td class="paramname"><em>prevChain</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="struct_q_u_e_s_o_1_1_balanced_linked_chains_per_node_struct.html">BalancedLinkedChainsPerNodeStruct</a>&lt; P_V &gt; &amp;&#160;</td>
          <td class="paramname"><em>balancedLinkControl</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_q_u_e_s_o_1_1_sequence_of_vectors.html">SequenceOfVectors</a>&lt; P_V, P_M &gt; &amp;&#160;</td>
          <td class="paramname"><em>currChain</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double &amp;&#160;</td>
          <td class="paramname"><em>cumulativeRawChainRunTime</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned int &amp;&#160;</td>
          <td class="paramname"><em>cumulativeRawChainRejections</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_q_u_e_s_o_1_1_scalar_sequence.html">ScalarSequence</a>&lt; double &gt; *&#160;</td>
          <td class="paramname"><em>currLogLikelihoodValues</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_q_u_e_s_o_1_1_scalar_sequence.html">ScalarSequence</a>&lt; double &gt; *&#160;</td>
          <td class="paramname"><em>currLogTargetValues</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Samples the vector RV of current level (Step 10 from ML algorithm). </p>
<p>This method is responsible for the Step 10 in the ML algorithm implemented/described in the method <a class="el" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a8d7296b30623c73ada38971cae27994a" title="Method to generate the chain. ">MLSampling&lt;P_V,P_M&gt;::generateSequence</a>.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">currOptions,unifiedCovMatrix,currRv,useBalancedChains,unbalancedLinkControl,indexOfFirstWeight,prevChain,balancedLinkControl</td><td></td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">currChain,cumulativeRawChainRunTime,cumulativeRawChainRejections,currLogLikelihoodValues,currLogTargetValues</td><td></td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="_m_l_sampling_8_c_source.html#l03758">3758</a> of file <a class="el" href="_m_l_sampling_8_c_source.html">MLSampling.C</a>.</p>

<p>References <a class="el" href="_m_l_sampling_level_options_8h_source.html#l00028">LEVEL_REF_ID</a>, <a class="el" href="_m_l_sampling_level_options_8h_source.html#l00256">QUESO::MLSamplingLevelOptions::m_filteredChainGenerate</a>, <a class="el" href="_m_l_sampling_level_options_8h_source.html#l00222">QUESO::MLSamplingLevelOptions::m_rawChainSize</a>, <a class="el" href="_m_l_sampling_level_options_8h_source.html#l00194">QUESO::MLSamplingLevelOptions::m_totallyMute</a>, <a class="el" href="_miscellaneous_8_c_source.html#l00287">QUESO::MiscGetEllapsedSeconds()</a>, and <a class="el" href="_defines_8h_source.html#l00075">QUESO::UQ_OK_RC</a>.</p>
<div class="fragment"><div class="line"><a name="l03772"></a><span class="lineno"> 3772</span>&#160;{</div>
<div class="line"><a name="l03773"></a><span class="lineno"> 3773</span>&#160;  <span class="keywordtype">int</span> iRC = <a class="code" href="namespace_q_u_e_s_o.html#a8e909502900aecf24cedba022ea84471">UQ_OK_RC</a>;</div>
<div class="line"><a name="l03774"></a><span class="lineno"> 3774</span>&#160;  <span class="keyword">struct </span>timeval timevalStep;</div>
<div class="line"><a name="l03775"></a><span class="lineno"> 3775</span>&#160;  iRC = gettimeofday(&amp;timevalStep, NULL);</div>
<div class="line"><a name="l03776"></a><span class="lineno"> 3776</span>&#160;  <span class="keywordflow">if</span> (iRC) {}; <span class="comment">// just to remove compiler warning</span></div>
<div class="line"><a name="l03777"></a><span class="lineno"> 3777</span>&#160;</div>
<div class="line"><a name="l03778"></a><span class="lineno"> 3778</span>&#160;      <span class="keywordflow">if</span> ((<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#a8a0064746ae8dddfece4229b9ad374d6">subDisplayFile</a>()) &amp;&amp; (<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#a1fe5f244fc0316a0ab3e37463f108b96">displayVerbosity</a>() &gt;= 0)) {</div>
<div class="line"><a name="l03779"></a><span class="lineno"> 3779</span>&#160;        *<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#a8a0064746ae8dddfece4229b9ad374d6">subDisplayFile</a>() &lt;&lt; <span class="stringliteral">&quot;In MLSampling&lt;P_V,P_M&gt;::generateSequence()&quot;</span></div>
<div class="line"><a name="l03780"></a><span class="lineno"> 3780</span>&#160;                                &lt;&lt; <span class="stringliteral">&quot;, level &quot;</span> &lt;&lt; <a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#af9416874c856e50f3b35270e801f17e4">m_currLevel</a>+<a class="code" href="_m_l_sampling_level_options_8h.html#a68d15eaf394d210effcf584b938206d3">LEVEL_REF_ID</a></div>
<div class="line"><a name="l03781"></a><span class="lineno"> 3781</span>&#160;                                &lt;&lt; <span class="stringliteral">&quot;, step &quot;</span>  &lt;&lt; <a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a1b1f8ccb4823bdfa26ec652f0807c63e">m_currStep</a></div>
<div class="line"><a name="l03782"></a><span class="lineno"> 3782</span>&#160;                                &lt;&lt; <span class="stringliteral">&quot;: beginning step 10 of 11&quot;</span></div>
<div class="line"><a name="l03783"></a><span class="lineno"> 3783</span>&#160;                                &lt;&lt; <span class="stringliteral">&quot;, currLogLikelihoodValues = &quot;</span> &lt;&lt; currLogLikelihoodValues</div>
<div class="line"><a name="l03784"></a><span class="lineno"> 3784</span>&#160;                                &lt;&lt; std::endl;</div>
<div class="line"><a name="l03785"></a><span class="lineno"> 3785</span>&#160;      }</div>
<div class="line"><a name="l03786"></a><span class="lineno"> 3786</span>&#160;</div>
<div class="line"><a name="l03787"></a><span class="lineno"> 3787</span>&#160;      <span class="comment">// All nodes should call here</span></div>
<div class="line"><a name="l03788"></a><span class="lineno"> 3788</span>&#160;      <span class="keywordtype">bool</span>         savedTotallyMute           = currOptions.m_totallyMute; <span class="comment">// HERE - ENHANCEMENT</span></div>
<div class="line"><a name="l03789"></a><span class="lineno"> 3789</span>&#160;      <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> savedRawChainSize          = currOptions.m_rawChainSize; <span class="comment">// Ok to use rawChainSize</span></div>
<div class="line"><a name="l03790"></a><span class="lineno"> 3790</span>&#160;<span class="preprocessor">#ifdef QUESO_USES_SEQUENCE_STATISTICAL_OPTIONS</span></div>
<div class="line"><a name="l03791"></a><span class="lineno"> 3791</span>&#160;<span class="preprocessor"></span>      <span class="keywordtype">bool</span>         savedRawChainComputeStats  = currOptions.m_rawChainComputeStats;</div>
<div class="line"><a name="l03792"></a><span class="lineno"> 3792</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l03793"></a><span class="lineno"> 3793</span>&#160;<span class="preprocessor"></span>      <span class="keywordtype">bool</span>         savedFilteredChainGenerate = currOptions.m_filteredChainGenerate;</div>
<div class="line"><a name="l03794"></a><span class="lineno"> 3794</span>&#160;</div>
<div class="line"><a name="l03795"></a><span class="lineno"> 3795</span>&#160;      currOptions.m_totallyMute = <span class="keyword">true</span>;</div>
<div class="line"><a name="l03796"></a><span class="lineno"> 3796</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#a1fe5f244fc0316a0ab3e37463f108b96">displayVerbosity</a>() &gt;= 999999) {</div>
<div class="line"><a name="l03797"></a><span class="lineno"> 3797</span>&#160;        currOptions.m_totallyMute = <span class="keyword">false</span>;</div>
<div class="line"><a name="l03798"></a><span class="lineno"> 3798</span>&#160;      }</div>
<div class="line"><a name="l03799"></a><span class="lineno"> 3799</span>&#160;      currOptions.m_rawChainSize          = 0; <span class="comment">// will be set inside generateXYZLinkedChains()</span></div>
<div class="line"><a name="l03800"></a><span class="lineno"> 3800</span>&#160;<span class="preprocessor">#ifdef QUESO_USES_SEQUENCE_STATISTICAL_OPTIONS</span></div>
<div class="line"><a name="l03801"></a><span class="lineno"> 3801</span>&#160;<span class="preprocessor"></span>      currOptions.m_rawChainComputeStats  = <span class="keyword">false</span>;</div>
<div class="line"><a name="l03802"></a><span class="lineno"> 3802</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l03803"></a><span class="lineno"> 3803</span>&#160;<span class="preprocessor"></span>      currOptions.m_filteredChainGenerate = <span class="keyword">false</span>;</div>
<div class="line"><a name="l03804"></a><span class="lineno"> 3804</span>&#160;</div>
<div class="line"><a name="l03805"></a><span class="lineno"> 3805</span>&#160;      <span class="comment">// All nodes should call here</span></div>
<div class="line"><a name="l03806"></a><span class="lineno"> 3806</span>&#160;      <span class="keywordflow">if</span> (useBalancedChains) {</div>
<div class="line"><a name="l03807"></a><span class="lineno"> 3807</span>&#160;        <a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a8e9d7681d17623c726814d206c8be4b2">generateBalLinkedChains_all</a>(currOptions,                  <span class="comment">// input, only m_rawChainSize changes</span></div>
<div class="line"><a name="l03808"></a><span class="lineno"> 3808</span>&#160;                                    unifiedCovMatrix,             <span class="comment">// input</span></div>
<div class="line"><a name="l03809"></a><span class="lineno"> 3809</span>&#160;                                    currRv,                       <span class="comment">// input</span></div>
<div class="line"><a name="l03810"></a><span class="lineno"> 3810</span>&#160;                                    balancedLinkControl,          <span class="comment">// input // Round Rock</span></div>
<div class="line"><a name="l03811"></a><span class="lineno"> 3811</span>&#160;                                    currChain,                    <span class="comment">// output</span></div>
<div class="line"><a name="l03812"></a><span class="lineno"> 3812</span>&#160;                                    cumulativeRawChainRunTime,    <span class="comment">// output</span></div>
<div class="line"><a name="l03813"></a><span class="lineno"> 3813</span>&#160;                                    cumulativeRawChainRejections, <span class="comment">// output</span></div>
<div class="line"><a name="l03814"></a><span class="lineno"> 3814</span>&#160;                                    currLogLikelihoodValues,      <span class="comment">// output // likelihood is important</span></div>
<div class="line"><a name="l03815"></a><span class="lineno"> 3815</span>&#160;                                    currLogTargetValues);         <span class="comment">// output</span></div>
<div class="line"><a name="l03816"></a><span class="lineno"> 3816</span>&#160;      }</div>
<div class="line"><a name="l03817"></a><span class="lineno"> 3817</span>&#160;      <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l03818"></a><span class="lineno"> 3818</span>&#160;        <a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a04b0d797b321bb5c4047aab89a445e3c">generateUnbLinkedChains_all</a>(currOptions,                  <span class="comment">// input, only m_rawChainSize changes</span></div>
<div class="line"><a name="l03819"></a><span class="lineno"> 3819</span>&#160;                                    unifiedCovMatrix,             <span class="comment">// input</span></div>
<div class="line"><a name="l03820"></a><span class="lineno"> 3820</span>&#160;                                    currRv,                       <span class="comment">// input</span></div>
<div class="line"><a name="l03821"></a><span class="lineno"> 3821</span>&#160;                                    unbalancedLinkControl,        <span class="comment">// input // Round Rock</span></div>
<div class="line"><a name="l03822"></a><span class="lineno"> 3822</span>&#160;                                    indexOfFirstWeight,           <span class="comment">// input // Round Rock</span></div>
<div class="line"><a name="l03823"></a><span class="lineno"> 3823</span>&#160;                                    prevChain,                    <span class="comment">// input // Round Rock</span></div>
<div class="line"><a name="l03824"></a><span class="lineno"> 3824</span>&#160;                                    currChain,                    <span class="comment">// output</span></div>
<div class="line"><a name="l03825"></a><span class="lineno"> 3825</span>&#160;                                    cumulativeRawChainRunTime,    <span class="comment">// output</span></div>
<div class="line"><a name="l03826"></a><span class="lineno"> 3826</span>&#160;                                    cumulativeRawChainRejections, <span class="comment">// output</span></div>
<div class="line"><a name="l03827"></a><span class="lineno"> 3827</span>&#160;                                    currLogLikelihoodValues,      <span class="comment">// output // likelihood is important</span></div>
<div class="line"><a name="l03828"></a><span class="lineno"> 3828</span>&#160;                                    currLogTargetValues);         <span class="comment">// output</span></div>
<div class="line"><a name="l03829"></a><span class="lineno"> 3829</span>&#160;      }</div>
<div class="line"><a name="l03830"></a><span class="lineno"> 3830</span>&#160;</div>
<div class="line"><a name="l03831"></a><span class="lineno"> 3831</span>&#160;      <span class="keywordflow">if</span> ((<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#a8a0064746ae8dddfece4229b9ad374d6">subDisplayFile</a>()) &amp;&amp; (<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#a1fe5f244fc0316a0ab3e37463f108b96">displayVerbosity</a>() &gt;= 0)) {</div>
<div class="line"><a name="l03832"></a><span class="lineno"> 3832</span>&#160;        <span class="keywordtype">double</span> tmpValue = INFINITY;</div>
<div class="line"><a name="l03833"></a><span class="lineno"> 3833</span>&#160;        <span class="keywordflow">if</span> (currLogLikelihoodValues) tmpValue = (*currLogLikelihoodValues)[0];</div>
<div class="line"><a name="l03834"></a><span class="lineno"> 3834</span>&#160;        *<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#a8a0064746ae8dddfece4229b9ad374d6">subDisplayFile</a>() &lt;&lt; <span class="stringliteral">&quot;In MLSampling&lt;P_V,P_M&gt;::generateSequence_Step()&quot;</span></div>
<div class="line"><a name="l03835"></a><span class="lineno"> 3835</span>&#160;                                &lt;&lt; <span class="stringliteral">&quot;, level &quot;</span> &lt;&lt; <a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#af9416874c856e50f3b35270e801f17e4">m_currLevel</a>+<a class="code" href="_m_l_sampling_level_options_8h.html#a68d15eaf394d210effcf584b938206d3">LEVEL_REF_ID</a></div>
<div class="line"><a name="l03836"></a><span class="lineno"> 3836</span>&#160;                                &lt;&lt; <span class="stringliteral">&quot;, step &quot;</span>  &lt;&lt; <a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a1b1f8ccb4823bdfa26ec652f0807c63e">m_currStep</a></div>
<div class="line"><a name="l03837"></a><span class="lineno"> 3837</span>&#160;                                &lt;&lt; <span class="stringliteral">&quot;, after chain generatrion&quot;</span></div>
<div class="line"><a name="l03838"></a><span class="lineno"> 3838</span>&#160;                                &lt;&lt; <span class="stringliteral">&quot;, currLogLikelihoodValues[0] = &quot;</span> &lt;&lt; tmpValue</div>
<div class="line"><a name="l03839"></a><span class="lineno"> 3839</span>&#160;                                &lt;&lt; std::endl;</div>
<div class="line"><a name="l03840"></a><span class="lineno"> 3840</span>&#160;      }</div>
<div class="line"><a name="l03841"></a><span class="lineno"> 3841</span>&#160;</div>
<div class="line"><a name="l03842"></a><span class="lineno"> 3842</span>&#160;      <span class="comment">// All nodes should call here</span></div>
<div class="line"><a name="l03843"></a><span class="lineno"> 3843</span>&#160;      currOptions.m_totallyMute           = savedTotallyMute;</div>
<div class="line"><a name="l03844"></a><span class="lineno"> 3844</span>&#160;      currOptions.m_rawChainSize          = savedRawChainSize;</div>
<div class="line"><a name="l03845"></a><span class="lineno"> 3845</span>&#160;<span class="preprocessor">#ifdef QUESO_USES_SEQUENCE_STATISTICAL_OPTIONS</span></div>
<div class="line"><a name="l03846"></a><span class="lineno"> 3846</span>&#160;<span class="preprocessor"></span>      currOptions.m_rawChainComputeStats  = savedRawChainComputeStats;</div>
<div class="line"><a name="l03847"></a><span class="lineno"> 3847</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l03848"></a><span class="lineno"> 3848</span>&#160;<span class="preprocessor"></span>      currOptions.m_filteredChainGenerate = savedFilteredChainGenerate; <span class="comment">// FIX ME</span></div>
<div class="line"><a name="l03849"></a><span class="lineno"> 3849</span>&#160;</div>
<div class="line"><a name="l03850"></a><span class="lineno"> 3850</span>&#160;  <span class="keywordtype">double</span> stepRunTime = <a class="code" href="namespace_q_u_e_s_o.html#a424bc33f2e6e287fd468408d14b772ee">MiscGetEllapsedSeconds</a>(&amp;timevalStep);</div>
<div class="line"><a name="l03851"></a><span class="lineno"> 3851</span>&#160;  <span class="keywordflow">if</span> ((<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#a8a0064746ae8dddfece4229b9ad374d6">subDisplayFile</a>()) &amp;&amp; (<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#a1fe5f244fc0316a0ab3e37463f108b96">displayVerbosity</a>() &gt;= 0)) {</div>
<div class="line"><a name="l03852"></a><span class="lineno"> 3852</span>&#160;    *<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#a8a0064746ae8dddfece4229b9ad374d6">subDisplayFile</a>() &lt;&lt; <span class="stringliteral">&quot;Leaving MLSampling&lt;P_V,P_M&gt;::generateSequence_Step()&quot;</span></div>
<div class="line"><a name="l03853"></a><span class="lineno"> 3853</span>&#160;                            &lt;&lt; <span class="stringliteral">&quot;, level &quot;</span> &lt;&lt; <a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#af9416874c856e50f3b35270e801f17e4">m_currLevel</a>+<a class="code" href="_m_l_sampling_level_options_8h.html#a68d15eaf394d210effcf584b938206d3">LEVEL_REF_ID</a></div>
<div class="line"><a name="l03854"></a><span class="lineno"> 3854</span>&#160;                            &lt;&lt; <span class="stringliteral">&quot;, step &quot;</span>  &lt;&lt; <a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a1b1f8ccb4823bdfa26ec652f0807c63e">m_currStep</a></div>
<div class="line"><a name="l03855"></a><span class="lineno"> 3855</span>&#160;                            &lt;&lt; <span class="stringliteral">&quot;, after &quot;</span> &lt;&lt; stepRunTime &lt;&lt; <span class="stringliteral">&quot; seconds&quot;</span></div>
<div class="line"><a name="l03856"></a><span class="lineno"> 3856</span>&#160;                            &lt;&lt; std::endl;</div>
<div class="line"><a name="l03857"></a><span class="lineno"> 3857</span>&#160;  }</div>
<div class="line"><a name="l03858"></a><span class="lineno"> 3858</span>&#160;</div>
<div class="line"><a name="l03859"></a><span class="lineno"> 3859</span>&#160;  <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l03860"></a><span class="lineno"> 3860</span>&#160;}</div>
<div class="ttc" id="class_q_u_e_s_o_1_1_m_l_sampling_html_a13f1ca4fe9f94822fe572a743eaced1d"><div class="ttname"><a href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">QUESO::MLSampling::m_env</a></div><div class="ttdeci">const BaseEnvironment &amp; m_env</div><div class="ttdoc">Queso enviroment. </div><div class="ttdef"><b>Definition:</b> <a href="_m_l_sampling_8h_source.html#l00442">MLSampling.h:442</a></div></div>
<div class="ttc" id="class_q_u_e_s_o_1_1_m_l_sampling_html_a04b0d797b321bb5c4047aab89a445e3c"><div class="ttname"><a href="class_q_u_e_s_o_1_1_m_l_sampling.html#a04b0d797b321bb5c4047aab89a445e3c">QUESO::MLSampling::generateUnbLinkedChains_all</a></div><div class="ttdeci">void generateUnbLinkedChains_all(MLSamplingLevelOptions &amp;inputOptions, const P_M &amp;unifiedCovMatrix, const GenericVectorRV&lt; P_V, P_M &gt; &amp;rv, const UnbalancedLinkedChainsPerNodeStruct &amp;unbalancedLinkControl, unsigned int indexOfFirstWeight, const SequenceOfVectors&lt; P_V, P_M &gt; &amp;prevChain, SequenceOfVectors&lt; P_V, P_M &gt; &amp;workingChain, double &amp;cumulativeRunTime, unsigned int &amp;cumulativeRejections, ScalarSequence&lt; double &gt; *currLogLikelihoodValues, ScalarSequence&lt; double &gt; *currLogTargetValues)</div><div class="ttdef"><b>Definition:</b> <a href="_m_l_sampling_8_c_source.html#l00890">MLSampling.C:890</a></div></div>
<div class="ttc" id="namespace_q_u_e_s_o_html_a8e909502900aecf24cedba022ea84471"><div class="ttname"><a href="namespace_q_u_e_s_o.html#a8e909502900aecf24cedba022ea84471">QUESO::UQ_OK_RC</a></div><div class="ttdeci">const int UQ_OK_RC</div><div class="ttdef"><b>Definition:</b> <a href="_defines_8h_source.html#l00075">Defines.h:75</a></div></div>
<div class="ttc" id="class_q_u_e_s_o_1_1_m_l_sampling_html_af9416874c856e50f3b35270e801f17e4"><div class="ttname"><a href="class_q_u_e_s_o_1_1_m_l_sampling.html#af9416874c856e50f3b35270e801f17e4">QUESO::MLSampling::m_currLevel</a></div><div class="ttdeci">unsigned int m_currLevel</div><div class="ttdoc">Current level. </div><div class="ttdef"><b>Definition:</b> <a href="_m_l_sampling_8h_source.html#l00464">MLSampling.h:464</a></div></div>
<div class="ttc" id="_m_l_sampling_level_options_8h_html_a68d15eaf394d210effcf584b938206d3"><div class="ttname"><a href="_m_l_sampling_level_options_8h.html#a68d15eaf394d210effcf584b938206d3">LEVEL_REF_ID</a></div><div class="ttdeci">#define LEVEL_REF_ID</div><div class="ttdef"><b>Definition:</b> <a href="_m_l_sampling_level_options_8h_source.html#l00028">MLSamplingLevelOptions.h:28</a></div></div>
<div class="ttc" id="namespace_q_u_e_s_o_html_a424bc33f2e6e287fd468408d14b772ee"><div class="ttname"><a href="namespace_q_u_e_s_o.html#a424bc33f2e6e287fd468408d14b772ee">QUESO::MiscGetEllapsedSeconds</a></div><div class="ttdeci">double MiscGetEllapsedSeconds(struct timeval *timeval0)</div><div class="ttdef"><b>Definition:</b> <a href="_miscellaneous_8_c_source.html#l00287">Miscellaneous.C:287</a></div></div>
<div class="ttc" id="class_q_u_e_s_o_1_1_m_l_sampling_html_a8e9d7681d17623c726814d206c8be4b2"><div class="ttname"><a href="class_q_u_e_s_o_1_1_m_l_sampling.html#a8e9d7681d17623c726814d206c8be4b2">QUESO::MLSampling::generateBalLinkedChains_all</a></div><div class="ttdeci">void generateBalLinkedChains_all(MLSamplingLevelOptions &amp;inputOptions, const P_M &amp;unifiedCovMatrix, const GenericVectorRV&lt; P_V, P_M &gt; &amp;rv, const BalancedLinkedChainsPerNodeStruct&lt; P_V &gt; &amp;balancedLinkControl, SequenceOfVectors&lt; P_V, P_M &gt; &amp;workingChain, double &amp;cumulativeRunTime, unsigned int &amp;cumulativeRejections, ScalarSequence&lt; double &gt; *currLogLikelihoodValues, ScalarSequence&lt; double &gt; *currLogTargetValues)</div><div class="ttdef"><b>Definition:</b> <a href="_m_l_sampling_8_c_source.html#l00656">MLSampling.C:656</a></div></div>
<div class="ttc" id="class_q_u_e_s_o_1_1_m_l_sampling_html_a1b1f8ccb4823bdfa26ec652f0807c63e"><div class="ttname"><a href="class_q_u_e_s_o_1_1_m_l_sampling.html#a1b1f8ccb4823bdfa26ec652f0807c63e">QUESO::MLSampling::m_currStep</a></div><div class="ttdeci">unsigned int m_currStep</div><div class="ttdoc">Curret step. </div><div class="ttdef"><b>Definition:</b> <a href="_m_l_sampling_8h_source.html#l00467">MLSampling.h:467</a></div></div>
<div class="ttc" id="class_q_u_e_s_o_1_1_base_environment_html_a1fe5f244fc0316a0ab3e37463f108b96"><div class="ttname"><a href="class_q_u_e_s_o_1_1_base_environment.html#a1fe5f244fc0316a0ab3e37463f108b96">QUESO::BaseEnvironment::displayVerbosity</a></div><div class="ttdeci">unsigned int displayVerbosity() const </div><div class="ttdef"><b>Definition:</b> <a href="_environment_8_c_source.html#l00436">Environment.C:436</a></div></div>
<div class="ttc" id="class_q_u_e_s_o_1_1_base_environment_html_a8a0064746ae8dddfece4229b9ad374d6"><div class="ttname"><a href="class_q_u_e_s_o_1_1_base_environment.html#a8a0064746ae8dddfece4229b9ad374d6">QUESO::BaseEnvironment::subDisplayFile</a></div><div class="ttdeci">std::ofstream * subDisplayFile() const </div><div class="ttdoc">Access function for m_subDisplayFile (displays file on stream). </div><div class="ttdef"><b>Definition:</b> <a href="_environment_8_c_source.html#l00305">Environment.C:305</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="aae527304bc1012a91ffc396e94fbab11"></a>
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;class P_V , class P_M &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="class_q_u_e_s_o_1_1_m_l_sampling.html">QUESO::MLSampling</a>&lt; P_V, P_M &gt;::generateSequence_Step11_inter0 </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="class_q_u_e_s_o_1_1_m_l_sampling_level_options.html">MLSamplingLevelOptions</a> *&#160;</td>
          <td class="paramname"><em>currOptions</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned int&#160;</td>
          <td class="paramname"><em>unifiedRequestedNumSamples</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned int&#160;</td>
          <td class="paramname"><em>cumulativeRawChainRejections</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_q_u_e_s_o_1_1_sequence_of_vectors.html">SequenceOfVectors</a>&lt; P_V, P_M &gt; &amp;&#160;</td>
          <td class="paramname"><em>currChain</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_q_u_e_s_o_1_1_scalar_sequence.html">ScalarSequence</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>currLogLikelihoodValues</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_q_u_e_s_o_1_1_scalar_sequence.html">ScalarSequence</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>currLogTargetValues</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned int &amp;&#160;</td>
          <td class="paramname"><em>unifiedNumberOfRejections</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Filters chain (Step 11 from ML algorithm). </p>
<p>This method is responsible for the Step 11 in the ML algorithm implemented/described in the method <a class="el" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a8d7296b30623c73ada38971cae27994a" title="Method to generate the chain. ">MLSampling&lt;P_V,P_M&gt;::generateSequence</a>.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">currOptions,unifiedRequestedNumSamples,cumulativeRawChainRejections,@param[in,out]</td><td>currChain, currLogLikelihoodValues, currLogTargetValues </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">unifiedNumberOfRejections</td><td></td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="_m_l_sampling_8_c_source.html#l03864">3864</a> of file <a class="el" href="_m_l_sampling_8_c_source.html">MLSampling.C</a>.</p>

<p>References <a class="el" href="_vector_sequence_8_c_source.html#l00613">QUESO::BaseVectorSequence&lt; V, M &gt;::computeFilterParams()</a>, <a class="el" href="_sequence_of_vectors_8_c_source.html#l02079">QUESO::SequenceOfVectors&lt; V, M &gt;::filter()</a>, <a class="el" href="_scalar_sequence_8_c_source.html#l02575">QUESO::ScalarSequence&lt; T &gt;::filter()</a>, <a class="el" href="_m_l_sampling_level_options_8h_source.html#l00028">LEVEL_REF_ID</a>, <a class="el" href="_m_l_sampling_level_options_8h_source.html#l00160">QUESO::MLSamplingLevelOptions::m_dataOutputAllowedSet</a>, <a class="el" href="_m_l_sampling_level_options_8h_source.html#l00154">QUESO::MLSamplingLevelOptions::m_dataOutputFileName</a>, <a class="el" href="_m_l_sampling_level_options_8h_source.html#l00265">QUESO::MLSamplingLevelOptions::m_filteredChainDataOutputFileName</a>, <a class="el" href="_m_l_sampling_level_options_8h_source.html#l00268">QUESO::MLSamplingLevelOptions::m_filteredChainDataOutputFileType</a>, <a class="el" href="_m_l_sampling_level_options_8h_source.html#l00259">QUESO::MLSamplingLevelOptions::m_filteredChainDiscardedPortion</a>, <a class="el" href="_m_l_sampling_level_options_8h_source.html#l00256">QUESO::MLSamplingLevelOptions::m_filteredChainGenerate</a>, <a class="el" href="_m_l_sampling_level_options_8h_source.html#l00262">QUESO::MLSamplingLevelOptions::m_filteredChainLag</a>, <a class="el" href="_m_l_sampling_level_options_8h_source.html#l00143">QUESO::MLSamplingLevelOptions::m_prefix</a>, <a class="el" href="_m_l_sampling_level_options_8h_source.html#l00237">QUESO::MLSamplingLevelOptions::m_rawChainDataOutputFileName</a>, <a class="el" href="_m_l_sampling_level_options_8h_source.html#l00240">QUESO::MLSamplingLevelOptions::m_rawChainDataOutputFileType</a>, <a class="el" href="_miscellaneous_8_c_source.html#l00287">QUESO::MiscGetEllapsedSeconds()</a>, <a class="el" href="_environment_8h_source.html#l00075">QUESO::FilePtrSetStruct::ofsVar</a>, <a class="el" href="_mpi_comm_8h_source.html#l00052">RawValue_MPI_SUM</a>, <a class="el" href="_mpi_comm_8h_source.html#l00049">RawValue_MPI_UNSIGNED</a>, <a class="el" href="_vector_sequence_8_c_source.html#l00128">QUESO::BaseVectorSequence&lt; V, M &gt;::setName()</a>, <a class="el" href="_scalar_sequence_8_c_source.html#l00120">QUESO::ScalarSequence&lt; T &gt;::setName()</a>, <a class="el" href="_sequence_of_vectors_8_c_source.html#l00103">QUESO::SequenceOfVectors&lt; V, M &gt;::subSequenceSize()</a>, <a class="el" href="_sequence_of_vectors_8_c_source.html#l01485">QUESO::SequenceOfVectors&lt; V, M &gt;::unifiedWriteContents()</a>, <a class="el" href="_scalar_sequence_8_c_source.html#l02799">QUESO::ScalarSequence&lt; T &gt;::unifiedWriteContents()</a>, <a class="el" href="_defines_8h_source.html#l00222">UQ_FATAL_TEST_MACRO</a>, <a class="el" href="_defines_8h_source.html#l00088">UQ_FILE_EXTENSION_FOR_MATLAB_FORMAT</a>, <a class="el" href="_metropolis_hastings_s_g_options_8h_source.html#l00035">UQ_MH_SG_FILENAME_FOR_NO_FILE</a>, and <a class="el" href="_defines_8h_source.html#l00075">QUESO::UQ_OK_RC</a>.</p>
<div class="fragment"><div class="line"><a name="l03872"></a><span class="lineno"> 3872</span>&#160;{</div>
<div class="line"><a name="l03873"></a><span class="lineno"> 3873</span>&#160;  <span class="keywordtype">int</span> iRC = <a class="code" href="namespace_q_u_e_s_o.html#a8e909502900aecf24cedba022ea84471">UQ_OK_RC</a>;</div>
<div class="line"><a name="l03874"></a><span class="lineno"> 3874</span>&#160;  <span class="keyword">struct </span>timeval timevalStep;</div>
<div class="line"><a name="l03875"></a><span class="lineno"> 3875</span>&#160;  iRC = gettimeofday(&amp;timevalStep, NULL);</div>
<div class="line"><a name="l03876"></a><span class="lineno"> 3876</span>&#160;  <span class="keywordflow">if</span> (iRC) {}; <span class="comment">// just to remove compiler warning</span></div>
<div class="line"><a name="l03877"></a><span class="lineno"> 3877</span>&#160;</div>
<div class="line"><a name="l03878"></a><span class="lineno"> 3878</span>&#160;  <span class="keywordflow">if</span> ((<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#a8a0064746ae8dddfece4229b9ad374d6">subDisplayFile</a>()) &amp;&amp; (<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#a1fe5f244fc0316a0ab3e37463f108b96">displayVerbosity</a>() &gt;= 0)) {</div>
<div class="line"><a name="l03879"></a><span class="lineno"> 3879</span>&#160;    *<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#a8a0064746ae8dddfece4229b9ad374d6">subDisplayFile</a>() &lt;&lt; <span class="stringliteral">&quot;In MLSampling&lt;P_V,P_M&gt;::generateSequence()&quot;</span></div>
<div class="line"><a name="l03880"></a><span class="lineno"> 3880</span>&#160;                            &lt;&lt; <span class="stringliteral">&quot;, level &quot;</span> &lt;&lt; <a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#af9416874c856e50f3b35270e801f17e4">m_currLevel</a>+<a class="code" href="_m_l_sampling_level_options_8h.html#a68d15eaf394d210effcf584b938206d3">LEVEL_REF_ID</a></div>
<div class="line"><a name="l03881"></a><span class="lineno"> 3881</span>&#160;                            &lt;&lt; <span class="stringliteral">&quot;, step &quot;</span>  &lt;&lt; <a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a1b1f8ccb4823bdfa26ec652f0807c63e">m_currStep</a></div>
<div class="line"><a name="l03882"></a><span class="lineno"> 3882</span>&#160;                            &lt;&lt; <span class="stringliteral">&quot;: beginning step 11 of 11&quot;</span></div>
<div class="line"><a name="l03883"></a><span class="lineno"> 3883</span>&#160;                            &lt;&lt; std::endl;</div>
<div class="line"><a name="l03884"></a><span class="lineno"> 3884</span>&#160;  }</div>
<div class="line"><a name="l03885"></a><span class="lineno"> 3885</span>&#160;</div>
<div class="line"><a name="l03886"></a><span class="lineno"> 3886</span>&#160;  <span class="comment">//if (m_env.subComm().MyPID() == 0) std::cout &lt;&lt; &quot;Aqui 000&quot; &lt;&lt; std::endl;</span></div>
<div class="line"><a name="l03887"></a><span class="lineno"> 3887</span>&#160;</div>
<div class="line"><a name="l03888"></a><span class="lineno"> 3888</span>&#160;<span class="preprocessor">#ifdef QUESO_USES_SEQUENCE_STATISTICAL_OPTIONS</span></div>
<div class="line"><a name="l03889"></a><span class="lineno"> 3889</span>&#160;<span class="preprocessor"></span>  <span class="keywordflow">if</span> (currOptions-&gt;m_rawChainComputeStats) {</div>
<div class="line"><a name="l03890"></a><span class="lineno"> 3890</span>&#160;    FilePtrSetStruct filePtrSet;</div>
<div class="line"><a name="l03891"></a><span class="lineno"> 3891</span>&#160;    <a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#ab8fe853074f12ea34e18724119a2fc75">openOutputFile</a>(currOptions-&gt;m_dataOutputFileName,</div>
<div class="line"><a name="l03892"></a><span class="lineno"> 3892</span>&#160;                         <a class="code" href="_defines_8h.html#ac440026eff7deb1c1eed1eea0e8e36ba">UQ_FILE_EXTENSION_FOR_MATLAB_FORMAT</a>, <span class="comment">// Yes, always &quot;.m&quot;</span></div>
<div class="line"><a name="l03893"></a><span class="lineno"> 3893</span>&#160;                         currOptions-&gt;m_dataOutputAllowedSet,</div>
<div class="line"><a name="l03894"></a><span class="lineno"> 3894</span>&#160;                         <span class="keyword">false</span>,</div>
<div class="line"><a name="l03895"></a><span class="lineno"> 3895</span>&#160;                         filePtrSet);</div>
<div class="line"><a name="l03896"></a><span class="lineno"> 3896</span>&#160;</div>
<div class="line"><a name="l03897"></a><span class="lineno"> 3897</span>&#160;    <span class="keywordflow">if</span> ((<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#a8a0064746ae8dddfece4229b9ad374d6">subDisplayFile</a>()) &amp;&amp; (<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#a1fe5f244fc0316a0ab3e37463f108b96">displayVerbosity</a>() &gt;= 10)) { <span class="comment">// output debug</span></div>
<div class="line"><a name="l03898"></a><span class="lineno"> 3898</span>&#160;      *<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#a8a0064746ae8dddfece4229b9ad374d6">subDisplayFile</a>() &lt;&lt; <span class="stringliteral">&quot;In MLSampling&lt;P_V,P_M&gt;::generateSequence_Step()&quot;</span></div>
<div class="line"><a name="l03899"></a><span class="lineno"> 3899</span>&#160;                              &lt;&lt; <span class="stringliteral">&quot;, level &quot;</span> &lt;&lt; <a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#af9416874c856e50f3b35270e801f17e4">m_currLevel</a>+<a class="code" href="_m_l_sampling_level_options_8h.html#a68d15eaf394d210effcf584b938206d3">LEVEL_REF_ID</a></div>
<div class="line"><a name="l03900"></a><span class="lineno"> 3900</span>&#160;                              &lt;&lt; <span class="stringliteral">&quot;, step &quot;</span>  &lt;&lt; <a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a1b1f8ccb4823bdfa26ec652f0807c63e">m_currStep</a></div>
<div class="line"><a name="l03901"></a><span class="lineno"> 3901</span>&#160;                              &lt;&lt; <span class="stringliteral">&quot;, calling computeStatistics for raw chain&quot;</span></div>
<div class="line"><a name="l03902"></a><span class="lineno"> 3902</span>&#160;                              &lt;&lt; <span class="stringliteral">&quot;. Ofstream pointer value = &quot;</span> &lt;&lt; filePtrSet.ofsVar</div>
<div class="line"><a name="l03903"></a><span class="lineno"> 3903</span>&#160;                              &lt;&lt; <span class="stringliteral">&quot;, statistical options are&quot;</span></div>
<div class="line"><a name="l03904"></a><span class="lineno"> 3904</span>&#160;                              &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span> &lt;&lt; *currOptions-&gt;m_rawChainStatisticalOptionsObj</div>
<div class="line"><a name="l03905"></a><span class="lineno"> 3905</span>&#160;                              &lt;&lt; std::endl;</div>
<div class="line"><a name="l03906"></a><span class="lineno"> 3906</span>&#160;    }</div>
<div class="line"><a name="l03907"></a><span class="lineno"> 3907</span>&#160;    <span class="comment">//m_env.syncPrintDebugMsg(&quot;At step 11, calling computeStatistics for raw chain&quot;,1,10,m_env.inter0Comm()); // output debug</span></div>
<div class="line"><a name="l03908"></a><span class="lineno"> 3908</span>&#160;    currChain.computeStatistics(*currOptions-&gt;m_rawChainStatisticalOptionsObj,</div>
<div class="line"><a name="l03909"></a><span class="lineno"> 3909</span>&#160;                                filePtrSet.ofsVar);</div>
<div class="line"><a name="l03910"></a><span class="lineno"> 3910</span>&#160;</div>
<div class="line"><a name="l03911"></a><span class="lineno"> 3911</span>&#160;    <a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#ab712bff194ddd91459d4ea8715c77e8b">closeFile</a>(filePtrSet,<a class="code" href="_defines_8h.html#ac440026eff7deb1c1eed1eea0e8e36ba">UQ_FILE_EXTENSION_FOR_MATLAB_FORMAT</a>);</div>
<div class="line"><a name="l03912"></a><span class="lineno"> 3912</span>&#160;  }</div>
<div class="line"><a name="l03913"></a><span class="lineno"> 3913</span>&#160;  <span class="comment">// Compute MLE and MAP</span></div>
<div class="line"><a name="l03914"></a><span class="lineno"> 3914</span>&#160;  <span class="comment">// rr0</span></div>
<div class="line"><a name="l03915"></a><span class="lineno"> 3915</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l03916"></a><span class="lineno"> 3916</span>&#160;<span class="preprocessor"></span>  <span class="keywordflow">if</span> (currOptions-&gt;m_rawChainDataOutputFileName != <a class="code" href="_metropolis_hastings_s_g_options_8h.html#a75699ceb938d800e2b7f59ede3ea9a31">UQ_MH_SG_FILENAME_FOR_NO_FILE</a>) {</div>
<div class="line"><a name="l03917"></a><span class="lineno"> 3917</span>&#160;    currChain.unifiedWriteContents(currOptions-&gt;m_rawChainDataOutputFileName,</div>
<div class="line"><a name="l03918"></a><span class="lineno"> 3918</span>&#160;                                   currOptions-&gt;m_rawChainDataOutputFileType); <span class="comment">// KAUST5</span></div>
<div class="line"><a name="l03919"></a><span class="lineno"> 3919</span>&#160;    <span class="keywordflow">if</span> ((<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#a8a0064746ae8dddfece4229b9ad374d6">subDisplayFile</a>()) &amp;&amp; (<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#a1fe5f244fc0316a0ab3e37463f108b96">displayVerbosity</a>() &gt;= 0)) {</div>
<div class="line"><a name="l03920"></a><span class="lineno"> 3920</span>&#160;      *<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#a8a0064746ae8dddfece4229b9ad374d6">subDisplayFile</a>() &lt;&lt; <span class="stringliteral">&quot;In MLSampling&lt;P_V,P_M&gt;::generateSequence_Step()&quot;</span></div>
<div class="line"><a name="l03921"></a><span class="lineno"> 3921</span>&#160;                              &lt;&lt; <span class="stringliteral">&quot;, level &quot;</span> &lt;&lt; <a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#af9416874c856e50f3b35270e801f17e4">m_currLevel</a>+<a class="code" href="_m_l_sampling_level_options_8h.html#a68d15eaf394d210effcf584b938206d3">LEVEL_REF_ID</a></div>
<div class="line"><a name="l03922"></a><span class="lineno"> 3922</span>&#160;                              &lt;&lt; <span class="stringliteral">&quot;, step &quot;</span>  &lt;&lt; <a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a1b1f8ccb4823bdfa26ec652f0807c63e">m_currStep</a></div>
<div class="line"><a name="l03923"></a><span class="lineno"> 3923</span>&#160;                              &lt;&lt; <span class="stringliteral">&quot;, before calling currLogLikelihoodValues.unifiedWriteContents()&quot;</span></div>
<div class="line"><a name="l03924"></a><span class="lineno"> 3924</span>&#160;                              &lt;&lt; <span class="stringliteral">&quot;, currLogLikelihoodValues[0] = &quot;</span> &lt;&lt; currLogLikelihoodValues[0]</div>
<div class="line"><a name="l03925"></a><span class="lineno"> 3925</span>&#160;                              &lt;&lt; std::endl;</div>
<div class="line"><a name="l03926"></a><span class="lineno"> 3926</span>&#160;    }</div>
<div class="line"><a name="l03927"></a><span class="lineno"> 3927</span>&#160;    currLogLikelihoodValues.<a class="code" href="class_q_u_e_s_o_1_1_scalar_sequence.html#a2f832dd5eda37df06eb52650ab8ce733">unifiedWriteContents</a>(currOptions-&gt;m_rawChainDataOutputFileName,</div>
<div class="line"><a name="l03928"></a><span class="lineno"> 3928</span>&#160;                                                 currOptions-&gt;m_rawChainDataOutputFileType);</div>
<div class="line"><a name="l03929"></a><span class="lineno"> 3929</span>&#160;    currLogTargetValues.<a class="code" href="class_q_u_e_s_o_1_1_scalar_sequence.html#a2f832dd5eda37df06eb52650ab8ce733">unifiedWriteContents</a>    (currOptions-&gt;m_rawChainDataOutputFileName,</div>
<div class="line"><a name="l03930"></a><span class="lineno"> 3930</span>&#160;                                                 currOptions-&gt;m_rawChainDataOutputFileType);</div>
<div class="line"><a name="l03931"></a><span class="lineno"> 3931</span>&#160;  }</div>
<div class="line"><a name="l03932"></a><span class="lineno"> 3932</span>&#160;</div>
<div class="line"><a name="l03933"></a><span class="lineno"> 3933</span>&#160;  <span class="keywordflow">if</span> (currOptions-&gt;m_filteredChainGenerate) {</div>
<div class="line"><a name="l03934"></a><span class="lineno"> 3934</span>&#160;    FilePtrSetStruct filePtrSet;</div>
<div class="line"><a name="l03935"></a><span class="lineno"> 3935</span>&#160;    <a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#ab8fe853074f12ea34e18724119a2fc75">openOutputFile</a>(currOptions-&gt;m_dataOutputFileName,</div>
<div class="line"><a name="l03936"></a><span class="lineno"> 3936</span>&#160;                         <a class="code" href="_defines_8h.html#ac440026eff7deb1c1eed1eea0e8e36ba">UQ_FILE_EXTENSION_FOR_MATLAB_FORMAT</a>, <span class="comment">// Yes, always &quot;.m&quot;</span></div>
<div class="line"><a name="l03937"></a><span class="lineno"> 3937</span>&#160;                         currOptions-&gt;m_dataOutputAllowedSet,</div>
<div class="line"><a name="l03938"></a><span class="lineno"> 3938</span>&#160;                         <span class="keyword">false</span>,</div>
<div class="line"><a name="l03939"></a><span class="lineno"> 3939</span>&#160;                         filePtrSet);</div>
<div class="line"><a name="l03940"></a><span class="lineno"> 3940</span>&#160;</div>
<div class="line"><a name="l03941"></a><span class="lineno"> 3941</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> filterInitialPos = (<span class="keywordtype">unsigned</span> int) (currOptions-&gt;m_filteredChainDiscardedPortion * (<span class="keywordtype">double</span>) currChain.subSequenceSize());</div>
<div class="line"><a name="l03942"></a><span class="lineno"> 3942</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> filterSpacing    = currOptions-&gt;m_filteredChainLag;</div>
<div class="line"><a name="l03943"></a><span class="lineno"> 3943</span>&#160;    <span class="keywordflow">if</span> (filterSpacing == 0) {</div>
<div class="line"><a name="l03944"></a><span class="lineno"> 3944</span>&#160;      currChain.computeFilterParams(filePtrSet.ofsVar,</div>
<div class="line"><a name="l03945"></a><span class="lineno"> 3945</span>&#160;                                    filterInitialPos,</div>
<div class="line"><a name="l03946"></a><span class="lineno"> 3946</span>&#160;                                    filterSpacing);</div>
<div class="line"><a name="l03947"></a><span class="lineno"> 3947</span>&#160;    }</div>
<div class="line"><a name="l03948"></a><span class="lineno"> 3948</span>&#160;</div>
<div class="line"><a name="l03949"></a><span class="lineno"> 3949</span>&#160;    <span class="comment">// Filter positions from the converged portion of the chain</span></div>
<div class="line"><a name="l03950"></a><span class="lineno"> 3950</span>&#160;    currChain.filter(filterInitialPos,</div>
<div class="line"><a name="l03951"></a><span class="lineno"> 3951</span>&#160;                     filterSpacing);</div>
<div class="line"><a name="l03952"></a><span class="lineno"> 3952</span>&#160;    currChain.setName(currOptions-&gt;m_prefix + <span class="stringliteral">&quot;filtChain&quot;</span>);</div>
<div class="line"><a name="l03953"></a><span class="lineno"> 3953</span>&#160;</div>
<div class="line"><a name="l03954"></a><span class="lineno"> 3954</span>&#160;    currLogLikelihoodValues.<a class="code" href="class_q_u_e_s_o_1_1_scalar_sequence.html#aaf386a04a0cebd7f88c5b7694a5fd3d1">filter</a>(filterInitialPos,</div>
<div class="line"><a name="l03955"></a><span class="lineno"> 3955</span>&#160;                                   filterSpacing);</div>
<div class="line"><a name="l03956"></a><span class="lineno"> 3956</span>&#160;    currLogLikelihoodValues.<a class="code" href="class_q_u_e_s_o_1_1_scalar_sequence.html#a198b72423333bc5aa1722b830b64a263">setName</a>(currOptions-&gt;m_prefix + <span class="stringliteral">&quot;filtLogLikelihood&quot;</span>);</div>
<div class="line"><a name="l03957"></a><span class="lineno"> 3957</span>&#160;</div>
<div class="line"><a name="l03958"></a><span class="lineno"> 3958</span>&#160;    currLogTargetValues.<a class="code" href="class_q_u_e_s_o_1_1_scalar_sequence.html#aaf386a04a0cebd7f88c5b7694a5fd3d1">filter</a>(filterInitialPos,</div>
<div class="line"><a name="l03959"></a><span class="lineno"> 3959</span>&#160;                               filterSpacing);</div>
<div class="line"><a name="l03960"></a><span class="lineno"> 3960</span>&#160;    currLogTargetValues.<a class="code" href="class_q_u_e_s_o_1_1_scalar_sequence.html#a198b72423333bc5aa1722b830b64a263">setName</a>(currOptions-&gt;m_prefix + <span class="stringliteral">&quot;filtLogTarget&quot;</span>);</div>
<div class="line"><a name="l03961"></a><span class="lineno"> 3961</span>&#160;</div>
<div class="line"><a name="l03962"></a><span class="lineno"> 3962</span>&#160;<span class="preprocessor">#ifdef QUESO_USES_SEQUENCE_STATISTICAL_OPTIONS</span></div>
<div class="line"><a name="l03963"></a><span class="lineno"> 3963</span>&#160;<span class="preprocessor"></span>    <span class="keywordflow">if</span> (currOptions-&gt;m_filteredChainComputeStats) {</div>
<div class="line"><a name="l03964"></a><span class="lineno"> 3964</span>&#160;      <span class="keywordflow">if</span> ((<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#a8a0064746ae8dddfece4229b9ad374d6">subDisplayFile</a>()) &amp;&amp; (<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#a1fe5f244fc0316a0ab3e37463f108b96">displayVerbosity</a>() &gt;= 10)) { <span class="comment">// output debug</span></div>
<div class="line"><a name="l03965"></a><span class="lineno"> 3965</span>&#160;        *<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#a8a0064746ae8dddfece4229b9ad374d6">subDisplayFile</a>() &lt;&lt; <span class="stringliteral">&quot;In MLSampling&lt;P_V,P_M&gt;::generateSequence_Step()&quot;</span></div>
<div class="line"><a name="l03966"></a><span class="lineno"> 3966</span>&#160;                                &lt;&lt; <span class="stringliteral">&quot;, level &quot;</span> &lt;&lt; <a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#af9416874c856e50f3b35270e801f17e4">m_currLevel</a>+<a class="code" href="_m_l_sampling_level_options_8h.html#a68d15eaf394d210effcf584b938206d3">LEVEL_REF_ID</a></div>
<div class="line"><a name="l03967"></a><span class="lineno"> 3967</span>&#160;                                &lt;&lt; <span class="stringliteral">&quot;, step &quot;</span>  &lt;&lt; <a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a1b1f8ccb4823bdfa26ec652f0807c63e">m_currStep</a></div>
<div class="line"><a name="l03968"></a><span class="lineno"> 3968</span>&#160;                                &lt;&lt; <span class="stringliteral">&quot;, calling computeStatistics for filtered chain&quot;</span></div>
<div class="line"><a name="l03969"></a><span class="lineno"> 3969</span>&#160;                                &lt;&lt; <span class="stringliteral">&quot;. Ofstream pointer value = &quot;</span> &lt;&lt; filePtrSet.ofsVar</div>
<div class="line"><a name="l03970"></a><span class="lineno"> 3970</span>&#160;                                &lt;&lt; <span class="stringliteral">&quot;, statistical options are&quot;</span></div>
<div class="line"><a name="l03971"></a><span class="lineno"> 3971</span>&#160;                                &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span> &lt;&lt; *currOptions-&gt;m_rawChainStatisticalOptionsObj</div>
<div class="line"><a name="l03972"></a><span class="lineno"> 3972</span>&#160;                                &lt;&lt; std::endl;</div>
<div class="line"><a name="l03973"></a><span class="lineno"> 3973</span>&#160;      }</div>
<div class="line"><a name="l03974"></a><span class="lineno"> 3974</span>&#160;</div>
<div class="line"><a name="l03975"></a><span class="lineno"> 3975</span>&#160;      <span class="comment">//m_env.syncPrintDebugMsg(&quot;At step 11, calling computeStatistics for filtered chain&quot;,1,10,m_env.inter0Comm()); // output debug</span></div>
<div class="line"><a name="l03976"></a><span class="lineno"> 3976</span>&#160;      currChain.computeStatistics(*currOptions-&gt;m_filteredChainStatisticalOptionsObj,</div>
<div class="line"><a name="l03977"></a><span class="lineno"> 3977</span>&#160;                                  filePtrSet.ofsVar);</div>
<div class="line"><a name="l03978"></a><span class="lineno"> 3978</span>&#160;</div>
<div class="line"><a name="l03979"></a><span class="lineno"> 3979</span>&#160;    }</div>
<div class="line"><a name="l03980"></a><span class="lineno"> 3980</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l03981"></a><span class="lineno"> 3981</span>&#160;<span class="preprocessor"></span>    <span class="comment">// Compute MLE and MAP</span></div>
<div class="line"><a name="l03982"></a><span class="lineno"> 3982</span>&#160;    <span class="comment">// rr0</span></div>
<div class="line"><a name="l03983"></a><span class="lineno"> 3983</span>&#160;    <a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#ab712bff194ddd91459d4ea8715c77e8b">closeFile</a>(filePtrSet,<a class="code" href="_defines_8h.html#ac440026eff7deb1c1eed1eea0e8e36ba">UQ_FILE_EXTENSION_FOR_MATLAB_FORMAT</a>);</div>
<div class="line"><a name="l03984"></a><span class="lineno"> 3984</span>&#160;</div>
<div class="line"><a name="l03985"></a><span class="lineno"> 3985</span>&#160;    <span class="keywordflow">if</span> (currOptions-&gt;m_filteredChainDataOutputFileName != <a class="code" href="_metropolis_hastings_s_g_options_8h.html#a75699ceb938d800e2b7f59ede3ea9a31">UQ_MH_SG_FILENAME_FOR_NO_FILE</a>) {</div>
<div class="line"><a name="l03986"></a><span class="lineno"> 3986</span>&#160;      currChain.unifiedWriteContents              (currOptions-&gt;m_filteredChainDataOutputFileName,</div>
<div class="line"><a name="l03987"></a><span class="lineno"> 3987</span>&#160;                                                   currOptions-&gt;m_filteredChainDataOutputFileType);</div>
<div class="line"><a name="l03988"></a><span class="lineno"> 3988</span>&#160;      currLogLikelihoodValues.<a class="code" href="class_q_u_e_s_o_1_1_scalar_sequence.html#a2f832dd5eda37df06eb52650ab8ce733">unifiedWriteContents</a>(currOptions-&gt;m_filteredChainDataOutputFileName,</div>
<div class="line"><a name="l03989"></a><span class="lineno"> 3989</span>&#160;                                                   currOptions-&gt;m_filteredChainDataOutputFileType);</div>
<div class="line"><a name="l03990"></a><span class="lineno"> 3990</span>&#160;      currLogTargetValues.<a class="code" href="class_q_u_e_s_o_1_1_scalar_sequence.html#a2f832dd5eda37df06eb52650ab8ce733">unifiedWriteContents</a>    (currOptions-&gt;m_filteredChainDataOutputFileName,</div>
<div class="line"><a name="l03991"></a><span class="lineno"> 3991</span>&#160;                                                   currOptions-&gt;m_filteredChainDataOutputFileType);</div>
<div class="line"><a name="l03992"></a><span class="lineno"> 3992</span>&#160;    }</div>
<div class="line"><a name="l03993"></a><span class="lineno"> 3993</span>&#160;  } <span class="comment">// if (currOptions-&gt;m_filteredChainGenerate)</span></div>
<div class="line"><a name="l03994"></a><span class="lineno"> 3994</span>&#160;</div>
<div class="line"><a name="l03995"></a><span class="lineno"> 3995</span>&#160;  <span class="keywordflow">if</span> (currOptions-&gt;m_filteredChainGenerate) {</div>
<div class="line"><a name="l03996"></a><span class="lineno"> 3996</span>&#160;    <span class="comment">// Do not check</span></div>
<div class="line"><a name="l03997"></a><span class="lineno"> 3997</span>&#160;  }</div>
<div class="line"><a name="l03998"></a><span class="lineno"> 3998</span>&#160;  <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l03999"></a><span class="lineno"> 3999</span>&#160;    <span class="comment">// Check if unified size of generated chain matches the unified requested size // KAUST</span></div>
<div class="line"><a name="l04000"></a><span class="lineno"> 4000</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> tmpSize = currChain.subSequenceSize();</div>
<div class="line"><a name="l04001"></a><span class="lineno"> 4001</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> unifiedGeneratedNumSamples = 0;</div>
<div class="line"><a name="l04002"></a><span class="lineno"> 4002</span>&#160;    <a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#a689e4d140c74d495d97eb498714a4b82">inter0Comm</a>().<a class="code" href="class_q_u_e_s_o_1_1_mpi_comm.html#a72e137e60ef8060efb1ee5fc874fa4b8">Allreduce</a>((<span class="keywordtype">void</span> *) &amp;tmpSize, (<span class="keywordtype">void</span> *) &amp;unifiedGeneratedNumSamples, (<span class="keywordtype">int</span>) 1, <a class="code" href="_mpi_comm_8h.html#a06cbfbc33436f6e0dc8a48ff3c49bdfc">RawValue_MPI_UNSIGNED</a>, <a class="code" href="_mpi_comm_8h.html#afbf78d291c032aa7f512bc566cee2bd1">RawValue_MPI_SUM</a>,</div>
<div class="line"><a name="l04003"></a><span class="lineno"> 4003</span>&#160;                                 <span class="stringliteral">&quot;MLSampling&lt;P_V,P_M&gt;::generateSequence()&quot;</span>,</div>
<div class="line"><a name="l04004"></a><span class="lineno"> 4004</span>&#160;                                 <span class="stringliteral">&quot;failed MPI.Allreduce() for generated num samples in step 11&quot;</span>);</div>
<div class="line"><a name="l04005"></a><span class="lineno"> 4005</span>&#160;    <span class="comment">//std::cout &lt;&lt; &quot;unifiedGeneratedNumSamples = &quot;   &lt;&lt; unifiedGeneratedNumSamples</span></div>
<div class="line"><a name="l04006"></a><span class="lineno"> 4006</span>&#160;    <span class="comment">//          &lt;&lt; &quot;, unifiedRequestedNumSamples = &quot; &lt;&lt; unifiedRequestedNumSamples</span></div>
<div class="line"><a name="l04007"></a><span class="lineno"> 4007</span>&#160;    <span class="comment">//          &lt;&lt; std::endl;</span></div>
<div class="line"><a name="l04008"></a><span class="lineno"> 4008</span>&#160;    <a class="code" href="_defines_8h.html#a56d63d18d0a6d45757de47fcc06f574d">UQ_FATAL_TEST_MACRO</a>(unifiedGeneratedNumSamples != unifiedRequestedNumSamples,</div>
<div class="line"><a name="l04009"></a><span class="lineno"> 4009</span>&#160;                        <a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#a78b57112bbd0e6dd0e8afec00b40ffa7">worldRank</a>(),</div>
<div class="line"><a name="l04010"></a><span class="lineno"> 4010</span>&#160;                        <span class="stringliteral">&quot;MLSampling&lt;P_V,P_M&gt;::generateSequence()&quot;</span>,</div>
<div class="line"><a name="l04011"></a><span class="lineno"> 4011</span>&#160;                        <span class="stringliteral">&quot;currChain (linked one) has been generated with invalid size&quot;</span>);</div>
<div class="line"><a name="l04012"></a><span class="lineno"> 4012</span>&#160;  }</div>
<div class="line"><a name="l04013"></a><span class="lineno"> 4013</span>&#160;</div>
<div class="line"><a name="l04014"></a><span class="lineno"> 4014</span>&#160;  <span class="comment">// Compute unified number of rejections</span></div>
<div class="line"><a name="l04015"></a><span class="lineno"> 4015</span>&#160;  <a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#a689e4d140c74d495d97eb498714a4b82">inter0Comm</a>().<a class="code" href="class_q_u_e_s_o_1_1_mpi_comm.html#a72e137e60ef8060efb1ee5fc874fa4b8">Allreduce</a>((<span class="keywordtype">void</span> *) &amp;cumulativeRawChainRejections, (<span class="keywordtype">void</span> *) &amp;unifiedNumberOfRejections, (<span class="keywordtype">int</span>) 1, <a class="code" href="_mpi_comm_8h.html#a06cbfbc33436f6e0dc8a48ff3c49bdfc">RawValue_MPI_UNSIGNED</a>, <a class="code" href="_mpi_comm_8h.html#afbf78d291c032aa7f512bc566cee2bd1">RawValue_MPI_SUM</a>,</div>
<div class="line"><a name="l04016"></a><span class="lineno"> 4016</span>&#160;                               <span class="stringliteral">&quot;MLSampling&lt;P_V,P_M&gt;::generateSequence()&quot;</span>,</div>
<div class="line"><a name="l04017"></a><span class="lineno"> 4017</span>&#160;                               <span class="stringliteral">&quot;failed MPI.Allreduce() for number of rejections&quot;</span>);</div>
<div class="line"><a name="l04018"></a><span class="lineno"> 4018</span>&#160;</div>
<div class="line"><a name="l04019"></a><span class="lineno"> 4019</span>&#160;  <span class="keywordtype">double</span> stepRunTime = <a class="code" href="namespace_q_u_e_s_o.html#a424bc33f2e6e287fd468408d14b772ee">MiscGetEllapsedSeconds</a>(&amp;timevalStep);</div>
<div class="line"><a name="l04020"></a><span class="lineno"> 4020</span>&#160;  <span class="keywordflow">if</span> ((<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#a8a0064746ae8dddfece4229b9ad374d6">subDisplayFile</a>()) &amp;&amp; (<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#a1fe5f244fc0316a0ab3e37463f108b96">displayVerbosity</a>() &gt;= 0)) {</div>
<div class="line"><a name="l04021"></a><span class="lineno"> 4021</span>&#160;    *<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#a8a0064746ae8dddfece4229b9ad374d6">subDisplayFile</a>() &lt;&lt; <span class="stringliteral">&quot;Leaving MLSampling&lt;P_V,P_M&gt;::generateSequence_Step()&quot;</span></div>
<div class="line"><a name="l04022"></a><span class="lineno"> 4022</span>&#160;                            &lt;&lt; <span class="stringliteral">&quot;, level &quot;</span> &lt;&lt; <a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#af9416874c856e50f3b35270e801f17e4">m_currLevel</a>+<a class="code" href="_m_l_sampling_level_options_8h.html#a68d15eaf394d210effcf584b938206d3">LEVEL_REF_ID</a></div>
<div class="line"><a name="l04023"></a><span class="lineno"> 4023</span>&#160;                            &lt;&lt; <span class="stringliteral">&quot;, step &quot;</span>  &lt;&lt; <a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a1b1f8ccb4823bdfa26ec652f0807c63e">m_currStep</a></div>
<div class="line"><a name="l04024"></a><span class="lineno"> 4024</span>&#160;                            &lt;&lt; <span class="stringliteral">&quot;, after &quot;</span> &lt;&lt; stepRunTime &lt;&lt; <span class="stringliteral">&quot; seconds&quot;</span></div>
<div class="line"><a name="l04025"></a><span class="lineno"> 4025</span>&#160;                            &lt;&lt; std::endl;</div>
<div class="line"><a name="l04026"></a><span class="lineno"> 4026</span>&#160;  }</div>
<div class="line"><a name="l04027"></a><span class="lineno"> 4027</span>&#160;</div>
<div class="line"><a name="l04028"></a><span class="lineno"> 4028</span>&#160;  <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l04029"></a><span class="lineno"> 4029</span>&#160;}</div>
<div class="ttc" id="class_q_u_e_s_o_1_1_base_environment_html_ab712bff194ddd91459d4ea8715c77e8b"><div class="ttname"><a href="class_q_u_e_s_o_1_1_base_environment.html#ab712bff194ddd91459d4ea8715c77e8b">QUESO::BaseEnvironment::closeFile</a></div><div class="ttdeci">void closeFile(FilePtrSetStruct &amp;filePtrSet, const std::string &amp;fileType) const </div><div class="ttdoc">Closes the file. </div><div class="ttdef"><b>Definition:</b> <a href="_environment_8_c_source.html#l01117">Environment.C:1117</a></div></div>
<div class="ttc" id="class_q_u_e_s_o_1_1_m_l_sampling_html_a13f1ca4fe9f94822fe572a743eaced1d"><div class="ttname"><a href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">QUESO::MLSampling::m_env</a></div><div class="ttdeci">const BaseEnvironment &amp; m_env</div><div class="ttdoc">Queso enviroment. </div><div class="ttdef"><b>Definition:</b> <a href="_m_l_sampling_8h_source.html#l00442">MLSampling.h:442</a></div></div>
<div class="ttc" id="_mpi_comm_8h_html_afbf78d291c032aa7f512bc566cee2bd1"><div class="ttname"><a href="_mpi_comm_8h.html#afbf78d291c032aa7f512bc566cee2bd1">RawValue_MPI_SUM</a></div><div class="ttdeci">#define RawValue_MPI_SUM</div><div class="ttdef"><b>Definition:</b> <a href="_mpi_comm_8h_source.html#l00052">MpiComm.h:52</a></div></div>
<div class="ttc" id="_metropolis_hastings_s_g_options_8h_html_a75699ceb938d800e2b7f59ede3ea9a31"><div class="ttname"><a href="_metropolis_hastings_s_g_options_8h.html#a75699ceb938d800e2b7f59ede3ea9a31">UQ_MH_SG_FILENAME_FOR_NO_FILE</a></div><div class="ttdeci">#define UQ_MH_SG_FILENAME_FOR_NO_FILE</div><div class="ttdef"><b>Definition:</b> <a href="_metropolis_hastings_s_g_options_8h_source.html#l00035">MetropolisHastingsSGOptions.h:35</a></div></div>
<div class="ttc" id="class_q_u_e_s_o_1_1_base_environment_html_a78b57112bbd0e6dd0e8afec00b40ffa7"><div class="ttname"><a href="class_q_u_e_s_o_1_1_base_environment.html#a78b57112bbd0e6dd0e8afec00b40ffa7">QUESO::BaseEnvironment::worldRank</a></div><div class="ttdeci">int worldRank() const </div><div class="ttdoc">Returns the process world rank. </div><div class="ttdef"><b>Definition:</b> <a href="_environment_8_c_source.html#l00235">Environment.C:235</a></div></div>
<div class="ttc" id="namespace_q_u_e_s_o_html_a8e909502900aecf24cedba022ea84471"><div class="ttname"><a href="namespace_q_u_e_s_o.html#a8e909502900aecf24cedba022ea84471">QUESO::UQ_OK_RC</a></div><div class="ttdeci">const int UQ_OK_RC</div><div class="ttdef"><b>Definition:</b> <a href="_defines_8h_source.html#l00075">Defines.h:75</a></div></div>
<div class="ttc" id="class_q_u_e_s_o_1_1_scalar_sequence_html_a198b72423333bc5aa1722b830b64a263"><div class="ttname"><a href="class_q_u_e_s_o_1_1_scalar_sequence.html#a198b72423333bc5aa1722b830b64a263">QUESO::ScalarSequence::setName</a></div><div class="ttdeci">void setName(const std::string &amp;newName)</div><div class="ttdoc">Sets a new name to the sequence of scalars. </div><div class="ttdef"><b>Definition:</b> <a href="_scalar_sequence_8_c_source.html#l00120">ScalarSequence.C:120</a></div></div>
<div class="ttc" id="class_q_u_e_s_o_1_1_base_environment_html_ab8fe853074f12ea34e18724119a2fc75"><div class="ttname"><a href="class_q_u_e_s_o_1_1_base_environment.html#ab8fe853074f12ea34e18724119a2fc75">QUESO::BaseEnvironment::openOutputFile</a></div><div class="ttdeci">bool openOutputFile(const std::string &amp;fileName, const std::string &amp;fileType, const std::set&lt; unsigned int &gt; &amp;allowedSubEnvIds, bool writeOver, FilePtrSetStruct &amp;filePtrSet) const </div><div class="ttdoc">Opens an output file for each sub-environment that was chosen to send data to the file...</div><div class="ttdef"><b>Definition:</b> <a href="_environment_8_c_source.html#l00516">Environment.C:516</a></div></div>
<div class="ttc" id="class_q_u_e_s_o_1_1_m_l_sampling_html_af9416874c856e50f3b35270e801f17e4"><div class="ttname"><a href="class_q_u_e_s_o_1_1_m_l_sampling.html#af9416874c856e50f3b35270e801f17e4">QUESO::MLSampling::m_currLevel</a></div><div class="ttdeci">unsigned int m_currLevel</div><div class="ttdoc">Current level. </div><div class="ttdef"><b>Definition:</b> <a href="_m_l_sampling_8h_source.html#l00464">MLSampling.h:464</a></div></div>
<div class="ttc" id="class_q_u_e_s_o_1_1_scalar_sequence_html_a2f832dd5eda37df06eb52650ab8ce733"><div class="ttname"><a href="class_q_u_e_s_o_1_1_scalar_sequence.html#a2f832dd5eda37df06eb52650ab8ce733">QUESO::ScalarSequence::unifiedWriteContents</a></div><div class="ttdeci">void unifiedWriteContents(const std::string &amp;fileName, const std::string &amp;fileType) const </div><div class="ttdoc">Writes the unified sequence to a file. </div><div class="ttdef"><b>Definition:</b> <a href="_scalar_sequence_8_c_source.html#l02799">ScalarSequence.C:2799</a></div></div>
<div class="ttc" id="_m_l_sampling_level_options_8h_html_a68d15eaf394d210effcf584b938206d3"><div class="ttname"><a href="_m_l_sampling_level_options_8h.html#a68d15eaf394d210effcf584b938206d3">LEVEL_REF_ID</a></div><div class="ttdeci">#define LEVEL_REF_ID</div><div class="ttdef"><b>Definition:</b> <a href="_m_l_sampling_level_options_8h_source.html#l00028">MLSamplingLevelOptions.h:28</a></div></div>
<div class="ttc" id="_defines_8h_html_ac440026eff7deb1c1eed1eea0e8e36ba"><div class="ttname"><a href="_defines_8h.html#ac440026eff7deb1c1eed1eea0e8e36ba">UQ_FILE_EXTENSION_FOR_MATLAB_FORMAT</a></div><div class="ttdeci">#define UQ_FILE_EXTENSION_FOR_MATLAB_FORMAT</div><div class="ttdef"><b>Definition:</b> <a href="_defines_8h_source.html#l00088">Defines.h:88</a></div></div>
<div class="ttc" id="namespace_q_u_e_s_o_html_a424bc33f2e6e287fd468408d14b772ee"><div class="ttname"><a href="namespace_q_u_e_s_o.html#a424bc33f2e6e287fd468408d14b772ee">QUESO::MiscGetEllapsedSeconds</a></div><div class="ttdeci">double MiscGetEllapsedSeconds(struct timeval *timeval0)</div><div class="ttdef"><b>Definition:</b> <a href="_miscellaneous_8_c_source.html#l00287">Miscellaneous.C:287</a></div></div>
<div class="ttc" id="class_q_u_e_s_o_1_1_mpi_comm_html_a72e137e60ef8060efb1ee5fc874fa4b8"><div class="ttname"><a href="class_q_u_e_s_o_1_1_mpi_comm.html#a72e137e60ef8060efb1ee5fc874fa4b8">QUESO::MpiComm::Allreduce</a></div><div class="ttdeci">void Allreduce(void *sendbuf, void *recvbuf, int count, RawType_MPI_Datatype datatype, RawType_MPI_Op op, const char *whereMsg, const char *whatMsg) const </div><div class="ttdoc">Combines values from all processes and distributes the result back to all processes. </div><div class="ttdef"><b>Definition:</b> <a href="_mpi_comm_8_c_source.html#l00131">MpiComm.C:131</a></div></div>
<div class="ttc" id="class_q_u_e_s_o_1_1_scalar_sequence_html_aaf386a04a0cebd7f88c5b7694a5fd3d1"><div class="ttname"><a href="class_q_u_e_s_o_1_1_scalar_sequence.html#aaf386a04a0cebd7f88c5b7694a5fd3d1">QUESO::ScalarSequence::filter</a></div><div class="ttdeci">void filter(unsigned int initialPos, unsigned int spacing)</div><div class="ttdoc">Filters positions in the sequence of vectors. </div><div class="ttdef"><b>Definition:</b> <a href="_scalar_sequence_8_c_source.html#l02575">ScalarSequence.C:2575</a></div></div>
<div class="ttc" id="_defines_8h_html_a56d63d18d0a6d45757de47fcc06f574d"><div class="ttname"><a href="_defines_8h.html#a56d63d18d0a6d45757de47fcc06f574d">UQ_FATAL_TEST_MACRO</a></div><div class="ttdeci">#define UQ_FATAL_TEST_MACRO(test, givenRank, where, what)</div><div class="ttdef"><b>Definition:</b> <a href="_defines_8h_source.html#l00222">Defines.h:222</a></div></div>
<div class="ttc" id="_mpi_comm_8h_html_a06cbfbc33436f6e0dc8a48ff3c49bdfc"><div class="ttname"><a href="_mpi_comm_8h.html#a06cbfbc33436f6e0dc8a48ff3c49bdfc">RawValue_MPI_UNSIGNED</a></div><div class="ttdeci">#define RawValue_MPI_UNSIGNED</div><div class="ttdef"><b>Definition:</b> <a href="_mpi_comm_8h_source.html#l00049">MpiComm.h:49</a></div></div>
<div class="ttc" id="class_q_u_e_s_o_1_1_m_l_sampling_html_a1b1f8ccb4823bdfa26ec652f0807c63e"><div class="ttname"><a href="class_q_u_e_s_o_1_1_m_l_sampling.html#a1b1f8ccb4823bdfa26ec652f0807c63e">QUESO::MLSampling::m_currStep</a></div><div class="ttdeci">unsigned int m_currStep</div><div class="ttdoc">Curret step. </div><div class="ttdef"><b>Definition:</b> <a href="_m_l_sampling_8h_source.html#l00467">MLSampling.h:467</a></div></div>
<div class="ttc" id="class_q_u_e_s_o_1_1_base_environment_html_a1fe5f244fc0316a0ab3e37463f108b96"><div class="ttname"><a href="class_q_u_e_s_o_1_1_base_environment.html#a1fe5f244fc0316a0ab3e37463f108b96">QUESO::BaseEnvironment::displayVerbosity</a></div><div class="ttdeci">unsigned int displayVerbosity() const </div><div class="ttdef"><b>Definition:</b> <a href="_environment_8_c_source.html#l00436">Environment.C:436</a></div></div>
<div class="ttc" id="class_q_u_e_s_o_1_1_base_environment_html_a8a0064746ae8dddfece4229b9ad374d6"><div class="ttname"><a href="class_q_u_e_s_o_1_1_base_environment.html#a8a0064746ae8dddfece4229b9ad374d6">QUESO::BaseEnvironment::subDisplayFile</a></div><div class="ttdeci">std::ofstream * subDisplayFile() const </div><div class="ttdoc">Access function for m_subDisplayFile (displays file on stream). </div><div class="ttdef"><b>Definition:</b> <a href="_environment_8_c_source.html#l00305">Environment.C:305</a></div></div>
<div class="ttc" id="class_q_u_e_s_o_1_1_base_environment_html_a689e4d140c74d495d97eb498714a4b82"><div class="ttname"><a href="class_q_u_e_s_o_1_1_base_environment.html#a689e4d140c74d495d97eb498714a4b82">QUESO::BaseEnvironment::inter0Comm</a></div><div class="ttdeci">const MpiComm &amp; inter0Comm() const </div><div class="ttdoc">Access function for MpiComm inter0-communicator. </div><div class="ttdef"><b>Definition:</b> <a href="_environment_8_c_source.html#l00295">Environment.C:295</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a04b0d797b321bb5c4047aab89a445e3c"></a>
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;class P_V , class P_M &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="class_q_u_e_s_o_1_1_m_l_sampling.html">QUESO::MLSampling</a>&lt; P_V, P_M &gt;::generateUnbLinkedChains_all </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_q_u_e_s_o_1_1_m_l_sampling_level_options.html">MLSamplingLevelOptions</a> &amp;&#160;</td>
          <td class="paramname"><em>inputOptions</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const P_M &amp;&#160;</td>
          <td class="paramname"><em>unifiedCovMatrix</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="class_q_u_e_s_o_1_1_generic_vector_r_v.html">GenericVectorRV</a>&lt; P_V, P_M &gt; &amp;&#160;</td>
          <td class="paramname"><em>rv</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="struct_q_u_e_s_o_1_1_unbalanced_linked_chains_per_node_struct.html">UnbalancedLinkedChainsPerNodeStruct</a> &amp;&#160;</td>
          <td class="paramname"><em>unbalancedLinkControl</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned int&#160;</td>
          <td class="paramname"><em>indexOfFirstWeight</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="class_q_u_e_s_o_1_1_sequence_of_vectors.html">SequenceOfVectors</a>&lt; P_V, P_M &gt; &amp;&#160;</td>
          <td class="paramname"><em>prevChain</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_q_u_e_s_o_1_1_sequence_of_vectors.html">SequenceOfVectors</a>&lt; P_V, P_M &gt; &amp;&#160;</td>
          <td class="paramname"><em>workingChain</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double &amp;&#160;</td>
          <td class="paramname"><em>cumulativeRunTime</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned int &amp;&#160;</td>
          <td class="paramname"><em>cumulativeRejections</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_q_u_e_s_o_1_1_scalar_sequence.html">ScalarSequence</a>&lt; double &gt; *&#160;</td>
          <td class="paramname"><em>currLogLikelihoodValues</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_q_u_e_s_o_1_1_scalar_sequence.html">ScalarSequence</a>&lt; double &gt; *&#160;</td>
          <td class="paramname"><em>currLogTargetValues</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">inputOptions,unifiedCovMatrix,rv,unbalancedLinkControl,indexOfFirstWeight,prevChain</td><td></td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">workingChain,cumulativeRunTime,cumulativeRejections,currLogLikelihoodValues,currLogTargetValues</td><td></td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="_m_l_sampling_8_c_source.html#l00890">890</a> of file <a class="el" href="_m_l_sampling_8_c_source.html">MLSampling.C</a>.</p>

<p>References <a class="el" href="_vector_sequence_8_c_source.html#l00357">QUESO::BaseVectorSequence&lt; V, M &gt;::append()</a>, <a class="el" href="_scalar_sequence_8_c_source.html#l02649">QUESO::ScalarSequence&lt; T &gt;::append()</a>, <a class="el" href="_metropolis_hastings_s_g_8_c_source.html#l00811">QUESO::MetropolisHastingsSG&lt; P_V, P_M &gt;::generateSequence()</a>, <a class="el" href="_sequence_of_vectors_8_c_source.html#l00197">QUESO::SequenceOfVectors&lt; V, M &gt;::getPositionValues()</a>, <a class="el" href="_metropolis_hastings_s_g_8_c_source.html#l01250">QUESO::MetropolisHastingsSG&lt; P_V, P_M &gt;::getRawChainInfo()</a>, <a class="el" href="_m_l_sampling_level_options_8h_source.html#l00028">LEVEL_REF_ID</a>, <a class="el" href="_m_l_sampling_level_options_8h_source.html#l00222">QUESO::MLSamplingLevelOptions::m_rawChainSize</a>, <a class="el" href="_miscellaneous_8_c_source.html#l00287">QUESO::MiscGetEllapsedSeconds()</a>, <a class="el" href="_metropolis_hastings_s_g_8h_source.html#l00102">QUESO::MHRawChainInfoStruct::numRejections</a>, <a class="el" href="_mpi_comm_8h_source.html#l00051">RawValue_MPI_MAX</a>, <a class="el" href="_mpi_comm_8h_source.html#l00050">RawValue_MPI_MIN</a>, <a class="el" href="_mpi_comm_8h_source.html#l00052">RawValue_MPI_SUM</a>, <a class="el" href="_mpi_comm_8h_source.html#l00049">RawValue_MPI_UNSIGNED</a>, <a class="el" href="_metropolis_hastings_s_g_8h_source.html#l00090">QUESO::MHRawChainInfoStruct::runTime</a>, <a class="el" href="_sequence_of_vectors_8_c_source.html#l00103">QUESO::SequenceOfVectors&lt; V, M &gt;::subSequenceSize()</a>, <a class="el" href="_scalar_sequence_8_c_source.html#l00141">QUESO::ScalarSequence&lt; T &gt;::subSequenceSize()</a>, and <a class="el" href="_m_l_sampling_8h_source.html#l00097">QUESO::UnbalancedLinkedChainsPerNodeStruct::unbLinkedChains</a>.</p>
<div class="fragment"><div class="line"><a name="l00902"></a><span class="lineno">  902</span>&#160;{</div>
<div class="line"><a name="l00903"></a><span class="lineno">  903</span>&#160;  <a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#a0b0779b41ff304058856e97e1d16b4d4">fullComm</a>().<a class="code" href="class_q_u_e_s_o_1_1_mpi_comm.html#a4059971c30e023b272fccaa6aa00c426">Barrier</a>();</div>
<div class="line"><a name="l00904"></a><span class="lineno">  904</span>&#160;</div>
<div class="line"><a name="l00905"></a><span class="lineno">  905</span>&#160;  <span class="keywordflow">if</span> ((<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#a8a0064746ae8dddfece4229b9ad374d6">subDisplayFile</a>()) &amp;&amp; (<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#a1fe5f244fc0316a0ab3e37463f108b96">displayVerbosity</a>() &gt;= 0)) {</div>
<div class="line"><a name="l00906"></a><span class="lineno">  906</span>&#160;    *<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#a8a0064746ae8dddfece4229b9ad374d6">subDisplayFile</a>() &lt;&lt; <span class="stringliteral">&quot;Entering MLSampling&lt;P_V,P_M&gt;::generateUnbLinkedChains_all()&quot;</span></div>
<div class="line"><a name="l00907"></a><span class="lineno">  907</span>&#160;                            &lt;&lt; <span class="stringliteral">&quot;: unbalancedLinkControl.unbLinkedChains.size() = &quot;</span> &lt;&lt; unbalancedLinkControl.unbLinkedChains.size()</div>
<div class="line"><a name="l00908"></a><span class="lineno">  908</span>&#160;                            &lt;&lt; <span class="stringliteral">&quot;, indexOfFirstWeight = &quot;</span>                           &lt;&lt; indexOfFirstWeight</div>
<div class="line"><a name="l00909"></a><span class="lineno">  909</span>&#160;                            &lt;&lt; std::endl;</div>
<div class="line"><a name="l00910"></a><span class="lineno">  910</span>&#160;  }</div>
<div class="line"><a name="l00911"></a><span class="lineno">  911</span>&#160;</div>
<div class="line"><a name="l00912"></a><span class="lineno">  912</span>&#160;  P_V auxInitialPosition(<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a7bc4c72f65ba9166ed94a6e198b0915b">m_vectorSpace</a>.<a class="code" href="class_q_u_e_s_o_1_1_vector_space.html#a92e963bb5cab3eecd290dfe4b8f03b04">zeroVector</a>());</div>
<div class="line"><a name="l00913"></a><span class="lineno">  913</span>&#160;</div>
<div class="line"><a name="l00914"></a><span class="lineno">  914</span>&#160;  <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> chainIdMax = 0;</div>
<div class="line"><a name="l00915"></a><span class="lineno">  915</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#ae106b5bb8a80b655b88b3a26b1e7c185">inter0Rank</a>() &gt;= 0) {</div>
<div class="line"><a name="l00916"></a><span class="lineno">  916</span>&#160;    chainIdMax = unbalancedLinkControl.unbLinkedChains.size();</div>
<div class="line"><a name="l00917"></a><span class="lineno">  917</span>&#160;  }</div>
<div class="line"><a name="l00918"></a><span class="lineno">  918</span>&#160;  <span class="comment">// KAUST: all nodes in &#39;subComm&#39; should have the same &#39;chainIdMax&#39;</span></div>
<div class="line"><a name="l00919"></a><span class="lineno">  919</span>&#160;  <a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#affe39f53e3d5d678842413370af09145">subComm</a>().<a class="code" href="class_q_u_e_s_o_1_1_mpi_comm.html#abd6af8db8b0c7fd2f5b62e26477a9537">Bcast</a>((<span class="keywordtype">void</span> *) &amp;chainIdMax, (<span class="keywordtype">int</span>) 1, <a class="code" href="_mpi_comm_8h.html#a06cbfbc33436f6e0dc8a48ff3c49bdfc">RawValue_MPI_UNSIGNED</a>, 0, <span class="comment">// Yes, &#39;subComm&#39;, important</span></div>
<div class="line"><a name="l00920"></a><span class="lineno">  920</span>&#160;                        <span class="stringliteral">&quot;MLSampling&lt;P_V,P_M&gt;::generateUnbLinkedChains_all()&quot;</span>,</div>
<div class="line"><a name="l00921"></a><span class="lineno">  921</span>&#160;                        <span class="stringliteral">&quot;failed MPI.Bcast() for chainIdMax&quot;</span>);</div>
<div class="line"><a name="l00922"></a><span class="lineno">  922</span>&#160;</div>
<div class="line"><a name="l00923"></a><span class="lineno">  923</span>&#160;  <span class="keyword">struct </span>timeval timevalEntering;</div>
<div class="line"><a name="l00924"></a><span class="lineno">  924</span>&#160;  <span class="keywordtype">int</span> iRC = 0;</div>
<div class="line"><a name="l00925"></a><span class="lineno">  925</span>&#160;  iRC = gettimeofday(&amp;timevalEntering, NULL);</div>
<div class="line"><a name="l00926"></a><span class="lineno">  926</span>&#160;  <span class="keywordflow">if</span> (iRC) {}; <span class="comment">// just to remove compiler warning</span></div>
<div class="line"><a name="l00927"></a><span class="lineno">  927</span>&#160;</div>
<div class="line"><a name="l00928"></a><span class="lineno">  928</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#ae106b5bb8a80b655b88b3a26b1e7c185">inter0Rank</a>() &gt;= 0) {</div>
<div class="line"><a name="l00929"></a><span class="lineno">  929</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> numberOfPositions = 0;</div>
<div class="line"><a name="l00930"></a><span class="lineno">  930</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> chainId = 0; chainId &lt; chainIdMax; ++chainId) {</div>
<div class="line"><a name="l00931"></a><span class="lineno">  931</span>&#160;      numberOfPositions += unbalancedLinkControl.unbLinkedChains[chainId].numberOfPositions;</div>
<div class="line"><a name="l00932"></a><span class="lineno">  932</span>&#160;    }</div>
<div class="line"><a name="l00933"></a><span class="lineno">  933</span>&#160;</div>
<div class="line"><a name="l00934"></a><span class="lineno">  934</span>&#160;    std::vector&lt;unsigned int&gt; auxBuf(1,0);</div>
<div class="line"><a name="l00935"></a><span class="lineno">  935</span>&#160;</div>
<div class="line"><a name="l00936"></a><span class="lineno">  936</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> minNumberOfPositions = 0;</div>
<div class="line"><a name="l00937"></a><span class="lineno">  937</span>&#160;    auxBuf[0] = numberOfPositions;</div>
<div class="line"><a name="l00938"></a><span class="lineno">  938</span>&#160;    <a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#a689e4d140c74d495d97eb498714a4b82">inter0Comm</a>().<a class="code" href="class_q_u_e_s_o_1_1_mpi_comm.html#a72e137e60ef8060efb1ee5fc874fa4b8">Allreduce</a>((<span class="keywordtype">void</span> *) &amp;auxBuf[0], (<span class="keywordtype">void</span> *) &amp;minNumberOfPositions, (<span class="keywordtype">int</span>) auxBuf.size(), <a class="code" href="_mpi_comm_8h.html#a06cbfbc33436f6e0dc8a48ff3c49bdfc">RawValue_MPI_UNSIGNED</a>, <a class="code" href="_mpi_comm_8h.html#a8e30f42fdac116861205e83e2aa18042">RawValue_MPI_MIN</a>,</div>
<div class="line"><a name="l00939"></a><span class="lineno">  939</span>&#160;                                 <span class="stringliteral">&quot;MLSampling&lt;P_V,P_M&gt;::generateUnbLinkedChains_all()&quot;</span>,</div>
<div class="line"><a name="l00940"></a><span class="lineno">  940</span>&#160;                                 <span class="stringliteral">&quot;failed MPI.Allreduce() for min&quot;</span>);</div>
<div class="line"><a name="l00941"></a><span class="lineno">  941</span>&#160;</div>
<div class="line"><a name="l00942"></a><span class="lineno">  942</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> maxNumberOfPositions = 0;</div>
<div class="line"><a name="l00943"></a><span class="lineno">  943</span>&#160;    auxBuf[0] = numberOfPositions;</div>
<div class="line"><a name="l00944"></a><span class="lineno">  944</span>&#160;    <a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#a689e4d140c74d495d97eb498714a4b82">inter0Comm</a>().<a class="code" href="class_q_u_e_s_o_1_1_mpi_comm.html#a72e137e60ef8060efb1ee5fc874fa4b8">Allreduce</a>((<span class="keywordtype">void</span> *) &amp;auxBuf[0], (<span class="keywordtype">void</span> *) &amp;maxNumberOfPositions, (<span class="keywordtype">int</span>) auxBuf.size(), <a class="code" href="_mpi_comm_8h.html#a06cbfbc33436f6e0dc8a48ff3c49bdfc">RawValue_MPI_UNSIGNED</a>, <a class="code" href="_mpi_comm_8h.html#a68f3ac7ff71a6504e236b0c95de78178">RawValue_MPI_MAX</a>,</div>
<div class="line"><a name="l00945"></a><span class="lineno">  945</span>&#160;                                 <span class="stringliteral">&quot;MLSampling&lt;P_V,P_M&gt;::generateUnbLinkedChains_all()&quot;</span>,</div>
<div class="line"><a name="l00946"></a><span class="lineno">  946</span>&#160;                                 <span class="stringliteral">&quot;failed MPI.Allreduce() for max&quot;</span>);</div>
<div class="line"><a name="l00947"></a><span class="lineno">  947</span>&#160;</div>
<div class="line"><a name="l00948"></a><span class="lineno">  948</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> sumNumberOfPositions = 0;</div>
<div class="line"><a name="l00949"></a><span class="lineno">  949</span>&#160;    auxBuf[0] = numberOfPositions;</div>
<div class="line"><a name="l00950"></a><span class="lineno">  950</span>&#160;    <a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#a689e4d140c74d495d97eb498714a4b82">inter0Comm</a>().<a class="code" href="class_q_u_e_s_o_1_1_mpi_comm.html#a72e137e60ef8060efb1ee5fc874fa4b8">Allreduce</a>((<span class="keywordtype">void</span> *) &amp;auxBuf[0], (<span class="keywordtype">void</span> *) &amp;sumNumberOfPositions, (<span class="keywordtype">int</span>) auxBuf.size(), <a class="code" href="_mpi_comm_8h.html#a06cbfbc33436f6e0dc8a48ff3c49bdfc">RawValue_MPI_UNSIGNED</a>, <a class="code" href="_mpi_comm_8h.html#afbf78d291c032aa7f512bc566cee2bd1">RawValue_MPI_SUM</a>,</div>
<div class="line"><a name="l00951"></a><span class="lineno">  951</span>&#160;                                 <span class="stringliteral">&quot;MLSampling&lt;P_V,P_M&gt;::generateUnbLinkedChains_all()&quot;</span>,</div>
<div class="line"><a name="l00952"></a><span class="lineno">  952</span>&#160;                                 <span class="stringliteral">&quot;failed MPI.Allreduce() for sum&quot;</span>);</div>
<div class="line"><a name="l00953"></a><span class="lineno">  953</span>&#160;</div>
<div class="line"><a name="l00954"></a><span class="lineno">  954</span>&#160;    <span class="keywordflow">if</span> ((<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#a8a0064746ae8dddfece4229b9ad374d6">subDisplayFile</a>()) &amp;&amp; (<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#a1fe5f244fc0316a0ab3e37463f108b96">displayVerbosity</a>() &gt;= 0)) {</div>
<div class="line"><a name="l00955"></a><span class="lineno">  955</span>&#160;      *<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#a8a0064746ae8dddfece4229b9ad374d6">subDisplayFile</a>() &lt;&lt; <span class="stringliteral">&quot;KEY In MLSampling&lt;P_V,P_M&gt;::generateUnbLinkedChains_all()&quot;</span></div>
<div class="line"><a name="l00956"></a><span class="lineno">  956</span>&#160;                              &lt;&lt; <span class="stringliteral">&quot;, level &quot;</span>               &lt;&lt; <a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#af9416874c856e50f3b35270e801f17e4">m_currLevel</a>+<a class="code" href="_m_l_sampling_level_options_8h.html#a68d15eaf394d210effcf584b938206d3">LEVEL_REF_ID</a></div>
<div class="line"><a name="l00957"></a><span class="lineno">  957</span>&#160;                              &lt;&lt; <span class="stringliteral">&quot;, step &quot;</span>                &lt;&lt; <a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a1b1f8ccb4823bdfa26ec652f0807c63e">m_currStep</a></div>
<div class="line"><a name="l00958"></a><span class="lineno">  958</span>&#160;                              &lt;&lt; <span class="stringliteral">&quot;: chainIdMax = &quot;</span>        &lt;&lt; chainIdMax</div>
<div class="line"><a name="l00959"></a><span class="lineno">  959</span>&#160;                              &lt;&lt; <span class="stringliteral">&quot;, numberOfPositions = &quot;</span> &lt;&lt; numberOfPositions</div>
<div class="line"><a name="l00960"></a><span class="lineno">  960</span>&#160;                              &lt;&lt; <span class="stringliteral">&quot;, at &quot;</span>                  &lt;&lt; ctime(&amp;timevalEntering.tv_sec)</div>
<div class="line"><a name="l00961"></a><span class="lineno">  961</span>&#160;                              &lt;&lt; std::endl;</div>
<div class="line"><a name="l00962"></a><span class="lineno">  962</span>&#160;      *<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#a8a0064746ae8dddfece4229b9ad374d6">subDisplayFile</a>() &lt;&lt; <span class="stringliteral">&quot;KEY In MLSampling&lt;P_V,P_M&gt;::generateUnbLinkedChains_all()&quot;</span></div>
<div class="line"><a name="l00963"></a><span class="lineno">  963</span>&#160;                              &lt;&lt; <span class="stringliteral">&quot;, level &quot;</span>                  &lt;&lt; <a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#af9416874c856e50f3b35270e801f17e4">m_currLevel</a>+<a class="code" href="_m_l_sampling_level_options_8h.html#a68d15eaf394d210effcf584b938206d3">LEVEL_REF_ID</a></div>
<div class="line"><a name="l00964"></a><span class="lineno">  964</span>&#160;                              &lt;&lt; <span class="stringliteral">&quot;, step &quot;</span>                   &lt;&lt; <a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a1b1f8ccb4823bdfa26ec652f0807c63e">m_currStep</a></div>
<div class="line"><a name="l00965"></a><span class="lineno">  965</span>&#160;                              &lt;&lt; <span class="stringliteral">&quot;: minNumberOfPositions = &quot;</span> &lt;&lt; minNumberOfPositions</div>
<div class="line"><a name="l00966"></a><span class="lineno">  966</span>&#160;                              &lt;&lt; <span class="stringliteral">&quot;, avgNumberOfPositions = &quot;</span> &lt;&lt; ((double) sumNumberOfPositions)/((double) <a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#a689e4d140c74d495d97eb498714a4b82">inter0Comm</a>().<a class="code" href="class_q_u_e_s_o_1_1_mpi_comm.html#aa780721ae0fdeabc5a15e04cb0cad964">NumProc</a>())</div>
<div class="line"><a name="l00967"></a><span class="lineno">  967</span>&#160;                              &lt;&lt; <span class="stringliteral">&quot;, maxNumberOfPositions = &quot;</span> &lt;&lt; maxNumberOfPositions</div>
<div class="line"><a name="l00968"></a><span class="lineno">  968</span>&#160;                              &lt;&lt; std::endl;</div>
<div class="line"><a name="l00969"></a><span class="lineno">  969</span>&#160;    }</div>
<div class="line"><a name="l00970"></a><span class="lineno">  970</span>&#160;  }</div>
<div class="line"><a name="l00971"></a><span class="lineno">  971</span>&#160;  <span class="keywordflow">if</span> ((<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#abdd5cd35419283c33cc40a77d0f4f07f">m_debugExponent</a> == 1.) &amp;&amp;</div>
<div class="line"><a name="l00972"></a><span class="lineno">  972</span>&#160;      (<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a1b1f8ccb4823bdfa26ec652f0807c63e">m_currStep</a>      == 10)) {</div>
<div class="line"><a name="l00973"></a><span class="lineno">  973</span>&#160;    <span class="comment">//m_env.setExceptionalCircumstance(true);</span></div>
<div class="line"><a name="l00974"></a><span class="lineno">  974</span>&#160;  }</div>
<div class="line"><a name="l00975"></a><span class="lineno">  975</span>&#160;  <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> cumulativeNumPositions = 0;</div>
<div class="line"><a name="l00976"></a><span class="lineno">  976</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> chainId = 0; chainId &lt; chainIdMax; ++chainId) {</div>
<div class="line"><a name="l00977"></a><span class="lineno">  977</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> tmpChainSize = 0;</div>
<div class="line"><a name="l00978"></a><span class="lineno">  978</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#ae106b5bb8a80b655b88b3a26b1e7c185">inter0Rank</a>() &gt;= 0) {</div>
<div class="line"><a name="l00979"></a><span class="lineno">  979</span>&#160;      <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> auxIndex = unbalancedLinkControl.unbLinkedChains[chainId].initialPositionIndexInPreviousChain - indexOfFirstWeight; <span class="comment">// KAUST4 // Round Rock</span></div>
<div class="line"><a name="l00980"></a><span class="lineno">  980</span>&#160;      prevChain.getPositionValues(auxIndex,auxInitialPosition); <span class="comment">// Round Rock</span></div>
<div class="line"><a name="l00981"></a><span class="lineno">  981</span>&#160;      tmpChainSize = unbalancedLinkControl.unbLinkedChains[chainId].numberOfPositions+1; <span class="comment">// IMPORTANT: &#39;+1&#39; in order to discard initial position afterwards</span></div>
<div class="line"><a name="l00982"></a><span class="lineno">  982</span>&#160;      <span class="keywordflow">if</span> ((<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#a8a0064746ae8dddfece4229b9ad374d6">subDisplayFile</a>()       ) &amp;&amp;</div>
<div class="line"><a name="l00983"></a><span class="lineno">  983</span>&#160;          (<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#a1fe5f244fc0316a0ab3e37463f108b96">displayVerbosity</a>() &gt;= 3)) {</div>
<div class="line"><a name="l00984"></a><span class="lineno">  984</span>&#160;        *<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#a8a0064746ae8dddfece4229b9ad374d6">subDisplayFile</a>() &lt;&lt; <span class="stringliteral">&quot;In MLSampling&lt;P_V,P_M&gt;::generateUnbLinkedChains_all()&quot;</span></div>
<div class="line"><a name="l00985"></a><span class="lineno">  985</span>&#160;                                &lt;&lt; <span class="stringliteral">&quot;, level &quot;</span>            &lt;&lt; <a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#af9416874c856e50f3b35270e801f17e4">m_currLevel</a>+<a class="code" href="_m_l_sampling_level_options_8h.html#a68d15eaf394d210effcf584b938206d3">LEVEL_REF_ID</a></div>
<div class="line"><a name="l00986"></a><span class="lineno">  986</span>&#160;                                &lt;&lt; <span class="stringliteral">&quot;, step &quot;</span>             &lt;&lt; <a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a1b1f8ccb4823bdfa26ec652f0807c63e">m_currStep</a></div>
<div class="line"><a name="l00987"></a><span class="lineno">  987</span>&#160;                                &lt;&lt; <span class="stringliteral">&quot;, chainId = &quot;</span>        &lt;&lt; chainId</div>
<div class="line"><a name="l00988"></a><span class="lineno">  988</span>&#160;                                &lt;&lt; <span class="stringliteral">&quot; &lt; &quot;</span>                 &lt;&lt; chainIdMax</div>
<div class="line"><a name="l00989"></a><span class="lineno">  989</span>&#160;                                &lt;&lt; <span class="stringliteral">&quot;: begin generating &quot;</span> &lt;&lt; tmpChainSize</div>
<div class="line"><a name="l00990"></a><span class="lineno">  990</span>&#160;                                &lt;&lt; <span class="stringliteral">&quot; chain positions&quot;</span></div>
<div class="line"><a name="l00991"></a><span class="lineno">  991</span>&#160;                                &lt;&lt; std::endl;</div>
<div class="line"><a name="l00992"></a><span class="lineno">  992</span>&#160;      }</div>
<div class="line"><a name="l00993"></a><span class="lineno">  993</span>&#160;    }</div>
<div class="line"><a name="l00994"></a><span class="lineno">  994</span>&#160;    auxInitialPosition.mpiBcast(0, <a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#affe39f53e3d5d678842413370af09145">subComm</a>()); <span class="comment">// Yes, &#39;subComm&#39;, important // KAUST</span></div>
<div class="line"><a name="l00995"></a><span class="lineno">  995</span>&#160;<span class="preprocessor">#if 0 // For debug only</span></div>
<div class="line"><a name="l00996"></a><span class="lineno">  996</span>&#160;<span class="preprocessor"></span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> r = 0; r &lt; <a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#affe39f53e3d5d678842413370af09145">subComm</a>().<a class="code" href="class_q_u_e_s_o_1_1_mpi_comm.html#aa780721ae0fdeabc5a15e04cb0cad964">NumProc</a>(); ++r) {</div>
<div class="line"><a name="l00997"></a><span class="lineno">  997</span>&#160;      <span class="keywordflow">if</span> (r == <a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#affe39f53e3d5d678842413370af09145">subComm</a>().<a class="code" href="class_q_u_e_s_o_1_1_mpi_comm.html#ab806f80f206210723fcb4df8185a55a8">MyPID</a>()) {</div>
<div class="line"><a name="l00998"></a><span class="lineno">  998</span>&#160;  std::cout &lt;&lt; <span class="stringliteral">&quot;Vector &#39;auxInitialPosition at rank &quot;</span> &lt;&lt; r</div>
<div class="line"><a name="l00999"></a><span class="lineno">  999</span>&#160;                  &lt;&lt; <span class="stringliteral">&quot; has contents &quot;</span>                      &lt;&lt; auxInitialPosition</div>
<div class="line"><a name="l01000"></a><span class="lineno"> 1000</span>&#160;                  &lt;&lt; std::endl;</div>
<div class="line"><a name="l01001"></a><span class="lineno"> 1001</span>&#160;      }</div>
<div class="line"><a name="l01002"></a><span class="lineno"> 1002</span>&#160;      <a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#affe39f53e3d5d678842413370af09145">subComm</a>().<a class="code" href="class_q_u_e_s_o_1_1_mpi_comm.html#a4059971c30e023b272fccaa6aa00c426">Barrier</a>();</div>
<div class="line"><a name="l01003"></a><span class="lineno"> 1003</span>&#160;    }</div>
<div class="line"><a name="l01004"></a><span class="lineno"> 1004</span>&#160;    sleep(1);</div>
<div class="line"><a name="l01005"></a><span class="lineno"> 1005</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01006"></a><span class="lineno"> 1006</span>&#160;<span class="preprocessor"></span></div>
<div class="line"><a name="l01007"></a><span class="lineno"> 1007</span>&#160;    <span class="comment">// KAUST: all nodes in &#39;subComm&#39; should have the same &#39;tmpChainSize&#39;</span></div>
<div class="line"><a name="l01008"></a><span class="lineno"> 1008</span>&#160;    <a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#affe39f53e3d5d678842413370af09145">subComm</a>().<a class="code" href="class_q_u_e_s_o_1_1_mpi_comm.html#abd6af8db8b0c7fd2f5b62e26477a9537">Bcast</a>((<span class="keywordtype">void</span> *) &amp;tmpChainSize, (<span class="keywordtype">int</span>) 1, <a class="code" href="_mpi_comm_8h.html#a06cbfbc33436f6e0dc8a48ff3c49bdfc">RawValue_MPI_UNSIGNED</a>, 0, <span class="comment">// Yes, &#39;subComm&#39;, important</span></div>
<div class="line"><a name="l01009"></a><span class="lineno"> 1009</span>&#160;                          <span class="stringliteral">&quot;MLSampling&lt;P_V,P_M&gt;::generateUnbLinkedChains_all()&quot;</span>,</div>
<div class="line"><a name="l01010"></a><span class="lineno"> 1010</span>&#160;                          <span class="stringliteral">&quot;failed MPI.Bcast() for tmpChainSize&quot;</span>);</div>
<div class="line"><a name="l01011"></a><span class="lineno"> 1011</span>&#160;</div>
<div class="line"><a name="l01012"></a><span class="lineno"> 1012</span>&#160;    inputOptions.m_rawChainSize = tmpChainSize;</div>
<div class="line"><a name="l01013"></a><span class="lineno"> 1013</span>&#160;    SequenceOfVectors&lt;P_V,P_M&gt; tmpChain(<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a7bc4c72f65ba9166ed94a6e198b0915b">m_vectorSpace</a>,</div>
<div class="line"><a name="l01014"></a><span class="lineno"> 1014</span>&#160;                                               0,</div>
<div class="line"><a name="l01015"></a><span class="lineno"> 1015</span>&#160;                                               <a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#af8504cc57ec72b3c52833826b2bfff8e">m_options</a>.<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling_options.html#a1d3d48598e0b59b46337ce66a52671a5">m_prefix</a>+<span class="stringliteral">&quot;tmp_chain&quot;</span>);</div>
<div class="line"><a name="l01016"></a><span class="lineno"> 1016</span>&#160;    ScalarSequence&lt;double&gt; tmpLogLikelihoodValues(<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>,0,<span class="stringliteral">&quot;&quot;</span>);</div>
<div class="line"><a name="l01017"></a><span class="lineno"> 1017</span>&#160;    ScalarSequence&lt;double&gt; tmpLogTargetValues    (<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>,0,<span class="stringliteral">&quot;&quot;</span>);</div>
<div class="line"><a name="l01018"></a><span class="lineno"> 1018</span>&#160;</div>
<div class="line"><a name="l01019"></a><span class="lineno"> 1019</span>&#160;    <span class="comment">// KAUST: all nodes should call here</span></div>
<div class="line"><a name="l01020"></a><span class="lineno"> 1020</span>&#160;    MetropolisHastingsSG&lt;P_V,P_M&gt; mcSeqGenerator(inputOptions,</div>
<div class="line"><a name="l01021"></a><span class="lineno"> 1021</span>&#160;                                                        rv,</div>
<div class="line"><a name="l01022"></a><span class="lineno"> 1022</span>&#160;                                                        auxInitialPosition, <span class="comment">// KEY new: pass logPrior and logLikelihood</span></div>
<div class="line"><a name="l01023"></a><span class="lineno"> 1023</span>&#160;                                                        &amp;unifiedCovMatrix);</div>
<div class="line"><a name="l01024"></a><span class="lineno"> 1024</span>&#160;</div>
<div class="line"><a name="l01025"></a><span class="lineno"> 1025</span>&#160;    <span class="comment">// KAUST: all nodes should call here</span></div>
<div class="line"><a name="l01026"></a><span class="lineno"> 1026</span>&#160;    mcSeqGenerator.generateSequence(tmpChain,</div>
<div class="line"><a name="l01027"></a><span class="lineno"> 1027</span>&#160;                                    &amp;tmpLogLikelihoodValues, <span class="comment">// likelihood is IMPORTANT</span></div>
<div class="line"><a name="l01028"></a><span class="lineno"> 1028</span>&#160;                                    &amp;tmpLogTargetValues);</div>
<div class="line"><a name="l01029"></a><span class="lineno"> 1029</span>&#160;    MHRawChainInfoStruct mcRawInfo;</div>
<div class="line"><a name="l01030"></a><span class="lineno"> 1030</span>&#160;    mcSeqGenerator.getRawChainInfo(mcRawInfo);</div>
<div class="line"><a name="l01031"></a><span class="lineno"> 1031</span>&#160;    cumulativeRunTime    += mcRawInfo.runTime;</div>
<div class="line"><a name="l01032"></a><span class="lineno"> 1032</span>&#160;    cumulativeRejections += mcRawInfo.numRejections;</div>
<div class="line"><a name="l01033"></a><span class="lineno"> 1033</span>&#160;</div>
<div class="line"><a name="l01034"></a><span class="lineno"> 1034</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#ae106b5bb8a80b655b88b3a26b1e7c185">inter0Rank</a>() &gt;= 0) {</div>
<div class="line"><a name="l01035"></a><span class="lineno"> 1035</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#af0bc451b18302cfd5ee747c321e1c6e5">exceptionalCircumstance</a>()) {</div>
<div class="line"><a name="l01036"></a><span class="lineno"> 1036</span>&#160;        <span class="keywordflow">if</span> ((<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#a8a0064746ae8dddfece4229b9ad374d6">subDisplayFile</a>()       ) &amp;&amp;</div>
<div class="line"><a name="l01037"></a><span class="lineno"> 1037</span>&#160;            (<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#a1fe5f244fc0316a0ab3e37463f108b96">displayVerbosity</a>() &gt;= 0)) { <span class="comment">// detailed output debug</span></div>
<div class="line"><a name="l01038"></a><span class="lineno"> 1038</span>&#160;          P_V tmpVec(<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a7bc4c72f65ba9166ed94a6e198b0915b">m_vectorSpace</a>.<a class="code" href="class_q_u_e_s_o_1_1_vector_space.html#a92e963bb5cab3eecd290dfe4b8f03b04">zeroVector</a>());</div>
<div class="line"><a name="l01039"></a><span class="lineno"> 1039</span>&#160;          <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = 0; i &lt; tmpLogLikelihoodValues.subSequenceSize(); ++i) {</div>
<div class="line"><a name="l01040"></a><span class="lineno"> 1040</span>&#160;            tmpChain.getPositionValues(i,tmpVec);</div>
<div class="line"><a name="l01041"></a><span class="lineno"> 1041</span>&#160;            *<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#a8a0064746ae8dddfece4229b9ad374d6">subDisplayFile</a>() &lt;&lt; <span class="stringliteral">&quot;DEBUG finalChain[&quot;</span> &lt;&lt; cumulativeNumPositions+i &lt;&lt; <span class="stringliteral">&quot;] &quot;</span></div>
<div class="line"><a name="l01042"></a><span class="lineno"> 1042</span>&#160;                                    &lt;&lt; <span class="stringliteral">&quot;= tmpChain[&quot;</span>               &lt;&lt; i &lt;&lt; <span class="stringliteral">&quot;] = &quot;</span> &lt;&lt; tmpVec</div>
<div class="line"><a name="l01043"></a><span class="lineno"> 1043</span>&#160;                                    &lt;&lt; <span class="stringliteral">&quot;, tmpLogLikelihoodValues[&quot;</span> &lt;&lt; i &lt;&lt; <span class="stringliteral">&quot;] = &quot;</span> &lt;&lt; tmpLogLikelihoodValues[i]</div>
<div class="line"><a name="l01044"></a><span class="lineno"> 1044</span>&#160;                                    &lt;&lt; <span class="stringliteral">&quot;, tmpLogTargetValues[&quot;</span>     &lt;&lt; i &lt;&lt; <span class="stringliteral">&quot;] = &quot;</span> &lt;&lt; tmpLogTargetValues[i]</div>
<div class="line"><a name="l01045"></a><span class="lineno"> 1045</span>&#160;                                    &lt;&lt; std::endl;</div>
<div class="line"><a name="l01046"></a><span class="lineno"> 1046</span>&#160;          }</div>
<div class="line"><a name="l01047"></a><span class="lineno"> 1047</span>&#160;        }</div>
<div class="line"><a name="l01048"></a><span class="lineno"> 1048</span>&#160;      } <span class="comment">// exceptional</span></div>
<div class="line"><a name="l01049"></a><span class="lineno"> 1049</span>&#160;</div>
<div class="line"><a name="l01050"></a><span class="lineno"> 1050</span>&#160;      cumulativeNumPositions += tmpChainSize;</div>
<div class="line"><a name="l01051"></a><span class="lineno"> 1051</span>&#160;      <span class="keywordflow">if</span> (cumulativeNumPositions &gt; 100) <a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#abb2a6a8de19058957f856341fce2440e">setExceptionalCircumstance</a>(<span class="keyword">false</span>);</div>
<div class="line"><a name="l01052"></a><span class="lineno"> 1052</span>&#160;</div>
<div class="line"><a name="l01053"></a><span class="lineno"> 1053</span>&#160;      <span class="keywordflow">if</span> ((<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#a8a0064746ae8dddfece4229b9ad374d6">subDisplayFile</a>()       ) &amp;&amp;</div>
<div class="line"><a name="l01054"></a><span class="lineno"> 1054</span>&#160;          (<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#a1fe5f244fc0316a0ab3e37463f108b96">displayVerbosity</a>() &gt;= 3)) {</div>
<div class="line"><a name="l01055"></a><span class="lineno"> 1055</span>&#160;        *<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#a8a0064746ae8dddfece4229b9ad374d6">subDisplayFile</a>() &lt;&lt; <span class="stringliteral">&quot;In MLSampling&lt;P_V,P_M&gt;::generateUnbLinkedChains_all()&quot;</span></div>
<div class="line"><a name="l01056"></a><span class="lineno"> 1056</span>&#160;                                &lt;&lt; <span class="stringliteral">&quot;, level &quot;</span>               &lt;&lt; <a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#af9416874c856e50f3b35270e801f17e4">m_currLevel</a>+<a class="code" href="_m_l_sampling_level_options_8h.html#a68d15eaf394d210effcf584b938206d3">LEVEL_REF_ID</a></div>
<div class="line"><a name="l01057"></a><span class="lineno"> 1057</span>&#160;                                &lt;&lt; <span class="stringliteral">&quot;, step &quot;</span>                &lt;&lt; <a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a1b1f8ccb4823bdfa26ec652f0807c63e">m_currStep</a></div>
<div class="line"><a name="l01058"></a><span class="lineno"> 1058</span>&#160;                                &lt;&lt; <span class="stringliteral">&quot;, chainId = &quot;</span>           &lt;&lt; chainId</div>
<div class="line"><a name="l01059"></a><span class="lineno"> 1059</span>&#160;                                &lt;&lt; <span class="stringliteral">&quot; &lt; &quot;</span>                    &lt;&lt; chainIdMax</div>
<div class="line"><a name="l01060"></a><span class="lineno"> 1060</span>&#160;                                &lt;&lt; <span class="stringliteral">&quot;: finished generating &quot;</span> &lt;&lt; tmpChain.subSequenceSize()</div>
<div class="line"><a name="l01061"></a><span class="lineno"> 1061</span>&#160;                                &lt;&lt; <span class="stringliteral">&quot; chain positions&quot;</span></div>
<div class="line"><a name="l01062"></a><span class="lineno"> 1062</span>&#160;                                &lt;&lt; std::endl;</div>
<div class="line"><a name="l01063"></a><span class="lineno"> 1063</span>&#160;      }</div>
<div class="line"><a name="l01064"></a><span class="lineno"> 1064</span>&#160;</div>
<div class="line"><a name="l01065"></a><span class="lineno"> 1065</span>&#160;      <span class="comment">// KAUST5: what if workingChain ends up with different size in different nodes? Important</span></div>
<div class="line"><a name="l01066"></a><span class="lineno"> 1066</span>&#160;      workingChain.append              (tmpChain,              1,tmpChain.subSequenceSize()-1              ); <span class="comment">// IMPORTANT: &#39;1&#39; in order to discard initial position</span></div>
<div class="line"><a name="l01067"></a><span class="lineno"> 1067</span>&#160;      <span class="keywordflow">if</span> (currLogLikelihoodValues) {</div>
<div class="line"><a name="l01068"></a><span class="lineno"> 1068</span>&#160;        currLogLikelihoodValues-&gt;<a class="code" href="class_q_u_e_s_o_1_1_scalar_sequence.html#a75cdd556cc417e35a6b9f7aff86896ae">append</a>(tmpLogLikelihoodValues,1,tmpLogLikelihoodValues.subSequenceSize()-1); <span class="comment">// IMPORTANT: &#39;1&#39; in order to discard initial position</span></div>
<div class="line"><a name="l01069"></a><span class="lineno"> 1069</span>&#160;        <span class="keywordflow">if</span> ((<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#a8a0064746ae8dddfece4229b9ad374d6">subDisplayFile</a>()        ) &amp;&amp;</div>
<div class="line"><a name="l01070"></a><span class="lineno"> 1070</span>&#160;            (<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#a1fe5f244fc0316a0ab3e37463f108b96">displayVerbosity</a>() &gt;= 99) &amp;&amp;</div>
<div class="line"><a name="l01071"></a><span class="lineno"> 1071</span>&#160;            (chainId == 0                  )) {</div>
<div class="line"><a name="l01072"></a><span class="lineno"> 1072</span>&#160;          *<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#a8a0064746ae8dddfece4229b9ad374d6">subDisplayFile</a>() &lt;&lt; <span class="stringliteral">&quot;In MLSampling&lt;P_V,P_M&gt;::generateUnbLinkedChains_all()&quot;</span></div>
<div class="line"><a name="l01073"></a><span class="lineno"> 1073</span>&#160;                                  &lt;&lt; <span class="stringliteral">&quot;, level &quot;</span>     &lt;&lt; <a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#af9416874c856e50f3b35270e801f17e4">m_currLevel</a>+<a class="code" href="_m_l_sampling_level_options_8h.html#a68d15eaf394d210effcf584b938206d3">LEVEL_REF_ID</a></div>
<div class="line"><a name="l01074"></a><span class="lineno"> 1074</span>&#160;                                  &lt;&lt; <span class="stringliteral">&quot;, step &quot;</span>      &lt;&lt; <a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a1b1f8ccb4823bdfa26ec652f0807c63e">m_currStep</a></div>
<div class="line"><a name="l01075"></a><span class="lineno"> 1075</span>&#160;                                  &lt;&lt; <span class="stringliteral">&quot;, chainId = &quot;</span> &lt;&lt; chainId</div>
<div class="line"><a name="l01076"></a><span class="lineno"> 1076</span>&#160;                                  &lt;&lt; <span class="stringliteral">&quot;, tmpLogLikelihoodValues.subSequenceSize() = &quot;</span> &lt;&lt; tmpLogLikelihoodValues.subSequenceSize()</div>
<div class="line"><a name="l01077"></a><span class="lineno"> 1077</span>&#160;                                  &lt;&lt; <span class="stringliteral">&quot;, tmpLogLikelihoodValues[0] = &quot;</span>                &lt;&lt; tmpLogLikelihoodValues[0]</div>
<div class="line"><a name="l01078"></a><span class="lineno"> 1078</span>&#160;                                  &lt;&lt; <span class="stringliteral">&quot;, tmpLogLikelihoodValues[1] = &quot;</span>                &lt;&lt; tmpLogLikelihoodValues[1]</div>
<div class="line"><a name="l01079"></a><span class="lineno"> 1079</span>&#160;                                  &lt;&lt; <span class="stringliteral">&quot;, currLogLikelihoodValues[0] = &quot;</span>               &lt;&lt; (*currLogLikelihoodValues)[0]</div>
<div class="line"><a name="l01080"></a><span class="lineno"> 1080</span>&#160;                                  &lt;&lt; std::endl;</div>
<div class="line"><a name="l01081"></a><span class="lineno"> 1081</span>&#160;        }</div>
<div class="line"><a name="l01082"></a><span class="lineno"> 1082</span>&#160;      }</div>
<div class="line"><a name="l01083"></a><span class="lineno"> 1083</span>&#160;      <span class="keywordflow">if</span> (currLogTargetValues) {</div>
<div class="line"><a name="l01084"></a><span class="lineno"> 1084</span>&#160;        currLogTargetValues-&gt;<a class="code" href="class_q_u_e_s_o_1_1_scalar_sequence.html#a75cdd556cc417e35a6b9f7aff86896ae">append</a>    (tmpLogTargetValues,    1,tmpLogTargetValues.subSequenceSize()-1    ); <span class="comment">// IMPORTANT: &#39;1&#39; in order to discard initial position</span></div>
<div class="line"><a name="l01085"></a><span class="lineno"> 1085</span>&#160;      }</div>
<div class="line"><a name="l01086"></a><span class="lineno"> 1086</span>&#160;    }</div>
<div class="line"><a name="l01087"></a><span class="lineno"> 1087</span>&#160;  } <span class="comment">// for &#39;chainId&#39;</span></div>
<div class="line"><a name="l01088"></a><span class="lineno"> 1088</span>&#160;</div>
<div class="line"><a name="l01089"></a><span class="lineno"> 1089</span>&#160;  <span class="keyword">struct </span>timeval timevalBarrier;</div>
<div class="line"><a name="l01090"></a><span class="lineno"> 1090</span>&#160;  iRC = gettimeofday(&amp;timevalBarrier, NULL);</div>
<div class="line"><a name="l01091"></a><span class="lineno"> 1091</span>&#160;  <span class="keywordflow">if</span> (iRC) {}; <span class="comment">// just to remove compiler warning</span></div>
<div class="line"><a name="l01092"></a><span class="lineno"> 1092</span>&#160;  <span class="keywordtype">double</span> loopTime = <a class="code" href="namespace_q_u_e_s_o.html#a424bc33f2e6e287fd468408d14b772ee">MiscGetEllapsedSeconds</a>(&amp;timevalEntering);</div>
<div class="line"><a name="l01093"></a><span class="lineno"> 1093</span>&#160;  <span class="keywordflow">if</span> ((<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#a8a0064746ae8dddfece4229b9ad374d6">subDisplayFile</a>()) &amp;&amp; (<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#a1fe5f244fc0316a0ab3e37463f108b96">displayVerbosity</a>() &gt;= 0)) {</div>
<div class="line"><a name="l01094"></a><span class="lineno"> 1094</span>&#160;    *<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#a8a0064746ae8dddfece4229b9ad374d6">subDisplayFile</a>() &lt;&lt; <span class="stringliteral">&quot;In MLSampling&lt;P_V,P_M&gt;::generateUnbLinkedChains_all()&quot;</span></div>
<div class="line"><a name="l01095"></a><span class="lineno"> 1095</span>&#160;                            &lt;&lt; <span class="stringliteral">&quot;, level &quot;</span> &lt;&lt; <a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#af9416874c856e50f3b35270e801f17e4">m_currLevel</a>+<a class="code" href="_m_l_sampling_level_options_8h.html#a68d15eaf394d210effcf584b938206d3">LEVEL_REF_ID</a></div>
<div class="line"><a name="l01096"></a><span class="lineno"> 1096</span>&#160;                            &lt;&lt; <span class="stringliteral">&quot;, step &quot;</span>  &lt;&lt; <a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a1b1f8ccb4823bdfa26ec652f0807c63e">m_currStep</a></div>
<div class="line"><a name="l01097"></a><span class="lineno"> 1097</span>&#160;                            &lt;&lt; <span class="stringliteral">&quot;: ended chain loop after &quot;</span> &lt;&lt; loopTime &lt;&lt; <span class="stringliteral">&quot; seconds&quot;</span></div>
<div class="line"><a name="l01098"></a><span class="lineno"> 1098</span>&#160;                            &lt;&lt; <span class="stringliteral">&quot;, calling fullComm().Barrier() at &quot;</span> &lt;&lt; ctime(&amp;timevalBarrier.tv_sec)</div>
<div class="line"><a name="l01099"></a><span class="lineno"> 1099</span>&#160;                            &lt;&lt; std::endl;</div>
<div class="line"><a name="l01100"></a><span class="lineno"> 1100</span>&#160;  }</div>
<div class="line"><a name="l01101"></a><span class="lineno"> 1101</span>&#160;</div>
<div class="line"><a name="l01102"></a><span class="lineno"> 1102</span>&#160;  <a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#a0b0779b41ff304058856e97e1d16b4d4">fullComm</a>().<a class="code" href="class_q_u_e_s_o_1_1_mpi_comm.html#a4059971c30e023b272fccaa6aa00c426">Barrier</a>(); <span class="comment">// KAUST4</span></div>
<div class="line"><a name="l01103"></a><span class="lineno"> 1103</span>&#160;</div>
<div class="line"><a name="l01104"></a><span class="lineno"> 1104</span>&#160;  <span class="keyword">struct </span>timeval timevalLeaving;</div>
<div class="line"><a name="l01105"></a><span class="lineno"> 1105</span>&#160;  iRC = gettimeofday(&amp;timevalLeaving, NULL);</div>
<div class="line"><a name="l01106"></a><span class="lineno"> 1106</span>&#160;  <span class="keywordflow">if</span> (iRC) {}; <span class="comment">// just to remove compiler warning</span></div>
<div class="line"><a name="l01107"></a><span class="lineno"> 1107</span>&#160;  <span class="keywordtype">double</span> barrierTime = <a class="code" href="namespace_q_u_e_s_o.html#a424bc33f2e6e287fd468408d14b772ee">MiscGetEllapsedSeconds</a>(&amp;timevalBarrier);</div>
<div class="line"><a name="l01108"></a><span class="lineno"> 1108</span>&#160;  <span class="keywordflow">if</span> ((<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#a8a0064746ae8dddfece4229b9ad374d6">subDisplayFile</a>()) &amp;&amp; (<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#a1fe5f244fc0316a0ab3e37463f108b96">displayVerbosity</a>() &gt;= 0)) {</div>
<div class="line"><a name="l01109"></a><span class="lineno"> 1109</span>&#160;    *<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#a8a0064746ae8dddfece4229b9ad374d6">subDisplayFile</a>() &lt;&lt; <span class="stringliteral">&quot;Leaving MLSampling&lt;P_V,P_M&gt;::generateUnbLinkedChains_all()&quot;</span></div>
<div class="line"><a name="l01110"></a><span class="lineno"> 1110</span>&#160;                            &lt;&lt; <span class="stringliteral">&quot;, level &quot;</span> &lt;&lt; <a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#af9416874c856e50f3b35270e801f17e4">m_currLevel</a>+<a class="code" href="_m_l_sampling_level_options_8h.html#a68d15eaf394d210effcf584b938206d3">LEVEL_REF_ID</a></div>
<div class="line"><a name="l01111"></a><span class="lineno"> 1111</span>&#160;                            &lt;&lt; <span class="stringliteral">&quot;, step &quot;</span>  &lt;&lt; <a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a1b1f8ccb4823bdfa26ec652f0807c63e">m_currStep</a></div>
<div class="line"><a name="l01112"></a><span class="lineno"> 1112</span>&#160;                            &lt;&lt; <span class="stringliteral">&quot;: after &quot;</span> &lt;&lt; barrierTime &lt;&lt; <span class="stringliteral">&quot; seconds in fullComm().Barrier()&quot;</span></div>
<div class="line"><a name="l01113"></a><span class="lineno"> 1113</span>&#160;                            &lt;&lt; <span class="stringliteral">&quot;, at &quot;</span> &lt;&lt; ctime(&amp;timevalLeaving.tv_sec)</div>
<div class="line"><a name="l01114"></a><span class="lineno"> 1114</span>&#160;                            &lt;&lt; std::endl;</div>
<div class="line"><a name="l01115"></a><span class="lineno"> 1115</span>&#160;  }</div>
<div class="line"><a name="l01116"></a><span class="lineno"> 1116</span>&#160;</div>
<div class="line"><a name="l01117"></a><span class="lineno"> 1117</span>&#160;  <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l01118"></a><span class="lineno"> 1118</span>&#160;}</div>
<div class="ttc" id="class_q_u_e_s_o_1_1_m_l_sampling_html_a13f1ca4fe9f94822fe572a743eaced1d"><div class="ttname"><a href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">QUESO::MLSampling::m_env</a></div><div class="ttdeci">const BaseEnvironment &amp; m_env</div><div class="ttdoc">Queso enviroment. </div><div class="ttdef"><b>Definition:</b> <a href="_m_l_sampling_8h_source.html#l00442">MLSampling.h:442</a></div></div>
<div class="ttc" id="_mpi_comm_8h_html_afbf78d291c032aa7f512bc566cee2bd1"><div class="ttname"><a href="_mpi_comm_8h.html#afbf78d291c032aa7f512bc566cee2bd1">RawValue_MPI_SUM</a></div><div class="ttdeci">#define RawValue_MPI_SUM</div><div class="ttdef"><b>Definition:</b> <a href="_mpi_comm_8h_source.html#l00052">MpiComm.h:52</a></div></div>
<div class="ttc" id="class_q_u_e_s_o_1_1_mpi_comm_html_aa780721ae0fdeabc5a15e04cb0cad964"><div class="ttname"><a href="class_q_u_e_s_o_1_1_mpi_comm.html#aa780721ae0fdeabc5a15e04cb0cad964">QUESO::MpiComm::NumProc</a></div><div class="ttdeci">int NumProc() const </div><div class="ttdoc">Returns total number of processes. </div><div class="ttdef"><b>Definition:</b> <a href="_mpi_comm_8_c_source.html#l00121">MpiComm.C:121</a></div></div>
<div class="ttc" id="class_q_u_e_s_o_1_1_m_l_sampling_html_abdd5cd35419283c33cc40a77d0f4f07f"><div class="ttname"><a href="class_q_u_e_s_o_1_1_m_l_sampling.html#abdd5cd35419283c33cc40a77d0f4f07f">QUESO::MLSampling::m_debugExponent</a></div><div class="ttdeci">double m_debugExponent</div><div class="ttdoc">Exponent for debugging. </div><div class="ttdef"><b>Definition:</b> <a href="_m_l_sampling_8h_source.html#l00470">MLSampling.h:470</a></div></div>
<div class="ttc" id="class_q_u_e_s_o_1_1_mpi_comm_html_a4059971c30e023b272fccaa6aa00c426"><div class="ttname"><a href="class_q_u_e_s_o_1_1_mpi_comm.html#a4059971c30e023b272fccaa6aa00c426">QUESO::MpiComm::Barrier</a></div><div class="ttdeci">void Barrier() const </div><div class="ttdoc">Pause every process in *this communicator until all the processes reach this point. </div><div class="ttdef"><b>Definition:</b> <a href="_mpi_comm_8_c_source.html#l00143">MpiComm.C:143</a></div></div>
<div class="ttc" id="class_q_u_e_s_o_1_1_base_environment_html_affe39f53e3d5d678842413370af09145"><div class="ttname"><a href="class_q_u_e_s_o_1_1_base_environment.html#affe39f53e3d5d678842413370af09145">QUESO::BaseEnvironment::subComm</a></div><div class="ttdeci">const MpiComm &amp; subComm() const </div><div class="ttdoc">Access function for MpiComm sub communicator. </div><div class="ttdef"><b>Definition:</b> <a href="_environment_8_c_source.html#l00269">Environment.C:269</a></div></div>
<div class="ttc" id="class_q_u_e_s_o_1_1_base_environment_html_a0b0779b41ff304058856e97e1d16b4d4"><div class="ttname"><a href="class_q_u_e_s_o_1_1_base_environment.html#a0b0779b41ff304058856e97e1d16b4d4">QUESO::BaseEnvironment::fullComm</a></div><div class="ttdeci">const MpiComm &amp; fullComm() const </div><div class="ttdoc">Access function for MpiComm full communicator. </div><div class="ttdef"><b>Definition:</b> <a href="_environment_8_c_source.html#l00247">Environment.C:247</a></div></div>
<div class="ttc" id="class_q_u_e_s_o_1_1_m_l_sampling_html_af8504cc57ec72b3c52833826b2bfff8e"><div class="ttname"><a href="class_q_u_e_s_o_1_1_m_l_sampling.html#af8504cc57ec72b3c52833826b2bfff8e">QUESO::MLSampling::m_options</a></div><div class="ttdeci">MLSamplingOptions m_options</div><div class="ttdoc">Options for the ML algorithm. </div><div class="ttdef"><b>Definition:</b> <a href="_m_l_sampling_8h_source.html#l00461">MLSampling.h:461</a></div></div>
<div class="ttc" id="class_q_u_e_s_o_1_1_scalar_sequence_html_a75cdd556cc417e35a6b9f7aff86896ae"><div class="ttname"><a href="class_q_u_e_s_o_1_1_scalar_sequence.html#a75cdd556cc417e35a6b9f7aff86896ae">QUESO::ScalarSequence::append</a></div><div class="ttdeci">void append(const ScalarSequence&lt; T &gt; &amp;src, unsigned int srcInitialPos, unsigned int srcNumPos)</div><div class="ttdoc">Appends the scalar sequence src to this sequence. </div><div class="ttdef"><b>Definition:</b> <a href="_scalar_sequence_8_c_source.html#l02649">ScalarSequence.C:2649</a></div></div>
<div class="ttc" id="class_q_u_e_s_o_1_1_m_l_sampling_options_html_a1d3d48598e0b59b46337ce66a52671a5"><div class="ttname"><a href="class_q_u_e_s_o_1_1_m_l_sampling_options.html#a1d3d48598e0b59b46337ce66a52671a5">QUESO::MLSamplingOptions::m_prefix</a></div><div class="ttdeci">std::string m_prefix</div><div class="ttdoc">Class prefix. (ml) </div><div class="ttdef"><b>Definition:</b> <a href="_m_l_sampling_options_8h_source.html#l00090">MLSamplingOptions.h:90</a></div></div>
<div class="ttc" id="class_q_u_e_s_o_1_1_m_l_sampling_html_af9416874c856e50f3b35270e801f17e4"><div class="ttname"><a href="class_q_u_e_s_o_1_1_m_l_sampling.html#af9416874c856e50f3b35270e801f17e4">QUESO::MLSampling::m_currLevel</a></div><div class="ttdeci">unsigned int m_currLevel</div><div class="ttdoc">Current level. </div><div class="ttdef"><b>Definition:</b> <a href="_m_l_sampling_8h_source.html#l00464">MLSampling.h:464</a></div></div>
<div class="ttc" id="class_q_u_e_s_o_1_1_base_environment_html_af0bc451b18302cfd5ee747c321e1c6e5"><div class="ttname"><a href="class_q_u_e_s_o_1_1_base_environment.html#af0bc451b18302cfd5ee747c321e1c6e5">QUESO::BaseEnvironment::exceptionalCircumstance</a></div><div class="ttdeci">bool exceptionalCircumstance() const </div><div class="ttdoc">Decides whether there is an exceptional circumstance. </div><div class="ttdef"><b>Definition:</b> <a href="_environment_8_c_source.html#l01178">Environment.C:1178</a></div></div>
<div class="ttc" id="_m_l_sampling_level_options_8h_html_a68d15eaf394d210effcf584b938206d3"><div class="ttname"><a href="_m_l_sampling_level_options_8h.html#a68d15eaf394d210effcf584b938206d3">LEVEL_REF_ID</a></div><div class="ttdeci">#define LEVEL_REF_ID</div><div class="ttdef"><b>Definition:</b> <a href="_m_l_sampling_level_options_8h_source.html#l00028">MLSamplingLevelOptions.h:28</a></div></div>
<div class="ttc" id="class_q_u_e_s_o_1_1_mpi_comm_html_ab806f80f206210723fcb4df8185a55a8"><div class="ttname"><a href="class_q_u_e_s_o_1_1_mpi_comm.html#ab806f80f206210723fcb4df8185a55a8">QUESO::MpiComm::MyPID</a></div><div class="ttdeci">int MyPID() const </div><div class="ttdoc">Return my process ID. </div><div class="ttdef"><b>Definition:</b> <a href="_mpi_comm_8_c_source.html#l00112">MpiComm.C:112</a></div></div>
<div class="ttc" id="_mpi_comm_8h_html_a68f3ac7ff71a6504e236b0c95de78178"><div class="ttname"><a href="_mpi_comm_8h.html#a68f3ac7ff71a6504e236b0c95de78178">RawValue_MPI_MAX</a></div><div class="ttdeci">#define RawValue_MPI_MAX</div><div class="ttdef"><b>Definition:</b> <a href="_mpi_comm_8h_source.html#l00051">MpiComm.h:51</a></div></div>
<div class="ttc" id="class_q_u_e_s_o_1_1_vector_space_html_a92e963bb5cab3eecd290dfe4b8f03b04"><div class="ttname"><a href="class_q_u_e_s_o_1_1_vector_space.html#a92e963bb5cab3eecd290dfe4b8f03b04">QUESO::VectorSpace::zeroVector</a></div><div class="ttdeci">const V &amp; zeroVector() const </div><div class="ttdoc">Returns a vector filled with zeros. </div><div class="ttdef"><b>Definition:</b> <a href="_vector_space_8_c_source.html#l00218">VectorSpace.C:218</a></div></div>
<div class="ttc" id="class_q_u_e_s_o_1_1_mpi_comm_html_abd6af8db8b0c7fd2f5b62e26477a9537"><div class="ttname"><a href="class_q_u_e_s_o_1_1_mpi_comm.html#abd6af8db8b0c7fd2f5b62e26477a9537">QUESO::MpiComm::Bcast</a></div><div class="ttdeci">void Bcast(void *buffer, int count, RawType_MPI_Datatype datatype, int root, const char *whereMsg, const char *whatMsg) const </div><div class="ttdoc">Broadcast values from the root process to the slave processes. </div><div class="ttdef"><b>Definition:</b> <a href="_mpi_comm_8_c_source.html#l00157">MpiComm.C:157</a></div></div>
<div class="ttc" id="class_q_u_e_s_o_1_1_m_l_sampling_html_a7bc4c72f65ba9166ed94a6e198b0915b"><div class="ttname"><a href="class_q_u_e_s_o_1_1_m_l_sampling.html#a7bc4c72f65ba9166ed94a6e198b0915b">QUESO::MLSampling::m_vectorSpace</a></div><div class="ttdeci">const VectorSpace&lt; P_V, P_M &gt; &amp; m_vectorSpace</div><div class="ttdoc">Vector space. </div><div class="ttdef"><b>Definition:</b> <a href="_m_l_sampling_8h_source.html#l00451">MLSampling.h:451</a></div></div>
<div class="ttc" id="namespace_q_u_e_s_o_html_a424bc33f2e6e287fd468408d14b772ee"><div class="ttname"><a href="namespace_q_u_e_s_o.html#a424bc33f2e6e287fd468408d14b772ee">QUESO::MiscGetEllapsedSeconds</a></div><div class="ttdeci">double MiscGetEllapsedSeconds(struct timeval *timeval0)</div><div class="ttdef"><b>Definition:</b> <a href="_miscellaneous_8_c_source.html#l00287">Miscellaneous.C:287</a></div></div>
<div class="ttc" id="class_q_u_e_s_o_1_1_base_environment_html_ae106b5bb8a80b655b88b3a26b1e7c185"><div class="ttname"><a href="class_q_u_e_s_o_1_1_base_environment.html#ae106b5bb8a80b655b88b3a26b1e7c185">QUESO::BaseEnvironment::inter0Rank</a></div><div class="ttdeci">int inter0Rank() const </div><div class="ttdoc">Returns the process inter0 rank. </div><div class="ttdef"><b>Definition:</b> <a href="_environment_8_c_source.html#l00289">Environment.C:289</a></div></div>
<div class="ttc" id="class_q_u_e_s_o_1_1_mpi_comm_html_a72e137e60ef8060efb1ee5fc874fa4b8"><div class="ttname"><a href="class_q_u_e_s_o_1_1_mpi_comm.html#a72e137e60ef8060efb1ee5fc874fa4b8">QUESO::MpiComm::Allreduce</a></div><div class="ttdeci">void Allreduce(void *sendbuf, void *recvbuf, int count, RawType_MPI_Datatype datatype, RawType_MPI_Op op, const char *whereMsg, const char *whatMsg) const </div><div class="ttdoc">Combines values from all processes and distributes the result back to all processes. </div><div class="ttdef"><b>Definition:</b> <a href="_mpi_comm_8_c_source.html#l00131">MpiComm.C:131</a></div></div>
<div class="ttc" id="class_q_u_e_s_o_1_1_base_environment_html_abb2a6a8de19058957f856341fce2440e"><div class="ttname"><a href="class_q_u_e_s_o_1_1_base_environment.html#abb2a6a8de19058957f856341fce2440e">QUESO::BaseEnvironment::setExceptionalCircumstance</a></div><div class="ttdeci">void setExceptionalCircumstance(bool value) const </div><div class="ttdoc">Set an exceptional circumstance. </div><div class="ttdef"><b>Definition:</b> <a href="_environment_8_c_source.html#l01171">Environment.C:1171</a></div></div>
<div class="ttc" id="_mpi_comm_8h_html_a06cbfbc33436f6e0dc8a48ff3c49bdfc"><div class="ttname"><a href="_mpi_comm_8h.html#a06cbfbc33436f6e0dc8a48ff3c49bdfc">RawValue_MPI_UNSIGNED</a></div><div class="ttdeci">#define RawValue_MPI_UNSIGNED</div><div class="ttdef"><b>Definition:</b> <a href="_mpi_comm_8h_source.html#l00049">MpiComm.h:49</a></div></div>
<div class="ttc" id="class_q_u_e_s_o_1_1_m_l_sampling_html_a1b1f8ccb4823bdfa26ec652f0807c63e"><div class="ttname"><a href="class_q_u_e_s_o_1_1_m_l_sampling.html#a1b1f8ccb4823bdfa26ec652f0807c63e">QUESO::MLSampling::m_currStep</a></div><div class="ttdeci">unsigned int m_currStep</div><div class="ttdoc">Curret step. </div><div class="ttdef"><b>Definition:</b> <a href="_m_l_sampling_8h_source.html#l00467">MLSampling.h:467</a></div></div>
<div class="ttc" id="_mpi_comm_8h_html_a8e30f42fdac116861205e83e2aa18042"><div class="ttname"><a href="_mpi_comm_8h.html#a8e30f42fdac116861205e83e2aa18042">RawValue_MPI_MIN</a></div><div class="ttdeci">#define RawValue_MPI_MIN</div><div class="ttdef"><b>Definition:</b> <a href="_mpi_comm_8h_source.html#l00050">MpiComm.h:50</a></div></div>
<div class="ttc" id="class_q_u_e_s_o_1_1_base_environment_html_a1fe5f244fc0316a0ab3e37463f108b96"><div class="ttname"><a href="class_q_u_e_s_o_1_1_base_environment.html#a1fe5f244fc0316a0ab3e37463f108b96">QUESO::BaseEnvironment::displayVerbosity</a></div><div class="ttdeci">unsigned int displayVerbosity() const </div><div class="ttdef"><b>Definition:</b> <a href="_environment_8_c_source.html#l00436">Environment.C:436</a></div></div>
<div class="ttc" id="class_q_u_e_s_o_1_1_base_environment_html_a8a0064746ae8dddfece4229b9ad374d6"><div class="ttname"><a href="class_q_u_e_s_o_1_1_base_environment.html#a8a0064746ae8dddfece4229b9ad374d6">QUESO::BaseEnvironment::subDisplayFile</a></div><div class="ttdeci">std::ofstream * subDisplayFile() const </div><div class="ttdoc">Access function for m_subDisplayFile (displays file on stream). </div><div class="ttdef"><b>Definition:</b> <a href="_environment_8_c_source.html#l00305">Environment.C:305</a></div></div>
<div class="ttc" id="class_q_u_e_s_o_1_1_base_environment_html_a689e4d140c74d495d97eb498714a4b82"><div class="ttname"><a href="class_q_u_e_s_o_1_1_base_environment.html#a689e4d140c74d495d97eb498714a4b82">QUESO::BaseEnvironment::inter0Comm</a></div><div class="ttdeci">const MpiComm &amp; inter0Comm() const </div><div class="ttdoc">Access function for MpiComm inter0-communicator. </div><div class="ttdef"><b>Definition:</b> <a href="_environment_8_c_source.html#l00295">Environment.C:295</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a44ff302d505e5de781ea6635ea0d85d9"></a>
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;class P_V , class P_M &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="class_q_u_e_s_o_1_1_m_l_sampling.html">QUESO::MLSampling</a>&lt; P_V, P_M &gt;::justBalance_proc0 </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="class_q_u_e_s_o_1_1_m_l_sampling_level_options.html">MLSamplingLevelOptions</a> *&#160;</td>
          <td class="paramname"><em>currOptions</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::vector&lt; <a class="el" href="struct_q_u_e_s_o_1_1_exchange_info_struct.html">ExchangeInfoStruct</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>exchangeStdVec</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">currOptions,exchangeStdVec</td><td></td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">exchangeStdVec</td><td></td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="_m_l_sampling_8_c_source.html#l01518">1518</a> of file <a class="el" href="_m_l_sampling_8_c_source.html">MLSampling.C</a>.</p>

<p>References <a class="el" href="_m_l_sampling_level_options_8h_source.html#l00028">LEVEL_REF_ID</a>, <a class="el" href="_m_l_sampling_level_options_8h_source.html#l00169">QUESO::MLSamplingLevelOptions::m_loadBalanceTreshold</a>, <a class="el" href="_miscellaneous_8_c_source.html#l00287">QUESO::MiscGetEllapsedSeconds()</a>, <a class="el" href="_defines_8h_source.html#l00222">UQ_FATAL_TEST_MACRO</a>, and <a class="el" href="_defines_8h_source.html#l00075">QUESO::UQ_OK_RC</a>.</p>
<div class="fragment"><div class="line"><a name="l01521"></a><span class="lineno"> 1521</span>&#160;{</div>
<div class="line"><a name="l01522"></a><span class="lineno"> 1522</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#ae106b5bb8a80b655b88b3a26b1e7c185">inter0Rank</a>() != 0) <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l01523"></a><span class="lineno"> 1523</span>&#160;</div>
<div class="line"><a name="l01524"></a><span class="lineno"> 1524</span>&#160;  <span class="keywordtype">int</span> iRC = <a class="code" href="namespace_q_u_e_s_o.html#a8e909502900aecf24cedba022ea84471">UQ_OK_RC</a>;</div>
<div class="line"><a name="l01525"></a><span class="lineno"> 1525</span>&#160;  <span class="keyword">struct </span>timeval timevalBal;</div>
<div class="line"><a name="l01526"></a><span class="lineno"> 1526</span>&#160;  iRC = gettimeofday(&amp;timevalBal, NULL);</div>
<div class="line"><a name="l01527"></a><span class="lineno"> 1527</span>&#160;  <span class="keywordflow">if</span> (iRC) {}; <span class="comment">// just to remove compiler warning</span></div>
<div class="line"><a name="l01528"></a><span class="lineno"> 1528</span>&#160;</div>
<div class="line"><a name="l01529"></a><span class="lineno"> 1529</span>&#160;  <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> Np = <a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#ac0345f57e31ef7833e379ed972bd094d">numSubEnvironments</a>();</div>
<div class="line"><a name="l01530"></a><span class="lineno"> 1530</span>&#160;  <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> Nc = exchangeStdVec.size();</div>
<div class="line"><a name="l01531"></a><span class="lineno"> 1531</span>&#160;</div>
<div class="line"><a name="l01532"></a><span class="lineno"> 1532</span>&#160;  std::vector&lt;ExchangeInfoStruct&gt; currExchangeStdVec(Nc);</div>
<div class="line"><a name="l01533"></a><span class="lineno"> 1533</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> chainId = 0; chainId &lt; Nc; ++chainId) {</div>
<div class="line"><a name="l01534"></a><span class="lineno"> 1534</span>&#160;    currExchangeStdVec[chainId] = exchangeStdVec[chainId];</div>
<div class="line"><a name="l01535"></a><span class="lineno"> 1535</span>&#160;    currExchangeStdVec[chainId].finalNodeOfInitialPosition = currExchangeStdVec[chainId].originalNodeOfInitialPosition; <span class="comment">// final = original</span></div>
<div class="line"><a name="l01536"></a><span class="lineno"> 1536</span>&#160;  }</div>
<div class="line"><a name="l01537"></a><span class="lineno"> 1537</span>&#160;</div>
<div class="line"><a name="l01539"></a><span class="lineno"> 1539</span>&#160;  <span class="comment">// Compute original ratio of positions per node</span></div>
<div class="line"><a name="l01541"></a><span class="lineno"> 1541</span>&#160;<span class="comment"></span>  <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> iterIdMax = 0;</div>
<div class="line"><a name="l01542"></a><span class="lineno"> 1542</span>&#160;  std::vector&lt;unsigned int&gt; currNumChainsPerNode   (Np,0);</div>
<div class="line"><a name="l01543"></a><span class="lineno"> 1543</span>&#160;  std::vector&lt;unsigned int&gt; currNumPositionsPerNode(Np,0);</div>
<div class="line"><a name="l01544"></a><span class="lineno"> 1544</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> chainId = 0; chainId &lt; Nc; ++chainId) {</div>
<div class="line"><a name="l01545"></a><span class="lineno"> 1545</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> nodeId = currExchangeStdVec[chainId].finalNodeOfInitialPosition; <span class="comment">// Yes, &#39;final&#39;</span></div>
<div class="line"><a name="l01546"></a><span class="lineno"> 1546</span>&#160;    currNumChainsPerNode   [nodeId] += 1;</div>
<div class="line"><a name="l01547"></a><span class="lineno"> 1547</span>&#160;    currNumPositionsPerNode[nodeId] += currExchangeStdVec[chainId].numberOfPositions;</div>
<div class="line"><a name="l01548"></a><span class="lineno"> 1548</span>&#160;    iterIdMax                       += currExchangeStdVec[chainId].numberOfPositions;</div>
<div class="line"><a name="l01549"></a><span class="lineno"> 1549</span>&#160;  }</div>
<div class="line"><a name="l01550"></a><span class="lineno"> 1550</span>&#160;  <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> currMinPosPerNode = *std::min_element(currNumPositionsPerNode.begin(), currNumPositionsPerNode.end());</div>
<div class="line"><a name="l01551"></a><span class="lineno"> 1551</span>&#160;  <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> currMaxPosPerNode = *std::max_element(currNumPositionsPerNode.begin(), currNumPositionsPerNode.end());</div>
<div class="line"><a name="l01552"></a><span class="lineno"> 1552</span>&#160;  <span class="keywordtype">double</span> currRatioOfPosPerNode = ((double) currMaxPosPerNode ) / ((double) currMinPosPerNode);</div>
<div class="line"><a name="l01553"></a><span class="lineno"> 1553</span>&#160;</div>
<div class="line"><a name="l01555"></a><span class="lineno"> 1555</span>&#160;  <span class="comment">// Loop</span></div>
<div class="line"><a name="l01557"></a><span class="lineno"> 1557</span>&#160;<span class="comment"></span>  <span class="comment">//iterIdMax /= 2;</span></div>
<div class="line"><a name="l01558"></a><span class="lineno"> 1558</span>&#160;  <span class="keywordtype">int</span> iterId = -1;</div>
<div class="line"><a name="l01559"></a><span class="lineno"> 1559</span>&#160;  <span class="keywordflow">if</span> ((<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#a8a0064746ae8dddfece4229b9ad374d6">subDisplayFile</a>()) &amp;&amp; (<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#a1fe5f244fc0316a0ab3e37463f108b96">displayVerbosity</a>() &gt;= 0)) {</div>
<div class="line"><a name="l01560"></a><span class="lineno"> 1560</span>&#160;    *<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#a8a0064746ae8dddfece4229b9ad374d6">subDisplayFile</a>() &lt;&lt; <span class="stringliteral">&quot;In MLSampling&lt;P_V,P_M&gt;::justBalance_proc0()&quot;</span></div>
<div class="line"><a name="l01561"></a><span class="lineno"> 1561</span>&#160;                            &lt;&lt; <span class="stringliteral">&quot;, level &quot;</span> &lt;&lt; <a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#af9416874c856e50f3b35270e801f17e4">m_currLevel</a>+<a class="code" href="_m_l_sampling_level_options_8h.html#a68d15eaf394d210effcf584b938206d3">LEVEL_REF_ID</a></div>
<div class="line"><a name="l01562"></a><span class="lineno"> 1562</span>&#160;                            &lt;&lt; <span class="stringliteral">&quot;, step &quot;</span>  &lt;&lt; <a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a1b1f8ccb4823bdfa26ec652f0807c63e">m_currStep</a></div>
<div class="line"><a name="l01563"></a><span class="lineno"> 1563</span>&#160;                            &lt;&lt; <span class="stringliteral">&quot;, iter &quot;</span>  &lt;&lt; iterId</div>
<div class="line"><a name="l01564"></a><span class="lineno"> 1564</span>&#160;                            &lt;&lt; <span class="stringliteral">&quot;, currRatioOfPosPerNode = &quot;</span> &lt;&lt; currRatioOfPosPerNode</div>
<div class="line"><a name="l01565"></a><span class="lineno"> 1565</span>&#160;                            &lt;&lt; std::endl;</div>
<div class="line"><a name="l01566"></a><span class="lineno"> 1566</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> nodeId = 0; nodeId &lt; Np; ++nodeId) {</div>
<div class="line"><a name="l01567"></a><span class="lineno"> 1567</span>&#160;      *<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#a8a0064746ae8dddfece4229b9ad374d6">subDisplayFile</a>() &lt;&lt; <span class="stringliteral">&quot;  KEY In MLSampling&lt;P_V,P_M&gt;::justBalance_proc0()&quot;</span></div>
<div class="line"><a name="l01568"></a><span class="lineno"> 1568</span>&#160;                              &lt;&lt; <span class="stringliteral">&quot;, level &quot;</span> &lt;&lt; <a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#af9416874c856e50f3b35270e801f17e4">m_currLevel</a>+<a class="code" href="_m_l_sampling_level_options_8h.html#a68d15eaf394d210effcf584b938206d3">LEVEL_REF_ID</a></div>
<div class="line"><a name="l01569"></a><span class="lineno"> 1569</span>&#160;                              &lt;&lt; <span class="stringliteral">&quot;, step &quot;</span>  &lt;&lt; <a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a1b1f8ccb4823bdfa26ec652f0807c63e">m_currStep</a></div>
<div class="line"><a name="l01570"></a><span class="lineno"> 1570</span>&#160;                              &lt;&lt; <span class="stringliteral">&quot;, iter &quot;</span>  &lt;&lt; iterId</div>
<div class="line"><a name="l01571"></a><span class="lineno"> 1571</span>&#160;                              &lt;&lt; <span class="stringliteral">&quot;, currNumChainsPerNode[&quot;</span>    &lt;&lt; nodeId &lt;&lt; <span class="stringliteral">&quot;] = &quot;</span> &lt;&lt; currNumChainsPerNode[nodeId]</div>
<div class="line"><a name="l01572"></a><span class="lineno"> 1572</span>&#160;                              &lt;&lt; <span class="stringliteral">&quot;, currNumPositionsPerNode[&quot;</span> &lt;&lt; nodeId &lt;&lt; <span class="stringliteral">&quot;] = &quot;</span> &lt;&lt; currNumPositionsPerNode[nodeId]</div>
<div class="line"><a name="l01573"></a><span class="lineno"> 1573</span>&#160;                              &lt;&lt; std::endl;</div>
<div class="line"><a name="l01574"></a><span class="lineno"> 1574</span>&#160;    }</div>
<div class="line"><a name="l01575"></a><span class="lineno"> 1575</span>&#160;  }</div>
<div class="line"><a name="l01576"></a><span class="lineno"> 1576</span>&#160;</div>
<div class="line"><a name="l01577"></a><span class="lineno"> 1577</span>&#160;  std::vector&lt;std::vector&lt;double&gt; &gt; vectorOfChainSizesPerNode(Np);</div>
<div class="line"><a name="l01578"></a><span class="lineno"> 1578</span>&#160;  <span class="keywordflow">while</span> ((iterId                &lt; (<span class="keywordtype">int</span>) iterIdMax                   ) &amp;&amp;</div>
<div class="line"><a name="l01579"></a><span class="lineno"> 1579</span>&#160;         (currRatioOfPosPerNode &gt; currOptions-&gt;m_loadBalanceTreshold)) {</div>
<div class="line"><a name="l01580"></a><span class="lineno"> 1580</span>&#160;    iterId++;</div>
<div class="line"><a name="l01581"></a><span class="lineno"> 1581</span>&#160;</div>
<div class="line"><a name="l01583"></a><span class="lineno"> 1583</span>&#160;    <span class="comment">// Initialize information</span></div>
<div class="line"><a name="l01585"></a><span class="lineno"> 1585</span>&#160;<span class="comment"></span>    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> nodeId = 0; nodeId &lt; Np; ++nodeId) {</div>
<div class="line"><a name="l01586"></a><span class="lineno"> 1586</span>&#160;      vectorOfChainSizesPerNode[nodeId].clear(); <span class="comment">// make sure vectors have size 0</span></div>
<div class="line"><a name="l01587"></a><span class="lineno"> 1587</span>&#160;    }</div>
<div class="line"><a name="l01588"></a><span class="lineno"> 1588</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> chainId = 0; chainId &lt; Nc; ++chainId) {</div>
<div class="line"><a name="l01589"></a><span class="lineno"> 1589</span>&#160;      <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> nodeId = currExchangeStdVec[chainId].finalNodeOfInitialPosition; <span class="comment">// Yes, &#39;final&#39;</span></div>
<div class="line"><a name="l01590"></a><span class="lineno"> 1590</span>&#160;      vectorOfChainSizesPerNode[nodeId].push_back(currExchangeStdVec[chainId].numberOfPositions);</div>
<div class="line"><a name="l01591"></a><span class="lineno"> 1591</span>&#160;    }</div>
<div class="line"><a name="l01592"></a><span class="lineno"> 1592</span>&#160;    <span class="comment">// FIX ME: swap to save memory</span></div>
<div class="line"><a name="l01593"></a><span class="lineno"> 1593</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> nodeId = 0; nodeId &lt; Np; ++nodeId) {</div>
<div class="line"><a name="l01594"></a><span class="lineno"> 1594</span>&#160;      std::sort(vectorOfChainSizesPerNode[nodeId].begin(), vectorOfChainSizesPerNode[nodeId].end());</div>
<div class="line"><a name="l01595"></a><span class="lineno"> 1595</span>&#160;      <a class="code" href="_defines_8h.html#a56d63d18d0a6d45757de47fcc06f574d">UQ_FATAL_TEST_MACRO</a>(vectorOfChainSizesPerNode[nodeId].size() != currNumChainsPerNode[nodeId],</div>
<div class="line"><a name="l01596"></a><span class="lineno"> 1596</span>&#160;                          <a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#a78b57112bbd0e6dd0e8afec00b40ffa7">worldRank</a>(),</div>
<div class="line"><a name="l01597"></a><span class="lineno"> 1597</span>&#160;                          <span class="stringliteral">&quot;MLSampling&lt;P_V,P_M&gt;::justBalance_proc0()&quot;</span>,</div>
<div class="line"><a name="l01598"></a><span class="lineno"> 1598</span>&#160;                          <span class="stringliteral">&quot;inconsistent number of chains in node&quot;</span>);</div>
<div class="line"><a name="l01599"></a><span class="lineno"> 1599</span>&#160;    }</div>
<div class="line"><a name="l01600"></a><span class="lineno"> 1600</span>&#160;</div>
<div class="line"><a name="l01602"></a><span class="lineno"> 1602</span>&#160;    <span class="comment">// Find [node with most postions], [node with least positions] and [number of positions to move]</span></div>
<div class="line"><a name="l01604"></a><span class="lineno"> 1604</span>&#160;<span class="comment"></span>    <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> currBiggestAmountOfPositionsPerNode  = currNumPositionsPerNode[0];</div>
<div class="line"><a name="l01605"></a><span class="lineno"> 1605</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> currSmallestAmountOfPositionsPerNode = currNumPositionsPerNode[0];</div>
<div class="line"><a name="l01606"></a><span class="lineno"> 1606</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> currNodeWithMostPositions = 0;</div>
<div class="line"><a name="l01607"></a><span class="lineno"> 1607</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> currNodeWithLeastPositions = 0;</div>
<div class="line"><a name="l01608"></a><span class="lineno"> 1608</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> nodeId = 0; nodeId &lt; Np; ++nodeId) {</div>
<div class="line"><a name="l01609"></a><span class="lineno"> 1609</span>&#160;      <span class="keywordflow">if</span> (currNumPositionsPerNode[nodeId] &gt; currBiggestAmountOfPositionsPerNode) {</div>
<div class="line"><a name="l01610"></a><span class="lineno"> 1610</span>&#160;        currBiggestAmountOfPositionsPerNode = currNumPositionsPerNode[nodeId];</div>
<div class="line"><a name="l01611"></a><span class="lineno"> 1611</span>&#160;        currNodeWithMostPositions = nodeId;</div>
<div class="line"><a name="l01612"></a><span class="lineno"> 1612</span>&#160;      }</div>
<div class="line"><a name="l01613"></a><span class="lineno"> 1613</span>&#160;      <span class="keywordflow">if</span> (currNumPositionsPerNode[nodeId] &lt; currSmallestAmountOfPositionsPerNode) {</div>
<div class="line"><a name="l01614"></a><span class="lineno"> 1614</span>&#160;        currSmallestAmountOfPositionsPerNode = currNumPositionsPerNode[nodeId];</div>
<div class="line"><a name="l01615"></a><span class="lineno"> 1615</span>&#160;        currNodeWithLeastPositions = nodeId;</div>
<div class="line"><a name="l01616"></a><span class="lineno"> 1616</span>&#160;      }</div>
<div class="line"><a name="l01617"></a><span class="lineno"> 1617</span>&#160;    }</div>
<div class="line"><a name="l01618"></a><span class="lineno"> 1618</span>&#160;</div>
<div class="line"><a name="l01619"></a><span class="lineno"> 1619</span>&#160;    <a class="code" href="_defines_8h.html#a56d63d18d0a6d45757de47fcc06f574d">UQ_FATAL_TEST_MACRO</a>(currMinPosPerNode != currNumPositionsPerNode[currNodeWithLeastPositions],</div>
<div class="line"><a name="l01620"></a><span class="lineno"> 1620</span>&#160;                        <a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#a78b57112bbd0e6dd0e8afec00b40ffa7">worldRank</a>(),</div>
<div class="line"><a name="l01621"></a><span class="lineno"> 1621</span>&#160;                        <span class="stringliteral">&quot;MLSampling&lt;P_V,P_M&gt;::justBalance_proc0()&quot;</span>,</div>
<div class="line"><a name="l01622"></a><span class="lineno"> 1622</span>&#160;                        <span class="stringliteral">&quot;inconsistent currMinPosPerNode&quot;</span>);</div>
<div class="line"><a name="l01623"></a><span class="lineno"> 1623</span>&#160;</div>
<div class="line"><a name="l01624"></a><span class="lineno"> 1624</span>&#160;    <a class="code" href="_defines_8h.html#a56d63d18d0a6d45757de47fcc06f574d">UQ_FATAL_TEST_MACRO</a>(currMaxPosPerNode != currNumPositionsPerNode[currNodeWithMostPositions],</div>
<div class="line"><a name="l01625"></a><span class="lineno"> 1625</span>&#160;                        <a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#a78b57112bbd0e6dd0e8afec00b40ffa7">worldRank</a>(),</div>
<div class="line"><a name="l01626"></a><span class="lineno"> 1626</span>&#160;                        <span class="stringliteral">&quot;MLSampling&lt;P_V,P_M&gt;::justBalance_proc0()&quot;</span>,</div>
<div class="line"><a name="l01627"></a><span class="lineno"> 1627</span>&#160;                        <span class="stringliteral">&quot;inconsistent currMaxPosPerNode&quot;</span>);</div>
<div class="line"><a name="l01628"></a><span class="lineno"> 1628</span>&#160;</div>
<div class="line"><a name="l01629"></a><span class="lineno"> 1629</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> numberOfPositionsToMove = vectorOfChainSizesPerNode[currNodeWithMostPositions][0];</div>
<div class="line"><a name="l01630"></a><span class="lineno"> 1630</span>&#160;</div>
<div class="line"><a name="l01631"></a><span class="lineno"> 1631</span>&#160;    <span class="keywordflow">if</span> ((<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#a8a0064746ae8dddfece4229b9ad374d6">subDisplayFile</a>()) &amp;&amp; (<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#a1fe5f244fc0316a0ab3e37463f108b96">displayVerbosity</a>() &gt;= 3)) {</div>
<div class="line"><a name="l01632"></a><span class="lineno"> 1632</span>&#160;      *<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#a8a0064746ae8dddfece4229b9ad374d6">subDisplayFile</a>() &lt;&lt; <span class="stringliteral">&quot;In MLSampling&lt;P_V,P_M&gt;::justBalance_proc0()&quot;</span></div>
<div class="line"><a name="l01633"></a><span class="lineno"> 1633</span>&#160;                              &lt;&lt; <span class="stringliteral">&quot;, level &quot;</span> &lt;&lt; <a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#af9416874c856e50f3b35270e801f17e4">m_currLevel</a>+<a class="code" href="_m_l_sampling_level_options_8h.html#a68d15eaf394d210effcf584b938206d3">LEVEL_REF_ID</a></div>
<div class="line"><a name="l01634"></a><span class="lineno"> 1634</span>&#160;                              &lt;&lt; <span class="stringliteral">&quot;, step &quot;</span>  &lt;&lt; <a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a1b1f8ccb4823bdfa26ec652f0807c63e">m_currStep</a></div>
<div class="line"><a name="l01635"></a><span class="lineno"> 1635</span>&#160;                              &lt;&lt; <span class="stringliteral">&quot;, iter &quot;</span>  &lt;&lt; iterId</div>
<div class="line"><a name="l01636"></a><span class="lineno"> 1636</span>&#160;                              &lt;&lt; <span class="stringliteral">&quot;, before update&quot;</span></div>
<div class="line"><a name="l01637"></a><span class="lineno"> 1637</span>&#160;                              &lt;&lt; <span class="stringliteral">&quot;, node w/ most pos is &quot;</span></div>
<div class="line"><a name="l01638"></a><span class="lineno"> 1638</span>&#160;                              &lt;&lt; currNodeWithMostPositions  &lt;&lt; <span class="stringliteral">&quot;(cs=&quot;</span> &lt;&lt; currNumChainsPerNode[currNodeWithMostPositions ] &lt;&lt; <span class="stringliteral">&quot;, ps=&quot;</span> &lt;&lt; currNumPositionsPerNode[currNodeWithMostPositions ] &lt;&lt; <span class="stringliteral">&quot;)&quot;</span></div>
<div class="line"><a name="l01639"></a><span class="lineno"> 1639</span>&#160;                              &lt;&lt; <span class="stringliteral">&quot;, node w/ least pos is &quot;</span></div>
<div class="line"><a name="l01640"></a><span class="lineno"> 1640</span>&#160;                              &lt;&lt; currNodeWithLeastPositions &lt;&lt; <span class="stringliteral">&quot;(cs=&quot;</span> &lt;&lt; currNumChainsPerNode[currNodeWithLeastPositions] &lt;&lt; <span class="stringliteral">&quot;, ps=&quot;</span> &lt;&lt; currNumPositionsPerNode[currNodeWithLeastPositions] &lt;&lt; <span class="stringliteral">&quot;)&quot;</span></div>
<div class="line"><a name="l01641"></a><span class="lineno"> 1641</span>&#160;                              &lt;&lt; <span class="stringliteral">&quot;, number of pos to move = &quot;</span> &lt;&lt; numberOfPositionsToMove</div>
<div class="line"><a name="l01642"></a><span class="lineno"> 1642</span>&#160;                              &lt;&lt; std::endl;</div>
<div class="line"><a name="l01643"></a><span class="lineno"> 1643</span>&#160;    }</div>
<div class="line"><a name="l01644"></a><span class="lineno"> 1644</span>&#160;</div>
<div class="line"><a name="l01646"></a><span class="lineno"> 1646</span>&#160;    <span class="comment">// Update &#39;final&#39; fields in the two nodes</span></div>
<div class="line"><a name="l01648"></a><span class="lineno"> 1648</span>&#160;<span class="comment"></span>    std::vector&lt;ExchangeInfoStruct&gt; newExchangeStdVec(Nc);</div>
<div class="line"><a name="l01649"></a><span class="lineno"> 1649</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> chainId = 0; chainId &lt; Nc; ++chainId) {</div>
<div class="line"><a name="l01650"></a><span class="lineno"> 1650</span>&#160;      newExchangeStdVec[chainId] = currExchangeStdVec[chainId];</div>
<div class="line"><a name="l01651"></a><span class="lineno"> 1651</span>&#160;    }</div>
<div class="line"><a name="l01652"></a><span class="lineno"> 1652</span>&#160;</div>
<div class="line"><a name="l01653"></a><span class="lineno"> 1653</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> chainId = 0; chainId &lt; Nc; ++chainId) {</div>
<div class="line"><a name="l01654"></a><span class="lineno"> 1654</span>&#160;      <span class="keywordflow">if</span> ((newExchangeStdVec[chainId].finalNodeOfInitialPosition == (<span class="keywordtype">int</span>) currNodeWithMostPositions) &amp;&amp;</div>
<div class="line"><a name="l01655"></a><span class="lineno"> 1655</span>&#160;          (newExchangeStdVec[chainId].numberOfPositions          == numberOfPositionsToMove        )) {</div>
<div class="line"><a name="l01656"></a><span class="lineno"> 1656</span>&#160;        newExchangeStdVec[chainId].finalNodeOfInitialPosition = currNodeWithLeastPositions;</div>
<div class="line"><a name="l01657"></a><span class="lineno"> 1657</span>&#160;        <span class="keywordflow">break</span>; <span class="comment">// exit &#39;for&#39;</span></div>
<div class="line"><a name="l01658"></a><span class="lineno"> 1658</span>&#160;      }</div>
<div class="line"><a name="l01659"></a><span class="lineno"> 1659</span>&#160;    }</div>
<div class="line"><a name="l01660"></a><span class="lineno"> 1660</span>&#160;</div>
<div class="line"><a name="l01662"></a><span class="lineno"> 1662</span>&#160;    <span class="comment">// Compute new ratio of positions per node</span></div>
<div class="line"><a name="l01664"></a><span class="lineno"> 1664</span>&#160;<span class="comment"></span>    std::vector&lt;unsigned int&gt; newNumChainsPerNode   (Np,0);</div>
<div class="line"><a name="l01665"></a><span class="lineno"> 1665</span>&#160;    std::vector&lt;unsigned int&gt; newNumPositionsPerNode(Np,0);</div>
<div class="line"><a name="l01666"></a><span class="lineno"> 1666</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> chainId = 0; chainId &lt; Nc; ++chainId) {</div>
<div class="line"><a name="l01667"></a><span class="lineno"> 1667</span>&#160;      <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> nodeId = newExchangeStdVec[chainId].finalNodeOfInitialPosition; <span class="comment">// Yes, &#39;final&#39;</span></div>
<div class="line"><a name="l01668"></a><span class="lineno"> 1668</span>&#160;      newNumChainsPerNode   [nodeId] += 1;</div>
<div class="line"><a name="l01669"></a><span class="lineno"> 1669</span>&#160;      newNumPositionsPerNode[nodeId] += newExchangeStdVec[chainId].numberOfPositions;</div>
<div class="line"><a name="l01670"></a><span class="lineno"> 1670</span>&#160;    }</div>
<div class="line"><a name="l01671"></a><span class="lineno"> 1671</span>&#160;</div>
<div class="line"><a name="l01672"></a><span class="lineno"> 1672</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> newBiggestAmountOfPositionsPerNode  = newNumPositionsPerNode[0];</div>
<div class="line"><a name="l01673"></a><span class="lineno"> 1673</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> newSmallestAmountOfPositionsPerNode = newNumPositionsPerNode[0];</div>
<div class="line"><a name="l01674"></a><span class="lineno"> 1674</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> newNodeWithMostPositions = 0;</div>
<div class="line"><a name="l01675"></a><span class="lineno"> 1675</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> newNodeWithLeastPositions = 0;</div>
<div class="line"><a name="l01676"></a><span class="lineno"> 1676</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> nodeId = 0; nodeId &lt; Np; ++nodeId) {</div>
<div class="line"><a name="l01677"></a><span class="lineno"> 1677</span>&#160;      <span class="keywordflow">if</span> (newNumPositionsPerNode[nodeId] &gt; newBiggestAmountOfPositionsPerNode) {</div>
<div class="line"><a name="l01678"></a><span class="lineno"> 1678</span>&#160;        newBiggestAmountOfPositionsPerNode = newNumPositionsPerNode[nodeId];</div>
<div class="line"><a name="l01679"></a><span class="lineno"> 1679</span>&#160;        newNodeWithMostPositions = nodeId;</div>
<div class="line"><a name="l01680"></a><span class="lineno"> 1680</span>&#160;      }</div>
<div class="line"><a name="l01681"></a><span class="lineno"> 1681</span>&#160;      <span class="keywordflow">if</span> (newNumPositionsPerNode[nodeId] &lt; newSmallestAmountOfPositionsPerNode) {</div>
<div class="line"><a name="l01682"></a><span class="lineno"> 1682</span>&#160;        newSmallestAmountOfPositionsPerNode = newNumPositionsPerNode[nodeId];</div>
<div class="line"><a name="l01683"></a><span class="lineno"> 1683</span>&#160;        newNodeWithLeastPositions = nodeId;</div>
<div class="line"><a name="l01684"></a><span class="lineno"> 1684</span>&#160;      }</div>
<div class="line"><a name="l01685"></a><span class="lineno"> 1685</span>&#160;    }</div>
<div class="line"><a name="l01686"></a><span class="lineno"> 1686</span>&#160;</div>
<div class="line"><a name="l01687"></a><span class="lineno"> 1687</span>&#160;    <span class="keywordflow">if</span> ((<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#a8a0064746ae8dddfece4229b9ad374d6">subDisplayFile</a>()) &amp;&amp; (<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#a1fe5f244fc0316a0ab3e37463f108b96">displayVerbosity</a>() &gt;= 3)) {</div>
<div class="line"><a name="l01688"></a><span class="lineno"> 1688</span>&#160;      *<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#a8a0064746ae8dddfece4229b9ad374d6">subDisplayFile</a>() &lt;&lt; <span class="stringliteral">&quot;In MLSampling&lt;P_V,P_M&gt;::justBalance_proc0()&quot;</span></div>
<div class="line"><a name="l01689"></a><span class="lineno"> 1689</span>&#160;                              &lt;&lt; <span class="stringliteral">&quot;, level &quot;</span> &lt;&lt; <a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#af9416874c856e50f3b35270e801f17e4">m_currLevel</a>+<a class="code" href="_m_l_sampling_level_options_8h.html#a68d15eaf394d210effcf584b938206d3">LEVEL_REF_ID</a></div>
<div class="line"><a name="l01690"></a><span class="lineno"> 1690</span>&#160;                              &lt;&lt; <span class="stringliteral">&quot;, step &quot;</span>  &lt;&lt; <a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a1b1f8ccb4823bdfa26ec652f0807c63e">m_currStep</a></div>
<div class="line"><a name="l01691"></a><span class="lineno"> 1691</span>&#160;                              &lt;&lt; <span class="stringliteral">&quot;, iter &quot;</span>  &lt;&lt; iterId</div>
<div class="line"><a name="l01692"></a><span class="lineno"> 1692</span>&#160;                              &lt;&lt; <span class="stringliteral">&quot;, after update&quot;</span></div>
<div class="line"><a name="l01693"></a><span class="lineno"> 1693</span>&#160;                              &lt;&lt; <span class="stringliteral">&quot;, node w/ most pos is &quot;</span></div>
<div class="line"><a name="l01694"></a><span class="lineno"> 1694</span>&#160;                              &lt;&lt; newNodeWithMostPositions  &lt;&lt; <span class="stringliteral">&quot;(cs=&quot;</span> &lt;&lt; newNumChainsPerNode[newNodeWithMostPositions ] &lt;&lt; <span class="stringliteral">&quot;, ps=&quot;</span> &lt;&lt; newNumPositionsPerNode[newNodeWithMostPositions ] &lt;&lt; <span class="stringliteral">&quot;)&quot;</span></div>
<div class="line"><a name="l01695"></a><span class="lineno"> 1695</span>&#160;                              &lt;&lt; <span class="stringliteral">&quot;, node w/ least pos is &quot;</span></div>
<div class="line"><a name="l01696"></a><span class="lineno"> 1696</span>&#160;                              &lt;&lt; newNodeWithLeastPositions &lt;&lt; <span class="stringliteral">&quot;(cs=&quot;</span> &lt;&lt; newNumChainsPerNode[newNodeWithLeastPositions] &lt;&lt; <span class="stringliteral">&quot;, ps=&quot;</span> &lt;&lt; newNumPositionsPerNode[newNodeWithLeastPositions] &lt;&lt; <span class="stringliteral">&quot;)&quot;</span></div>
<div class="line"><a name="l01697"></a><span class="lineno"> 1697</span>&#160;                              &lt;&lt; std::endl;</div>
<div class="line"><a name="l01698"></a><span class="lineno"> 1698</span>&#160;    }</div>
<div class="line"><a name="l01699"></a><span class="lineno"> 1699</span>&#160;</div>
<div class="line"><a name="l01700"></a><span class="lineno"> 1700</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> newMinPosPerNode = *std::min_element(newNumPositionsPerNode.begin(), newNumPositionsPerNode.end());</div>
<div class="line"><a name="l01701"></a><span class="lineno"> 1701</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> newMaxPosPerNode = *std::max_element(newNumPositionsPerNode.begin(), newNumPositionsPerNode.end());</div>
<div class="line"><a name="l01702"></a><span class="lineno"> 1702</span>&#160;    <span class="keywordtype">double</span> newRatioOfPosPerNode = ((double) newMaxPosPerNode ) / ((double) newMinPosPerNode);</div>
<div class="line"><a name="l01703"></a><span class="lineno"> 1703</span>&#160;</div>
<div class="line"><a name="l01704"></a><span class="lineno"> 1704</span>&#160;    <a class="code" href="_defines_8h.html#a56d63d18d0a6d45757de47fcc06f574d">UQ_FATAL_TEST_MACRO</a>(newMinPosPerNode != newNumPositionsPerNode[newNodeWithLeastPositions],</div>
<div class="line"><a name="l01705"></a><span class="lineno"> 1705</span>&#160;                        <a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#a78b57112bbd0e6dd0e8afec00b40ffa7">worldRank</a>(),</div>
<div class="line"><a name="l01706"></a><span class="lineno"> 1706</span>&#160;                        <span class="stringliteral">&quot;MLSampling&lt;P_V,P_M&gt;::justBalance_proc0()&quot;</span>,</div>
<div class="line"><a name="l01707"></a><span class="lineno"> 1707</span>&#160;                        <span class="stringliteral">&quot;inconsistent newMinPosPerNode&quot;</span>);</div>
<div class="line"><a name="l01708"></a><span class="lineno"> 1708</span>&#160;</div>
<div class="line"><a name="l01709"></a><span class="lineno"> 1709</span>&#160;    <a class="code" href="_defines_8h.html#a56d63d18d0a6d45757de47fcc06f574d">UQ_FATAL_TEST_MACRO</a>(newMaxPosPerNode != newNumPositionsPerNode[newNodeWithMostPositions],</div>
<div class="line"><a name="l01710"></a><span class="lineno"> 1710</span>&#160;                        <a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#a78b57112bbd0e6dd0e8afec00b40ffa7">worldRank</a>(),</div>
<div class="line"><a name="l01711"></a><span class="lineno"> 1711</span>&#160;                        <span class="stringliteral">&quot;MLSampling&lt;P_V,P_M&gt;::justBalance_proc0()&quot;</span>,</div>
<div class="line"><a name="l01712"></a><span class="lineno"> 1712</span>&#160;                        <span class="stringliteral">&quot;inconsistent newMaxPosPerNode&quot;</span>);</div>
<div class="line"><a name="l01713"></a><span class="lineno"> 1713</span>&#160;</div>
<div class="line"><a name="l01714"></a><span class="lineno"> 1714</span>&#160;    <span class="keywordflow">if</span> ((<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#a8a0064746ae8dddfece4229b9ad374d6">subDisplayFile</a>()) &amp;&amp; (<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#a1fe5f244fc0316a0ab3e37463f108b96">displayVerbosity</a>() &gt;= 3)) {</div>
<div class="line"><a name="l01715"></a><span class="lineno"> 1715</span>&#160;      *<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#a8a0064746ae8dddfece4229b9ad374d6">subDisplayFile</a>() &lt;&lt; <span class="stringliteral">&quot;In MLSampling&lt;P_V,P_M&gt;::justBalance_proc0()&quot;</span></div>
<div class="line"><a name="l01716"></a><span class="lineno"> 1716</span>&#160;                              &lt;&lt; <span class="stringliteral">&quot;, level &quot;</span> &lt;&lt; <a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#af9416874c856e50f3b35270e801f17e4">m_currLevel</a>+<a class="code" href="_m_l_sampling_level_options_8h.html#a68d15eaf394d210effcf584b938206d3">LEVEL_REF_ID</a></div>
<div class="line"><a name="l01717"></a><span class="lineno"> 1717</span>&#160;                              &lt;&lt; <span class="stringliteral">&quot;, step &quot;</span>  &lt;&lt; <a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a1b1f8ccb4823bdfa26ec652f0807c63e">m_currStep</a></div>
<div class="line"><a name="l01718"></a><span class="lineno"> 1718</span>&#160;                              &lt;&lt; <span class="stringliteral">&quot;, iter &quot;</span>  &lt;&lt; iterId</div>
<div class="line"><a name="l01719"></a><span class="lineno"> 1719</span>&#160;                              &lt;&lt; <span class="stringliteral">&quot;, newMaxPosPerNode = &quot;</span>     &lt;&lt; newMaxPosPerNode</div>
<div class="line"><a name="l01720"></a><span class="lineno"> 1720</span>&#160;                              &lt;&lt; <span class="stringliteral">&quot;, newMinPosPerNode = &quot;</span>     &lt;&lt; newMinPosPerNode</div>
<div class="line"><a name="l01721"></a><span class="lineno"> 1721</span>&#160;                              &lt;&lt; <span class="stringliteral">&quot;, newRatioOfPosPerNode = &quot;</span> &lt;&lt; newRatioOfPosPerNode</div>
<div class="line"><a name="l01722"></a><span class="lineno"> 1722</span>&#160;                              &lt;&lt; std::endl;</div>
<div class="line"><a name="l01723"></a><span class="lineno"> 1723</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> nodeId = 0; nodeId &lt; Np; ++nodeId) {</div>
<div class="line"><a name="l01724"></a><span class="lineno"> 1724</span>&#160;        *<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#a8a0064746ae8dddfece4229b9ad374d6">subDisplayFile</a>() &lt;&lt; <span class="stringliteral">&quot;  KEY In MLSampling&lt;P_V,P_M&gt;::justBalance_proc0()&quot;</span></div>
<div class="line"><a name="l01725"></a><span class="lineno"> 1725</span>&#160;                                &lt;&lt; <span class="stringliteral">&quot;, level &quot;</span> &lt;&lt; <a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#af9416874c856e50f3b35270e801f17e4">m_currLevel</a>+<a class="code" href="_m_l_sampling_level_options_8h.html#a68d15eaf394d210effcf584b938206d3">LEVEL_REF_ID</a></div>
<div class="line"><a name="l01726"></a><span class="lineno"> 1726</span>&#160;                                &lt;&lt; <span class="stringliteral">&quot;, step &quot;</span>  &lt;&lt; <a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a1b1f8ccb4823bdfa26ec652f0807c63e">m_currStep</a></div>
<div class="line"><a name="l01727"></a><span class="lineno"> 1727</span>&#160;                                &lt;&lt; <span class="stringliteral">&quot;, iter &quot;</span>  &lt;&lt; iterId</div>
<div class="line"><a name="l01728"></a><span class="lineno"> 1728</span>&#160;                                &lt;&lt; <span class="stringliteral">&quot;, newNumChainsPerNode[&quot;</span>    &lt;&lt; nodeId &lt;&lt; <span class="stringliteral">&quot;] = &quot;</span> &lt;&lt; newNumChainsPerNode   [nodeId]</div>
<div class="line"><a name="l01729"></a><span class="lineno"> 1729</span>&#160;                                &lt;&lt; <span class="stringliteral">&quot;, newNumPositionsPerNode[&quot;</span> &lt;&lt; nodeId &lt;&lt; <span class="stringliteral">&quot;] = &quot;</span> &lt;&lt; newNumPositionsPerNode[nodeId]</div>
<div class="line"><a name="l01730"></a><span class="lineno"> 1730</span>&#160;                                &lt;&lt; std::endl;</div>
<div class="line"><a name="l01731"></a><span class="lineno"> 1731</span>&#160;      }</div>
<div class="line"><a name="l01732"></a><span class="lineno"> 1732</span>&#160;    }</div>
<div class="line"><a name="l01733"></a><span class="lineno"> 1733</span>&#160;</div>
<div class="line"><a name="l01735"></a><span class="lineno"> 1735</span>&#160;    <span class="comment">// See if we need to exit &#39;while&#39;</span></div>
<div class="line"><a name="l01737"></a><span class="lineno"> 1737</span>&#160;<span class="comment"></span>    <span class="keywordflow">if</span> (newRatioOfPosPerNode &gt; currRatioOfPosPerNode) {</div>
<div class="line"><a name="l01738"></a><span class="lineno"> 1738</span>&#160;      <span class="keywordflow">break</span>; <span class="comment">// exit &#39;while&#39;</span></div>
<div class="line"><a name="l01739"></a><span class="lineno"> 1739</span>&#160;    }</div>
<div class="line"><a name="l01740"></a><span class="lineno"> 1740</span>&#160;</div>
<div class="line"><a name="l01742"></a><span class="lineno"> 1742</span>&#160;    <span class="comment">// Prepare for next iteration</span></div>
<div class="line"><a name="l01744"></a><span class="lineno"> 1744</span>&#160;<span class="comment"></span>    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> nodeId = 0; nodeId &lt; Np; ++nodeId) {</div>
<div class="line"><a name="l01745"></a><span class="lineno"> 1745</span>&#160;      currNumChainsPerNode   [nodeId] = 0;</div>
<div class="line"><a name="l01746"></a><span class="lineno"> 1746</span>&#160;      currNumPositionsPerNode[nodeId] = 0;</div>
<div class="line"><a name="l01747"></a><span class="lineno"> 1747</span>&#160;    }</div>
<div class="line"><a name="l01748"></a><span class="lineno"> 1748</span>&#160;    currRatioOfPosPerNode = newRatioOfPosPerNode;</div>
<div class="line"><a name="l01749"></a><span class="lineno"> 1749</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> chainId = 0; chainId &lt; Nc; ++chainId) {</div>
<div class="line"><a name="l01750"></a><span class="lineno"> 1750</span>&#160;      currExchangeStdVec[chainId] = newExchangeStdVec[chainId];</div>
<div class="line"><a name="l01751"></a><span class="lineno"> 1751</span>&#160;      <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> nodeId = currExchangeStdVec[chainId].finalNodeOfInitialPosition; <span class="comment">// Yes, &#39;final&#39;</span></div>
<div class="line"><a name="l01752"></a><span class="lineno"> 1752</span>&#160;      currNumChainsPerNode   [nodeId] += 1;</div>
<div class="line"><a name="l01753"></a><span class="lineno"> 1753</span>&#160;      currNumPositionsPerNode[nodeId] += currExchangeStdVec[chainId].numberOfPositions;</div>
<div class="line"><a name="l01754"></a><span class="lineno"> 1754</span>&#160;    }</div>
<div class="line"><a name="l01755"></a><span class="lineno"> 1755</span>&#160;    currMinPosPerNode = *std::min_element(currNumPositionsPerNode.begin(), currNumPositionsPerNode.end());</div>
<div class="line"><a name="l01756"></a><span class="lineno"> 1756</span>&#160;    currMaxPosPerNode = *std::max_element(currNumPositionsPerNode.begin(), currNumPositionsPerNode.end());</div>
<div class="line"><a name="l01757"></a><span class="lineno"> 1757</span>&#160;    currRatioOfPosPerNode = ((double) currMaxPosPerNode ) / ((double) currMinPosPerNode);</div>
<div class="line"><a name="l01758"></a><span class="lineno"> 1758</span>&#160;  }</div>
<div class="line"><a name="l01759"></a><span class="lineno"> 1759</span>&#160;</div>
<div class="line"><a name="l01761"></a><span class="lineno"> 1761</span>&#160;  <span class="comment">// Prepare output information</span></div>
<div class="line"><a name="l01763"></a><span class="lineno"> 1763</span>&#160;<span class="comment"></span>  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> chainId = 0; chainId &lt; Nc; ++chainId) {</div>
<div class="line"><a name="l01764"></a><span class="lineno"> 1764</span>&#160;    exchangeStdVec[chainId].finalNodeOfInitialPosition = currExchangeStdVec[chainId].finalNodeOfInitialPosition; <span class="comment">// Yes, &#39;final&#39; = &#39;final&#39;</span></div>
<div class="line"><a name="l01765"></a><span class="lineno"> 1765</span>&#160;  }</div>
<div class="line"><a name="l01766"></a><span class="lineno"> 1766</span>&#160;</div>
<div class="line"><a name="l01768"></a><span class="lineno"> 1768</span>&#160;  <span class="comment">// Printout solution information</span></div>
<div class="line"><a name="l01770"></a><span class="lineno"> 1770</span>&#160;<span class="comment"></span>  std::vector&lt;unsigned int&gt; finalNumChainsPerNode   (Np,0);</div>
<div class="line"><a name="l01771"></a><span class="lineno"> 1771</span>&#160;  std::vector&lt;unsigned int&gt; finalNumPositionsPerNode(Np,0);</div>
<div class="line"><a name="l01772"></a><span class="lineno"> 1772</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> chainId = 0; chainId &lt; Nc; ++chainId) {</div>
<div class="line"><a name="l01773"></a><span class="lineno"> 1773</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> nodeId = exchangeStdVec[chainId].finalNodeOfInitialPosition; <span class="comment">// Yes, &#39;final&#39;</span></div>
<div class="line"><a name="l01774"></a><span class="lineno"> 1774</span>&#160;    finalNumChainsPerNode   [nodeId] += 1;</div>
<div class="line"><a name="l01775"></a><span class="lineno"> 1775</span>&#160;    finalNumPositionsPerNode[nodeId] += exchangeStdVec[chainId].numberOfPositions;</div>
<div class="line"><a name="l01776"></a><span class="lineno"> 1776</span>&#160;  }</div>
<div class="line"><a name="l01777"></a><span class="lineno"> 1777</span>&#160;  <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> finalMinPosPerNode = *std::min_element(finalNumPositionsPerNode.begin(), finalNumPositionsPerNode.end());</div>
<div class="line"><a name="l01778"></a><span class="lineno"> 1778</span>&#160;  <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> finalMaxPosPerNode = *std::max_element(finalNumPositionsPerNode.begin(), finalNumPositionsPerNode.end());</div>
<div class="line"><a name="l01779"></a><span class="lineno"> 1779</span>&#160;  <span class="keywordtype">double</span> finalRatioOfPosPerNode = ((double) finalMaxPosPerNode ) / ((double) finalMinPosPerNode);</div>
<div class="line"><a name="l01780"></a><span class="lineno"> 1780</span>&#160;</div>
<div class="line"><a name="l01781"></a><span class="lineno"> 1781</span>&#160;  <span class="keywordflow">if</span> ((<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#a8a0064746ae8dddfece4229b9ad374d6">subDisplayFile</a>()) &amp;&amp; (<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#a1fe5f244fc0316a0ab3e37463f108b96">displayVerbosity</a>() &gt;= 0)) {</div>
<div class="line"><a name="l01782"></a><span class="lineno"> 1782</span>&#160;    *<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#a8a0064746ae8dddfece4229b9ad374d6">subDisplayFile</a>() &lt;&lt; <span class="stringliteral">&quot;KEY In MLSampling&lt;P_V,P_M&gt;::justBalance_proc0()&quot;</span></div>
<div class="line"><a name="l01783"></a><span class="lineno"> 1783</span>&#160;                            &lt;&lt; <span class="stringliteral">&quot;, level &quot;</span> &lt;&lt; <a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#af9416874c856e50f3b35270e801f17e4">m_currLevel</a>+<a class="code" href="_m_l_sampling_level_options_8h.html#a68d15eaf394d210effcf584b938206d3">LEVEL_REF_ID</a></div>
<div class="line"><a name="l01784"></a><span class="lineno"> 1784</span>&#160;                            &lt;&lt; <span class="stringliteral">&quot;, step &quot;</span>  &lt;&lt; <a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a1b1f8ccb4823bdfa26ec652f0807c63e">m_currStep</a></div>
<div class="line"><a name="l01785"></a><span class="lineno"> 1785</span>&#160;                            &lt;&lt; <span class="stringliteral">&quot;: solution gives the following redistribution&quot;</span></div>
<div class="line"><a name="l01786"></a><span class="lineno"> 1786</span>&#160;                            &lt;&lt; std::endl;</div>
<div class="line"><a name="l01787"></a><span class="lineno"> 1787</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> nodeId = 0; nodeId &lt; Np; ++nodeId) {</div>
<div class="line"><a name="l01788"></a><span class="lineno"> 1788</span>&#160;      *<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#a8a0064746ae8dddfece4229b9ad374d6">subDisplayFile</a>() &lt;&lt; <span class="stringliteral">&quot;  KEY In MLSampling&lt;P_V,P_M&gt;::justBalance_proc0()&quot;</span></div>
<div class="line"><a name="l01789"></a><span class="lineno"> 1789</span>&#160;                              &lt;&lt; <span class="stringliteral">&quot;, level &quot;</span> &lt;&lt; <a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#af9416874c856e50f3b35270e801f17e4">m_currLevel</a>+<a class="code" href="_m_l_sampling_level_options_8h.html#a68d15eaf394d210effcf584b938206d3">LEVEL_REF_ID</a></div>
<div class="line"><a name="l01790"></a><span class="lineno"> 1790</span>&#160;                              &lt;&lt; <span class="stringliteral">&quot;, step &quot;</span>  &lt;&lt; <a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a1b1f8ccb4823bdfa26ec652f0807c63e">m_currStep</a></div>
<div class="line"><a name="l01791"></a><span class="lineno"> 1791</span>&#160;                              &lt;&lt; <span class="stringliteral">&quot;, finalNumChainsPerNode[&quot;</span>    &lt;&lt; nodeId &lt;&lt; <span class="stringliteral">&quot;] = &quot;</span> &lt;&lt; finalNumChainsPerNode[nodeId]</div>
<div class="line"><a name="l01792"></a><span class="lineno"> 1792</span>&#160;                              &lt;&lt; <span class="stringliteral">&quot;, finalNumPositionsPerNode[&quot;</span> &lt;&lt; nodeId &lt;&lt; <span class="stringliteral">&quot;] = &quot;</span> &lt;&lt; finalNumPositionsPerNode[nodeId]</div>
<div class="line"><a name="l01793"></a><span class="lineno"> 1793</span>&#160;                              &lt;&lt; std::endl;</div>
<div class="line"><a name="l01794"></a><span class="lineno"> 1794</span>&#160;    }</div>
<div class="line"><a name="l01795"></a><span class="lineno"> 1795</span>&#160;    *<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#a8a0064746ae8dddfece4229b9ad374d6">subDisplayFile</a>() &lt;&lt; <span class="stringliteral">&quot;  KEY In MLSampling&lt;P_V,P_M&gt;::justBalance_proc0()&quot;</span></div>
<div class="line"><a name="l01796"></a><span class="lineno"> 1796</span>&#160;                            &lt;&lt; <span class="stringliteral">&quot;, level &quot;</span> &lt;&lt; <a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#af9416874c856e50f3b35270e801f17e4">m_currLevel</a>+<a class="code" href="_m_l_sampling_level_options_8h.html#a68d15eaf394d210effcf584b938206d3">LEVEL_REF_ID</a></div>
<div class="line"><a name="l01797"></a><span class="lineno"> 1797</span>&#160;                            &lt;&lt; <span class="stringliteral">&quot;, step &quot;</span>  &lt;&lt; <a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a1b1f8ccb4823bdfa26ec652f0807c63e">m_currStep</a></div>
<div class="line"><a name="l01798"></a><span class="lineno"> 1798</span>&#160;                            &lt;&lt; <span class="stringliteral">&quot;, finalRatioOfPosPerNode = &quot;</span> &lt;&lt; finalRatioOfPosPerNode</div>
<div class="line"><a name="l01799"></a><span class="lineno"> 1799</span>&#160;                            &lt;&lt; std::endl;</div>
<div class="line"><a name="l01800"></a><span class="lineno"> 1800</span>&#160;  }</div>
<div class="line"><a name="l01801"></a><span class="lineno"> 1801</span>&#160;</div>
<div class="line"><a name="l01803"></a><span class="lineno"> 1803</span>&#160;  <span class="comment">// Measure time</span></div>
<div class="line"><a name="l01805"></a><span class="lineno"> 1805</span>&#160;<span class="comment"></span>  <span class="keywordtype">double</span> balRunTime = <a class="code" href="namespace_q_u_e_s_o.html#a424bc33f2e6e287fd468408d14b772ee">MiscGetEllapsedSeconds</a>(&amp;timevalBal);</div>
<div class="line"><a name="l01806"></a><span class="lineno"> 1806</span>&#160;  <span class="keywordflow">if</span> ((<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#a8a0064746ae8dddfece4229b9ad374d6">subDisplayFile</a>()) &amp;&amp; (<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#a1fe5f244fc0316a0ab3e37463f108b96">displayVerbosity</a>() &gt;= 0)) {</div>
<div class="line"><a name="l01807"></a><span class="lineno"> 1807</span>&#160;    *<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#a8a0064746ae8dddfece4229b9ad374d6">subDisplayFile</a>() &lt;&lt; <span class="stringliteral">&quot;Leaving MLSampling&lt;P_V,P_M&gt;::justBalance_proc0()&quot;</span></div>
<div class="line"><a name="l01808"></a><span class="lineno"> 1808</span>&#160;                            &lt;&lt; <span class="stringliteral">&quot;, level &quot;</span>                   &lt;&lt; <a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#af9416874c856e50f3b35270e801f17e4">m_currLevel</a>+<a class="code" href="_m_l_sampling_level_options_8h.html#a68d15eaf394d210effcf584b938206d3">LEVEL_REF_ID</a></div>
<div class="line"><a name="l01809"></a><span class="lineno"> 1809</span>&#160;                            &lt;&lt; <span class="stringliteral">&quot;, step &quot;</span>                    &lt;&lt; <a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a1b1f8ccb4823bdfa26ec652f0807c63e">m_currStep</a></div>
<div class="line"><a name="l01810"></a><span class="lineno"> 1810</span>&#160;                            &lt;&lt; <span class="stringliteral">&quot;, iterId = &quot;</span>                &lt;&lt; iterId</div>
<div class="line"><a name="l01811"></a><span class="lineno"> 1811</span>&#160;                            &lt;&lt; <span class="stringliteral">&quot;, currRatioOfPosPerNode = &quot;</span> &lt;&lt; currRatioOfPosPerNode</div>
<div class="line"><a name="l01812"></a><span class="lineno"> 1812</span>&#160;                            &lt;&lt; <span class="stringliteral">&quot;, after &quot;</span> &lt;&lt; balRunTime &lt;&lt; <span class="stringliteral">&quot; seconds&quot;</span></div>
<div class="line"><a name="l01813"></a><span class="lineno"> 1813</span>&#160;                            &lt;&lt; std::endl;</div>
<div class="line"><a name="l01814"></a><span class="lineno"> 1814</span>&#160;  }</div>
<div class="line"><a name="l01815"></a><span class="lineno"> 1815</span>&#160;</div>
<div class="line"><a name="l01816"></a><span class="lineno"> 1816</span>&#160;  <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l01817"></a><span class="lineno"> 1817</span>&#160;}</div>
<div class="ttc" id="class_q_u_e_s_o_1_1_m_l_sampling_html_a13f1ca4fe9f94822fe572a743eaced1d"><div class="ttname"><a href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">QUESO::MLSampling::m_env</a></div><div class="ttdeci">const BaseEnvironment &amp; m_env</div><div class="ttdoc">Queso enviroment. </div><div class="ttdef"><b>Definition:</b> <a href="_m_l_sampling_8h_source.html#l00442">MLSampling.h:442</a></div></div>
<div class="ttc" id="class_q_u_e_s_o_1_1_base_environment_html_a78b57112bbd0e6dd0e8afec00b40ffa7"><div class="ttname"><a href="class_q_u_e_s_o_1_1_base_environment.html#a78b57112bbd0e6dd0e8afec00b40ffa7">QUESO::BaseEnvironment::worldRank</a></div><div class="ttdeci">int worldRank() const </div><div class="ttdoc">Returns the process world rank. </div><div class="ttdef"><b>Definition:</b> <a href="_environment_8_c_source.html#l00235">Environment.C:235</a></div></div>
<div class="ttc" id="namespace_q_u_e_s_o_html_a8e909502900aecf24cedba022ea84471"><div class="ttname"><a href="namespace_q_u_e_s_o.html#a8e909502900aecf24cedba022ea84471">QUESO::UQ_OK_RC</a></div><div class="ttdeci">const int UQ_OK_RC</div><div class="ttdef"><b>Definition:</b> <a href="_defines_8h_source.html#l00075">Defines.h:75</a></div></div>
<div class="ttc" id="class_q_u_e_s_o_1_1_m_l_sampling_html_af9416874c856e50f3b35270e801f17e4"><div class="ttname"><a href="class_q_u_e_s_o_1_1_m_l_sampling.html#af9416874c856e50f3b35270e801f17e4">QUESO::MLSampling::m_currLevel</a></div><div class="ttdeci">unsigned int m_currLevel</div><div class="ttdoc">Current level. </div><div class="ttdef"><b>Definition:</b> <a href="_m_l_sampling_8h_source.html#l00464">MLSampling.h:464</a></div></div>
<div class="ttc" id="_m_l_sampling_level_options_8h_html_a68d15eaf394d210effcf584b938206d3"><div class="ttname"><a href="_m_l_sampling_level_options_8h.html#a68d15eaf394d210effcf584b938206d3">LEVEL_REF_ID</a></div><div class="ttdeci">#define LEVEL_REF_ID</div><div class="ttdef"><b>Definition:</b> <a href="_m_l_sampling_level_options_8h_source.html#l00028">MLSamplingLevelOptions.h:28</a></div></div>
<div class="ttc" id="namespace_q_u_e_s_o_html_a424bc33f2e6e287fd468408d14b772ee"><div class="ttname"><a href="namespace_q_u_e_s_o.html#a424bc33f2e6e287fd468408d14b772ee">QUESO::MiscGetEllapsedSeconds</a></div><div class="ttdeci">double MiscGetEllapsedSeconds(struct timeval *timeval0)</div><div class="ttdef"><b>Definition:</b> <a href="_miscellaneous_8_c_source.html#l00287">Miscellaneous.C:287</a></div></div>
<div class="ttc" id="class_q_u_e_s_o_1_1_base_environment_html_ae106b5bb8a80b655b88b3a26b1e7c185"><div class="ttname"><a href="class_q_u_e_s_o_1_1_base_environment.html#ae106b5bb8a80b655b88b3a26b1e7c185">QUESO::BaseEnvironment::inter0Rank</a></div><div class="ttdeci">int inter0Rank() const </div><div class="ttdoc">Returns the process inter0 rank. </div><div class="ttdef"><b>Definition:</b> <a href="_environment_8_c_source.html#l00289">Environment.C:289</a></div></div>
<div class="ttc" id="_defines_8h_html_a56d63d18d0a6d45757de47fcc06f574d"><div class="ttname"><a href="_defines_8h.html#a56d63d18d0a6d45757de47fcc06f574d">UQ_FATAL_TEST_MACRO</a></div><div class="ttdeci">#define UQ_FATAL_TEST_MACRO(test, givenRank, where, what)</div><div class="ttdef"><b>Definition:</b> <a href="_defines_8h_source.html#l00222">Defines.h:222</a></div></div>
<div class="ttc" id="class_q_u_e_s_o_1_1_m_l_sampling_html_a1b1f8ccb4823bdfa26ec652f0807c63e"><div class="ttname"><a href="class_q_u_e_s_o_1_1_m_l_sampling.html#a1b1f8ccb4823bdfa26ec652f0807c63e">QUESO::MLSampling::m_currStep</a></div><div class="ttdeci">unsigned int m_currStep</div><div class="ttdoc">Curret step. </div><div class="ttdef"><b>Definition:</b> <a href="_m_l_sampling_8h_source.html#l00467">MLSampling.h:467</a></div></div>
<div class="ttc" id="class_q_u_e_s_o_1_1_base_environment_html_a1fe5f244fc0316a0ab3e37463f108b96"><div class="ttname"><a href="class_q_u_e_s_o_1_1_base_environment.html#a1fe5f244fc0316a0ab3e37463f108b96">QUESO::BaseEnvironment::displayVerbosity</a></div><div class="ttdeci">unsigned int displayVerbosity() const </div><div class="ttdef"><b>Definition:</b> <a href="_environment_8_c_source.html#l00436">Environment.C:436</a></div></div>
<div class="ttc" id="class_q_u_e_s_o_1_1_base_environment_html_a8a0064746ae8dddfece4229b9ad374d6"><div class="ttname"><a href="class_q_u_e_s_o_1_1_base_environment.html#a8a0064746ae8dddfece4229b9ad374d6">QUESO::BaseEnvironment::subDisplayFile</a></div><div class="ttdeci">std::ofstream * subDisplayFile() const </div><div class="ttdoc">Access function for m_subDisplayFile (displays file on stream). </div><div class="ttdef"><b>Definition:</b> <a href="_environment_8_c_source.html#l00305">Environment.C:305</a></div></div>
<div class="ttc" id="class_q_u_e_s_o_1_1_base_environment_html_ac0345f57e31ef7833e379ed972bd094d"><div class="ttname"><a href="class_q_u_e_s_o_1_1_base_environment.html#ac0345f57e31ef7833e379ed972bd094d">QUESO::BaseEnvironment::numSubEnvironments</a></div><div class="ttdeci">unsigned int numSubEnvironments() const </div><div class="ttdoc">Access function to the number of sub-environments. </div><div class="ttdef"><b>Definition:</b> <a href="_environment_8_c_source.html#l00319">Environment.C:319</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ae870f4b12060ae67d0c4473828b142f1"></a>
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;class P_V , class P_M &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">double <a class="el" href="class_q_u_e_s_o_1_1_m_l_sampling.html">QUESO::MLSampling</a>&lt; P_V, P_M &gt;::logEvidence </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Method to calculate the logarithm of the evidence. </p>
<p>Access to the private member: <code>m_logEvidence</code>. </p>

<p>Definition at line <a class="el" href="_m_l_sampling_8_c_source.html#l04872">4872</a> of file <a class="el" href="_m_l_sampling_8_c_source.html">MLSampling.C</a>.</p>
<div class="fragment"><div class="line"><a name="l04873"></a><span class="lineno"> 4873</span>&#160;{</div>
<div class="line"><a name="l04874"></a><span class="lineno"> 4874</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#afad63c42dccb1518319bf677f2bffde0">m_logEvidence</a>;</div>
<div class="line"><a name="l04875"></a><span class="lineno"> 4875</span>&#160;}</div>
<div class="ttc" id="class_q_u_e_s_o_1_1_m_l_sampling_html_afad63c42dccb1518319bf677f2bffde0"><div class="ttname"><a href="class_q_u_e_s_o_1_1_m_l_sampling.html#afad63c42dccb1518319bf677f2bffde0">QUESO::MLSampling::m_logEvidence</a></div><div class="ttdeci">double m_logEvidence</div><div class="ttdef"><b>Definition:</b> <a href="_m_l_sampling_8h_source.html#l00472">MLSampling.h:472</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ace6bbf605f8b655e0671d20309160941"></a>
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;class P_V , class P_M &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">double <a class="el" href="class_q_u_e_s_o_1_1_m_l_sampling.html">QUESO::MLSampling</a>&lt; P_V, P_M &gt;::meanLogLikelihood </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Method to calculate the mean of the logarithm of the likelihood. </p>
<p>Access to the private member: <code>m_meanLogLikelihood</code>. </p>

<p>Definition at line <a class="el" href="_m_l_sampling_8_c_source.html#l04878">4878</a> of file <a class="el" href="_m_l_sampling_8_c_source.html">MLSampling.C</a>.</p>
<div class="fragment"><div class="line"><a name="l04879"></a><span class="lineno"> 4879</span>&#160;{</div>
<div class="line"><a name="l04880"></a><span class="lineno"> 4880</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#aec4229773274b58e3eaa49a77738389f">m_meanLogLikelihood</a>;</div>
<div class="line"><a name="l04881"></a><span class="lineno"> 4881</span>&#160;}</div>
<div class="ttc" id="class_q_u_e_s_o_1_1_m_l_sampling_html_aec4229773274b58e3eaa49a77738389f"><div class="ttname"><a href="class_q_u_e_s_o_1_1_m_l_sampling.html#aec4229773274b58e3eaa49a77738389f">QUESO::MLSampling::m_meanLogLikelihood</a></div><div class="ttdeci">double m_meanLogLikelihood</div><div class="ttdef"><b>Definition:</b> <a href="_m_l_sampling_8h_source.html#l00473">MLSampling.h:473</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a1bb275df38553b88e2196103c7f5ea46"></a>
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;class P_V , class P_M &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="class_q_u_e_s_o_1_1_m_l_sampling.html">QUESO::MLSampling</a>&lt; P_V, P_M &gt;::mpiExchangePositions_inter0 </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="class_q_u_e_s_o_1_1_sequence_of_vectors.html">SequenceOfVectors</a>&lt; P_V, P_M &gt; &amp;&#160;</td>
          <td class="paramname"><em>prevChain</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::vector&lt; <a class="el" href="struct_q_u_e_s_o_1_1_exchange_info_struct.html">ExchangeInfoStruct</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>exchangeStdVec</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::vector&lt; unsigned int &gt; &amp;&#160;</td>
          <td class="paramname"><em>finalNumChainsPerNode</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::vector&lt; unsigned int &gt; &amp;&#160;</td>
          <td class="paramname"><em>finalNumPositionsPerNode</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct_q_u_e_s_o_1_1_balanced_linked_chains_per_node_struct.html">BalancedLinkedChainsPerNodeStruct</a>&lt; P_V &gt; &amp;&#160;</td>
          <td class="paramname"><em>balancedLinkControl</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">prevChain,exchangeStdVec,finalNumChainsPerNode,finalNumPositionsPerNode</td><td></td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">balancedLinkControl</td><td></td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="_m_l_sampling_8_c_source.html#l01821">1821</a> of file <a class="el" href="_m_l_sampling_8_c_source.html">MLSampling.C</a>.</p>

<p>References <a class="el" href="_m_l_sampling_8h_source.html#l00084">QUESO::BalancedLinkedChainsPerNodeStruct&lt; P_V &gt;::balLinkedChains</a>, <a class="el" href="_sequence_of_vectors_8_c_source.html#l00197">QUESO::SequenceOfVectors&lt; V, M &gt;::getPositionValues()</a>, <a class="el" href="_m_l_sampling_level_options_8h_source.html#l00028">LEVEL_REF_ID</a>, <a class="el" href="_mpi_comm_8h_source.html#l00048">RawValue_MPI_DOUBLE</a>, <a class="el" href="_mpi_comm_8h_source.html#l00044">RawValue_MPI_IN_PLACE</a>, and <a class="el" href="_defines_8h_source.html#l00222">UQ_FATAL_TEST_MACRO</a>.</p>
<div class="fragment"><div class="line"><a name="l01827"></a><span class="lineno"> 1827</span>&#160;{</div>
<div class="line"><a name="l01828"></a><span class="lineno"> 1828</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#ae106b5bb8a80b655b88b3a26b1e7c185">inter0Rank</a>() &lt; 0) <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l01829"></a><span class="lineno"> 1829</span>&#160;</div>
<div class="line"><a name="l01830"></a><span class="lineno"> 1830</span>&#160;  <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> Np = (<span class="keywordtype">unsigned</span> int) <a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#a689e4d140c74d495d97eb498714a4b82">inter0Comm</a>().<a class="code" href="class_q_u_e_s_o_1_1_mpi_comm.html#aa780721ae0fdeabc5a15e04cb0cad964">NumProc</a>();</div>
<div class="line"><a name="l01831"></a><span class="lineno"> 1831</span>&#160;  <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> Nc = exchangeStdVec.size();</div>
<div class="line"><a name="l01832"></a><span class="lineno"> 1832</span>&#160;</div>
<div class="line"><a name="l01833"></a><span class="lineno"> 1833</span>&#160;  <span class="keywordflow">if</span> ((<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#a8a0064746ae8dddfece4229b9ad374d6">subDisplayFile</a>()) &amp;&amp; (<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#a1fe5f244fc0316a0ab3e37463f108b96">displayVerbosity</a>() &gt;= 0)) {</div>
<div class="line"><a name="l01834"></a><span class="lineno"> 1834</span>&#160;    *<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#a8a0064746ae8dddfece4229b9ad374d6">subDisplayFile</a>() &lt;&lt; <span class="stringliteral">&quot;Entering MLSampling&lt;P_V,P_M&gt;::mpiExchangePositions_inter0()&quot;</span></div>
<div class="line"><a name="l01835"></a><span class="lineno"> 1835</span>&#160;                            &lt;&lt; <span class="stringliteral">&quot;, level &quot;</span> &lt;&lt; <a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#af9416874c856e50f3b35270e801f17e4">m_currLevel</a>+<a class="code" href="_m_l_sampling_level_options_8h.html#a68d15eaf394d210effcf584b938206d3">LEVEL_REF_ID</a></div>
<div class="line"><a name="l01836"></a><span class="lineno"> 1836</span>&#160;                            &lt;&lt; <span class="stringliteral">&quot;, step &quot;</span>  &lt;&lt; <a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a1b1f8ccb4823bdfa26ec652f0807c63e">m_currStep</a></div>
<div class="line"><a name="l01837"></a><span class="lineno"> 1837</span>&#160;                            &lt;&lt; <span class="stringliteral">&quot;: Np = &quot;</span> &lt;&lt; Np</div>
<div class="line"><a name="l01838"></a><span class="lineno"> 1838</span>&#160;                            &lt;&lt; <span class="stringliteral">&quot;, Nc = &quot;</span> &lt;&lt; Nc</div>
<div class="line"><a name="l01839"></a><span class="lineno"> 1839</span>&#160;                            &lt;&lt; std::endl;</div>
<div class="line"><a name="l01840"></a><span class="lineno"> 1840</span>&#160;  }</div>
<div class="line"><a name="l01841"></a><span class="lineno"> 1841</span>&#160;</div>
<div class="line"><a name="l01843"></a><span class="lineno"> 1843</span>&#160;  <span class="comment">// Each node performs:</span></div>
<div class="line"><a name="l01844"></a><span class="lineno"> 1844</span>&#160;  <span class="comment">// --&gt; a &#39;gatherv&#39; for collecting all necessary initial positions from other nodes</span></div>
<div class="line"><a name="l01845"></a><span class="lineno"> 1845</span>&#160;  <span class="comment">// --&gt; a &#39;gatherv&#39; for collecting all necessary chain lenghts from other nodes</span></div>
<div class="line"><a name="l01847"></a><span class="lineno"> 1847</span>&#160;<span class="comment"></span>  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> r = 0; r &lt; Np; ++r) {</div>
<div class="line"><a name="l01849"></a><span class="lineno"> 1849</span>&#160;    <span class="comment">// Prepare some counters</span></div>
<div class="line"><a name="l01851"></a><span class="lineno"> 1851</span>&#160;<span class="comment"></span>    <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>              numberOfInitialPositionsNodeRAlreadyHas = 0;</div>
<div class="line"><a name="l01852"></a><span class="lineno"> 1852</span>&#160;    std::vector&lt;unsigned int&gt; numberOfInitialPositionsNodeRHasToReceiveFromNode(Np,0);</div>
<div class="line"><a name="l01853"></a><span class="lineno"> 1853</span>&#160;    std::vector&lt;unsigned int&gt; indexesOfInitialPositionsNodeRHasToReceiveFromMe(0);</div>
<div class="line"><a name="l01854"></a><span class="lineno"> 1854</span>&#160;</div>
<div class="line"><a name="l01855"></a><span class="lineno"> 1855</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>              sumOfChainLenghtsNodeRAlreadyHas = 0;</div>
<div class="line"><a name="l01856"></a><span class="lineno"> 1856</span>&#160;    std::vector&lt;unsigned int&gt; chainLenghtsNodeRHasToInherit(0);</div>
<div class="line"><a name="l01857"></a><span class="lineno"> 1857</span>&#160;</div>
<div class="line"><a name="l01858"></a><span class="lineno"> 1858</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = 0; i &lt; Nc; ++i) {</div>
<div class="line"><a name="l01859"></a><span class="lineno"> 1859</span>&#160;      <span class="keywordflow">if</span> (exchangeStdVec[i].finalNodeOfInitialPosition == (<span class="keywordtype">int</span>) r) {</div>
<div class="line"><a name="l01860"></a><span class="lineno"> 1860</span>&#160;        <span class="keywordflow">if</span> (exchangeStdVec[i].originalNodeOfInitialPosition == (<span class="keywordtype">int</span>) r) {</div>
<div class="line"><a name="l01861"></a><span class="lineno"> 1861</span>&#160;          numberOfInitialPositionsNodeRAlreadyHas++;</div>
<div class="line"><a name="l01862"></a><span class="lineno"> 1862</span>&#160;          sumOfChainLenghtsNodeRAlreadyHas += exchangeStdVec[i].numberOfPositions;</div>
<div class="line"><a name="l01863"></a><span class="lineno"> 1863</span>&#160;        }</div>
<div class="line"><a name="l01864"></a><span class="lineno"> 1864</span>&#160;        <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l01865"></a><span class="lineno"> 1865</span>&#160;          numberOfInitialPositionsNodeRHasToReceiveFromNode[exchangeStdVec[i].originalNodeOfInitialPosition]++;</div>
<div class="line"><a name="l01866"></a><span class="lineno"> 1866</span>&#160;          chainLenghtsNodeRHasToInherit.push_back(exchangeStdVec[i].numberOfPositions);</div>
<div class="line"><a name="l01867"></a><span class="lineno"> 1867</span>&#160;          <span class="keywordflow">if</span> (<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#ae106b5bb8a80b655b88b3a26b1e7c185">inter0Rank</a>() == exchangeStdVec[i].originalNodeOfInitialPosition) {</div>
<div class="line"><a name="l01868"></a><span class="lineno"> 1868</span>&#160;            indexesOfInitialPositionsNodeRHasToReceiveFromMe.push_back(exchangeStdVec[i].originalIndexOfInitialPosition);</div>
<div class="line"><a name="l01869"></a><span class="lineno"> 1869</span>&#160;          }</div>
<div class="line"><a name="l01870"></a><span class="lineno"> 1870</span>&#160;        }</div>
<div class="line"><a name="l01871"></a><span class="lineno"> 1871</span>&#160;      }</div>
<div class="line"><a name="l01872"></a><span class="lineno"> 1872</span>&#160;    }</div>
<div class="line"><a name="l01873"></a><span class="lineno"> 1873</span>&#160;</div>
<div class="line"><a name="l01874"></a><span class="lineno"> 1874</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> totalNumberOfInitialPositionsNodeRHasToReceive = 0;</div>
<div class="line"><a name="l01875"></a><span class="lineno"> 1875</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> nodeId = 0; nodeId &lt; Np; ++nodeId) {</div>
<div class="line"><a name="l01876"></a><span class="lineno"> 1876</span>&#160;      totalNumberOfInitialPositionsNodeRHasToReceive += numberOfInitialPositionsNodeRHasToReceiveFromNode[nodeId];</div>
<div class="line"><a name="l01877"></a><span class="lineno"> 1877</span>&#160;    }</div>
<div class="line"><a name="l01878"></a><span class="lineno"> 1878</span>&#160;</div>
<div class="line"><a name="l01879"></a><span class="lineno"> 1879</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> totalNumberOfChainLenghtsNodeRHasToInherit = chainLenghtsNodeRHasToInherit.size();</div>
<div class="line"><a name="l01880"></a><span class="lineno"> 1880</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> totalSumOfChainLenghtsNodeRHasToInherit = 0;</div>
<div class="line"><a name="l01881"></a><span class="lineno"> 1881</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = 0; i &lt; totalNumberOfChainLenghtsNodeRHasToInherit; ++i) {</div>
<div class="line"><a name="l01882"></a><span class="lineno"> 1882</span>&#160;      totalSumOfChainLenghtsNodeRHasToInherit += chainLenghtsNodeRHasToInherit[i];</div>
<div class="line"><a name="l01883"></a><span class="lineno"> 1883</span>&#160;    }</div>
<div class="line"><a name="l01884"></a><span class="lineno"> 1884</span>&#160;</div>
<div class="line"><a name="l01886"></a><span class="lineno"> 1886</span>&#160;    <span class="comment">// Printout important information</span></div>
<div class="line"><a name="l01888"></a><span class="lineno"> 1888</span>&#160;<span class="comment"></span>    <span class="keywordflow">if</span> ((<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#a8a0064746ae8dddfece4229b9ad374d6">subDisplayFile</a>()) &amp;&amp; (<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#a1fe5f244fc0316a0ab3e37463f108b96">displayVerbosity</a>() &gt;= 0)) {</div>
<div class="line"><a name="l01889"></a><span class="lineno"> 1889</span>&#160;      *<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#a8a0064746ae8dddfece4229b9ad374d6">subDisplayFile</a>() &lt;&lt; <span class="stringliteral">&quot;KEY In MLSampling&lt;P_V,P_M&gt;::mpiExchangePositions_inter0()&quot;</span></div>
<div class="line"><a name="l01890"></a><span class="lineno"> 1890</span>&#160;                              &lt;&lt; <span class="stringliteral">&quot;, level &quot;</span> &lt;&lt; <a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#af9416874c856e50f3b35270e801f17e4">m_currLevel</a>+<a class="code" href="_m_l_sampling_level_options_8h.html#a68d15eaf394d210effcf584b938206d3">LEVEL_REF_ID</a></div>
<div class="line"><a name="l01891"></a><span class="lineno"> 1891</span>&#160;                              &lt;&lt; <span class="stringliteral">&quot;, step &quot;</span>  &lt;&lt; <a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a1b1f8ccb4823bdfa26ec652f0807c63e">m_currStep</a></div>
<div class="line"><a name="l01892"></a><span class="lineno"> 1892</span>&#160;                              &lt;&lt; <span class="stringliteral">&quot;: r = &quot;</span>                                              &lt;&lt; r</div>
<div class="line"><a name="l01893"></a><span class="lineno"> 1893</span>&#160;                              &lt;&lt; <span class="stringliteral">&quot;, finalNumChainsPerNode[r] = &quot;</span>                       &lt;&lt; finalNumChainsPerNode[r]</div>
<div class="line"><a name="l01894"></a><span class="lineno"> 1894</span>&#160;                              &lt;&lt; <span class="stringliteral">&quot;, totalNumberOfInitialPositionsNodeRHasToReceive = &quot;</span> &lt;&lt; totalNumberOfInitialPositionsNodeRHasToReceive</div>
<div class="line"><a name="l01895"></a><span class="lineno"> 1895</span>&#160;                              &lt;&lt; <span class="stringliteral">&quot;, numberOfInitialPositionsNodeRAlreadyHas = &quot;</span>        &lt;&lt; numberOfInitialPositionsNodeRAlreadyHas</div>
<div class="line"><a name="l01896"></a><span class="lineno"> 1896</span>&#160;                              &lt;&lt; std::endl;</div>
<div class="line"><a name="l01897"></a><span class="lineno"> 1897</span>&#160;      *<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#a8a0064746ae8dddfece4229b9ad374d6">subDisplayFile</a>() &lt;&lt; <span class="stringliteral">&quot;KEY In MLSampling&lt;P_V,P_M&gt;::mpiExchangePositions_inter0()&quot;</span></div>
<div class="line"><a name="l01898"></a><span class="lineno"> 1898</span>&#160;                              &lt;&lt; <span class="stringliteral">&quot;, level &quot;</span> &lt;&lt; <a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#af9416874c856e50f3b35270e801f17e4">m_currLevel</a>+<a class="code" href="_m_l_sampling_level_options_8h.html#a68d15eaf394d210effcf584b938206d3">LEVEL_REF_ID</a></div>
<div class="line"><a name="l01899"></a><span class="lineno"> 1899</span>&#160;                              &lt;&lt; <span class="stringliteral">&quot;, step &quot;</span>  &lt;&lt; <a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a1b1f8ccb4823bdfa26ec652f0807c63e">m_currStep</a></div>
<div class="line"><a name="l01900"></a><span class="lineno"> 1900</span>&#160;                              &lt;&lt; <span class="stringliteral">&quot;: r = &quot;</span>                                       &lt;&lt; r</div>
<div class="line"><a name="l01901"></a><span class="lineno"> 1901</span>&#160;                              &lt;&lt; <span class="stringliteral">&quot;, finalNumPositionsPerNode[r] = &quot;</span>             &lt;&lt; finalNumPositionsPerNode[r]</div>
<div class="line"><a name="l01902"></a><span class="lineno"> 1902</span>&#160;                              &lt;&lt; <span class="stringliteral">&quot;, totalSumOfChainLenghtsNodeRHasToInherit = &quot;</span> &lt;&lt; totalSumOfChainLenghtsNodeRHasToInherit</div>
<div class="line"><a name="l01903"></a><span class="lineno"> 1903</span>&#160;                              &lt;&lt; <span class="stringliteral">&quot;, sumOfChainLenghtsNodeRAlreadyHas = &quot;</span>        &lt;&lt; sumOfChainLenghtsNodeRAlreadyHas</div>
<div class="line"><a name="l01904"></a><span class="lineno"> 1904</span>&#160;                              &lt;&lt; std::endl;</div>
<div class="line"><a name="l01905"></a><span class="lineno"> 1905</span>&#160;    }</div>
<div class="line"><a name="l01906"></a><span class="lineno"> 1906</span>&#160;</div>
<div class="line"><a name="l01908"></a><span class="lineno"> 1908</span>&#160;    <span class="comment">// Make sanity checks</span></div>
<div class="line"><a name="l01910"></a><span class="lineno"> 1910</span>&#160;<span class="comment"></span>    <a class="code" href="_defines_8h.html#a56d63d18d0a6d45757de47fcc06f574d">UQ_FATAL_TEST_MACRO</a>(indexesOfInitialPositionsNodeRHasToReceiveFromMe.size() != numberOfInitialPositionsNodeRHasToReceiveFromNode[<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#ae106b5bb8a80b655b88b3a26b1e7c185">inter0Rank</a>()],</div>
<div class="line"><a name="l01911"></a><span class="lineno"> 1911</span>&#160;                        <a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#a78b57112bbd0e6dd0e8afec00b40ffa7">worldRank</a>(),</div>
<div class="line"><a name="l01912"></a><span class="lineno"> 1912</span>&#160;                        <span class="stringliteral">&quot;MLSampling&lt;P_V,P_M&gt;::mpiExchangePositions_inter0()&quot;</span>,</div>
<div class="line"><a name="l01913"></a><span class="lineno"> 1913</span>&#160;                        <span class="stringliteral">&quot;inconsistent number of initial positions to send to node &#39;r&#39;&quot;</span>);</div>
<div class="line"><a name="l01914"></a><span class="lineno"> 1914</span>&#160;</div>
<div class="line"><a name="l01915"></a><span class="lineno"> 1915</span>&#160;    <a class="code" href="_defines_8h.html#a56d63d18d0a6d45757de47fcc06f574d">UQ_FATAL_TEST_MACRO</a>(finalNumChainsPerNode[r] != (totalNumberOfInitialPositionsNodeRHasToReceive + numberOfInitialPositionsNodeRAlreadyHas),</div>
<div class="line"><a name="l01916"></a><span class="lineno"> 1916</span>&#160;                        <a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#a78b57112bbd0e6dd0e8afec00b40ffa7">worldRank</a>(),</div>
<div class="line"><a name="l01917"></a><span class="lineno"> 1917</span>&#160;                        <span class="stringliteral">&quot;MLSampling&lt;P_V,P_M&gt;::mpiExchangePositions_inter0()&quot;</span>,</div>
<div class="line"><a name="l01918"></a><span class="lineno"> 1918</span>&#160;                        <span class="stringliteral">&quot;inconsistent number of chains in node &#39;r&#39;&quot;</span>);</div>
<div class="line"><a name="l01919"></a><span class="lineno"> 1919</span>&#160;</div>
<div class="line"><a name="l01920"></a><span class="lineno"> 1920</span>&#160;    <a class="code" href="_defines_8h.html#a56d63d18d0a6d45757de47fcc06f574d">UQ_FATAL_TEST_MACRO</a>(finalNumPositionsPerNode[r] != (totalSumOfChainLenghtsNodeRHasToInherit + sumOfChainLenghtsNodeRAlreadyHas),</div>
<div class="line"><a name="l01921"></a><span class="lineno"> 1921</span>&#160;                        <a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#a78b57112bbd0e6dd0e8afec00b40ffa7">worldRank</a>(),</div>
<div class="line"><a name="l01922"></a><span class="lineno"> 1922</span>&#160;                        <span class="stringliteral">&quot;MLSampling&lt;P_V,P_M&gt;::mpiExchangePositions_inter0()&quot;</span>,</div>
<div class="line"><a name="l01923"></a><span class="lineno"> 1923</span>&#160;                        <span class="stringliteral">&quot;inconsistent sum of chain lenghts in node &#39;r&#39;&quot;</span>);</div>
<div class="line"><a name="l01924"></a><span class="lineno"> 1924</span>&#160;</div>
<div class="line"><a name="l01925"></a><span class="lineno"> 1925</span>&#160;    <a class="code" href="_defines_8h.html#a56d63d18d0a6d45757de47fcc06f574d">UQ_FATAL_TEST_MACRO</a>(totalNumberOfInitialPositionsNodeRHasToReceive != totalNumberOfChainLenghtsNodeRHasToInherit,</div>
<div class="line"><a name="l01926"></a><span class="lineno"> 1926</span>&#160;                        <a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#a78b57112bbd0e6dd0e8afec00b40ffa7">worldRank</a>(),</div>
<div class="line"><a name="l01927"></a><span class="lineno"> 1927</span>&#160;                        <span class="stringliteral">&quot;MLSampling&lt;P_V,P_M&gt;::mpiExchangePositions_inter0()&quot;</span>,</div>
<div class="line"><a name="l01928"></a><span class="lineno"> 1928</span>&#160;                        <span class="stringliteral">&quot;inconsistent on total number of initial positions to receive in node &#39;r&#39;&quot;</span>);</div>
<div class="line"><a name="l01929"></a><span class="lineno"> 1929</span>&#160;</div>
<div class="line"><a name="l01930"></a><span class="lineno"> 1930</span>&#160;    <span class="comment">// Optimize use of memory (FIX ME: don&#39;t need to use swap here ????)</span></div>
<div class="line"><a name="l01931"></a><span class="lineno"> 1931</span>&#160;    indexesOfInitialPositionsNodeRHasToReceiveFromMe.resize(numberOfInitialPositionsNodeRHasToReceiveFromNode[<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#ae106b5bb8a80b655b88b3a26b1e7c185">inter0Rank</a>()]);</div>
<div class="line"><a name="l01932"></a><span class="lineno"> 1932</span>&#160;    chainLenghtsNodeRHasToInherit.resize                   (totalSumOfChainLenghtsNodeRHasToInherit);</div>
<div class="line"><a name="l01933"></a><span class="lineno"> 1933</span>&#160;</div>
<div class="line"><a name="l01935"></a><span class="lineno"> 1935</span>&#160;    <span class="comment">// Prepare counters and buffers for gatherv of initial positions</span></div>
<div class="line"><a name="l01937"></a><span class="lineno"> 1937</span>&#160;<span class="comment"></span>    <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> dimSize = <a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a7bc4c72f65ba9166ed94a6e198b0915b">m_vectorSpace</a>.<a class="code" href="class_q_u_e_s_o_1_1_vector_space.html#a5829a1f4f996f8307c840b705144d666">dimLocal</a>();</div>
<div class="line"><a name="l01938"></a><span class="lineno"> 1938</span>&#160;    P_V auxInitialPosition(<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a7bc4c72f65ba9166ed94a6e198b0915b">m_vectorSpace</a>.<a class="code" href="class_q_u_e_s_o_1_1_vector_space.html#a92e963bb5cab3eecd290dfe4b8f03b04">zeroVector</a>());</div>
<div class="line"><a name="l01939"></a><span class="lineno"> 1939</span>&#160;    std::vector&lt;double&gt; sendbuf(0);</div>
<div class="line"><a name="l01940"></a><span class="lineno"> 1940</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> sendcnt = 0;</div>
<div class="line"><a name="l01941"></a><span class="lineno"> 1941</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#ae106b5bb8a80b655b88b3a26b1e7c185">inter0Rank</a>() != (int) r) {</div>
<div class="line"><a name="l01942"></a><span class="lineno"> 1942</span>&#160;      sendcnt = numberOfInitialPositionsNodeRHasToReceiveFromNode[<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#ae106b5bb8a80b655b88b3a26b1e7c185">inter0Rank</a>()] * dimSize;</div>
<div class="line"><a name="l01943"></a><span class="lineno"> 1943</span>&#160;      sendbuf.resize(sendcnt);</div>
<div class="line"><a name="l01944"></a><span class="lineno"> 1944</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = 0; i &lt; numberOfInitialPositionsNodeRHasToReceiveFromNode[<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#ae106b5bb8a80b655b88b3a26b1e7c185">inter0Rank</a>()]; ++i) {</div>
<div class="line"><a name="l01945"></a><span class="lineno"> 1945</span>&#160;        <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> auxIndex = indexesOfInitialPositionsNodeRHasToReceiveFromMe[i];</div>
<div class="line"><a name="l01946"></a><span class="lineno"> 1946</span>&#160;        prevChain.getPositionValues(auxIndex,auxInitialPosition);</div>
<div class="line"><a name="l01947"></a><span class="lineno"> 1947</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> j = 0; j &lt; dimSize; ++j) {</div>
<div class="line"><a name="l01948"></a><span class="lineno"> 1948</span>&#160;          sendbuf[i*dimSize + j] = auxInitialPosition[j];</div>
<div class="line"><a name="l01949"></a><span class="lineno"> 1949</span>&#160;        }</div>
<div class="line"><a name="l01950"></a><span class="lineno"> 1950</span>&#160;      }</div>
<div class="line"><a name="l01951"></a><span class="lineno"> 1951</span>&#160;    }</div>
<div class="line"><a name="l01952"></a><span class="lineno"> 1952</span>&#160;</div>
<div class="line"><a name="l01953"></a><span class="lineno"> 1953</span>&#160;    std::vector&lt;double&gt; recvbuf(0);</div>
<div class="line"><a name="l01954"></a><span class="lineno"> 1954</span>&#160;    std::vector&lt;int&gt; recvcnts(Np,0); <span class="comment">// &#39;0&#39; is already the correct value for recvcnts[r]</span></div>
<div class="line"><a name="l01955"></a><span class="lineno"> 1955</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#ae106b5bb8a80b655b88b3a26b1e7c185">inter0Rank</a>() == (int) r) {</div>
<div class="line"><a name="l01956"></a><span class="lineno"> 1956</span>&#160;      recvbuf.resize(totalNumberOfInitialPositionsNodeRHasToReceive * dimSize);</div>
<div class="line"><a name="l01957"></a><span class="lineno"> 1957</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> nodeId = 0; nodeId &lt; Np; ++nodeId) { <span class="comment">// Yes, from &#39;0&#39; on (for &#39;r&#39;, numberOf...ToReceiveFromNode[r] = 0 anyway)</span></div>
<div class="line"><a name="l01958"></a><span class="lineno"> 1958</span>&#160;        recvcnts[nodeId] = numberOfInitialPositionsNodeRHasToReceiveFromNode[nodeId<span class="comment">/*m_env.inter0Rank()*/</span>] * dimSize;</div>
<div class="line"><a name="l01959"></a><span class="lineno"> 1959</span>&#160;      }</div>
<div class="line"><a name="l01960"></a><span class="lineno"> 1960</span>&#160;    }</div>
<div class="line"><a name="l01961"></a><span class="lineno"> 1961</span>&#160;</div>
<div class="line"><a name="l01962"></a><span class="lineno"> 1962</span>&#160;    std::vector&lt;int&gt; displs(Np,0);</div>
<div class="line"><a name="l01963"></a><span class="lineno"> 1963</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> nodeId = 1; nodeId &lt; Np; ++nodeId) { <span class="comment">// Yes, from &#39;1&#39; on</span></div>
<div class="line"><a name="l01964"></a><span class="lineno"> 1964</span>&#160;      displs[nodeId] = displs[nodeId-1] + recvcnts[nodeId-1];</div>
<div class="line"><a name="l01965"></a><span class="lineno"> 1965</span>&#160;    }</div>
<div class="line"><a name="l01966"></a><span class="lineno"> 1966</span>&#160;</div>
<div class="line"><a name="l01967"></a><span class="lineno"> 1967</span>&#160;<span class="preprocessor">#if 0</span></div>
<div class="line"><a name="l01968"></a><span class="lineno"> 1968</span>&#160;<span class="preprocessor"></span>    <span class="keywordflow">if</span> (<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#ae106b5bb8a80b655b88b3a26b1e7c185">inter0Rank</a>() == r) {</div>
<div class="line"><a name="l01969"></a><span class="lineno"> 1969</span>&#160;      <a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#a689e4d140c74d495d97eb498714a4b82">inter0Comm</a>().<a class="code" href="class_q_u_e_s_o_1_1_mpi_comm.html#a9313449240c1bb2289870309a5c711ed">Gatherv</a>(<a class="code" href="_mpi_comm_8h.html#a578a93c04b9dab934e3a90f0beed4edf">RawValue_MPI_IN_PLACE</a>, (<span class="keywordtype">int</span>) sendcnt, <a class="code" href="_mpi_comm_8h.html#ad0f503bd9fecfe4e570ca3d15aaf2518">RawValue_MPI_DOUBLE</a>, (<span class="keywordtype">void</span> *) &amp;recvbuf[0], (<span class="keywordtype">int</span> *) &amp;recvcnts[0], (<span class="keywordtype">int</span> *) &amp;displs[0], <a class="code" href="_mpi_comm_8h.html#ad0f503bd9fecfe4e570ca3d15aaf2518">RawValue_MPI_DOUBLE</a>, r, <span class="comment">// LOAD BALANCE</span></div>
<div class="line"><a name="l01970"></a><span class="lineno"> 1970</span>&#160;                                 <span class="stringliteral">&quot;MLSampling&lt;P_V,P_M&gt;::mpiExchangePositions_inter0(1)&quot;</span>,</div>
<div class="line"><a name="l01971"></a><span class="lineno"> 1971</span>&#160;                                 <span class="stringliteral">&quot;failed MPI.Gatherv()&quot;</span>);</div>
<div class="line"><a name="l01972"></a><span class="lineno"> 1972</span>&#160;    }</div>
<div class="line"><a name="l01973"></a><span class="lineno"> 1973</span>&#160;    <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l01974"></a><span class="lineno"> 1974</span>&#160;      <a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#a689e4d140c74d495d97eb498714a4b82">inter0Comm</a>().<a class="code" href="class_q_u_e_s_o_1_1_mpi_comm.html#a9313449240c1bb2289870309a5c711ed">Gatherv</a>((<span class="keywordtype">void</span> *) &amp;sendbuf[0], (<span class="keywordtype">int</span>) sendcnt, <a class="code" href="_mpi_comm_8h.html#ad0f503bd9fecfe4e570ca3d15aaf2518">RawValue_MPI_DOUBLE</a>, (<span class="keywordtype">void</span> *) &amp;recvbuf[0], (<span class="keywordtype">int</span> *) &amp;recvcnts[0], (<span class="keywordtype">int</span> *) &amp;displs[0], <a class="code" href="_mpi_comm_8h.html#ad0f503bd9fecfe4e570ca3d15aaf2518">RawValue_MPI_DOUBLE</a>, r, <span class="comment">// LOAD BALANCE</span></div>
<div class="line"><a name="l01975"></a><span class="lineno"> 1975</span>&#160;                                 <span class="stringliteral">&quot;MLSampling&lt;P_V,P_M&gt;::mpiExchangePositions_inter0(2)&quot;</span>,</div>
<div class="line"><a name="l01976"></a><span class="lineno"> 1976</span>&#160;                                 <span class="stringliteral">&quot;failed MPI.Gatherv()&quot;</span>);</div>
<div class="line"><a name="l01977"></a><span class="lineno"> 1977</span>&#160;    }</div>
<div class="line"><a name="l01978"></a><span class="lineno"> 1978</span>&#160;<span class="preprocessor">#else</span></div>
<div class="line"><a name="l01979"></a><span class="lineno"> 1979</span>&#160;<span class="preprocessor"></span>    <a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#a689e4d140c74d495d97eb498714a4b82">inter0Comm</a>().<a class="code" href="class_q_u_e_s_o_1_1_mpi_comm.html#a9313449240c1bb2289870309a5c711ed">Gatherv</a>((<span class="keywordtype">void</span> *) &amp;sendbuf[0], (<span class="keywordtype">int</span>) sendcnt, <a class="code" href="_mpi_comm_8h.html#ad0f503bd9fecfe4e570ca3d15aaf2518">RawValue_MPI_DOUBLE</a>, (<span class="keywordtype">void</span> *) &amp;recvbuf[0], (<span class="keywordtype">int</span> *) &amp;recvcnts[0], (<span class="keywordtype">int</span> *) &amp;displs[0], <a class="code" href="_mpi_comm_8h.html#ad0f503bd9fecfe4e570ca3d15aaf2518">RawValue_MPI_DOUBLE</a>, r, <span class="comment">// LOAD BALANCE</span></div>
<div class="line"><a name="l01980"></a><span class="lineno"> 1980</span>&#160;                               <span class="stringliteral">&quot;MLSampling&lt;P_V,P_M&gt;::mpiExchangePositions_inter0()&quot;</span>,</div>
<div class="line"><a name="l01981"></a><span class="lineno"> 1981</span>&#160;                               <span class="stringliteral">&quot;failed MPI.Gatherv()&quot;</span>);</div>
<div class="line"><a name="l01982"></a><span class="lineno"> 1982</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01983"></a><span class="lineno"> 1983</span>&#160;<span class="preprocessor"></span></div>
<div class="line"><a name="l01985"></a><span class="lineno"> 1985</span>&#160;    <span class="comment">// Make sanity checks</span></div>
<div class="line"><a name="l01987"></a><span class="lineno"> 1987</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l01989"></a><span class="lineno"> 1989</span>&#160;    <span class="comment">// Transfer data from &#39;recvbuf&#39; to &#39;balancedLinkControl&#39;</span></div>
<div class="line"><a name="l01990"></a><span class="lineno"> 1990</span>&#160;    <span class="comment">// Remember that finalNumChainsPerNode[r] = (totalNumberOfInitialPositionsNodeRHasToReceive + numberOfInitialPositionsNodeRAlreadyHas)</span></div>
<div class="line"><a name="l01991"></a><span class="lineno"> 1991</span>&#160;    <span class="comment">// Remember that totalNumberOfInitialPositionsNodeRHasToReceive = totalNumberOfChainLenghtsNodeRHasToInherit</span></div>
<div class="line"><a name="l01993"></a><span class="lineno"> 1993</span>&#160;<span class="comment"></span>    <span class="keywordflow">if</span> (<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#ae106b5bb8a80b655b88b3a26b1e7c185">inter0Rank</a>() == (int) r) {</div>
<div class="line"><a name="l01994"></a><span class="lineno"> 1994</span>&#160;      balancedLinkControl.balLinkedChains.resize(finalNumChainsPerNode[r]);</div>
<div class="line"><a name="l01995"></a><span class="lineno"> 1995</span>&#160;      <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> auxIndex = 0;</div>
<div class="line"><a name="l01996"></a><span class="lineno"> 1996</span>&#160;</div>
<div class="line"><a name="l01997"></a><span class="lineno"> 1997</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = 0; i &lt; Nc; ++i) {</div>
<div class="line"><a name="l01998"></a><span class="lineno"> 1998</span>&#160;        <span class="keywordflow">if</span> ((exchangeStdVec[i].finalNodeOfInitialPosition    == (<span class="keywordtype">int</span>) r) &amp;&amp;</div>
<div class="line"><a name="l01999"></a><span class="lineno"> 1999</span>&#160;            (exchangeStdVec[i].originalNodeOfInitialPosition == (<span class="keywordtype">int</span>) r)) {</div>
<div class="line"><a name="l02000"></a><span class="lineno"> 2000</span>&#160;          prevChain.getPositionValues(exchangeStdVec[i].originalIndexOfInitialPosition,auxInitialPosition);</div>
<div class="line"><a name="l02001"></a><span class="lineno"> 2001</span>&#160;          balancedLinkControl.balLinkedChains[auxIndex].initialPosition = <span class="keyword">new</span> P_V(auxInitialPosition);</div>
<div class="line"><a name="l02002"></a><span class="lineno"> 2002</span>&#160;          balancedLinkControl.balLinkedChains[auxIndex].numberOfPositions = exchangeStdVec[i].numberOfPositions;</div>
<div class="line"><a name="l02003"></a><span class="lineno"> 2003</span>&#160;          auxIndex++;</div>
<div class="line"><a name="l02004"></a><span class="lineno"> 2004</span>&#160;  }</div>
<div class="line"><a name="l02005"></a><span class="lineno"> 2005</span>&#160;      }</div>
<div class="line"><a name="l02006"></a><span class="lineno"> 2006</span>&#160;</div>
<div class="line"><a name="l02007"></a><span class="lineno"> 2007</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = 0; i &lt; totalNumberOfInitialPositionsNodeRHasToReceive; ++i) {</div>
<div class="line"><a name="l02008"></a><span class="lineno"> 2008</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> j = 0; j &lt; dimSize; ++j) {</div>
<div class="line"><a name="l02009"></a><span class="lineno"> 2009</span>&#160;          auxInitialPosition[j] = recvbuf[i*dimSize + j];</div>
<div class="line"><a name="l02010"></a><span class="lineno"> 2010</span>&#160;        }</div>
<div class="line"><a name="l02011"></a><span class="lineno"> 2011</span>&#160;        balancedLinkControl.balLinkedChains[auxIndex].initialPosition = <span class="keyword">new</span> P_V(auxInitialPosition);</div>
<div class="line"><a name="l02012"></a><span class="lineno"> 2012</span>&#160;        balancedLinkControl.balLinkedChains[auxIndex].numberOfPositions = chainLenghtsNodeRHasToInherit[i]; <span class="comment">// aqui 3</span></div>
<div class="line"><a name="l02013"></a><span class="lineno"> 2013</span>&#160;        auxIndex++;</div>
<div class="line"><a name="l02014"></a><span class="lineno"> 2014</span>&#160;      }</div>
<div class="line"><a name="l02015"></a><span class="lineno"> 2015</span>&#160;    }</div>
<div class="line"><a name="l02016"></a><span class="lineno"> 2016</span>&#160;</div>
<div class="line"><a name="l02017"></a><span class="lineno"> 2017</span>&#160;    <a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#a689e4d140c74d495d97eb498714a4b82">inter0Comm</a>().<a class="code" href="class_q_u_e_s_o_1_1_mpi_comm.html#a4059971c30e023b272fccaa6aa00c426">Barrier</a>();</div>
<div class="line"><a name="l02018"></a><span class="lineno"> 2018</span>&#160;  } <span class="comment">// for &#39;r&#39;</span></div>
<div class="line"><a name="l02019"></a><span class="lineno"> 2019</span>&#160;</div>
<div class="line"><a name="l02020"></a><span class="lineno"> 2020</span>&#160;  <span class="keywordflow">if</span> ((<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#a8a0064746ae8dddfece4229b9ad374d6">subDisplayFile</a>()) &amp;&amp; (<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#a1fe5f244fc0316a0ab3e37463f108b96">displayVerbosity</a>() &gt;= 0)) {</div>
<div class="line"><a name="l02021"></a><span class="lineno"> 2021</span>&#160;    *<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#a8a0064746ae8dddfece4229b9ad374d6">subDisplayFile</a>() &lt;&lt; <span class="stringliteral">&quot;Leaving MLSampling&lt;P_V,P_M&gt;::mpiExchangePositions_inter0()&quot;</span></div>
<div class="line"><a name="l02022"></a><span class="lineno"> 2022</span>&#160;                            &lt;&lt; <span class="stringliteral">&quot;, level &quot;</span> &lt;&lt; <a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#af9416874c856e50f3b35270e801f17e4">m_currLevel</a>+<a class="code" href="_m_l_sampling_level_options_8h.html#a68d15eaf394d210effcf584b938206d3">LEVEL_REF_ID</a></div>
<div class="line"><a name="l02023"></a><span class="lineno"> 2023</span>&#160;                            &lt;&lt; <span class="stringliteral">&quot;, step &quot;</span>  &lt;&lt; <a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a1b1f8ccb4823bdfa26ec652f0807c63e">m_currStep</a></div>
<div class="line"><a name="l02024"></a><span class="lineno"> 2024</span>&#160;                            &lt;&lt; std::endl;</div>
<div class="line"><a name="l02025"></a><span class="lineno"> 2025</span>&#160;  }</div>
<div class="line"><a name="l02026"></a><span class="lineno"> 2026</span>&#160;</div>
<div class="line"><a name="l02027"></a><span class="lineno"> 2027</span>&#160;  <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l02028"></a><span class="lineno"> 2028</span>&#160;}</div>
<div class="ttc" id="class_q_u_e_s_o_1_1_m_l_sampling_html_a13f1ca4fe9f94822fe572a743eaced1d"><div class="ttname"><a href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">QUESO::MLSampling::m_env</a></div><div class="ttdeci">const BaseEnvironment &amp; m_env</div><div class="ttdoc">Queso enviroment. </div><div class="ttdef"><b>Definition:</b> <a href="_m_l_sampling_8h_source.html#l00442">MLSampling.h:442</a></div></div>
<div class="ttc" id="class_q_u_e_s_o_1_1_vector_space_html_a5829a1f4f996f8307c840b705144d666"><div class="ttname"><a href="class_q_u_e_s_o_1_1_vector_space.html#a5829a1f4f996f8307c840b705144d666">QUESO::VectorSpace::dimLocal</a></div><div class="ttdeci">unsigned int dimLocal() const </div><div class="ttdef"><b>Definition:</b> <a href="_vector_space_8_c_source.html#l00199">VectorSpace.C:199</a></div></div>
<div class="ttc" id="class_q_u_e_s_o_1_1_mpi_comm_html_aa780721ae0fdeabc5a15e04cb0cad964"><div class="ttname"><a href="class_q_u_e_s_o_1_1_mpi_comm.html#aa780721ae0fdeabc5a15e04cb0cad964">QUESO::MpiComm::NumProc</a></div><div class="ttdeci">int NumProc() const </div><div class="ttdoc">Returns total number of processes. </div><div class="ttdef"><b>Definition:</b> <a href="_mpi_comm_8_c_source.html#l00121">MpiComm.C:121</a></div></div>
<div class="ttc" id="class_q_u_e_s_o_1_1_base_environment_html_a78b57112bbd0e6dd0e8afec00b40ffa7"><div class="ttname"><a href="class_q_u_e_s_o_1_1_base_environment.html#a78b57112bbd0e6dd0e8afec00b40ffa7">QUESO::BaseEnvironment::worldRank</a></div><div class="ttdeci">int worldRank() const </div><div class="ttdoc">Returns the process world rank. </div><div class="ttdef"><b>Definition:</b> <a href="_environment_8_c_source.html#l00235">Environment.C:235</a></div></div>
<div class="ttc" id="class_q_u_e_s_o_1_1_mpi_comm_html_a4059971c30e023b272fccaa6aa00c426"><div class="ttname"><a href="class_q_u_e_s_o_1_1_mpi_comm.html#a4059971c30e023b272fccaa6aa00c426">QUESO::MpiComm::Barrier</a></div><div class="ttdeci">void Barrier() const </div><div class="ttdoc">Pause every process in *this communicator until all the processes reach this point. </div><div class="ttdef"><b>Definition:</b> <a href="_mpi_comm_8_c_source.html#l00143">MpiComm.C:143</a></div></div>
<div class="ttc" id="class_q_u_e_s_o_1_1_m_l_sampling_html_af9416874c856e50f3b35270e801f17e4"><div class="ttname"><a href="class_q_u_e_s_o_1_1_m_l_sampling.html#af9416874c856e50f3b35270e801f17e4">QUESO::MLSampling::m_currLevel</a></div><div class="ttdeci">unsigned int m_currLevel</div><div class="ttdoc">Current level. </div><div class="ttdef"><b>Definition:</b> <a href="_m_l_sampling_8h_source.html#l00464">MLSampling.h:464</a></div></div>
<div class="ttc" id="_m_l_sampling_level_options_8h_html_a68d15eaf394d210effcf584b938206d3"><div class="ttname"><a href="_m_l_sampling_level_options_8h.html#a68d15eaf394d210effcf584b938206d3">LEVEL_REF_ID</a></div><div class="ttdeci">#define LEVEL_REF_ID</div><div class="ttdef"><b>Definition:</b> <a href="_m_l_sampling_level_options_8h_source.html#l00028">MLSamplingLevelOptions.h:28</a></div></div>
<div class="ttc" id="class_q_u_e_s_o_1_1_vector_space_html_a92e963bb5cab3eecd290dfe4b8f03b04"><div class="ttname"><a href="class_q_u_e_s_o_1_1_vector_space.html#a92e963bb5cab3eecd290dfe4b8f03b04">QUESO::VectorSpace::zeroVector</a></div><div class="ttdeci">const V &amp; zeroVector() const </div><div class="ttdoc">Returns a vector filled with zeros. </div><div class="ttdef"><b>Definition:</b> <a href="_vector_space_8_c_source.html#l00218">VectorSpace.C:218</a></div></div>
<div class="ttc" id="_mpi_comm_8h_html_a578a93c04b9dab934e3a90f0beed4edf"><div class="ttname"><a href="_mpi_comm_8h.html#a578a93c04b9dab934e3a90f0beed4edf">RawValue_MPI_IN_PLACE</a></div><div class="ttdeci">#define RawValue_MPI_IN_PLACE</div><div class="ttdef"><b>Definition:</b> <a href="_mpi_comm_8h_source.html#l00044">MpiComm.h:44</a></div></div>
<div class="ttc" id="class_q_u_e_s_o_1_1_m_l_sampling_html_a7bc4c72f65ba9166ed94a6e198b0915b"><div class="ttname"><a href="class_q_u_e_s_o_1_1_m_l_sampling.html#a7bc4c72f65ba9166ed94a6e198b0915b">QUESO::MLSampling::m_vectorSpace</a></div><div class="ttdeci">const VectorSpace&lt; P_V, P_M &gt; &amp; m_vectorSpace</div><div class="ttdoc">Vector space. </div><div class="ttdef"><b>Definition:</b> <a href="_m_l_sampling_8h_source.html#l00451">MLSampling.h:451</a></div></div>
<div class="ttc" id="class_q_u_e_s_o_1_1_mpi_comm_html_a9313449240c1bb2289870309a5c711ed"><div class="ttname"><a href="class_q_u_e_s_o_1_1_mpi_comm.html#a9313449240c1bb2289870309a5c711ed">QUESO::MpiComm::Gatherv</a></div><div class="ttdeci">void Gatherv(void *sendbuf, int sendcnt, RawType_MPI_Datatype sendtype, void *recvbuf, int *recvcnts, int *displs, RawType_MPI_Datatype recvtype, int root, const char *whereMsg, const char *whatMsg) const </div><div class="ttdoc">Gathers into specified locations from all processes in a group. </div><div class="ttdef"><b>Definition:</b> <a href="_mpi_comm_8_c_source.html#l00188">MpiComm.C:188</a></div></div>
<div class="ttc" id="class_q_u_e_s_o_1_1_base_environment_html_ae106b5bb8a80b655b88b3a26b1e7c185"><div class="ttname"><a href="class_q_u_e_s_o_1_1_base_environment.html#ae106b5bb8a80b655b88b3a26b1e7c185">QUESO::BaseEnvironment::inter0Rank</a></div><div class="ttdeci">int inter0Rank() const </div><div class="ttdoc">Returns the process inter0 rank. </div><div class="ttdef"><b>Definition:</b> <a href="_environment_8_c_source.html#l00289">Environment.C:289</a></div></div>
<div class="ttc" id="_mpi_comm_8h_html_ad0f503bd9fecfe4e570ca3d15aaf2518"><div class="ttname"><a href="_mpi_comm_8h.html#ad0f503bd9fecfe4e570ca3d15aaf2518">RawValue_MPI_DOUBLE</a></div><div class="ttdeci">#define RawValue_MPI_DOUBLE</div><div class="ttdef"><b>Definition:</b> <a href="_mpi_comm_8h_source.html#l00048">MpiComm.h:48</a></div></div>
<div class="ttc" id="_defines_8h_html_a56d63d18d0a6d45757de47fcc06f574d"><div class="ttname"><a href="_defines_8h.html#a56d63d18d0a6d45757de47fcc06f574d">UQ_FATAL_TEST_MACRO</a></div><div class="ttdeci">#define UQ_FATAL_TEST_MACRO(test, givenRank, where, what)</div><div class="ttdef"><b>Definition:</b> <a href="_defines_8h_source.html#l00222">Defines.h:222</a></div></div>
<div class="ttc" id="class_q_u_e_s_o_1_1_m_l_sampling_html_a1b1f8ccb4823bdfa26ec652f0807c63e"><div class="ttname"><a href="class_q_u_e_s_o_1_1_m_l_sampling.html#a1b1f8ccb4823bdfa26ec652f0807c63e">QUESO::MLSampling::m_currStep</a></div><div class="ttdeci">unsigned int m_currStep</div><div class="ttdoc">Curret step. </div><div class="ttdef"><b>Definition:</b> <a href="_m_l_sampling_8h_source.html#l00467">MLSampling.h:467</a></div></div>
<div class="ttc" id="class_q_u_e_s_o_1_1_base_environment_html_a1fe5f244fc0316a0ab3e37463f108b96"><div class="ttname"><a href="class_q_u_e_s_o_1_1_base_environment.html#a1fe5f244fc0316a0ab3e37463f108b96">QUESO::BaseEnvironment::displayVerbosity</a></div><div class="ttdeci">unsigned int displayVerbosity() const </div><div class="ttdef"><b>Definition:</b> <a href="_environment_8_c_source.html#l00436">Environment.C:436</a></div></div>
<div class="ttc" id="class_q_u_e_s_o_1_1_base_environment_html_a8a0064746ae8dddfece4229b9ad374d6"><div class="ttname"><a href="class_q_u_e_s_o_1_1_base_environment.html#a8a0064746ae8dddfece4229b9ad374d6">QUESO::BaseEnvironment::subDisplayFile</a></div><div class="ttdeci">std::ofstream * subDisplayFile() const </div><div class="ttdoc">Access function for m_subDisplayFile (displays file on stream). </div><div class="ttdef"><b>Definition:</b> <a href="_environment_8_c_source.html#l00305">Environment.C:305</a></div></div>
<div class="ttc" id="class_q_u_e_s_o_1_1_base_environment_html_a689e4d140c74d495d97eb498714a4b82"><div class="ttname"><a href="class_q_u_e_s_o_1_1_base_environment.html#a689e4d140c74d495d97eb498714a4b82">QUESO::BaseEnvironment::inter0Comm</a></div><div class="ttdeci">const MpiComm &amp; inter0Comm() const </div><div class="ttdoc">Access function for MpiComm inter0-communicator. </div><div class="ttdef"><b>Definition:</b> <a href="_environment_8_c_source.html#l00295">Environment.C:295</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a75b2d73a0b07f594951a89cc1bc96849"></a>
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;class P_V , class P_M &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="class_q_u_e_s_o_1_1_m_l_sampling.html">QUESO::MLSampling</a>&lt; P_V, P_M &gt;::prepareBalLinkedChains_inter0 </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="class_q_u_e_s_o_1_1_m_l_sampling_level_options.html">MLSamplingLevelOptions</a> *&#160;</td>
          <td class="paramname"><em>currOptions</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="class_q_u_e_s_o_1_1_sequence_of_vectors.html">SequenceOfVectors</a>&lt; P_V, P_M &gt; &amp;&#160;</td>
          <td class="paramname"><em>prevChain</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::vector&lt; <a class="el" href="struct_q_u_e_s_o_1_1_exchange_info_struct.html">ExchangeInfoStruct</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>exchangeStdVec</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct_q_u_e_s_o_1_1_balanced_linked_chains_per_node_struct.html">BalancedLinkedChainsPerNodeStruct</a>&lt; P_V &gt; &amp;&#160;</td>
          <td class="paramname"><em>balancedLinkControl</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">currOptions,prevChain,exchangeStdVec</td><td></td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">exchangeStdVec,balancedLinkControl</td><td></td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="_m_l_sampling_8_c_source.html#l00343">343</a> of file <a class="el" href="_m_l_sampling_8_c_source.html">MLSampling.C</a>.</p>

<p>References <a class="el" href="_m_l_sampling_level_options_8h_source.html#l00028">LEVEL_REF_ID</a>, <a class="el" href="_m_l_sampling_level_options_8h_source.html#l00166">QUESO::MLSamplingLevelOptions::m_loadBalanceAlgorithmId</a>, <a class="el" href="_mpi_comm_8h_source.html#l00046">RawValue_MPI_CHAR</a>, <a class="el" href="_mpi_comm_8h_source.html#l00048">RawValue_MPI_DOUBLE</a>, <a class="el" href="_mpi_comm_8h_source.html#l00051">RawValue_MPI_MAX</a>, <a class="el" href="_mpi_comm_8h_source.html#l00050">RawValue_MPI_MIN</a>, <a class="el" href="_mpi_comm_8h_source.html#l00049">RawValue_MPI_UNSIGNED</a>, and <a class="el" href="_defines_8h_source.html#l00222">UQ_FATAL_TEST_MACRO</a>.</p>
<div class="fragment"><div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;{</div>
<div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#ae106b5bb8a80b655b88b3a26b1e7c185">inter0Rank</a>() &lt; 0) <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;</div>
<div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;  <span class="keywordflow">if</span> ((<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#a8a0064746ae8dddfece4229b9ad374d6">subDisplayFile</a>()) &amp;&amp; (<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#a1fe5f244fc0316a0ab3e37463f108b96">displayVerbosity</a>() &gt;= 0)) {</div>
<div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;    *<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#a8a0064746ae8dddfece4229b9ad374d6">subDisplayFile</a>() &lt;&lt; <span class="stringliteral">&quot;Entering MLSampling&lt;P_V,P_M&gt;::prepareBalLinkedChains_inter0()&quot;</span></div>
<div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;                            &lt;&lt; <span class="stringliteral">&quot;, level &quot;</span> &lt;&lt; <a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#af9416874c856e50f3b35270e801f17e4">m_currLevel</a>+<a class="code" href="_m_l_sampling_level_options_8h.html#a68d15eaf394d210effcf584b938206d3">LEVEL_REF_ID</a></div>
<div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;                            &lt;&lt; <span class="stringliteral">&quot;, step &quot;</span>  &lt;&lt; <a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a1b1f8ccb4823bdfa26ec652f0807c63e">m_currStep</a></div>
<div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;                            &lt;&lt; std::endl;</div>
<div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;  }</div>
<div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;</div>
<div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;  <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> Np = (<span class="keywordtype">unsigned</span> int) <a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#a689e4d140c74d495d97eb498714a4b82">inter0Comm</a>().<a class="code" href="class_q_u_e_s_o_1_1_mpi_comm.html#aa780721ae0fdeabc5a15e04cb0cad964">NumProc</a>();</div>
<div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#ae106b5bb8a80b655b88b3a26b1e7c185">inter0Rank</a>() == 0) {</div>
<div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;    <span class="keywordflow">switch</span> (currOptions-&gt;m_loadBalanceAlgorithmId) {</div>
<div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;      <span class="keywordflow">case</span> 2:</div>
<div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;        <a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a44ff302d505e5de781ea6635ea0d85d9">justBalance_proc0</a>(currOptions,     <span class="comment">// input</span></div>
<div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;                          exchangeStdVec); <span class="comment">// input/output</span></div>
<div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;      <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;</div>
<div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;      <span class="keywordflow">case</span> 1:</div>
<div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;      <span class="keywordflow">default</span>:</div>
<div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;<span class="preprocessor">#ifdef QUESO_HAS_GLPK</span></div>
<div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;<span class="preprocessor"></span>        <span class="comment">// Get final node responsible for a linked chain by solving BIP at node zero only</span></div>
<div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;        solveBIP_proc0(exchangeStdVec); <span class="comment">// input/output</span></div>
<div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;<span class="preprocessor">#else</span></div>
<div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;<span class="preprocessor"></span>        <span class="keywordflow">if</span> (<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#a8a0064746ae8dddfece4229b9ad374d6">subDisplayFile</a>()) {</div>
<div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;          *<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#a8a0064746ae8dddfece4229b9ad374d6">subDisplayFile</a>() &lt;&lt; <span class="stringliteral">&quot;WARNING in MLSampling&lt;P_V,P_M&gt;::prepareBalLinkedChains_inter0()&quot;</span></div>
<div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;                                  &lt;&lt; <span class="stringliteral">&quot;: algorithm id &#39;&quot;</span> &lt;&lt; currOptions-&gt;m_loadBalanceAlgorithmId</div>
<div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;                                  &lt;&lt; <span class="stringliteral">&quot;&#39; has been requested, but this QUESO library has not been built with &#39;hdf5&#39;&quot;</span></div>
<div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;                                  &lt;&lt; <span class="stringliteral">&quot;. Code will therefore process the algorithm id &#39;&quot;</span> &lt;&lt; 2</div>
<div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;                                  &lt;&lt; <span class="stringliteral">&quot;&#39; instead...&quot;</span></div>
<div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;                                  &lt;&lt; std::endl;</div>
<div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;        }</div>
<div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#a172d52f993f1322ed45aaddf71518dbb">subRank</a>() == 0) {</div>
<div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;          std::cerr &lt;&lt; <span class="stringliteral">&quot;WARNING in MLSampling&lt;P_V,P_M&gt;::prepareBalLinkedChains_inter0()&quot;</span></div>
<div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;                    &lt;&lt; <span class="stringliteral">&quot;: algorithm id &#39;&quot;</span> &lt;&lt; currOptions-&gt;m_loadBalanceAlgorithmId</div>
<div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;                    &lt;&lt; <span class="stringliteral">&quot;&#39; has been requested, but this QUESO library has not been built with &#39;hdf5&#39;&quot;</span></div>
<div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;                    &lt;&lt; <span class="stringliteral">&quot;. Code will therefore process the algorithm id &#39;&quot;</span> &lt;&lt; 2</div>
<div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;                    &lt;&lt; <span class="stringliteral">&quot;&#39; instead...&quot;</span></div>
<div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;                    &lt;&lt; std::endl;</div>
<div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;        }</div>
<div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;        <a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a44ff302d505e5de781ea6635ea0d85d9">justBalance_proc0</a>(currOptions,     <span class="comment">// input</span></div>
<div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;                          exchangeStdVec); <span class="comment">// input/output</span></div>
<div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;<span class="preprocessor"></span>      <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;    }</div>
<div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;  } <span class="comment">// if (m_env.inter0Rank() == 0)</span></div>
<div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;</div>
<div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;  <a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#a689e4d140c74d495d97eb498714a4b82">inter0Comm</a>().<a class="code" href="class_q_u_e_s_o_1_1_mpi_comm.html#a4059971c30e023b272fccaa6aa00c426">Barrier</a>();</div>
<div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;</div>
<div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;  <span class="comment">// Proc 0 now broadcasts the information on &#39;exchangeStdVec&#39;</span></div>
<div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;<span class="comment"></span>  <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> exchangeStdVecSize = exchangeStdVec.size();</div>
<div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;  <a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#a689e4d140c74d495d97eb498714a4b82">inter0Comm</a>().<a class="code" href="class_q_u_e_s_o_1_1_mpi_comm.html#abd6af8db8b0c7fd2f5b62e26477a9537">Bcast</a>((<span class="keywordtype">void</span> *) &amp;exchangeStdVecSize, (<span class="keywordtype">int</span>) 1, <a class="code" href="_mpi_comm_8h.html#a06cbfbc33436f6e0dc8a48ff3c49bdfc">RawValue_MPI_UNSIGNED</a>, 0, <span class="comment">// LOAD BALANCE</span></div>
<div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;                           <span class="stringliteral">&quot;MLSampling&lt;P_V,P_M&gt;::prepareBalLinkedChains_inter0()&quot;</span>,</div>
<div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;                           <span class="stringliteral">&quot;failed MPI.Bcast() for exchangeStdVec size&quot;</span>);</div>
<div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#ae106b5bb8a80b655b88b3a26b1e7c185">inter0Rank</a>() &gt; 0) exchangeStdVec.resize(exchangeStdVecSize);</div>
<div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;</div>
<div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;  <a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#a689e4d140c74d495d97eb498714a4b82">inter0Comm</a>().<a class="code" href="class_q_u_e_s_o_1_1_mpi_comm.html#abd6af8db8b0c7fd2f5b62e26477a9537">Bcast</a>((<span class="keywordtype">void</span> *) &amp;exchangeStdVec[0], (<span class="keywordtype">int</span>) (exchangeStdVecSize*<span class="keyword">sizeof</span>(ExchangeInfoStruct)), <a class="code" href="_mpi_comm_8h.html#ae81a57f3cac29c0f9c656182d95b8af1">RawValue_MPI_CHAR</a>, 0, <span class="comment">// LOAD BALANCE</span></div>
<div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;                           <span class="stringliteral">&quot;MLSampling&lt;P_V,P_M&gt;::prepareBalLinkedChains_inter0()&quot;</span>,</div>
<div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;                           <span class="stringliteral">&quot;failed MPI.Bcast() for exchangeStdVec data&quot;</span>);</div>
<div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;</div>
<div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;  <span class="comment">// All &quot;management&quot; nodes update &#39;finalNumChainsPerNode&#39; and &#39;finalNumPostionsPerNode&#39;</span></div>
<div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;<span class="comment"></span>  std::vector&lt;unsigned int&gt; finalNumChainsPerNode   (Np,0);</div>
<div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;  std::vector&lt;unsigned int&gt; finalNumPositionsPerNode(Np,0);</div>
<div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;  <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> Nc = exchangeStdVec.size();</div>
<div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> chainId = 0; chainId &lt; Nc; ++chainId) {</div>
<div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> nodeId = exchangeStdVec[chainId].finalNodeOfInitialPosition;</div>
<div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;    finalNumChainsPerNode   [nodeId] += 1;</div>
<div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;    finalNumPositionsPerNode[nodeId] += exchangeStdVec[chainId].numberOfPositions;</div>
<div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;  }</div>
<div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;</div>
<div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;  <span class="comment">// Sanity check</span></div>
<div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;<span class="comment"></span>  <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> finalMinPosPerNode = *std::min_element(finalNumPositionsPerNode.begin(), finalNumPositionsPerNode.end());</div>
<div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;  <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> finalMaxPosPerNode = *std::max_element(finalNumPositionsPerNode.begin(), finalNumPositionsPerNode.end());</div>
<div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;  <span class="keywordtype">double</span> finalRatioOfPosPerNode = ((double) finalMaxPosPerNode) / ((double)finalMinPosPerNode);</div>
<div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;  <span class="comment">//std::cout &lt;&lt; m_env.worldRank() &lt;&lt; &quot;, finalRatioOfPosPerNode = &quot; &lt;&lt; finalRatioOfPosPerNode &lt;&lt; std::endl;</span></div>
<div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;</div>
<div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;  std::vector&lt;double&gt; auxBuf(1,0.);</div>
<div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;  <span class="keywordtype">double</span> minRatio = 0.;</div>
<div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;  auxBuf[0] = finalRatioOfPosPerNode;</div>
<div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;  <a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#a689e4d140c74d495d97eb498714a4b82">inter0Comm</a>().<a class="code" href="class_q_u_e_s_o_1_1_mpi_comm.html#a72e137e60ef8060efb1ee5fc874fa4b8">Allreduce</a>((<span class="keywordtype">void</span> *) &amp;auxBuf[0], (<span class="keywordtype">void</span> *) &amp;minRatio, (<span class="keywordtype">int</span>) auxBuf.size(), <a class="code" href="_mpi_comm_8h.html#ad0f503bd9fecfe4e570ca3d15aaf2518">RawValue_MPI_DOUBLE</a>, <a class="code" href="_mpi_comm_8h.html#a8e30f42fdac116861205e83e2aa18042">RawValue_MPI_MIN</a>, <span class="comment">// LOAD BALANCE</span></div>
<div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;                               <span class="stringliteral">&quot;MLSampling&lt;P_V,P_M&gt;::prepareBalLinkedChains_inter0()&quot;</span>,</div>
<div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;                               <span class="stringliteral">&quot;failed MPI.Allreduce() for min&quot;</span>);</div>
<div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;  <span class="comment">//std::cout &lt;&lt; m_env.worldRank() &lt;&lt; &quot;, minRatio = &quot; &lt;&lt; minRatio &lt;&lt; std::endl;</span></div>
<div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;  <a class="code" href="_defines_8h.html#a56d63d18d0a6d45757de47fcc06f574d">UQ_FATAL_TEST_MACRO</a>(minRatio != finalRatioOfPosPerNode,</div>
<div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;                      <a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#a78b57112bbd0e6dd0e8afec00b40ffa7">worldRank</a>(),</div>
<div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;                      <span class="stringliteral">&quot;MLSampling&lt;P_V,P_M&gt;::prepareBalLinkedChains_inter0()&quot;</span>,</div>
<div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;                      <span class="stringliteral">&quot;failed minRatio sanity check&quot;</span>);</div>
<div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;</div>
<div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;  <span class="keywordtype">double</span> maxRatio = 0.;</div>
<div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;  auxBuf[0] = finalRatioOfPosPerNode;</div>
<div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;  <a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#a689e4d140c74d495d97eb498714a4b82">inter0Comm</a>().<a class="code" href="class_q_u_e_s_o_1_1_mpi_comm.html#a72e137e60ef8060efb1ee5fc874fa4b8">Allreduce</a>((<span class="keywordtype">void</span> *) &amp;auxBuf[0], (<span class="keywordtype">void</span> *) &amp;maxRatio, (<span class="keywordtype">int</span>) auxBuf.size(), <a class="code" href="_mpi_comm_8h.html#ad0f503bd9fecfe4e570ca3d15aaf2518">RawValue_MPI_DOUBLE</a>, <a class="code" href="_mpi_comm_8h.html#a68f3ac7ff71a6504e236b0c95de78178">RawValue_MPI_MAX</a>, <span class="comment">// LOAD BALANCE</span></div>
<div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;                               <span class="stringliteral">&quot;MLSampling&lt;P_V,P_M&gt;::prepareBalLinkedChains_inter0()&quot;</span>,</div>
<div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;                               <span class="stringliteral">&quot;failed MPI.Allreduce() for max&quot;</span>);</div>
<div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;  <span class="comment">//std::cout &lt;&lt; m_env.worldRank() &lt;&lt; &quot;, maxRatio = &quot; &lt;&lt; maxRatio &lt;&lt; std::endl;</span></div>
<div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;  <a class="code" href="_defines_8h.html#a56d63d18d0a6d45757de47fcc06f574d">UQ_FATAL_TEST_MACRO</a>(maxRatio != finalRatioOfPosPerNode,</div>
<div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;                      <a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#a78b57112bbd0e6dd0e8afec00b40ffa7">worldRank</a>(),</div>
<div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;                      <span class="stringliteral">&quot;MLSampling&lt;P_V,P_M&gt;::prepareBalLinkedChains_inter0()&quot;</span>,</div>
<div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;                      <span class="stringliteral">&quot;failed maxRatio sanity check&quot;</span>);</div>
<div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;</div>
<div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;  <span class="comment">// Proc 0 now broadcasts the information on &#39;finalNumChainsPerNode&#39;</span></div>
<div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;<span class="comment"></span>  <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> finalNumChainsPerNodeSize = finalNumChainsPerNode.size();</div>
<div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;  <a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#a689e4d140c74d495d97eb498714a4b82">inter0Comm</a>().<a class="code" href="class_q_u_e_s_o_1_1_mpi_comm.html#abd6af8db8b0c7fd2f5b62e26477a9537">Bcast</a>((<span class="keywordtype">void</span> *) &amp;finalNumChainsPerNodeSize, (<span class="keywordtype">int</span>) 1, <a class="code" href="_mpi_comm_8h.html#a06cbfbc33436f6e0dc8a48ff3c49bdfc">RawValue_MPI_UNSIGNED</a>, 0, <span class="comment">// LOAD BALANCE</span></div>
<div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;                           <span class="stringliteral">&quot;MLSampling&lt;P_V,P_M&gt;::prepareBalLinkedChains_inter0()&quot;</span>,</div>
<div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;                           <span class="stringliteral">&quot;failed MPI.Bcast() for finalNumChainsPerNode size&quot;</span>);</div>
<div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#ae106b5bb8a80b655b88b3a26b1e7c185">inter0Rank</a>() &gt; 0) finalNumChainsPerNode.resize(finalNumChainsPerNodeSize);</div>
<div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;</div>
<div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;  <a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#a689e4d140c74d495d97eb498714a4b82">inter0Comm</a>().<a class="code" href="class_q_u_e_s_o_1_1_mpi_comm.html#abd6af8db8b0c7fd2f5b62e26477a9537">Bcast</a>((<span class="keywordtype">void</span> *) &amp;finalNumChainsPerNode[0], (<span class="keywordtype">int</span>) finalNumChainsPerNodeSize, <a class="code" href="_mpi_comm_8h.html#a06cbfbc33436f6e0dc8a48ff3c49bdfc">RawValue_MPI_UNSIGNED</a>, 0, <span class="comment">// LOAD BALANCE</span></div>
<div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;                           <span class="stringliteral">&quot;MLSampling&lt;P_V,P_M&gt;::prepareBalLinkedChains_inter0()&quot;</span>,</div>
<div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;                           <span class="stringliteral">&quot;failed MPI.Bcast() for finalNumChainsPerNode data&quot;</span>);</div>
<div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;</div>
<div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;  <span class="comment">// Mpi exchange information between nodes and properly populate</span></div>
<div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;  <span class="comment">// balancedLinkControl.linkedChains at each node</span></div>
<div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;<span class="comment"></span>  <a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a1bb275df38553b88e2196103c7f5ea46">mpiExchangePositions_inter0</a>(prevChain,</div>
<div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;                              exchangeStdVec,</div>
<div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;                              finalNumChainsPerNode,</div>
<div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;                              finalNumPositionsPerNode, <span class="comment">// It is already valid at all &quot;management&quot; nodes (not only at node 0) because of the sanity check above</span></div>
<div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;                              balancedLinkControl);</div>
<div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;</div>
<div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;  <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;}</div>
<div class="ttc" id="class_q_u_e_s_o_1_1_m_l_sampling_html_a13f1ca4fe9f94822fe572a743eaced1d"><div class="ttname"><a href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">QUESO::MLSampling::m_env</a></div><div class="ttdeci">const BaseEnvironment &amp; m_env</div><div class="ttdoc">Queso enviroment. </div><div class="ttdef"><b>Definition:</b> <a href="_m_l_sampling_8h_source.html#l00442">MLSampling.h:442</a></div></div>
<div class="ttc" id="class_q_u_e_s_o_1_1_mpi_comm_html_aa780721ae0fdeabc5a15e04cb0cad964"><div class="ttname"><a href="class_q_u_e_s_o_1_1_mpi_comm.html#aa780721ae0fdeabc5a15e04cb0cad964">QUESO::MpiComm::NumProc</a></div><div class="ttdeci">int NumProc() const </div><div class="ttdoc">Returns total number of processes. </div><div class="ttdef"><b>Definition:</b> <a href="_mpi_comm_8_c_source.html#l00121">MpiComm.C:121</a></div></div>
<div class="ttc" id="class_q_u_e_s_o_1_1_base_environment_html_a78b57112bbd0e6dd0e8afec00b40ffa7"><div class="ttname"><a href="class_q_u_e_s_o_1_1_base_environment.html#a78b57112bbd0e6dd0e8afec00b40ffa7">QUESO::BaseEnvironment::worldRank</a></div><div class="ttdeci">int worldRank() const </div><div class="ttdoc">Returns the process world rank. </div><div class="ttdef"><b>Definition:</b> <a href="_environment_8_c_source.html#l00235">Environment.C:235</a></div></div>
<div class="ttc" id="class_q_u_e_s_o_1_1_mpi_comm_html_a4059971c30e023b272fccaa6aa00c426"><div class="ttname"><a href="class_q_u_e_s_o_1_1_mpi_comm.html#a4059971c30e023b272fccaa6aa00c426">QUESO::MpiComm::Barrier</a></div><div class="ttdeci">void Barrier() const </div><div class="ttdoc">Pause every process in *this communicator until all the processes reach this point. </div><div class="ttdef"><b>Definition:</b> <a href="_mpi_comm_8_c_source.html#l00143">MpiComm.C:143</a></div></div>
<div class="ttc" id="class_q_u_e_s_o_1_1_m_l_sampling_html_a44ff302d505e5de781ea6635ea0d85d9"><div class="ttname"><a href="class_q_u_e_s_o_1_1_m_l_sampling.html#a44ff302d505e5de781ea6635ea0d85d9">QUESO::MLSampling::justBalance_proc0</a></div><div class="ttdeci">void justBalance_proc0(const MLSamplingLevelOptions *currOptions, std::vector&lt; ExchangeInfoStruct &gt; &amp;exchangeStdVec)</div><div class="ttdef"><b>Definition:</b> <a href="_m_l_sampling_8_c_source.html#l01518">MLSampling.C:1518</a></div></div>
<div class="ttc" id="class_q_u_e_s_o_1_1_base_environment_html_a172d52f993f1322ed45aaddf71518dbb"><div class="ttname"><a href="class_q_u_e_s_o_1_1_base_environment.html#a172d52f993f1322ed45aaddf71518dbb">QUESO::BaseEnvironment::subRank</a></div><div class="ttdeci">int subRank() const </div><div class="ttdoc">Access function for sub-rank. </div><div class="ttdef"><b>Definition:</b> <a href="_environment_8_c_source.html#l00263">Environment.C:263</a></div></div>
<div class="ttc" id="class_q_u_e_s_o_1_1_m_l_sampling_html_af9416874c856e50f3b35270e801f17e4"><div class="ttname"><a href="class_q_u_e_s_o_1_1_m_l_sampling.html#af9416874c856e50f3b35270e801f17e4">QUESO::MLSampling::m_currLevel</a></div><div class="ttdeci">unsigned int m_currLevel</div><div class="ttdoc">Current level. </div><div class="ttdef"><b>Definition:</b> <a href="_m_l_sampling_8h_source.html#l00464">MLSampling.h:464</a></div></div>
<div class="ttc" id="_m_l_sampling_level_options_8h_html_a68d15eaf394d210effcf584b938206d3"><div class="ttname"><a href="_m_l_sampling_level_options_8h.html#a68d15eaf394d210effcf584b938206d3">LEVEL_REF_ID</a></div><div class="ttdeci">#define LEVEL_REF_ID</div><div class="ttdef"><b>Definition:</b> <a href="_m_l_sampling_level_options_8h_source.html#l00028">MLSamplingLevelOptions.h:28</a></div></div>
<div class="ttc" id="_mpi_comm_8h_html_a68f3ac7ff71a6504e236b0c95de78178"><div class="ttname"><a href="_mpi_comm_8h.html#a68f3ac7ff71a6504e236b0c95de78178">RawValue_MPI_MAX</a></div><div class="ttdeci">#define RawValue_MPI_MAX</div><div class="ttdef"><b>Definition:</b> <a href="_mpi_comm_8h_source.html#l00051">MpiComm.h:51</a></div></div>
<div class="ttc" id="class_q_u_e_s_o_1_1_mpi_comm_html_abd6af8db8b0c7fd2f5b62e26477a9537"><div class="ttname"><a href="class_q_u_e_s_o_1_1_mpi_comm.html#abd6af8db8b0c7fd2f5b62e26477a9537">QUESO::MpiComm::Bcast</a></div><div class="ttdeci">void Bcast(void *buffer, int count, RawType_MPI_Datatype datatype, int root, const char *whereMsg, const char *whatMsg) const </div><div class="ttdoc">Broadcast values from the root process to the slave processes. </div><div class="ttdef"><b>Definition:</b> <a href="_mpi_comm_8_c_source.html#l00157">MpiComm.C:157</a></div></div>
<div class="ttc" id="class_q_u_e_s_o_1_1_m_l_sampling_html_a1bb275df38553b88e2196103c7f5ea46"><div class="ttname"><a href="class_q_u_e_s_o_1_1_m_l_sampling.html#a1bb275df38553b88e2196103c7f5ea46">QUESO::MLSampling::mpiExchangePositions_inter0</a></div><div class="ttdeci">void mpiExchangePositions_inter0(const SequenceOfVectors&lt; P_V, P_M &gt; &amp;prevChain, const std::vector&lt; ExchangeInfoStruct &gt; &amp;exchangeStdVec, const std::vector&lt; unsigned int &gt; &amp;finalNumChainsPerNode, const std::vector&lt; unsigned int &gt; &amp;finalNumPositionsPerNode, BalancedLinkedChainsPerNodeStruct&lt; P_V &gt; &amp;balancedLinkControl)</div><div class="ttdef"><b>Definition:</b> <a href="_m_l_sampling_8_c_source.html#l01821">MLSampling.C:1821</a></div></div>
<div class="ttc" id="class_q_u_e_s_o_1_1_base_environment_html_ae106b5bb8a80b655b88b3a26b1e7c185"><div class="ttname"><a href="class_q_u_e_s_o_1_1_base_environment.html#ae106b5bb8a80b655b88b3a26b1e7c185">QUESO::BaseEnvironment::inter0Rank</a></div><div class="ttdeci">int inter0Rank() const </div><div class="ttdoc">Returns the process inter0 rank. </div><div class="ttdef"><b>Definition:</b> <a href="_environment_8_c_source.html#l00289">Environment.C:289</a></div></div>
<div class="ttc" id="_mpi_comm_8h_html_ae81a57f3cac29c0f9c656182d95b8af1"><div class="ttname"><a href="_mpi_comm_8h.html#ae81a57f3cac29c0f9c656182d95b8af1">RawValue_MPI_CHAR</a></div><div class="ttdeci">#define RawValue_MPI_CHAR</div><div class="ttdef"><b>Definition:</b> <a href="_mpi_comm_8h_source.html#l00046">MpiComm.h:46</a></div></div>
<div class="ttc" id="class_q_u_e_s_o_1_1_mpi_comm_html_a72e137e60ef8060efb1ee5fc874fa4b8"><div class="ttname"><a href="class_q_u_e_s_o_1_1_mpi_comm.html#a72e137e60ef8060efb1ee5fc874fa4b8">QUESO::MpiComm::Allreduce</a></div><div class="ttdeci">void Allreduce(void *sendbuf, void *recvbuf, int count, RawType_MPI_Datatype datatype, RawType_MPI_Op op, const char *whereMsg, const char *whatMsg) const </div><div class="ttdoc">Combines values from all processes and distributes the result back to all processes. </div><div class="ttdef"><b>Definition:</b> <a href="_mpi_comm_8_c_source.html#l00131">MpiComm.C:131</a></div></div>
<div class="ttc" id="_mpi_comm_8h_html_ad0f503bd9fecfe4e570ca3d15aaf2518"><div class="ttname"><a href="_mpi_comm_8h.html#ad0f503bd9fecfe4e570ca3d15aaf2518">RawValue_MPI_DOUBLE</a></div><div class="ttdeci">#define RawValue_MPI_DOUBLE</div><div class="ttdef"><b>Definition:</b> <a href="_mpi_comm_8h_source.html#l00048">MpiComm.h:48</a></div></div>
<div class="ttc" id="_defines_8h_html_a56d63d18d0a6d45757de47fcc06f574d"><div class="ttname"><a href="_defines_8h.html#a56d63d18d0a6d45757de47fcc06f574d">UQ_FATAL_TEST_MACRO</a></div><div class="ttdeci">#define UQ_FATAL_TEST_MACRO(test, givenRank, where, what)</div><div class="ttdef"><b>Definition:</b> <a href="_defines_8h_source.html#l00222">Defines.h:222</a></div></div>
<div class="ttc" id="_mpi_comm_8h_html_a06cbfbc33436f6e0dc8a48ff3c49bdfc"><div class="ttname"><a href="_mpi_comm_8h.html#a06cbfbc33436f6e0dc8a48ff3c49bdfc">RawValue_MPI_UNSIGNED</a></div><div class="ttdeci">#define RawValue_MPI_UNSIGNED</div><div class="ttdef"><b>Definition:</b> <a href="_mpi_comm_8h_source.html#l00049">MpiComm.h:49</a></div></div>
<div class="ttc" id="class_q_u_e_s_o_1_1_m_l_sampling_html_a1b1f8ccb4823bdfa26ec652f0807c63e"><div class="ttname"><a href="class_q_u_e_s_o_1_1_m_l_sampling.html#a1b1f8ccb4823bdfa26ec652f0807c63e">QUESO::MLSampling::m_currStep</a></div><div class="ttdeci">unsigned int m_currStep</div><div class="ttdoc">Curret step. </div><div class="ttdef"><b>Definition:</b> <a href="_m_l_sampling_8h_source.html#l00467">MLSampling.h:467</a></div></div>
<div class="ttc" id="_mpi_comm_8h_html_a8e30f42fdac116861205e83e2aa18042"><div class="ttname"><a href="_mpi_comm_8h.html#a8e30f42fdac116861205e83e2aa18042">RawValue_MPI_MIN</a></div><div class="ttdeci">#define RawValue_MPI_MIN</div><div class="ttdef"><b>Definition:</b> <a href="_mpi_comm_8h_source.html#l00050">MpiComm.h:50</a></div></div>
<div class="ttc" id="class_q_u_e_s_o_1_1_base_environment_html_a1fe5f244fc0316a0ab3e37463f108b96"><div class="ttname"><a href="class_q_u_e_s_o_1_1_base_environment.html#a1fe5f244fc0316a0ab3e37463f108b96">QUESO::BaseEnvironment::displayVerbosity</a></div><div class="ttdeci">unsigned int displayVerbosity() const </div><div class="ttdef"><b>Definition:</b> <a href="_environment_8_c_source.html#l00436">Environment.C:436</a></div></div>
<div class="ttc" id="class_q_u_e_s_o_1_1_base_environment_html_a8a0064746ae8dddfece4229b9ad374d6"><div class="ttname"><a href="class_q_u_e_s_o_1_1_base_environment.html#a8a0064746ae8dddfece4229b9ad374d6">QUESO::BaseEnvironment::subDisplayFile</a></div><div class="ttdeci">std::ofstream * subDisplayFile() const </div><div class="ttdoc">Access function for m_subDisplayFile (displays file on stream). </div><div class="ttdef"><b>Definition:</b> <a href="_environment_8_c_source.html#l00305">Environment.C:305</a></div></div>
<div class="ttc" id="class_q_u_e_s_o_1_1_base_environment_html_a689e4d140c74d495d97eb498714a4b82"><div class="ttname"><a href="class_q_u_e_s_o_1_1_base_environment.html#a689e4d140c74d495d97eb498714a4b82">QUESO::BaseEnvironment::inter0Comm</a></div><div class="ttdeci">const MpiComm &amp; inter0Comm() const </div><div class="ttdoc">Access function for MpiComm inter0-communicator. </div><div class="ttdef"><b>Definition:</b> <a href="_environment_8_c_source.html#l00295">Environment.C:295</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a37dcf4d893b6c8f67fe077892bada773"></a>
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;class P_V , class P_M &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="class_q_u_e_s_o_1_1_m_l_sampling.html">QUESO::MLSampling</a>&lt; P_V, P_M &gt;::prepareUnbLinkedChains_inter0 </td>
          <td>(</td>
          <td class="paramtype">unsigned int&#160;</td>
          <td class="paramname"><em>indexOfFirstWeight</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned int&#160;</td>
          <td class="paramname"><em>indexOfLastWeight</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::vector&lt; unsigned int &gt; &amp;&#160;</td>
          <td class="paramname"><em>unifiedIndexCountersAtProc0Only</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct_q_u_e_s_o_1_1_unbalanced_linked_chains_per_node_struct.html">UnbalancedLinkedChainsPerNodeStruct</a> &amp;&#160;</td>
          <td class="paramname"><em>unbalancedLinkControl</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">indexOfFirstWeight,indexOfLastWeight,unifiedIndexCountersAtProc0Only</td><td></td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">unbalancedLinkControl</td><td></td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="_m_l_sampling_8_c_source.html#l00481">481</a> of file <a class="el" href="_m_l_sampling_8_c_source.html">MLSampling.C</a>.</p>

<p>References <a class="el" href="_m_l_sampling_8h_source.html#l00091">QUESO::UnbalancedLinkedChainControlStruct::initialPositionIndexInPreviousChain</a>, <a class="el" href="_m_l_sampling_level_options_8h_source.html#l00028">LEVEL_REF_ID</a>, <a class="el" href="_m_l_sampling_8h_source.html#l00092">QUESO::UnbalancedLinkedChainControlStruct::numberOfPositions</a>, <a class="el" href="_mpi_comm_8h_source.html#l00051">RawValue_MPI_MAX</a>, <a class="el" href="_mpi_comm_8h_source.html#l00050">RawValue_MPI_MIN</a>, <a class="el" href="_mpi_comm_8h_source.html#l00052">RawValue_MPI_SUM</a>, <a class="el" href="_mpi_comm_8h_source.html#l00049">RawValue_MPI_UNSIGNED</a>, <a class="el" href="_m_l_sampling_8h_source.html#l00097">QUESO::UnbalancedLinkedChainsPerNodeStruct::unbLinkedChains</a>, and <a class="el" href="_defines_8h_source.html#l00222">UQ_FATAL_TEST_MACRO</a>.</p>
<div class="fragment"><div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;{</div>
<div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#ae106b5bb8a80b655b88b3a26b1e7c185">inter0Rank</a>() &lt; 0) <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;</div>
<div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;  <span class="keywordflow">if</span> ((<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#a8a0064746ae8dddfece4229b9ad374d6">subDisplayFile</a>()) &amp;&amp; (<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#a1fe5f244fc0316a0ab3e37463f108b96">displayVerbosity</a>() &gt;= 0)) {</div>
<div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;    *<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#a8a0064746ae8dddfece4229b9ad374d6">subDisplayFile</a>() &lt;&lt; <span class="stringliteral">&quot;Entering MLSampling&lt;P_V,P_M&gt;::prepareUnbLinkedChains_inter0()&quot;</span></div>
<div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;                            &lt;&lt; <span class="stringliteral">&quot;, level &quot;</span> &lt;&lt; <a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#af9416874c856e50f3b35270e801f17e4">m_currLevel</a>+<a class="code" href="_m_l_sampling_level_options_8h.html#a68d15eaf394d210effcf584b938206d3">LEVEL_REF_ID</a></div>
<div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;                            &lt;&lt; <span class="stringliteral">&quot;, step &quot;</span>  &lt;&lt; <a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a1b1f8ccb4823bdfa26ec652f0807c63e">m_currStep</a></div>
<div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;                            &lt;&lt; <span class="stringliteral">&quot;: indexOfFirstWeight = &quot;</span> &lt;&lt; indexOfFirstWeight</div>
<div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;                            &lt;&lt; <span class="stringliteral">&quot;, indexOfLastWeight = &quot;</span>  &lt;&lt; indexOfLastWeight</div>
<div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;                            &lt;&lt; std::endl;</div>
<div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;  }</div>
<div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;</div>
<div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;  <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>              subNumSamples = 0;</div>
<div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;  std::vector&lt;unsigned int&gt; unifiedIndexCountersAtAllProcs(0);</div>
<div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;</div>
<div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;  <span class="comment">// All nodes in &#39;inter0Comm&#39; should resize to the same size // KAUST3</span></div>
<div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;  <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> resizeSize = unifiedIndexCountersAtProc0Only.size();</div>
<div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;  <a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#a689e4d140c74d495d97eb498714a4b82">inter0Comm</a>().<a class="code" href="class_q_u_e_s_o_1_1_mpi_comm.html#abd6af8db8b0c7fd2f5b62e26477a9537">Bcast</a>((<span class="keywordtype">void</span> *) &amp;resizeSize, (<span class="keywordtype">int</span>) 1, <a class="code" href="_mpi_comm_8h.html#a06cbfbc33436f6e0dc8a48ff3c49bdfc">RawValue_MPI_UNSIGNED</a>, 0,</div>
<div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;                           <span class="stringliteral">&quot;MLSampling&lt;P_V,P_M&gt;::prepareUnbLinkedChains_inter0()&quot;</span>,</div>
<div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;                           <span class="stringliteral">&quot;failed MPI.Bcast() for resizeSize&quot;</span>);</div>
<div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;  unifiedIndexCountersAtAllProcs.resize(resizeSize,0);</div>
<div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;</div>
<div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#ae106b5bb8a80b655b88b3a26b1e7c185">inter0Rank</a>() == 0) unifiedIndexCountersAtAllProcs = unifiedIndexCountersAtProc0Only;</div>
<div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;</div>
<div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;  <span class="comment">// Broadcast index counters to all nodes</span></div>
<div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;  <a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#a689e4d140c74d495d97eb498714a4b82">inter0Comm</a>().<a class="code" href="class_q_u_e_s_o_1_1_mpi_comm.html#abd6af8db8b0c7fd2f5b62e26477a9537">Bcast</a>((<span class="keywordtype">void</span> *) &amp;unifiedIndexCountersAtAllProcs[0], (<span class="keywordtype">int</span>) unifiedIndexCountersAtAllProcs.size(), <a class="code" href="_mpi_comm_8h.html#a06cbfbc33436f6e0dc8a48ff3c49bdfc">RawValue_MPI_UNSIGNED</a>, 0,</div>
<div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;                           <span class="stringliteral">&quot;MLSampling&lt;P_V,P_M&gt;::prepareUnbLinkedChains_inter0()&quot;</span>,</div>
<div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;                           <span class="stringliteral">&quot;failed MPI.Bcast() for unified index counters&quot;</span>);</div>
<div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;<span class="preprocessor">#if 0 // Use allgatherv ??? for subNumSamples instead</span></div>
<div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;<span class="preprocessor"></span>  <span class="keywordflow">if</span> ((<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#a8a0064746ae8dddfece4229b9ad374d6">subDisplayFile</a>()) &amp;&amp; (<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#a1fe5f244fc0316a0ab3e37463f108b96">displayVerbosity</a>() &gt;= 0)) {</div>
<div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;    *<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#a8a0064746ae8dddfece4229b9ad374d6">subDisplayFile</a>() &lt;&lt; <span class="stringliteral">&quot;In MLSampling&lt;P_V,P_M&gt;::prepareUnbLinkedChains_inter0()&quot;</span></div>
<div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;                            &lt;&lt; <span class="stringliteral">&quot;, level &quot;</span> &lt;&lt; <a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#af9416874c856e50f3b35270e801f17e4">m_currLevel</a>+<a class="code" href="_m_l_sampling_level_options_8h.html#a68d15eaf394d210effcf584b938206d3">LEVEL_REF_ID</a></div>
<div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;                            &lt;&lt; <span class="stringliteral">&quot;, step &quot;</span>  &lt;&lt; <a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a1b1f8ccb4823bdfa26ec652f0807c63e">m_currStep</a></div>
<div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;                            &lt;&lt; <span class="stringliteral">&quot;:&quot;</span></div>
<div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;                            &lt;&lt; std::endl;</div>
<div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> r = 0; r &lt; <a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#a689e4d140c74d495d97eb498714a4b82">inter0Comm</a>().<a class="code" href="class_q_u_e_s_o_1_1_mpi_comm.html#aa780721ae0fdeabc5a15e04cb0cad964">NumProc</a>(); ++r) {</div>
<div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;      *<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#a8a0064746ae8dddfece4229b9ad374d6">subDisplayFile</a>() &lt;&lt; <span class="stringliteral">&quot;  unifiedIndexCountersAtAllProcs[&quot;</span> &lt;&lt; r &lt;&lt; <span class="stringliteral">&quot;] = &quot;</span> &lt;&lt; unifiedIndexCountersAtAllProcs[r]</div>
<div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;                              &lt;&lt; std::endl;</div>
<div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;    }</div>
<div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;  }</div>
<div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;<span class="preprocessor"></span>  <span class="comment">//for (unsigned int i = 0; i &lt; unifiedIndexCountersAtAllProcs.size(); ++i) {</span></div>
<div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;  <span class="comment">//  *m_env.subDisplayFile() &lt;&lt; &quot;unifiedIndexCountersAtAllProcs[&quot; &lt;&lt; i</span></div>
<div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;  <span class="comment">//                          &lt;&lt; &quot;] = &quot; &lt;&lt; unifiedIndexCountersAtAllProcs[i]</span></div>
<div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;  <span class="comment">//                          &lt;&lt; std::endl;</span></div>
<div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;  <span class="comment">//}</span></div>
<div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;</div>
<div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;  <span class="comment">// Use &#39;indexOfFirstWeight&#39; and &#39;indexOfLastWeight&#39; in order to update &#39;subNumSamples&#39;</span></div>
<div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;  <a class="code" href="_defines_8h.html#a56d63d18d0a6d45757de47fcc06f574d">UQ_FATAL_TEST_MACRO</a>(indexOfFirstWeight &gt;= unifiedIndexCountersAtAllProcs.size(),</div>
<div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;                      <a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#a78b57112bbd0e6dd0e8afec00b40ffa7">worldRank</a>(),</div>
<div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;                      <span class="stringliteral">&quot;MLSampling&lt;P_V,P_M&gt;::prepareUnbLinkedChains_inter0()&quot;</span>,</div>
<div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;                      <span class="stringliteral">&quot;invalid indexOfFirstWeight&quot;</span>);</div>
<div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;  <a class="code" href="_defines_8h.html#a56d63d18d0a6d45757de47fcc06f574d">UQ_FATAL_TEST_MACRO</a>(indexOfLastWeight &gt;= unifiedIndexCountersAtAllProcs.size(),</div>
<div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;                      <a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#a78b57112bbd0e6dd0e8afec00b40ffa7">worldRank</a>(),</div>
<div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;                      <span class="stringliteral">&quot;MLSampling&lt;P_V,P_M&gt;::prepareUnbLinkedChains_inter0()&quot;</span>,</div>
<div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;                      <span class="stringliteral">&quot;invalid indexOfLastWeight&quot;</span>);</div>
<div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;  subNumSamples = 0;</div>
<div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = indexOfFirstWeight; i &lt;= indexOfLastWeight; ++i) {</div>
<div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;    subNumSamples += unifiedIndexCountersAtAllProcs[i];</div>
<div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;  }</div>
<div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;</div>
<div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;  std::vector&lt;unsigned int&gt; auxBuf(1,0);</div>
<div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;</div>
<div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;  <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> minModifiedSubNumSamples = 0;</div>
<div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;  auxBuf[0] = subNumSamples;</div>
<div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;  <a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#a689e4d140c74d495d97eb498714a4b82">inter0Comm</a>().<a class="code" href="class_q_u_e_s_o_1_1_mpi_comm.html#a72e137e60ef8060efb1ee5fc874fa4b8">Allreduce</a>((<span class="keywordtype">void</span> *) &amp;auxBuf[0], (<span class="keywordtype">void</span> *) &amp;minModifiedSubNumSamples, (<span class="keywordtype">int</span>) auxBuf.size(), <a class="code" href="_mpi_comm_8h.html#a06cbfbc33436f6e0dc8a48ff3c49bdfc">RawValue_MPI_UNSIGNED</a>, <a class="code" href="_mpi_comm_8h.html#a8e30f42fdac116861205e83e2aa18042">RawValue_MPI_MIN</a>,</div>
<div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;                               <span class="stringliteral">&quot;MLSampling&lt;P_V,P_M&gt;::prepareUnbLinkedChains_inter0()&quot;</span>,</div>
<div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;                               <span class="stringliteral">&quot;failed MPI.Allreduce() for min&quot;</span>);</div>
<div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;</div>
<div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;  <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> maxModifiedSubNumSamples = 0;</div>
<div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;  auxBuf[0] = subNumSamples;</div>
<div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;  <a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#a689e4d140c74d495d97eb498714a4b82">inter0Comm</a>().<a class="code" href="class_q_u_e_s_o_1_1_mpi_comm.html#a72e137e60ef8060efb1ee5fc874fa4b8">Allreduce</a>((<span class="keywordtype">void</span> *) &amp;auxBuf[0], (<span class="keywordtype">void</span> *) &amp;maxModifiedSubNumSamples, (<span class="keywordtype">int</span>) auxBuf.size(), <a class="code" href="_mpi_comm_8h.html#a06cbfbc33436f6e0dc8a48ff3c49bdfc">RawValue_MPI_UNSIGNED</a>, <a class="code" href="_mpi_comm_8h.html#a68f3ac7ff71a6504e236b0c95de78178">RawValue_MPI_MAX</a>,</div>
<div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;                               <span class="stringliteral">&quot;MLSampling&lt;P_V,P_M&gt;::prepareUnbLinkedChains_inter0()&quot;</span>,</div>
<div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;                               <span class="stringliteral">&quot;failed MPI.Allreduce() for max&quot;</span>);</div>
<div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;</div>
<div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;  <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> sumModifiedSubNumSamples = 0;</div>
<div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;  auxBuf[0] = subNumSamples;</div>
<div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;  <a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#a689e4d140c74d495d97eb498714a4b82">inter0Comm</a>().<a class="code" href="class_q_u_e_s_o_1_1_mpi_comm.html#a72e137e60ef8060efb1ee5fc874fa4b8">Allreduce</a>((<span class="keywordtype">void</span> *) &amp;auxBuf[0], (<span class="keywordtype">void</span> *) &amp;sumModifiedSubNumSamples, (<span class="keywordtype">int</span>) auxBuf.size(), <a class="code" href="_mpi_comm_8h.html#a06cbfbc33436f6e0dc8a48ff3c49bdfc">RawValue_MPI_UNSIGNED</a>, <a class="code" href="_mpi_comm_8h.html#afbf78d291c032aa7f512bc566cee2bd1">RawValue_MPI_SUM</a>,</div>
<div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;                               <span class="stringliteral">&quot;MLSampling&lt;P_V,P_M&gt;::prepareUnbLinkedChains_inter0()&quot;</span>,</div>
<div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;                               <span class="stringliteral">&quot;failed MPI.Allreduce() for sum&quot;</span>);</div>
<div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;</div>
<div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;  <span class="comment">//UQ_FATAL_TEST_MACRO(unifiedRequestedNumSamples != sumModifiedSubNumSamples,</span></div>
<div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;  <span class="comment">//                    m_env.worldRank(),</span></div>
<div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;  <span class="comment">//                    &quot;MLSampling&lt;P_V,P_M&gt;::prepareUnbLinkedChains_inter0()&quot;,</span></div>
<div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;  <span class="comment">//                    &quot;invalid state&quot;);</span></div>
<div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;</div>
<div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;  <span class="keywordflow">if</span> ((<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#a8a0064746ae8dddfece4229b9ad374d6">subDisplayFile</a>()) &amp;&amp; (<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#a1fe5f244fc0316a0ab3e37463f108b96">displayVerbosity</a>() &gt;= 0)) {</div>
<div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;    *<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#a8a0064746ae8dddfece4229b9ad374d6">subDisplayFile</a>() &lt;&lt; <span class="stringliteral">&quot;KEY Leaving MLSampling&lt;P_V,P_M&gt;::prepareUnbLinkedChains_inter0()&quot;</span></div>
<div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;                            &lt;&lt; <span class="stringliteral">&quot;, level &quot;</span>                                   &lt;&lt; <a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#af9416874c856e50f3b35270e801f17e4">m_currLevel</a>+<a class="code" href="_m_l_sampling_level_options_8h.html#a68d15eaf394d210effcf584b938206d3">LEVEL_REF_ID</a></div>
<div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;                            &lt;&lt; <span class="stringliteral">&quot;, step &quot;</span>                                    &lt;&lt; <a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a1b1f8ccb4823bdfa26ec652f0807c63e">m_currStep</a></div>
<div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;                            &lt;&lt; <span class="stringliteral">&quot;: subNumSamples = &quot;</span>                         &lt;&lt; subNumSamples</div>
<div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;                            &lt;&lt; <span class="stringliteral">&quot;, unifiedIndexCountersAtAllProcs.size() = &quot;</span> &lt;&lt; unifiedIndexCountersAtAllProcs.size()</div>
<div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;                            &lt;&lt; std::endl;</div>
<div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;    *<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#a8a0064746ae8dddfece4229b9ad374d6">subDisplayFile</a>() &lt;&lt; <span class="stringliteral">&quot;KEY Leaving MLSampling&lt;P_V,P_M&gt;::prepareUnbLinkedChains_inter0()&quot;</span></div>
<div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;                            &lt;&lt; <span class="stringliteral">&quot;, level &quot;</span>                      &lt;&lt; <a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#af9416874c856e50f3b35270e801f17e4">m_currLevel</a>+<a class="code" href="_m_l_sampling_level_options_8h.html#a68d15eaf394d210effcf584b938206d3">LEVEL_REF_ID</a></div>
<div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;                            &lt;&lt; <span class="stringliteral">&quot;, step &quot;</span>                       &lt;&lt; <a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a1b1f8ccb4823bdfa26ec652f0807c63e">m_currStep</a></div>
<div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;                            &lt;&lt; <span class="stringliteral">&quot;: minModifiedSubNumSamples = &quot;</span> &lt;&lt; minModifiedSubNumSamples</div>
<div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;                            &lt;&lt; <span class="stringliteral">&quot;, avgModifiedSubNumSamples = &quot;</span> &lt;&lt; ((double) sumModifiedSubNumSamples)/((double) <a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#a689e4d140c74d495d97eb498714a4b82">inter0Comm</a>().<a class="code" href="class_q_u_e_s_o_1_1_mpi_comm.html#aa780721ae0fdeabc5a15e04cb0cad964">NumProc</a>())</div>
<div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;                            &lt;&lt; <span class="stringliteral">&quot;, maxModifiedSubNumSamples = &quot;</span> &lt;&lt; maxModifiedSubNumSamples</div>
<div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;                            &lt;&lt; std::endl;</div>
<div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;  }</div>
<div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;</div>
<div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;  <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> numberOfPositionsToGuaranteeForNode = subNumSamples;</div>
<div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;  <span class="keywordflow">if</span> ((<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#a8a0064746ae8dddfece4229b9ad374d6">subDisplayFile</a>()) &amp;&amp; (<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#a1fe5f244fc0316a0ab3e37463f108b96">displayVerbosity</a>() &gt;= 0)) {</div>
<div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;    *<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#a8a0064746ae8dddfece4229b9ad374d6">subDisplayFile</a>() &lt;&lt; <span class="stringliteral">&quot;KEY In MLSampling&lt;P_V,P_M&gt;::prepareUnbLinkedChains_inter0()&quot;</span></div>
<div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;                            &lt;&lt; <span class="stringliteral">&quot;, level &quot;</span>                                 &lt;&lt; <a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#af9416874c856e50f3b35270e801f17e4">m_currLevel</a>+<a class="code" href="_m_l_sampling_level_options_8h.html#a68d15eaf394d210effcf584b938206d3">LEVEL_REF_ID</a></div>
<div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160;                            &lt;&lt; <span class="stringliteral">&quot;, step &quot;</span>                                  &lt;&lt; <a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a1b1f8ccb4823bdfa26ec652f0807c63e">m_currStep</a></div>
<div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;                            &lt;&lt; <span class="stringliteral">&quot;: numberOfPositionsToGuaranteeForNode = &quot;</span> &lt;&lt; numberOfPositionsToGuaranteeForNode</div>
<div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;                            &lt;&lt; std::endl;</div>
<div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160;  }</div>
<div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = indexOfFirstWeight; i &lt;= indexOfLastWeight; ++i) {</div>
<div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;<span class="comment">//for (unsigned int i = 0; i &lt; unifiedIndexCountersAtAllProcs.size(); ++i) { // KAUST4: important</span></div>
<div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;    <span class="keywordflow">while</span> (unifiedIndexCountersAtAllProcs[i] != 0) {</div>
<div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;      <span class="keywordflow">if</span> ((<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#a8a0064746ae8dddfece4229b9ad374d6">subDisplayFile</a>()) &amp;&amp; (<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#a1fe5f244fc0316a0ab3e37463f108b96">displayVerbosity</a>() &gt;= 30)) {</div>
<div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160;        *<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#a8a0064746ae8dddfece4229b9ad374d6">subDisplayFile</a>() &lt;&lt; <span class="stringliteral">&quot;, numberOfPositionsToGuaranteeForNode = &quot;</span> &lt;&lt; numberOfPositionsToGuaranteeForNode</div>
<div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160;                                &lt;&lt; <span class="stringliteral">&quot;, unifiedIndexCountersAtAllProcs[&quot;</span>        &lt;&lt; i</div>
<div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160;                                &lt;&lt; <span class="stringliteral">&quot;] = &quot;</span>                                     &lt;&lt; unifiedIndexCountersAtAllProcs[i]</div>
<div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160;                                &lt;&lt; std::endl;</div>
<div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160;      }</div>
<div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;      <span class="keywordflow">if</span> (unifiedIndexCountersAtAllProcs[i] &lt; numberOfPositionsToGuaranteeForNode) {</div>
<div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;        UnbalancedLinkedChainControlStruct auxControl;</div>
<div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;        auxControl.initialPositionIndexInPreviousChain = i;</div>
<div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160;        auxControl.numberOfPositions = unifiedIndexCountersAtAllProcs[i];</div>
<div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160;        unbalancedLinkControl.unbLinkedChains.push_back(auxControl);</div>
<div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160;</div>
<div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;        numberOfPositionsToGuaranteeForNode -= unifiedIndexCountersAtAllProcs[i];</div>
<div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160;        unifiedIndexCountersAtAllProcs[i] = 0;</div>
<div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160;      }</div>
<div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160;      <span class="keywordflow">else</span> <span class="keywordflow">if</span> ((unifiedIndexCountersAtAllProcs[i] == numberOfPositionsToGuaranteeForNode) &amp;&amp;</div>
<div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160;               (unifiedIndexCountersAtAllProcs[i] &gt; 0                                   )) {</div>
<div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160;      <span class="comment">//else { // KAUST4</span></div>
<div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160;        UnbalancedLinkedChainControlStruct auxControl;</div>
<div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160;        auxControl.initialPositionIndexInPreviousChain = i;</div>
<div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160;        auxControl.numberOfPositions = numberOfPositionsToGuaranteeForNode;</div>
<div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160;        unbalancedLinkControl.unbLinkedChains.push_back(auxControl);</div>
<div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;</div>
<div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160;        unifiedIndexCountersAtAllProcs[i] -= numberOfPositionsToGuaranteeForNode;</div>
<div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160;        numberOfPositionsToGuaranteeForNode = 0;</div>
<div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160;      }</div>
<div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160;      <span class="keywordflow">else</span> <span class="keywordflow">if</span> ((unifiedIndexCountersAtAllProcs[i] == numberOfPositionsToGuaranteeForNode) &amp;&amp;</div>
<div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160;               (unifiedIndexCountersAtAllProcs[i] == 0                                  )) {</div>
<div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160;        <span class="comment">// Ok</span></div>
<div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160;      }</div>
<div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160;      <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160;        <a class="code" href="_defines_8h.html#a56d63d18d0a6d45757de47fcc06f574d">UQ_FATAL_TEST_MACRO</a>(<span class="keyword">true</span>, <span class="comment">// KAUST4</span></div>
<div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160;                            <a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#a78b57112bbd0e6dd0e8afec00b40ffa7">worldRank</a>(),</div>
<div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;                            <span class="stringliteral">&quot;MLSampling&lt;P_V,P_M&gt;::prepareUnbLinkedChains_inter0()&quot;</span>,</div>
<div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160;                            <span class="stringliteral">&quot;should never get here&quot;</span>);</div>
<div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160;      }</div>
<div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160;    }</div>
<div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160;  }</div>
<div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160;  <a class="code" href="_defines_8h.html#a56d63d18d0a6d45757de47fcc06f574d">UQ_FATAL_TEST_MACRO</a>(numberOfPositionsToGuaranteeForNode != 0, <span class="comment">// subNumSamples, // KAUST4</span></div>
<div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160;                      <a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#a78b57112bbd0e6dd0e8afec00b40ffa7">worldRank</a>(),</div>
<div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160;                      <span class="stringliteral">&quot;MLSampling&lt;P_V,P_M&gt;::prepareUnbLinkedChains_inter0()&quot;</span>,</div>
<div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160;                      <span class="stringliteral">&quot;numberOfPositionsToGuaranteeForNode exited loop with wrong value&quot;</span>);</div>
<div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160;  <span class="comment">// FIX ME: swap trick to save memory</span></div>
<div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160;</div>
<div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160;  <span class="keywordflow">if</span> ((<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#a8a0064746ae8dddfece4229b9ad374d6">subDisplayFile</a>()) &amp;&amp; (<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#a1fe5f244fc0316a0ab3e37463f108b96">displayVerbosity</a>() &gt;= 0)) {</div>
<div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160;    *<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#a8a0064746ae8dddfece4229b9ad374d6">subDisplayFile</a>() &lt;&lt; <span class="stringliteral">&quot;KEY Leaving MLSampling&lt;P_V,P_M&gt;::prepareUnbLinkedChains_inter0()&quot;</span></div>
<div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160;                            &lt;&lt; <span class="stringliteral">&quot;, level &quot;</span>                                          &lt;&lt; <a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#af9416874c856e50f3b35270e801f17e4">m_currLevel</a>+<a class="code" href="_m_l_sampling_level_options_8h.html#a68d15eaf394d210effcf584b938206d3">LEVEL_REF_ID</a></div>
<div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160;                            &lt;&lt; <span class="stringliteral">&quot;, step &quot;</span>                                           &lt;&lt; <a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a1b1f8ccb4823bdfa26ec652f0807c63e">m_currStep</a></div>
<div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160;                            &lt;&lt; <span class="stringliteral">&quot;: unbalancedLinkControl.unbLinkedChains.size() = &quot;</span> &lt;&lt; unbalancedLinkControl.unbLinkedChains.size()</div>
<div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160;                            &lt;&lt; std::endl;</div>
<div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160;  }</div>
<div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160;</div>
<div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160;  <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160;}</div>
<div class="ttc" id="class_q_u_e_s_o_1_1_m_l_sampling_html_a13f1ca4fe9f94822fe572a743eaced1d"><div class="ttname"><a href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">QUESO::MLSampling::m_env</a></div><div class="ttdeci">const BaseEnvironment &amp; m_env</div><div class="ttdoc">Queso enviroment. </div><div class="ttdef"><b>Definition:</b> <a href="_m_l_sampling_8h_source.html#l00442">MLSampling.h:442</a></div></div>
<div class="ttc" id="_mpi_comm_8h_html_afbf78d291c032aa7f512bc566cee2bd1"><div class="ttname"><a href="_mpi_comm_8h.html#afbf78d291c032aa7f512bc566cee2bd1">RawValue_MPI_SUM</a></div><div class="ttdeci">#define RawValue_MPI_SUM</div><div class="ttdef"><b>Definition:</b> <a href="_mpi_comm_8h_source.html#l00052">MpiComm.h:52</a></div></div>
<div class="ttc" id="class_q_u_e_s_o_1_1_mpi_comm_html_aa780721ae0fdeabc5a15e04cb0cad964"><div class="ttname"><a href="class_q_u_e_s_o_1_1_mpi_comm.html#aa780721ae0fdeabc5a15e04cb0cad964">QUESO::MpiComm::NumProc</a></div><div class="ttdeci">int NumProc() const </div><div class="ttdoc">Returns total number of processes. </div><div class="ttdef"><b>Definition:</b> <a href="_mpi_comm_8_c_source.html#l00121">MpiComm.C:121</a></div></div>
<div class="ttc" id="class_q_u_e_s_o_1_1_base_environment_html_a78b57112bbd0e6dd0e8afec00b40ffa7"><div class="ttname"><a href="class_q_u_e_s_o_1_1_base_environment.html#a78b57112bbd0e6dd0e8afec00b40ffa7">QUESO::BaseEnvironment::worldRank</a></div><div class="ttdeci">int worldRank() const </div><div class="ttdoc">Returns the process world rank. </div><div class="ttdef"><b>Definition:</b> <a href="_environment_8_c_source.html#l00235">Environment.C:235</a></div></div>
<div class="ttc" id="class_q_u_e_s_o_1_1_m_l_sampling_html_af9416874c856e50f3b35270e801f17e4"><div class="ttname"><a href="class_q_u_e_s_o_1_1_m_l_sampling.html#af9416874c856e50f3b35270e801f17e4">QUESO::MLSampling::m_currLevel</a></div><div class="ttdeci">unsigned int m_currLevel</div><div class="ttdoc">Current level. </div><div class="ttdef"><b>Definition:</b> <a href="_m_l_sampling_8h_source.html#l00464">MLSampling.h:464</a></div></div>
<div class="ttc" id="_m_l_sampling_level_options_8h_html_a68d15eaf394d210effcf584b938206d3"><div class="ttname"><a href="_m_l_sampling_level_options_8h.html#a68d15eaf394d210effcf584b938206d3">LEVEL_REF_ID</a></div><div class="ttdeci">#define LEVEL_REF_ID</div><div class="ttdef"><b>Definition:</b> <a href="_m_l_sampling_level_options_8h_source.html#l00028">MLSamplingLevelOptions.h:28</a></div></div>
<div class="ttc" id="_mpi_comm_8h_html_a68f3ac7ff71a6504e236b0c95de78178"><div class="ttname"><a href="_mpi_comm_8h.html#a68f3ac7ff71a6504e236b0c95de78178">RawValue_MPI_MAX</a></div><div class="ttdeci">#define RawValue_MPI_MAX</div><div class="ttdef"><b>Definition:</b> <a href="_mpi_comm_8h_source.html#l00051">MpiComm.h:51</a></div></div>
<div class="ttc" id="class_q_u_e_s_o_1_1_mpi_comm_html_abd6af8db8b0c7fd2f5b62e26477a9537"><div class="ttname"><a href="class_q_u_e_s_o_1_1_mpi_comm.html#abd6af8db8b0c7fd2f5b62e26477a9537">QUESO::MpiComm::Bcast</a></div><div class="ttdeci">void Bcast(void *buffer, int count, RawType_MPI_Datatype datatype, int root, const char *whereMsg, const char *whatMsg) const </div><div class="ttdoc">Broadcast values from the root process to the slave processes. </div><div class="ttdef"><b>Definition:</b> <a href="_mpi_comm_8_c_source.html#l00157">MpiComm.C:157</a></div></div>
<div class="ttc" id="class_q_u_e_s_o_1_1_base_environment_html_ae106b5bb8a80b655b88b3a26b1e7c185"><div class="ttname"><a href="class_q_u_e_s_o_1_1_base_environment.html#ae106b5bb8a80b655b88b3a26b1e7c185">QUESO::BaseEnvironment::inter0Rank</a></div><div class="ttdeci">int inter0Rank() const </div><div class="ttdoc">Returns the process inter0 rank. </div><div class="ttdef"><b>Definition:</b> <a href="_environment_8_c_source.html#l00289">Environment.C:289</a></div></div>
<div class="ttc" id="class_q_u_e_s_o_1_1_mpi_comm_html_a72e137e60ef8060efb1ee5fc874fa4b8"><div class="ttname"><a href="class_q_u_e_s_o_1_1_mpi_comm.html#a72e137e60ef8060efb1ee5fc874fa4b8">QUESO::MpiComm::Allreduce</a></div><div class="ttdeci">void Allreduce(void *sendbuf, void *recvbuf, int count, RawType_MPI_Datatype datatype, RawType_MPI_Op op, const char *whereMsg, const char *whatMsg) const </div><div class="ttdoc">Combines values from all processes and distributes the result back to all processes. </div><div class="ttdef"><b>Definition:</b> <a href="_mpi_comm_8_c_source.html#l00131">MpiComm.C:131</a></div></div>
<div class="ttc" id="_defines_8h_html_a56d63d18d0a6d45757de47fcc06f574d"><div class="ttname"><a href="_defines_8h.html#a56d63d18d0a6d45757de47fcc06f574d">UQ_FATAL_TEST_MACRO</a></div><div class="ttdeci">#define UQ_FATAL_TEST_MACRO(test, givenRank, where, what)</div><div class="ttdef"><b>Definition:</b> <a href="_defines_8h_source.html#l00222">Defines.h:222</a></div></div>
<div class="ttc" id="_mpi_comm_8h_html_a06cbfbc33436f6e0dc8a48ff3c49bdfc"><div class="ttname"><a href="_mpi_comm_8h.html#a06cbfbc33436f6e0dc8a48ff3c49bdfc">RawValue_MPI_UNSIGNED</a></div><div class="ttdeci">#define RawValue_MPI_UNSIGNED</div><div class="ttdef"><b>Definition:</b> <a href="_mpi_comm_8h_source.html#l00049">MpiComm.h:49</a></div></div>
<div class="ttc" id="class_q_u_e_s_o_1_1_m_l_sampling_html_a1b1f8ccb4823bdfa26ec652f0807c63e"><div class="ttname"><a href="class_q_u_e_s_o_1_1_m_l_sampling.html#a1b1f8ccb4823bdfa26ec652f0807c63e">QUESO::MLSampling::m_currStep</a></div><div class="ttdeci">unsigned int m_currStep</div><div class="ttdoc">Curret step. </div><div class="ttdef"><b>Definition:</b> <a href="_m_l_sampling_8h_source.html#l00467">MLSampling.h:467</a></div></div>
<div class="ttc" id="_mpi_comm_8h_html_a8e30f42fdac116861205e83e2aa18042"><div class="ttname"><a href="_mpi_comm_8h.html#a8e30f42fdac116861205e83e2aa18042">RawValue_MPI_MIN</a></div><div class="ttdeci">#define RawValue_MPI_MIN</div><div class="ttdef"><b>Definition:</b> <a href="_mpi_comm_8h_source.html#l00050">MpiComm.h:50</a></div></div>
<div class="ttc" id="class_q_u_e_s_o_1_1_base_environment_html_a1fe5f244fc0316a0ab3e37463f108b96"><div class="ttname"><a href="class_q_u_e_s_o_1_1_base_environment.html#a1fe5f244fc0316a0ab3e37463f108b96">QUESO::BaseEnvironment::displayVerbosity</a></div><div class="ttdeci">unsigned int displayVerbosity() const </div><div class="ttdef"><b>Definition:</b> <a href="_environment_8_c_source.html#l00436">Environment.C:436</a></div></div>
<div class="ttc" id="class_q_u_e_s_o_1_1_base_environment_html_a8a0064746ae8dddfece4229b9ad374d6"><div class="ttname"><a href="class_q_u_e_s_o_1_1_base_environment.html#a8a0064746ae8dddfece4229b9ad374d6">QUESO::BaseEnvironment::subDisplayFile</a></div><div class="ttdeci">std::ofstream * subDisplayFile() const </div><div class="ttdoc">Access function for m_subDisplayFile (displays file on stream). </div><div class="ttdef"><b>Definition:</b> <a href="_environment_8_c_source.html#l00305">Environment.C:305</a></div></div>
<div class="ttc" id="class_q_u_e_s_o_1_1_base_environment_html_a689e4d140c74d495d97eb498714a4b82"><div class="ttname"><a href="class_q_u_e_s_o_1_1_base_environment.html#a689e4d140c74d495d97eb498714a4b82">QUESO::BaseEnvironment::inter0Comm</a></div><div class="ttdeci">const MpiComm &amp; inter0Comm() const </div><div class="ttdoc">Access function for MpiComm inter0-communicator. </div><div class="ttdef"><b>Definition:</b> <a href="_environment_8_c_source.html#l00295">Environment.C:295</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="aec103dbc7af1af9e982d8c162033e77b"></a>
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;class P_V, class P_M&gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="class_q_u_e_s_o_1_1_m_l_sampling.html">QUESO::MLSampling</a>&lt; P_V, P_M &gt;::print </td>
          <td>(</td>
          <td class="paramtype">std::ostream &amp;&#160;</td>
          <td class="paramname"><em>os</em></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>TODO: Prints the sequence. </p>
<dl class="todo"><dt><b><a class="el" href="todo.html#_todo000039">Todo:</a></b></dt><dd>: implement me! </dd></dl>

</div>
</div>
<a class="anchor" id="aa387be291dd763ce001ea769e87266c4"></a>
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;class P_V , class P_M &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="class_q_u_e_s_o_1_1_m_l_sampling.html">QUESO::MLSampling</a>&lt; P_V, P_M &gt;::restartML </td>
          <td>(</td>
          <td class="paramtype">double &amp;&#160;</td>
          <td class="paramname"><em>currExponent</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double &amp;&#160;</td>
          <td class="paramname"><em>currEta</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_q_u_e_s_o_1_1_sequence_of_vectors.html">SequenceOfVectors</a>&lt; P_V, P_M &gt; &amp;&#160;</td>
          <td class="paramname"><em>currChain</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_q_u_e_s_o_1_1_scalar_sequence.html">ScalarSequence</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>currLogLikelihoodValues</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_q_u_e_s_o_1_1_scalar_sequence.html">ScalarSequence</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>currLogTargetValues</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Restarts ML algorithm. </p>
<p>This method reads the control file and determines the number of lines on it; then it reads the stored values, calls MPI_Bcast and processes the read data in all available MPI nodes.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[out]</td><td class="paramname">currExponent,currEta,currChain,currLogLikelihoodValues,currLogTargetValues.</td><td></td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="_m_l_sampling_8_c_source.html#l02149">2149</a> of file <a class="el" href="_m_l_sampling_8_c_source.html">MLSampling.C</a>.</p>

<p>References <a class="el" href="_m_l_sampling_level_options_8h_source.html#l00028">LEVEL_REF_ID</a>, <a class="el" href="_m_l_sampling_8h_source.html#l00046">ML_CHECKPOINT_FIXED_AMOUNT_OF_DATA</a>, <a class="el" href="_mpi_comm_8h_source.html#l00048">RawValue_MPI_DOUBLE</a>, <a class="el" href="_mpi_comm_8h_source.html#l00049">RawValue_MPI_UNSIGNED</a>, <a class="el" href="_sequence_of_vectors_8_c_source.html#l01760">QUESO::SequenceOfVectors&lt; V, M &gt;::unifiedReadContents()</a>, <a class="el" href="_scalar_sequence_8_c_source.html#l03006">QUESO::ScalarSequence&lt; T &gt;::unifiedReadContents()</a>, and <a class="el" href="_defines_8h_source.html#l00222">UQ_FATAL_TEST_MACRO</a>.</p>
<div class="fragment"><div class="line"><a name="l02155"></a><span class="lineno"> 2155</span>&#160;{</div>
<div class="line"><a name="l02156"></a><span class="lineno"> 2156</span>&#160;  <span class="keywordflow">if</span> ((<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#a8a0064746ae8dddfece4229b9ad374d6">subDisplayFile</a>()) &amp;&amp; (<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#a1fe5f244fc0316a0ab3e37463f108b96">displayVerbosity</a>() &gt;= 2)) {</div>
<div class="line"><a name="l02157"></a><span class="lineno"> 2157</span>&#160;    *<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#a8a0064746ae8dddfece4229b9ad374d6">subDisplayFile</a>() &lt;&lt; <span class="stringliteral">&quot;\n RESTARTING initiating at level &quot;</span> &lt;&lt; <a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#af9416874c856e50f3b35270e801f17e4">m_currLevel</a></div>
<div class="line"><a name="l02158"></a><span class="lineno"> 2158</span>&#160;                            &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l02159"></a><span class="lineno"> 2159</span>&#160;  }</div>
<div class="line"><a name="l02160"></a><span class="lineno"> 2160</span>&#160;</div>
<div class="line"><a name="l02161"></a><span class="lineno"> 2161</span>&#160;  <span class="comment">//******************************************************************************</span></div>
<div class="line"><a name="l02162"></a><span class="lineno"> 2162</span>&#160;  <span class="comment">// Read &#39;control&#39; file</span></div>
<div class="line"><a name="l02163"></a><span class="lineno"> 2163</span>&#160;  <span class="comment">//******************************************************************************</span></div>
<div class="line"><a name="l02164"></a><span class="lineno"> 2164</span>&#160;  <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> vectorSpaceDim  = 0;</div>
<div class="line"><a name="l02165"></a><span class="lineno"> 2165</span>&#160;  <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> quantity1       = 0;</div>
<div class="line"><a name="l02166"></a><span class="lineno"> 2166</span>&#160;  std::string  checkingString(<span class="stringliteral">&quot;&quot;</span>);</div>
<div class="line"><a name="l02167"></a><span class="lineno"> 2167</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#a84a239e42ae443cf71db6e03e8159620">fullRank</a>() == 0) {</div>
<div class="line"><a name="l02168"></a><span class="lineno"> 2168</span>&#160;    std::ifstream* ifsVar = <span class="keyword">new</span> std::ifstream((<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#af8504cc57ec72b3c52833826b2bfff8e">m_options</a>.m_restartInput_baseNameForFiles + <span class="stringliteral">&quot;Control.txt&quot;</span>).c_str(),</div>
<div class="line"><a name="l02169"></a><span class="lineno"> 2169</span>&#160;                                              std::ifstream::in);</div>
<div class="line"><a name="l02170"></a><span class="lineno"> 2170</span>&#160;</div>
<div class="line"><a name="l02171"></a><span class="lineno"> 2171</span>&#160;    <span class="comment">//******************************************************************************</span></div>
<div class="line"><a name="l02172"></a><span class="lineno"> 2172</span>&#160;    <span class="comment">// Determine number of lines</span></div>
<div class="line"><a name="l02173"></a><span class="lineno"> 2173</span>&#160;    <span class="comment">//******************************************************************************</span></div>
<div class="line"><a name="l02174"></a><span class="lineno"> 2174</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> numLines = std::count(std::istreambuf_iterator&lt;char&gt;(*ifsVar),</div>
<div class="line"><a name="l02175"></a><span class="lineno"> 2175</span>&#160;                                       std::istreambuf_iterator&lt;char&gt;(),</div>
<div class="line"><a name="l02176"></a><span class="lineno"> 2176</span>&#160;                                       <span class="charliteral">&#39;\n&#39;</span>);</div>
<div class="line"><a name="l02177"></a><span class="lineno"> 2177</span>&#160;    ifsVar-&gt;seekg(0,std::ios_base::beg);</div>
<div class="line"><a name="l02178"></a><span class="lineno"> 2178</span>&#160;    <span class="keywordflow">if</span> ((<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#a8a0064746ae8dddfece4229b9ad374d6">subDisplayFile</a>()) &amp;&amp; (<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#a1fe5f244fc0316a0ab3e37463f108b96">displayVerbosity</a>() &gt;= 2)) {</div>
<div class="line"><a name="l02179"></a><span class="lineno"> 2179</span>&#160;      *<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#a8a0064746ae8dddfece4229b9ad374d6">subDisplayFile</a>() &lt;&lt; <span class="stringliteral">&quot;Restart input file has &quot;</span> &lt;&lt; numLines</div>
<div class="line"><a name="l02180"></a><span class="lineno"> 2180</span>&#160;                              &lt;&lt; <span class="stringliteral">&quot; lines&quot;</span></div>
<div class="line"><a name="l02181"></a><span class="lineno"> 2181</span>&#160;                              &lt;&lt; std::endl;</div>
<div class="line"><a name="l02182"></a><span class="lineno"> 2182</span>&#160;    }</div>
<div class="line"><a name="l02183"></a><span class="lineno"> 2183</span>&#160;</div>
<div class="line"><a name="l02184"></a><span class="lineno"> 2184</span>&#160;    <span class="comment">//******************************************************************************</span></div>
<div class="line"><a name="l02185"></a><span class="lineno"> 2185</span>&#160;    <span class="comment">// Read all values</span></div>
<div class="line"><a name="l02186"></a><span class="lineno"> 2186</span>&#160;    <span class="comment">//******************************************************************************</span></div>
<div class="line"><a name="l02187"></a><span class="lineno"> 2187</span>&#160;    *ifsVar &gt;&gt; <a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#af9416874c856e50f3b35270e801f17e4">m_currLevel</a>; <span class="comment">// 1</span></div>
<div class="line"><a name="l02188"></a><span class="lineno"> 2188</span>&#160;    <a class="code" href="_defines_8h.html#a56d63d18d0a6d45757de47fcc06f574d">UQ_FATAL_TEST_MACRO</a>(numLines != (<a class="code" href="_m_l_sampling_8h.html#a6c830698381e4aa1c55b3b418754ae4b">ML_CHECKPOINT_FIXED_AMOUNT_OF_DATA</a> + m_currLevel),</div>
<div class="line"><a name="l02189"></a><span class="lineno"> 2189</span>&#160;                        <a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#a84a239e42ae443cf71db6e03e8159620">fullRank</a>(),</div>
<div class="line"><a name="l02190"></a><span class="lineno"> 2190</span>&#160;                        <span class="stringliteral">&quot;MLSampling&lt;P_V,P_M&gt;::restartML()&quot;</span>,</div>
<div class="line"><a name="l02191"></a><span class="lineno"> 2191</span>&#160;                        <span class="stringliteral">&quot;number of lines read is different than pre-established number of lines in control file&quot;</span>);</div>
<div class="line"><a name="l02192"></a><span class="lineno"> 2192</span>&#160;</div>
<div class="line"><a name="l02193"></a><span class="lineno"> 2193</span>&#160;    <a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a75f2ceab4a2c6774b3fa07d74221dbf3">m_logEvidenceFactors</a>.clear();</div>
<div class="line"><a name="l02194"></a><span class="lineno"> 2194</span>&#160;    <a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a75f2ceab4a2c6774b3fa07d74221dbf3">m_logEvidenceFactors</a>.resize(m_currLevel,0.);</div>
<div class="line"><a name="l02195"></a><span class="lineno"> 2195</span>&#160;    *ifsVar &gt;&gt; vectorSpaceDim  <span class="comment">// 2</span></div>
<div class="line"><a name="l02196"></a><span class="lineno"> 2196</span>&#160;            &gt;&gt; currExponent    <span class="comment">// 3</span></div>
<div class="line"><a name="l02197"></a><span class="lineno"> 2197</span>&#160;            &gt;&gt; currEta         <span class="comment">// 4</span></div>
<div class="line"><a name="l02198"></a><span class="lineno"> 2198</span>&#160;            &gt;&gt; quantity1;      <span class="comment">// 5</span></div>
<div class="line"><a name="l02199"></a><span class="lineno"> 2199</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a75f2ceab4a2c6774b3fa07d74221dbf3">m_logEvidenceFactors</a>.size(); ++i) {</div>
<div class="line"><a name="l02200"></a><span class="lineno"> 2200</span>&#160;      *ifsVar &gt;&gt; <a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a75f2ceab4a2c6774b3fa07d74221dbf3">m_logEvidenceFactors</a>[i];</div>
<div class="line"><a name="l02201"></a><span class="lineno"> 2201</span>&#160;    }</div>
<div class="line"><a name="l02202"></a><span class="lineno"> 2202</span>&#160;    *ifsVar &gt;&gt; checkingString; <span class="comment">// 6 = ML_CHECKPOINT_FIXED_AMOUNT_OF_DATA</span></div>
<div class="line"><a name="l02203"></a><span class="lineno"> 2203</span>&#160;    <a class="code" href="_defines_8h.html#a56d63d18d0a6d45757de47fcc06f574d">UQ_FATAL_TEST_MACRO</a>(checkingString != <span class="stringliteral">&quot;COMPLETE&quot;</span>,</div>
<div class="line"><a name="l02204"></a><span class="lineno"> 2204</span>&#160;                        <a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#a84a239e42ae443cf71db6e03e8159620">fullRank</a>(),</div>
<div class="line"><a name="l02205"></a><span class="lineno"> 2205</span>&#160;                        <span class="stringliteral">&quot;MLSampling&lt;P_V,P_M&gt;::restartML()&quot;</span>,</div>
<div class="line"><a name="l02206"></a><span class="lineno"> 2206</span>&#160;                        <span class="stringliteral">&quot;control txt input file is not complete&quot;</span>);</div>
<div class="line"><a name="l02207"></a><span class="lineno"> 2207</span>&#160;</div>
<div class="line"><a name="l02208"></a><span class="lineno"> 2208</span>&#160;    <span class="keywordflow">if</span> ((<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#a8a0064746ae8dddfece4229b9ad374d6">subDisplayFile</a>()) &amp;&amp; (<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#a1fe5f244fc0316a0ab3e37463f108b96">displayVerbosity</a>() &gt;= 2)) {</div>
<div class="line"><a name="l02209"></a><span class="lineno"> 2209</span>&#160;      *<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#a8a0064746ae8dddfece4229b9ad374d6">subDisplayFile</a>() &lt;&lt; <span class="stringliteral">&quot;Restart input file has the following information:&quot;</span></div>
<div class="line"><a name="l02210"></a><span class="lineno"> 2210</span>&#160;                              &lt;&lt; <span class="stringliteral">&quot;\n m_currLevel = &quot;</span>      &lt;&lt; m_currLevel</div>
<div class="line"><a name="l02211"></a><span class="lineno"> 2211</span>&#160;                              &lt;&lt; <span class="stringliteral">&quot;\n vectorSpaceDim = &quot;</span>   &lt;&lt; vectorSpaceDim</div>
<div class="line"><a name="l02212"></a><span class="lineno"> 2212</span>&#160;                              &lt;&lt; <span class="stringliteral">&quot;\n currExponent = &quot;</span>     &lt;&lt; currExponent</div>
<div class="line"><a name="l02213"></a><span class="lineno"> 2213</span>&#160;                              &lt;&lt; <span class="stringliteral">&quot;\n currEta = &quot;</span>          &lt;&lt; currEta</div>
<div class="line"><a name="l02214"></a><span class="lineno"> 2214</span>&#160;                              &lt;&lt; <span class="stringliteral">&quot;\n quantity1 = &quot;</span>        &lt;&lt; quantity1;</div>
<div class="line"><a name="l02215"></a><span class="lineno"> 2215</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a75f2ceab4a2c6774b3fa07d74221dbf3">m_logEvidenceFactors</a>.size(); ++i) {</div>
<div class="line"><a name="l02216"></a><span class="lineno"> 2216</span>&#160;        *<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#a8a0064746ae8dddfece4229b9ad374d6">subDisplayFile</a>() &lt;&lt; <span class="stringliteral">&quot;\n [&quot;</span> &lt;&lt; i &lt;&lt; <span class="stringliteral">&quot;] = &quot;</span> &lt;&lt; <a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a75f2ceab4a2c6774b3fa07d74221dbf3">m_logEvidenceFactors</a>[i];</div>
<div class="line"><a name="l02217"></a><span class="lineno"> 2217</span>&#160;      }</div>
<div class="line"><a name="l02218"></a><span class="lineno"> 2218</span>&#160;      *<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#a8a0064746ae8dddfece4229b9ad374d6">subDisplayFile</a>() &lt;&lt; std::endl;</div>
<div class="line"><a name="l02219"></a><span class="lineno"> 2219</span>&#160;    }</div>
<div class="line"><a name="l02220"></a><span class="lineno"> 2220</span>&#160;</div>
<div class="line"><a name="l02221"></a><span class="lineno"> 2221</span>&#160;<span class="preprocessor">#if 0 // For debug only</span></div>
<div class="line"><a name="l02222"></a><span class="lineno"> 2222</span>&#160;<span class="preprocessor"></span>    std::string tmpString;</div>
<div class="line"><a name="l02223"></a><span class="lineno"> 2223</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = 0; i &lt; 2; ++i) {</div>
<div class="line"><a name="l02224"></a><span class="lineno"> 2224</span>&#160;      *ifsVar &gt;&gt; tmpString;</div>
<div class="line"><a name="l02225"></a><span class="lineno"> 2225</span>&#160;      std::cout &lt;&lt; <span class="stringliteral">&quot;Just read &#39;&quot;</span> &lt;&lt; tmpString &lt;&lt; <span class="stringliteral">&quot;&#39;&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l02226"></a><span class="lineno"> 2226</span>&#160;    }</div>
<div class="line"><a name="l02227"></a><span class="lineno"> 2227</span>&#160;    <span class="keywordflow">while</span> ((lineId &lt; numLines) &amp;&amp; (ifsVar-&gt;eof() == <span class="keyword">false</span>)) {</div>
<div class="line"><a name="l02228"></a><span class="lineno"> 2228</span>&#160;    }</div>
<div class="line"><a name="l02229"></a><span class="lineno"> 2229</span>&#160;    ifsVar-&gt;ignore(maxCharsPerLine,<span class="charliteral">&#39;\n&#39;</span>);</div>
<div class="line"><a name="l02230"></a><span class="lineno"> 2230</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l02231"></a><span class="lineno"> 2231</span>&#160;<span class="preprocessor"></span></div>
<div class="line"><a name="l02232"></a><span class="lineno"> 2232</span>&#160;    <span class="keyword">delete</span> ifsVar;</div>
<div class="line"><a name="l02233"></a><span class="lineno"> 2233</span>&#160;  } <span class="comment">// if (m_env.fullRank() == 0)</span></div>
<div class="line"><a name="l02234"></a><span class="lineno"> 2234</span>&#160;  <a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#a0b0779b41ff304058856e97e1d16b4d4">fullComm</a>().<a class="code" href="class_q_u_e_s_o_1_1_mpi_comm.html#a4059971c30e023b272fccaa6aa00c426">Barrier</a>();</div>
<div class="line"><a name="l02235"></a><span class="lineno"> 2235</span>&#160;</div>
<div class="line"><a name="l02236"></a><span class="lineno"> 2236</span>&#160;  <span class="comment">//******************************************************************************</span></div>
<div class="line"><a name="l02237"></a><span class="lineno"> 2237</span>&#160;  <span class="comment">// MPI_Bcast &#39;m_currLevel&#39;</span></div>
<div class="line"><a name="l02238"></a><span class="lineno"> 2238</span>&#160;  <span class="comment">//******************************************************************************</span></div>
<div class="line"><a name="l02239"></a><span class="lineno"> 2239</span>&#160;  <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> tmpUint = (<span class="keywordtype">unsigned</span> int) m_currLevel;</div>
<div class="line"><a name="l02240"></a><span class="lineno"> 2240</span>&#160;  <a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#a0b0779b41ff304058856e97e1d16b4d4">fullComm</a>().<a class="code" href="class_q_u_e_s_o_1_1_mpi_comm.html#abd6af8db8b0c7fd2f5b62e26477a9537">Bcast</a>((<span class="keywordtype">void</span> *) &amp;tmpUint, (<span class="keywordtype">int</span>) 1, <a class="code" href="_mpi_comm_8h.html#a06cbfbc33436f6e0dc8a48ff3c49bdfc">RawValue_MPI_UNSIGNED</a>, 0, <span class="comment">// Yes, &#39;fullComm&#39;</span></div>
<div class="line"><a name="l02241"></a><span class="lineno"> 2241</span>&#160;                         <span class="stringliteral">&quot;MLSampling&lt;P_V,P_M&gt;::restartML()&quot;</span>,</div>
<div class="line"><a name="l02242"></a><span class="lineno"> 2242</span>&#160;                         <span class="stringliteral">&quot;failed MPI.Bcast() for m_currLevel&quot;</span>);</div>
<div class="line"><a name="l02243"></a><span class="lineno"> 2243</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#a84a239e42ae443cf71db6e03e8159620">fullRank</a>() != 0) {</div>
<div class="line"><a name="l02244"></a><span class="lineno"> 2244</span>&#160;    m_currLevel = tmpUint;</div>
<div class="line"><a name="l02245"></a><span class="lineno"> 2245</span>&#160;  }</div>
<div class="line"><a name="l02246"></a><span class="lineno"> 2246</span>&#160;</div>
<div class="line"><a name="l02247"></a><span class="lineno"> 2247</span>&#160;  <span class="comment">//******************************************************************************</span></div>
<div class="line"><a name="l02248"></a><span class="lineno"> 2248</span>&#160;  <span class="comment">// MPI_Bcast the rest of the information just read</span></div>
<div class="line"><a name="l02249"></a><span class="lineno"> 2249</span>&#160;  <span class="comment">//******************************************************************************</span></div>
<div class="line"><a name="l02250"></a><span class="lineno"> 2250</span>&#160;  std::vector&lt;double&gt; tmpData(<a class="code" href="_m_l_sampling_8h.html#a6c830698381e4aa1c55b3b418754ae4b">ML_CHECKPOINT_FIXED_AMOUNT_OF_DATA</a>-1+m_currLevel,0.);</div>
<div class="line"><a name="l02251"></a><span class="lineno"> 2251</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#a84a239e42ae443cf71db6e03e8159620">fullRank</a>() == 0) {</div>
<div class="line"><a name="l02252"></a><span class="lineno"> 2252</span>&#160;    tmpData[0] = vectorSpaceDim;</div>
<div class="line"><a name="l02253"></a><span class="lineno"> 2253</span>&#160;    tmpData[1] = currExponent;</div>
<div class="line"><a name="l02254"></a><span class="lineno"> 2254</span>&#160;    tmpData[2] = currEta;</div>
<div class="line"><a name="l02255"></a><span class="lineno"> 2255</span>&#160;    tmpData[3] = quantity1;</div>
<div class="line"><a name="l02256"></a><span class="lineno"> 2256</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a75f2ceab4a2c6774b3fa07d74221dbf3">m_logEvidenceFactors</a>.size(); ++i) {</div>
<div class="line"><a name="l02257"></a><span class="lineno"> 2257</span>&#160;      tmpData[4+i] = <a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a75f2ceab4a2c6774b3fa07d74221dbf3">m_logEvidenceFactors</a>[i];</div>
<div class="line"><a name="l02258"></a><span class="lineno"> 2258</span>&#160;    }</div>
<div class="line"><a name="l02259"></a><span class="lineno"> 2259</span>&#160;  }</div>
<div class="line"><a name="l02260"></a><span class="lineno"> 2260</span>&#160;  <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l02261"></a><span class="lineno"> 2261</span>&#160;    <a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a75f2ceab4a2c6774b3fa07d74221dbf3">m_logEvidenceFactors</a>.clear();</div>
<div class="line"><a name="l02262"></a><span class="lineno"> 2262</span>&#160;    <a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a75f2ceab4a2c6774b3fa07d74221dbf3">m_logEvidenceFactors</a>.resize(m_currLevel,0.);</div>
<div class="line"><a name="l02263"></a><span class="lineno"> 2263</span>&#160;  }</div>
<div class="line"><a name="l02264"></a><span class="lineno"> 2264</span>&#160;  <a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#a0b0779b41ff304058856e97e1d16b4d4">fullComm</a>().<a class="code" href="class_q_u_e_s_o_1_1_mpi_comm.html#abd6af8db8b0c7fd2f5b62e26477a9537">Bcast</a>((<span class="keywordtype">void</span> *) &amp;tmpData[0], (<span class="keywordtype">int</span>) tmpData.size(), <a class="code" href="_mpi_comm_8h.html#ad0f503bd9fecfe4e570ca3d15aaf2518">RawValue_MPI_DOUBLE</a>, 0, <span class="comment">// Yes, &#39;fullComm&#39;</span></div>
<div class="line"><a name="l02265"></a><span class="lineno"> 2265</span>&#160;                         <span class="stringliteral">&quot;MLSampling&lt;P_V,P_M&gt;::restartML()&quot;</span>,</div>
<div class="line"><a name="l02266"></a><span class="lineno"> 2266</span>&#160;                         <span class="stringliteral">&quot;failed MPI.Bcast() for rest of information read from input file&quot;</span>);</div>
<div class="line"><a name="l02267"></a><span class="lineno"> 2267</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#a84a239e42ae443cf71db6e03e8159620">fullRank</a>() != 0) {</div>
<div class="line"><a name="l02268"></a><span class="lineno"> 2268</span>&#160;    vectorSpaceDim = tmpData[0];</div>
<div class="line"><a name="l02269"></a><span class="lineno"> 2269</span>&#160;    currExponent   = tmpData[1];</div>
<div class="line"><a name="l02270"></a><span class="lineno"> 2270</span>&#160;    currEta        = tmpData[2];</div>
<div class="line"><a name="l02271"></a><span class="lineno"> 2271</span>&#160;    quantity1      = tmpData[3];</div>
<div class="line"><a name="l02272"></a><span class="lineno"> 2272</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a75f2ceab4a2c6774b3fa07d74221dbf3">m_logEvidenceFactors</a>.size(); ++i) {</div>
<div class="line"><a name="l02273"></a><span class="lineno"> 2273</span>&#160;      <a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a75f2ceab4a2c6774b3fa07d74221dbf3">m_logEvidenceFactors</a>[i] = tmpData[4+i];</div>
<div class="line"><a name="l02274"></a><span class="lineno"> 2274</span>&#160;    }</div>
<div class="line"><a name="l02275"></a><span class="lineno"> 2275</span>&#160;  }</div>
<div class="line"><a name="l02276"></a><span class="lineno"> 2276</span>&#160;</div>
<div class="line"><a name="l02277"></a><span class="lineno"> 2277</span>&#160;  <span class="comment">//******************************************************************************</span></div>
<div class="line"><a name="l02278"></a><span class="lineno"> 2278</span>&#160;  <span class="comment">// Process read data in all MPI nodes now</span></div>
<div class="line"><a name="l02279"></a><span class="lineno"> 2279</span>&#160;  <span class="comment">//******************************************************************************</span></div>
<div class="line"><a name="l02280"></a><span class="lineno"> 2280</span>&#160;  <a class="code" href="_defines_8h.html#a56d63d18d0a6d45757de47fcc06f574d">UQ_FATAL_TEST_MACRO</a>(vectorSpaceDim != <a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a7bc4c72f65ba9166ed94a6e198b0915b">m_vectorSpace</a>.<a class="code" href="class_q_u_e_s_o_1_1_vector_space.html#acd4359dc120905c22ca1064e33787239">dimGlobal</a>(),</div>
<div class="line"><a name="l02281"></a><span class="lineno"> 2281</span>&#160;                      <a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#a84a239e42ae443cf71db6e03e8159620">fullRank</a>(),</div>
<div class="line"><a name="l02282"></a><span class="lineno"> 2282</span>&#160;                      <span class="stringliteral">&quot;MLSampling&lt;P_V,P_M&gt;::restartML()&quot;</span>,</div>
<div class="line"><a name="l02283"></a><span class="lineno"> 2283</span>&#160;                      <span class="stringliteral">&quot;read vector space dimension is not consistent&quot;</span>);</div>
<div class="line"><a name="l02284"></a><span class="lineno"> 2284</span>&#160;  <a class="code" href="_defines_8h.html#a56d63d18d0a6d45757de47fcc06f574d">UQ_FATAL_TEST_MACRO</a>((currExponent &lt; 0.) || (currExponent &gt; 1.),</div>
<div class="line"><a name="l02285"></a><span class="lineno"> 2285</span>&#160;                      <a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#a84a239e42ae443cf71db6e03e8159620">fullRank</a>(),</div>
<div class="line"><a name="l02286"></a><span class="lineno"> 2286</span>&#160;                      <span class="stringliteral">&quot;MLSampling&lt;P_V,P_M&gt;::restartML()&quot;</span>,</div>
<div class="line"><a name="l02287"></a><span class="lineno"> 2287</span>&#160;                      <span class="stringliteral">&quot;read currExponent is not consistent&quot;</span>);</div>
<div class="line"><a name="l02288"></a><span class="lineno"> 2288</span>&#160;  <a class="code" href="_defines_8h.html#a56d63d18d0a6d45757de47fcc06f574d">UQ_FATAL_TEST_MACRO</a>((quantity1 % <a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#ac0345f57e31ef7833e379ed972bd094d">numSubEnvironments</a>()) != 0,</div>
<div class="line"><a name="l02289"></a><span class="lineno"> 2289</span>&#160;                      <a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#a84a239e42ae443cf71db6e03e8159620">fullRank</a>(),</div>
<div class="line"><a name="l02290"></a><span class="lineno"> 2290</span>&#160;                      <span class="stringliteral">&quot;MLSampling&lt;P_V,P_M&gt;::restartML()&quot;</span>,</div>
<div class="line"><a name="l02291"></a><span class="lineno"> 2291</span>&#160;                      <span class="stringliteral">&quot;read size of chain should be a multiple of the number of subenvironments&quot;</span>);</div>
<div class="line"><a name="l02292"></a><span class="lineno"> 2292</span>&#160;  <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> subSequenceSize = 0;</div>
<div class="line"><a name="l02293"></a><span class="lineno"> 2293</span>&#160;  subSequenceSize = ((double) quantity1) / ((double) <a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#ac0345f57e31ef7833e379ed972bd094d">numSubEnvironments</a>());</div>
<div class="line"><a name="l02294"></a><span class="lineno"> 2294</span>&#160;</div>
<div class="line"><a name="l02295"></a><span class="lineno"> 2295</span>&#160;  <span class="keywordflow">if</span> ((<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#a8a0064746ae8dddfece4229b9ad374d6">subDisplayFile</a>()) &amp;&amp; (<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#a1fe5f244fc0316a0ab3e37463f108b96">displayVerbosity</a>() &gt;= 2)) {</div>
<div class="line"><a name="l02296"></a><span class="lineno"> 2296</span>&#160;    *<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#a8a0064746ae8dddfece4229b9ad374d6">subDisplayFile</a>() &lt;&lt; <span class="stringliteral">&quot;Restart input file has the following information&quot;</span></div>
<div class="line"><a name="l02297"></a><span class="lineno"> 2297</span>&#160;                            &lt;&lt; <span class="stringliteral">&quot;: subSequenceSize = &quot;</span> &lt;&lt; subSequenceSize</div>
<div class="line"><a name="l02298"></a><span class="lineno"> 2298</span>&#160;                            &lt;&lt; std::endl;</div>
<div class="line"><a name="l02299"></a><span class="lineno"> 2299</span>&#160;  }</div>
<div class="line"><a name="l02300"></a><span class="lineno"> 2300</span>&#160;</div>
<div class="line"><a name="l02301"></a><span class="lineno"> 2301</span>&#160;  <span class="comment">//******************************************************************************</span></div>
<div class="line"><a name="l02302"></a><span class="lineno"> 2302</span>&#160;  <span class="comment">// Read three &#39;data&#39; files</span></div>
<div class="line"><a name="l02303"></a><span class="lineno"> 2303</span>&#160;  <span class="comment">//******************************************************************************</span></div>
<div class="line"><a name="l02304"></a><span class="lineno"> 2304</span>&#160;  <span class="keywordtype">char</span> levelSufix[256];</div>
<div class="line"><a name="l02305"></a><span class="lineno"> 2305</span>&#160;  sprintf(levelSufix,<span class="stringliteral">&quot;%d&quot;</span>,m_currLevel+<a class="code" href="_m_l_sampling_level_options_8h.html#a68d15eaf394d210effcf584b938206d3">LEVEL_REF_ID</a>); <span class="comment">// Yes, &#39;+0&#39;</span></div>
<div class="line"><a name="l02306"></a><span class="lineno"> 2306</span>&#160;</div>
<div class="line"><a name="l02307"></a><span class="lineno"> 2307</span>&#160;  <span class="keywordflow">if</span> ((<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#a8a0064746ae8dddfece4229b9ad374d6">subDisplayFile</a>()) &amp;&amp; (<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#a1fe5f244fc0316a0ab3e37463f108b96">displayVerbosity</a>() &gt;= 2)) {</div>
<div class="line"><a name="l02308"></a><span class="lineno"> 2308</span>&#160;    *<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#a8a0064746ae8dddfece4229b9ad374d6">subDisplayFile</a>() &lt;&lt; <span class="stringliteral">&quot;\n RESTARTING chain at level &quot;</span> &lt;&lt; m_currLevel</div>
<div class="line"><a name="l02309"></a><span class="lineno"> 2309</span>&#160;                            &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l02310"></a><span class="lineno"> 2310</span>&#160;  }</div>
<div class="line"><a name="l02311"></a><span class="lineno"> 2311</span>&#160;  currChain.unifiedReadContents(<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#af8504cc57ec72b3c52833826b2bfff8e">m_options</a>.m_restartInput_baseNameForFiles + <span class="stringliteral">&quot;Chain_l&quot;</span> + levelSufix,</div>
<div class="line"><a name="l02312"></a><span class="lineno"> 2312</span>&#160;                                <a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#af8504cc57ec72b3c52833826b2bfff8e">m_options</a>.m_restartInput_fileType,</div>
<div class="line"><a name="l02313"></a><span class="lineno"> 2313</span>&#160;                                subSequenceSize);</div>
<div class="line"><a name="l02314"></a><span class="lineno"> 2314</span>&#160;  <a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#a0b0779b41ff304058856e97e1d16b4d4">fullComm</a>().<a class="code" href="class_q_u_e_s_o_1_1_mpi_comm.html#a4059971c30e023b272fccaa6aa00c426">Barrier</a>();</div>
<div class="line"><a name="l02315"></a><span class="lineno"> 2315</span>&#160;</div>
<div class="line"><a name="l02316"></a><span class="lineno"> 2316</span>&#160;  <span class="keywordflow">if</span> ((<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#a8a0064746ae8dddfece4229b9ad374d6">subDisplayFile</a>()) &amp;&amp; (<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#a1fe5f244fc0316a0ab3e37463f108b96">displayVerbosity</a>() &gt;= 2)) {</div>
<div class="line"><a name="l02317"></a><span class="lineno"> 2317</span>&#160;    *<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#a8a0064746ae8dddfece4229b9ad374d6">subDisplayFile</a>() &lt;&lt; <span class="stringliteral">&quot;\n RESTARTING like at level &quot;</span> &lt;&lt; m_currLevel</div>
<div class="line"><a name="l02318"></a><span class="lineno"> 2318</span>&#160;                            &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l02319"></a><span class="lineno"> 2319</span>&#160;  }</div>
<div class="line"><a name="l02320"></a><span class="lineno"> 2320</span>&#160;  currLogLikelihoodValues.<a class="code" href="class_q_u_e_s_o_1_1_scalar_sequence.html#a6aaf13eda57e55b709d247cfd1ab22bc">unifiedReadContents</a>(<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#af8504cc57ec72b3c52833826b2bfff8e">m_options</a>.m_restartInput_baseNameForFiles + <span class="stringliteral">&quot;LogLike_l&quot;</span> + levelSufix,</div>
<div class="line"><a name="l02321"></a><span class="lineno"> 2321</span>&#160;                                              <a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#af8504cc57ec72b3c52833826b2bfff8e">m_options</a>.m_restartInput_fileType,</div>
<div class="line"><a name="l02322"></a><span class="lineno"> 2322</span>&#160;                                              subSequenceSize);</div>
<div class="line"><a name="l02323"></a><span class="lineno"> 2323</span>&#160;  <a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#a0b0779b41ff304058856e97e1d16b4d4">fullComm</a>().<a class="code" href="class_q_u_e_s_o_1_1_mpi_comm.html#a4059971c30e023b272fccaa6aa00c426">Barrier</a>();</div>
<div class="line"><a name="l02324"></a><span class="lineno"> 2324</span>&#160;</div>
<div class="line"><a name="l02325"></a><span class="lineno"> 2325</span>&#160;  <span class="keywordflow">if</span> ((<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#a8a0064746ae8dddfece4229b9ad374d6">subDisplayFile</a>()) &amp;&amp; (<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#a1fe5f244fc0316a0ab3e37463f108b96">displayVerbosity</a>() &gt;= 2)) {</div>
<div class="line"><a name="l02326"></a><span class="lineno"> 2326</span>&#160;    *<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#a8a0064746ae8dddfece4229b9ad374d6">subDisplayFile</a>() &lt;&lt; <span class="stringliteral">&quot;\n RESTARTING target at level &quot;</span> &lt;&lt; m_currLevel</div>
<div class="line"><a name="l02327"></a><span class="lineno"> 2327</span>&#160;                            &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l02328"></a><span class="lineno"> 2328</span>&#160;  }</div>
<div class="line"><a name="l02329"></a><span class="lineno"> 2329</span>&#160;  currLogTargetValues.<a class="code" href="class_q_u_e_s_o_1_1_scalar_sequence.html#a6aaf13eda57e55b709d247cfd1ab22bc">unifiedReadContents</a>(<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#af8504cc57ec72b3c52833826b2bfff8e">m_options</a>.m_restartInput_baseNameForFiles + <span class="stringliteral">&quot;LogTarget_l&quot;</span> + levelSufix,</div>
<div class="line"><a name="l02330"></a><span class="lineno"> 2330</span>&#160;                                          <a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#af8504cc57ec72b3c52833826b2bfff8e">m_options</a>.m_restartInput_fileType,</div>
<div class="line"><a name="l02331"></a><span class="lineno"> 2331</span>&#160;                                          subSequenceSize);</div>
<div class="line"><a name="l02332"></a><span class="lineno"> 2332</span>&#160;  <a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#a0b0779b41ff304058856e97e1d16b4d4">fullComm</a>().<a class="code" href="class_q_u_e_s_o_1_1_mpi_comm.html#a4059971c30e023b272fccaa6aa00c426">Barrier</a>();</div>
<div class="line"><a name="l02333"></a><span class="lineno"> 2333</span>&#160;</div>
<div class="line"><a name="l02334"></a><span class="lineno"> 2334</span>&#160;  <span class="keywordflow">if</span> ((<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#a8a0064746ae8dddfece4229b9ad374d6">subDisplayFile</a>()) &amp;&amp; (<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#a1fe5f244fc0316a0ab3e37463f108b96">displayVerbosity</a>() &gt;= 2)) {</div>
<div class="line"><a name="l02335"></a><span class="lineno"> 2335</span>&#160;    *<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#a8a0064746ae8dddfece4229b9ad374d6">subDisplayFile</a>() &lt;&lt; <span class="stringliteral">&quot;\n RESTARTING done at level &quot;</span> &lt;&lt; m_currLevel</div>
<div class="line"><a name="l02336"></a><span class="lineno"> 2336</span>&#160;                            &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l02337"></a><span class="lineno"> 2337</span>&#160;  }</div>
<div class="line"><a name="l02338"></a><span class="lineno"> 2338</span>&#160;</div>
<div class="line"><a name="l02339"></a><span class="lineno"> 2339</span>&#160;  <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l02340"></a><span class="lineno"> 2340</span>&#160;}</div>
<div class="ttc" id="class_q_u_e_s_o_1_1_base_environment_html_a84a239e42ae443cf71db6e03e8159620"><div class="ttname"><a href="class_q_u_e_s_o_1_1_base_environment.html#a84a239e42ae443cf71db6e03e8159620">QUESO::BaseEnvironment::fullRank</a></div><div class="ttdeci">int fullRank() const </div><div class="ttdoc">Returns the process full rank. </div><div class="ttdef"><b>Definition:</b> <a href="_environment_8_c_source.html#l00241">Environment.C:241</a></div></div>
<div class="ttc" id="class_q_u_e_s_o_1_1_m_l_sampling_html_a13f1ca4fe9f94822fe572a743eaced1d"><div class="ttname"><a href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">QUESO::MLSampling::m_env</a></div><div class="ttdeci">const BaseEnvironment &amp; m_env</div><div class="ttdoc">Queso enviroment. </div><div class="ttdef"><b>Definition:</b> <a href="_m_l_sampling_8h_source.html#l00442">MLSampling.h:442</a></div></div>
<div class="ttc" id="class_q_u_e_s_o_1_1_mpi_comm_html_a4059971c30e023b272fccaa6aa00c426"><div class="ttname"><a href="class_q_u_e_s_o_1_1_mpi_comm.html#a4059971c30e023b272fccaa6aa00c426">QUESO::MpiComm::Barrier</a></div><div class="ttdeci">void Barrier() const </div><div class="ttdoc">Pause every process in *this communicator until all the processes reach this point. </div><div class="ttdef"><b>Definition:</b> <a href="_mpi_comm_8_c_source.html#l00143">MpiComm.C:143</a></div></div>
<div class="ttc" id="class_q_u_e_s_o_1_1_base_environment_html_a0b0779b41ff304058856e97e1d16b4d4"><div class="ttname"><a href="class_q_u_e_s_o_1_1_base_environment.html#a0b0779b41ff304058856e97e1d16b4d4">QUESO::BaseEnvironment::fullComm</a></div><div class="ttdeci">const MpiComm &amp; fullComm() const </div><div class="ttdoc">Access function for MpiComm full communicator. </div><div class="ttdef"><b>Definition:</b> <a href="_environment_8_c_source.html#l00247">Environment.C:247</a></div></div>
<div class="ttc" id="class_q_u_e_s_o_1_1_m_l_sampling_html_a75f2ceab4a2c6774b3fa07d74221dbf3"><div class="ttname"><a href="class_q_u_e_s_o_1_1_m_l_sampling.html#a75f2ceab4a2c6774b3fa07d74221dbf3">QUESO::MLSampling::m_logEvidenceFactors</a></div><div class="ttdeci">std::vector&lt; double &gt; m_logEvidenceFactors</div><div class="ttdef"><b>Definition:</b> <a href="_m_l_sampling_8h_source.html#l00471">MLSampling.h:471</a></div></div>
<div class="ttc" id="class_q_u_e_s_o_1_1_m_l_sampling_html_af8504cc57ec72b3c52833826b2bfff8e"><div class="ttname"><a href="class_q_u_e_s_o_1_1_m_l_sampling.html#af8504cc57ec72b3c52833826b2bfff8e">QUESO::MLSampling::m_options</a></div><div class="ttdeci">MLSamplingOptions m_options</div><div class="ttdoc">Options for the ML algorithm. </div><div class="ttdef"><b>Definition:</b> <a href="_m_l_sampling_8h_source.html#l00461">MLSampling.h:461</a></div></div>
<div class="ttc" id="class_q_u_e_s_o_1_1_scalar_sequence_html_a6aaf13eda57e55b709d247cfd1ab22bc"><div class="ttname"><a href="class_q_u_e_s_o_1_1_scalar_sequence.html#a6aaf13eda57e55b709d247cfd1ab22bc">QUESO::ScalarSequence::unifiedReadContents</a></div><div class="ttdeci">void unifiedReadContents(const std::string &amp;fileName, const std::string &amp;fileType, const unsigned int subSequenceSize)</div><div class="ttdoc">Reads the unified sequence from a file. </div><div class="ttdef"><b>Definition:</b> <a href="_scalar_sequence_8_c_source.html#l03006">ScalarSequence.C:3006</a></div></div>
<div class="ttc" id="class_q_u_e_s_o_1_1_m_l_sampling_html_af9416874c856e50f3b35270e801f17e4"><div class="ttname"><a href="class_q_u_e_s_o_1_1_m_l_sampling.html#af9416874c856e50f3b35270e801f17e4">QUESO::MLSampling::m_currLevel</a></div><div class="ttdeci">unsigned int m_currLevel</div><div class="ttdoc">Current level. </div><div class="ttdef"><b>Definition:</b> <a href="_m_l_sampling_8h_source.html#l00464">MLSampling.h:464</a></div></div>
<div class="ttc" id="class_q_u_e_s_o_1_1_vector_space_html_acd4359dc120905c22ca1064e33787239"><div class="ttname"><a href="class_q_u_e_s_o_1_1_vector_space.html#acd4359dc120905c22ca1064e33787239">QUESO::VectorSpace::dimGlobal</a></div><div class="ttdeci">unsigned int dimGlobal() const </div><div class="ttdef"><b>Definition:</b> <a href="_vector_space_8_c_source.html#l00205">VectorSpace.C:205</a></div></div>
<div class="ttc" id="_m_l_sampling_level_options_8h_html_a68d15eaf394d210effcf584b938206d3"><div class="ttname"><a href="_m_l_sampling_level_options_8h.html#a68d15eaf394d210effcf584b938206d3">LEVEL_REF_ID</a></div><div class="ttdeci">#define LEVEL_REF_ID</div><div class="ttdef"><b>Definition:</b> <a href="_m_l_sampling_level_options_8h_source.html#l00028">MLSamplingLevelOptions.h:28</a></div></div>
<div class="ttc" id="class_q_u_e_s_o_1_1_mpi_comm_html_abd6af8db8b0c7fd2f5b62e26477a9537"><div class="ttname"><a href="class_q_u_e_s_o_1_1_mpi_comm.html#abd6af8db8b0c7fd2f5b62e26477a9537">QUESO::MpiComm::Bcast</a></div><div class="ttdeci">void Bcast(void *buffer, int count, RawType_MPI_Datatype datatype, int root, const char *whereMsg, const char *whatMsg) const </div><div class="ttdoc">Broadcast values from the root process to the slave processes. </div><div class="ttdef"><b>Definition:</b> <a href="_mpi_comm_8_c_source.html#l00157">MpiComm.C:157</a></div></div>
<div class="ttc" id="class_q_u_e_s_o_1_1_m_l_sampling_html_a7bc4c72f65ba9166ed94a6e198b0915b"><div class="ttname"><a href="class_q_u_e_s_o_1_1_m_l_sampling.html#a7bc4c72f65ba9166ed94a6e198b0915b">QUESO::MLSampling::m_vectorSpace</a></div><div class="ttdeci">const VectorSpace&lt; P_V, P_M &gt; &amp; m_vectorSpace</div><div class="ttdoc">Vector space. </div><div class="ttdef"><b>Definition:</b> <a href="_m_l_sampling_8h_source.html#l00451">MLSampling.h:451</a></div></div>
<div class="ttc" id="_mpi_comm_8h_html_ad0f503bd9fecfe4e570ca3d15aaf2518"><div class="ttname"><a href="_mpi_comm_8h.html#ad0f503bd9fecfe4e570ca3d15aaf2518">RawValue_MPI_DOUBLE</a></div><div class="ttdeci">#define RawValue_MPI_DOUBLE</div><div class="ttdef"><b>Definition:</b> <a href="_mpi_comm_8h_source.html#l00048">MpiComm.h:48</a></div></div>
<div class="ttc" id="_defines_8h_html_a56d63d18d0a6d45757de47fcc06f574d"><div class="ttname"><a href="_defines_8h.html#a56d63d18d0a6d45757de47fcc06f574d">UQ_FATAL_TEST_MACRO</a></div><div class="ttdeci">#define UQ_FATAL_TEST_MACRO(test, givenRank, where, what)</div><div class="ttdef"><b>Definition:</b> <a href="_defines_8h_source.html#l00222">Defines.h:222</a></div></div>
<div class="ttc" id="_mpi_comm_8h_html_a06cbfbc33436f6e0dc8a48ff3c49bdfc"><div class="ttname"><a href="_mpi_comm_8h.html#a06cbfbc33436f6e0dc8a48ff3c49bdfc">RawValue_MPI_UNSIGNED</a></div><div class="ttdeci">#define RawValue_MPI_UNSIGNED</div><div class="ttdef"><b>Definition:</b> <a href="_mpi_comm_8h_source.html#l00049">MpiComm.h:49</a></div></div>
<div class="ttc" id="class_q_u_e_s_o_1_1_base_environment_html_a1fe5f244fc0316a0ab3e37463f108b96"><div class="ttname"><a href="class_q_u_e_s_o_1_1_base_environment.html#a1fe5f244fc0316a0ab3e37463f108b96">QUESO::BaseEnvironment::displayVerbosity</a></div><div class="ttdeci">unsigned int displayVerbosity() const </div><div class="ttdef"><b>Definition:</b> <a href="_environment_8_c_source.html#l00436">Environment.C:436</a></div></div>
<div class="ttc" id="class_q_u_e_s_o_1_1_base_environment_html_a8a0064746ae8dddfece4229b9ad374d6"><div class="ttname"><a href="class_q_u_e_s_o_1_1_base_environment.html#a8a0064746ae8dddfece4229b9ad374d6">QUESO::BaseEnvironment::subDisplayFile</a></div><div class="ttdeci">std::ofstream * subDisplayFile() const </div><div class="ttdoc">Access function for m_subDisplayFile (displays file on stream). </div><div class="ttdef"><b>Definition:</b> <a href="_environment_8_c_source.html#l00305">Environment.C:305</a></div></div>
<div class="ttc" id="class_q_u_e_s_o_1_1_base_environment_html_ac0345f57e31ef7833e379ed972bd094d"><div class="ttname"><a href="class_q_u_e_s_o_1_1_base_environment.html#ac0345f57e31ef7833e379ed972bd094d">QUESO::BaseEnvironment::numSubEnvironments</a></div><div class="ttdeci">unsigned int numSubEnvironments() const </div><div class="ttdoc">Access function to the number of sub-environments. </div><div class="ttdef"><b>Definition:</b> <a href="_environment_8_c_source.html#l00319">Environment.C:319</a></div></div>
<div class="ttc" id="_m_l_sampling_8h_html_a6c830698381e4aa1c55b3b418754ae4b"><div class="ttname"><a href="_m_l_sampling_8h.html#a6c830698381e4aa1c55b3b418754ae4b">ML_CHECKPOINT_FIXED_AMOUNT_OF_DATA</a></div><div class="ttdeci">#define ML_CHECKPOINT_FIXED_AMOUNT_OF_DATA</div><div class="ttdef"><b>Definition:</b> <a href="_m_l_sampling_8h_source.html#l00046">MLSampling.h:46</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="af71979655e46135b6a3c97b8909321f0"></a>
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;class P_V , class P_M &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="class_q_u_e_s_o_1_1_m_l_sampling.html">QUESO::MLSampling</a>&lt; P_V, P_M &gt;::sampleIndexes_proc0 </td>
          <td>(</td>
          <td class="paramtype">unsigned int&#160;</td>
          <td class="paramname"><em>unifiedRequestedNumSamples</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::vector&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>unifiedWeightStdVectorAtProc0Only</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::vector&lt; unsigned int &gt; &amp;&#160;</td>
          <td class="paramname"><em>unifiedIndexCountersAtProc0Only</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">unifiedRequestedNumSamples,unifiedWeightStdVectorAtProc0Only</td><td></td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">unifiedIndexCountersAtProc0Only</td><td></td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="_m_l_sampling_8_c_source.html#l00093">93</a> of file <a class="el" href="_m_l_sampling_8_c_source.html">MLSampling.C</a>.</p>

<p>References <a class="el" href="_m_l_sampling_level_options_8h_source.html#l00028">LEVEL_REF_ID</a>, and <a class="el" href="_finite_distribution_8_c_source.html#l00144">QUESO::FiniteDistribution::sample()</a>.</p>
<div class="fragment"><div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;{</div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#ae106b5bb8a80b655b88b3a26b1e7c185">inter0Rank</a>() != 0) <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;</div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;  <span class="keywordflow">if</span> ((<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#a8a0064746ae8dddfece4229b9ad374d6">subDisplayFile</a>()) &amp;&amp; (<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#a1fe5f244fc0316a0ab3e37463f108b96">displayVerbosity</a>() &gt;= 0)) {</div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;    *<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#a8a0064746ae8dddfece4229b9ad374d6">subDisplayFile</a>() &lt;&lt; <span class="stringliteral">&quot;Entering MLSampling&lt;P_V,P_M&gt;::sampleIndexes_proc0()&quot;</span></div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;                            &lt;&lt; <span class="stringliteral">&quot;, level &quot;</span> &lt;&lt; <a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#af9416874c856e50f3b35270e801f17e4">m_currLevel</a>+<a class="code" href="_m_l_sampling_level_options_8h.html#a68d15eaf394d210effcf584b938206d3">LEVEL_REF_ID</a></div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;                            &lt;&lt; <span class="stringliteral">&quot;, step &quot;</span>  &lt;&lt; <a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a1b1f8ccb4823bdfa26ec652f0807c63e">m_currStep</a></div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;                            &lt;&lt; <span class="stringliteral">&quot;: unifiedRequestedNumSamples = &quot;</span>               &lt;&lt; unifiedRequestedNumSamples</div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;                            &lt;&lt; <span class="stringliteral">&quot;, unifiedWeightStdVectorAtProc0Only.size() = &quot;</span> &lt;&lt; unifiedWeightStdVectorAtProc0Only.size()</div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;                            &lt;&lt; std::endl;</div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;  }</div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;</div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;<span class="preprocessor">#if 0 // For debug only</span></div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;<span class="preprocessor"></span>  <span class="keywordflow">if</span> ((<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#a8a0064746ae8dddfece4229b9ad374d6">subDisplayFile</a>()) &amp;&amp; (<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#a1fe5f244fc0316a0ab3e37463f108b96">displayVerbosity</a>() &gt;= 0)) {</div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;    *<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#a8a0064746ae8dddfece4229b9ad374d6">subDisplayFile</a>() &lt;&lt; <span class="stringliteral">&quot;In MLSampling&lt;P_V,P_M&gt;::sampleIndexes_proc0()&quot;</span></div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;                            &lt;&lt; <span class="stringliteral">&quot;, level &quot;</span> &lt;&lt; <a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#af9416874c856e50f3b35270e801f17e4">m_currLevel</a>+<a class="code" href="_m_l_sampling_level_options_8h.html#a68d15eaf394d210effcf584b938206d3">LEVEL_REF_ID</a></div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;                            &lt;&lt; <span class="stringliteral">&quot;, step &quot;</span>  &lt;&lt; <a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a1b1f8ccb4823bdfa26ec652f0807c63e">m_currStep</a></div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;                            &lt;&lt; <span class="stringliteral">&quot;:&quot;</span></div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;                            &lt;&lt; std::endl;</div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> numZeros = 0;</div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = 0; i &lt; unifiedWeightStdVectorAtProc0Only.size(); ++i) {</div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;      *<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#a8a0064746ae8dddfece4229b9ad374d6">subDisplayFile</a>() &lt;&lt; <span class="stringliteral">&quot;  unifiedWeightStdVectorAtProc0Only[&quot;</span> &lt;&lt; i</div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;                              &lt;&lt; <span class="stringliteral">&quot;] = &quot;</span> &lt;&lt; unifiedWeightStdVectorAtProc0Only[i]</div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;                              &lt;&lt; std::endl;</div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;      <span class="keywordflow">if</span> (unifiedWeightStdVectorAtProc0Only[i] == 0.) numZeros++;</div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;    }</div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;    *<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#a8a0064746ae8dddfece4229b9ad374d6">subDisplayFile</a>() &lt;&lt; <span class="stringliteral">&quot;Number of zeros in unifiedWeightStdVectorAtProc0Only = &quot;</span> &lt;&lt; numZeros</div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;                            &lt;&lt; std::endl;</div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;  }</div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;<span class="preprocessor"></span></div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>.<a class="code" href="class_q_u_e_s_o_1_1_base_environment.html#ae106b5bb8a80b655b88b3a26b1e7c185">inter0Rank</a>() == 0) {</div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> resizeSize = unifiedWeightStdVectorAtProc0Only.size();</div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;    unifiedIndexCountersAtProc0Only.resize(resizeSize,0);</div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;</div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;    <span class="comment">// Generate &#39;unifiedRequestedNumSamples&#39; samples from &#39;tmpFD&#39;</span></div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;    FiniteDistribution tmpFd(<a class="code" href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">m_env</a>,</div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;                                    <span class="stringliteral">&quot;&quot;</span>,</div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;                                    unifiedWeightStdVectorAtProc0Only);</div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = 0; i &lt; unifiedRequestedNumSamples; ++i) {</div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;      <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> index = tmpFd.sample();</div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;      unifiedIndexCountersAtProc0Only[index] += 1;</div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;    }</div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;  }</div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;</div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;  <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;}</div>
<div class="ttc" id="class_q_u_e_s_o_1_1_m_l_sampling_html_a13f1ca4fe9f94822fe572a743eaced1d"><div class="ttname"><a href="class_q_u_e_s_o_1_1_m_l_sampling.html#a13f1ca4fe9f94822fe572a743eaced1d">QUESO::MLSampling::m_env</a></div><div class="ttdeci">const BaseEnvironment &amp; m_env</div><div class="ttdoc">Queso enviroment. </div><div class="ttdef"><b>Definition:</b> <a href="_m_l_sampling_8h_source.html#l00442">MLSampling.h:442</a></div></div>
<div class="ttc" id="class_q_u_e_s_o_1_1_m_l_sampling_html_af9416874c856e50f3b35270e801f17e4"><div class="ttname"><a href="class_q_u_e_s_o_1_1_m_l_sampling.html#af9416874c856e50f3b35270e801f17e4">QUESO::MLSampling::m_currLevel</a></div><div class="ttdeci">unsigned int m_currLevel</div><div class="ttdoc">Current level. </div><div class="ttdef"><b>Definition:</b> <a href="_m_l_sampling_8h_source.html#l00464">MLSampling.h:464</a></div></div>
<div class="ttc" id="_m_l_sampling_level_options_8h_html_a68d15eaf394d210effcf584b938206d3"><div class="ttname"><a href="_m_l_sampling_level_options_8h.html#a68d15eaf394d210effcf584b938206d3">LEVEL_REF_ID</a></div><div class="ttdeci">#define LEVEL_REF_ID</div><div class="ttdef"><b>Definition:</b> <a href="_m_l_sampling_level_options_8h_source.html#l00028">MLSamplingLevelOptions.h:28</a></div></div>
<div class="ttc" id="class_q_u_e_s_o_1_1_base_environment_html_ae106b5bb8a80b655b88b3a26b1e7c185"><div class="ttname"><a href="class_q_u_e_s_o_1_1_base_environment.html#ae106b5bb8a80b655b88b3a26b1e7c185">QUESO::BaseEnvironment::inter0Rank</a></div><div class="ttdeci">int inter0Rank() const </div><div class="ttdoc">Returns the process inter0 rank. </div><div class="ttdef"><b>Definition:</b> <a href="_environment_8_c_source.html#l00289">Environment.C:289</a></div></div>
<div class="ttc" id="class_q_u_e_s_o_1_1_m_l_sampling_html_a1b1f8ccb4823bdfa26ec652f0807c63e"><div class="ttname"><a href="class_q_u_e_s_o_1_1_m_l_sampling.html#a1b1f8ccb4823bdfa26ec652f0807c63e">QUESO::MLSampling::m_currStep</a></div><div class="ttdeci">unsigned int m_currStep</div><div class="ttdoc">Curret step. </div><div class="ttdef"><b>Definition:</b> <a href="_m_l_sampling_8h_source.html#l00467">MLSampling.h:467</a></div></div>
<div class="ttc" id="class_q_u_e_s_o_1_1_base_environment_html_a1fe5f244fc0316a0ab3e37463f108b96"><div class="ttname"><a href="class_q_u_e_s_o_1_1_base_environment.html#a1fe5f244fc0316a0ab3e37463f108b96">QUESO::BaseEnvironment::displayVerbosity</a></div><div class="ttdeci">unsigned int displayVerbosity() const </div><div class="ttdef"><b>Definition:</b> <a href="_environment_8_c_source.html#l00436">Environment.C:436</a></div></div>
<div class="ttc" id="class_q_u_e_s_o_1_1_base_environment_html_a8a0064746ae8dddfece4229b9ad374d6"><div class="ttname"><a href="class_q_u_e_s_o_1_1_base_environment.html#a8a0064746ae8dddfece4229b9ad374d6">QUESO::BaseEnvironment::subDisplayFile</a></div><div class="ttdeci">std::ofstream * subDisplayFile() const </div><div class="ttdoc">Access function for m_subDisplayFile (displays file on stream). </div><div class="ttdef"><b>Definition:</b> <a href="_environment_8_c_source.html#l00305">Environment.C:305</a></div></div>
</div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">Friends And Related Function Documentation</h2>
<a class="anchor" id="a5a8aa9e185dfa1698ec94d6709895d2c"></a>
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;class P_V, class P_M&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::ostream&amp; operator&lt;&lt; </td>
          <td>(</td>
          <td class="paramtype">std::ostream &amp;&#160;</td>
          <td class="paramname"><em>os</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="class_q_u_e_s_o_1_1_m_l_sampling.html">MLSampling</a>&lt; P_V, P_M &gt; &amp;&#160;</td>
          <td class="paramname"><em>obj</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">friend</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="_m_l_sampling_8h_source.html#l00202">202</a> of file <a class="el" href="_m_l_sampling_8h_source.html">MLSampling.h</a>.</p>
<div class="fragment"><div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;                                      {</div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;    obj.print(os);</div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;    <span class="keywordflow">return</span> os;</div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;  }</div>
</div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">Member Data Documentation</h2>
<a class="anchor" id="af9416874c856e50f3b35270e801f17e4"></a>
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;class P_V, class P_M&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">unsigned int <a class="el" href="class_q_u_e_s_o_1_1_m_l_sampling.html">QUESO::MLSampling</a>&lt; P_V, P_M &gt;::m_currLevel</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Current level. </p>

<p>Definition at line <a class="el" href="_m_l_sampling_8h_source.html#l00464">464</a> of file <a class="el" href="_m_l_sampling_8h_source.html">MLSampling.h</a>.</p>

</div>
</div>
<a class="anchor" id="a1b1f8ccb4823bdfa26ec652f0807c63e"></a>
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;class P_V, class P_M&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">unsigned int <a class="el" href="class_q_u_e_s_o_1_1_m_l_sampling.html">QUESO::MLSampling</a>&lt; P_V, P_M &gt;::m_currStep</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Curret step. </p>

<p>Definition at line <a class="el" href="_m_l_sampling_8h_source.html#l00467">467</a> of file <a class="el" href="_m_l_sampling_8h_source.html">MLSampling.h</a>.</p>

</div>
</div>
<a class="anchor" id="abdd5cd35419283c33cc40a77d0f4f07f"></a>
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;class P_V, class P_M&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">double <a class="el" href="class_q_u_e_s_o_1_1_m_l_sampling.html">QUESO::MLSampling</a>&lt; P_V, P_M &gt;::m_debugExponent</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Exponent for debugging. </p>

<p>Definition at line <a class="el" href="_m_l_sampling_8h_source.html#l00470">470</a> of file <a class="el" href="_m_l_sampling_8h_source.html">MLSampling.h</a>.</p>

</div>
</div>
<a class="anchor" id="abec7f8cf9da08bc5c0a20d99fa4570af"></a>
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;class P_V, class P_M&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">double <a class="el" href="class_q_u_e_s_o_1_1_m_l_sampling.html">QUESO::MLSampling</a>&lt; P_V, P_M &gt;::m_eig</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="_m_l_sampling_8h_source.html#l00474">474</a> of file <a class="el" href="_m_l_sampling_8h_source.html">MLSampling.h</a>.</p>

</div>
</div>
<a class="anchor" id="a13f1ca4fe9f94822fe572a743eaced1d"></a>
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;class P_V, class P_M&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">const <a class="el" href="class_q_u_e_s_o_1_1_base_environment.html">BaseEnvironment</a>&amp; <a class="el" href="class_q_u_e_s_o_1_1_m_l_sampling.html">QUESO::MLSampling</a>&lt; P_V, P_M &gt;::m_env</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Queso enviroment. </p>

<p>Definition at line <a class="el" href="_m_l_sampling_8h_source.html#l00442">442</a> of file <a class="el" href="_m_l_sampling_8h_source.html">MLSampling.h</a>.</p>

<p>Referenced by <a class="el" href="_m_l_sampling_8_c_source.html#l04033">QUESO::MLSampling&lt; P_V, P_M &gt;::MLSampling()</a>.</p>

</div>
</div>
<a class="anchor" id="ab08c3059d23460db49b229aa88bd4e70"></a>
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;class P_V, class P_M&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">const <a class="el" href="class_q_u_e_s_o_1_1_base_scalar_function.html">BaseScalarFunction</a>&lt;P_V,P_M&gt;&amp; <a class="el" href="class_q_u_e_s_o_1_1_m_l_sampling.html">QUESO::MLSampling</a>&lt; P_V, P_M &gt;::m_likelihoodFunction</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Likelihood function. </p>

<p>Definition at line <a class="el" href="_m_l_sampling_8h_source.html#l00448">448</a> of file <a class="el" href="_m_l_sampling_8h_source.html">MLSampling.h</a>.</p>

</div>
</div>
<a class="anchor" id="afad63c42dccb1518319bf677f2bffde0"></a>
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;class P_V, class P_M&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">double <a class="el" href="class_q_u_e_s_o_1_1_m_l_sampling.html">QUESO::MLSampling</a>&lt; P_V, P_M &gt;::m_logEvidence</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="_m_l_sampling_8h_source.html#l00472">472</a> of file <a class="el" href="_m_l_sampling_8h_source.html">MLSampling.h</a>.</p>

</div>
</div>
<a class="anchor" id="a75f2ceab4a2c6774b3fa07d74221dbf3"></a>
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;class P_V, class P_M&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt;double&gt; <a class="el" href="class_q_u_e_s_o_1_1_m_l_sampling.html">QUESO::MLSampling</a>&lt; P_V, P_M &gt;::m_logEvidenceFactors</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="_m_l_sampling_8h_source.html#l00471">471</a> of file <a class="el" href="_m_l_sampling_8h_source.html">MLSampling.h</a>.</p>

</div>
</div>
<a class="anchor" id="aec4229773274b58e3eaa49a77738389f"></a>
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;class P_V, class P_M&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">double <a class="el" href="class_q_u_e_s_o_1_1_m_l_sampling.html">QUESO::MLSampling</a>&lt; P_V, P_M &gt;::m_meanLogLikelihood</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="_m_l_sampling_8h_source.html#l00473">473</a> of file <a class="el" href="_m_l_sampling_8h_source.html">MLSampling.h</a>.</p>

</div>
</div>
<a class="anchor" id="afbe27e6149562020663b72da6592d933"></a>
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;class P_V, class P_M&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">unsigned int <a class="el" href="class_q_u_e_s_o_1_1_m_l_sampling.html">QUESO::MLSampling</a>&lt; P_V, P_M &gt;::m_numDisabledParameters</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="_m_l_sampling_8h_source.html#l00456">456</a> of file <a class="el" href="_m_l_sampling_8h_source.html">MLSampling.h</a>.</p>

</div>
</div>
<a class="anchor" id="af8504cc57ec72b3c52833826b2bfff8e"></a>
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;class P_V, class P_M&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="class_q_u_e_s_o_1_1_m_l_sampling_options.html">MLSamplingOptions</a> <a class="el" href="class_q_u_e_s_o_1_1_m_l_sampling.html">QUESO::MLSampling</a>&lt; P_V, P_M &gt;::m_options</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Options for the ML algorithm. </p>

<p>Definition at line <a class="el" href="_m_l_sampling_8h_source.html#l00461">461</a> of file <a class="el" href="_m_l_sampling_8h_source.html">MLSampling.h</a>.</p>

<p>Referenced by <a class="el" href="_m_l_sampling_8_c_source.html#l04033">QUESO::MLSampling&lt; P_V, P_M &gt;::MLSampling()</a>.</p>

</div>
</div>
<a class="anchor" id="ac76690384f70d74b8662faf7a051449e"></a>
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;class P_V, class P_M&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt;bool&gt; <a class="el" href="class_q_u_e_s_o_1_1_m_l_sampling.html">QUESO::MLSampling</a>&lt; P_V, P_M &gt;::m_parameterEnabledStatus</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="_m_l_sampling_8h_source.html#l00458">458</a> of file <a class="el" href="_m_l_sampling_8h_source.html">MLSampling.h</a>.</p>

</div>
</div>
<a class="anchor" id="aa45e9c06bd51cae0dc2294af1831c158"></a>
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;class P_V, class P_M&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">const <a class="el" href="class_q_u_e_s_o_1_1_base_vector_r_v.html">BaseVectorRV</a>&lt;P_V,P_M&gt;&amp; <a class="el" href="class_q_u_e_s_o_1_1_m_l_sampling.html">QUESO::MLSampling</a>&lt; P_V, P_M &gt;::m_priorRv</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Prior RV. </p>

<p>Definition at line <a class="el" href="_m_l_sampling_8h_source.html#l00445">445</a> of file <a class="el" href="_m_l_sampling_8h_source.html">MLSampling.h</a>.</p>

</div>
</div>
<a class="anchor" id="a21525858e93a7d9654fdf68c8ac25576"></a>
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;class P_V, class P_M&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="class_q_u_e_s_o_1_1_vector_set.html">VectorSet</a>&lt;P_V,P_M&gt;* <a class="el" href="class_q_u_e_s_o_1_1_m_l_sampling.html">QUESO::MLSampling</a>&lt; P_V, P_M &gt;::m_targetDomain</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Domain of the target PDF: intersection of the domains of the prior PDf and likelihood function. </p>

<p>Definition at line <a class="el" href="_m_l_sampling_8h_source.html#l00454">454</a> of file <a class="el" href="_m_l_sampling_8h_source.html">MLSampling.h</a>.</p>

</div>
</div>
<a class="anchor" id="a7bc4c72f65ba9166ed94a6e198b0915b"></a>
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;class P_V, class P_M&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">const <a class="el" href="class_q_u_e_s_o_1_1_vector_space.html">VectorSpace</a>&lt;P_V,P_M&gt;&amp; <a class="el" href="class_q_u_e_s_o_1_1_m_l_sampling.html">QUESO::MLSampling</a>&lt; P_V, P_M &gt;::m_vectorSpace</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p><a class="el" href="class_q_u_e_s_o_1_1_vector.html" title="Class for vector operations (virtual). ">Vector</a> space. </p>

<p>Definition at line <a class="el" href="_m_l_sampling_8h_source.html#l00451">451</a> of file <a class="el" href="_m_l_sampling_8h_source.html">MLSampling.h</a>.</p>

</div>
</div>
<hr/>The documentation for this class was generated from the following files:<ul>
<li>src/stats/inc/<a class="el" href="_m_l_sampling_8h_source.html">MLSampling.h</a></li>
<li>src/stats/src/<a class="el" href="_m_l_sampling_8_c_source.html">MLSampling.C</a></li>
</ul>
</div><!-- contents -->
<hr size="1"/><address style="text-align: right;"><small>
Generated on Sat Apr 19 2014 17:01:58 for queso-0.50.0
by&nbsp;<a href="http://www.doxygen.org/index.html">
<em>doxygen</em></a>
1.8.5</small></address>
</body>
</html>
