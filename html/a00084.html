<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.5"/>
<title>queso-0.56.2: QUESO::Fft&lt; T &gt; Class Template Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">queso-0.56.2
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.5 -->
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li class="current"><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="annotated.html"><span>Class&#160;List</span></a></li>
      <li><a href="classes.html"><span>Class&#160;Index</span></a></li>
      <li><a href="inherits.html"><span>Class&#160;Hierarchy</span></a></li>
      <li><a href="functions.html"><span>Class&#160;Members</span></a></li>
    </ul>
  </div>
<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="a00674.html">QUESO</a></li><li class="navelem"><a class="el" href="a00084.html">Fft</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pri-attribs">Private Attributes</a> &#124;
<a href="a00988.html">List of all members</a>  </div>
  <div class="headertitle">
<div class="title">QUESO::Fft&lt; T &gt; Class Template Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Class for a Fast Fourier Transform (FFT) algorithm.  
 <a href="a00084.html#details">More...</a></p>

<p><code>#include &lt;<a class="el" href="a00449_source.html">Fft.h</a>&gt;</code></p>
<div class="dynheader">
Collaboration diagram for QUESO::Fft&lt; T &gt;:</div>
<div class="dyncontent">
<div class="center"><img src="a00989.png" border="0" usemap="#_q_u_e_s_o_1_1_fft_3_01_t_01_4_coll__map" alt="Collaboration graph"/></div>
<map name="_q_u_e_s_o_1_1_fft_3_01_t_01_4_coll__map" id="_q_u_e_s_o_1_1_fft_3_01_t_01_4_coll__map">
<area shape="rect" id="node2" href="a00036.html" title="This (virtual) class sets up the environment underlying the use of the QUESO library by an executable..." alt="" coords="397,251,579,277"/><area shape="rect" id="node3" href="a00206.html" title="QUESO::ScopedPtr\&lt; QUESO\l::RngBase \&gt;" alt="" coords="22,5,221,46"/><area shape="rect" id="node4" href="a00206.html" title="QUESO::ScopedPtr\&lt; QUESO\l::MpiComm \&gt;" alt="" coords="22,83,221,125"/><area shape="rect" id="node5" href="a00206.html" title="QUESO::ScopedPtr\&lt; boost\l::program_options::variables_map \&gt;" alt="" coords="6,149,237,190"/><area shape="rect" id="node6" href="a00206.html" title="QUESO::ScopedPtr\&lt; QUESO\l::EnvOptionsValues \&gt;" alt="" coords="22,214,221,255"/><area shape="rect" id="node7" href="a00206.html" title="QUESO::ScopedPtr\&lt; GetPot \&gt;" alt="" coords="19,280,223,307"/><area shape="rect" id="node8" href="a00206.html" title="QUESO::ScopedPtr\&lt; QUESO\l::BasicPdfsBase \&gt;" alt="" coords="22,331,221,373"/><area shape="rect" id="node9" href="a00206.html" title="QUESO::ScopedPtr\&lt; std\l::ofstream \&gt;" alt="" coords="37,397,206,438"/><area shape="rect" id="node10" href="a00206.html" title="QUESO::ScopedPtr\&lt; boost\l::program_options::options\l_description \&gt;" alt="" coords="30,463,213,519"/></map>
<center><span class="legend">[<a href="graph_legend.html">legend</a>]</span></center></div>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:a749f7de2d358417a63e6060b96c5233b"><td class="memTemplParams" colspan="2">template&lt;&gt; </td></tr>
<tr class="memitem:a749f7de2d358417a63e6060b96c5233b"><td class="memTemplItemLeft" align="right" valign="top"><a class="el" href="a00311.html#a3b083519fd2b41d83363afcfd5ebad9d">void</a>&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="a00084.html#a749f7de2d358417a63e6060b96c5233b">forward</a> (const std::vector&lt; std::complex&lt; double &gt; &gt; &amp;data, unsigned int fftSize, std::vector&lt; std::complex&lt; double &gt; &gt; &amp;forwardResult)</td></tr>
<tr class="separator:a749f7de2d358417a63e6060b96c5233b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab7147b1d0ec73019152c149e602172f1"><td class="memTemplParams" colspan="2">template&lt;&gt; </td></tr>
<tr class="memitem:ab7147b1d0ec73019152c149e602172f1"><td class="memTemplItemLeft" align="right" valign="top"><a class="el" href="a00311.html#a3b083519fd2b41d83363afcfd5ebad9d">void</a>&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="a00084.html#ab7147b1d0ec73019152c149e602172f1">inverse</a> (const std::vector&lt; std::complex&lt; double &gt; &gt; &amp;data, unsigned int fftSize, std::vector&lt; std::complex&lt; double &gt; &gt; &amp;inverseResult)</td></tr>
<tr class="separator:ab7147b1d0ec73019152c149e602172f1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab31ecb8b49b52d107f152fa07a59628d"><td class="memTemplParams" colspan="2">template&lt;&gt; </td></tr>
<tr class="memitem:ab31ecb8b49b52d107f152fa07a59628d"><td class="memTemplItemLeft" align="right" valign="top"><a class="el" href="a00311.html#a3b083519fd2b41d83363afcfd5ebad9d">void</a>&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="a00084.html#ab31ecb8b49b52d107f152fa07a59628d">forward</a> (const std::vector&lt; double &gt; &amp;data, unsigned int fftSize, std::vector&lt; std::complex&lt; double &gt; &gt; &amp;forwardResult)</td></tr>
<tr class="separator:ab31ecb8b49b52d107f152fa07a59628d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aed1cacf899ad52ae979c475130411719"><td class="memTemplParams" colspan="2">template&lt;&gt; </td></tr>
<tr class="memitem:aed1cacf899ad52ae979c475130411719"><td class="memTemplItemLeft" align="right" valign="top"><a class="el" href="a00311.html#a3b083519fd2b41d83363afcfd5ebad9d">void</a>&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="a00084.html#aed1cacf899ad52ae979c475130411719">inverse</a> (const std::vector&lt; double &gt; &amp;data, unsigned int fftSize, std::vector&lt; std::complex&lt; double &gt; &gt; &amp;inverseResult)</td></tr>
<tr class="separator:aed1cacf899ad52ae979c475130411719"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr><td colspan="2"><div class="groupHeader">Constructor/Destructor methods</div></td></tr>
<tr class="memitem:a04fa27a65066c50e029c842fa1e3fe78"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00084.html#a04fa27a65066c50e029c842fa1e3fe78">Fft</a> (const <a class="el" href="a00036.html">BaseEnvironment</a> &amp;env)</td></tr>
<tr class="memdesc:a04fa27a65066c50e029c842fa1e3fe78"><td class="mdescLeft">&#160;</td><td class="mdescRight">Default Constructor.  <a href="#a04fa27a65066c50e029c842fa1e3fe78">More...</a><br/></td></tr>
<tr class="separator:a04fa27a65066c50e029c842fa1e3fe78"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3dac972e69f606d201dee17db1e9216b"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00084.html#a3dac972e69f606d201dee17db1e9216b">~Fft</a> ()</td></tr>
<tr class="memdesc:a3dac972e69f606d201dee17db1e9216b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Destructor.  <a href="#a3dac972e69f606d201dee17db1e9216b">More...</a><br/></td></tr>
<tr class="separator:a3dac972e69f606d201dee17db1e9216b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr><td colspan="2"><div class="groupHeader">Mathematical methods</div></td></tr>
<tr class="memitem:a416c250a17337415b02e6545ed622476"><td class="memItemLeft" align="right" valign="top"><a class="el" href="a00311.html#a3b083519fd2b41d83363afcfd5ebad9d">void</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00084.html#a416c250a17337415b02e6545ed622476">forward</a> (const std::vector&lt; T &gt; &amp;data, unsigned int fftSize, std::vector&lt; std::complex&lt; double &gt; &gt; &amp;result)</td></tr>
<tr class="memdesc:a416c250a17337415b02e6545ed622476"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculates the forward Fourier transform (for real data. TODO: complex data).  <a href="#a416c250a17337415b02e6545ed622476">More...</a><br/></td></tr>
<tr class="separator:a416c250a17337415b02e6545ed622476"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2e1faedd41887115b032b0b45d1f8f58"><td class="memItemLeft" align="right" valign="top"><a class="el" href="a00311.html#a3b083519fd2b41d83363afcfd5ebad9d">void</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00084.html#a2e1faedd41887115b032b0b45d1f8f58">inverse</a> (const std::vector&lt; T &gt; &amp;data, unsigned int fftSize, std::vector&lt; std::complex&lt; double &gt; &gt; &amp;result)</td></tr>
<tr class="memdesc:a2e1faedd41887115b032b0b45d1f8f58"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculates the inverse Fourier transform for real and complex data.  <a href="#a2e1faedd41887115b032b0b45d1f8f58">More...</a><br/></td></tr>
<tr class="separator:a2e1faedd41887115b032b0b45d1f8f58"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pri-attribs"></a>
Private Attributes</h2></td></tr>
<tr class="memitem:a47bda8b9417d43d94b14d0721b6189e2"><td class="memItemLeft" align="right" valign="top">const <a class="el" href="a00036.html">BaseEnvironment</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00084.html#a47bda8b9417d43d94b14d0721b6189e2">m_env</a></td></tr>
<tr class="separator:a47bda8b9417d43d94b14d0721b6189e2"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><h3>template&lt;class T&gt;<br/>
class QUESO::Fft&lt; T &gt;</h3>

<p>Class for a Fast Fourier Transform (FFT) algorithm. </p>
<p>This class implements a Fast Fourier Transform (FFT) algorithm. Fast Fourier Transforms are efficient algorithms for calculating the discrete Fourier transform (DFT), </p>
<p class="formulaDsp">
<img class="formulaDsp" alt="\[ x_j = \sum_{k=0}^{N-1} z_k \exp(-2\pi i j k / N) \]" src="form_104.png"/>
</p>
<p> and its inverse. The DFT usually arises as an approximation to the continuous Fourier transform when functions are sampled at discrete intervals in space or time. The naive evaluation of the discrete Fourier transform is a matrix-vector multiplication <img class="formulaInl" alt="$ Ab $" src="form_105.png"/>. A general matrix-vector multiplication takes <img class="formulaInl" alt="$ O(N^2)$" src="form_106.png"/> operations for <img class="formulaInl" alt="$ N $" src="form_107.png"/> data-points. Fast Fourier transform algorithms use a divide-and-conquer strategy to factorize the matrix <img class="formulaInl" alt="$ A $" src="form_108.png"/> into smaller sub-matrices, corresponding to the integer factors of the length <img class="formulaInl" alt="$ N $" src="form_107.png"/>. If <img class="formulaInl" alt="$ N $" src="form_107.png"/> can be factorized into a product of integers <img class="formulaInl" alt="$ f_1 f_2 ... f_n $" src="form_109.png"/> then the DFT can be computed in <img class="formulaInl" alt="$ O(N \sum f_i) $" src="form_110.png"/> operations. For a radix-2 FFT this gives an operation count of <img class="formulaInl" alt="$ O(N \log_2 N)$" src="form_111.png"/>.</p>
<dl class="todo"><dt><b><a class="el" href="a00676.html#_todo000014">Todo:</a></b></dt><dd>: Implement Forward Fourier Transform for Complex data.</dd></dl>

<p>Definition at line <a class="el" href="a00449_source.html#l00066">66</a> of file <a class="el" href="a00449_source.html">Fft.h</a>.</p>
</div><h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a class="anchor" id="a04fa27a65066c50e029c842fa1e3fe78"></a>
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;class T &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="a00084.html">QUESO::Fft</a>&lt; T &gt;::<a class="el" href="a00084.html">Fft</a> </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="a00036.html">BaseEnvironment</a> &amp;&#160;</td>
          <td class="paramname"><em>env</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Default Constructor. </p>

<p>Definition at line <a class="el" href="a00468_source.html#l00031">31</a> of file <a class="el" href="a00468_source.html">Fft.C</a>.</p>
<div class="fragment"><div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;  :</div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;  <a class="code" href="a00084.html#a47bda8b9417d43d94b14d0721b6189e2">m_env</a>(env)</div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;{</div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;}</div>
<div class="ttc" id="a00084_html_a47bda8b9417d43d94b14d0721b6189e2"><div class="ttname"><a href="a00084.html#a47bda8b9417d43d94b14d0721b6189e2">QUESO::Fft::m_env</a></div><div class="ttdeci">const BaseEnvironment &amp; m_env</div><div class="ttdef"><b>Definition:</b> <a href="a00449_source.html#l00113">Fft.h:113</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a3dac972e69f606d201dee17db1e9216b"></a>
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;class T &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="a00084.html">QUESO::Fft</a>&lt; T &gt;::~<a class="el" href="a00084.html">Fft</a> </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Destructor. </p>

<p>Definition at line <a class="el" href="a00468_source.html#l00038">38</a> of file <a class="el" href="a00468_source.html">Fft.C</a>.</p>
<div class="fragment"><div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;{</div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a class="anchor" id="a749f7de2d358417a63e6060b96c5233b"></a>
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;&gt; </div>
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="a00311.html#a3b083519fd2b41d83363afcfd5ebad9d">void</a> <a class="el" href="a00084.html">QUESO::Fft</a>&lt; std::complex&lt; double &gt; &gt;::forward </td>
          <td>(</td>
          <td class="paramtype">const std::vector&lt; std::complex&lt; double &gt; &gt; &amp;&#160;</td>
          <td class="paramname"><em>data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned int&#160;</td>
          <td class="paramname"><em>fftSize</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::vector&lt; std::complex&lt; double &gt; &gt; &amp;&#160;</td>
          <td class="paramname"><em>forwardResult</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="a00466_source.html#l00032">32</a> of file <a class="el" href="a00466_source.html">ComplexFft.C</a>.</p>
<div class="fragment"><div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;{</div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;  queso_not_implemented();</div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;</div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;  std::complex&lt;double&gt; z = data[0]; z += 0.; <span class="comment">// just to avoid icpc warnings</span></div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;  <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>         f = fftSize; f += 1;  <span class="comment">// just to avoid icpc warnings</span></div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;  forwardResult[0] = 0.;                     <span class="comment">// just to avoid icpc warnings</span></div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;<span class="preprocessor">#if 0</span></div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;<span class="preprocessor"></span>  <span class="keywordflow">if</span> (forwardResult.size() != fftSize) {</div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;    forwardResult.resize(fftSize,std::complex&lt;double&gt;(0.,0.));</div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;    std::vector&lt;std::complex&lt;double&gt; &gt;(forwardResult).swap(forwardResult);</div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;  }</div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;</div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;  std::vector&lt;double&gt; internalData(fftSize,0.);</div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;  <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> minSize = std::min((<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>) data.size(),fftSize);</div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> j = 0; j &lt; minSize; ++j) {</div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;    internalData[j] = data[j];</div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;  }</div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;</div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;  gsl_fft_real_workspace* realWkSpace = gsl_fft_real_workspace_alloc(fftSize);</div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;  gsl_fft_real_wavetable* realWvTable = gsl_fft_real_wavetable_alloc(fftSize);</div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;</div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;  gsl_fft_real_transform(&amp;internalData[0],</div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;                         1,</div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;                         fftSize,</div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;                         realWvTable,</div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;                         realWkSpace);</div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;</div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;  gsl_fft_real_wavetable_free(realWvTable);</div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;  gsl_fft_real_workspace_free(realWkSpace);</div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;</div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;  <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> halfFFTSize = fftSize/2;</div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;  <span class="keywordtype">double</span> realPartOfFFT = 0.;</div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;  <span class="keywordtype">double</span> imagPartOfFFT = 0.;</div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> j = 0; j &lt; internalData.size(); ++j) {</div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;    <span class="keywordflow">if</span> (j == 0) {</div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;      realPartOfFFT = internalData[j];</div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;      imagPartOfFFT = 0.;</div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;    }</div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (j &lt; halfFFTSize) {</div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;      realPartOfFFT = internalData[2*j-1];</div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;      imagPartOfFFT = internalData[2*j  ];</div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;    }</div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (j == halfFFTSize) {</div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;      realPartOfFFT = internalData[2*j-1];</div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;      imagPartOfFFT = 0.;</div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;    }</div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;    <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;      realPartOfFFT =  internalData[2*(fftSize-j)-1];</div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;      imagPartOfFFT = -internalData[2*(fftSize-j)  ];</div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;    }</div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;    forwardResult[j] = std::complex&lt;double&gt;(realPartOfFFT,imagPartOfFFT);</div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;  }</div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;<span class="preprocessor"></span>  <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ab31ecb8b49b52d107f152fa07a59628d"></a>
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;&gt; </div>
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="a00311.html#a3b083519fd2b41d83363afcfd5ebad9d">void</a> <a class="el" href="a00084.html">QUESO::Fft</a>&lt; double &gt;::forward </td>
          <td>(</td>
          <td class="paramtype">const std::vector&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned int&#160;</td>
          <td class="paramname"><em>fftSize</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::vector&lt; std::complex&lt; double &gt; &gt; &amp;&#160;</td>
          <td class="paramname"><em>forwardResult</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="a00474_source.html#l00034">34</a> of file <a class="el" href="a00474_source.html">RealFft.C</a>.</p>
<div class="fragment"><div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;{</div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;  <span class="keywordflow">if</span> (forwardResult.size() != fftSize) {</div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;    forwardResult.resize(fftSize,std::complex&lt;double&gt;(0.,0.));</div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;    std::vector&lt;std::complex&lt;double&gt; &gt;(forwardResult).swap(forwardResult);</div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;  }</div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;</div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;  std::vector&lt;double&gt; internalData(fftSize,0.);</div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;  <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> minSize = std::min((<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>) data.size(),fftSize);</div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> j = 0; j &lt; minSize; ++j) {</div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;    internalData[j] = data[j];</div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;  }</div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;</div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;  <span class="comment">//double sumOfAllTerms = 0.;</span></div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;  <span class="comment">//for (unsigned int j = 0; j &lt; fftSize; ++j) {</span></div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;  <span class="comment">//  sumOfAllTerms += internalData[j];</span></div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;  <span class="comment">//}</span></div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;</div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;  <span class="comment">//allocTables(fftSize);</span></div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;  gsl_fft_real_workspace* realWkSpace = gsl_fft_real_workspace_alloc(fftSize);</div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;  gsl_fft_real_wavetable* realWvTable = gsl_fft_real_wavetable_alloc(fftSize);</div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;</div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;  gsl_fft_real_transform(&amp;internalData[0],</div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;                         1,</div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;                         fftSize,</div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;                         realWvTable,</div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;                         realWkSpace);</div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;</div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;  gsl_fft_real_wavetable_free(realWvTable);</div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;  gsl_fft_real_workspace_free(realWkSpace);</div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;  <span class="comment">//freeTables();</span></div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;</div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;  <span class="comment">//std::cout &lt;&lt; &quot;After FFT&quot;</span></div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;  <span class="comment">//          &lt;&lt; &quot;, sumOfAllTerms = &quot;          &lt;&lt; sumOfAllTerms</span></div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;  <span class="comment">//          &lt;&lt; &quot;, sumOfAllTerms - dft[0] = &quot; &lt;&lt; sumOfAllTerms - internalData[0]</span></div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;  <span class="comment">//          &lt;&lt; std::endl;</span></div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;</div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;  <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> halfFFTSize = fftSize/2;</div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;  <span class="keywordtype">double</span> realPartOfFFT = 0.;</div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;  <span class="keywordtype">double</span> imagPartOfFFT = 0.;</div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> j = 0; j &lt; internalData.size(); ++j) {</div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;    <span class="keywordflow">if</span> (j == 0) {</div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;      realPartOfFFT = internalData[j];</div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;      imagPartOfFFT = 0.;</div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;    }</div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (j &lt; halfFFTSize) {</div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;      realPartOfFFT = internalData[2*j-1];</div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;      imagPartOfFFT = internalData[2*j  ];</div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;    }</div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (j == halfFFTSize) {</div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;      realPartOfFFT = internalData[2*j-1];</div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;      imagPartOfFFT = 0.;</div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;    }</div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;    <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;      realPartOfFFT =  internalData[2*(fftSize-j)-1];</div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;      imagPartOfFFT = -internalData[2*(fftSize-j)  ];</div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;    }</div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;    forwardResult[j] = std::complex&lt;double&gt;(realPartOfFFT,imagPartOfFFT);</div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;  }</div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;</div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;  <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a416c250a17337415b02e6545ed622476"></a>
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;class T&gt; </div>
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="a00311.html#a3b083519fd2b41d83363afcfd5ebad9d">void</a> <a class="el" href="a00084.html">QUESO::Fft</a>&lt; T &gt;::forward </td>
          <td>(</td>
          <td class="paramtype">const std::vector&lt; T &gt; &amp;&#160;</td>
          <td class="paramname"><em>data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned int&#160;</td>
          <td class="paramname"><em>fftSize</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::vector&lt; std::complex&lt; double &gt; &gt; &amp;&#160;</td>
          <td class="paramname"><em>result</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calculates the forward Fourier transform (for real data. TODO: complex data). </p>
<p>This function uses GSL function 'gsl_fft_real_transform' to compute the FFT of <code>data</code>, a real array (of time-ordered real data) of length <code>fftSize</code>, using a mixed radix decimation-in-frequency algorithm. There is no restriction on the length <code>fftSize</code>. Efficient modules are provided for subtransforms of length 2, 3, 4 and 5. Any remaining factors are computed with a slow, <img class="formulaInl" alt="$ O(\c fftSize ^2) $" src="form_112.png"/>, general- <code>fftSize</code> module. The caller must supply a wavetable containing trigonometric lookup tables and a workspace work.<br/>
 The definition of the forward Fourier transform, <img class="formulaInl" alt="$ x = FFT(z) $" src="form_113.png"/> of size <img class="formulaInl" alt="$ N $" src="form_107.png"/> is: </p>
<p class="formulaDsp">
<img class="formulaDsp" alt="\[ x_j = \sum_{k=0}^{N-1} z_k \exp(-2\pi i j k / N). \]" src="form_114.png"/>
</p>
 
<p>Referenced by <a class="el" href="a00296_source.html#l01331">QUESO::ScalarSequence&lt; T &gt;::autoCorrViaFft()</a>, and <a class="el" href="a00296_source.html#l03530">QUESO::ScalarSequence&lt; T &gt;::psd()</a>.</p>

</div>
</div>
<a class="anchor" id="ab7147b1d0ec73019152c149e602172f1"></a>
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;&gt; </div>
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="a00311.html#a3b083519fd2b41d83363afcfd5ebad9d">void</a> <a class="el" href="a00084.html">QUESO::Fft</a>&lt; std::complex&lt; double &gt; &gt;::inverse </td>
          <td>(</td>
          <td class="paramtype">const std::vector&lt; std::complex&lt; double &gt; &gt; &amp;&#160;</td>
          <td class="paramname"><em>data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned int&#160;</td>
          <td class="paramname"><em>fftSize</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::vector&lt; std::complex&lt; double &gt; &gt; &amp;&#160;</td>
          <td class="paramname"><em>inverseResult</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="a00466_source.html#l00094">94</a> of file <a class="el" href="a00466_source.html">ComplexFft.C</a>.</p>
<div class="fragment"><div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;{</div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;  <span class="keywordflow">if</span> (inverseResult.size() != fftSize) {</div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;    inverseResult.resize(fftSize,std::complex&lt;double&gt;(0.,0.));</div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;    std::vector&lt;std::complex&lt;double&gt; &gt;(inverseResult).swap(inverseResult);</div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;  }</div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;</div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;  std::vector&lt;double&gt; internalData(2*fftSize,0.);                          <span class="comment">// Yes, twice the fftSize</span></div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;  <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> minSize = 2 * std::min((<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>) data.size(),fftSize); <span class="comment">// Yes, 2*</span></div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> j = 0; j &lt; minSize; ++j) {</div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;    internalData[2*j  ] = data[j].real();</div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;    internalData[2*j+1] = data[j].imag();</div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;  }</div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;</div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;  gsl_fft_complex_workspace* complexWkSpace = gsl_fft_complex_workspace_alloc(fftSize);</div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;  gsl_fft_complex_wavetable* complexWvTable = gsl_fft_complex_wavetable_alloc(fftSize);</div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;</div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;  gsl_fft_complex_inverse(&amp;internalData[0],</div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;                          1,</div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;                          fftSize,</div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;                          complexWvTable,</div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;                          complexWkSpace);</div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;</div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;  gsl_fft_complex_wavetable_free(complexWvTable);</div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;  gsl_fft_complex_workspace_free(complexWkSpace);</div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;</div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> j = 0; j &lt; fftSize; ++j) {</div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;    inverseResult[j] = std::complex&lt;double&gt;(internalData[2*j],internalData[2*j+1]);</div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;  }</div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;</div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;  <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="aed1cacf899ad52ae979c475130411719"></a>
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;&gt; </div>
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="a00311.html#a3b083519fd2b41d83363afcfd5ebad9d">void</a> <a class="el" href="a00084.html">QUESO::Fft</a>&lt; double &gt;::inverse </td>
          <td>(</td>
          <td class="paramtype">const std::vector&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned int&#160;</td>
          <td class="paramname"><em>fftSize</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::vector&lt; std::complex&lt; double &gt; &gt; &amp;&#160;</td>
          <td class="paramname"><em>inverseResult</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="a00474_source.html#l00102">102</a> of file <a class="el" href="a00474_source.html">RealFft.C</a>.</p>
<div class="fragment"><div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;{</div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;  <span class="keywordflow">if</span> (inverseResult.size() != fftSize) {</div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;    inverseResult.resize(fftSize,std::complex&lt;double&gt;(0.,0.));</div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;    std::vector&lt;std::complex&lt;double&gt; &gt;(inverseResult).swap(inverseResult);</div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;  }</div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;</div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;  std::vector&lt;double&gt; internalData(2*fftSize,0.); <span class="comment">// Yes, twice the fftSize</span></div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;  <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> minSize = std::min((<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>) data.size(),fftSize);</div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> j = 0; j &lt; minSize; ++j) {</div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;    internalData[2*j] = data[j];</div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;  }</div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;</div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;  <span class="comment">//if (m_subDisplayFile()) {</span></div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;  <span class="comment">//  *m_subDisplayFile() &lt;&lt; &quot;In Fft&lt;double&gt;::inverse()&quot;</span></div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;  <span class="comment">//                     &lt;&lt; &quot;: about to call gsl_fft_complex_inverse()&quot;</span></div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;  <span class="comment">//                     &lt;&lt; &quot; with fftSize = &quot;         &lt;&lt; fftSize</span></div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;  <span class="comment">//                     &lt;&lt; &quot;; internalData.size() = &quot; &lt;&lt; internalData.size()</span></div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;  <span class="comment">//                     &lt;&lt; std::endl;</span></div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;  <span class="comment">//}</span></div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;</div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;  gsl_fft_complex_workspace* complexWkSpace = gsl_fft_complex_workspace_alloc(fftSize);</div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;  gsl_fft_complex_wavetable* complexWvTable = gsl_fft_complex_wavetable_alloc(fftSize);</div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;</div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;  gsl_fft_complex_inverse(&amp;internalData[0],</div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;                          1,</div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;                          fftSize,</div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;                          complexWvTable,</div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;                          complexWkSpace);</div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;</div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;  gsl_fft_complex_wavetable_free(complexWvTable);</div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;  gsl_fft_complex_workspace_free(complexWkSpace);</div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;</div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;  <span class="comment">//if (m_subDisplayFile()) {</span></div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;  <span class="comment">//  *m_subDisplayFile() &lt;&lt; &quot;In Fft&lt;double&gt;::inverse()&quot;</span></div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;  <span class="comment">//                     &lt;&lt; &quot;: returned from gsl_fft_complex_inverse()&quot;</span></div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;  <span class="comment">//                     &lt;&lt; &quot; with fftSize = &quot;          &lt;&lt; fftSize</span></div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;  <span class="comment">//                     &lt;&lt; &quot;; inverseResult.size() = &quot; &lt;&lt; inverseResult.size()</span></div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;  <span class="comment">//                     &lt;&lt; std::endl;</span></div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;  <span class="comment">//}</span></div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;</div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> j = 0; j &lt; fftSize; ++j) {</div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;    inverseResult[j] = std::complex&lt;double&gt;(internalData[2*j],internalData[2*j+1]);</div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;  }</div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;</div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;  <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a2e1faedd41887115b032b0b45d1f8f58"></a>
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;class T&gt; </div>
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="a00311.html#a3b083519fd2b41d83363afcfd5ebad9d">void</a> <a class="el" href="a00084.html">QUESO::Fft</a>&lt; T &gt;::inverse </td>
          <td>(</td>
          <td class="paramtype">const std::vector&lt; T &gt; &amp;&#160;</td>
          <td class="paramname"><em>data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned int&#160;</td>
          <td class="paramname"><em>fftSize</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::vector&lt; std::complex&lt; double &gt; &gt; &amp;&#160;</td>
          <td class="paramname"><em>result</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calculates the inverse Fourier transform for real and complex data. </p>
<p>This function uses GSL function 'gsl_fft_complex_inverse' to compute the FFT of <code>data</code>, a real array (of time-ordered real data) of length <code>fftSize</code>, using a mixed radix decimation-in-frequency algorithm. There is no restriction on the length <code>fftSize</code>. Efficient modules are provided for subtransforms of length 2, 3, 4 and 5. Any remaining factors are computed with a slow, <img class="formulaInl" alt="$ O(fftSize^2) $" src="form_115.png"/>, general- <code>fftSize</code> module. The caller must supply a wavetable containing trigonometric lookup tables and a workspace work.<br/>
 The definition of the inverse Fourier transform, <img class="formulaInl" alt="$ x = IFFT(z)$" src="form_116.png"/> of size <img class="formulaInl" alt="$ N $" src="form_107.png"/> is: </p>
<p class="formulaDsp">
<img class="formulaDsp" alt="\[ z_j = {1 \over N} \sum_{k=0}^{N-1} x_k \exp(2\pi i j k / N).\]" src="form_117.png"/>
</p>
<p> The factor of <img class="formulaInl" alt="$ 1/N $" src="form_118.png"/> makes this a true inverse. </p>

<p>Referenced by <a class="el" href="a00296_source.html#l01331">QUESO::ScalarSequence&lt; T &gt;::autoCorrViaFft()</a>, and <a class="el" href="a00302_source.html#l02311">QUESO::BaseVectorSequence&lt; V, M &gt;::computeBMM()</a>.</p>

</div>
</div>
<h2 class="groupheader">Member Data Documentation</h2>
<a class="anchor" id="a47bda8b9417d43d94b14d0721b6189e2"></a>
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;class T&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">const <a class="el" href="a00036.html">BaseEnvironment</a>&amp; <a class="el" href="a00084.html">QUESO::Fft</a>&lt; T &gt;::m_env</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="a00449_source.html#l00113">113</a> of file <a class="el" href="a00449_source.html">Fft.h</a>.</p>

</div>
</div>
<hr/>The documentation for this class was generated from the following files:<ul>
<li>src/misc/inc/<a class="el" href="a00449_source.html">Fft.h</a></li>
<li>src/misc/src/<a class="el" href="a00468_source.html">Fft.C</a></li>
</ul>
</div><!-- contents -->
<hr size="1"/><address style="text-align: right;"><small>
Generated on Sat Apr 22 2017 12:47:51 for queso-0.56.2
by&nbsp;<a href="http://www.doxygen.org/index.html">
<em>doxygen</em></a>
1.8.5</small></address>
</body>
</html>
