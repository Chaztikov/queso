<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.5"/>
<title>queso-0.57.0: src/core/src/TeuchosMatrix.C Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">queso-0.57.0
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.5 -->
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>File&#160;Members</span></a></li>
    </ul>
  </div>
<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_974a4f9b5986246761932d409834af31.html">src</a></li><li class="navelem"><a class="el" href="dir_6c3c03b0c6c61440556655ca6259a2f1.html">core</a></li><li class="navelem"><a class="el" href="dir_637b9fe55c797d9c55ffa9eb30124a86.html">src</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">TeuchosMatrix.C</div>  </div>
</div><!--header-->
<div class="contents">
<a href="a00431.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="comment">//-----------------------------------------------------------------------bl-</span></div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="comment">//--------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="comment">// QUESO - a library to support the Quantification of Uncertainty</span></div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="comment">// for Estimation, Simulation and Optimization</span></div>
<div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="comment">// Copyright (C) 2008-2017 The PECOS Development Team</span></div>
<div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="comment">// This library is free software; you can redistribute it and/or</span></div>
<div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="comment">// modify it under the terms of the Version 2.1 GNU Lesser General</span></div>
<div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="comment">// Public License as published by the Free Software Foundation.</span></div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;<span class="comment">// This library is distributed in the hope that it will be useful,</span></div>
<div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;<span class="comment">// but WITHOUT ANY WARRANTY; without even the implied warranty of</span></div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;<span class="comment">// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU</span></div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;<span class="comment">// Lesser General Public License for more details.</span></div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;<span class="comment">// You should have received a copy of the GNU Lesser General Public</span></div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;<span class="comment">// License along with this library; if not, write to the Free Software</span></div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;<span class="comment">// Foundation, Inc. 51 Franklin Street, Fifth Floor,</span></div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;<span class="comment">// Boston, MA  02110-1301  USA</span></div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;<span class="comment">//-----------------------------------------------------------------------el-</span></div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;</div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;<span class="preprocessor">#include &lt;queso/Defines.h&gt;</span></div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;</div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;<span class="preprocessor">#ifdef QUESO_HAS_TRILINOS</span></div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;<span class="preprocessor"></span><span class="preprocessor">#include &lt;queso/TeuchosMatrix.h&gt;</span></div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;<span class="preprocessor">#include &lt;queso/TeuchosVector.h&gt;</span></div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;<span class="preprocessor"></span><span class="preprocessor">#include &lt;sys/time.h&gt;</span></div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;<span class="preprocessor">#include &lt;cmath&gt;</span></div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;</div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;<span class="preprocessor">#ifdef QUESO_HAS_TRILINOS</span></div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;<span class="preprocessor"></span></div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;<span class="keyword">namespace </span>QUESO {</div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;</div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;<span class="keyword">using</span> std:: cout;</div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;<span class="keyword">using</span> std:: endl;</div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;</div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;<span class="comment">// ---------------------------------------------------</span></div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;<span class="comment">// shaped constructor (square/rectangular)------------</span></div>
<div class="line"><a name="l00043"></a><span class="lineno"><a class="line" href="a00227.html#a3aed514dd47d48d91641523e9df234e0">   43</a></span>&#160;<a class="code" href="a00227.html#a1c93b3054debeb1277a4ef0d06a6001d">TeuchosMatrix::TeuchosMatrix</a>( <span class="comment">// can be a rectangular matrix</span></div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;  <span class="keyword">const</span> <a class="code" href="a00036.html">BaseEnvironment</a>&amp; env,</div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;  <span class="keyword">const</span> <a class="code" href="a00162.html">Map</a>&amp;             map,</div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;  <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>                  nCols)</div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;  :</div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;  <a class="code" href="a00164.html">Matrix</a>  (env,map),</div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;  m_inverse      (NULL),</div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;  m_svdColMap    (NULL),</div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;  m_svdUmat      (NULL),</div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;  m_svdSvec      (NULL),</div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;  m_svdVmat      (NULL),</div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;  m_svdVTmat     (NULL),</div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;  m_determinant  (-INFINITY),</div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;  m_lnDeterminant(-INFINITY),</div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;  v_pivoting     (NULL),</div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;  m_signum       (0),</div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;  m_isSingular   (false)</div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;{</div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;  <a class="code" href="a00227.html#a154931850614ec7597e9b134b7d9ffbb">m_mat</a>.shape(map.<a class="code" href="a00162.html#ac67907266dcd7108ffe5a0cbef908781">NumGlobalElements</a>(),nCols);</div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;  <a class="code" href="a00227.html#a6df7300159f5ca3ff664ebca6e3c932f">m_LU</a>.shape(0,0);</div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;}</div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;</div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;<span class="comment">// ---------------------------------------------------</span></div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;<span class="comment">// shaped constructor (square) -----------------------</span></div>
<div class="line"><a name="l00067"></a><span class="lineno"><a class="line" href="a00227.html#ab27c6bcb3216aa88db9582e3c56f5317">   67</a></span>&#160;<a class="code" href="a00227.html#a1c93b3054debeb1277a4ef0d06a6001d">TeuchosMatrix::TeuchosMatrix</a>( <span class="comment">// square matrix</span></div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;  <span class="keyword">const</span> <a class="code" href="a00036.html">BaseEnvironment</a>&amp; env,</div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;  <span class="keyword">const</span> <a class="code" href="a00162.html">Map</a>&amp;             map,</div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;  <span class="keywordtype">double</span>                        diagValue)</div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;  :</div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;  <a class="code" href="a00164.html">Matrix</a>  (env,map),</div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;  m_inverse      (NULL),</div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;  m_svdColMap    (NULL),</div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;  m_svdUmat      (NULL),</div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;  m_svdSvec      (NULL),</div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;  m_svdVmat      (NULL),</div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;  m_svdVTmat     (NULL),</div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;  m_determinant  (-INFINITY),</div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;  m_lnDeterminant(-INFINITY),</div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;  v_pivoting     (NULL),</div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;  m_signum       (0),</div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;  m_isSingular   (false)</div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;{</div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;  <a class="code" href="a00227.html#a154931850614ec7597e9b134b7d9ffbb">m_mat</a>.shape    (map.<a class="code" href="a00162.html#ac67907266dcd7108ffe5a0cbef908781">NumGlobalElements</a>(),map.<a class="code" href="a00162.html#ac67907266dcd7108ffe5a0cbef908781">NumGlobalElements</a>());</div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;  <a class="code" href="a00227.html#a6df7300159f5ca3ff664ebca6e3c932f">m_LU</a>.shape(0,0);</div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;</div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = 0; i &lt; (<span class="keywordtype">unsigned</span> int) <a class="code" href="a00227.html#a154931850614ec7597e9b134b7d9ffbb">m_mat</a>.numRows(); ++i) {</div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;    <a class="code" href="a00227.html#a154931850614ec7597e9b134b7d9ffbb">m_mat</a>(i,i) = diagValue;</div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;  }</div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;}</div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;<span class="comment">// ---------------------------------------------------</span></div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;<span class="comment">// shaped constructor (diagonal) ---------------------</span></div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;<span class="comment">// Kemelli tested on 12/05/12</span></div>
<div class="line"><a name="l00095"></a><span class="lineno"><a class="line" href="a00227.html#a77b8f0d13857c0152778cbfaf378070c">   95</a></span>&#160;<a class="code" href="a00227.html#a1c93b3054debeb1277a4ef0d06a6001d">TeuchosMatrix::TeuchosMatrix</a>( <span class="comment">// square matrix</span></div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;  <span class="keyword">const</span> <a class="code" href="a00228.html">TeuchosVector</a>&amp; v,</div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;  <span class="keywordtype">double</span>                      diagValue)</div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;  :</div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;  <a class="code" href="a00164.html">Matrix</a>  (v.env(),v.map()),</div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;  m_inverse      (NULL),</div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;  m_svdColMap    (NULL),</div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;  m_svdUmat      (NULL),</div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;  m_svdSvec      (NULL),</div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;  m_svdVmat      (NULL),</div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;  m_svdVTmat     (NULL),</div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;  m_determinant  (-INFINITY),</div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;  m_lnDeterminant(-INFINITY),</div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;  v_pivoting     (NULL),</div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;  m_signum       (0),</div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;  m_isSingular   (false)</div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;{</div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160; <a class="code" href="a00227.html#a154931850614ec7597e9b134b7d9ffbb">m_mat</a>.shape    (v.<a class="code" href="a00228.html#aa1d2726c42a9c317898e348fafca6998">sizeLocal</a>(),v.<a class="code" href="a00228.html#aa1d2726c42a9c317898e348fafca6998">sizeLocal</a>());</div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160; <a class="code" href="a00227.html#a6df7300159f5ca3ff664ebca6e3c932f">m_LU</a>.shape(0,0);</div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;</div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160; <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = 0; i &lt; (<span class="keywordtype">unsigned</span> int) <a class="code" href="a00227.html#a154931850614ec7597e9b134b7d9ffbb">m_mat</a>.numRows(); ++i) {</div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;    <a class="code" href="a00227.html#a154931850614ec7597e9b134b7d9ffbb">m_mat</a>(i,i) = diagValue;</div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;  }</div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;}</div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;</div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;<span class="comment">// ---------------------------------------------------</span></div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;<span class="comment">// shaped constructor (diagonal, from vector) --------</span></div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;<span class="comment">// Kemelli, 12/05/12 - tested</span></div>
<div class="line"><a name="l00123"></a><span class="lineno"><a class="line" href="a00227.html#ac932390aaccb0d5b0847eefb5955025f">  123</a></span>&#160;<a class="code" href="a00227.html#a1c93b3054debeb1277a4ef0d06a6001d">TeuchosMatrix::TeuchosMatrix</a>(<span class="keyword">const</span> <a class="code" href="a00228.html">TeuchosVector</a>&amp; v) <span class="comment">// square matrix</span></div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;  :</div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;  <a class="code" href="a00164.html">Matrix</a>  (v.env(),v.map()),</div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;  m_inverse      (NULL),</div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;  m_svdColMap    (NULL),</div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;  m_svdUmat      (NULL),</div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;  m_svdSvec      (NULL),</div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;  m_svdVmat      (NULL),</div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;  m_svdVTmat     (NULL),</div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;  m_determinant  (-INFINITY),</div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;  m_lnDeterminant(-INFINITY),</div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;  v_pivoting     (NULL),</div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;  m_signum       (0),</div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;  m_isSingular   (false)</div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;{</div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;  <a class="code" href="a00227.html#a154931850614ec7597e9b134b7d9ffbb">m_mat</a>.shape    (v.<a class="code" href="a00228.html#aa1d2726c42a9c317898e348fafca6998">sizeLocal</a>(),v.<a class="code" href="a00228.html#aa1d2726c42a9c317898e348fafca6998">sizeLocal</a>());</div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;  <a class="code" href="a00227.html#a6df7300159f5ca3ff664ebca6e3c932f">m_LU</a>.shape(0,0);</div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;</div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;  <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="a00306.html#a70b5e28b5bc3d1b63a7435c5fe50b837">dim</a> =  v.<a class="code" href="a00228.html#aa1d2726c42a9c317898e348fafca6998">sizeLocal</a>();</div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;</div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="a00306.html#a70b5e28b5bc3d1b63a7435c5fe50b837">dim</a>; ++i) {</div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;    <a class="code" href="a00227.html#a154931850614ec7597e9b134b7d9ffbb">m_mat</a>(i,i) = v[i];</div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;  }</div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;}</div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;<span class="comment">// ---------------------------------------------------</span></div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;<span class="comment">// copy constructor-----------------------------------</span></div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;<span class="comment">// Kemelli 12/05/12 - tested</span></div>
<div class="line"><a name="l00150"></a><span class="lineno"><a class="line" href="a00227.html#aedab9e4e971e2c2a63a0babc00e10d95">  150</a></span>&#160;<a class="code" href="a00227.html#a1c93b3054debeb1277a4ef0d06a6001d">TeuchosMatrix::TeuchosMatrix</a>(<span class="keyword">const</span> <a class="code" href="a00227.html">TeuchosMatrix</a>&amp; B) <span class="comment">// can be a rectangular matrix</span></div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;  :</div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;  <a class="code" href="a00164.html">Matrix</a>  (B.env(),B.map()),</div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;  m_inverse      (NULL),</div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;  m_svdColMap    (NULL),</div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;  m_svdUmat      (NULL),</div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;  m_svdSvec      (NULL),</div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;  m_svdVmat      (NULL),</div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;  m_svdVTmat     (NULL),</div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;  m_determinant  (-INFINITY),</div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;  m_lnDeterminant(-INFINITY),</div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;  v_pivoting     (NULL),</div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;  m_signum       (0),</div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;  m_isSingular   (false)</div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;{</div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;  <a class="code" href="a00227.html#a154931850614ec7597e9b134b7d9ffbb">m_mat</a>.shape    (B.<a class="code" href="a00227.html#a78a5b262967d31e6171aadd292e77395">numRowsLocal</a>(),B.<a class="code" href="a00227.html#a6e3aa20d8c618718a9fa9cc56ff65b9f">numCols</a>());</div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;  <a class="code" href="a00227.html#a6df7300159f5ca3ff664ebca6e3c932f">m_LU</a>.shape(0,0);</div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;</div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;  this-&gt;<a class="code" href="a00164.html#a643225869ea7f8371aa638619b8c8990">Matrix::base_copy</a>(B);</div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;  this-&gt;<a class="code" href="a00227.html#a1858cbb278b4cbfca8110133ed4ca19e">copy</a>(B);</div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;}</div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;</div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;<span class="comment">// ---------------------------------------------------</span></div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;<span class="comment">// destructor ----------------------------------------</span></div>
<div class="line"><a name="l00174"></a><span class="lineno"><a class="line" href="a00227.html#ac2918edbd8b9ca1a931bd420ac45054e">  174</a></span>&#160;<a class="code" href="a00227.html#ac2918edbd8b9ca1a931bd420ac45054e">TeuchosMatrix::~TeuchosMatrix</a>()</div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;{</div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;  this-&gt;<a class="code" href="a00227.html#ad2739933c700c0abb7d27aa094f49630">resetLU</a>();</div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;}</div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;</div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;</div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;<span class="comment">// ---------------------------------------------------</span></div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;<span class="comment">// Set methodos --------------------------------------</span></div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;</div>
<div class="line"><a name="l00183"></a><span class="lineno"><a class="line" href="a00227.html#a3215fb5daae7a4a13c4820ec8f7f9725">  183</a></span>&#160;<a class="code" href="a00227.html">TeuchosMatrix</a>&amp; <a class="code" href="a00227.html#a3215fb5daae7a4a13c4820ec8f7f9725">TeuchosMatrix::operator=</a>(<span class="keyword">const</span> <a class="code" href="a00227.html">TeuchosMatrix</a>&amp; obj)</div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;{</div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;  this-&gt;<a class="code" href="a00227.html#ad2739933c700c0abb7d27aa094f49630">resetLU</a>();</div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;  this-&gt;<a class="code" href="a00227.html#a1858cbb278b4cbfca8110133ed4ca19e">copy</a>(obj);</div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;  <span class="keywordflow">return</span> *<span class="keyword">this</span>;</div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;}</div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;</div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;<span class="comment">// ---------------------------------------------------</span></div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;<span class="comment">// Kemelli 12/05/12 - tested</span></div>
<div class="line"><a name="l00192"></a><span class="lineno"><a class="line" href="a00227.html#a95a38a5e8519e0f030107dc7087ac6ed">  192</a></span>&#160;<a class="code" href="a00227.html">TeuchosMatrix</a>&amp; <a class="code" href="a00227.html#a95a38a5e8519e0f030107dc7087ac6ed">TeuchosMatrix::operator*=</a>(<span class="keywordtype">double</span> a)</div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;{</div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;  this-&gt;<a class="code" href="a00227.html#ad2739933c700c0abb7d27aa094f49630">resetLU</a>();</div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;  <span class="keywordtype">int</span> iRC;</div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;  iRC = <a class="code" href="a00227.html#a154931850614ec7597e9b134b7d9ffbb">m_mat</a>.scale(a);</div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;  queso_require_msg(!(iRC), <span class="stringliteral">&quot;scaling failed&quot;</span>);</div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;  <span class="keywordflow">return</span> *<span class="keyword">this</span>;</div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;}</div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;</div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;<span class="comment">// ---------------------------------------------------</span></div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;<span class="comment">// Kemelli 12/05/12 - tested</span></div>
<div class="line"><a name="l00203"></a><span class="lineno"><a class="line" href="a00227.html#a6fd964946622f14f509fdf65c90538ee">  203</a></span>&#160;<a class="code" href="a00227.html">TeuchosMatrix</a>&amp; <a class="code" href="a00227.html#a6fd964946622f14f509fdf65c90538ee">TeuchosMatrix::operator/=</a>(<span class="keywordtype">double</span> a)</div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;{</div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;  this-&gt;<a class="code" href="a00227.html#ad2739933c700c0abb7d27aa094f49630">resetLU</a>();</div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;  <a class="code" href="a00227.html#a154931850614ec7597e9b134b7d9ffbb">m_mat</a>.scale(1./a);</div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;  <span class="keywordflow">return</span> *<span class="keyword">this</span>;</div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;}</div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;</div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;<span class="comment">// ---------------------------------------------------</span></div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;<span class="comment">// Kemelli 12/05/12 - tested</span></div>
<div class="line"><a name="l00212"></a><span class="lineno"><a class="line" href="a00227.html#a1db2c54c46debc003638605253eab5c6">  212</a></span>&#160;<a class="code" href="a00227.html">TeuchosMatrix</a>&amp; <a class="code" href="a00227.html#a1db2c54c46debc003638605253eab5c6">TeuchosMatrix::operator+=</a>(<span class="keyword">const</span> <a class="code" href="a00227.html">TeuchosMatrix</a>&amp; rhs)</div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;{</div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;  this-&gt;<a class="code" href="a00227.html#ad2739933c700c0abb7d27aa094f49630">resetLU</a>();</div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;</div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;  <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i,j, nrows=rhs.<a class="code" href="a00227.html#a78a5b262967d31e6171aadd292e77395">numRowsLocal</a>(), ncols=rhs.<a class="code" href="a00227.html#a6e3aa20d8c618718a9fa9cc56ff65b9f">numCols</a>();</div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;</div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;  <span class="keywordflow">for</span>(i=0; i&lt; nrows ; i++)</div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;    <span class="keywordflow">for</span> (j = 0; j &lt; ncols; j++)</div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;      (*<span class="keyword">this</span>)(i,j) += rhs(i,j);</div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;</div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;  <span class="keywordflow">return</span> *<span class="keyword">this</span>;</div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;}</div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;<span class="comment">// ---------------------------------------------------</span></div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;<span class="comment">// Kemelli 12/05/12 - tested</span></div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;<a class="code" href="a00227.html">TeuchosMatrix</a>&amp;</div>
<div class="line"><a name="l00227"></a><span class="lineno"><a class="line" href="a00227.html#af4f736849f78e1d7b93590fa00323394">  227</a></span>&#160;<a class="code" href="a00227.html#af4f736849f78e1d7b93590fa00323394">TeuchosMatrix::operator-=</a>(<span class="keyword">const</span> <a class="code" href="a00227.html">TeuchosMatrix</a>&amp; rhs)</div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;{</div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;  this-&gt;<a class="code" href="a00227.html#ad2739933c700c0abb7d27aa094f49630">resetLU</a>();</div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;</div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;  <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i,j, nrows=rhs.<a class="code" href="a00227.html#a78a5b262967d31e6171aadd292e77395">numRowsLocal</a>(), ncols=rhs.<a class="code" href="a00227.html#a6e3aa20d8c618718a9fa9cc56ff65b9f">numCols</a>();</div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;</div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;  <span class="keywordflow">for</span>(i=0; i&lt; nrows ; i++)</div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;    <span class="keywordflow">for</span> (j = 0; j &lt; ncols; j++)</div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;      (*<span class="keyword">this</span>)(i,j) -= rhs(i,j);</div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;</div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;  <span class="keywordflow">return</span> *<span class="keyword">this</span>;</div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;}</div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;</div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;<span class="comment">// ---------------------------------------------------</span></div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;<span class="comment">// Accessor methods ----------------------------------</span></div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;</div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;<span class="comment">// Kemelli 12/05/12 - tested</span></div>
<div class="line"><a name="l00244"></a><span class="lineno"><a class="line" href="a00227.html#af6828c79debcbab452e75576d95b8e19">  244</a></span>&#160;<span class="keywordtype">double</span>&amp; <a class="code" href="a00227.html#af6828c79debcbab452e75576d95b8e19">TeuchosMatrix::operator()</a>(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i, <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> j)</div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;{</div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;  this-&gt;<a class="code" href="a00227.html#ad2739933c700c0abb7d27aa094f49630">resetLU</a>();</div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;  <span class="keywordflow">if</span> ((i &gt;= (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>) <a class="code" href="a00227.html#a154931850614ec7597e9b134b7d9ffbb">m_mat</a>.numRows()) ||</div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;      (j &gt;= (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>) <a class="code" href="a00227.html#a154931850614ec7597e9b134b7d9ffbb">m_mat</a>.numCols())) {</div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;    std::cerr &lt;&lt; <span class="stringliteral">&quot;In TeuchosMatrix::operator(i,j) (non-const)&quot;</span></div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;              &lt;&lt; <span class="stringliteral">&quot;: i = &quot;</span> &lt;&lt; i</div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;              &lt;&lt; <span class="stringliteral">&quot;, j = &quot;</span> &lt;&lt; j</div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;              &lt;&lt; <span class="stringliteral">&quot;, m_mat.numRows() = &quot;</span> &lt;&lt; (<span class="keywordtype">unsigned</span> int) <a class="code" href="a00227.html#a154931850614ec7597e9b134b7d9ffbb">m_mat</a>.numRows()</div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;              &lt;&lt; <span class="stringliteral">&quot;, m_mat.numCols() = &quot;</span> &lt;&lt; (<span class="keywordtype">unsigned</span> int) <a class="code" href="a00227.html#a154931850614ec7597e9b134b7d9ffbb">m_mat</a>.numCols()</div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;              &lt;&lt; std::endl;</div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;    queso_require_less_msg(i, (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>) <a class="code" href="a00227.html#a154931850614ec7597e9b134b7d9ffbb">m_mat</a>.numRows(), <span class="stringliteral">&quot;i is too large&quot;</span>);</div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;    queso_require_less_msg(j, (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>) <a class="code" href="a00227.html#a154931850614ec7597e9b134b7d9ffbb">m_mat</a>.numCols(), <span class="stringliteral">&quot;j is too large&quot;</span>);</div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;  }</div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="a00227.html#a154931850614ec7597e9b134b7d9ffbb">m_mat</a>(i,j);</div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;}</div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;</div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;<span class="comment">// ---------------------------------------------------</span></div>
<div class="line"><a name="l00262"></a><span class="lineno"><a class="line" href="a00227.html#a95546fe786a603b59ea7e9f1aae647d2">  262</a></span>&#160;<span class="keyword">const</span> <span class="keywordtype">double</span>&amp; <a class="code" href="a00227.html#af6828c79debcbab452e75576d95b8e19">TeuchosMatrix::operator()</a>(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i, <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> j)<span class="keyword"> const</span></div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;<span class="keyword"></span>{</div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;  queso_require_less_msg(i, (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>) <a class="code" href="a00227.html#a154931850614ec7597e9b134b7d9ffbb">m_mat</a>.numRows(), <span class="stringliteral">&quot;i is too large&quot;</span>);</div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;  queso_require_less_msg(j, (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>) <a class="code" href="a00227.html#a154931850614ec7597e9b134b7d9ffbb">m_mat</a>.numCols(), <span class="stringliteral">&quot;j is too large&quot;</span>);</div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="a00227.html#a154931850614ec7597e9b134b7d9ffbb">m_mat</a>(i,j);</div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;}</div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;</div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;<span class="comment">// ---------------------------------------------------</span></div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;<span class="comment">// Attribute methods ---------------------------------</span></div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;</div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;<span class="comment">// Kemelli 12/05/12 - tested</span></div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span></div>
<div class="line"><a name="l00274"></a><span class="lineno"><a class="line" href="a00227.html#a78a5b262967d31e6171aadd292e77395">  274</a></span>&#160;<a class="code" href="a00227.html#a78a5b262967d31e6171aadd292e77395">TeuchosMatrix::numRowsLocal</a>()<span class="keyword"> const</span></div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;<span class="keyword"></span>{</div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;  <span class="keywordflow">return</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>) <a class="code" href="a00227.html#a154931850614ec7597e9b134b7d9ffbb">m_mat</a>.numRows();</div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;}</div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;</div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;<span class="comment">// ---------------------------------------------------</span></div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;<span class="comment">// Kemelli 12/05/12 - tested</span></div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span></div>
<div class="line"><a name="l00282"></a><span class="lineno"><a class="line" href="a00227.html#a2e0cc4998dfb5c3d3de7efaec012b87f">  282</a></span>&#160;<a class="code" href="a00227.html#a2e0cc4998dfb5c3d3de7efaec012b87f">TeuchosMatrix::numRowsGlobal</a>()<span class="keyword"> const</span></div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;<span class="keyword"></span>{</div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;  <span class="keywordflow">return</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>) <a class="code" href="a00227.html#a154931850614ec7597e9b134b7d9ffbb">m_mat</a>.numRows();</div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;}</div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;</div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;<span class="comment">// ---------------------------------------------------</span></div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;<span class="comment">// Kemelli 12/05/12 - tested</span></div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span></div>
<div class="line"><a name="l00290"></a><span class="lineno"><a class="line" href="a00227.html#a6e3aa20d8c618718a9fa9cc56ff65b9f">  290</a></span>&#160;<a class="code" href="a00227.html#a6e3aa20d8c618718a9fa9cc56ff65b9f">TeuchosMatrix::numCols</a>()<span class="keyword"> const</span></div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;<span class="keyword"></span>{</div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;  <span class="keywordflow">return</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>) <a class="code" href="a00227.html#a154931850614ec7597e9b134b7d9ffbb">m_mat</a>.numCols();</div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;};</div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;</div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;<span class="comment">// ---------------------------------------------------</span></div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;<span class="comment">// Kemelli 12/05/12 - tested</span></div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;<span class="keywordtype">double</span>*</div>
<div class="line"><a name="l00298"></a><span class="lineno"><a class="line" href="a00227.html#a22c82a6fb78541a113f65753d9303448">  298</a></span>&#160;<a class="code" href="a00227.html#a22c82a6fb78541a113f65753d9303448">TeuchosMatrix::values</a>()</div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;{</div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;  <span class="keywordflow">return</span>  <a class="code" href="a00227.html#a154931850614ec7597e9b134b7d9ffbb">m_mat</a>.values();</div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;};</div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;</div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;<span class="comment">// ---------------------------------------------------</span></div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;<span class="comment">// Kemelli 12/05/12 - tested</span></div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;<span class="keywordtype">int</span></div>
<div class="line"><a name="l00306"></a><span class="lineno"><a class="line" href="a00227.html#aaba42e724f7b422d69f6ebe1cb40d0df">  306</a></span>&#160;<a class="code" href="a00227.html#aaba42e724f7b422d69f6ebe1cb40d0df">TeuchosMatrix::stride</a>()</div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;{</div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;  <span class="keywordflow">return</span>  <a class="code" href="a00227.html#a154931850614ec7597e9b134b7d9ffbb">m_mat</a>.stride();</div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;};</div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;</div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;</div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;</div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;<span class="comment">// ---------------------------------------------------</span></div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;<span class="keywordtype">double</span></div>
<div class="line"><a name="l00315"></a><span class="lineno"><a class="line" href="a00227.html#a23860d08ecf0f3ec2683811dbaeda14c">  315</a></span>&#160;<a class="code" href="a00227.html#a23860d08ecf0f3ec2683811dbaeda14c">TeuchosMatrix::max</a>()<span class="keyword"> const</span></div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;<span class="keyword"></span>{</div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;  <span class="keywordtype">double</span> value = -INFINITY;</div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;</div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;  <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> nRows = this-&gt;<a class="code" href="a00227.html#a78a5b262967d31e6171aadd292e77395">numRowsLocal</a>();</div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;  <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> nCols = this-&gt;<a class="code" href="a00227.html#a6e3aa20d8c618718a9fa9cc56ff65b9f">numCols</a>();</div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;  <span class="keywordtype">double</span> aux = 0.;</div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = 0; i &lt; nRows; i++) {</div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> j = 0; j &lt; nCols; j++) {</div>
<div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;      aux = (*this)(i,j);</div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;      <span class="keywordflow">if</span> (aux &gt; value) value = aux;</div>
<div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;    }</div>
<div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;  }</div>
<div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;</div>
<div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;  <span class="keywordflow">return</span> value;</div>
<div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;}</div>
<div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;</div>
<div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;</div>
<div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;<span class="comment">// ---------------------------------------------------</span></div>
<div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span></div>
<div class="line"><a name="l00335"></a><span class="lineno"><a class="line" href="a00227.html#aec68ff5ba30a3fbacad6e2c2ef278d07">  335</a></span>&#160;<a class="code" href="a00227.html#aec68ff5ba30a3fbacad6e2c2ef278d07">TeuchosMatrix::rank</a>(<span class="keywordtype">double</span> absoluteZeroThreshold, <span class="keywordtype">double</span> relativeZeroThreshold)<span class="keyword"> const</span></div>
<div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;<span class="keyword"></span>{</div>
<div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;  <span class="keywordtype">int</span> iRC = 0;</div>
<div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;  iRC = <a class="code" href="a00227.html#a6a0ed6fd46f5b06c571a59f6678a3380">internalSvd</a>();</div>
<div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;  <span class="keywordflow">if</span> (iRC) {}; <span class="comment">// just to remove compiler warning</span></div>
<div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;</div>
<div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;  <a class="code" href="a00228.html">TeuchosVector</a> relativeVec(*<a class="code" href="a00227.html#a7b20f299e99f5bbe86053ca5c720f9f7">m_svdSvec</a>);</div>
<div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;  <span class="keywordflow">if</span> (relativeVec[0] &gt; 0.) {</div>
<div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;    relativeVec = (1./relativeVec[0])*relativeVec;</div>
<div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;  }</div>
<div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;</div>
<div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;  <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> rankValue = 0;</div>
<div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = 0; i &lt; relativeVec.<a class="code" href="a00228.html#aa1d2726c42a9c317898e348fafca6998">sizeLocal</a>(); ++i) {</div>
<div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;    <span class="keywordflow">if</span> (( (*<a class="code" href="a00227.html#a7b20f299e99f5bbe86053ca5c720f9f7">m_svdSvec</a>)[i] &gt;= absoluteZeroThreshold ) &amp;&amp;</div>
<div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;        ( relativeVec [i] &gt;= relativeZeroThreshold )) {</div>
<div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;       rankValue += 1;</div>
<div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;    }</div>
<div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;  }</div>
<div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;</div>
<div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;  <span class="keywordflow">if</span> ((<a class="code" href="a00164.html#a247fb0fc0b87fecdee054bb4660b68e8">m_env</a>.<a class="code" href="a00036.html#a8a0064746ae8dddfece4229b9ad374d6">subDisplayFile</a>()) &amp;&amp; (<a class="code" href="a00164.html#a247fb0fc0b87fecdee054bb4660b68e8">m_env</a>.<a class="code" href="a00036.html#a1fe5f244fc0316a0ab3e37463f108b96">displayVerbosity</a>() &gt;= 3)) {</div>
<div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;    *<a class="code" href="a00164.html#a247fb0fc0b87fecdee054bb4660b68e8">m_env</a>.<a class="code" href="a00036.html#a8a0064746ae8dddfece4229b9ad374d6">subDisplayFile</a>() &lt;&lt; <span class="stringliteral">&quot;In TeuchosMatrix::rank()&quot;</span></div>
<div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;                            &lt;&lt; <span class="stringliteral">&quot;: this-&gt;numRowsLocal() = &quot;</span>  &lt;&lt; this-&gt;<a class="code" href="a00227.html#a78a5b262967d31e6171aadd292e77395">numRowsLocal</a>()</div>
<div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;                            &lt;&lt; <span class="stringliteral">&quot;, this-&gt;numCols() = &quot;</span>       &lt;&lt; this-&gt;<a class="code" href="a00227.html#a6e3aa20d8c618718a9fa9cc56ff65b9f">numCols</a>()</div>
<div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;                            &lt;&lt; <span class="stringliteral">&quot;, absoluteZeroThreshold = &quot;</span> &lt;&lt; absoluteZeroThreshold</div>
<div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;                            &lt;&lt; <span class="stringliteral">&quot;, relativeZeroThreshold = &quot;</span> &lt;&lt; relativeZeroThreshold</div>
<div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;                            &lt;&lt; <span class="stringliteral">&quot;, rankValue = &quot;</span>             &lt;&lt; rankValue</div>
<div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;                            &lt;&lt; <span class="stringliteral">&quot;, m_svdSvec = &quot;</span>             &lt;&lt; *<a class="code" href="a00227.html#a7b20f299e99f5bbe86053ca5c720f9f7">m_svdSvec</a></div>
<div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;                            &lt;&lt; <span class="stringliteral">&quot;, relativeVec = &quot;</span>           &lt;&lt; relativeVec</div>
<div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;                            &lt;&lt; std::endl;</div>
<div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;  }</div>
<div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;</div>
<div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;  <span class="keywordflow">return</span> rankValue;</div>
<div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;}</div>
<div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;</div>
<div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;<span class="comment">// ---------------------------------------------------</span></div>
<div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;<span class="comment">// checked 1/07/13</span></div>
<div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;<a class="code" href="a00227.html">TeuchosMatrix</a></div>
<div class="line"><a name="l00372"></a><span class="lineno"><a class="line" href="a00227.html#a9a415d3d463c4620ac59e3f7476bc6c9">  372</a></span>&#160;<a class="code" href="a00227.html#a9a415d3d463c4620ac59e3f7476bc6c9">TeuchosMatrix::transpose</a>()<span class="keyword"> const</span></div>
<div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;<span class="keyword"></span>{</div>
<div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;  <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> nRows = this-&gt;<a class="code" href="a00227.html#a78a5b262967d31e6171aadd292e77395">numRowsLocal</a>();</div>
<div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;  <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> nCols = this-&gt;<a class="code" href="a00227.html#a6e3aa20d8c618718a9fa9cc56ff65b9f">numCols</a>();</div>
<div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;</div>
<div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;  <a class="code" href="a00674.html#ace699c1e7716717f330c783a58ebcd4f">queso_require_equal_to_msg</a>(nRows, nCols, <span class="stringliteral">&quot;routine works only for square matrices&quot;</span>);</div>
<div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;</div>
<div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;  <a class="code" href="a00227.html">TeuchosMatrix</a> mat(<a class="code" href="a00164.html#a247fb0fc0b87fecdee054bb4660b68e8">m_env</a>,<a class="code" href="a00164.html#a95e307c6e1263d505af0a43c35f81a8b">m_map</a>,nCols);</div>
<div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> row = 0; row &lt; nRows; ++row) {</div>
<div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> col = 0; col &lt; nCols; ++col) {</div>
<div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;      mat(row,col) = (*this)(col,row);</div>
<div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;    }</div>
<div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;  }</div>
<div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;</div>
<div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;  <span class="keywordflow">return</span> mat;</div>
<div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;}</div>
<div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;</div>
<div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;<span class="comment">// ---------------------------------------------------</span></div>
<div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;<span class="comment">// tested 1/31/13</span></div>
<div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;<a class="code" href="a00227.html">TeuchosMatrix</a></div>
<div class="line"><a name="l00392"></a><span class="lineno"><a class="line" href="a00227.html#aba7a03164e995005cc82e45b78975c19">  392</a></span>&#160;<a class="code" href="a00227.html#aba7a03164e995005cc82e45b78975c19">TeuchosMatrix::inverse</a>()<span class="keyword"> const</span></div>
<div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;<span class="keyword"></span>{</div>
<div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;  <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> nRows = this-&gt;<a class="code" href="a00227.html#a78a5b262967d31e6171aadd292e77395">numRowsLocal</a>();</div>
<div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;  <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> nCols = this-&gt;<a class="code" href="a00227.html#a6e3aa20d8c618718a9fa9cc56ff65b9f">numCols</a>();</div>
<div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;</div>
<div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;  <a class="code" href="a00674.html#ace699c1e7716717f330c783a58ebcd4f">queso_require_equal_to_msg</a>(nRows, nCols, <span class="stringliteral">&quot;matrix is not square&quot;</span>);</div>
<div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;</div>
<div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="a00227.html#a4dc7e5ac8a92c5151771b785a7dfa8aa">m_inverse</a> == NULL) {</div>
<div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;    <a class="code" href="a00227.html#a4dc7e5ac8a92c5151771b785a7dfa8aa">m_inverse</a> = <span class="keyword">new</span> <a class="code" href="a00227.html#a1c93b3054debeb1277a4ef0d06a6001d">TeuchosMatrix</a>(<a class="code" href="a00164.html#a247fb0fc0b87fecdee054bb4660b68e8">m_env</a>,<a class="code" href="a00164.html#a95e307c6e1263d505af0a43c35f81a8b">m_map</a>,nCols);</div>
<div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;    <a class="code" href="a00228.html">TeuchosVector</a> unitVector(<a class="code" href="a00164.html#a247fb0fc0b87fecdee054bb4660b68e8">m_env</a>,<a class="code" href="a00164.html#a95e307c6e1263d505af0a43c35f81a8b">m_map</a>);</div>
<div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;    unitVector.<a class="code" href="a00228.html#ac8ec998ac054f3a726bb14d1df05e7d7">cwSet</a>(0.);</div>
<div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;    <a class="code" href="a00228.html">TeuchosVector</a> multVector(<a class="code" href="a00164.html#a247fb0fc0b87fecdee054bb4660b68e8">m_env</a>,<a class="code" href="a00164.html#a95e307c6e1263d505af0a43c35f81a8b">m_map</a>);</div>
<div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> j = 0; j &lt; nCols; ++j) {</div>
<div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;      <span class="keywordflow">if</span> (j &gt; 0) unitVector[j-1] = 0.;</div>
<div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;      unitVector[j] = 1.;</div>
<div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;      this-&gt;<a class="code" href="a00227.html#a4f3affd6522fafb794e2cc36a382ccc9">invertMultiply</a>(unitVector, multVector);</div>
<div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = 0; i &lt; nRows; ++i) {</div>
<div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;        (*m_inverse)(i,j) = multVector[i];</div>
<div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;      }</div>
<div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;    }</div>
<div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;  }</div>
<div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="a00164.html#a247fb0fc0b87fecdee054bb4660b68e8">m_env</a>.<a class="code" href="a00036.html#a83c1c036f81651792a74975f2da23ae1">checkingLevel</a>() &gt;= 1) {</div>
<div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;    *<a class="code" href="a00164.html#a247fb0fc0b87fecdee054bb4660b68e8">m_env</a>.<a class="code" href="a00036.html#a8a0064746ae8dddfece4229b9ad374d6">subDisplayFile</a>() &lt;&lt; <span class="stringliteral">&quot;CHECKING In TeuchosMatrix::inverse()&quot;</span></div>
<div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;                            &lt;&lt; <span class="stringliteral">&quot;: M.lnDet = &quot;</span>      &lt;&lt; this-&gt;<a class="code" href="a00227.html#ae343b697c04a1716ce73e69f7e4f61e6">lnDeterminant</a>()</div>
<div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;                            &lt;&lt; <span class="stringliteral">&quot;, M^{-1}.lnDet = &quot;</span> &lt;&lt; <a class="code" href="a00227.html#a4dc7e5ac8a92c5151771b785a7dfa8aa">m_inverse</a>-&gt;<a class="code" href="a00227.html#ae343b697c04a1716ce73e69f7e4f61e6">lnDeterminant</a>()</div>
<div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;                            &lt;&lt; std::endl;</div>
<div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;  }</div>
<div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;  <span class="keywordflow">if</span> ((<a class="code" href="a00164.html#a247fb0fc0b87fecdee054bb4660b68e8">m_env</a>.<a class="code" href="a00036.html#a8a0064746ae8dddfece4229b9ad374d6">subDisplayFile</a>()) &amp;&amp; (<a class="code" href="a00164.html#a247fb0fc0b87fecdee054bb4660b68e8">m_env</a>.<a class="code" href="a00036.html#a1fe5f244fc0316a0ab3e37463f108b96">displayVerbosity</a>() &gt;= 5)) {</div>
<div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;    *<a class="code" href="a00164.html#a247fb0fc0b87fecdee054bb4660b68e8">m_env</a>.<a class="code" href="a00036.html#a8a0064746ae8dddfece4229b9ad374d6">subDisplayFile</a>() &lt;&lt; <span class="stringliteral">&quot;In TeuchosMatrix::inverse():&quot;</span></div>
<div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;                            &lt;&lt; <span class="stringliteral">&quot;\n M = &quot;</span>        &lt;&lt; *<span class="keyword">this</span></div>
<div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;                            &lt;&lt; <span class="stringliteral">&quot;\n M^{-1} = &quot;</span>   &lt;&lt; *<a class="code" href="a00227.html#a4dc7e5ac8a92c5151771b785a7dfa8aa">m_inverse</a></div>
<div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;                            &lt;&lt; <span class="stringliteral">&quot;\n M*M^{-1} = &quot;</span> &lt;&lt; (*this)*(*m_inverse)</div>
<div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;                            &lt;&lt; <span class="stringliteral">&quot;\n M^{-1}*M = &quot;</span> &lt;&lt; (*m_inverse)*(*this)</div>
<div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;                            &lt;&lt; std::endl;</div>
<div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;  }</div>
<div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;</div>
<div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;<span class="comment">/* cout &lt;&lt; &quot;Inverse ---------------------\n&quot;;</span></div>
<div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;<span class="comment">   for (int i=0; i&lt;m_inverse-&gt;numRowsLocal(); i++) {</span></div>
<div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;<span class="comment">     for (int j=0; j&lt;m_inverse-&gt;numCols(); j++)</span></div>
<div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;<span class="comment">       cout&lt;&lt; m_inverse-&gt;m_mat(i,j) &lt;&lt; &quot; &quot;;</span></div>
<div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;<span class="comment">     cout &lt;&lt; endl;</span></div>
<div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;<span class="comment">   }</span></div>
<div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;<span class="comment">   cout &lt;&lt; endl;</span></div>
<div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;<span class="comment">*/</span></div>
<div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;  <span class="keywordflow">return</span> *<a class="code" href="a00227.html#a4dc7e5ac8a92c5151771b785a7dfa8aa">m_inverse</a>;</div>
<div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;}</div>
<div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;</div>
<div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;<span class="comment">// ----------------------------------------------</span></div>
<div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;<span class="comment">//checked 12/10/12</span></div>
<div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;<span class="keywordtype">double</span></div>
<div class="line"><a name="l00442"></a><span class="lineno"><a class="line" href="a00227.html#a9c251746e569e5b51231bcfe939e13c7">  442</a></span>&#160;<a class="code" href="a00227.html#a9c251746e569e5b51231bcfe939e13c7">TeuchosMatrix::determinant</a>()<span class="keyword"> const</span></div>
<div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;<span class="keyword"></span>{</div>
<div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="a00227.html#a8e80ebb3c4e6720bf35c5f5a214a3c1f">m_determinant</a> == -INFINITY)</div>
<div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;  {</div>
<div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;    <span class="keywordflow">if</span>(<a class="code" href="a00227.html#a6df7300159f5ca3ff664ebca6e3c932f">m_LU</a>.numRows() ==0 &amp;&amp; <a class="code" href="a00227.html#a6df7300159f5ca3ff664ebca6e3c932f">m_LU</a>.numCols() ==0)  <span class="comment">//dummy</span></div>
<div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;    {</div>
<div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;      <a class="code" href="a00228.html">TeuchosVector</a> tmpB(<a class="code" href="a00164.html#a247fb0fc0b87fecdee054bb4660b68e8">m_env</a>,<a class="code" href="a00164.html#a95e307c6e1263d505af0a43c35f81a8b">m_map</a>);</div>
<div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;      <a class="code" href="a00228.html">TeuchosVector</a> tmpX(<a class="code" href="a00164.html#a247fb0fc0b87fecdee054bb4660b68e8">m_env</a>,<a class="code" href="a00164.html#a95e307c6e1263d505af0a43c35f81a8b">m_map</a>);</div>
<div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;      <span class="keywordflow">if</span> ((<a class="code" href="a00164.html#a247fb0fc0b87fecdee054bb4660b68e8">m_env</a>.<a class="code" href="a00036.html#a8a0064746ae8dddfece4229b9ad374d6">subDisplayFile</a>()) &amp;&amp; (<a class="code" href="a00164.html#a247fb0fc0b87fecdee054bb4660b68e8">m_env</a>.<a class="code" href="a00036.html#a1fe5f244fc0316a0ab3e37463f108b96">displayVerbosity</a>() &gt;= 99)) {</div>
<div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;        *<a class="code" href="a00164.html#a247fb0fc0b87fecdee054bb4660b68e8">m_env</a>.<a class="code" href="a00036.html#a8a0064746ae8dddfece4229b9ad374d6">subDisplayFile</a>() &lt;&lt; <span class="stringliteral">&quot;In TeuchosMatrix::lnDeterminant()&quot;</span></div>
<div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;                                &lt;&lt; <span class="stringliteral">&quot;: before &#39;this-&gt;invertMultiply()&#39;&quot;</span></div>
<div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;                                &lt;&lt; std::endl;</div>
<div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;      }</div>
<div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;      this-&gt;<a class="code" href="a00227.html#a4f3affd6522fafb794e2cc36a382ccc9">invertMultiply</a>(tmpB,tmpX);</div>
<div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;      <span class="keywordflow">if</span> ((<a class="code" href="a00164.html#a247fb0fc0b87fecdee054bb4660b68e8">m_env</a>.<a class="code" href="a00036.html#a8a0064746ae8dddfece4229b9ad374d6">subDisplayFile</a>()) &amp;&amp; (<a class="code" href="a00164.html#a247fb0fc0b87fecdee054bb4660b68e8">m_env</a>.<a class="code" href="a00036.html#a1fe5f244fc0316a0ab3e37463f108b96">displayVerbosity</a>() &gt;= 99)) {</div>
<div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;        *<a class="code" href="a00164.html#a247fb0fc0b87fecdee054bb4660b68e8">m_env</a>.<a class="code" href="a00036.html#a8a0064746ae8dddfece4229b9ad374d6">subDisplayFile</a>() &lt;&lt; <span class="stringliteral">&quot;In TeuchosMatrix::lnDeterminant()&quot;</span></div>
<div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;                                &lt;&lt; <span class="stringliteral">&quot;: after &#39;this-&gt;invertMultiply()&#39;&quot;</span></div>
<div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;                                &lt;&lt; std::endl;</div>
<div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;      }</div>
<div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;    }</div>
<div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;    <span class="keywordflow">if</span> ((<a class="code" href="a00164.html#a247fb0fc0b87fecdee054bb4660b68e8">m_env</a>.<a class="code" href="a00036.html#a8a0064746ae8dddfece4229b9ad374d6">subDisplayFile</a>()) &amp;&amp; (<a class="code" href="a00164.html#a247fb0fc0b87fecdee054bb4660b68e8">m_env</a>.<a class="code" href="a00036.html#a1fe5f244fc0316a0ab3e37463f108b96">displayVerbosity</a>() &gt;= 99)) {</div>
<div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;      *<a class="code" href="a00164.html#a247fb0fc0b87fecdee054bb4660b68e8">m_env</a>.<a class="code" href="a00036.html#a8a0064746ae8dddfece4229b9ad374d6">subDisplayFile</a>() &lt;&lt; <span class="stringliteral">&quot;In TeuchosMatrix::lnDeterminant()&quot;</span></div>
<div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;                              &lt;&lt; <span class="stringliteral">&quot;: before computing det&quot;</span></div>
<div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;                              &lt;&lt; std::endl;</div>
<div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;    }</div>
<div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;</div>
<div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;    <span class="keywordtype">double</span> det   = 1.0;</div>
<div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;    <span class="keywordtype">double</span> lnDet = 0.0;</div>
<div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0;i&lt;<a class="code" href="a00227.html#a6df7300159f5ca3ff664ebca6e3c932f">m_LU</a>.numCols();i++) {</div>
<div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;      det   *= <a class="code" href="a00227.html#a6df7300159f5ca3ff664ebca6e3c932f">m_LU</a>(i,i);</div>
<div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;      lnDet += std::log(<a class="code" href="a00227.html#a6df7300159f5ca3ff664ebca6e3c932f">m_LU</a>(i,i));</div>
<div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;    }</div>
<div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;</div>
<div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;    <a class="code" href="a00227.html#a8e80ebb3c4e6720bf35c5f5a214a3c1f">m_determinant</a>   = det;</div>
<div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;    <a class="code" href="a00227.html#a665ce7c3ecf4ba47c8b00ffebd06f438">m_lnDeterminant</a> = lnDet;</div>
<div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;</div>
<div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;    <span class="keywordflow">if</span> ((<a class="code" href="a00164.html#a247fb0fc0b87fecdee054bb4660b68e8">m_env</a>.<a class="code" href="a00036.html#a8a0064746ae8dddfece4229b9ad374d6">subDisplayFile</a>()) &amp;&amp; (<a class="code" href="a00164.html#a247fb0fc0b87fecdee054bb4660b68e8">m_env</a>.<a class="code" href="a00036.html#a1fe5f244fc0316a0ab3e37463f108b96">displayVerbosity</a>() &gt;= 99)) {</div>
<div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;      *<a class="code" href="a00164.html#a247fb0fc0b87fecdee054bb4660b68e8">m_env</a>.<a class="code" href="a00036.html#a8a0064746ae8dddfece4229b9ad374d6">subDisplayFile</a>() &lt;&lt; <span class="stringliteral">&quot;In TeuchosMatrix::lnDeterminant()&quot;</span></div>
<div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;                              &lt;&lt; <span class="stringliteral">&quot;: after computing det&quot;</span></div>
<div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;                              &lt;&lt; std::endl;</div>
<div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;    }</div>
<div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;  }</div>
<div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;</div>
<div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="a00227.html#a8e80ebb3c4e6720bf35c5f5a214a3c1f">m_determinant</a>;</div>
<div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;}</div>
<div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;</div>
<div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;<span class="comment">// ----------------------------------------------</span></div>
<div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;<span class="comment">//checked 12/10/12</span></div>
<div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;<span class="keywordtype">double</span></div>
<div class="line"><a name="l00491"></a><span class="lineno"><a class="line" href="a00227.html#ae343b697c04a1716ce73e69f7e4f61e6">  491</a></span>&#160;<a class="code" href="a00227.html#ae343b697c04a1716ce73e69f7e4f61e6">TeuchosMatrix::lnDeterminant</a>()<span class="keyword"> const</span></div>
<div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;<span class="keyword"></span>{</div>
<div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="a00227.html#a665ce7c3ecf4ba47c8b00ffebd06f438">m_lnDeterminant</a> == -INFINITY)</div>
<div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;  {</div>
<div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;    <span class="keywordflow">if</span>(<a class="code" href="a00227.html#a6df7300159f5ca3ff664ebca6e3c932f">m_LU</a>.numRows() ==0 &amp;&amp; <a class="code" href="a00227.html#a6df7300159f5ca3ff664ebca6e3c932f">m_LU</a>.numCols() ==0)  <span class="comment">//dummy</span></div>
<div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;    {</div>
<div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;      <a class="code" href="a00228.html">TeuchosVector</a> tmpB(<a class="code" href="a00164.html#a247fb0fc0b87fecdee054bb4660b68e8">m_env</a>,<a class="code" href="a00164.html#a95e307c6e1263d505af0a43c35f81a8b">m_map</a>);</div>
<div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;      <a class="code" href="a00228.html">TeuchosVector</a> tmpX(<a class="code" href="a00164.html#a247fb0fc0b87fecdee054bb4660b68e8">m_env</a>,<a class="code" href="a00164.html#a95e307c6e1263d505af0a43c35f81a8b">m_map</a>);</div>
<div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;      <span class="keywordflow">if</span> ((<a class="code" href="a00164.html#a247fb0fc0b87fecdee054bb4660b68e8">m_env</a>.<a class="code" href="a00036.html#a8a0064746ae8dddfece4229b9ad374d6">subDisplayFile</a>()) &amp;&amp; (<a class="code" href="a00164.html#a247fb0fc0b87fecdee054bb4660b68e8">m_env</a>.<a class="code" href="a00036.html#a1fe5f244fc0316a0ab3e37463f108b96">displayVerbosity</a>() &gt;= 99)) {</div>
<div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;        *<a class="code" href="a00164.html#a247fb0fc0b87fecdee054bb4660b68e8">m_env</a>.<a class="code" href="a00036.html#a8a0064746ae8dddfece4229b9ad374d6">subDisplayFile</a>() &lt;&lt; <span class="stringliteral">&quot;In TeuchosMatrix::lnDeterminant()&quot;</span></div>
<div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;                                &lt;&lt; <span class="stringliteral">&quot;: before &#39;this-&gt;invertMultiply()&#39;&quot;</span></div>
<div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;                                &lt;&lt; std::endl;</div>
<div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;      }</div>
<div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;      this-&gt;<a class="code" href="a00227.html#a4f3affd6522fafb794e2cc36a382ccc9">invertMultiply</a>(tmpB,tmpX);</div>
<div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;      <span class="keywordflow">if</span> ((<a class="code" href="a00164.html#a247fb0fc0b87fecdee054bb4660b68e8">m_env</a>.<a class="code" href="a00036.html#a8a0064746ae8dddfece4229b9ad374d6">subDisplayFile</a>()) &amp;&amp; (<a class="code" href="a00164.html#a247fb0fc0b87fecdee054bb4660b68e8">m_env</a>.<a class="code" href="a00036.html#a1fe5f244fc0316a0ab3e37463f108b96">displayVerbosity</a>() &gt;= 99)) {</div>
<div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;        *<a class="code" href="a00164.html#a247fb0fc0b87fecdee054bb4660b68e8">m_env</a>.<a class="code" href="a00036.html#a8a0064746ae8dddfece4229b9ad374d6">subDisplayFile</a>() &lt;&lt; <span class="stringliteral">&quot;In TeuchosMatrix::lnDeterminant()&quot;</span></div>
<div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;                                &lt;&lt; <span class="stringliteral">&quot;: after &#39;this-&gt;invertMultiply()&#39;&quot;</span></div>
<div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;                                &lt;&lt; std::endl;</div>
<div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;      }</div>
<div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;    }</div>
<div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;    <span class="keywordflow">if</span> ((<a class="code" href="a00164.html#a247fb0fc0b87fecdee054bb4660b68e8">m_env</a>.<a class="code" href="a00036.html#a8a0064746ae8dddfece4229b9ad374d6">subDisplayFile</a>()) &amp;&amp; (<a class="code" href="a00164.html#a247fb0fc0b87fecdee054bb4660b68e8">m_env</a>.<a class="code" href="a00036.html#a1fe5f244fc0316a0ab3e37463f108b96">displayVerbosity</a>() &gt;= 99)) {</div>
<div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;      *<a class="code" href="a00164.html#a247fb0fc0b87fecdee054bb4660b68e8">m_env</a>.<a class="code" href="a00036.html#a8a0064746ae8dddfece4229b9ad374d6">subDisplayFile</a>() &lt;&lt; <span class="stringliteral">&quot;In TeuchosMatrix::lnDeterminant()&quot;</span></div>
<div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;                              &lt;&lt; <span class="stringliteral">&quot;: before computing lnDet&quot;</span></div>
<div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;                              &lt;&lt; std::endl;</div>
<div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;    }</div>
<div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;</div>
<div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;    <span class="keywordtype">double</span> det   = 1.0;</div>
<div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;    <span class="keywordtype">double</span> lnDet = 0.0;</div>
<div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0;i&lt;<a class="code" href="a00227.html#a6df7300159f5ca3ff664ebca6e3c932f">m_LU</a>.numCols();i++) {</div>
<div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;      det   *= <a class="code" href="a00227.html#a6df7300159f5ca3ff664ebca6e3c932f">m_LU</a>(i,i);</div>
<div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;      lnDet += std::log(<a class="code" href="a00227.html#a6df7300159f5ca3ff664ebca6e3c932f">m_LU</a>(i,i));</div>
<div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;    }</div>
<div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;</div>
<div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;    <a class="code" href="a00227.html#a8e80ebb3c4e6720bf35c5f5a214a3c1f">m_determinant</a>   = det;</div>
<div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;    <a class="code" href="a00227.html#a665ce7c3ecf4ba47c8b00ffebd06f438">m_lnDeterminant</a> = lnDet;</div>
<div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;</div>
<div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;    <span class="keywordflow">if</span> ((<a class="code" href="a00164.html#a247fb0fc0b87fecdee054bb4660b68e8">m_env</a>.<a class="code" href="a00036.html#a8a0064746ae8dddfece4229b9ad374d6">subDisplayFile</a>()) &amp;&amp; (<a class="code" href="a00164.html#a247fb0fc0b87fecdee054bb4660b68e8">m_env</a>.<a class="code" href="a00036.html#a1fe5f244fc0316a0ab3e37463f108b96">displayVerbosity</a>() &gt;= 99)) {</div>
<div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;      *<a class="code" href="a00164.html#a247fb0fc0b87fecdee054bb4660b68e8">m_env</a>.<a class="code" href="a00036.html#a8a0064746ae8dddfece4229b9ad374d6">subDisplayFile</a>() &lt;&lt; <span class="stringliteral">&quot;In TeuchosMatrix::lnDeterminant()&quot;</span></div>
<div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;                              &lt;&lt; <span class="stringliteral">&quot;: after computing lnDet&quot;</span></div>
<div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;                              &lt;&lt; std::endl;</div>
<div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;    }</div>
<div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;  }</div>
<div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;</div>
<div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="a00227.html#a665ce7c3ecf4ba47c8b00ffebd06f438">m_lnDeterminant</a>;</div>
<div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;}</div>
<div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;</div>
<div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;<span class="comment">// ---------------------------------------------------</span></div>
<div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;<span class="comment">// Norm methods --------------------------------------</span></div>
<div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;</div>
<div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;<span class="keywordtype">double</span></div>
<div class="line"><a name="l00541"></a><span class="lineno"><a class="line" href="a00227.html#a96490c60f3bf57fe5cfdc95d8ff97dd1">  541</a></span>&#160;<a class="code" href="a00227.html#a96490c60f3bf57fe5cfdc95d8ff97dd1">TeuchosMatrix::normFrob</a>()<span class="keyword"> const</span></div>
<div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;<span class="keyword"></span>{</div>
<div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="a00227.html#a154931850614ec7597e9b134b7d9ffbb">m_mat</a>.normFrobenius ();</div>
<div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;}</div>
<div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;</div>
<div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;<span class="comment">// ---------------------------------------------------</span></div>
<div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;<span class="keywordtype">double</span></div>
<div class="line"><a name="l00548"></a><span class="lineno"><a class="line" href="a00227.html#a1205fbbcb3dee3a5a3c761e0c7fd54fa">  548</a></span>&#160;<a class="code" href="a00227.html#a1205fbbcb3dee3a5a3c761e0c7fd54fa">TeuchosMatrix::normMax</a>()<span class="keyword"> const</span></div>
<div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;<span class="keyword"></span>{</div>
<div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;  <span class="keywordtype">double</span> value = 0.;</div>
<div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;</div>
<div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;  <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> nRows = this-&gt;<a class="code" href="a00227.html#a78a5b262967d31e6171aadd292e77395">numRowsLocal</a>();</div>
<div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;  <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> nCols = this-&gt;<a class="code" href="a00227.html#a6e3aa20d8c618718a9fa9cc56ff65b9f">numCols</a>();</div>
<div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;  <span class="keywordtype">double</span> aux = 0.;</div>
<div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = 0; i &lt; nRows; i++) {</div>
<div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> j = 0; j &lt; nCols; j++) {</div>
<div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;      aux = fabs((*<span class="keyword">this</span>)(i,j));</div>
<div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;      <span class="keywordflow">if</span> (aux &gt; value) value = aux;</div>
<div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;    }</div>
<div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;  }</div>
<div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;  <span class="keywordflow">return</span> value;</div>
<div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;}</div>
<div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;</div>
<div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;<span class="comment">// Mathematical methods ------------------------------</span></div>
<div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;<span class="comment">// ---------------------------------------------------</span></div>
<div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;</div>
<div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;<span class="comment">// Kemelli: added and tested 12/10/12</span></div>
<div class="line"><a name="l00568"></a><span class="lineno"><a class="line" href="a00227.html#a8bac5523896601fdd26325250a4d732d">  568</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="a00227.html#a8bac5523896601fdd26325250a4d732d">TeuchosMatrix::chol</a>()</div>
<div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;{</div>
<div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;  <span class="keywordtype">int</span> return_success =0 ;</div>
<div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;<span class="comment">/*  If UPLO = &#39;L&#39;, the leading N-by-N lower triangular part of A contains the lower</span></div>
<div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;<span class="comment"> *          triangular part of the matrix A (lets call it L), and the strictly upper</span></div>
<div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;<span class="comment"> *          triangular part of A is not referenced. Thus, the upper triangular part</span></div>
<div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;<span class="comment"> *          of A +++must be manually+++ overwritten with L^T. */</span></div>
<div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;</div>
<div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;  Teuchos::LAPACK&lt;int, double&gt; lapack;</div>
<div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;  <span class="keywordtype">int</span> info;<span class="comment">//= 0:  successful exit</span></div>
<div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;           <span class="comment">//&lt; 0:  if INFO = -i, the i-th argument had an illegal value</span></div>
<div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;           <span class="comment">//&gt; 0:  if INFO = i, the leading minor of order i is not</span></div>
<div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;           <span class="comment">//      positive definite, and the factorization could not be</span></div>
<div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;           <span class="comment">//      completed.</span></div>
<div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;  <span class="keywordtype">char</span> UPLO = <span class="charliteral">&#39;U&#39;</span>;</div>
<div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;          <span class="comment">//= &#39;U&#39;:  Upper triangle of A is stored;</span></div>
<div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;          <span class="comment">//= &#39;L&#39;:  Lower triangle of A is stored.</span></div>
<div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;</div>
<div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;  lapack.POTRF (UPLO, <a class="code" href="a00227.html#a154931850614ec7597e9b134b7d9ffbb">m_mat</a>.numRows(), <a class="code" href="a00227.html#a154931850614ec7597e9b134b7d9ffbb">m_mat</a>.values(), <a class="code" href="a00227.html#a154931850614ec7597e9b134b7d9ffbb">m_mat</a>.stride(), &amp;info);</div>
<div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;</div>
<div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;  <span class="comment">// Overwriting the upper triangular part of the input matrix A with  L^T</span></div>
<div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;  <span class="comment">//(the diagonal terms are identical for both L and L^T)</span></div>
<div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;</div>
<div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0;i&lt;<a class="code" href="a00227.html#a154931850614ec7597e9b134b7d9ffbb">m_mat</a>.numRows();i++){</div>
<div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j=i+1;j&lt;<a class="code" href="a00227.html#a154931850614ec7597e9b134b7d9ffbb">m_mat</a>.numCols();j++)</div>
<div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;       <a class="code" href="a00227.html#a154931850614ec7597e9b134b7d9ffbb">m_mat</a>(i,j) = <a class="code" href="a00227.html#a154931850614ec7597e9b134b7d9ffbb">m_mat</a>(j,i) ;</div>
<div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;  }</div>
<div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160;</div>
<div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;  <span class="keywordflow">if</span> (info != 0) {</div>
<div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;    std::cerr &lt;&lt; <span class="stringliteral">&quot;In TeuchosMtrix::chol()&quot;</span></div>
<div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;              &lt;&lt; <span class="stringliteral">&quot;: INFO = &quot;</span> &lt;&lt; info</div>
<div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;              &lt;&lt; <span class="stringliteral">&quot;,\n INFO &lt; 0:  if INFO = -i, the i-th argument had an illegal value.&quot;</span></div>
<div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160;              &lt;&lt; <span class="stringliteral">&quot;\n INFO &gt; 0:  if INFO = i, the leading minor of order i is not &quot;</span></div>
<div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160;              &lt;&lt; <span class="stringliteral">&quot; positive definite, and the factorization could not be completed.&quot;</span></div>
<div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160;              &lt;&lt; std::endl;</div>
<div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160;    return_success =1 ;</div>
<div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160;  }</div>
<div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;</div>
<div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;  UQ_RC_MACRO(info, <span class="comment">// Yes, *not* a fatal check on RC</span></div>
<div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;              <a class="code" href="a00164.html#a247fb0fc0b87fecdee054bb4660b68e8">m_env</a>.<a class="code" href="a00036.html#a78b57112bbd0e6dd0e8afec00b40ffa7">worldRank</a>(),</div>
<div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160;              <span class="stringliteral">&quot;TeuchosMatrix::chol()&quot;</span>,</div>
<div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160;              <span class="stringliteral">&quot;matrix is not positive definite&quot;</span>,</div>
<div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160;              <a class="code" href="a00674.html#a677863cd32092584175760250f39e8bb">UQ_MATRIX_IS_NOT_POS_DEFINITE_RC</a>);</div>
<div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;</div>
<div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160;  <span class="keywordflow">return</span> return_success;</div>
<div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160;};</div>
<div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160;</div>
<div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160;<span class="comment">// ---------------------------------------------------</span></div>
<div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160;<span class="keywordtype">int</span></div>
<div class="line"><a name="l00617"></a><span class="lineno"><a class="line" href="a00227.html#a546b7b2e45a5ce4cd47222229e0b9732">  617</a></span>&#160;<a class="code" href="a00227.html#a546b7b2e45a5ce4cd47222229e0b9732">TeuchosMatrix::svd</a>(<a class="code" href="a00227.html">TeuchosMatrix</a>&amp; matU, <a class="code" href="a00228.html">TeuchosVector</a>&amp; vecS, <a class="code" href="a00227.html">TeuchosMatrix</a>&amp; matVt)<span class="keyword"> const</span></div>
<div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160;<span class="keyword"></span>{</div>
<div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160;  <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> nRows = this-&gt;<a class="code" href="a00227.html#a78a5b262967d31e6171aadd292e77395">numRowsLocal</a>();</div>
<div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160;  <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> nCols = this-&gt;<a class="code" href="a00227.html#a6e3aa20d8c618718a9fa9cc56ff65b9f">numCols</a>();</div>
<div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;</div>
<div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160;  queso_require_msg(!((matU.<a class="code" href="a00227.html#a78a5b262967d31e6171aadd292e77395">numRowsLocal</a>() != nRows) || (matU.<a class="code" href="a00227.html#a6e3aa20d8c618718a9fa9cc56ff65b9f">numCols</a>() != nCols)), <span class="stringliteral">&quot;invalid matU&quot;</span>);</div>
<div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160;</div>
<div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160;  <a class="code" href="a00674.html#ace699c1e7716717f330c783a58ebcd4f">queso_require_equal_to_msg</a>(vecS.<a class="code" href="a00228.html#aa1d2726c42a9c317898e348fafca6998">sizeLocal</a>(), nCols, <span class="stringliteral">&quot;invalid vecS&quot;</span>);</div>
<div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160;</div>
<div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160;  queso_require_msg(!((matVt.<a class="code" href="a00227.html#a78a5b262967d31e6171aadd292e77395">numRowsLocal</a>() != nCols) || (matVt.<a class="code" href="a00227.html#a6e3aa20d8c618718a9fa9cc56ff65b9f">numCols</a>() != nCols)), <span class="stringliteral">&quot;invalid matVt&quot;</span>);</div>
<div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160;</div>
<div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160;  <span class="keywordtype">int</span> iRC = <a class="code" href="a00227.html#a6a0ed6fd46f5b06c571a59f6678a3380">internalSvd</a>();</div>
<div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160;</div>
<div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160;  matU  = *<a class="code" href="a00227.html#adae6a5fa59652c964e2d3893117bb95d">m_svdUmat</a>;</div>
<div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160;  vecS  = *<a class="code" href="a00227.html#a7b20f299e99f5bbe86053ca5c720f9f7">m_svdSvec</a>;</div>
<div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;  matVt = *<a class="code" href="a00227.html#a50e1d16f2e2b7045157c5596ca240be1">m_svdVTmat</a>;</div>
<div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160;</div>
<div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160;  <span class="keywordflow">return</span> iRC;</div>
<div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160;}</div>
<div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160;</div>
<div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160;<span class="comment">//---------------------------------------------------------------</span></div>
<div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160;<span class="comment">//tested 2/1/13</span></div>
<div class="line"><a name="l00639"></a><span class="lineno"><a class="line" href="a00227.html#ad033f43de1f52ba83d8abbf0c32ca7aa">  639</a></span>&#160;<span class="keyword">const</span> <a class="code" href="a00227.html">TeuchosMatrix</a>&amp; <a class="code" href="a00227.html#ad033f43de1f52ba83d8abbf0c32ca7aa">TeuchosMatrix::svdMatU</a>()<span class="keyword"> const</span></div>
<div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160;<span class="keyword"></span>{</div>
<div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160;  <span class="keywordtype">int</span> iRC = 0;</div>
<div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160;  iRC = <a class="code" href="a00227.html#a6a0ed6fd46f5b06c571a59f6678a3380">internalSvd</a>();</div>
<div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160;  <span class="keywordflow">if</span> (iRC) {}; <span class="comment">// just to remove compiler warning</span></div>
<div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160;  <span class="keywordflow">return</span> *<a class="code" href="a00227.html#adae6a5fa59652c964e2d3893117bb95d">m_svdUmat</a>;</div>
<div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160;}</div>
<div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160;</div>
<div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160;<span class="comment">//---------------------------------------------------------------</span></div>
<div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160;<span class="comment">//tested 2/1/13</span></div>
<div class="line"><a name="l00649"></a><span class="lineno"><a class="line" href="a00227.html#abfa59abcb8bddf7fc3e455465e6ee0e4">  649</a></span>&#160;<span class="keyword">const</span> <a class="code" href="a00227.html">TeuchosMatrix</a>&amp; <a class="code" href="a00227.html#abfa59abcb8bddf7fc3e455465e6ee0e4">TeuchosMatrix::svdMatV</a>()<span class="keyword"> const</span></div>
<div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160;<span class="keyword"></span>{</div>
<div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160;  <span class="keywordtype">int</span> iRC = 0;</div>
<div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160;  iRC = <a class="code" href="a00227.html#a6a0ed6fd46f5b06c571a59f6678a3380">internalSvd</a>();</div>
<div class="line"><a name="l00653"></a><span class="lineno">  653</span>&#160;  <span class="keywordflow">if</span> (iRC) {}; <span class="comment">// just to remove compiler warning</span></div>
<div class="line"><a name="l00654"></a><span class="lineno">  654</span>&#160;  <span class="keywordflow">return</span> *<a class="code" href="a00227.html#a38aebd6933884dd1dccdb140227092b6">m_svdVmat</a>;</div>
<div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160;}</div>
<div class="line"><a name="l00656"></a><span class="lineno">  656</span>&#160;</div>
<div class="line"><a name="l00657"></a><span class="lineno">  657</span>&#160;<span class="comment">//---------------------------------------------------------------</span></div>
<div class="line"><a name="l00658"></a><span class="lineno">  658</span>&#160;<span class="comment">// checked 2/27/13</span></div>
<div class="line"><a name="l00659"></a><span class="lineno">  659</span>&#160;<span class="comment">/* An orthogonal matrix M has a norm-preserving property, i.e.</span></div>
<div class="line"><a name="l00660"></a><span class="lineno">  660</span>&#160;<span class="comment"> * for any vector v, \f[||Mv|| = ||v|| \f] (1). Then:</span></div>
<div class="line"><a name="l00661"></a><span class="lineno">  661</span>&#160;<span class="comment"> * \f[ min(||Ax − b||^2) = min(||Ax − b||) = min(||UDVT x − b||) = (1) min(||DV x − U b||) \f].</span></div>
<div class="line"><a name="l00662"></a><span class="lineno">  662</span>&#160;<span class="comment"> * Substituting \f[ y = VT x \f] and \f[ b&#39; = UT b \f] gives us \f[ Dy = b&#39; \f]</span></div>
<div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160;<span class="comment"> * with D a diagonal matrix. Or,  \f[ y = inv(D)*UT*b \f] and we only have to</span></div>
<div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160;<span class="comment"> * solve the linear system: \f[ VT x = y \f].</span></div>
<div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160;<span class="comment"> */</span></div>
<div class="line"><a name="l00666"></a><span class="lineno">  666</span>&#160;<span class="keywordtype">int</span></div>
<div class="line"><a name="l00667"></a><span class="lineno"><a class="line" href="a00227.html#a984606fc58d720fe0cb21345106e7c33">  667</a></span>&#160;<a class="code" href="a00227.html#a984606fc58d720fe0cb21345106e7c33">TeuchosMatrix::svdSolve</a>(<span class="keyword">const</span> <a class="code" href="a00228.html">TeuchosVector</a>&amp; rhsVec, <a class="code" href="a00228.html">TeuchosVector</a>&amp; solVec)<span class="keyword"> const</span></div>
<div class="line"><a name="l00668"></a><span class="lineno">  668</span>&#160;<span class="keyword"></span>{</div>
<div class="line"><a name="l00669"></a><span class="lineno">  669</span>&#160;  <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> nRows = this-&gt;<a class="code" href="a00227.html#a78a5b262967d31e6171aadd292e77395">numRowsLocal</a>();</div>
<div class="line"><a name="l00670"></a><span class="lineno">  670</span>&#160;  <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> nCols = this-&gt;<a class="code" href="a00227.html#a6e3aa20d8c618718a9fa9cc56ff65b9f">numCols</a>();</div>
<div class="line"><a name="l00671"></a><span class="lineno">  671</span>&#160;  <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i;</div>
<div class="line"><a name="l00672"></a><span class="lineno">  672</span>&#160;</div>
<div class="line"><a name="l00673"></a><span class="lineno">  673</span>&#160;  <a class="code" href="a00674.html#ace699c1e7716717f330c783a58ebcd4f">queso_require_equal_to_msg</a>(rhsVec.<a class="code" href="a00228.html#aa1d2726c42a9c317898e348fafca6998">sizeLocal</a>(), nRows, <span class="stringliteral">&quot;invalid rhsVec&quot;</span>);</div>
<div class="line"><a name="l00674"></a><span class="lineno">  674</span>&#160;</div>
<div class="line"><a name="l00675"></a><span class="lineno">  675</span>&#160;  <a class="code" href="a00674.html#ace699c1e7716717f330c783a58ebcd4f">queso_require_equal_to_msg</a>(solVec.<a class="code" href="a00228.html#aa1d2726c42a9c317898e348fafca6998">sizeLocal</a>(), nCols, <span class="stringliteral">&quot;invalid solVec&quot;</span>);</div>
<div class="line"><a name="l00676"></a><span class="lineno">  676</span>&#160;</div>
<div class="line"><a name="l00677"></a><span class="lineno">  677</span>&#160;  <span class="keywordtype">int</span> iRC = <a class="code" href="a00227.html#a6a0ed6fd46f5b06c571a59f6678a3380">internalSvd</a>();</div>
<div class="line"><a name="l00678"></a><span class="lineno">  678</span>&#160;</div>
<div class="line"><a name="l00679"></a><span class="lineno">  679</span>&#160;  <span class="keywordflow">if</span> ((<a class="code" href="a00164.html#a247fb0fc0b87fecdee054bb4660b68e8">m_env</a>.<a class="code" href="a00036.html#a8a0064746ae8dddfece4229b9ad374d6">subDisplayFile</a>()) &amp;&amp; (<a class="code" href="a00164.html#a247fb0fc0b87fecdee054bb4660b68e8">m_env</a>.<a class="code" href="a00036.html#a1fe5f244fc0316a0ab3e37463f108b96">displayVerbosity</a>() &gt;= 5)) {</div>
<div class="line"><a name="l00680"></a><span class="lineno">  680</span>&#160;    *<a class="code" href="a00164.html#a247fb0fc0b87fecdee054bb4660b68e8">m_env</a>.<a class="code" href="a00036.html#a8a0064746ae8dddfece4229b9ad374d6">subDisplayFile</a>() &lt;&lt; <span class="stringliteral">&quot;In TeuchosMatrix::svdSolve():&quot;</span></div>
<div class="line"><a name="l00681"></a><span class="lineno">  681</span>&#160;                            &lt;&lt; <span class="stringliteral">&quot;\n this-&gt;numRowsLocal()      = &quot;</span> &lt;&lt; this-&gt;<a class="code" href="a00227.html#a78a5b262967d31e6171aadd292e77395">numRowsLocal</a>()</div>
<div class="line"><a name="l00682"></a><span class="lineno">  682</span>&#160;                            &lt;&lt; <span class="stringliteral">&quot;, this-&gt;numCols()      = &quot;</span>       &lt;&lt; this-&gt;<a class="code" href="a00227.html#a6e3aa20d8c618718a9fa9cc56ff65b9f">numCols</a>()</div>
<div class="line"><a name="l00683"></a><span class="lineno">  683</span>&#160;                            &lt;&lt; <span class="stringliteral">&quot;\n m_svdUmat-&gt;numRowsLocal() = &quot;</span> &lt;&lt; <a class="code" href="a00227.html#adae6a5fa59652c964e2d3893117bb95d">m_svdUmat</a>-&gt;<a class="code" href="a00227.html#a78a5b262967d31e6171aadd292e77395">numRowsLocal</a>()</div>
<div class="line"><a name="l00684"></a><span class="lineno">  684</span>&#160;                            &lt;&lt; <span class="stringliteral">&quot;, m_svdUmat-&gt;numCols() = &quot;</span>       &lt;&lt; <a class="code" href="a00227.html#adae6a5fa59652c964e2d3893117bb95d">m_svdUmat</a>-&gt;<a class="code" href="a00227.html#a6e3aa20d8c618718a9fa9cc56ff65b9f">numCols</a>()</div>
<div class="line"><a name="l00685"></a><span class="lineno">  685</span>&#160;                            &lt;&lt; <span class="stringliteral">&quot;\n m_svdVmat-&gt;numRowsLocal() = &quot;</span> &lt;&lt; <a class="code" href="a00227.html#a38aebd6933884dd1dccdb140227092b6">m_svdVmat</a>-&gt;<a class="code" href="a00227.html#a78a5b262967d31e6171aadd292e77395">numRowsLocal</a>()</div>
<div class="line"><a name="l00686"></a><span class="lineno">  686</span>&#160;                            &lt;&lt; <span class="stringliteral">&quot;, m_svdVmat-&gt;numCols() = &quot;</span>       &lt;&lt; <a class="code" href="a00227.html#a38aebd6933884dd1dccdb140227092b6">m_svdVmat</a>-&gt;<a class="code" href="a00227.html#a6e3aa20d8c618718a9fa9cc56ff65b9f">numCols</a>()</div>
<div class="line"><a name="l00687"></a><span class="lineno">  687</span>&#160;                            &lt;&lt; <span class="stringliteral">&quot;\n m_svdSvec-&gt;sizeLocal()    = &quot;</span> &lt;&lt; <a class="code" href="a00227.html#a7b20f299e99f5bbe86053ca5c720f9f7">m_svdSvec</a>-&gt;<a class="code" href="a00228.html#aa1d2726c42a9c317898e348fafca6998">sizeLocal</a>()</div>
<div class="line"><a name="l00688"></a><span class="lineno">  688</span>&#160;                            &lt;&lt; <span class="stringliteral">&quot;\n rhsVec.sizeLocal()        = &quot;</span> &lt;&lt; rhsVec.<a class="code" href="a00228.html#aa1d2726c42a9c317898e348fafca6998">sizeLocal</a>()</div>
<div class="line"><a name="l00689"></a><span class="lineno">  689</span>&#160;                            &lt;&lt; <span class="stringliteral">&quot;\n solVec.sizeLocal()        = &quot;</span> &lt;&lt; solVec.<a class="code" href="a00228.html#aa1d2726c42a9c317898e348fafca6998">sizeLocal</a>()</div>
<div class="line"><a name="l00690"></a><span class="lineno">  690</span>&#160;                            &lt;&lt; std::endl;</div>
<div class="line"><a name="l00691"></a><span class="lineno">  691</span>&#160;  }</div>
<div class="line"><a name="l00692"></a><span class="lineno">  692</span>&#160;</div>
<div class="line"><a name="l00693"></a><span class="lineno">  693</span>&#160; <span class="keywordflow">if</span> (iRC == 0)</div>
<div class="line"><a name="l00694"></a><span class="lineno">  694</span>&#160; {</div>
<div class="line"><a name="l00695"></a><span class="lineno">  695</span>&#160;   <a class="code" href="a00227.html">TeuchosMatrix</a>  invD = <a class="code" href="a00227.html#a1c93b3054debeb1277a4ef0d06a6001d">TeuchosMatrix</a>(solVec);</div>
<div class="line"><a name="l00696"></a><span class="lineno">  696</span>&#160;   <a class="code" href="a00227.html">TeuchosMatrix</a>  auxMatrix = <a class="code" href="a00227.html#a1c93b3054debeb1277a4ef0d06a6001d">TeuchosMatrix</a>(solVec);</div>
<div class="line"><a name="l00697"></a><span class="lineno">  697</span>&#160;</div>
<div class="line"><a name="l00698"></a><span class="lineno">  698</span>&#160;   <span class="keywordflow">for</span> (i=0; i&lt;nRows; i++){</div>
<div class="line"><a name="l00699"></a><span class="lineno">  699</span>&#160;     invD(i,i) = 1./(<a class="code" href="a00227.html#a7b20f299e99f5bbe86053ca5c720f9f7">m_svdSvec</a>-&gt;<a class="code" href="a00228.html#a2398f321692d661267a6e9dc5d249917">values</a>()[i]);</div>
<div class="line"><a name="l00700"></a><span class="lineno">  700</span>&#160;   }</div>
<div class="line"><a name="l00701"></a><span class="lineno">  701</span>&#160;</div>
<div class="line"><a name="l00702"></a><span class="lineno">  702</span>&#160;  <span class="comment">// GESV: For a system Ax=b, on entry, b contains the right-hand side b;</span></div>
<div class="line"><a name="l00703"></a><span class="lineno">  703</span>&#160;  <span class="comment">// on exit it contains the solution x.</span></div>
<div class="line"><a name="l00704"></a><span class="lineno">  704</span>&#160;  <span class="comment">// Thus, intead of doing y = inv(D)*UT*rhsVec = auxMatrix*rhsVec, with</span></div>
<div class="line"><a name="l00705"></a><span class="lineno">  705</span>&#160;  <span class="comment">// auxMatrix = inv(D)*UT; and then assigning solVec=y (requirement for using GESV)</span></div>
<div class="line"><a name="l00706"></a><span class="lineno">  706</span>&#160;  <span class="comment">// lets do solVec= auxMatrix*rhsVec, and save one step in the calculation</span></div>
<div class="line"><a name="l00707"></a><span class="lineno">  707</span>&#160;</div>
<div class="line"><a name="l00708"></a><span class="lineno">  708</span>&#160;    auxMatrix = invD * <a class="code" href="a00227.html#ad033f43de1f52ba83d8abbf0c32ca7aa">svdMatU</a>().<a class="code" href="a00227.html#a9a415d3d463c4620ac59e3f7476bc6c9">transpose</a>();</div>
<div class="line"><a name="l00709"></a><span class="lineno">  709</span>&#160;    solVec = auxMatrix*rhsVec;</div>
<div class="line"><a name="l00710"></a><span class="lineno">  710</span>&#160;</div>
<div class="line"><a name="l00711"></a><span class="lineno">  711</span>&#160;  <span class="comment">// solve the linear system VT * solVec = y</span></div>
<div class="line"><a name="l00712"></a><span class="lineno">  712</span>&#160;  <span class="comment">// GESV changes the values of the matrix, so lets make a copy of it and use it.</span></div>
<div class="line"><a name="l00713"></a><span class="lineno">  713</span>&#160;</div>
<div class="line"><a name="l00714"></a><span class="lineno">  714</span>&#160;    <a class="code" href="a00227.html">TeuchosMatrix</a>* aux_m_svdVTmat  = <span class="keyword">new</span> <a class="code" href="a00227.html#a1c93b3054debeb1277a4ef0d06a6001d">TeuchosMatrix</a>(*<a class="code" href="a00227.html#a50e1d16f2e2b7045157c5596ca240be1">m_svdVTmat</a>);</div>
<div class="line"><a name="l00715"></a><span class="lineno">  715</span>&#160;</div>
<div class="line"><a name="l00716"></a><span class="lineno">  716</span>&#160;    <span class="keywordtype">int</span> ipiv[0], info;</div>
<div class="line"><a name="l00717"></a><span class="lineno">  717</span>&#160;    Teuchos::LAPACK&lt;int, double&gt; lapack;</div>
<div class="line"><a name="l00718"></a><span class="lineno">  718</span>&#160;    lapack.GESV(nCols, 1,  aux_m_svdVTmat-&gt;<a class="code" href="a00227.html#a22c82a6fb78541a113f65753d9303448">values</a>(),  aux_m_svdVTmat-&gt;<a class="code" href="a00227.html#aaba42e724f7b422d69f6ebe1cb40d0df">stride</a>(), ipiv, &amp;solVec[0], solVec.<a class="code" href="a00228.html#aa1d2726c42a9c317898e348fafca6998">sizeLocal</a>(), &amp;info );</div>
<div class="line"><a name="l00719"></a><span class="lineno">  719</span>&#160;</div>
<div class="line"><a name="l00720"></a><span class="lineno">  720</span>&#160;  <span class="comment">/* GESV output INFO: = 0:  successful exit</span></div>
<div class="line"><a name="l00721"></a><span class="lineno">  721</span>&#160;<span class="comment">   *          &lt; 0:  if INFO = -i, the i-th argument had an illegal value</span></div>
<div class="line"><a name="l00722"></a><span class="lineno">  722</span>&#160;<span class="comment">   *          &gt; 0:  if INFO = i, U(i,i) is exactly zero.  The factorization</span></div>
<div class="line"><a name="l00723"></a><span class="lineno">  723</span>&#160;<span class="comment">   *                has been completed, but the factor U is exactly</span></div>
<div class="line"><a name="l00724"></a><span class="lineno">  724</span>&#160;<span class="comment">   *                singular, so the solution could not be computed.   */</span></div>
<div class="line"><a name="l00725"></a><span class="lineno">  725</span>&#160;</div>
<div class="line"><a name="l00726"></a><span class="lineno">  726</span>&#160;    iRC = info;</div>
<div class="line"><a name="l00727"></a><span class="lineno">  727</span>&#160;    <span class="keyword">delete</span> aux_m_svdVTmat;</div>
<div class="line"><a name="l00728"></a><span class="lineno">  728</span>&#160;  }</div>
<div class="line"><a name="l00729"></a><span class="lineno">  729</span>&#160;  <span class="keywordflow">return</span> iRC;</div>
<div class="line"><a name="l00730"></a><span class="lineno">  730</span>&#160;}</div>
<div class="line"><a name="l00731"></a><span class="lineno">  731</span>&#160;</div>
<div class="line"><a name="l00732"></a><span class="lineno">  732</span>&#160;<span class="comment">// ---------------------------------------------------</span></div>
<div class="line"><a name="l00733"></a><span class="lineno">  733</span>&#160;<span class="comment">//checked 2/27/13</span></div>
<div class="line"><a name="l00734"></a><span class="lineno">  734</span>&#160;<span class="keywordtype">int</span></div>
<div class="line"><a name="l00735"></a><span class="lineno"><a class="line" href="a00227.html#ae130c73f0ac2d55b83ce66dff2610867">  735</a></span>&#160;<a class="code" href="a00227.html#a984606fc58d720fe0cb21345106e7c33">TeuchosMatrix::svdSolve</a>(<span class="keyword">const</span> <a class="code" href="a00227.html">TeuchosMatrix</a>&amp; rhsMat, <a class="code" href="a00227.html">TeuchosMatrix</a>&amp; solMat)<span class="keyword"> const</span></div>
<div class="line"><a name="l00736"></a><span class="lineno">  736</span>&#160;<span class="keyword"></span>{</div>
<div class="line"><a name="l00737"></a><span class="lineno">  737</span>&#160;  <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> nRows = this-&gt;<a class="code" href="a00227.html#a78a5b262967d31e6171aadd292e77395">numRowsLocal</a>();</div>
<div class="line"><a name="l00738"></a><span class="lineno">  738</span>&#160;  <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> nCols = this-&gt;<a class="code" href="a00227.html#a6e3aa20d8c618718a9fa9cc56ff65b9f">numCols</a>();</div>
<div class="line"><a name="l00739"></a><span class="lineno">  739</span>&#160;</div>
<div class="line"><a name="l00740"></a><span class="lineno">  740</span>&#160;  <a class="code" href="a00674.html#ace699c1e7716717f330c783a58ebcd4f">queso_require_equal_to_msg</a>(rhsMat.<a class="code" href="a00227.html#a78a5b262967d31e6171aadd292e77395">numRowsLocal</a>(), nRows, <span class="stringliteral">&quot;invalid rhsMat&quot;</span>);</div>
<div class="line"><a name="l00741"></a><span class="lineno">  741</span>&#160;</div>
<div class="line"><a name="l00742"></a><span class="lineno">  742</span>&#160;  <a class="code" href="a00674.html#ace699c1e7716717f330c783a58ebcd4f">queso_require_equal_to_msg</a>(solMat.<a class="code" href="a00227.html#a78a5b262967d31e6171aadd292e77395">numRowsLocal</a>(), nCols, <span class="stringliteral">&quot;invalid solMat&quot;</span>);</div>
<div class="line"><a name="l00743"></a><span class="lineno">  743</span>&#160;</div>
<div class="line"><a name="l00744"></a><span class="lineno">  744</span>&#160;  <a class="code" href="a00674.html#ace699c1e7716717f330c783a58ebcd4f">queso_require_equal_to_msg</a>(rhsMat.<a class="code" href="a00227.html#a6e3aa20d8c618718a9fa9cc56ff65b9f">numCols</a>(), solMat.<a class="code" href="a00227.html#a6e3aa20d8c618718a9fa9cc56ff65b9f">numCols</a>(), <span class="stringliteral">&quot;rhsMat and solMat are not compatible&quot;</span>);</div>
<div class="line"><a name="l00745"></a><span class="lineno">  745</span>&#160;</div>
<div class="line"><a name="l00746"></a><span class="lineno">  746</span>&#160;  <a class="code" href="a00228.html">TeuchosVector</a> rhsVec(<a class="code" href="a00164.html#a247fb0fc0b87fecdee054bb4660b68e8">m_env</a>,rhsMat.<a class="code" href="a00164.html#ae01c72255466cd95201bb4c7f07e1b83">map</a>());</div>
<div class="line"><a name="l00747"></a><span class="lineno">  747</span>&#160;  <a class="code" href="a00228.html">TeuchosVector</a> solVec(<a class="code" href="a00164.html#a247fb0fc0b87fecdee054bb4660b68e8">m_env</a>,solMat.<a class="code" href="a00164.html#ae01c72255466cd95201bb4c7f07e1b83">map</a>());</div>
<div class="line"><a name="l00748"></a><span class="lineno">  748</span>&#160;  <span class="keywordtype">int</span> iRC = 0;</div>
<div class="line"><a name="l00749"></a><span class="lineno">  749</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> j = 0; j &lt; rhsMat.<a class="code" href="a00227.html#a6e3aa20d8c618718a9fa9cc56ff65b9f">numCols</a>(); ++j) {</div>
<div class="line"><a name="l00750"></a><span class="lineno">  750</span>&#160;    rhsVec = rhsMat.<a class="code" href="a00227.html#ae66a7551b49a7e33a407972c3da2763c">getColumn</a>(j);</div>
<div class="line"><a name="l00751"></a><span class="lineno">  751</span>&#160;    iRC = this-&gt;<a class="code" href="a00227.html#a984606fc58d720fe0cb21345106e7c33">svdSolve</a>(rhsVec, solVec);</div>
<div class="line"><a name="l00752"></a><span class="lineno">  752</span>&#160;    <span class="keywordflow">if</span> (iRC) <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00753"></a><span class="lineno">  753</span>&#160;    solMat.<a class="code" href="a00227.html#a5855b579a855166171ccdd72c55e5d0d">setColumn</a>(j,solVec);</div>
<div class="line"><a name="l00754"></a><span class="lineno">  754</span>&#160;  }</div>
<div class="line"><a name="l00755"></a><span class="lineno">  755</span>&#160;</div>
<div class="line"><a name="l00756"></a><span class="lineno">  756</span>&#160;  <span class="keywordflow">return</span> iRC;</div>
<div class="line"><a name="l00757"></a><span class="lineno">  757</span>&#160;}</div>
<div class="line"><a name="l00758"></a><span class="lineno">  758</span>&#160;</div>
<div class="line"><a name="l00759"></a><span class="lineno">  759</span>&#160;<span class="comment">// ---------------------------------------------------</span></div>
<div class="line"><a name="l00760"></a><span class="lineno">  760</span>&#160;<span class="comment">// implemented/checked 1/8/13</span></div>
<div class="line"><a name="l00761"></a><span class="lineno">  761</span>&#160;<span class="comment">// multiply this matrix by vector x and store in vector y, which is returned</span></div>
<div class="line"><a name="l00762"></a><span class="lineno">  762</span>&#160;<span class="comment">// eg: TeuchosVector v1(paramSpace.zeroVector() );</span></div>
<div class="line"><a name="l00763"></a><span class="lineno">  763</span>&#160;<span class="comment">//     v1=covMatrix.multiply(meanVector);</span></div>
<div class="line"><a name="l00764"></a><span class="lineno">  764</span>&#160;<a class="code" href="a00228.html">TeuchosVector</a></div>
<div class="line"><a name="l00765"></a><span class="lineno"><a class="line" href="a00227.html#a2ce0ab6dfd8ef4d82caddd4d052218f5">  765</a></span>&#160;<a class="code" href="a00227.html#a2ce0ab6dfd8ef4d82caddd4d052218f5">TeuchosMatrix::multiply</a>(<span class="keyword">const</span> <a class="code" href="a00228.html">TeuchosVector</a>&amp; x)<span class="keyword"> const</span></div>
<div class="line"><a name="l00766"></a><span class="lineno">  766</span>&#160;<span class="keyword"></span>{</div>
<div class="line"><a name="l00767"></a><span class="lineno">  767</span>&#160;  <a class="code" href="a00674.html#ace699c1e7716717f330c783a58ebcd4f">queso_require_equal_to_msg</a>(this-&gt;<a class="code" href="a00227.html#a6e3aa20d8c618718a9fa9cc56ff65b9f">numCols</a>(), x.<a class="code" href="a00228.html#aa1d2726c42a9c317898e348fafca6998">sizeLocal</a>(), <span class="stringliteral">&quot;matrix and vector have incompatible sizes&quot;</span>);</div>
<div class="line"><a name="l00768"></a><span class="lineno">  768</span>&#160;</div>
<div class="line"><a name="l00769"></a><span class="lineno">  769</span>&#160;  <a class="code" href="a00228.html">TeuchosVector</a> y(<a class="code" href="a00164.html#a247fb0fc0b87fecdee054bb4660b68e8">m_env</a>,<a class="code" href="a00164.html#a95e307c6e1263d505af0a43c35f81a8b">m_map</a>);</div>
<div class="line"><a name="l00770"></a><span class="lineno">  770</span>&#160;  this-&gt;<a class="code" href="a00227.html#a2ce0ab6dfd8ef4d82caddd4d052218f5">multiply</a>(x,y);</div>
<div class="line"><a name="l00771"></a><span class="lineno">  771</span>&#160;</div>
<div class="line"><a name="l00772"></a><span class="lineno">  772</span>&#160;  <span class="keywordflow">return</span> y;</div>
<div class="line"><a name="l00773"></a><span class="lineno">  773</span>&#160;}</div>
<div class="line"><a name="l00774"></a><span class="lineno">  774</span>&#160;</div>
<div class="line"><a name="l00775"></a><span class="lineno">  775</span>&#160;<span class="comment">// ---------------------------------------------------</span></div>
<div class="line"><a name="l00776"></a><span class="lineno">  776</span>&#160;<span class="comment">//Kemelli checked 12/06/12</span></div>
<div class="line"><a name="l00777"></a><span class="lineno">  777</span>&#160;<a class="code" href="a00228.html">TeuchosVector</a></div>
<div class="line"><a name="l00778"></a><span class="lineno"><a class="line" href="a00227.html#a607ae7648311e1725671bd8f9454ca29">  778</a></span>&#160;<a class="code" href="a00227.html#a4f3affd6522fafb794e2cc36a382ccc9">TeuchosMatrix::invertMultiply</a>(<span class="keyword">const</span> <a class="code" href="a00228.html">TeuchosVector</a>&amp; b)<span class="keyword"> const</span></div>
<div class="line"><a name="l00779"></a><span class="lineno">  779</span>&#160;<span class="keyword"></span>{</div>
<div class="line"><a name="l00780"></a><span class="lineno">  780</span>&#160;  <a class="code" href="a00674.html#ace699c1e7716717f330c783a58ebcd4f">queso_require_equal_to_msg</a>(this-&gt;<a class="code" href="a00227.html#a6e3aa20d8c618718a9fa9cc56ff65b9f">numCols</a>(), b.<a class="code" href="a00228.html#aa1d2726c42a9c317898e348fafca6998">sizeLocal</a>(), <span class="stringliteral">&quot;matrix and rhs have incompatible sizes&quot;</span>);</div>
<div class="line"><a name="l00781"></a><span class="lineno">  781</span>&#160;  <a class="code" href="a00228.html">TeuchosVector</a> x(<a class="code" href="a00164.html#a247fb0fc0b87fecdee054bb4660b68e8">m_env</a>,<a class="code" href="a00164.html#a95e307c6e1263d505af0a43c35f81a8b">m_map</a>);</div>
<div class="line"><a name="l00782"></a><span class="lineno">  782</span>&#160;</div>
<div class="line"><a name="l00783"></a><span class="lineno">  783</span>&#160;  this-&gt;<a class="code" href="a00227.html#a4f3affd6522fafb794e2cc36a382ccc9">invertMultiply</a>(b,x);</div>
<div class="line"><a name="l00784"></a><span class="lineno">  784</span>&#160;</div>
<div class="line"><a name="l00785"></a><span class="lineno">  785</span>&#160;  <span class="keywordflow">return</span> x;</div>
<div class="line"><a name="l00786"></a><span class="lineno">  786</span>&#160;}</div>
<div class="line"><a name="l00787"></a><span class="lineno">  787</span>&#160;</div>
<div class="line"><a name="l00788"></a><span class="lineno">  788</span>&#160;<span class="comment">// ---------------------------------------------------</span></div>
<div class="line"><a name="l00789"></a><span class="lineno">  789</span>&#160;<span class="comment">//Kemelli checked 12/06/12</span></div>
<div class="line"><a name="l00790"></a><span class="lineno">  790</span>&#160;<span class="keywordtype">void</span></div>
<div class="line"><a name="l00791"></a><span class="lineno"><a class="line" href="a00227.html#a4f3affd6522fafb794e2cc36a382ccc9">  791</a></span>&#160;<a class="code" href="a00227.html#a4f3affd6522fafb794e2cc36a382ccc9">TeuchosMatrix::invertMultiply</a>(<span class="keyword">const</span> <a class="code" href="a00228.html">TeuchosVector</a>&amp; b, <a class="code" href="a00228.html">TeuchosVector</a>&amp; x)<span class="keyword"> const</span></div>
<div class="line"><a name="l00792"></a><span class="lineno">  792</span>&#160;<span class="keyword"></span>{</div>
<div class="line"><a name="l00793"></a><span class="lineno">  793</span>&#160;  <a class="code" href="a00674.html#ace699c1e7716717f330c783a58ebcd4f">queso_require_equal_to_msg</a>(this-&gt;<a class="code" href="a00227.html#a6e3aa20d8c618718a9fa9cc56ff65b9f">numCols</a>(), b.<a class="code" href="a00228.html#aa1d2726c42a9c317898e348fafca6998">sizeLocal</a>(), <span class="stringliteral">&quot;matrix and rhs have incompatible sizes&quot;</span>);</div>
<div class="line"><a name="l00794"></a><span class="lineno">  794</span>&#160;</div>
<div class="line"><a name="l00795"></a><span class="lineno">  795</span>&#160;  <a class="code" href="a00674.html#ace699c1e7716717f330c783a58ebcd4f">queso_require_equal_to_msg</a>(x.<a class="code" href="a00228.html#aa1d2726c42a9c317898e348fafca6998">sizeLocal</a>(), b.<a class="code" href="a00228.html#aa1d2726c42a9c317898e348fafca6998">sizeLocal</a>(), <span class="stringliteral">&quot;solution and rhs have incompatible sizes&quot;</span>);</div>
<div class="line"><a name="l00796"></a><span class="lineno">  796</span>&#160;</div>
<div class="line"><a name="l00797"></a><span class="lineno">  797</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="a00227.html#a6df7300159f5ca3ff664ebca6e3c932f">m_LU</a>.numCols() == 0 &amp;&amp; <a class="code" href="a00227.html#a6df7300159f5ca3ff664ebca6e3c932f">m_LU</a>.numRows() == 0)</div>
<div class="line"><a name="l00798"></a><span class="lineno">  798</span>&#160;  {</div>
<div class="line"><a name="l00799"></a><span class="lineno">  799</span>&#160;  queso_require_msg(!(<a class="code" href="a00227.html#af81bb8e0e3c02a248b8cdf87fc13fd2a">v_pivoting</a>), <span class="stringliteral">&quot;v_pivoting should be NULL&quot;</span>);</div>
<div class="line"><a name="l00800"></a><span class="lineno">  800</span>&#160;</div>
<div class="line"><a name="l00801"></a><span class="lineno">  801</span>&#160;  <span class="comment">//allocate m_LU and v_pivoting</span></div>
<div class="line"><a name="l00802"></a><span class="lineno">  802</span>&#160;  <a class="code" href="a00227.html#a6df7300159f5ca3ff664ebca6e3c932f">m_LU</a> = <a class="code" href="a00227.html#a154931850614ec7597e9b134b7d9ffbb">m_mat</a>;</div>
<div class="line"><a name="l00803"></a><span class="lineno">  803</span>&#160;  <a class="code" href="a00227.html#af81bb8e0e3c02a248b8cdf87fc13fd2a">v_pivoting</a> =(<span class="keywordtype">int</span> *) malloc(<span class="keyword">sizeof</span>(<span class="keywordtype">int</span>)*<a class="code" href="a00227.html#a6df7300159f5ca3ff664ebca6e3c932f">m_LU</a>.numCols() );</div>
<div class="line"><a name="l00804"></a><span class="lineno">  804</span>&#160;</div>
<div class="line"><a name="l00805"></a><span class="lineno">  805</span>&#160;  <a class="code" href="a00674.html#aae2cd8576f7d7d4de5543f13b8edc974">queso_require_not_equal_to_msg</a>(<a class="code" href="a00227.html#a6df7300159f5ca3ff664ebca6e3c932f">m_LU</a>.numCols(), 0 &amp;&amp; <a class="code" href="a00227.html#a6df7300159f5ca3ff664ebca6e3c932f">m_LU</a>.numRows() == 0, <span class="stringliteral">&quot;malloc() failed&quot;</span>);</div>
<div class="line"><a name="l00806"></a><span class="lineno">  806</span>&#160;</div>
<div class="line"><a name="l00807"></a><span class="lineno">  807</span>&#160;  queso_require_msg(<a class="code" href="a00227.html#af81bb8e0e3c02a248b8cdf87fc13fd2a">v_pivoting</a>, <span class="stringliteral">&quot;malloc() failed&quot;</span>);</div>
<div class="line"><a name="l00808"></a><span class="lineno">  808</span>&#160;</div>
<div class="line"><a name="l00809"></a><span class="lineno">  809</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="a00164.html#a3384d3fc1a1058fce9191b0d74653911">m_inDebugMode</a>) {</div>
<div class="line"><a name="l00810"></a><span class="lineno">  810</span>&#160;    std::cout &lt;&lt; <span class="stringliteral">&quot;In TeuchosMatrix::invertMultiply()&quot;</span></div>
<div class="line"><a name="l00811"></a><span class="lineno">  811</span>&#160;              &lt;&lt; <span class="stringliteral">&quot;: before LU decomposition, m_LU = &quot;</span>;</div>
<div class="line"><a name="l00812"></a><span class="lineno">  812</span>&#160;              <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0;i&lt;3;i++){</div>
<div class="line"><a name="l00813"></a><span class="lineno">  813</span>&#160;                <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j=0;j&lt;3;j++)</div>
<div class="line"><a name="l00814"></a><span class="lineno">  814</span>&#160;                  cout &lt;&lt; <a class="code" href="a00227.html#a6df7300159f5ca3ff664ebca6e3c932f">m_LU</a>(i,j) &lt;&lt;<span class="stringliteral">&quot;\t&quot;</span> ;</div>
<div class="line"><a name="l00815"></a><span class="lineno">  815</span>&#160;                cout &lt;&lt; endl;</div>
<div class="line"><a name="l00816"></a><span class="lineno">  816</span>&#160;              }</div>
<div class="line"><a name="l00817"></a><span class="lineno">  817</span>&#160;    }</div>
<div class="line"><a name="l00818"></a><span class="lineno">  818</span>&#160;</div>
<div class="line"><a name="l00819"></a><span class="lineno">  819</span>&#160;  <span class="comment">// Perform an LU factorization of matrix m_LU. Checked 12/06/12</span></div>
<div class="line"><a name="l00820"></a><span class="lineno">  820</span>&#160;  Teuchos::LAPACK&lt;int, double&gt; lapack;</div>
<div class="line"><a name="l00821"></a><span class="lineno">  821</span>&#160;  <span class="keywordtype">int</span> info;</div>
<div class="line"><a name="l00822"></a><span class="lineno">  822</span>&#160;</div>
<div class="line"><a name="l00823"></a><span class="lineno">  823</span>&#160;  lapack.GETRF( <a class="code" href="a00227.html#a6df7300159f5ca3ff664ebca6e3c932f">m_LU</a>.numRows(), <a class="code" href="a00227.html#a6df7300159f5ca3ff664ebca6e3c932f">m_LU</a>.numCols(), <a class="code" href="a00227.html#a6df7300159f5ca3ff664ebca6e3c932f">m_LU</a>.values(), <a class="code" href="a00227.html#a6df7300159f5ca3ff664ebca6e3c932f">m_LU</a>.stride(), <a class="code" href="a00227.html#af81bb8e0e3c02a248b8cdf87fc13fd2a">v_pivoting</a>, &amp;info );</div>
<div class="line"><a name="l00824"></a><span class="lineno">  824</span>&#160;</div>
<div class="line"><a name="l00825"></a><span class="lineno">  825</span>&#160;  <span class="keywordflow">if</span> (info != 0) {</div>
<div class="line"><a name="l00826"></a><span class="lineno">  826</span>&#160;    std::cerr   &lt;&lt; <span class="stringliteral">&quot;In TeuchosMatrix::invertMultiply()&quot;</span></div>
<div class="line"><a name="l00827"></a><span class="lineno">  827</span>&#160;                &lt;&lt; <span class="stringliteral">&quot;, after lapack.GETRF&quot;</span></div>
<div class="line"><a name="l00828"></a><span class="lineno">  828</span>&#160;                &lt;&lt; <span class="stringliteral">&quot;: INFO = &quot;</span> &lt;&lt; info</div>
<div class="line"><a name="l00829"></a><span class="lineno">  829</span>&#160;                &lt;&lt; <span class="stringliteral">&quot;,\nINFO &lt; 0:  if INFO = -i, the i-th argument had an illegal value.\n&quot;</span></div>
<div class="line"><a name="l00830"></a><span class="lineno">  830</span>&#160;                &lt;&lt; <span class="stringliteral">&quot;INFO &gt; 0:  if INFO = i, U(i,i) is exactly zero. The factorization \n&quot;</span></div>
<div class="line"><a name="l00831"></a><span class="lineno">  831</span>&#160;                &lt;&lt; <span class="stringliteral">&quot;has been completed, but the factor U is exactly singular, and division \n&quot;</span></div>
<div class="line"><a name="l00832"></a><span class="lineno">  832</span>&#160;                &lt;&lt; <span class="stringliteral">&quot;by zero will occur if it is used to solve a system of equations.&quot;</span></div>
<div class="line"><a name="l00833"></a><span class="lineno">  833</span>&#160;                &lt;&lt; std::endl;</div>
<div class="line"><a name="l00834"></a><span class="lineno">  834</span>&#160;  }</div>
<div class="line"><a name="l00835"></a><span class="lineno">  835</span>&#160;  queso_require_msg(!(info), <span class="stringliteral">&quot;GETRF() failed&quot;</span>);</div>
<div class="line"><a name="l00836"></a><span class="lineno">  836</span>&#160;</div>
<div class="line"><a name="l00837"></a><span class="lineno">  837</span>&#160;  <span class="keywordflow">if</span> (info &gt;  0)</div>
<div class="line"><a name="l00838"></a><span class="lineno">  838</span>&#160;     <a class="code" href="a00227.html#afb82d09e20c32f15e4b4a490efedab9b">m_isSingular</a> = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00839"></a><span class="lineno">  839</span>&#160;</div>
<div class="line"><a name="l00840"></a><span class="lineno">  840</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="a00164.html#a3384d3fc1a1058fce9191b0d74653911">m_inDebugMode</a>) {</div>
<div class="line"><a name="l00841"></a><span class="lineno">  841</span>&#160;    std::cout &lt;&lt; <span class="stringliteral">&quot;In TeuchosMatrix::invertMultiply()&quot;</span></div>
<div class="line"><a name="l00842"></a><span class="lineno">  842</span>&#160;              &lt;&lt; <span class="stringliteral">&quot;: after LU decomposition, m_LU = &quot;</span>;</div>
<div class="line"><a name="l00843"></a><span class="lineno">  843</span>&#160;              <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0;i&lt;3;i++){</div>
<div class="line"><a name="l00844"></a><span class="lineno">  844</span>&#160;                <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j=0;j&lt;3;j++)</div>
<div class="line"><a name="l00845"></a><span class="lineno">  845</span>&#160;                  cout &lt;&lt; <a class="code" href="a00227.html#a6df7300159f5ca3ff664ebca6e3c932f">m_LU</a>(i,j) &lt;&lt;<span class="stringliteral">&quot;\t&quot;</span> ;</div>
<div class="line"><a name="l00846"></a><span class="lineno">  846</span>&#160;                cout &lt;&lt; endl;</div>
<div class="line"><a name="l00847"></a><span class="lineno">  847</span>&#160;              }</div>
<div class="line"><a name="l00848"></a><span class="lineno">  848</span>&#160;      std::cout &lt;&lt; std::endl;</div>
<div class="line"><a name="l00849"></a><span class="lineno">  849</span>&#160;    }</div>
<div class="line"><a name="l00850"></a><span class="lineno">  850</span>&#160;  }</div>
<div class="line"><a name="l00851"></a><span class="lineno">  851</span>&#160;  <span class="keywordflow">if</span> ((<a class="code" href="a00164.html#a247fb0fc0b87fecdee054bb4660b68e8">m_env</a>.<a class="code" href="a00036.html#a8a0064746ae8dddfece4229b9ad374d6">subDisplayFile</a>()) &amp;&amp; (<a class="code" href="a00164.html#a247fb0fc0b87fecdee054bb4660b68e8">m_env</a>.<a class="code" href="a00036.html#a1fe5f244fc0316a0ab3e37463f108b96">displayVerbosity</a>() &gt;= 99)) {</div>
<div class="line"><a name="l00852"></a><span class="lineno">  852</span>&#160;    *<a class="code" href="a00164.html#a247fb0fc0b87fecdee054bb4660b68e8">m_env</a>.<a class="code" href="a00036.html#a8a0064746ae8dddfece4229b9ad374d6">subDisplayFile</a>() &lt;&lt; <span class="stringliteral">&quot;In TeuchosMatrix::invertMultiply()&quot;</span></div>
<div class="line"><a name="l00853"></a><span class="lineno">  853</span>&#160;                            &lt;&lt; <span class="stringliteral">&quot;: before &#39;lapack.GETRS()&#39;&quot;</span></div>
<div class="line"><a name="l00854"></a><span class="lineno">  854</span>&#160;                            &lt;&lt; std::endl;</div>
<div class="line"><a name="l00855"></a><span class="lineno">  855</span>&#160;  }</div>
<div class="line"><a name="l00856"></a><span class="lineno">  856</span>&#160;</div>
<div class="line"><a name="l00857"></a><span class="lineno">  857</span>&#160;  <span class="comment">// Solve the linear system.</span></div>
<div class="line"><a name="l00858"></a><span class="lineno">  858</span>&#160;  Teuchos::LAPACK&lt;int, double&gt; lapack;</div>
<div class="line"><a name="l00859"></a><span class="lineno">  859</span>&#160;  <span class="keywordtype">int</span> NRHS = 1; <span class="comment">// NRHS: number of right hand sides, i.e., the number</span></div>
<div class="line"><a name="l00860"></a><span class="lineno">  860</span>&#160;                                <span class="comment">// of columns of the matrix B. In this case, vector b.</span></div>
<div class="line"><a name="l00861"></a><span class="lineno">  861</span>&#160;  <span class="keywordtype">char</span> TRANS = <span class="charliteral">&#39;N&#39;</span>;  <span class="comment">// &#39;N&#39;:  A * x= B  (No transpose). Specifies the</span></div>
<div class="line"><a name="l00862"></a><span class="lineno">  862</span>&#160;                                     <span class="comment">// form of the system of equations.</span></div>
<div class="line"><a name="l00863"></a><span class="lineno">  863</span>&#160;  <span class="keywordtype">int</span> info02;</div>
<div class="line"><a name="l00864"></a><span class="lineno">  864</span>&#160;</div>
<div class="line"><a name="l00865"></a><span class="lineno">  865</span>&#160;  <span class="comment">//GETRS expects the matrix to be already factored in LU and uses the</span></div>
<div class="line"><a name="l00866"></a><span class="lineno">  866</span>&#160;  <span class="comment">//same ipiv vector, which are the pivot indices of the LU factorization</span></div>
<div class="line"><a name="l00867"></a><span class="lineno">  867</span>&#160;</div>
<div class="line"><a name="l00868"></a><span class="lineno">  868</span>&#160;  x=b;</div>
<div class="line"><a name="l00869"></a><span class="lineno">  869</span>&#160;  lapack.GETRS(TRANS, <a class="code" href="a00227.html#a6df7300159f5ca3ff664ebca6e3c932f">m_LU</a>.numRows(), NRHS, <a class="code" href="a00227.html#a6df7300159f5ca3ff664ebca6e3c932f">m_LU</a>.values(), <a class="code" href="a00227.html#a6df7300159f5ca3ff664ebca6e3c932f">m_LU</a>.stride(), <a class="code" href="a00227.html#af81bb8e0e3c02a248b8cdf87fc13fd2a">v_pivoting</a>, &amp;x[0],x.<a class="code" href="a00228.html#aa1d2726c42a9c317898e348fafca6998">sizeLocal</a>(), &amp;info02 );</div>
<div class="line"><a name="l00870"></a><span class="lineno">  870</span>&#160;</div>
<div class="line"><a name="l00871"></a><span class="lineno">  871</span>&#160;  <span class="keywordflow">if</span> (info02 != 0) {</div>
<div class="line"><a name="l00872"></a><span class="lineno">  872</span>&#160;      std::cerr &lt;&lt; <span class="stringliteral">&quot;In TeuchosMatrix::invertMultiply()&quot;</span></div>
<div class="line"><a name="l00873"></a><span class="lineno">  873</span>&#160;                &lt;&lt; <span class="stringliteral">&quot;, after lapack.GETRS - solve LU system&quot;</span></div>
<div class="line"><a name="l00874"></a><span class="lineno">  874</span>&#160;                &lt;&lt; <span class="stringliteral">&quot;: INFO = &quot;</span> &lt;&lt; info02</div>
<div class="line"><a name="l00875"></a><span class="lineno">  875</span>&#160;                &lt;&lt; <span class="stringliteral">&quot;,\nINFO &lt; 0:  if INFO = -i, the i-th argument had an illegal value.\n&quot;</span></div>
<div class="line"><a name="l00876"></a><span class="lineno">  876</span>&#160;                &lt;&lt; std::endl;</div>
<div class="line"><a name="l00877"></a><span class="lineno">  877</span>&#160;  }</div>
<div class="line"><a name="l00878"></a><span class="lineno">  878</span>&#160;  queso_require_msg(!(info02), <span class="stringliteral">&quot;GETRS() failed&quot;</span>);</div>
<div class="line"><a name="l00879"></a><span class="lineno">  879</span>&#160; <span class="keywordflow">if</span> ((<a class="code" href="a00164.html#a247fb0fc0b87fecdee054bb4660b68e8">m_env</a>.<a class="code" href="a00036.html#a8a0064746ae8dddfece4229b9ad374d6">subDisplayFile</a>()) &amp;&amp; (<a class="code" href="a00164.html#a247fb0fc0b87fecdee054bb4660b68e8">m_env</a>.<a class="code" href="a00036.html#a1fe5f244fc0316a0ab3e37463f108b96">displayVerbosity</a>() &gt;= 99)) {</div>
<div class="line"><a name="l00880"></a><span class="lineno">  880</span>&#160;    *<a class="code" href="a00164.html#a247fb0fc0b87fecdee054bb4660b68e8">m_env</a>.<a class="code" href="a00036.html#a8a0064746ae8dddfece4229b9ad374d6">subDisplayFile</a>() &lt;&lt; <span class="stringliteral">&quot;In TeuchosMatrix::invertMultiply()&quot;</span></div>
<div class="line"><a name="l00881"></a><span class="lineno">  881</span>&#160;                            &lt;&lt; <span class="stringliteral">&quot;, after lapack.GETRS() - solve LU system.&quot;</span></div>
<div class="line"><a name="l00882"></a><span class="lineno">  882</span>&#160;                            &lt;&lt; std::endl;</div>
<div class="line"><a name="l00883"></a><span class="lineno">  883</span>&#160; }</div>
<div class="line"><a name="l00884"></a><span class="lineno">  884</span>&#160; <span class="keywordflow">if</span> (<a class="code" href="a00164.html#a3384d3fc1a1058fce9191b0d74653911">m_inDebugMode</a>) {</div>
<div class="line"><a name="l00885"></a><span class="lineno">  885</span>&#160;    <a class="code" href="a00228.html">TeuchosVector</a> tmpVec(b - (*<span class="keyword">this</span>)*x);</div>
<div class="line"><a name="l00886"></a><span class="lineno">  886</span>&#160;    std::cout &lt;&lt; <span class="stringliteral">&quot;In TeuchosMatrix::invertMultiply()&quot;</span></div>
<div class="line"><a name="l00887"></a><span class="lineno">  887</span>&#160;              &lt;&lt; <span class="stringliteral">&quot;: ||b - Ax||_2 = &quot;</span>         &lt;&lt; tmpVec.<a class="code" href="a00228.html#ac8ac3cab19606dca5097e8d80bf203bf">norm2</a>()</div>
<div class="line"><a name="l00888"></a><span class="lineno">  888</span>&#160;              &lt;&lt; <span class="stringliteral">&quot;: ||b - Ax||_2/||b||_2 = &quot;</span> &lt;&lt; tmpVec.<a class="code" href="a00228.html#ac8ac3cab19606dca5097e8d80bf203bf">norm2</a>()/b.<a class="code" href="a00228.html#ac8ac3cab19606dca5097e8d80bf203bf">norm2</a>()</div>
<div class="line"><a name="l00889"></a><span class="lineno">  889</span>&#160;              &lt;&lt; std::endl;</div>
<div class="line"><a name="l00890"></a><span class="lineno">  890</span>&#160; }</div>
<div class="line"><a name="l00891"></a><span class="lineno">  891</span>&#160; <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00892"></a><span class="lineno">  892</span>&#160;}</div>
<div class="line"><a name="l00893"></a><span class="lineno">  893</span>&#160;</div>
<div class="line"><a name="l00894"></a><span class="lineno">  894</span>&#160;<span class="comment">// ----------------------------------------------</span></div>
<div class="line"><a name="l00895"></a><span class="lineno">  895</span>&#160;<a class="code" href="a00227.html">TeuchosMatrix</a></div>
<div class="line"><a name="l00896"></a><span class="lineno"><a class="line" href="a00227.html#a391607c3bfcc5607a53170c76db6da6c">  896</a></span>&#160;<a class="code" href="a00227.html#a4f3affd6522fafb794e2cc36a382ccc9">TeuchosMatrix::invertMultiply</a>(<span class="keyword">const</span> <a class="code" href="a00227.html">TeuchosMatrix</a>&amp; B)<span class="keyword"> const</span></div>
<div class="line"><a name="l00897"></a><span class="lineno">  897</span>&#160;<span class="keyword"></span>{</div>
<div class="line"><a name="l00898"></a><span class="lineno">  898</span>&#160;  <a class="code" href="a00227.html">TeuchosMatrix</a> X(<a class="code" href="a00164.html#a247fb0fc0b87fecdee054bb4660b68e8">m_env</a>,<a class="code" href="a00164.html#a95e307c6e1263d505af0a43c35f81a8b">m_map</a>,B.<a class="code" href="a00227.html#a6e3aa20d8c618718a9fa9cc56ff65b9f">numCols</a>());</div>
<div class="line"><a name="l00899"></a><span class="lineno">  899</span>&#160;  this-&gt;<a class="code" href="a00227.html#a4f3affd6522fafb794e2cc36a382ccc9">invertMultiply</a>(B,X);</div>
<div class="line"><a name="l00900"></a><span class="lineno">  900</span>&#160;  <span class="keywordflow">return</span> X;</div>
<div class="line"><a name="l00901"></a><span class="lineno">  901</span>&#160;}</div>
<div class="line"><a name="l00902"></a><span class="lineno">  902</span>&#160;</div>
<div class="line"><a name="l00903"></a><span class="lineno">  903</span>&#160;<span class="comment">// ----------------------------------------------</span></div>
<div class="line"><a name="l00904"></a><span class="lineno">  904</span>&#160;<span class="comment">//checked 12/10/12</span></div>
<div class="line"><a name="l00905"></a><span class="lineno">  905</span>&#160;<span class="keywordtype">void</span></div>
<div class="line"><a name="l00906"></a><span class="lineno"><a class="line" href="a00227.html#ab1fb014a96472b40eae8b4e3a83bbba6">  906</a></span>&#160;<a class="code" href="a00227.html#a4f3affd6522fafb794e2cc36a382ccc9">TeuchosMatrix::invertMultiply</a>(<span class="keyword">const</span> <a class="code" href="a00227.html">TeuchosMatrix</a>&amp; B, <a class="code" href="a00227.html">TeuchosMatrix</a>&amp; X)<span class="keyword"> const</span></div>
<div class="line"><a name="l00907"></a><span class="lineno">  907</span>&#160;<span class="keyword"></span>{</div>
<div class="line"><a name="l00908"></a><span class="lineno">  908</span>&#160;  <span class="comment">// Sanity Checks</span></div>
<div class="line"><a name="l00909"></a><span class="lineno">  909</span>&#160;  queso_require_msg(!((B.<a class="code" href="a00227.html#a78a5b262967d31e6171aadd292e77395">numRowsLocal</a>() != X.<a class="code" href="a00227.html#a78a5b262967d31e6171aadd292e77395">numRowsLocal</a>()) || (B.<a class="code" href="a00227.html#a6e3aa20d8c618718a9fa9cc56ff65b9f">numCols</a>() != X.<a class="code" href="a00227.html#a6e3aa20d8c618718a9fa9cc56ff65b9f">numCols</a>())), <span class="stringliteral">&quot;Matrices B and X are incompatible&quot;</span>);</div>
<div class="line"><a name="l00910"></a><span class="lineno">  910</span>&#160;</div>
<div class="line"><a name="l00911"></a><span class="lineno">  911</span>&#160;  <a class="code" href="a00674.html#ace699c1e7716717f330c783a58ebcd4f">queso_require_equal_to_msg</a>(this-&gt;<a class="code" href="a00227.html#a78a5b262967d31e6171aadd292e77395">numRowsLocal</a>(), X.<a class="code" href="a00227.html#a78a5b262967d31e6171aadd292e77395">numRowsLocal</a>(), <span class="stringliteral">&quot;This and X matrices are incompatible&quot;</span>);</div>
<div class="line"><a name="l00912"></a><span class="lineno">  912</span>&#160;</div>
<div class="line"><a name="l00913"></a><span class="lineno">  913</span>&#160;  <span class="comment">// Some local variables used within the loop.</span></div>
<div class="line"><a name="l00914"></a><span class="lineno">  914</span>&#160;  <a class="code" href="a00228.html">TeuchosVector</a> b(<a class="code" href="a00164.html#a247fb0fc0b87fecdee054bb4660b68e8">m_env</a>, <a class="code" href="a00164.html#a95e307c6e1263d505af0a43c35f81a8b">m_map</a>);</div>
<div class="line"><a name="l00915"></a><span class="lineno">  915</span>&#160;  <a class="code" href="a00228.html">TeuchosVector</a> x(<a class="code" href="a00164.html#a247fb0fc0b87fecdee054bb4660b68e8">m_env</a>, <a class="code" href="a00164.html#a95e307c6e1263d505af0a43c35f81a8b">m_map</a>);</div>
<div class="line"><a name="l00916"></a><span class="lineno">  916</span>&#160;</div>
<div class="line"><a name="l00917"></a><span class="lineno">  917</span>&#160;  <span class="keywordflow">for</span>( <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> j = 0; j &lt; B.<a class="code" href="a00227.html#a6e3aa20d8c618718a9fa9cc56ff65b9f">numCols</a>(); ++j ) {</div>
<div class="line"><a name="l00918"></a><span class="lineno">  918</span>&#160;    b = B.<a class="code" href="a00227.html#ae66a7551b49a7e33a407972c3da2763c">getColumn</a>(j);</div>
<div class="line"><a name="l00919"></a><span class="lineno">  919</span>&#160;    <span class="comment">//invertMultiply will only do the LU factorization once and store it.</span></div>
<div class="line"><a name="l00920"></a><span class="lineno">  920</span>&#160;    x = this-&gt;<a class="code" href="a00227.html#a4f3affd6522fafb794e2cc36a382ccc9">invertMultiply</a>(b);</div>
<div class="line"><a name="l00921"></a><span class="lineno">  921</span>&#160;    X.<a class="code" href="a00227.html#a5855b579a855166171ccdd72c55e5d0d">setColumn</a>(j,x);</div>
<div class="line"><a name="l00922"></a><span class="lineno">  922</span>&#160;  }</div>
<div class="line"><a name="l00923"></a><span class="lineno">  923</span>&#160;  <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00924"></a><span class="lineno">  924</span>&#160;}</div>
<div class="line"><a name="l00925"></a><span class="lineno">  925</span>&#160;</div>
<div class="line"><a name="l00926"></a><span class="lineno">  926</span>&#160;<span class="comment">//-----------------------------------------------</span></div>
<div class="line"><a name="l00927"></a><span class="lineno">  927</span>&#160;<a class="code" href="a00228.html">TeuchosVector</a></div>
<div class="line"><a name="l00928"></a><span class="lineno"><a class="line" href="a00227.html#a522ff5e32c69a6db7dbd49dc667df962">  928</a></span>&#160;<a class="code" href="a00227.html#aa6ea06ee3e2307d4f72bbea12933c919">TeuchosMatrix::invertMultiplyForceLU</a>(<span class="keyword">const</span> <a class="code" href="a00228.html">TeuchosVector</a>&amp; b)<span class="keyword"> const</span></div>
<div class="line"><a name="l00929"></a><span class="lineno">  929</span>&#160;<span class="keyword"></span>{</div>
<div class="line"><a name="l00930"></a><span class="lineno">  930</span>&#160;  <a class="code" href="a00674.html#ace699c1e7716717f330c783a58ebcd4f">queso_require_equal_to_msg</a>(this-&gt;<a class="code" href="a00227.html#a6e3aa20d8c618718a9fa9cc56ff65b9f">numCols</a>(), b.<a class="code" href="a00228.html#aa1d2726c42a9c317898e348fafca6998">sizeLocal</a>(), <span class="stringliteral">&quot;matrix and rhs have incompatible sizes&quot;</span>);</div>
<div class="line"><a name="l00931"></a><span class="lineno">  931</span>&#160;</div>
<div class="line"><a name="l00932"></a><span class="lineno">  932</span>&#160;  <a class="code" href="a00228.html">TeuchosVector</a> x(<a class="code" href="a00164.html#a247fb0fc0b87fecdee054bb4660b68e8">m_env</a>,<a class="code" href="a00164.html#a95e307c6e1263d505af0a43c35f81a8b">m_map</a>);</div>
<div class="line"><a name="l00933"></a><span class="lineno">  933</span>&#160;  this-&gt;<a class="code" href="a00227.html#aa6ea06ee3e2307d4f72bbea12933c919">invertMultiplyForceLU</a>(b,x);</div>
<div class="line"><a name="l00934"></a><span class="lineno">  934</span>&#160;</div>
<div class="line"><a name="l00935"></a><span class="lineno">  935</span>&#160;  <span class="keywordflow">return</span> x;</div>
<div class="line"><a name="l00936"></a><span class="lineno">  936</span>&#160;}</div>
<div class="line"><a name="l00937"></a><span class="lineno">  937</span>&#160;</div>
<div class="line"><a name="l00938"></a><span class="lineno">  938</span>&#160;<span class="comment">// ---------------------------------------------------</span></div>
<div class="line"><a name="l00939"></a><span class="lineno">  939</span>&#160;<span class="comment">// implemented and checked on 1/9/13</span></div>
<div class="line"><a name="l00940"></a><span class="lineno">  940</span>&#160;<span class="keywordtype">void</span></div>
<div class="line"><a name="l00941"></a><span class="lineno"><a class="line" href="a00227.html#aa6ea06ee3e2307d4f72bbea12933c919">  941</a></span>&#160;<a class="code" href="a00227.html#aa6ea06ee3e2307d4f72bbea12933c919">TeuchosMatrix::invertMultiplyForceLU</a>(<span class="keyword">const</span> <a class="code" href="a00228.html">TeuchosVector</a>&amp; b, <a class="code" href="a00228.html">TeuchosVector</a>&amp; x)<span class="keyword"> const</span></div>
<div class="line"><a name="l00942"></a><span class="lineno">  942</span>&#160;<span class="keyword"></span>{</div>
<div class="line"><a name="l00943"></a><span class="lineno">  943</span>&#160;  <a class="code" href="a00674.html#ace699c1e7716717f330c783a58ebcd4f">queso_require_equal_to_msg</a>(this-&gt;<a class="code" href="a00227.html#a6e3aa20d8c618718a9fa9cc56ff65b9f">numCols</a>(), b.<a class="code" href="a00228.html#aa1d2726c42a9c317898e348fafca6998">sizeLocal</a>(), <span class="stringliteral">&quot;matrix and rhs have incompatible sizes&quot;</span>);</div>
<div class="line"><a name="l00944"></a><span class="lineno">  944</span>&#160;</div>
<div class="line"><a name="l00945"></a><span class="lineno">  945</span>&#160;  <a class="code" href="a00674.html#ace699c1e7716717f330c783a58ebcd4f">queso_require_equal_to_msg</a>(x.<a class="code" href="a00228.html#aa1d2726c42a9c317898e348fafca6998">sizeLocal</a>(), b.<a class="code" href="a00228.html#aa1d2726c42a9c317898e348fafca6998">sizeLocal</a>(), <span class="stringliteral">&quot;solution and rhs have incompatible sizes&quot;</span>);</div>
<div class="line"><a name="l00946"></a><span class="lineno">  946</span>&#160;</div>
<div class="line"><a name="l00947"></a><span class="lineno">  947</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="a00227.html#a6df7300159f5ca3ff664ebca6e3c932f">m_LU</a>.numCols() == 0 &amp;&amp; <a class="code" href="a00227.html#a6df7300159f5ca3ff664ebca6e3c932f">m_LU</a>.numRows() == 0) {</div>
<div class="line"><a name="l00948"></a><span class="lineno">  948</span>&#160;    queso_require_msg(!(<a class="code" href="a00227.html#af81bb8e0e3c02a248b8cdf87fc13fd2a">v_pivoting</a>), <span class="stringliteral">&quot;v_pivoting should be NULL&quot;</span>);</div>
<div class="line"><a name="l00949"></a><span class="lineno">  949</span>&#160;  }</div>
<div class="line"><a name="l00950"></a><span class="lineno">  950</span>&#160;</div>
<div class="line"><a name="l00951"></a><span class="lineno">  951</span>&#160;  <span class="comment">//allocate m_LU , yes outside the if above</span></div>
<div class="line"><a name="l00952"></a><span class="lineno">  952</span>&#160;  <a class="code" href="a00227.html#a6df7300159f5ca3ff664ebca6e3c932f">m_LU</a> = <a class="code" href="a00227.html#a154931850614ec7597e9b134b7d9ffbb">m_mat</a>;</div>
<div class="line"><a name="l00953"></a><span class="lineno">  953</span>&#160;</div>
<div class="line"><a name="l00954"></a><span class="lineno">  954</span>&#160;  <a class="code" href="a00674.html#aae2cd8576f7d7d4de5543f13b8edc974">queso_require_not_equal_to_msg</a>(<a class="code" href="a00227.html#a6df7300159f5ca3ff664ebca6e3c932f">m_LU</a>.numCols(), 0 &amp;&amp; <a class="code" href="a00227.html#a6df7300159f5ca3ff664ebca6e3c932f">m_LU</a>.numRows() == 0, <span class="stringliteral">&quot;Teuchos atttribuition m_LU = m_mat failed&quot;</span>);</div>
<div class="line"><a name="l00955"></a><span class="lineno">  955</span>&#160;</div>
<div class="line"><a name="l00956"></a><span class="lineno">  956</span>&#160;  <span class="comment">//allocate v_pivoting</span></div>
<div class="line"><a name="l00957"></a><span class="lineno">  957</span>&#160;  <span class="keywordflow">if</span> ( <a class="code" href="a00227.html#af81bb8e0e3c02a248b8cdf87fc13fd2a">v_pivoting</a> == NULL )</div>
<div class="line"><a name="l00958"></a><span class="lineno">  958</span>&#160;    <a class="code" href="a00227.html#af81bb8e0e3c02a248b8cdf87fc13fd2a">v_pivoting</a> =(<span class="keywordtype">int</span> *) malloc(<span class="keyword">sizeof</span>(<span class="keywordtype">int</span>)*<a class="code" href="a00227.html#a6df7300159f5ca3ff664ebca6e3c932f">m_LU</a>.numCols() );</div>
<div class="line"><a name="l00959"></a><span class="lineno">  959</span>&#160;</div>
<div class="line"><a name="l00960"></a><span class="lineno">  960</span>&#160;  queso_require_msg(<a class="code" href="a00227.html#af81bb8e0e3c02a248b8cdf87fc13fd2a">v_pivoting</a>, <span class="stringliteral">&quot;malloc() for v_pivoting failed&quot;</span>);</div>
<div class="line"><a name="l00961"></a><span class="lineno">  961</span>&#160;</div>
<div class="line"><a name="l00962"></a><span class="lineno">  962</span>&#160;  <span class="comment">// Perform an LU factorization of matrix m_LU. Checked 12/06/12</span></div>
<div class="line"><a name="l00963"></a><span class="lineno">  963</span>&#160;  Teuchos::LAPACK&lt;int, double&gt; lapack;</div>
<div class="line"><a name="l00964"></a><span class="lineno">  964</span>&#160;  <span class="keywordtype">int</span> info;</div>
<div class="line"><a name="l00965"></a><span class="lineno">  965</span>&#160;</div>
<div class="line"><a name="l00966"></a><span class="lineno">  966</span>&#160;  lapack.GETRF( <a class="code" href="a00227.html#a6df7300159f5ca3ff664ebca6e3c932f">m_LU</a>.numRows(), <a class="code" href="a00227.html#a6df7300159f5ca3ff664ebca6e3c932f">m_LU</a>.numCols(), <a class="code" href="a00227.html#a6df7300159f5ca3ff664ebca6e3c932f">m_LU</a>.values(), <a class="code" href="a00227.html#a6df7300159f5ca3ff664ebca6e3c932f">m_LU</a>.stride(), <a class="code" href="a00227.html#af81bb8e0e3c02a248b8cdf87fc13fd2a">v_pivoting</a>, &amp;info );</div>
<div class="line"><a name="l00967"></a><span class="lineno">  967</span>&#160;</div>
<div class="line"><a name="l00968"></a><span class="lineno">  968</span>&#160;  <span class="keywordflow">if</span> (info != 0) {</div>
<div class="line"><a name="l00969"></a><span class="lineno">  969</span>&#160;    std::cerr   &lt;&lt; <span class="stringliteral">&quot;In TeuchosMatrix::invertMultiply()&quot;</span></div>
<div class="line"><a name="l00970"></a><span class="lineno">  970</span>&#160;                &lt;&lt; <span class="stringliteral">&quot;, after lapack.GETRF&quot;</span></div>
<div class="line"><a name="l00971"></a><span class="lineno">  971</span>&#160;                &lt;&lt; <span class="stringliteral">&quot;: INFO = &quot;</span> &lt;&lt; info</div>
<div class="line"><a name="l00972"></a><span class="lineno">  972</span>&#160;                &lt;&lt; <span class="stringliteral">&quot;,\nINFO &lt; 0:  if INFO = -i, the i-th argument had an illegal value.\n&quot;</span></div>
<div class="line"><a name="l00973"></a><span class="lineno">  973</span>&#160;                &lt;&lt; <span class="stringliteral">&quot;INFO &gt; 0:  if INFO = i, U(i,i) is exactly zero. The factorization \n&quot;</span></div>
<div class="line"><a name="l00974"></a><span class="lineno">  974</span>&#160;                &lt;&lt; <span class="stringliteral">&quot;has been completed, but the factor U is exactly singular, and division \n&quot;</span></div>
<div class="line"><a name="l00975"></a><span class="lineno">  975</span>&#160;                &lt;&lt; <span class="stringliteral">&quot;by zero will occur if it is used to solve a system of equations.&quot;</span></div>
<div class="line"><a name="l00976"></a><span class="lineno">  976</span>&#160;                &lt;&lt; std::endl;</div>
<div class="line"><a name="l00977"></a><span class="lineno">  977</span>&#160;  }</div>
<div class="line"><a name="l00978"></a><span class="lineno">  978</span>&#160;</div>
<div class="line"><a name="l00979"></a><span class="lineno">  979</span>&#160;  queso_require_msg(!(info), <span class="stringliteral">&quot;GETRF() failed&quot;</span>);</div>
<div class="line"><a name="l00980"></a><span class="lineno">  980</span>&#160;</div>
<div class="line"><a name="l00981"></a><span class="lineno">  981</span>&#160;  <span class="keywordflow">if</span> (info &gt;  0)</div>
<div class="line"><a name="l00982"></a><span class="lineno">  982</span>&#160;     <a class="code" href="a00227.html#afb82d09e20c32f15e4b4a490efedab9b">m_isSingular</a> = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00983"></a><span class="lineno">  983</span>&#160;</div>
<div class="line"><a name="l00984"></a><span class="lineno">  984</span>&#160;  <span class="comment">// Solve the linear system.</span></div>
<div class="line"><a name="l00985"></a><span class="lineno">  985</span>&#160;  <span class="keywordtype">int</span> NRHS = 1; <span class="comment">// NRHS: number of right hand sides, i.e., the number</span></div>
<div class="line"><a name="l00986"></a><span class="lineno">  986</span>&#160;                                <span class="comment">// of columns of the matrix B. In this case, vector b.</span></div>
<div class="line"><a name="l00987"></a><span class="lineno">  987</span>&#160;  <span class="keywordtype">char</span> TRANS = <span class="charliteral">&#39;N&#39;</span>;  <span class="comment">// &#39;N&#39;:  A * x= B  (No transpose). Specifies the</span></div>
<div class="line"><a name="l00988"></a><span class="lineno">  988</span>&#160;                                     <span class="comment">// form of the system of equations.</span></div>
<div class="line"><a name="l00989"></a><span class="lineno">  989</span>&#160;  <span class="keywordtype">int</span> info02;</div>
<div class="line"><a name="l00990"></a><span class="lineno">  990</span>&#160;</div>
<div class="line"><a name="l00991"></a><span class="lineno">  991</span>&#160;  <span class="comment">//GETRS expects the matrix to be already factored in LU and uses the</span></div>
<div class="line"><a name="l00992"></a><span class="lineno">  992</span>&#160;  <span class="comment">//same ipiv vector, which are the pivot indices of the LU factorization</span></div>
<div class="line"><a name="l00993"></a><span class="lineno">  993</span>&#160;</div>
<div class="line"><a name="l00994"></a><span class="lineno">  994</span>&#160;  x=b;</div>
<div class="line"><a name="l00995"></a><span class="lineno">  995</span>&#160;  lapack.GETRS(TRANS, <a class="code" href="a00227.html#a6df7300159f5ca3ff664ebca6e3c932f">m_LU</a>.numRows(), NRHS, <a class="code" href="a00227.html#a6df7300159f5ca3ff664ebca6e3c932f">m_LU</a>.values(), <a class="code" href="a00227.html#a6df7300159f5ca3ff664ebca6e3c932f">m_LU</a>.stride(), <a class="code" href="a00227.html#af81bb8e0e3c02a248b8cdf87fc13fd2a">v_pivoting</a>, &amp;x[0],x.<a class="code" href="a00228.html#aa1d2726c42a9c317898e348fafca6998">sizeLocal</a>(), &amp;info02 );</div>
<div class="line"><a name="l00996"></a><span class="lineno">  996</span>&#160;</div>
<div class="line"><a name="l00997"></a><span class="lineno">  997</span>&#160;  <span class="keywordflow">if</span> (info02 != 0) {</div>
<div class="line"><a name="l00998"></a><span class="lineno">  998</span>&#160;      std::cerr &lt;&lt; <span class="stringliteral">&quot;In TeuchosMatrix::invertMultiply()&quot;</span></div>
<div class="line"><a name="l00999"></a><span class="lineno">  999</span>&#160;                &lt;&lt; <span class="stringliteral">&quot;, after lapack.GETRS - solve LU system&quot;</span></div>
<div class="line"><a name="l01000"></a><span class="lineno"> 1000</span>&#160;                &lt;&lt; <span class="stringliteral">&quot;: INFO = &quot;</span> &lt;&lt; info02</div>
<div class="line"><a name="l01001"></a><span class="lineno"> 1001</span>&#160;                &lt;&lt; <span class="stringliteral">&quot;,\nINFO &lt; 0:  if INFO = -i, the i-th argument had an illegal value.\n&quot;</span></div>
<div class="line"><a name="l01002"></a><span class="lineno"> 1002</span>&#160;                &lt;&lt; std::endl;</div>
<div class="line"><a name="l01003"></a><span class="lineno"> 1003</span>&#160;    }</div>
<div class="line"><a name="l01004"></a><span class="lineno"> 1004</span>&#160;</div>
<div class="line"><a name="l01005"></a><span class="lineno"> 1005</span>&#160;    queso_require_msg(!(info02), <span class="stringliteral">&quot;GETRS() failed&quot;</span>);</div>
<div class="line"><a name="l01006"></a><span class="lineno"> 1006</span>&#160;</div>
<div class="line"><a name="l01007"></a><span class="lineno"> 1007</span>&#160; <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l01008"></a><span class="lineno"> 1008</span>&#160;}</div>
<div class="line"><a name="l01009"></a><span class="lineno"> 1009</span>&#160;<span class="comment">// ---------------------------------------------------</span></div>
<div class="line"><a name="l01010"></a><span class="lineno"> 1010</span>&#160;<span class="comment">// Implemented and checked on 1/7/2013</span></div>
<div class="line"><a name="l01011"></a><span class="lineno"> 1011</span>&#160;</div>
<div class="line"><a name="l01012"></a><span class="lineno"> 1012</span>&#160;<span class="comment">/*  DSYEV computes all eigenvalues and, optionally, eigenvectors of a real symmetric matrix A.</span></div>
<div class="line"><a name="l01013"></a><span class="lineno"> 1013</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l01014"></a><span class="lineno"> 1014</span>&#160;<span class="comment">*  Arguments</span></div>
<div class="line"><a name="l01015"></a><span class="lineno"> 1015</span>&#160;<span class="comment">*  JOBZ    = &#39;N&#39;:  Compute eigenvalues only;</span></div>
<div class="line"><a name="l01016"></a><span class="lineno"> 1016</span>&#160;<span class="comment">*          = &#39;V&#39;:  Compute eigenvalues and eigenvectors.</span></div>
<div class="line"><a name="l01017"></a><span class="lineno"> 1017</span>&#160;<span class="comment">*  UPLO    = &#39;U&#39;:  Upper triangle of A is stored;</span></div>
<div class="line"><a name="l01018"></a><span class="lineno"> 1018</span>&#160;<span class="comment">*          = &#39;L&#39;:  Lower triangle of A is stored.</span></div>
<div class="line"><a name="l01019"></a><span class="lineno"> 1019</span>&#160;<span class="comment">*  N       The order of the matrix A.  N &gt;= 0.</span></div>
<div class="line"><a name="l01020"></a><span class="lineno"> 1020</span>&#160;<span class="comment">*  A       (input/output) DOUBLE PRECISION array, dimension (LDA, N).On entry, the symmetric</span></div>
<div class="line"><a name="l01021"></a><span class="lineno"> 1021</span>&#160;<span class="comment">*  matrix A.  If UPLO = &#39;U&#39;, the leading N-by-N upper triangular part of A contains the</span></div>
<div class="line"><a name="l01022"></a><span class="lineno"> 1022</span>&#160;<span class="comment">*  upper triangular part of the matrix A.  If UPLO = &#39;L&#39;, the leading N-by-N lower triangular</span></div>
<div class="line"><a name="l01023"></a><span class="lineno"> 1023</span>&#160;<span class="comment">*  part of A contains the lower triangular part of the matrix A. On exit, if JOBZ = &#39;V&#39;, then</span></div>
<div class="line"><a name="l01024"></a><span class="lineno"> 1024</span>&#160;<span class="comment">*  if INFO = 0, A contains the orthonormal eigenvectors of the matrix A. If JOBZ = &#39;N&#39;, then</span></div>
<div class="line"><a name="l01025"></a><span class="lineno"> 1025</span>&#160;<span class="comment">*  on exit the lower triangle (if UPLO=&#39;L&#39;) or the upper triangle (if UPLO=&#39;U&#39;) of A,</span></div>
<div class="line"><a name="l01026"></a><span class="lineno"> 1026</span>&#160;<span class="comment">*  including the  diagonal, is destroyed.</span></div>
<div class="line"><a name="l01027"></a><span class="lineno"> 1027</span>&#160;<span class="comment">*  LDA     (input) INTEGER - the leading dimension of the array A.  LDA &gt;= max(1,N).</span></div>
<div class="line"><a name="l01028"></a><span class="lineno"> 1028</span>&#160;<span class="comment">*  W       (output) DOUBLE PRECISION array, dimension (N)</span></div>
<div class="line"><a name="l01029"></a><span class="lineno"> 1029</span>&#160;<span class="comment">*          If INFO = 0, the eigenvalues in ascending order.</span></div>
<div class="line"><a name="l01030"></a><span class="lineno"> 1030</span>&#160;<span class="comment">*  WORK    (workspace/output) DOUBLE PRECISION array, dimension (MAX(1,LWORK))</span></div>
<div class="line"><a name="l01031"></a><span class="lineno"> 1031</span>&#160;<span class="comment">*          On exit, if INFO = 0, WORK(1) returns the optimal LWORK.</span></div>
<div class="line"><a name="l01032"></a><span class="lineno"> 1032</span>&#160;<span class="comment">*  LWORK   (input) INTEGER - the length of the array WORK.  LWORK &gt;= max(1,3*N-1).</span></div>
<div class="line"><a name="l01033"></a><span class="lineno"> 1033</span>&#160;<span class="comment">*  INFO    (output) INTEGER</span></div>
<div class="line"><a name="l01034"></a><span class="lineno"> 1034</span>&#160;<span class="comment">*          = 0:  successful exit</span></div>
<div class="line"><a name="l01035"></a><span class="lineno"> 1035</span>&#160;<span class="comment">*          &lt; 0:  if INFO = -i, the i-th argument had an illegal value</span></div>
<div class="line"><a name="l01036"></a><span class="lineno"> 1036</span>&#160;<span class="comment">*          &gt; 0:  if INFO = i, the algorithm failed to converge; i off-diagonal elements of</span></div>
<div class="line"><a name="l01037"></a><span class="lineno"> 1037</span>&#160;<span class="comment">*                an intermediate tridiagonal form did not converge to zero.*/</span></div>
<div class="line"><a name="l01038"></a><span class="lineno"> 1038</span>&#160;<span class="keywordtype">void</span></div>
<div class="line"><a name="l01039"></a><span class="lineno"><a class="line" href="a00227.html#adcf5767d9854efc82ba9da78b3d5bec2"> 1039</a></span>&#160;<a class="code" href="a00227.html#adcf5767d9854efc82ba9da78b3d5bec2">TeuchosMatrix::eigen</a>(<a class="code" href="a00228.html">TeuchosVector</a>&amp; eigenValues, <a class="code" href="a00227.html">TeuchosMatrix</a>* eigenVectors)<span class="keyword"> const</span></div>
<div class="line"><a name="l01040"></a><span class="lineno"> 1040</span>&#160;<span class="keyword"></span>{</div>
<div class="line"><a name="l01041"></a><span class="lineno"> 1041</span>&#160;  <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> n = eigenValues.<a class="code" href="a00228.html#aa1d2726c42a9c317898e348fafca6998">sizeLocal</a>();</div>
<div class="line"><a name="l01042"></a><span class="lineno"> 1042</span>&#160;</div>
<div class="line"><a name="l01043"></a><span class="lineno"> 1043</span>&#160;  <a class="code" href="a00674.html#aae2cd8576f7d7d4de5543f13b8edc974">queso_require_not_equal_to_msg</a>(n, 0, <span class="stringliteral">&quot;invalid input vector size&quot;</span>);</div>
<div class="line"><a name="l01044"></a><span class="lineno"> 1044</span>&#160;</div>
<div class="line"><a name="l01045"></a><span class="lineno"> 1045</span>&#160;  <span class="keywordflow">if</span> (eigenVectors) {</div>
<div class="line"><a name="l01046"></a><span class="lineno"> 1046</span>&#160;    <a class="code" href="a00674.html#ace699c1e7716717f330c783a58ebcd4f">queso_require_equal_to_msg</a>(eigenValues.<a class="code" href="a00228.html#aa1d2726c42a9c317898e348fafca6998">sizeLocal</a>(), eigenVectors-&gt;<a class="code" href="a00227.html#a78a5b262967d31e6171aadd292e77395">numRowsLocal</a>(), <span class="stringliteral">&quot;different input vector sizes&quot;</span>);</div>
<div class="line"><a name="l01047"></a><span class="lineno"> 1047</span>&#160;  }</div>
<div class="line"><a name="l01048"></a><span class="lineno"> 1048</span>&#160;</div>
<div class="line"><a name="l01049"></a><span class="lineno"> 1049</span>&#160;  <span class="comment">// At the end of execution, Lapack funcion destroys the input matrix</span></div>
<div class="line"><a name="l01050"></a><span class="lineno"> 1050</span>&#160;  <span class="comment">// So, lets not use m_mat, but instead, a copy of it</span></div>
<div class="line"><a name="l01051"></a><span class="lineno"> 1051</span>&#160;  Teuchos::SerialDenseMatrix&lt;int,double&gt; copy_m_mat;</div>
<div class="line"><a name="l01052"></a><span class="lineno"> 1052</span>&#160;  copy_m_mat = <a class="code" href="a00227.html#a154931850614ec7597e9b134b7d9ffbb">m_mat</a>;</div>
<div class="line"><a name="l01053"></a><span class="lineno"> 1053</span>&#160;</div>
<div class="line"><a name="l01054"></a><span class="lineno"> 1054</span>&#160;  Teuchos::LAPACK&lt;int, double&gt; lapack;</div>
<div class="line"><a name="l01055"></a><span class="lineno"> 1055</span>&#160;  <span class="keywordtype">int</span> lwork = 3*n -1;</div>
<div class="line"><a name="l01056"></a><span class="lineno"> 1056</span>&#160;  <span class="keywordtype">int</span> info;</div>
<div class="line"><a name="l01057"></a><span class="lineno"> 1057</span>&#160;  <span class="keywordtype">char</span> UPLO = <span class="charliteral">&#39;L&#39;</span>;</div>
<div class="line"><a name="l01058"></a><span class="lineno"> 1058</span>&#160;  <span class="keywordtype">double</span> *W, *WORK;</div>
<div class="line"><a name="l01059"></a><span class="lineno"> 1059</span>&#160;</div>
<div class="line"><a name="l01060"></a><span class="lineno"> 1060</span>&#160;  W = <span class="keyword">new</span> <span class="keywordtype">double</span>[n];</div>
<div class="line"><a name="l01061"></a><span class="lineno"> 1061</span>&#160;  WORK = <span class="keyword">new</span> <span class="keywordtype">double</span>[lwork];</div>
<div class="line"><a name="l01062"></a><span class="lineno"> 1062</span>&#160;</div>
<div class="line"><a name="l01063"></a><span class="lineno"> 1063</span>&#160;  <span class="keywordflow">if</span> (eigenVectors == NULL) {</div>
<div class="line"><a name="l01064"></a><span class="lineno"> 1064</span>&#160;    <span class="keywordtype">char</span> JOBZ = <span class="charliteral">&#39;N&#39;</span>;<span class="comment">//eigenvalues only</span></div>
<div class="line"><a name="l01065"></a><span class="lineno"> 1065</span>&#160;</div>
<div class="line"><a name="l01066"></a><span class="lineno"> 1066</span>&#160;    lapack.SYEV(JOBZ, UPLO, copy_m_mat.numRows(), copy_m_mat.values(), copy_m_mat.stride(), &amp;W[0], &amp;WORK[0], lwork, &amp;info);</div>
<div class="line"><a name="l01067"></a><span class="lineno"> 1067</span>&#160;</div>
<div class="line"><a name="l01068"></a><span class="lineno"> 1068</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i=0; i&lt; n; i++)</div>
<div class="line"><a name="l01069"></a><span class="lineno"> 1069</span>&#160;      eigenValues[i] = W[i];</div>
<div class="line"><a name="l01070"></a><span class="lineno"> 1070</span>&#160;</div>
<div class="line"><a name="l01071"></a><span class="lineno"> 1071</span>&#160;    <a class="code" href="a00674.html#ace699c1e7716717f330c783a58ebcd4f">queso_require_equal_to_msg</a>(info, 0, <span class="stringliteral">&quot;invalid input vector size&quot;</span>);</div>
<div class="line"><a name="l01072"></a><span class="lineno"> 1072</span>&#160;  }</div>
<div class="line"><a name="l01073"></a><span class="lineno"> 1073</span>&#160;  <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l01074"></a><span class="lineno"> 1074</span>&#160;        <span class="keywordtype">char</span> JOBZ = <span class="charliteral">&#39;V&#39;</span>;<span class="comment">//eigenvalues and eigenvectors</span></div>
<div class="line"><a name="l01075"></a><span class="lineno"> 1075</span>&#160;</div>
<div class="line"><a name="l01076"></a><span class="lineno"> 1076</span>&#160;    lapack.SYEV(JOBZ, UPLO, copy_m_mat.numRows(), copy_m_mat.values(), copy_m_mat.stride(), &amp;W[0], &amp;WORK[0], lwork, &amp;info);</div>
<div class="line"><a name="l01077"></a><span class="lineno"> 1077</span>&#160;</div>
<div class="line"><a name="l01078"></a><span class="lineno"> 1078</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i=0; i&lt; n; i++)</div>
<div class="line"><a name="l01079"></a><span class="lineno"> 1079</span>&#160;        eigenValues[i] = W[i];</div>
<div class="line"><a name="l01080"></a><span class="lineno"> 1080</span>&#160;</div>
<div class="line"><a name="l01081"></a><span class="lineno"> 1081</span>&#160;        eigenVectors-&gt;<a class="code" href="a00227.html#a154931850614ec7597e9b134b7d9ffbb">m_mat</a> = copy_m_mat;</div>
<div class="line"><a name="l01082"></a><span class="lineno"> 1082</span>&#160;  }</div>
<div class="line"><a name="l01083"></a><span class="lineno"> 1083</span>&#160;</div>
<div class="line"><a name="l01084"></a><span class="lineno"> 1084</span>&#160;  <span class="keywordflow">if</span> (info != 0) {</div>
<div class="line"><a name="l01085"></a><span class="lineno"> 1085</span>&#160;    std::cerr &lt;&lt; <span class="stringliteral">&quot;In TeuchosMtrix::eigen()&quot;</span></div>
<div class="line"><a name="l01086"></a><span class="lineno"> 1086</span>&#160;              &lt;&lt; <span class="stringliteral">&quot;: INFO = &quot;</span> &lt;&lt; info</div>
<div class="line"><a name="l01087"></a><span class="lineno"> 1087</span>&#160;              &lt;&lt; <span class="stringliteral">&quot;,\n INFO &lt; 0:  if INFO = -i, the i-th argument had an illegal value.&quot;</span></div>
<div class="line"><a name="l01088"></a><span class="lineno"> 1088</span>&#160;              &lt;&lt; <span class="stringliteral">&quot;\n INFO &gt; 0:  if INFO = i, the algorithm failed to converge; i off-diagonal &quot;</span></div>
<div class="line"><a name="l01089"></a><span class="lineno"> 1089</span>&#160;                      &lt;&lt; <span class="stringliteral">&quot; elements of an intermediate tridiagonal form did not converge to zero.&quot;</span></div>
<div class="line"><a name="l01090"></a><span class="lineno"> 1090</span>&#160;              &lt;&lt; std::endl;</div>
<div class="line"><a name="l01091"></a><span class="lineno"> 1091</span>&#160;  }</div>
<div class="line"><a name="l01092"></a><span class="lineno"> 1092</span>&#160;</div>
<div class="line"><a name="l01093"></a><span class="lineno"> 1093</span>&#160;  <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l01094"></a><span class="lineno"> 1094</span>&#160;}</div>
<div class="line"><a name="l01095"></a><span class="lineno"> 1095</span>&#160;<span class="comment">// ---------------------------------------------------</span></div>
<div class="line"><a name="l01096"></a><span class="lineno"> 1096</span>&#160;<span class="keywordtype">void</span></div>
<div class="line"><a name="l01097"></a><span class="lineno"><a class="line" href="a00227.html#a471d2629d244a87d0c2a58552da0c76b"> 1097</a></span>&#160;<a class="code" href="a00227.html#a471d2629d244a87d0c2a58552da0c76b">TeuchosMatrix::largestEigen</a>(<span class="keywordtype">double</span>&amp; eigenValue, <a class="code" href="a00228.html">TeuchosVector</a>&amp; eigenVector)<span class="keyword"> const</span></div>
<div class="line"><a name="l01098"></a><span class="lineno"> 1098</span>&#160;<span class="keyword"></span>{</div>
<div class="line"><a name="l01099"></a><span class="lineno"> 1099</span>&#160;  <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> n = eigenVector.<a class="code" href="a00228.html#aa1d2726c42a9c317898e348fafca6998">sizeLocal</a>();</div>
<div class="line"><a name="l01100"></a><span class="lineno"> 1100</span>&#160;</div>
<div class="line"><a name="l01101"></a><span class="lineno"> 1101</span>&#160;  <a class="code" href="a00674.html#aae2cd8576f7d7d4de5543f13b8edc974">queso_require_not_equal_to_msg</a>(n, 0, <span class="stringliteral">&quot;invalid input vector size&quot;</span>);</div>
<div class="line"><a name="l01102"></a><span class="lineno"> 1102</span>&#160;  Teuchos::LAPACK&lt;int, double&gt; lapack;</div>
<div class="line"><a name="l01103"></a><span class="lineno"> 1103</span>&#160;</div>
<div class="line"><a name="l01104"></a><span class="lineno"> 1104</span>&#160;  <span class="comment">//SYEV destroys the input matrix, so lets operate in a copy</span></div>
<div class="line"><a name="l01105"></a><span class="lineno"> 1105</span>&#160;  Teuchos::SerialDenseMatrix&lt;int,double&gt; copy_m_mat;</div>
<div class="line"><a name="l01106"></a><span class="lineno"> 1106</span>&#160;  copy_m_mat = <a class="code" href="a00227.html#a154931850614ec7597e9b134b7d9ffbb">m_mat</a>;</div>
<div class="line"><a name="l01107"></a><span class="lineno"> 1107</span>&#160;</div>
<div class="line"><a name="l01108"></a><span class="lineno"> 1108</span>&#160;  <span class="keywordtype">int</span> lwork = 3*n -1;</div>
<div class="line"><a name="l01109"></a><span class="lineno"> 1109</span>&#160;  <span class="keywordtype">int</span> info;</div>
<div class="line"><a name="l01110"></a><span class="lineno"> 1110</span>&#160;  <span class="keywordtype">char</span> UPLO = <span class="charliteral">&#39;L&#39;</span>;</div>
<div class="line"><a name="l01111"></a><span class="lineno"> 1111</span>&#160;  <span class="keywordtype">char</span> JOBZ = <span class="charliteral">&#39;V&#39;</span>; <span class="comment">//eigenvalues and eigenvectors</span></div>
<div class="line"><a name="l01112"></a><span class="lineno"> 1112</span>&#160;  <span class="keywordtype">double</span> *W, *WORK;</div>
<div class="line"><a name="l01113"></a><span class="lineno"> 1113</span>&#160;</div>
<div class="line"><a name="l01114"></a><span class="lineno"> 1114</span>&#160;  W = <span class="keyword">new</span> <span class="keywordtype">double</span>[n];</div>
<div class="line"><a name="l01115"></a><span class="lineno"> 1115</span>&#160;  WORK = <span class="keyword">new</span> <span class="keywordtype">double</span>[lwork];</div>
<div class="line"><a name="l01116"></a><span class="lineno"> 1116</span>&#160;</div>
<div class="line"><a name="l01117"></a><span class="lineno"> 1117</span>&#160;  lapack.SYEV(JOBZ, UPLO, copy_m_mat.numRows(), copy_m_mat.values(), copy_m_mat.stride(), &amp;W[0], &amp;WORK[0], lwork, &amp;info);</div>
<div class="line"><a name="l01118"></a><span class="lineno"> 1118</span>&#160;</div>
<div class="line"><a name="l01119"></a><span class="lineno"> 1119</span>&#160;  <span class="keywordflow">if</span> (info != 0) {</div>
<div class="line"><a name="l01120"></a><span class="lineno"> 1120</span>&#160;    std::cerr &lt;&lt; <span class="stringliteral">&quot;In TeuchosMtrix::largestEigen()&quot;</span></div>
<div class="line"><a name="l01121"></a><span class="lineno"> 1121</span>&#160;              &lt;&lt; <span class="stringliteral">&quot;: INFO = &quot;</span> &lt;&lt; info</div>
<div class="line"><a name="l01122"></a><span class="lineno"> 1122</span>&#160;              &lt;&lt; <span class="stringliteral">&quot;,\n INFO &lt; 0:  if INFO = -i, the i-th argument had an illegal value.&quot;</span></div>
<div class="line"><a name="l01123"></a><span class="lineno"> 1123</span>&#160;              &lt;&lt; <span class="stringliteral">&quot;\n INFO &gt; 0:  if INFO = i, the algorithm failed to converge; i off-diagonal &quot;</span></div>
<div class="line"><a name="l01124"></a><span class="lineno"> 1124</span>&#160;                      &lt;&lt; <span class="stringliteral">&quot; elements of an intermediate tridiagonal form did not converge to zero.&quot;</span></div>
<div class="line"><a name="l01125"></a><span class="lineno"> 1125</span>&#160;              &lt;&lt; std::endl;</div>
<div class="line"><a name="l01126"></a><span class="lineno"> 1126</span>&#160;  }</div>
<div class="line"><a name="l01127"></a><span class="lineno"> 1127</span>&#160;  <span class="comment">// If INFO = 0, W contains the eigenvalues in ascending order.</span></div>
<div class="line"><a name="l01128"></a><span class="lineno"> 1128</span>&#160;  <span class="comment">// Thus the largest eigenvalue is in W[n-1].</span></div>
<div class="line"><a name="l01129"></a><span class="lineno"> 1129</span>&#160;  eigenValue = W[n-1];</div>
<div class="line"><a name="l01130"></a><span class="lineno"> 1130</span>&#160;</div>
<div class="line"><a name="l01131"></a><span class="lineno"> 1131</span>&#160;  <span class="comment">// Eigenvector associated to the largest eigenvalue.</span></div>
<div class="line"><a name="l01132"></a><span class="lineno"> 1132</span>&#160;  <span class="comment">// Stored in the n-th column of matrix copy_m_mat.</span></div>
<div class="line"><a name="l01133"></a><span class="lineno"> 1133</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt; copy_m_mat.numRows(); i++)</div>
<div class="line"><a name="l01134"></a><span class="lineno"> 1134</span>&#160;    eigenVector[i] = copy_m_mat(i,n-1);</div>
<div class="line"><a name="l01135"></a><span class="lineno"> 1135</span>&#160;</div>
<div class="line"><a name="l01136"></a><span class="lineno"> 1136</span>&#160;  <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l01137"></a><span class="lineno"> 1137</span>&#160;}</div>
<div class="line"><a name="l01138"></a><span class="lineno"> 1138</span>&#160;</div>
<div class="line"><a name="l01139"></a><span class="lineno"> 1139</span>&#160;<span class="comment">// ---------------------------------------------------</span></div>
<div class="line"><a name="l01140"></a><span class="lineno"> 1140</span>&#160;<span class="keywordtype">void</span></div>
<div class="line"><a name="l01141"></a><span class="lineno"><a class="line" href="a00227.html#ae049ec766677ae92dab499da444ad772"> 1141</a></span>&#160;<a class="code" href="a00227.html#ae049ec766677ae92dab499da444ad772">TeuchosMatrix::smallestEigen</a>(<span class="keywordtype">double</span>&amp; eigenValue, <a class="code" href="a00228.html">TeuchosVector</a>&amp; eigenVector)<span class="keyword"> const</span></div>
<div class="line"><a name="l01142"></a><span class="lineno"> 1142</span>&#160;<span class="keyword"></span>{</div>
<div class="line"><a name="l01143"></a><span class="lineno"> 1143</span>&#160;  <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> n = eigenVector.<a class="code" href="a00228.html#aa1d2726c42a9c317898e348fafca6998">sizeLocal</a>();</div>
<div class="line"><a name="l01144"></a><span class="lineno"> 1144</span>&#160;</div>
<div class="line"><a name="l01145"></a><span class="lineno"> 1145</span>&#160;  <a class="code" href="a00674.html#aae2cd8576f7d7d4de5543f13b8edc974">queso_require_not_equal_to_msg</a>(n, 0, <span class="stringliteral">&quot;invalid input vector size&quot;</span>);</div>
<div class="line"><a name="l01146"></a><span class="lineno"> 1146</span>&#160;  Teuchos::LAPACK&lt;int, double&gt; lapack;</div>
<div class="line"><a name="l01147"></a><span class="lineno"> 1147</span>&#160;</div>
<div class="line"><a name="l01148"></a><span class="lineno"> 1148</span>&#160;  <span class="comment">//SYEV destroys the input matrix, so lets operate in a copy</span></div>
<div class="line"><a name="l01149"></a><span class="lineno"> 1149</span>&#160;  Teuchos::SerialDenseMatrix&lt;int,double&gt; copy_m_mat;</div>
<div class="line"><a name="l01150"></a><span class="lineno"> 1150</span>&#160;  copy_m_mat = <a class="code" href="a00227.html#a154931850614ec7597e9b134b7d9ffbb">m_mat</a>;</div>
<div class="line"><a name="l01151"></a><span class="lineno"> 1151</span>&#160;</div>
<div class="line"><a name="l01152"></a><span class="lineno"> 1152</span>&#160;  <span class="keywordtype">int</span> lwork = 3*n -1;</div>
<div class="line"><a name="l01153"></a><span class="lineno"> 1153</span>&#160;  <span class="keywordtype">int</span> info;</div>
<div class="line"><a name="l01154"></a><span class="lineno"> 1154</span>&#160;  <span class="keywordtype">char</span> UPLO = <span class="charliteral">&#39;L&#39;</span>;</div>
<div class="line"><a name="l01155"></a><span class="lineno"> 1155</span>&#160;  <span class="keywordtype">char</span> JOBZ = <span class="charliteral">&#39;V&#39;</span>;<span class="comment">//eigenvalues and eigenvectors</span></div>
<div class="line"><a name="l01156"></a><span class="lineno"> 1156</span>&#160;  <span class="keywordtype">double</span> *W, *WORK;</div>
<div class="line"><a name="l01157"></a><span class="lineno"> 1157</span>&#160;</div>
<div class="line"><a name="l01158"></a><span class="lineno"> 1158</span>&#160;  W = <span class="keyword">new</span> <span class="keywordtype">double</span>[n];</div>
<div class="line"><a name="l01159"></a><span class="lineno"> 1159</span>&#160;  WORK = <span class="keyword">new</span> <span class="keywordtype">double</span>[lwork];</div>
<div class="line"><a name="l01160"></a><span class="lineno"> 1160</span>&#160;</div>
<div class="line"><a name="l01161"></a><span class="lineno"> 1161</span>&#160;  lapack.SYEV(JOBZ, UPLO, copy_m_mat.numRows(), copy_m_mat.values(), copy_m_mat.stride(), &amp;W[0], &amp;WORK[0], lwork, &amp;info);</div>
<div class="line"><a name="l01162"></a><span class="lineno"> 1162</span>&#160;</div>
<div class="line"><a name="l01163"></a><span class="lineno"> 1163</span>&#160;  <span class="keywordflow">if</span> (info != 0) {</div>
<div class="line"><a name="l01164"></a><span class="lineno"> 1164</span>&#160;    std::cerr &lt;&lt; <span class="stringliteral">&quot;In TeuchosMtrix::smallestEigen()&quot;</span></div>
<div class="line"><a name="l01165"></a><span class="lineno"> 1165</span>&#160;              &lt;&lt; <span class="stringliteral">&quot;: INFO = &quot;</span> &lt;&lt; info</div>
<div class="line"><a name="l01166"></a><span class="lineno"> 1166</span>&#160;              &lt;&lt; <span class="stringliteral">&quot;,\n INFO &lt; 0:  if INFO = -i, the i-th argument had an illegal value.&quot;</span></div>
<div class="line"><a name="l01167"></a><span class="lineno"> 1167</span>&#160;              &lt;&lt; <span class="stringliteral">&quot;\n INFO &gt; 0:  if INFO = i, the algorithm failed to converge; i off-diagonal &quot;</span></div>
<div class="line"><a name="l01168"></a><span class="lineno"> 1168</span>&#160;                      &lt;&lt; <span class="stringliteral">&quot; elements of an intermediate tridiagonal form did not converge to zero.&quot;</span></div>
<div class="line"><a name="l01169"></a><span class="lineno"> 1169</span>&#160;              &lt;&lt; std::endl;</div>
<div class="line"><a name="l01170"></a><span class="lineno"> 1170</span>&#160;  }</div>
<div class="line"><a name="l01171"></a><span class="lineno"> 1171</span>&#160;</div>
<div class="line"><a name="l01172"></a><span class="lineno"> 1172</span>&#160;  <span class="comment">// If INFO = 0, W contains the eigenvalues in ascending order.</span></div>
<div class="line"><a name="l01173"></a><span class="lineno"> 1173</span>&#160;  <span class="comment">// Thus the smallest eigenvalue is in W[0].</span></div>
<div class="line"><a name="l01174"></a><span class="lineno"> 1174</span>&#160;  eigenValue = W[0];</div>
<div class="line"><a name="l01175"></a><span class="lineno"> 1175</span>&#160;</div>
<div class="line"><a name="l01176"></a><span class="lineno"> 1176</span>&#160;  <span class="comment">// Eigenvector associated to the smallest eigenvalue.</span></div>
<div class="line"><a name="l01177"></a><span class="lineno"> 1177</span>&#160;  <span class="comment">// Stored in the n-th column of matrix copy_m_mat.</span></div>
<div class="line"><a name="l01178"></a><span class="lineno"> 1178</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt; copy_m_mat.numRows(); i++)</div>
<div class="line"><a name="l01179"></a><span class="lineno"> 1179</span>&#160;    eigenVector[i] = copy_m_mat(i,0);</div>
<div class="line"><a name="l01180"></a><span class="lineno"> 1180</span>&#160;</div>
<div class="line"><a name="l01181"></a><span class="lineno"> 1181</span>&#160;  <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l01182"></a><span class="lineno"> 1182</span>&#160;}</div>
<div class="line"><a name="l01183"></a><span class="lineno"> 1183</span>&#160;</div>
<div class="line"><a name="l01184"></a><span class="lineno"> 1184</span>&#160;<span class="comment">// Get/Set methodos ----------------------------------</span></div>
<div class="line"><a name="l01185"></a><span class="lineno"> 1185</span>&#160;<span class="comment">// ---------------------------------------------------</span></div>
<div class="line"><a name="l01186"></a><span class="lineno"> 1186</span>&#160;</div>
<div class="line"><a name="l01187"></a><span class="lineno"> 1187</span>&#160;<span class="comment">// ---------------------------------------------------</span></div>
<div class="line"><a name="l01188"></a><span class="lineno"> 1188</span>&#160;<span class="keywordtype">void</span></div>
<div class="line"><a name="l01189"></a><span class="lineno"><a class="line" href="a00227.html#af951a778007acf7992d8504bf29c8a89"> 1189</a></span>&#160;<a class="code" href="a00227.html#af951a778007acf7992d8504bf29c8a89">TeuchosMatrix::cwSet</a>(<span class="keywordtype">double</span> value)</div>
<div class="line"><a name="l01190"></a><span class="lineno"> 1190</span>&#160;{</div>
<div class="line"><a name="l01191"></a><span class="lineno"> 1191</span>&#160;  <a class="code" href="a00227.html#a154931850614ec7597e9b134b7d9ffbb">m_mat</a>.putScalar(value);</div>
<div class="line"><a name="l01192"></a><span class="lineno"> 1192</span>&#160;  <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l01193"></a><span class="lineno"> 1193</span>&#160;}</div>
<div class="line"><a name="l01194"></a><span class="lineno"> 1194</span>&#160;</div>
<div class="line"><a name="l01195"></a><span class="lineno"> 1195</span>&#160;<span class="comment">// ---------------------------------------------------</span></div>
<div class="line"><a name="l01196"></a><span class="lineno"> 1196</span>&#160;<span class="comment">// tested on 1/31/13: copies matrix mat to this matrix, starting at row rowId and column colId</span></div>
<div class="line"><a name="l01197"></a><span class="lineno"> 1197</span>&#160;<span class="keywordtype">void</span></div>
<div class="line"><a name="l01198"></a><span class="lineno"><a class="line" href="a00227.html#ab092925da27907b209512cf9185cb544"> 1198</a></span>&#160;<a class="code" href="a00227.html#af951a778007acf7992d8504bf29c8a89">TeuchosMatrix::cwSet</a>(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> rowId,<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> colId,<span class="keyword">const</span> <a class="code" href="a00227.html">TeuchosMatrix</a>&amp; mat)</div>
<div class="line"><a name="l01199"></a><span class="lineno"> 1199</span>&#160;{</div>
<div class="line"><a name="l01200"></a><span class="lineno"> 1200</span>&#160;  queso_require_less_msg(rowId, this-&gt;<a class="code" href="a00227.html#a78a5b262967d31e6171aadd292e77395">numRowsLocal</a>(), <span class="stringliteral">&quot;invalid rowId&quot;</span>);</div>
<div class="line"><a name="l01201"></a><span class="lineno"> 1201</span>&#160;</div>
<div class="line"><a name="l01202"></a><span class="lineno"> 1202</span>&#160;  queso_require_less_equal_msg((rowId + mat.<a class="code" href="a00227.html#a78a5b262967d31e6171aadd292e77395">numRowsLocal</a>()), this-&gt;<a class="code" href="a00227.html#a78a5b262967d31e6171aadd292e77395">numRowsLocal</a>(), <span class="stringliteral">&quot;invalid vec.numRowsLocal()&quot;</span>);</div>
<div class="line"><a name="l01203"></a><span class="lineno"> 1203</span>&#160;</div>
<div class="line"><a name="l01204"></a><span class="lineno"> 1204</span>&#160;  queso_require_less_msg(colId, this-&gt;<a class="code" href="a00227.html#a6e3aa20d8c618718a9fa9cc56ff65b9f">numCols</a>(), <span class="stringliteral">&quot;invalid colId&quot;</span>);</div>
<div class="line"><a name="l01205"></a><span class="lineno"> 1205</span>&#160;</div>
<div class="line"><a name="l01206"></a><span class="lineno"> 1206</span>&#160;  queso_require_less_equal_msg((colId + mat.<a class="code" href="a00227.html#a6e3aa20d8c618718a9fa9cc56ff65b9f">numCols</a>()), this-&gt;<a class="code" href="a00227.html#a6e3aa20d8c618718a9fa9cc56ff65b9f">numCols</a>(), <span class="stringliteral">&quot;invalid vec.numCols()&quot;</span>);</div>
<div class="line"><a name="l01207"></a><span class="lineno"> 1207</span>&#160;</div>
<div class="line"><a name="l01208"></a><span class="lineno"> 1208</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = 0; i &lt; mat.<a class="code" href="a00227.html#a78a5b262967d31e6171aadd292e77395">numRowsLocal</a>(); ++i) {</div>
<div class="line"><a name="l01209"></a><span class="lineno"> 1209</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> j = 0; j &lt; mat.<a class="code" href="a00227.html#a6e3aa20d8c618718a9fa9cc56ff65b9f">numCols</a>(); ++j) {</div>
<div class="line"><a name="l01210"></a><span class="lineno"> 1210</span>&#160;      (*this)(rowId+i,colId+j) = mat(i,j);</div>
<div class="line"><a name="l01211"></a><span class="lineno"> 1211</span>&#160;    }</div>
<div class="line"><a name="l01212"></a><span class="lineno"> 1212</span>&#160;  }</div>
<div class="line"><a name="l01213"></a><span class="lineno"> 1213</span>&#160;</div>
<div class="line"><a name="l01214"></a><span class="lineno"> 1214</span>&#160;  <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l01215"></a><span class="lineno"> 1215</span>&#160;}</div>
<div class="line"><a name="l01216"></a><span class="lineno"> 1216</span>&#160;</div>
<div class="line"><a name="l01217"></a><span class="lineno"> 1217</span>&#160;<span class="comment">// ---------------------------------------------------</span></div>
<div class="line"><a name="l01218"></a><span class="lineno"> 1218</span>&#160;<span class="comment">//Kemelli tested 07/12/12</span></div>
<div class="line"><a name="l01219"></a><span class="lineno"> 1219</span>&#160;<span class="keywordtype">void</span></div>
<div class="line"><a name="l01220"></a><span class="lineno"><a class="line" href="a00227.html#ae66a7551b49a7e33a407972c3da2763c"> 1220</a></span>&#160;<a class="code" href="a00227.html#ae66a7551b49a7e33a407972c3da2763c">TeuchosMatrix::getColumn</a>(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> column_num, <a class="code" href="a00228.html">TeuchosVector</a>&amp; column)<span class="keyword"> const</span></div>
<div class="line"><a name="l01221"></a><span class="lineno"> 1221</span>&#160;<span class="keyword"></span>{</div>
<div class="line"><a name="l01222"></a><span class="lineno"> 1222</span>&#160;  <span class="comment">// Sanity checks</span></div>
<div class="line"><a name="l01223"></a><span class="lineno"> 1223</span>&#160;  queso_require_less_msg(column_num, this-&gt;<a class="code" href="a00227.html#a6e3aa20d8c618718a9fa9cc56ff65b9f">numCols</a>(), <span class="stringliteral">&quot;Specified row number not within range&quot;</span>);</div>
<div class="line"><a name="l01224"></a><span class="lineno"> 1224</span>&#160;</div>
<div class="line"><a name="l01225"></a><span class="lineno"> 1225</span>&#160;  <a class="code" href="a00674.html#ace699c1e7716717f330c783a58ebcd4f">queso_require_equal_to_msg</a>(column.<a class="code" href="a00228.html#aa1d2726c42a9c317898e348fafca6998">sizeLocal</a>(), this-&gt;<a class="code" href="a00227.html#a78a5b262967d31e6171aadd292e77395">numRowsLocal</a>(), <span class="stringliteral">&quot;column vector not same size as this matrix&quot;</span>);</div>
<div class="line"><a name="l01226"></a><span class="lineno"> 1226</span>&#160;</div>
<div class="line"><a name="l01227"></a><span class="lineno"> 1227</span>&#160;  <span class="comment">// Temporary working pointer</span></div>
<div class="line"><a name="l01228"></a><span class="lineno"> 1228</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">double</span>* temp_ptr ;</div>
<div class="line"><a name="l01229"></a><span class="lineno"> 1229</span>&#160;</div>
<div class="line"><a name="l01230"></a><span class="lineno"> 1230</span>&#160;  <span class="comment">// get the column_num- of matrix m_mat</span></div>
<div class="line"><a name="l01231"></a><span class="lineno"> 1231</span>&#160;  temp_ptr = <a class="code" href="a00227.html#a154931850614ec7597e9b134b7d9ffbb">m_mat</a>[column_num];</div>
<div class="line"><a name="l01232"></a><span class="lineno"> 1232</span>&#160;</div>
<div class="line"><a name="l01233"></a><span class="lineno"> 1233</span>&#160;  <span class="comment">// Copy column from Teuchos matrix into our TeuchosVector object</span></div>
<div class="line"><a name="l01234"></a><span class="lineno"> 1234</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i=0; i&lt; column.<a class="code" href="a00228.html#aa1d2726c42a9c317898e348fafca6998">sizeLocal</a>();i++)</div>
<div class="line"><a name="l01235"></a><span class="lineno"> 1235</span>&#160;    column[i] = temp_ptr[i];</div>
<div class="line"><a name="l01236"></a><span class="lineno"> 1236</span>&#160;</div>
<div class="line"><a name="l01237"></a><span class="lineno"> 1237</span>&#160;  <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l01238"></a><span class="lineno"> 1238</span>&#160;}</div>
<div class="line"><a name="l01239"></a><span class="lineno"> 1239</span>&#160;</div>
<div class="line"><a name="l01240"></a><span class="lineno"> 1240</span>&#160;<span class="comment">// ---------------------------------------------------</span></div>
<div class="line"><a name="l01241"></a><span class="lineno"> 1241</span>&#160;<a class="code" href="a00228.html">TeuchosVector</a></div>
<div class="line"><a name="l01242"></a><span class="lineno"><a class="line" href="a00227.html#af0d0cda12cb90904934760ba0c037981"> 1242</a></span>&#160;<a class="code" href="a00227.html#ae66a7551b49a7e33a407972c3da2763c">TeuchosMatrix::getColumn</a>(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> column_num )<span class="keyword"> const</span></div>
<div class="line"><a name="l01243"></a><span class="lineno"> 1243</span>&#160;<span class="keyword"></span>{</div>
<div class="line"><a name="l01244"></a><span class="lineno"> 1244</span>&#160;  <span class="comment">// We rely on the void getColumn&#39;s to do sanity checks</span></div>
<div class="line"><a name="l01245"></a><span class="lineno"> 1245</span>&#160;  <span class="comment">// So we don&#39;t do them here.</span></div>
<div class="line"><a name="l01246"></a><span class="lineno"> 1246</span>&#160;  <a class="code" href="a00228.html">TeuchosVector</a> column(<a class="code" href="a00164.html#a247fb0fc0b87fecdee054bb4660b68e8">m_env</a>, <a class="code" href="a00164.html#a95e307c6e1263d505af0a43c35f81a8b">m_map</a>);</div>
<div class="line"><a name="l01247"></a><span class="lineno"> 1247</span>&#160;  this-&gt;<a class="code" href="a00227.html#ae66a7551b49a7e33a407972c3da2763c">getColumn</a>( column_num, column );</div>
<div class="line"><a name="l01248"></a><span class="lineno"> 1248</span>&#160;  <span class="keywordflow">return</span> column;</div>
<div class="line"><a name="l01249"></a><span class="lineno"> 1249</span>&#160;}</div>
<div class="line"><a name="l01250"></a><span class="lineno"> 1250</span>&#160;</div>
<div class="line"><a name="l01251"></a><span class="lineno"> 1251</span>&#160;</div>
<div class="line"><a name="l01252"></a><span class="lineno"> 1252</span>&#160;<span class="comment">// ---------------------------------------------------</span></div>
<div class="line"><a name="l01253"></a><span class="lineno"> 1253</span>&#160;<span class="comment">//Kemelli tested 07/12/12</span></div>
<div class="line"><a name="l01254"></a><span class="lineno"> 1254</span>&#160;<span class="keywordtype">void</span></div>
<div class="line"><a name="l01255"></a><span class="lineno"><a class="line" href="a00227.html#a5855b579a855166171ccdd72c55e5d0d"> 1255</a></span>&#160;<a class="code" href="a00227.html#a5855b579a855166171ccdd72c55e5d0d">TeuchosMatrix::setColumn</a>(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> column_num, <span class="keyword">const</span> <a class="code" href="a00228.html">TeuchosVector</a>&amp; column)</div>
<div class="line"><a name="l01256"></a><span class="lineno"> 1256</span>&#160;{</div>
<div class="line"><a name="l01257"></a><span class="lineno"> 1257</span>&#160;  this-&gt;<a class="code" href="a00227.html#ad2739933c700c0abb7d27aa094f49630">resetLU</a>();</div>
<div class="line"><a name="l01258"></a><span class="lineno"> 1258</span>&#160;  <span class="comment">// Sanity checks</span></div>
<div class="line"><a name="l01259"></a><span class="lineno"> 1259</span>&#160;  queso_require_less_msg(column_num, this-&gt;<a class="code" href="a00227.html#a6e3aa20d8c618718a9fa9cc56ff65b9f">numCols</a>(), <span class="stringliteral">&quot;Specified column number not within range&quot;</span>);</div>
<div class="line"><a name="l01260"></a><span class="lineno"> 1260</span>&#160;</div>
<div class="line"><a name="l01261"></a><span class="lineno"> 1261</span>&#160;  <a class="code" href="a00674.html#ace699c1e7716717f330c783a58ebcd4f">queso_require_equal_to_msg</a>(column.<a class="code" href="a00228.html#aa1d2726c42a9c317898e348fafca6998">sizeLocal</a>(), this-&gt;<a class="code" href="a00227.html#a78a5b262967d31e6171aadd292e77395">numRowsLocal</a>(), <span class="stringliteral">&quot;column vector not same size as this matrix&quot;</span>);</div>
<div class="line"><a name="l01262"></a><span class="lineno"> 1262</span>&#160;</div>
<div class="line"><a name="l01263"></a><span class="lineno"> 1263</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i =0; i &lt; column.<a class="code" href="a00228.html#aa1d2726c42a9c317898e348fafca6998">sizeLocal</a>(); i++)</div>
<div class="line"><a name="l01264"></a><span class="lineno"> 1264</span>&#160;    <a class="code" href="a00227.html#a154931850614ec7597e9b134b7d9ffbb">m_mat</a>(i,column_num) = column[i];</div>
<div class="line"><a name="l01265"></a><span class="lineno"> 1265</span>&#160;</div>
<div class="line"><a name="l01266"></a><span class="lineno"> 1266</span>&#160;  <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l01267"></a><span class="lineno"> 1267</span>&#160;}</div>
<div class="line"><a name="l01268"></a><span class="lineno"> 1268</span>&#160;</div>
<div class="line"><a name="l01269"></a><span class="lineno"> 1269</span>&#160;<span class="comment">// ---------------------------------------------------</span></div>
<div class="line"><a name="l01270"></a><span class="lineno"> 1270</span>&#160;<span class="comment">// tested 1/31/13</span></div>
<div class="line"><a name="l01271"></a><span class="lineno"> 1271</span>&#160;<span class="keywordtype">void</span></div>
<div class="line"><a name="l01272"></a><span class="lineno"><a class="line" href="a00227.html#a898ab9b09abd36a4f8632d5c0acf8f53"> 1272</a></span>&#160;<a class="code" href="a00227.html#a898ab9b09abd36a4f8632d5c0acf8f53">TeuchosMatrix::getRow</a>(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> row_num, <a class="code" href="a00228.html">TeuchosVector</a>&amp; row)<span class="keyword"> const</span></div>
<div class="line"><a name="l01273"></a><span class="lineno"> 1273</span>&#160;<span class="keyword"></span>{</div>
<div class="line"><a name="l01274"></a><span class="lineno"> 1274</span>&#160;  <span class="comment">// Sanity checks</span></div>
<div class="line"><a name="l01275"></a><span class="lineno"> 1275</span>&#160;  queso_require_less_msg(row_num, this-&gt;<a class="code" href="a00227.html#a78a5b262967d31e6171aadd292e77395">numRowsLocal</a>(), <span class="stringliteral">&quot;Specified row number not within range&quot;</span>);</div>
<div class="line"><a name="l01276"></a><span class="lineno"> 1276</span>&#160;</div>
<div class="line"><a name="l01277"></a><span class="lineno"> 1277</span>&#160;  <a class="code" href="a00674.html#ace699c1e7716717f330c783a58ebcd4f">queso_require_equal_to_msg</a>(row.<a class="code" href="a00228.html#aa1d2726c42a9c317898e348fafca6998">sizeLocal</a>(), this-&gt;<a class="code" href="a00227.html#a78a5b262967d31e6171aadd292e77395">numRowsLocal</a>(), <span class="stringliteral">&quot;row vector not same size as this matrix&quot;</span>);</div>
<div class="line"><a name="l01278"></a><span class="lineno"> 1278</span>&#160;</div>
<div class="line"><a name="l01279"></a><span class="lineno"> 1279</span>&#160;  <span class="comment">// Copy row from Teuchos matrix into our TeuchosVector object</span></div>
<div class="line"><a name="l01280"></a><span class="lineno"> 1280</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i=0; i&lt; row.<a class="code" href="a00228.html#aa1d2726c42a9c317898e348fafca6998">sizeLocal</a>();i++)</div>
<div class="line"><a name="l01281"></a><span class="lineno"> 1281</span>&#160;    row[i] = <a class="code" href="a00227.html#a154931850614ec7597e9b134b7d9ffbb">m_mat</a>(row_num,i);</div>
<div class="line"><a name="l01282"></a><span class="lineno"> 1282</span>&#160;</div>
<div class="line"><a name="l01283"></a><span class="lineno"> 1283</span>&#160;  <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l01284"></a><span class="lineno"> 1284</span>&#160;}</div>
<div class="line"><a name="l01285"></a><span class="lineno"> 1285</span>&#160;</div>
<div class="line"><a name="l01286"></a><span class="lineno"> 1286</span>&#160;<span class="comment">// ---------------------------------------------------</span></div>
<div class="line"><a name="l01287"></a><span class="lineno"> 1287</span>&#160;<span class="comment">// tested 1/31/13</span></div>
<div class="line"><a name="l01288"></a><span class="lineno"> 1288</span>&#160;<a class="code" href="a00228.html">TeuchosVector</a></div>
<div class="line"><a name="l01289"></a><span class="lineno"><a class="line" href="a00227.html#a83911a34db5f920127941aee4f6984c3"> 1289</a></span>&#160;<a class="code" href="a00227.html#a898ab9b09abd36a4f8632d5c0acf8f53">TeuchosMatrix::getRow</a>(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> row_num )<span class="keyword"> const</span></div>
<div class="line"><a name="l01290"></a><span class="lineno"> 1290</span>&#160;<span class="keyword"></span>{</div>
<div class="line"><a name="l01291"></a><span class="lineno"> 1291</span>&#160;  <span class="comment">// We rely on the void getRow&#39;s to do sanity checks</span></div>
<div class="line"><a name="l01292"></a><span class="lineno"> 1292</span>&#160;  <span class="comment">// So we don&#39;t do them here.</span></div>
<div class="line"><a name="l01293"></a><span class="lineno"> 1293</span>&#160;  <a class="code" href="a00228.html">TeuchosVector</a> row(<a class="code" href="a00164.html#a247fb0fc0b87fecdee054bb4660b68e8">m_env</a>, <a class="code" href="a00164.html#a95e307c6e1263d505af0a43c35f81a8b">m_map</a>);</div>
<div class="line"><a name="l01294"></a><span class="lineno"> 1294</span>&#160;  this-&gt;<a class="code" href="a00227.html#a898ab9b09abd36a4f8632d5c0acf8f53">getRow</a>( row_num, row );</div>
<div class="line"><a name="l01295"></a><span class="lineno"> 1295</span>&#160;  <span class="keywordflow">return</span> row;</div>
<div class="line"><a name="l01296"></a><span class="lineno"> 1296</span>&#160;}</div>
<div class="line"><a name="l01297"></a><span class="lineno"> 1297</span>&#160;</div>
<div class="line"><a name="l01298"></a><span class="lineno"> 1298</span>&#160;<span class="comment">// ---------------------------------------------------</span></div>
<div class="line"><a name="l01299"></a><span class="lineno"> 1299</span>&#160;<span class="comment">// tested 1/31/13</span></div>
<div class="line"><a name="l01300"></a><span class="lineno"> 1300</span>&#160;<span class="keywordtype">void</span></div>
<div class="line"><a name="l01301"></a><span class="lineno"><a class="line" href="a00227.html#a8a6b19a4f686072a2b5416febef920d8"> 1301</a></span>&#160;<a class="code" href="a00227.html#a8a6b19a4f686072a2b5416febef920d8">TeuchosMatrix::setRow</a> (<span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> row_num, <span class="keyword">const</span> <a class="code" href="a00228.html">TeuchosVector</a>&amp; row)</div>
<div class="line"><a name="l01302"></a><span class="lineno"> 1302</span>&#160;{</div>
<div class="line"><a name="l01303"></a><span class="lineno"> 1303</span>&#160;  <span class="comment">// Sanity checks</span></div>
<div class="line"><a name="l01304"></a><span class="lineno"> 1304</span>&#160;  queso_require_less_msg(row_num, this-&gt;<a class="code" href="a00227.html#a78a5b262967d31e6171aadd292e77395">numRowsLocal</a>(), <span class="stringliteral">&quot;Specified row number not within range&quot;</span>);</div>
<div class="line"><a name="l01305"></a><span class="lineno"> 1305</span>&#160;</div>
<div class="line"><a name="l01306"></a><span class="lineno"> 1306</span>&#160;  <a class="code" href="a00674.html#ace699c1e7716717f330c783a58ebcd4f">queso_require_equal_to_msg</a>(row.<a class="code" href="a00228.html#aa1d2726c42a9c317898e348fafca6998">sizeLocal</a>(), this-&gt;<a class="code" href="a00227.html#a78a5b262967d31e6171aadd292e77395">numRowsLocal</a>(), <span class="stringliteral">&quot;row vector not same size as this matrix&quot;</span>);</div>
<div class="line"><a name="l01307"></a><span class="lineno"> 1307</span>&#160;</div>
<div class="line"><a name="l01308"></a><span class="lineno"> 1308</span>&#160;  <span class="comment">// Copy our TeuchosVector object to our Teuchos Matrix</span></div>
<div class="line"><a name="l01309"></a><span class="lineno"> 1309</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i=0; i&lt; row.<a class="code" href="a00228.html#aa1d2726c42a9c317898e348fafca6998">sizeLocal</a>();i++)</div>
<div class="line"><a name="l01310"></a><span class="lineno"> 1310</span>&#160;     <a class="code" href="a00227.html#a154931850614ec7597e9b134b7d9ffbb">m_mat</a>(row_num,i) = row[i] ;</div>
<div class="line"><a name="l01311"></a><span class="lineno"> 1311</span>&#160;</div>
<div class="line"><a name="l01312"></a><span class="lineno"> 1312</span>&#160;  <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l01313"></a><span class="lineno"> 1313</span>&#160;}</div>
<div class="line"><a name="l01314"></a><span class="lineno"> 1314</span>&#160;</div>
<div class="line"><a name="l01315"></a><span class="lineno"> 1315</span>&#160;<span class="comment">// ---------------------------------------------------</span></div>
<div class="line"><a name="l01316"></a><span class="lineno"> 1316</span>&#160;<span class="comment">// Kemelli 12/05/12 - tested</span></div>
<div class="line"><a name="l01317"></a><span class="lineno"> 1317</span>&#160;<span class="keywordtype">void</span></div>
<div class="line"><a name="l01318"></a><span class="lineno"><a class="line" href="a00227.html#ab7c5e29da5ac4d1e82015cf91171d4c0"> 1318</a></span>&#160;<a class="code" href="a00227.html#ab7c5e29da5ac4d1e82015cf91171d4c0">TeuchosMatrix::zeroLower</a>(<span class="keywordtype">bool</span> includeDiagonal)</div>
<div class="line"><a name="l01319"></a><span class="lineno"> 1319</span>&#160;{</div>
<div class="line"><a name="l01320"></a><span class="lineno"> 1320</span>&#160;  <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> nRows = this-&gt;<a class="code" href="a00227.html#a78a5b262967d31e6171aadd292e77395">numRowsLocal</a>();</div>
<div class="line"><a name="l01321"></a><span class="lineno"> 1321</span>&#160;  <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> nCols = this-&gt;<a class="code" href="a00227.html#a6e3aa20d8c618718a9fa9cc56ff65b9f">numCols</a>();</div>
<div class="line"><a name="l01322"></a><span class="lineno"> 1322</span>&#160;</div>
<div class="line"><a name="l01323"></a><span class="lineno"> 1323</span>&#160;  <a class="code" href="a00674.html#ace699c1e7716717f330c783a58ebcd4f">queso_require_equal_to_msg</a>(nRows, nCols, <span class="stringliteral">&quot;routine works only for square matrices&quot;</span>);</div>
<div class="line"><a name="l01324"></a><span class="lineno"> 1324</span>&#160;  this-&gt;<a class="code" href="a00227.html#ad2739933c700c0abb7d27aa094f49630">resetLU</a>();</div>
<div class="line"><a name="l01325"></a><span class="lineno"> 1325</span>&#160;</div>
<div class="line"><a name="l01326"></a><span class="lineno"> 1326</span>&#160;  <span class="keywordflow">if</span> (includeDiagonal) {</div>
<div class="line"><a name="l01327"></a><span class="lineno"> 1327</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = 0; i &lt; nRows; i++) {</div>
<div class="line"><a name="l01328"></a><span class="lineno"> 1328</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> j = 0; j &lt;= i; j++) {</div>
<div class="line"><a name="l01329"></a><span class="lineno"> 1329</span>&#160;        (*this)(i,j) = 0.;</div>
<div class="line"><a name="l01330"></a><span class="lineno"> 1330</span>&#160;      }</div>
<div class="line"><a name="l01331"></a><span class="lineno"> 1331</span>&#160;    }</div>
<div class="line"><a name="l01332"></a><span class="lineno"> 1332</span>&#160;  }</div>
<div class="line"><a name="l01333"></a><span class="lineno"> 1333</span>&#160;  <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l01334"></a><span class="lineno"> 1334</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = 0; i &lt; nRows; i++) {</div>
<div class="line"><a name="l01335"></a><span class="lineno"> 1335</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> j = 0; j &lt; i; j++) {</div>
<div class="line"><a name="l01336"></a><span class="lineno"> 1336</span>&#160;        (*this)(i,j) = 0.;</div>
<div class="line"><a name="l01337"></a><span class="lineno"> 1337</span>&#160;      }</div>
<div class="line"><a name="l01338"></a><span class="lineno"> 1338</span>&#160;    }</div>
<div class="line"><a name="l01339"></a><span class="lineno"> 1339</span>&#160;  }</div>
<div class="line"><a name="l01340"></a><span class="lineno"> 1340</span>&#160;</div>
<div class="line"><a name="l01341"></a><span class="lineno"> 1341</span>&#160;  <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l01342"></a><span class="lineno"> 1342</span>&#160;}</div>
<div class="line"><a name="l01343"></a><span class="lineno"> 1343</span>&#160;</div>
<div class="line"><a name="l01344"></a><span class="lineno"> 1344</span>&#160;<span class="comment">// ---------------------------------------------------</span></div>
<div class="line"><a name="l01345"></a><span class="lineno"> 1345</span>&#160;<span class="comment">// Kemelli 12/05/12 - tested</span></div>
<div class="line"><a name="l01346"></a><span class="lineno"> 1346</span>&#160;<span class="keywordtype">void</span></div>
<div class="line"><a name="l01347"></a><span class="lineno"><a class="line" href="a00227.html#ad4ebc8fd7d602eaa7178819d92e86556"> 1347</a></span>&#160;<a class="code" href="a00227.html#ad4ebc8fd7d602eaa7178819d92e86556">TeuchosMatrix::zeroUpper</a>(<span class="keywordtype">bool</span> includeDiagonal)</div>
<div class="line"><a name="l01348"></a><span class="lineno"> 1348</span>&#160;{</div>
<div class="line"><a name="l01349"></a><span class="lineno"> 1349</span>&#160;  <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> nRows = this-&gt;<a class="code" href="a00227.html#a78a5b262967d31e6171aadd292e77395">numRowsLocal</a>();</div>
<div class="line"><a name="l01350"></a><span class="lineno"> 1350</span>&#160;  <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> nCols = this-&gt;<a class="code" href="a00227.html#a6e3aa20d8c618718a9fa9cc56ff65b9f">numCols</a>();</div>
<div class="line"><a name="l01351"></a><span class="lineno"> 1351</span>&#160;</div>
<div class="line"><a name="l01352"></a><span class="lineno"> 1352</span>&#160;  <a class="code" href="a00674.html#ace699c1e7716717f330c783a58ebcd4f">queso_require_equal_to_msg</a>(nRows, nCols, <span class="stringliteral">&quot;routine works only for square matrices&quot;</span>);</div>
<div class="line"><a name="l01353"></a><span class="lineno"> 1353</span>&#160;  this-&gt;<a class="code" href="a00227.html#ad2739933c700c0abb7d27aa094f49630">resetLU</a>();</div>
<div class="line"><a name="l01354"></a><span class="lineno"> 1354</span>&#160;</div>
<div class="line"><a name="l01355"></a><span class="lineno"> 1355</span>&#160;  <span class="keywordflow">if</span> (includeDiagonal) {</div>
<div class="line"><a name="l01356"></a><span class="lineno"> 1356</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = 0; i &lt; nRows; i++) {</div>
<div class="line"><a name="l01357"></a><span class="lineno"> 1357</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> j = i; j &lt; nCols; j++) {</div>
<div class="line"><a name="l01358"></a><span class="lineno"> 1358</span>&#160;        (*this)(i,j) = 0.;</div>
<div class="line"><a name="l01359"></a><span class="lineno"> 1359</span>&#160;      }</div>
<div class="line"><a name="l01360"></a><span class="lineno"> 1360</span>&#160;    }</div>
<div class="line"><a name="l01361"></a><span class="lineno"> 1361</span>&#160;  }</div>
<div class="line"><a name="l01362"></a><span class="lineno"> 1362</span>&#160;  <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l01363"></a><span class="lineno"> 1363</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = 0; i &lt; nRows; i++) {</div>
<div class="line"><a name="l01364"></a><span class="lineno"> 1364</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> j = (i+1); j &lt; nCols; j++) {</div>
<div class="line"><a name="l01365"></a><span class="lineno"> 1365</span>&#160;        (*this)(i,j) = 0.;</div>
<div class="line"><a name="l01366"></a><span class="lineno"> 1366</span>&#160;      }</div>
<div class="line"><a name="l01367"></a><span class="lineno"> 1367</span>&#160;    }</div>
<div class="line"><a name="l01368"></a><span class="lineno"> 1368</span>&#160;  }</div>
<div class="line"><a name="l01369"></a><span class="lineno"> 1369</span>&#160;</div>
<div class="line"><a name="l01370"></a><span class="lineno"> 1370</span>&#160;  <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l01371"></a><span class="lineno"> 1371</span>&#160;}</div>
<div class="line"><a name="l01372"></a><span class="lineno"> 1372</span>&#160;</div>
<div class="line"><a name="l01373"></a><span class="lineno"> 1373</span>&#160;<span class="comment">// ---------------------------------------------------</span></div>
<div class="line"><a name="l01374"></a><span class="lineno"> 1374</span>&#160;<span class="keywordtype">void</span></div>
<div class="line"><a name="l01375"></a><span class="lineno"><a class="line" href="a00227.html#a35c6b451ba8daeb0a08046b5dad4ecfc"> 1375</a></span>&#160;<a class="code" href="a00227.html#a35c6b451ba8daeb0a08046b5dad4ecfc">TeuchosMatrix::filterSmallValues</a>(<span class="keywordtype">double</span> thresholdValue)</div>
<div class="line"><a name="l01376"></a><span class="lineno"> 1376</span>&#160;{</div>
<div class="line"><a name="l01377"></a><span class="lineno"> 1377</span>&#160;  <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> nRows = this-&gt;<a class="code" href="a00227.html#a78a5b262967d31e6171aadd292e77395">numRowsLocal</a>();</div>
<div class="line"><a name="l01378"></a><span class="lineno"> 1378</span>&#160;  <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> nCols = this-&gt;<a class="code" href="a00227.html#a6e3aa20d8c618718a9fa9cc56ff65b9f">numCols</a>();</div>
<div class="line"><a name="l01379"></a><span class="lineno"> 1379</span>&#160;</div>
<div class="line"><a name="l01380"></a><span class="lineno"> 1380</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = 0; i &lt; nRows; ++i) {</div>
<div class="line"><a name="l01381"></a><span class="lineno"> 1381</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> j = 0; j &lt; nCols; ++j) {</div>
<div class="line"><a name="l01382"></a><span class="lineno"> 1382</span>&#160;      <span class="keywordtype">double</span> aux = (*this)(i,j);</div>
<div class="line"><a name="l01383"></a><span class="lineno"> 1383</span>&#160;      <span class="comment">// If &#39;thresholdValue&#39; is negative, no values will be filtered</span></div>
<div class="line"><a name="l01384"></a><span class="lineno"> 1384</span>&#160;      <span class="keywordflow">if</span> ((aux &lt; 0. ) &amp;&amp; (-thresholdValue &lt; aux)) {</div>
<div class="line"><a name="l01385"></a><span class="lineno"> 1385</span>&#160;        (*this)(i,j) = 0.;</div>
<div class="line"><a name="l01386"></a><span class="lineno"> 1386</span>&#160;      }</div>
<div class="line"><a name="l01387"></a><span class="lineno"> 1387</span>&#160;      <span class="keywordflow">if</span> ((aux &gt; 0. ) &amp;&amp; (thresholdValue &gt; aux)) {</div>
<div class="line"><a name="l01388"></a><span class="lineno"> 1388</span>&#160;        (*this)(i,j) = 0.;</div>
<div class="line"><a name="l01389"></a><span class="lineno"> 1389</span>&#160;      }</div>
<div class="line"><a name="l01390"></a><span class="lineno"> 1390</span>&#160;    }</div>
<div class="line"><a name="l01391"></a><span class="lineno"> 1391</span>&#160;  }</div>
<div class="line"><a name="l01392"></a><span class="lineno"> 1392</span>&#160;  <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l01393"></a><span class="lineno"> 1393</span>&#160;}</div>
<div class="line"><a name="l01394"></a><span class="lineno"> 1394</span>&#160;</div>
<div class="line"><a name="l01395"></a><span class="lineno"> 1395</span>&#160;<span class="comment">// ---------------------------------------------------</span></div>
<div class="line"><a name="l01396"></a><span class="lineno"> 1396</span>&#160;<span class="keywordtype">void</span></div>
<div class="line"><a name="l01397"></a><span class="lineno"><a class="line" href="a00227.html#aba1ee7daec126808c3798ce17c9756d4"> 1397</a></span>&#160;<a class="code" href="a00227.html#aba1ee7daec126808c3798ce17c9756d4">TeuchosMatrix::filterLargeValues</a>(<span class="keywordtype">double</span> thresholdValue)</div>
<div class="line"><a name="l01398"></a><span class="lineno"> 1398</span>&#160;{</div>
<div class="line"><a name="l01399"></a><span class="lineno"> 1399</span>&#160;  <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> nRows = this-&gt;<a class="code" href="a00227.html#a78a5b262967d31e6171aadd292e77395">numRowsLocal</a>();</div>
<div class="line"><a name="l01400"></a><span class="lineno"> 1400</span>&#160;  <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> nCols = this-&gt;<a class="code" href="a00227.html#a6e3aa20d8c618718a9fa9cc56ff65b9f">numCols</a>();</div>
<div class="line"><a name="l01401"></a><span class="lineno"> 1401</span>&#160;</div>
<div class="line"><a name="l01402"></a><span class="lineno"> 1402</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = 0; i &lt; nRows; ++i) {</div>
<div class="line"><a name="l01403"></a><span class="lineno"> 1403</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> j = 0; j &lt; nCols; ++j) {</div>
<div class="line"><a name="l01404"></a><span class="lineno"> 1404</span>&#160;      <span class="keywordtype">double</span> aux = (*this)(i,j);</div>
<div class="line"><a name="l01405"></a><span class="lineno"> 1405</span>&#160;      <span class="comment">// If &#39;thresholdValue&#39; is negative, no values will be filtered</span></div>
<div class="line"><a name="l01406"></a><span class="lineno"> 1406</span>&#160;      <span class="keywordflow">if</span> ( (aux &lt; 0. ) &amp;&amp; (-thresholdValue &gt; aux))</div>
<div class="line"><a name="l01407"></a><span class="lineno"> 1407</span>&#160;          (*this)(i,j) = 0.;</div>
<div class="line"><a name="l01408"></a><span class="lineno"> 1408</span>&#160;</div>
<div class="line"><a name="l01409"></a><span class="lineno"> 1409</span>&#160;      <span class="keywordflow">if</span> ((aux &gt; 0. ) &amp;&amp; (thresholdValue &lt; aux))</div>
<div class="line"><a name="l01410"></a><span class="lineno"> 1410</span>&#160;        (*this)(i,j) = 0.;</div>
<div class="line"><a name="l01411"></a><span class="lineno"> 1411</span>&#160;    }</div>
<div class="line"><a name="l01412"></a><span class="lineno"> 1412</span>&#160;  }</div>
<div class="line"><a name="l01413"></a><span class="lineno"> 1413</span>&#160;  <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l01414"></a><span class="lineno"> 1414</span>&#160;}</div>
<div class="line"><a name="l01415"></a><span class="lineno"> 1415</span>&#160;</div>
<div class="line"><a name="l01416"></a><span class="lineno"> 1416</span>&#160;</div>
<div class="line"><a name="l01417"></a><span class="lineno"> 1417</span>&#160;<span class="comment">// ----------------------------------------------</span></div>
<div class="line"><a name="l01418"></a><span class="lineno"> 1418</span>&#160;<span class="comment">// tested 1/31/13</span></div>
<div class="line"><a name="l01419"></a><span class="lineno"> 1419</span>&#160;<span class="keywordtype">void</span></div>
<div class="line"><a name="l01420"></a><span class="lineno"><a class="line" href="a00227.html#a76363713af8d8c36338f999ca0cba0e1"> 1420</a></span>&#160;<a class="code" href="a00227.html#a76363713af8d8c36338f999ca0cba0e1">TeuchosMatrix::fillWithTranspose</a>(<span class="keyword">const</span> <a class="code" href="a00227.html">TeuchosMatrix</a>&amp; mat)</div>
<div class="line"><a name="l01421"></a><span class="lineno"> 1421</span>&#160;{</div>
<div class="line"><a name="l01422"></a><span class="lineno"> 1422</span>&#160;  <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> nRows = mat.<a class="code" href="a00227.html#a78a5b262967d31e6171aadd292e77395">numRowsLocal</a>();</div>
<div class="line"><a name="l01423"></a><span class="lineno"> 1423</span>&#160;  <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> nCols = mat.<a class="code" href="a00227.html#a6e3aa20d8c618718a9fa9cc56ff65b9f">numCols</a>();</div>
<div class="line"><a name="l01424"></a><span class="lineno"> 1424</span>&#160;  <a class="code" href="a00674.html#ace699c1e7716717f330c783a58ebcd4f">queso_require_equal_to_msg</a>(this-&gt;<a class="code" href="a00227.html#a78a5b262967d31e6171aadd292e77395">numRowsLocal</a>(), nCols, <span class="stringliteral">&quot;inconsistent local number of rows&quot;</span>);</div>
<div class="line"><a name="l01425"></a><span class="lineno"> 1425</span>&#160;  <a class="code" href="a00674.html#ace699c1e7716717f330c783a58ebcd4f">queso_require_equal_to_msg</a>(this-&gt;<a class="code" href="a00227.html#a6e3aa20d8c618718a9fa9cc56ff65b9f">numCols</a>(), nRows, <span class="stringliteral">&quot;inconsistent number of cols&quot;</span>);</div>
<div class="line"><a name="l01426"></a><span class="lineno"> 1426</span>&#160;</div>
<div class="line"><a name="l01427"></a><span class="lineno"> 1427</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> row = 0; row &lt; nRows; ++row) {</div>
<div class="line"><a name="l01428"></a><span class="lineno"> 1428</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> col = 0; col &lt; nCols; ++col) {</div>
<div class="line"><a name="l01429"></a><span class="lineno"> 1429</span>&#160;      (*this)(col,row) = mat(row,col);</div>
<div class="line"><a name="l01430"></a><span class="lineno"> 1430</span>&#160;    }</div>
<div class="line"><a name="l01431"></a><span class="lineno"> 1431</span>&#160;  }</div>
<div class="line"><a name="l01432"></a><span class="lineno"> 1432</span>&#160;</div>
<div class="line"><a name="l01433"></a><span class="lineno"> 1433</span>&#160;  <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l01434"></a><span class="lineno"> 1434</span>&#160;}</div>
<div class="line"><a name="l01435"></a><span class="lineno"> 1435</span>&#160;</div>
<div class="line"><a name="l01436"></a><span class="lineno"> 1436</span>&#160;<span class="comment">// ---------------------------------------------------</span></div>
<div class="line"><a name="l01437"></a><span class="lineno"> 1437</span>&#160;<span class="comment">// added 2/28/13</span></div>
<div class="line"><a name="l01438"></a><span class="lineno"> 1438</span>&#160;<span class="keywordtype">void</span></div>
<div class="line"><a name="l01439"></a><span class="lineno"><a class="line" href="a00227.html#a9c476bcea87d63f4b984d05292f919ee"> 1439</a></span>&#160;<a class="code" href="a00227.html#a9c476bcea87d63f4b984d05292f919ee">TeuchosMatrix::fillWithBlocksDiagonally</a>(<span class="keyword">const</span> std::vector&lt;const TeuchosMatrix* &gt;&amp; matrices)</div>
<div class="line"><a name="l01440"></a><span class="lineno"> 1440</span>&#160;{</div>
<div class="line"><a name="l01441"></a><span class="lineno"> 1441</span>&#160;  <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> sumNumRowsLocals = 0;</div>
<div class="line"><a name="l01442"></a><span class="lineno"> 1442</span>&#160;  <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> sumNumCols       = 0;</div>
<div class="line"><a name="l01443"></a><span class="lineno"> 1443</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = 0; i &lt; matrices.size(); ++i) {</div>
<div class="line"><a name="l01444"></a><span class="lineno"> 1444</span>&#160;    sumNumRowsLocals += matrices[i]-&gt;numRowsLocal();</div>
<div class="line"><a name="l01445"></a><span class="lineno"> 1445</span>&#160;    sumNumCols       += matrices[i]-&gt;numCols();</div>
<div class="line"><a name="l01446"></a><span class="lineno"> 1446</span>&#160;  }</div>
<div class="line"><a name="l01447"></a><span class="lineno"> 1447</span>&#160;  <a class="code" href="a00674.html#ace699c1e7716717f330c783a58ebcd4f">queso_require_equal_to_msg</a>(this-&gt;<a class="code" href="a00227.html#a78a5b262967d31e6171aadd292e77395">numRowsLocal</a>(), sumNumRowsLocals, <span class="stringliteral">&quot;inconsistent local number of rows&quot;</span>);</div>
<div class="line"><a name="l01448"></a><span class="lineno"> 1448</span>&#160;  <a class="code" href="a00674.html#ace699c1e7716717f330c783a58ebcd4f">queso_require_equal_to_msg</a>(this-&gt;<a class="code" href="a00227.html#a6e3aa20d8c618718a9fa9cc56ff65b9f">numCols</a>(), sumNumCols, <span class="stringliteral">&quot;inconsistent number of cols&quot;</span>);</div>
<div class="line"><a name="l01449"></a><span class="lineno"> 1449</span>&#160;</div>
<div class="line"><a name="l01450"></a><span class="lineno"> 1450</span>&#160;  <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> cumulativeRowId = 0;</div>
<div class="line"><a name="l01451"></a><span class="lineno"> 1451</span>&#160;  <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> cumulativeColId = 0;</div>
<div class="line"><a name="l01452"></a><span class="lineno"> 1452</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = 0; i &lt; matrices.size(); ++i) {</div>
<div class="line"><a name="l01453"></a><span class="lineno"> 1453</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> nRows = matrices[i]-&gt;numRowsLocal();</div>
<div class="line"><a name="l01454"></a><span class="lineno"> 1454</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> nCols = matrices[i]-&gt;numCols();</div>
<div class="line"><a name="l01455"></a><span class="lineno"> 1455</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> rowId = 0; rowId &lt; nRows; ++rowId) {</div>
<div class="line"><a name="l01456"></a><span class="lineno"> 1456</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> colId = 0; colId &lt; nCols; ++colId) {</div>
<div class="line"><a name="l01457"></a><span class="lineno"> 1457</span>&#160;        (*this)(cumulativeRowId + rowId, cumulativeColId + colId) = (*(matrices[i]))(rowId,colId);</div>
<div class="line"><a name="l01458"></a><span class="lineno"> 1458</span>&#160;      }</div>
<div class="line"><a name="l01459"></a><span class="lineno"> 1459</span>&#160;    }</div>
<div class="line"><a name="l01460"></a><span class="lineno"> 1460</span>&#160;    cumulativeRowId += nRows;</div>
<div class="line"><a name="l01461"></a><span class="lineno"> 1461</span>&#160;    cumulativeColId += nCols;</div>
<div class="line"><a name="l01462"></a><span class="lineno"> 1462</span>&#160;  }</div>
<div class="line"><a name="l01463"></a><span class="lineno"> 1463</span>&#160;</div>
<div class="line"><a name="l01464"></a><span class="lineno"> 1464</span>&#160;  <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l01465"></a><span class="lineno"> 1465</span>&#160;}</div>
<div class="line"><a name="l01466"></a><span class="lineno"> 1466</span>&#160;<span class="comment">// ---------------------------------------------------</span></div>
<div class="line"><a name="l01467"></a><span class="lineno"> 1467</span>&#160;<span class="comment">// added 2/28/13</span></div>
<div class="line"><a name="l01468"></a><span class="lineno"> 1468</span>&#160;<span class="keywordtype">void</span></div>
<div class="line"><a name="l01469"></a><span class="lineno"><a class="line" href="a00227.html#a50f8bbfd22893fb33b6cb93287f3a241"> 1469</a></span>&#160;<a class="code" href="a00227.html#a9c476bcea87d63f4b984d05292f919ee">TeuchosMatrix::fillWithBlocksDiagonally</a>(<span class="keyword">const</span> std::vector&lt;TeuchosMatrix* &gt;&amp; matrices)</div>
<div class="line"><a name="l01470"></a><span class="lineno"> 1470</span>&#160;{</div>
<div class="line"><a name="l01471"></a><span class="lineno"> 1471</span>&#160;  <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> sumNumRowsLocals = 0;</div>
<div class="line"><a name="l01472"></a><span class="lineno"> 1472</span>&#160;  <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> sumNumCols       = 0;</div>
<div class="line"><a name="l01473"></a><span class="lineno"> 1473</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = 0; i &lt; matrices.size(); ++i) {</div>
<div class="line"><a name="l01474"></a><span class="lineno"> 1474</span>&#160;    sumNumRowsLocals += matrices[i]-&gt;numRowsLocal();</div>
<div class="line"><a name="l01475"></a><span class="lineno"> 1475</span>&#160;    sumNumCols       += matrices[i]-&gt;numCols();</div>
<div class="line"><a name="l01476"></a><span class="lineno"> 1476</span>&#160;  }</div>
<div class="line"><a name="l01477"></a><span class="lineno"> 1477</span>&#160;  <a class="code" href="a00674.html#ace699c1e7716717f330c783a58ebcd4f">queso_require_equal_to_msg</a>(this-&gt;<a class="code" href="a00227.html#a78a5b262967d31e6171aadd292e77395">numRowsLocal</a>(), sumNumRowsLocals, <span class="stringliteral">&quot;inconsistent local number of rows&quot;</span>);</div>
<div class="line"><a name="l01478"></a><span class="lineno"> 1478</span>&#160;  <a class="code" href="a00674.html#ace699c1e7716717f330c783a58ebcd4f">queso_require_equal_to_msg</a>(this-&gt;<a class="code" href="a00227.html#a6e3aa20d8c618718a9fa9cc56ff65b9f">numCols</a>(), sumNumCols, <span class="stringliteral">&quot;inconsistent number of cols&quot;</span>);</div>
<div class="line"><a name="l01479"></a><span class="lineno"> 1479</span>&#160;</div>
<div class="line"><a name="l01480"></a><span class="lineno"> 1480</span>&#160;  <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> cumulativeRowId = 0;</div>
<div class="line"><a name="l01481"></a><span class="lineno"> 1481</span>&#160;  <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> cumulativeColId = 0;</div>
<div class="line"><a name="l01482"></a><span class="lineno"> 1482</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = 0; i &lt; matrices.size(); ++i) {</div>
<div class="line"><a name="l01483"></a><span class="lineno"> 1483</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> nRows = matrices[i]-&gt;numRowsLocal();</div>
<div class="line"><a name="l01484"></a><span class="lineno"> 1484</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> nCols = matrices[i]-&gt;numCols();</div>
<div class="line"><a name="l01485"></a><span class="lineno"> 1485</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> rowId = 0; rowId &lt; nRows; ++rowId) {</div>
<div class="line"><a name="l01486"></a><span class="lineno"> 1486</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> colId = 0; colId &lt; nCols; ++colId) {</div>
<div class="line"><a name="l01487"></a><span class="lineno"> 1487</span>&#160;        (*this)(cumulativeRowId + rowId, cumulativeColId + colId) = (*(matrices[i]))(rowId,colId);</div>
<div class="line"><a name="l01488"></a><span class="lineno"> 1488</span>&#160;      }</div>
<div class="line"><a name="l01489"></a><span class="lineno"> 1489</span>&#160;    }</div>
<div class="line"><a name="l01490"></a><span class="lineno"> 1490</span>&#160;    cumulativeRowId += nRows;</div>
<div class="line"><a name="l01491"></a><span class="lineno"> 1491</span>&#160;    cumulativeColId += nCols;</div>
<div class="line"><a name="l01492"></a><span class="lineno"> 1492</span>&#160;  }</div>
<div class="line"><a name="l01493"></a><span class="lineno"> 1493</span>&#160;</div>
<div class="line"><a name="l01494"></a><span class="lineno"> 1494</span>&#160;  <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l01495"></a><span class="lineno"> 1495</span>&#160;}</div>
<div class="line"><a name="l01496"></a><span class="lineno"> 1496</span>&#160;<span class="comment">// ---------------------------------------------------</span></div>
<div class="line"><a name="l01497"></a><span class="lineno"> 1497</span>&#160;<span class="comment">// added 2/28/13</span></div>
<div class="line"><a name="l01498"></a><span class="lineno"> 1498</span>&#160;<span class="keywordtype">void</span></div>
<div class="line"><a name="l01499"></a><span class="lineno"><a class="line" href="a00227.html#a3172e19749bd8821644142ea3b103223"> 1499</a></span>&#160;<a class="code" href="a00227.html#a3172e19749bd8821644142ea3b103223">TeuchosMatrix::fillWithBlocksHorizontally</a>(<span class="keyword">const</span> std::vector&lt;const TeuchosMatrix* &gt;&amp; matrices)</div>
<div class="line"><a name="l01500"></a><span class="lineno"> 1500</span>&#160;{</div>
<div class="line"><a name="l01501"></a><span class="lineno"> 1501</span>&#160;  <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> sumNumCols = 0;</div>
<div class="line"><a name="l01502"></a><span class="lineno"> 1502</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = 0; i &lt; matrices.size(); ++i) {</div>
<div class="line"><a name="l01503"></a><span class="lineno"> 1503</span>&#160;    <a class="code" href="a00674.html#ace699c1e7716717f330c783a58ebcd4f">queso_require_equal_to_msg</a>(this-&gt;<a class="code" href="a00227.html#a78a5b262967d31e6171aadd292e77395">numRowsLocal</a>(), matrices[i]-&gt;<a class="code" href="a00227.html#a78a5b262967d31e6171aadd292e77395">numRowsLocal</a>(), <span class="stringliteral">&quot;inconsistent local number of rows&quot;</span>);</div>
<div class="line"><a name="l01504"></a><span class="lineno"> 1504</span>&#160;    sumNumCols += matrices[i]-&gt;numCols();</div>
<div class="line"><a name="l01505"></a><span class="lineno"> 1505</span>&#160;  }</div>
<div class="line"><a name="l01506"></a><span class="lineno"> 1506</span>&#160;  <a class="code" href="a00674.html#ace699c1e7716717f330c783a58ebcd4f">queso_require_equal_to_msg</a>(this-&gt;<a class="code" href="a00227.html#a6e3aa20d8c618718a9fa9cc56ff65b9f">numCols</a>(), sumNumCols, <span class="stringliteral">&quot;inconsistent number of cols&quot;</span>);</div>
<div class="line"><a name="l01507"></a><span class="lineno"> 1507</span>&#160;</div>
<div class="line"><a name="l01508"></a><span class="lineno"> 1508</span>&#160;  <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> cumulativeColId = 0;</div>
<div class="line"><a name="l01509"></a><span class="lineno"> 1509</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = 0; i &lt; matrices.size(); ++i) {</div>
<div class="line"><a name="l01510"></a><span class="lineno"> 1510</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> nRows = matrices[i]-&gt;numRowsLocal();</div>
<div class="line"><a name="l01511"></a><span class="lineno"> 1511</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> nCols = matrices[i]-&gt;numCols();</div>
<div class="line"><a name="l01512"></a><span class="lineno"> 1512</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> rowId = 0; rowId &lt; nRows; ++rowId) {</div>
<div class="line"><a name="l01513"></a><span class="lineno"> 1513</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> colId = 0; colId &lt; nCols; ++colId) {</div>
<div class="line"><a name="l01514"></a><span class="lineno"> 1514</span>&#160;        (*this)(rowId, cumulativeColId + colId) = (*(matrices[i]))(rowId,colId);</div>
<div class="line"><a name="l01515"></a><span class="lineno"> 1515</span>&#160;      }</div>
<div class="line"><a name="l01516"></a><span class="lineno"> 1516</span>&#160;    }</div>
<div class="line"><a name="l01517"></a><span class="lineno"> 1517</span>&#160;    cumulativeColId += nCols;</div>
<div class="line"><a name="l01518"></a><span class="lineno"> 1518</span>&#160;  }</div>
<div class="line"><a name="l01519"></a><span class="lineno"> 1519</span>&#160;</div>
<div class="line"><a name="l01520"></a><span class="lineno"> 1520</span>&#160;  <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l01521"></a><span class="lineno"> 1521</span>&#160;}</div>
<div class="line"><a name="l01522"></a><span class="lineno"> 1522</span>&#160;</div>
<div class="line"><a name="l01523"></a><span class="lineno"> 1523</span>&#160;<span class="comment">// ---------------------------------------------------</span></div>
<div class="line"><a name="l01524"></a><span class="lineno"> 1524</span>&#160;<span class="comment">// added 2/28/13</span></div>
<div class="line"><a name="l01525"></a><span class="lineno"> 1525</span>&#160;<span class="keywordtype">void</span></div>
<div class="line"><a name="l01526"></a><span class="lineno"><a class="line" href="a00227.html#a2dcbb1a5a2f023b3c1082a2ad25856ba"> 1526</a></span>&#160;<a class="code" href="a00227.html#a3172e19749bd8821644142ea3b103223">TeuchosMatrix::fillWithBlocksHorizontally</a>(<span class="keyword">const</span> std::vector&lt;TeuchosMatrix* &gt;&amp; matrices)</div>
<div class="line"><a name="l01527"></a><span class="lineno"> 1527</span>&#160;{</div>
<div class="line"><a name="l01528"></a><span class="lineno"> 1528</span>&#160;  <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> sumNumCols = 0;</div>
<div class="line"><a name="l01529"></a><span class="lineno"> 1529</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = 0; i &lt; matrices.size(); ++i) {</div>
<div class="line"><a name="l01530"></a><span class="lineno"> 1530</span>&#160;    <a class="code" href="a00674.html#ace699c1e7716717f330c783a58ebcd4f">queso_require_equal_to_msg</a>(this-&gt;<a class="code" href="a00227.html#a78a5b262967d31e6171aadd292e77395">numRowsLocal</a>(), matrices[i]-&gt;<a class="code" href="a00227.html#a78a5b262967d31e6171aadd292e77395">numRowsLocal</a>(), <span class="stringliteral">&quot;inconsistent local number of rows&quot;</span>);</div>
<div class="line"><a name="l01531"></a><span class="lineno"> 1531</span>&#160;    sumNumCols += matrices[i]-&gt;numCols();</div>
<div class="line"><a name="l01532"></a><span class="lineno"> 1532</span>&#160;  }</div>
<div class="line"><a name="l01533"></a><span class="lineno"> 1533</span>&#160;  <a class="code" href="a00674.html#ace699c1e7716717f330c783a58ebcd4f">queso_require_equal_to_msg</a>(this-&gt;<a class="code" href="a00227.html#a6e3aa20d8c618718a9fa9cc56ff65b9f">numCols</a>(), sumNumCols, <span class="stringliteral">&quot;inconsistent number of cols&quot;</span>);</div>
<div class="line"><a name="l01534"></a><span class="lineno"> 1534</span>&#160;</div>
<div class="line"><a name="l01535"></a><span class="lineno"> 1535</span>&#160;  <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> cumulativeColId = 0;</div>
<div class="line"><a name="l01536"></a><span class="lineno"> 1536</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = 0; i &lt; matrices.size(); ++i) {</div>
<div class="line"><a name="l01537"></a><span class="lineno"> 1537</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> nRows = matrices[i]-&gt;numRowsLocal();</div>
<div class="line"><a name="l01538"></a><span class="lineno"> 1538</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> nCols = matrices[i]-&gt;numCols();</div>
<div class="line"><a name="l01539"></a><span class="lineno"> 1539</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> rowId = 0; rowId &lt; nRows; ++rowId) {</div>
<div class="line"><a name="l01540"></a><span class="lineno"> 1540</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> colId = 0; colId &lt; nCols; ++colId) {</div>
<div class="line"><a name="l01541"></a><span class="lineno"> 1541</span>&#160;        (*this)(rowId, cumulativeColId + colId) = (*(matrices[i]))(rowId,colId);</div>
<div class="line"><a name="l01542"></a><span class="lineno"> 1542</span>&#160;      }</div>
<div class="line"><a name="l01543"></a><span class="lineno"> 1543</span>&#160;    }</div>
<div class="line"><a name="l01544"></a><span class="lineno"> 1544</span>&#160;    cumulativeColId += nCols;</div>
<div class="line"><a name="l01545"></a><span class="lineno"> 1545</span>&#160;  }</div>
<div class="line"><a name="l01546"></a><span class="lineno"> 1546</span>&#160;</div>
<div class="line"><a name="l01547"></a><span class="lineno"> 1547</span>&#160;  <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l01548"></a><span class="lineno"> 1548</span>&#160;}</div>
<div class="line"><a name="l01549"></a><span class="lineno"> 1549</span>&#160;</div>
<div class="line"><a name="l01550"></a><span class="lineno"> 1550</span>&#160;<span class="comment">// ---------------------------------------------------</span></div>
<div class="line"><a name="l01551"></a><span class="lineno"> 1551</span>&#160;<span class="comment">// added 2/28/13</span></div>
<div class="line"><a name="l01552"></a><span class="lineno"> 1552</span>&#160;<span class="keywordtype">void</span></div>
<div class="line"><a name="l01553"></a><span class="lineno"><a class="line" href="a00227.html#a8b1592f739d3ae726449ab3d5d49843f"> 1553</a></span>&#160;<a class="code" href="a00227.html#a8b1592f739d3ae726449ab3d5d49843f">TeuchosMatrix::fillWithBlocksVertically</a>(<span class="keyword">const</span> std::vector&lt;const TeuchosMatrix* &gt;&amp; matrices)</div>
<div class="line"><a name="l01554"></a><span class="lineno"> 1554</span>&#160;{</div>
<div class="line"><a name="l01555"></a><span class="lineno"> 1555</span>&#160;  <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> sumNumRows = 0;</div>
<div class="line"><a name="l01556"></a><span class="lineno"> 1556</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = 0; i &lt; matrices.size(); ++i) {</div>
<div class="line"><a name="l01557"></a><span class="lineno"> 1557</span>&#160;    <a class="code" href="a00674.html#ace699c1e7716717f330c783a58ebcd4f">queso_require_equal_to_msg</a>(this-&gt;<a class="code" href="a00227.html#a6e3aa20d8c618718a9fa9cc56ff65b9f">numCols</a>(), matrices[i]-&gt;<a class="code" href="a00227.html#a6e3aa20d8c618718a9fa9cc56ff65b9f">numCols</a>(), <span class="stringliteral">&quot;inconsistent local number of cols&quot;</span>);</div>
<div class="line"><a name="l01558"></a><span class="lineno"> 1558</span>&#160;    sumNumRows += matrices[i]-&gt;numRowsLocal();</div>
<div class="line"><a name="l01559"></a><span class="lineno"> 1559</span>&#160;  }</div>
<div class="line"><a name="l01560"></a><span class="lineno"> 1560</span>&#160;  <a class="code" href="a00674.html#ace699c1e7716717f330c783a58ebcd4f">queso_require_equal_to_msg</a>(this-&gt;<a class="code" href="a00227.html#a78a5b262967d31e6171aadd292e77395">numRowsLocal</a>(), sumNumRows, <span class="stringliteral">&quot;inconsistent number of rows&quot;</span>);</div>
<div class="line"><a name="l01561"></a><span class="lineno"> 1561</span>&#160;</div>
<div class="line"><a name="l01562"></a><span class="lineno"> 1562</span>&#160;  <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> cumulativeRowId = 0;</div>
<div class="line"><a name="l01563"></a><span class="lineno"> 1563</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = 0; i &lt; matrices.size(); ++i) {</div>
<div class="line"><a name="l01564"></a><span class="lineno"> 1564</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> nRows = matrices[i]-&gt;numRowsLocal();</div>
<div class="line"><a name="l01565"></a><span class="lineno"> 1565</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> nCols = matrices[i]-&gt;numCols();</div>
<div class="line"><a name="l01566"></a><span class="lineno"> 1566</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> rowId = 0; rowId &lt; nRows; ++rowId) {</div>
<div class="line"><a name="l01567"></a><span class="lineno"> 1567</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> colId = 0; colId &lt; nCols; ++colId) {</div>
<div class="line"><a name="l01568"></a><span class="lineno"> 1568</span>&#160;        (*this)(cumulativeRowId + rowId, colId) = (*(matrices[i]))(rowId,colId);</div>
<div class="line"><a name="l01569"></a><span class="lineno"> 1569</span>&#160;      }</div>
<div class="line"><a name="l01570"></a><span class="lineno"> 1570</span>&#160;    }</div>
<div class="line"><a name="l01571"></a><span class="lineno"> 1571</span>&#160;    cumulativeRowId += nRows;</div>
<div class="line"><a name="l01572"></a><span class="lineno"> 1572</span>&#160;  }</div>
<div class="line"><a name="l01573"></a><span class="lineno"> 1573</span>&#160;  <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l01574"></a><span class="lineno"> 1574</span>&#160;}</div>
<div class="line"><a name="l01575"></a><span class="lineno"> 1575</span>&#160;</div>
<div class="line"><a name="l01576"></a><span class="lineno"> 1576</span>&#160;<span class="comment">// ---------------------------------------------------</span></div>
<div class="line"><a name="l01577"></a><span class="lineno"> 1577</span>&#160;<span class="comment">// added 2/28/13</span></div>
<div class="line"><a name="l01578"></a><span class="lineno"> 1578</span>&#160;<span class="keywordtype">void</span></div>
<div class="line"><a name="l01579"></a><span class="lineno"><a class="line" href="a00227.html#a2619de1729c84674036dc7e6c2fa1cca"> 1579</a></span>&#160;<a class="code" href="a00227.html#a8b1592f739d3ae726449ab3d5d49843f">TeuchosMatrix::fillWithBlocksVertically</a>(<span class="keyword">const</span> std::vector&lt;TeuchosMatrix* &gt;&amp; matrices)</div>
<div class="line"><a name="l01580"></a><span class="lineno"> 1580</span>&#160;{</div>
<div class="line"><a name="l01581"></a><span class="lineno"> 1581</span>&#160;  <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> sumNumRows = 0;</div>
<div class="line"><a name="l01582"></a><span class="lineno"> 1582</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = 0; i &lt; matrices.size(); ++i) {</div>
<div class="line"><a name="l01583"></a><span class="lineno"> 1583</span>&#160;    <a class="code" href="a00674.html#ace699c1e7716717f330c783a58ebcd4f">queso_require_equal_to_msg</a>(this-&gt;<a class="code" href="a00227.html#a6e3aa20d8c618718a9fa9cc56ff65b9f">numCols</a>(), matrices[i]-&gt;<a class="code" href="a00227.html#a6e3aa20d8c618718a9fa9cc56ff65b9f">numCols</a>(), <span class="stringliteral">&quot;inconsistent local number of cols&quot;</span>);</div>
<div class="line"><a name="l01584"></a><span class="lineno"> 1584</span>&#160;    sumNumRows += matrices[i]-&gt;numRowsLocal();</div>
<div class="line"><a name="l01585"></a><span class="lineno"> 1585</span>&#160;  }</div>
<div class="line"><a name="l01586"></a><span class="lineno"> 1586</span>&#160;  <a class="code" href="a00674.html#ace699c1e7716717f330c783a58ebcd4f">queso_require_equal_to_msg</a>(this-&gt;<a class="code" href="a00227.html#a78a5b262967d31e6171aadd292e77395">numRowsLocal</a>(), sumNumRows, <span class="stringliteral">&quot;inconsistent number of rows&quot;</span>);</div>
<div class="line"><a name="l01587"></a><span class="lineno"> 1587</span>&#160;</div>
<div class="line"><a name="l01588"></a><span class="lineno"> 1588</span>&#160;  <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> cumulativeRowId = 0;</div>
<div class="line"><a name="l01589"></a><span class="lineno"> 1589</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = 0; i &lt; matrices.size(); ++i) {</div>
<div class="line"><a name="l01590"></a><span class="lineno"> 1590</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> nRows = matrices[i]-&gt;numRowsLocal();</div>
<div class="line"><a name="l01591"></a><span class="lineno"> 1591</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> nCols = matrices[i]-&gt;numCols();</div>
<div class="line"><a name="l01592"></a><span class="lineno"> 1592</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> rowId = 0; rowId &lt; nRows; ++rowId) {</div>
<div class="line"><a name="l01593"></a><span class="lineno"> 1593</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> colId = 0; colId &lt; nCols; ++colId) {</div>
<div class="line"><a name="l01594"></a><span class="lineno"> 1594</span>&#160;        (*this)(cumulativeRowId + rowId, colId) = (*(matrices[i]))(rowId,colId);</div>
<div class="line"><a name="l01595"></a><span class="lineno"> 1595</span>&#160;      }</div>
<div class="line"><a name="l01596"></a><span class="lineno"> 1596</span>&#160;    }</div>
<div class="line"><a name="l01597"></a><span class="lineno"> 1597</span>&#160;    cumulativeRowId += nRows;</div>
<div class="line"><a name="l01598"></a><span class="lineno"> 1598</span>&#160;  }</div>
<div class="line"><a name="l01599"></a><span class="lineno"> 1599</span>&#160;  <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l01600"></a><span class="lineno"> 1600</span>&#160;}</div>
<div class="line"><a name="l01601"></a><span class="lineno"> 1601</span>&#160;</div>
<div class="line"><a name="l01602"></a><span class="lineno"> 1602</span>&#160;<span class="comment">// ---------------------------------------------------</span></div>
<div class="line"><a name="l01603"></a><span class="lineno"> 1603</span>&#160;<span class="comment">// added 2/28/13</span></div>
<div class="line"><a name="l01604"></a><span class="lineno"> 1604</span>&#160;<span class="keywordtype">void</span></div>
<div class="line"><a name="l01605"></a><span class="lineno"><a class="line" href="a00227.html#a33d7b0e6223baca6c8e10f6e65c67151"> 1605</a></span>&#160;<a class="code" href="a00227.html#a33d7b0e6223baca6c8e10f6e65c67151">TeuchosMatrix::fillWithTensorProduct</a>(<span class="keyword">const</span> <a class="code" href="a00227.html">TeuchosMatrix</a>&amp; mat1, <span class="keyword">const</span> <a class="code" href="a00227.html">TeuchosMatrix</a>&amp; mat2)</div>
<div class="line"><a name="l01606"></a><span class="lineno"> 1606</span>&#160;{</div>
<div class="line"><a name="l01607"></a><span class="lineno"> 1607</span>&#160;  <a class="code" href="a00674.html#ace699c1e7716717f330c783a58ebcd4f">queso_require_equal_to_msg</a>(this-&gt;<a class="code" href="a00227.html#a78a5b262967d31e6171aadd292e77395">numRowsLocal</a>(), (mat1.<a class="code" href="a00227.html#a78a5b262967d31e6171aadd292e77395">numRowsLocal</a>() * mat2.<a class="code" href="a00227.html#a78a5b262967d31e6171aadd292e77395">numRowsLocal</a>()), <span class="stringliteral">&quot;inconsistent local number of rows&quot;</span>);</div>
<div class="line"><a name="l01608"></a><span class="lineno"> 1608</span>&#160;  <a class="code" href="a00674.html#ace699c1e7716717f330c783a58ebcd4f">queso_require_equal_to_msg</a>(this-&gt;<a class="code" href="a00227.html#a6e3aa20d8c618718a9fa9cc56ff65b9f">numCols</a>(), (mat1.<a class="code" href="a00227.html#a6e3aa20d8c618718a9fa9cc56ff65b9f">numCols</a>() * mat2.<a class="code" href="a00227.html#a6e3aa20d8c618718a9fa9cc56ff65b9f">numCols</a>()), <span class="stringliteral">&quot;inconsistent number of columns&quot;</span>);</div>
<div class="line"><a name="l01609"></a><span class="lineno"> 1609</span>&#160;</div>
<div class="line"><a name="l01610"></a><span class="lineno"> 1610</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> rowId1 = 0; rowId1 &lt; mat1.<a class="code" href="a00227.html#a78a5b262967d31e6171aadd292e77395">numRowsLocal</a>(); ++rowId1) {</div>
<div class="line"><a name="l01611"></a><span class="lineno"> 1611</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> colId1 = 0; colId1 &lt; mat1.<a class="code" href="a00227.html#a6e3aa20d8c618718a9fa9cc56ff65b9f">numCols</a>(); ++colId1) {</div>
<div class="line"><a name="l01612"></a><span class="lineno"> 1612</span>&#160;      <span class="keywordtype">double</span> multiplicativeFactor = mat1(rowId1,colId1);</div>
<div class="line"><a name="l01613"></a><span class="lineno"> 1613</span>&#160;      <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> targetRowId = rowId1 * mat2.<a class="code" href="a00227.html#a78a5b262967d31e6171aadd292e77395">numRowsLocal</a>();</div>
<div class="line"><a name="l01614"></a><span class="lineno"> 1614</span>&#160;      <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> targetColId = colId1 * mat2.<a class="code" href="a00227.html#a6e3aa20d8c618718a9fa9cc56ff65b9f">numCols</a>();</div>
<div class="line"><a name="l01615"></a><span class="lineno"> 1615</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> rowId2 = 0; rowId2 &lt; mat2.<a class="code" href="a00227.html#a78a5b262967d31e6171aadd292e77395">numRowsLocal</a>(); ++rowId2) {</div>
<div class="line"><a name="l01616"></a><span class="lineno"> 1616</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> colId2 = 0; colId2 &lt; mat2.<a class="code" href="a00227.html#a6e3aa20d8c618718a9fa9cc56ff65b9f">numCols</a>(); ++colId2) {</div>
<div class="line"><a name="l01617"></a><span class="lineno"> 1617</span>&#160;          (*this)(targetRowId + rowId2, targetColId + colId2) = multiplicativeFactor * mat2(rowId2,colId2);</div>
<div class="line"><a name="l01618"></a><span class="lineno"> 1618</span>&#160;        }</div>
<div class="line"><a name="l01619"></a><span class="lineno"> 1619</span>&#160;      }</div>
<div class="line"><a name="l01620"></a><span class="lineno"> 1620</span>&#160;    }</div>
<div class="line"><a name="l01621"></a><span class="lineno"> 1621</span>&#160;  }</div>
<div class="line"><a name="l01622"></a><span class="lineno"> 1622</span>&#160;  <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l01623"></a><span class="lineno"> 1623</span>&#160;}</div>
<div class="line"><a name="l01624"></a><span class="lineno"> 1624</span>&#160;</div>
<div class="line"><a name="l01625"></a><span class="lineno"> 1625</span>&#160;<span class="comment">// ---------------------------------------------------</span></div>
<div class="line"><a name="l01626"></a><span class="lineno"> 1626</span>&#160;<span class="comment">// added 2/28/13</span></div>
<div class="line"><a name="l01627"></a><span class="lineno"> 1627</span>&#160;<span class="keywordtype">void</span></div>
<div class="line"><a name="l01628"></a><span class="lineno"><a class="line" href="a00227.html#a8f09abafdc7fa89186020bde08aabee3"> 1628</a></span>&#160;<a class="code" href="a00227.html#a33d7b0e6223baca6c8e10f6e65c67151">TeuchosMatrix::fillWithTensorProduct</a>(<span class="keyword">const</span> <a class="code" href="a00227.html">TeuchosMatrix</a>&amp; mat1, <span class="keyword">const</span> <a class="code" href="a00228.html">TeuchosVector</a>&amp; vec2)</div>
<div class="line"><a name="l01629"></a><span class="lineno"> 1629</span>&#160;{</div>
<div class="line"><a name="l01630"></a><span class="lineno"> 1630</span>&#160;  <a class="code" href="a00674.html#ace699c1e7716717f330c783a58ebcd4f">queso_require_equal_to_msg</a>(this-&gt;<a class="code" href="a00227.html#a78a5b262967d31e6171aadd292e77395">numRowsLocal</a>(), (mat1.<a class="code" href="a00227.html#a78a5b262967d31e6171aadd292e77395">numRowsLocal</a>() * vec2.<a class="code" href="a00228.html#aa1d2726c42a9c317898e348fafca6998">sizeLocal</a>()), <span class="stringliteral">&quot;inconsistent local number of rows&quot;</span>);</div>
<div class="line"><a name="l01631"></a><span class="lineno"> 1631</span>&#160;  <a class="code" href="a00674.html#ace699c1e7716717f330c783a58ebcd4f">queso_require_equal_to_msg</a>(this-&gt;<a class="code" href="a00227.html#a6e3aa20d8c618718a9fa9cc56ff65b9f">numCols</a>(), (mat1.<a class="code" href="a00227.html#a6e3aa20d8c618718a9fa9cc56ff65b9f">numCols</a>() * 1), <span class="stringliteral">&quot;inconsistent number of columns&quot;</span>);</div>
<div class="line"><a name="l01632"></a><span class="lineno"> 1632</span>&#160;</div>
<div class="line"><a name="l01633"></a><span class="lineno"> 1633</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> rowId1 = 0; rowId1 &lt; mat1.<a class="code" href="a00227.html#a78a5b262967d31e6171aadd292e77395">numRowsLocal</a>(); ++rowId1) {</div>
<div class="line"><a name="l01634"></a><span class="lineno"> 1634</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> colId1 = 0; colId1 &lt; mat1.<a class="code" href="a00227.html#a6e3aa20d8c618718a9fa9cc56ff65b9f">numCols</a>(); ++colId1) {</div>
<div class="line"><a name="l01635"></a><span class="lineno"> 1635</span>&#160;      <span class="keywordtype">double</span> multiplicativeFactor = mat1(rowId1,colId1);</div>
<div class="line"><a name="l01636"></a><span class="lineno"> 1636</span>&#160;      <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> targetRowId = rowId1 * vec2.<a class="code" href="a00228.html#aa1d2726c42a9c317898e348fafca6998">sizeLocal</a>();</div>
<div class="line"><a name="l01637"></a><span class="lineno"> 1637</span>&#160;      <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> targetColId = colId1 * 1;</div>
<div class="line"><a name="l01638"></a><span class="lineno"> 1638</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> rowId2 = 0; rowId2 &lt; vec2.<a class="code" href="a00228.html#aa1d2726c42a9c317898e348fafca6998">sizeLocal</a>(); ++rowId2) {</div>
<div class="line"><a name="l01639"></a><span class="lineno"> 1639</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> colId2 = 0; colId2 &lt; 1; ++colId2) {</div>
<div class="line"><a name="l01640"></a><span class="lineno"> 1640</span>&#160;          (*this)(targetRowId + rowId2, targetColId + colId2) = multiplicativeFactor * vec2[rowId2];</div>
<div class="line"><a name="l01641"></a><span class="lineno"> 1641</span>&#160;        }</div>
<div class="line"><a name="l01642"></a><span class="lineno"> 1642</span>&#160;      }</div>
<div class="line"><a name="l01643"></a><span class="lineno"> 1643</span>&#160;    }</div>
<div class="line"><a name="l01644"></a><span class="lineno"> 1644</span>&#160;  }</div>
<div class="line"><a name="l01645"></a><span class="lineno"> 1645</span>&#160;  <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l01646"></a><span class="lineno"> 1646</span>&#160;}</div>
<div class="line"><a name="l01647"></a><span class="lineno"> 1647</span>&#160;</div>
<div class="line"><a name="l01648"></a><span class="lineno"> 1648</span>&#160;</div>
<div class="line"><a name="l01649"></a><span class="lineno"> 1649</span>&#160;<span class="comment">// Miscellaneous methodos ----------------------------</span></div>
<div class="line"><a name="l01650"></a><span class="lineno"> 1650</span>&#160;<span class="comment">// ---------------------------------------------------</span></div>
<div class="line"><a name="l01651"></a><span class="lineno"> 1651</span>&#160;</div>
<div class="line"><a name="l01652"></a><span class="lineno"> 1652</span>&#160;<span class="keywordtype">void</span></div>
<div class="line"><a name="l01653"></a><span class="lineno"><a class="line" href="a00227.html#ac52cc56f2786fbd2d77023265a7da390"> 1653</a></span>&#160;<a class="code" href="a00227.html#ac52cc56f2786fbd2d77023265a7da390">TeuchosMatrix::mpiSum</a>( <span class="keyword">const</span> <a class="code" href="a00179.html">MpiComm</a>&amp; comm, <a class="code" href="a00227.html">TeuchosMatrix</a>&amp; M_global )<span class="keyword"> const</span></div>
<div class="line"><a name="l01654"></a><span class="lineno"> 1654</span>&#160;<span class="keyword"></span>{</div>
<div class="line"><a name="l01655"></a><span class="lineno"> 1655</span>&#160;  <span class="comment">// Sanity Checks</span></div>
<div class="line"><a name="l01656"></a><span class="lineno"> 1656</span>&#160;  <a class="code" href="a00674.html#ace699c1e7716717f330c783a58ebcd4f">queso_require_equal_to_msg</a>(this-&gt;<a class="code" href="a00227.html#a78a5b262967d31e6171aadd292e77395">numRowsLocal</a>(),</div>
<div class="line"><a name="l01657"></a><span class="lineno"> 1657</span>&#160;                             M_global.<a class="code" href="a00227.html#a78a5b262967d31e6171aadd292e77395">numRowsLocal</a>(),</div>
<div class="line"><a name="l01658"></a><span class="lineno"> 1658</span>&#160;                             <span class="stringliteral">&quot;local and global matrices incompatible&quot;</span>);</div>
<div class="line"><a name="l01659"></a><span class="lineno"> 1659</span>&#160;  <a class="code" href="a00674.html#ace699c1e7716717f330c783a58ebcd4f">queso_require_equal_to_msg</a>(this-&gt;<a class="code" href="a00227.html#a6e3aa20d8c618718a9fa9cc56ff65b9f">numCols</a>(),</div>
<div class="line"><a name="l01660"></a><span class="lineno"> 1660</span>&#160;                             M_global.<a class="code" href="a00227.html#a6e3aa20d8c618718a9fa9cc56ff65b9f">numCols</a>(),</div>
<div class="line"><a name="l01661"></a><span class="lineno"> 1661</span>&#160;                             <span class="stringliteral">&quot;local and global matrices incompatible&quot;</span>);</div>
<div class="line"><a name="l01662"></a><span class="lineno"> 1662</span>&#160;</div>
<div class="line"><a name="l01663"></a><span class="lineno"> 1663</span>&#160;  <span class="comment">/* TODO: Probably a better way to handle this unpacking/packing of data */</span></div>
<div class="line"><a name="l01664"></a><span class="lineno"> 1664</span>&#160;  <span class="keywordtype">int</span> <a class="code" href="a00674.html#a533f41b58c01b7a3acb23dcfd25142a7">size</a> = M_global.<a class="code" href="a00227.html#a78a5b262967d31e6171aadd292e77395">numRowsLocal</a>()*M_global.<a class="code" href="a00227.html#a6e3aa20d8c618718a9fa9cc56ff65b9f">numCols</a>();</div>
<div class="line"><a name="l01665"></a><span class="lineno"> 1665</span>&#160;  std::vector&lt;double&gt; local( size, 0.0 );</div>
<div class="line"><a name="l01666"></a><span class="lineno"> 1666</span>&#160;  std::vector&lt;double&gt; global( size, 0.0 );</div>
<div class="line"><a name="l01667"></a><span class="lineno"> 1667</span>&#160;</div>
<div class="line"><a name="l01668"></a><span class="lineno"> 1668</span>&#160;  <span class="keywordtype">int</span> <a class="code" href="a00313.html#ab66ed8e0098c0a86b458672a55a9cca9">k</a>;</div>
<div class="line"><a name="l01669"></a><span class="lineno"> 1669</span>&#160;  <span class="keywordflow">for</span>( <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = 0; i &lt; this-&gt;<a class="code" href="a00227.html#a78a5b262967d31e6171aadd292e77395">numRowsLocal</a>(); i++ ) {</div>
<div class="line"><a name="l01670"></a><span class="lineno"> 1670</span>&#160;      <span class="keywordflow">for</span>( <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> j = 0; j &lt; this-&gt;<a class="code" href="a00227.html#a6e3aa20d8c618718a9fa9cc56ff65b9f">numCols</a>(); j++ ) {</div>
<div class="line"><a name="l01671"></a><span class="lineno"> 1671</span>&#160;          k = i + j*M_global.<a class="code" href="a00227.html#a6e3aa20d8c618718a9fa9cc56ff65b9f">numCols</a>();</div>
<div class="line"><a name="l01672"></a><span class="lineno"> 1672</span>&#160;          local[<a class="code" href="a00313.html#ab66ed8e0098c0a86b458672a55a9cca9">k</a>] = (*this)(i,j);</div>
<div class="line"><a name="l01673"></a><span class="lineno"> 1673</span>&#160;          }</div>
<div class="line"><a name="l01674"></a><span class="lineno"> 1674</span>&#160;  }</div>
<div class="line"><a name="l01675"></a><span class="lineno"> 1675</span>&#160;</div>
<div class="line"><a name="l01676"></a><span class="lineno"> 1676</span>&#160;  comm.<a class="code" href="a00179.html#a72e137e60ef8060efb1ee5fc874fa4b8">Allreduce</a>&lt;<span class="keywordtype">double</span>&gt;(&amp;local[0], &amp;global[0], <a class="code" href="a00674.html#a533f41b58c01b7a3acb23dcfd25142a7">size</a>, RawValue_MPI_SUM,</div>
<div class="line"><a name="l01677"></a><span class="lineno"> 1677</span>&#160;                 <span class="stringliteral">&quot;TeuchosMatrix::mpiSum()&quot;</span>,</div>
<div class="line"><a name="l01678"></a><span class="lineno"> 1678</span>&#160;                 <span class="stringliteral">&quot;failed MPI.Allreduce()&quot;</span>);</div>
<div class="line"><a name="l01679"></a><span class="lineno"> 1679</span>&#160;</div>
<div class="line"><a name="l01680"></a><span class="lineno"> 1680</span>&#160;  <span class="keywordflow">for</span>( <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = 0; i &lt; this-&gt;<a class="code" href="a00227.html#a78a5b262967d31e6171aadd292e77395">numRowsLocal</a>(); i++ ) {</div>
<div class="line"><a name="l01681"></a><span class="lineno"> 1681</span>&#160;      <span class="keywordflow">for</span>( <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> j = 0; j &lt; this-&gt;<a class="code" href="a00227.html#a6e3aa20d8c618718a9fa9cc56ff65b9f">numCols</a>(); j++ ) {</div>
<div class="line"><a name="l01682"></a><span class="lineno"> 1682</span>&#160;          k = i + j*M_global.<a class="code" href="a00227.html#a6e3aa20d8c618718a9fa9cc56ff65b9f">numCols</a>();</div>
<div class="line"><a name="l01683"></a><span class="lineno"> 1683</span>&#160;          M_global(i,j) = global[<a class="code" href="a00313.html#ab66ed8e0098c0a86b458672a55a9cca9">k</a>];</div>
<div class="line"><a name="l01684"></a><span class="lineno"> 1684</span>&#160;          }</div>
<div class="line"><a name="l01685"></a><span class="lineno"> 1685</span>&#160;  }</div>
<div class="line"><a name="l01686"></a><span class="lineno"> 1686</span>&#160;</div>
<div class="line"><a name="l01687"></a><span class="lineno"> 1687</span>&#160;  <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l01688"></a><span class="lineno"> 1688</span>&#160;}</div>
<div class="line"><a name="l01689"></a><span class="lineno"> 1689</span>&#160;</div>
<div class="line"><a name="l01690"></a><span class="lineno"> 1690</span>&#160;<span class="comment">//--------------------------------------------------------</span></div>
<div class="line"><a name="l01691"></a><span class="lineno"> 1691</span>&#160;<span class="comment">// tested 2/28/13</span></div>
<div class="line"><a name="l01692"></a><span class="lineno"> 1692</span>&#160;<span class="keywordtype">void</span></div>
<div class="line"><a name="l01693"></a><span class="lineno"><a class="line" href="a00227.html#a4d97b7b6df41e465fc46a57c6a4f5cb7"> 1693</a></span>&#160;<a class="code" href="a00227.html#a4d97b7b6df41e465fc46a57c6a4f5cb7">TeuchosMatrix::matlabLinearInterpExtrap</a>(</div>
<div class="line"><a name="l01694"></a><span class="lineno"> 1694</span>&#160;  <span class="keyword">const</span> <a class="code" href="a00228.html">TeuchosVector</a>&amp; x1Vec,</div>
<div class="line"><a name="l01695"></a><span class="lineno"> 1695</span>&#160;  <span class="keyword">const</span> <a class="code" href="a00227.html">TeuchosMatrix</a>&amp; y1Mat,</div>
<div class="line"><a name="l01696"></a><span class="lineno"> 1696</span>&#160;  <span class="keyword">const</span> <a class="code" href="a00228.html">TeuchosVector</a>&amp; x2Vec)</div>
<div class="line"><a name="l01697"></a><span class="lineno"> 1697</span>&#160;{</div>
<div class="line"><a name="l01698"></a><span class="lineno"> 1698</span>&#160;  queso_require_greater_msg(x1Vec.<a class="code" href="a00228.html#aa1d2726c42a9c317898e348fafca6998">sizeLocal</a>(), 1, <span class="stringliteral">&quot;invalid &#39;x1&#39; size&quot;</span>);</div>
<div class="line"><a name="l01699"></a><span class="lineno"> 1699</span>&#160;</div>
<div class="line"><a name="l01700"></a><span class="lineno"> 1700</span>&#160;  <a class="code" href="a00674.html#ace699c1e7716717f330c783a58ebcd4f">queso_require_equal_to_msg</a>(x1Vec.<a class="code" href="a00228.html#aa1d2726c42a9c317898e348fafca6998">sizeLocal</a>(), y1Mat.<a class="code" href="a00227.html#a78a5b262967d31e6171aadd292e77395">numRowsLocal</a>(), <span class="stringliteral">&quot;invalid &#39;x1&#39; and &#39;y1&#39; sizes&quot;</span>);</div>
<div class="line"><a name="l01701"></a><span class="lineno"> 1701</span>&#160;</div>
<div class="line"><a name="l01702"></a><span class="lineno"> 1702</span>&#160;  <a class="code" href="a00674.html#ace699c1e7716717f330c783a58ebcd4f">queso_require_equal_to_msg</a>(x2Vec.<a class="code" href="a00228.html#aa1d2726c42a9c317898e348fafca6998">sizeLocal</a>(), this-&gt;<a class="code" href="a00227.html#a78a5b262967d31e6171aadd292e77395">numRowsLocal</a>(), <span class="stringliteral">&quot;invalid &#39;x2&#39; and &#39;this&#39; sizes&quot;</span>);</div>
<div class="line"><a name="l01703"></a><span class="lineno"> 1703</span>&#160;</div>
<div class="line"><a name="l01704"></a><span class="lineno"> 1704</span>&#160;  <a class="code" href="a00674.html#ace699c1e7716717f330c783a58ebcd4f">queso_require_equal_to_msg</a>(y1Mat.<a class="code" href="a00227.html#a6e3aa20d8c618718a9fa9cc56ff65b9f">numCols</a>(), this-&gt;<a class="code" href="a00227.html#a6e3aa20d8c618718a9fa9cc56ff65b9f">numCols</a>(), <span class="stringliteral">&quot;invalid &#39;y1&#39; and &#39;this&#39; sizes&quot;</span>);</div>
<div class="line"><a name="l01705"></a><span class="lineno"> 1705</span>&#160;</div>
<div class="line"><a name="l01706"></a><span class="lineno"> 1706</span>&#160;  <a class="code" href="a00228.html">TeuchosVector</a> y1Vec(x1Vec);</div>
<div class="line"><a name="l01707"></a><span class="lineno"> 1707</span>&#160;  <a class="code" href="a00228.html">TeuchosVector</a> y2Vec(x2Vec);</div>
<div class="line"><a name="l01708"></a><span class="lineno"> 1708</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> colId = 0; colId &lt; y1Mat.<a class="code" href="a00227.html#a6e3aa20d8c618718a9fa9cc56ff65b9f">numCols</a>(); ++colId) {</div>
<div class="line"><a name="l01709"></a><span class="lineno"> 1709</span>&#160;    y1Mat.<a class="code" href="a00227.html#ae66a7551b49a7e33a407972c3da2763c">getColumn</a>(colId,y1Vec);</div>
<div class="line"><a name="l01710"></a><span class="lineno"> 1710</span>&#160;    y2Vec.<a class="code" href="a00228.html#a1f6482c296c6bb263810772af6c81746">matlabLinearInterpExtrap</a>(x1Vec,y1Vec,x2Vec);</div>
<div class="line"><a name="l01711"></a><span class="lineno"> 1711</span>&#160;    this-&gt;<a class="code" href="a00227.html#a5855b579a855166171ccdd72c55e5d0d">setColumn</a>(colId,y2Vec);</div>
<div class="line"><a name="l01712"></a><span class="lineno"> 1712</span>&#160;  }</div>
<div class="line"><a name="l01713"></a><span class="lineno"> 1713</span>&#160;</div>
<div class="line"><a name="l01714"></a><span class="lineno"> 1714</span>&#160;  <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l01715"></a><span class="lineno"> 1715</span>&#160;}</div>
<div class="line"><a name="l01716"></a><span class="lineno"> 1716</span>&#160;</div>
<div class="line"><a name="l01717"></a><span class="lineno"> 1717</span>&#160;<span class="comment">// I/O methodos --------------------------------------</span></div>
<div class="line"><a name="l01718"></a><span class="lineno"> 1718</span>&#160;<span class="comment">// ---------------------------------------------------</span></div>
<div class="line"><a name="l01719"></a><span class="lineno"> 1719</span>&#160;<span class="comment">// Kemelli 12/05/12 - tested</span></div>
<div class="line"><a name="l01720"></a><span class="lineno"> 1720</span>&#160;<span class="keywordtype">void</span></div>
<div class="line"><a name="l01721"></a><span class="lineno"><a class="line" href="a00227.html#a3f1a1e4d74f39bcef06cd1fc91a58656"> 1721</a></span>&#160;<a class="code" href="a00227.html#a3f1a1e4d74f39bcef06cd1fc91a58656">TeuchosMatrix::print</a>(std::ostream&amp; os)<span class="keyword"> const</span></div>
<div class="line"><a name="l01722"></a><span class="lineno"> 1722</span>&#160;<span class="keyword"></span>{</div>
<div class="line"><a name="l01723"></a><span class="lineno"> 1723</span>&#160;  <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> nRows = this-&gt;<a class="code" href="a00227.html#a78a5b262967d31e6171aadd292e77395">numRowsLocal</a>();</div>
<div class="line"><a name="l01724"></a><span class="lineno"> 1724</span>&#160;  <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> nCols = this-&gt;<a class="code" href="a00227.html#a6e3aa20d8c618718a9fa9cc56ff65b9f">numCols</a>();</div>
<div class="line"><a name="l01725"></a><span class="lineno"> 1725</span>&#160;</div>
<div class="line"><a name="l01726"></a><span class="lineno"> 1726</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="a00164.html#aebf5e44b149cf1454b2e12995d9f8b6b">m_printHorizontally</a>) {</div>
<div class="line"><a name="l01727"></a><span class="lineno"> 1727</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = 0; i &lt; nRows; ++i) {</div>
<div class="line"><a name="l01728"></a><span class="lineno"> 1728</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> j = 0; j &lt; nCols; ++j) {</div>
<div class="line"><a name="l01729"></a><span class="lineno"> 1729</span>&#160;        os &lt;&lt; (*this)(i,j)</div>
<div class="line"><a name="l01730"></a><span class="lineno"> 1730</span>&#160;           &lt;&lt; <span class="stringliteral">&quot; &quot;</span>;</div>
<div class="line"><a name="l01731"></a><span class="lineno"> 1731</span>&#160;      }</div>
<div class="line"><a name="l01732"></a><span class="lineno"> 1732</span>&#160;      <span class="keywordflow">if</span> (i != (nRows-1)) os &lt;&lt; <span class="stringliteral">&quot;; &quot;</span>;</div>
<div class="line"><a name="l01733"></a><span class="lineno"> 1733</span>&#160;    }</div>
<div class="line"><a name="l01734"></a><span class="lineno"> 1734</span>&#160;    <span class="comment">//os &lt;&lt; std::endl;</span></div>
<div class="line"><a name="l01735"></a><span class="lineno"> 1735</span>&#160;  }</div>
<div class="line"><a name="l01736"></a><span class="lineno"> 1736</span>&#160;  <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l01737"></a><span class="lineno"> 1737</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = 0; i &lt; nRows; ++i) {</div>
<div class="line"><a name="l01738"></a><span class="lineno"> 1738</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> j = 0; j &lt; nCols; ++j) {</div>
<div class="line"><a name="l01739"></a><span class="lineno"> 1739</span>&#160;        os &lt;&lt; (*this)(i,j)</div>
<div class="line"><a name="l01740"></a><span class="lineno"> 1740</span>&#160;           &lt;&lt; <span class="stringliteral">&quot; &quot;</span>;</div>
<div class="line"><a name="l01741"></a><span class="lineno"> 1741</span>&#160;      }</div>
<div class="line"><a name="l01742"></a><span class="lineno"> 1742</span>&#160;      os &lt;&lt; std::endl;</div>
<div class="line"><a name="l01743"></a><span class="lineno"> 1743</span>&#160;    }</div>
<div class="line"><a name="l01744"></a><span class="lineno"> 1744</span>&#160;  }</div>
<div class="line"><a name="l01745"></a><span class="lineno"> 1745</span>&#160;</div>
<div class="line"><a name="l01746"></a><span class="lineno"> 1746</span>&#160;  <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l01747"></a><span class="lineno"> 1747</span>&#160;}</div>
<div class="line"><a name="l01748"></a><span class="lineno"> 1748</span>&#160;<span class="comment">// ---------------------------------------------------</span></div>
<div class="line"><a name="l01749"></a><span class="lineno"> 1749</span>&#160;</div>
<div class="line"><a name="l01750"></a><span class="lineno"> 1750</span>&#160;<span class="keywordtype">void</span></div>
<div class="line"><a name="l01751"></a><span class="lineno"><a class="line" href="a00227.html#ac36155312f4cb51fbe4da2b89420b8d4"> 1751</a></span>&#160;<a class="code" href="a00227.html#ac36155312f4cb51fbe4da2b89420b8d4">TeuchosMatrix::subReadContents</a>(</div>
<div class="line"><a name="l01752"></a><span class="lineno"> 1752</span>&#160;  <span class="keyword">const</span> std::string&amp;            fileName,</div>
<div class="line"><a name="l01753"></a><span class="lineno"> 1753</span>&#160;  <span class="keyword">const</span> std::string&amp;            fileType,</div>
<div class="line"><a name="l01754"></a><span class="lineno"> 1754</span>&#160;  <span class="keyword">const</span> std::set&lt;unsigned int&gt;&amp; allowedSubEnvIds)</div>
<div class="line"><a name="l01755"></a><span class="lineno"> 1755</span>&#160;{</div>
<div class="line"><a name="l01756"></a><span class="lineno"> 1756</span>&#160;  queso_require_greater_equal_msg(<a class="code" href="a00164.html#a247fb0fc0b87fecdee054bb4660b68e8">m_env</a>.<a class="code" href="a00036.html#a172d52f993f1322ed45aaddf71518dbb">subRank</a>(), 0, <span class="stringliteral">&quot;unexpected subRank&quot;</span>);</div>
<div class="line"><a name="l01757"></a><span class="lineno"> 1757</span>&#160;</div>
<div class="line"><a name="l01758"></a><span class="lineno"> 1758</span>&#160;  queso_require_less_equal_msg(this-&gt;<a class="code" href="a00164.html#a7d7310149ecf33ca68c5ef7a815093db">numOfProcsForStorage</a>(), 1, <span class="stringliteral">&quot;implemented just for sequential vectors for now&quot;</span>);</div>
<div class="line"><a name="l01759"></a><span class="lineno"> 1759</span>&#160;</div>
<div class="line"><a name="l01760"></a><span class="lineno"> 1760</span>&#160;  <a class="code" href="a00086.html">FilePtrSetStruct</a> filePtrSet;</div>
<div class="line"><a name="l01761"></a><span class="lineno"> 1761</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="a00164.html#a247fb0fc0b87fecdee054bb4660b68e8">m_env</a>.<a class="code" href="a00036.html#a8a3f76733a31991a1ed9a942feb2dc3c">openInputFile</a>(fileName,</div>
<div class="line"><a name="l01762"></a><span class="lineno"> 1762</span>&#160;                          fileType, <span class="comment">// &quot;m or hdf&quot;</span></div>
<div class="line"><a name="l01763"></a><span class="lineno"> 1763</span>&#160;                          allowedSubEnvIds,</div>
<div class="line"><a name="l01764"></a><span class="lineno"> 1764</span>&#160;                          filePtrSet)) {</div>
<div class="line"><a name="l01765"></a><span class="lineno"> 1765</span>&#160;</div>
<div class="line"><a name="l01766"></a><span class="lineno"> 1766</span>&#160;    <span class="comment">// palms</span></div>
<div class="line"><a name="l01767"></a><span class="lineno"> 1767</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> nRowsLocal = this-&gt;<a class="code" href="a00227.html#a78a5b262967d31e6171aadd292e77395">numRowsLocal</a>();</div>
<div class="line"><a name="l01768"></a><span class="lineno"> 1768</span>&#160;</div>
<div class="line"><a name="l01769"></a><span class="lineno"> 1769</span>&#160;    <span class="comment">// In the logic below, the id of a line&#39; begins with value 0 (zero)</span></div>
<div class="line"><a name="l01770"></a><span class="lineno"> 1770</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> idOfMyFirstLine = 1;</div>
<div class="line"><a name="l01771"></a><span class="lineno"> 1771</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> idOfMyLastLine = nRowsLocal;</div>
<div class="line"><a name="l01772"></a><span class="lineno"> 1772</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> nCols = this-&gt;<a class="code" href="a00227.html#a6e3aa20d8c618718a9fa9cc56ff65b9f">numCols</a>();</div>
<div class="line"><a name="l01773"></a><span class="lineno"> 1773</span>&#160;</div>
<div class="line"><a name="l01774"></a><span class="lineno"> 1774</span>&#160;    <span class="comment">// Read number of matrix rows in the file by taking care of the first line,</span></div>
<div class="line"><a name="l01775"></a><span class="lineno"> 1775</span>&#160;    <span class="comment">// which resembles something like &#39;variable_name = zeros(n_rows,n_cols);&#39;</span></div>
<div class="line"><a name="l01776"></a><span class="lineno"> 1776</span>&#160;    std::string tmpString;</div>
<div class="line"><a name="l01777"></a><span class="lineno"> 1777</span>&#160;</div>
<div class="line"><a name="l01778"></a><span class="lineno"> 1778</span>&#160;    <span class="comment">// Read &#39;variable name&#39; string</span></div>
<div class="line"><a name="l01779"></a><span class="lineno"> 1779</span>&#160;    *filePtrSet.<a class="code" href="a00086.html#a1faa6ed0771368358c29a492edf764ee">ifsVar</a> &gt;&gt; tmpString;</div>
<div class="line"><a name="l01780"></a><span class="lineno"> 1780</span>&#160;</div>
<div class="line"><a name="l01781"></a><span class="lineno"> 1781</span>&#160;    <span class="comment">// Read &#39;=&#39; sign</span></div>
<div class="line"><a name="l01782"></a><span class="lineno"> 1782</span>&#160;    *filePtrSet.<a class="code" href="a00086.html#a1faa6ed0771368358c29a492edf764ee">ifsVar</a> &gt;&gt; tmpString;</div>
<div class="line"><a name="l01783"></a><span class="lineno"> 1783</span>&#160;</div>
<div class="line"><a name="l01784"></a><span class="lineno"> 1784</span>&#160;    <a class="code" href="a00674.html#ace699c1e7716717f330c783a58ebcd4f">queso_require_equal_to_msg</a>(tmpString, <span class="stringliteral">&quot;=&quot;</span>, <span class="stringliteral">&quot;string should be the &#39;=&#39; sign&quot;</span>);</div>
<div class="line"><a name="l01785"></a><span class="lineno"> 1785</span>&#160;</div>
<div class="line"><a name="l01786"></a><span class="lineno"> 1786</span>&#160;    <span class="comment">// Read &#39;zeros(n_rows,n_cols)&#39; string</span></div>
<div class="line"><a name="l01787"></a><span class="lineno"> 1787</span>&#160;    *filePtrSet.<a class="code" href="a00086.html#a1faa6ed0771368358c29a492edf764ee">ifsVar</a> &gt;&gt; tmpString;</div>
<div class="line"><a name="l01788"></a><span class="lineno"> 1788</span>&#160;</div>
<div class="line"><a name="l01789"></a><span class="lineno"> 1789</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> posInTmpString = 6;</div>
<div class="line"><a name="l01790"></a><span class="lineno"> 1790</span>&#160;</div>
<div class="line"><a name="l01791"></a><span class="lineno"> 1791</span>&#160;    <span class="comment">// Isolate &#39;n_rows&#39; in a string</span></div>
<div class="line"><a name="l01792"></a><span class="lineno"> 1792</span>&#160;    <span class="keywordtype">char</span> nRowsString[tmpString.size()-posInTmpString+1];</div>
<div class="line"><a name="l01793"></a><span class="lineno"> 1793</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> posInRowsString = 0;</div>
<div class="line"><a name="l01794"></a><span class="lineno"> 1794</span>&#160;    <span class="keywordflow">do</span> {</div>
<div class="line"><a name="l01795"></a><span class="lineno"> 1795</span>&#160;      queso_require_less_msg(posInTmpString, tmpString.size(), <span class="stringliteral">&quot;symbol &#39;,&#39; not found in first line of file&quot;</span>);</div>
<div class="line"><a name="l01796"></a><span class="lineno"> 1796</span>&#160;      nRowsString[posInRowsString++] = tmpString[posInTmpString++];</div>
<div class="line"><a name="l01797"></a><span class="lineno"> 1797</span>&#160;    } <span class="keywordflow">while</span> (tmpString[posInTmpString] != <span class="charliteral">&#39;,&#39;</span>);</div>
<div class="line"><a name="l01798"></a><span class="lineno"> 1798</span>&#160;    nRowsString[posInRowsString] = <span class="charliteral">&#39;\0&#39;</span>;</div>
<div class="line"><a name="l01799"></a><span class="lineno"> 1799</span>&#160;</div>
<div class="line"><a name="l01800"></a><span class="lineno"> 1800</span>&#160;    <span class="comment">// Isolate &#39;n_cols&#39; in a string</span></div>
<div class="line"><a name="l01801"></a><span class="lineno"> 1801</span>&#160;    posInTmpString++; <span class="comment">// Avoid reading &#39;,&#39; char</span></div>
<div class="line"><a name="l01802"></a><span class="lineno"> 1802</span>&#160;    <span class="keywordtype">char</span> nColsString[tmpString.size()-posInTmpString+1];</div>
<div class="line"><a name="l01803"></a><span class="lineno"> 1803</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> posInColsString = 0;</div>
<div class="line"><a name="l01804"></a><span class="lineno"> 1804</span>&#160;    <span class="keywordflow">do</span> {</div>
<div class="line"><a name="l01805"></a><span class="lineno"> 1805</span>&#160;      queso_require_less_msg(posInTmpString, tmpString.size(), <span class="stringliteral">&quot;symbol &#39;)&#39; not found in first line of file&quot;</span>);</div>
<div class="line"><a name="l01806"></a><span class="lineno"> 1806</span>&#160;      nColsString[posInColsString++] = tmpString[posInTmpString++];</div>
<div class="line"><a name="l01807"></a><span class="lineno"> 1807</span>&#160;    } <span class="keywordflow">while</span> (tmpString[posInTmpString] != <span class="charliteral">&#39;)&#39;</span>);</div>
<div class="line"><a name="l01808"></a><span class="lineno"> 1808</span>&#160;    nColsString[posInColsString] = <span class="charliteral">&#39;\0&#39;</span>;</div>
<div class="line"><a name="l01809"></a><span class="lineno"> 1809</span>&#160;</div>
<div class="line"><a name="l01810"></a><span class="lineno"> 1810</span>&#160;    <span class="comment">// Convert &#39;n_rows&#39; and &#39;n_cols&#39; strings to numbers</span></div>
<div class="line"><a name="l01811"></a><span class="lineno"> 1811</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> numRowsInFile = (<span class="keywordtype">unsigned</span> int) strtod(nRowsString,NULL);</div>
<div class="line"><a name="l01812"></a><span class="lineno"> 1812</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> numColsInFile = (<span class="keywordtype">unsigned</span> int) strtod(nColsString,NULL);</div>
<div class="line"><a name="l01813"></a><span class="lineno"> 1813</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="a00164.html#a247fb0fc0b87fecdee054bb4660b68e8">m_env</a>.<a class="code" href="a00036.html#a8a0064746ae8dddfece4229b9ad374d6">subDisplayFile</a>()) {</div>
<div class="line"><a name="l01814"></a><span class="lineno"> 1814</span>&#160;      *<a class="code" href="a00164.html#a247fb0fc0b87fecdee054bb4660b68e8">m_env</a>.<a class="code" href="a00036.html#a8a0064746ae8dddfece4229b9ad374d6">subDisplayFile</a>() &lt;&lt; <span class="stringliteral">&quot;In TeuchosMatrix::subReadContents()&quot;</span></div>
<div class="line"><a name="l01815"></a><span class="lineno"> 1815</span>&#160;                              &lt;&lt; <span class="stringliteral">&quot;: fullRank &quot;</span>        &lt;&lt; <a class="code" href="a00164.html#a247fb0fc0b87fecdee054bb4660b68e8">m_env</a>.<a class="code" href="a00036.html#a84a239e42ae443cf71db6e03e8159620">fullRank</a>()</div>
<div class="line"><a name="l01816"></a><span class="lineno"> 1816</span>&#160;                              &lt;&lt; <span class="stringliteral">&quot;, numRowsInFile = &quot;</span> &lt;&lt; numRowsInFile</div>
<div class="line"><a name="l01817"></a><span class="lineno"> 1817</span>&#160;                              &lt;&lt; <span class="stringliteral">&quot;, numColsInFile = &quot;</span> &lt;&lt; numColsInFile</div>
<div class="line"><a name="l01818"></a><span class="lineno"> 1818</span>&#160;                              &lt;&lt; <span class="stringliteral">&quot;, nRowsLocal = &quot;</span>    &lt;&lt; nRowsLocal</div>
<div class="line"><a name="l01819"></a><span class="lineno"> 1819</span>&#160;                              &lt;&lt; <span class="stringliteral">&quot;, nCols = &quot;</span>         &lt;&lt; nCols</div>
<div class="line"><a name="l01820"></a><span class="lineno"> 1820</span>&#160;                              &lt;&lt; std::endl;</div>
<div class="line"><a name="l01821"></a><span class="lineno"> 1821</span>&#160;    }</div>
<div class="line"><a name="l01822"></a><span class="lineno"> 1822</span>&#160;</div>
<div class="line"><a name="l01823"></a><span class="lineno"> 1823</span>&#160;    <span class="comment">// Check if [num of rows in file] == [requested matrix row size]</span></div>
<div class="line"><a name="l01824"></a><span class="lineno"> 1824</span>&#160;    <a class="code" href="a00674.html#ace699c1e7716717f330c783a58ebcd4f">queso_require_equal_to_msg</a>(numRowsInFile, nRowsLocal, <span class="stringliteral">&quot;size of vec in file is not big enough&quot;</span>);</div>
<div class="line"><a name="l01825"></a><span class="lineno"> 1825</span>&#160;</div>
<div class="line"><a name="l01826"></a><span class="lineno"> 1826</span>&#160;    <span class="comment">// Check if [num of cols in file] == [num cols in current matrix]</span></div>
<div class="line"><a name="l01827"></a><span class="lineno"> 1827</span>&#160;    <a class="code" href="a00674.html#ace699c1e7716717f330c783a58ebcd4f">queso_require_equal_to_msg</a>(numColsInFile, nCols, <span class="stringliteral">&quot;number of parameters of vec in file is different than number of parameters in this vec object&quot;</span>);</div>
<div class="line"><a name="l01828"></a><span class="lineno"> 1828</span>&#160;</div>
<div class="line"><a name="l01829"></a><span class="lineno"> 1829</span>&#160;    <span class="comment">// Code common to any core in a communicator</span></div>
<div class="line"><a name="l01830"></a><span class="lineno"> 1830</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> maxCharsPerLine = 64*nCols; <span class="comment">// Up to about 60 characters to represent each parameter value</span></div>
<div class="line"><a name="l01831"></a><span class="lineno"> 1831</span>&#160;</div>
<div class="line"><a name="l01832"></a><span class="lineno"> 1832</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> lineId = 0;</div>
<div class="line"><a name="l01833"></a><span class="lineno"> 1833</span>&#160;    <span class="keywordflow">while</span> (lineId &lt; idOfMyFirstLine) {</div>
<div class="line"><a name="l01834"></a><span class="lineno"> 1834</span>&#160;      filePtrSet.<a class="code" href="a00086.html#a1faa6ed0771368358c29a492edf764ee">ifsVar</a>-&gt;ignore(maxCharsPerLine,<span class="charliteral">&#39;\n&#39;</span>);</div>
<div class="line"><a name="l01835"></a><span class="lineno"> 1835</span>&#160;      lineId++;</div>
<div class="line"><a name="l01836"></a><span class="lineno"> 1836</span>&#160;    };</div>
<div class="line"><a name="l01837"></a><span class="lineno"> 1837</span>&#160;</div>
<div class="line"><a name="l01838"></a><span class="lineno"> 1838</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="a00164.html#a247fb0fc0b87fecdee054bb4660b68e8">m_env</a>.<a class="code" href="a00036.html#a8a0064746ae8dddfece4229b9ad374d6">subDisplayFile</a>()) {</div>
<div class="line"><a name="l01839"></a><span class="lineno"> 1839</span>&#160;      *<a class="code" href="a00164.html#a247fb0fc0b87fecdee054bb4660b68e8">m_env</a>.<a class="code" href="a00036.html#a8a0064746ae8dddfece4229b9ad374d6">subDisplayFile</a>() &lt;&lt; <span class="stringliteral">&quot;In TeuchosMatrix::subReadContents()&quot;</span></div>
<div class="line"><a name="l01840"></a><span class="lineno"> 1840</span>&#160;                              &lt;&lt; <span class="stringliteral">&quot;: beginning to read input actual data&quot;</span></div>
<div class="line"><a name="l01841"></a><span class="lineno"> 1841</span>&#160;                              &lt;&lt; std::endl;</div>
<div class="line"><a name="l01842"></a><span class="lineno"> 1842</span>&#160;    }</div>
<div class="line"><a name="l01843"></a><span class="lineno"> 1843</span>&#160;</div>
<div class="line"><a name="l01844"></a><span class="lineno"> 1844</span>&#160;    <span class="comment">// Take care of initial part of the first data line,</span></div>
<div class="line"><a name="l01845"></a><span class="lineno"> 1845</span>&#160;    <span class="comment">// which resembles something like &#39;variable_name = [value1 value2 ...&#39;</span></div>
<div class="line"><a name="l01846"></a><span class="lineno"> 1846</span>&#160;    <span class="comment">// Read &#39;variable name&#39; string</span></div>
<div class="line"><a name="l01847"></a><span class="lineno"> 1847</span>&#160;    *filePtrSet.<a class="code" href="a00086.html#a1faa6ed0771368358c29a492edf764ee">ifsVar</a> &gt;&gt; tmpString;</div>
<div class="line"><a name="l01848"></a><span class="lineno"> 1848</span>&#160;    <span class="comment">//std::cout &lt;&lt; &quot;Core 0 just read &#39;&quot; &lt;&lt; tmpString &lt;&lt; &quot;&#39;&quot; &lt;&lt; std::endl;</span></div>
<div class="line"><a name="l01849"></a><span class="lineno"> 1849</span>&#160;</div>
<div class="line"><a name="l01850"></a><span class="lineno"> 1850</span>&#160;    <span class="comment">// Read &#39;=&#39; sign</span></div>
<div class="line"><a name="l01851"></a><span class="lineno"> 1851</span>&#160;    *filePtrSet.<a class="code" href="a00086.html#a1faa6ed0771368358c29a492edf764ee">ifsVar</a> &gt;&gt; tmpString;</div>
<div class="line"><a name="l01852"></a><span class="lineno"> 1852</span>&#160;    <span class="comment">//std::cout &lt;&lt; &quot;Core 0 just read &#39;&quot; &lt;&lt; tmpString &lt;&lt; &quot;&#39;&quot; &lt;&lt; std::endl;</span></div>
<div class="line"><a name="l01853"></a><span class="lineno"> 1853</span>&#160;    <a class="code" href="a00674.html#ace699c1e7716717f330c783a58ebcd4f">queso_require_equal_to_msg</a>(tmpString, <span class="stringliteral">&quot;=&quot;</span>, <span class="stringliteral">&quot;in core 0, string should be the &#39;=&#39; sign&quot;</span>);</div>
<div class="line"><a name="l01854"></a><span class="lineno"> 1854</span>&#160;</div>
<div class="line"><a name="l01855"></a><span class="lineno"> 1855</span>&#160;    <span class="comment">// Take into account the &#39; [&#39; portion</span></div>
<div class="line"><a name="l01856"></a><span class="lineno"> 1856</span>&#160;    std::streampos tmpPos = filePtrSet.<a class="code" href="a00086.html#a1faa6ed0771368358c29a492edf764ee">ifsVar</a>-&gt;tellg();</div>
<div class="line"><a name="l01857"></a><span class="lineno"> 1857</span>&#160;    filePtrSet.<a class="code" href="a00086.html#a1faa6ed0771368358c29a492edf764ee">ifsVar</a>-&gt;seekg(tmpPos+(std::streampos)2);</div>
<div class="line"><a name="l01858"></a><span class="lineno"> 1858</span>&#160;</div>
<div class="line"><a name="l01859"></a><span class="lineno"> 1859</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="a00164.html#a247fb0fc0b87fecdee054bb4660b68e8">m_env</a>.<a class="code" href="a00036.html#a8a0064746ae8dddfece4229b9ad374d6">subDisplayFile</a>()) {</div>
<div class="line"><a name="l01860"></a><span class="lineno"> 1860</span>&#160;      *<a class="code" href="a00164.html#a247fb0fc0b87fecdee054bb4660b68e8">m_env</a>.<a class="code" href="a00036.html#a8a0064746ae8dddfece4229b9ad374d6">subDisplayFile</a>() &lt;&lt; <span class="stringliteral">&quot;In TeuchosMatrix::subReadContents()&quot;</span></div>
<div class="line"><a name="l01861"></a><span class="lineno"> 1861</span>&#160;                              &lt;&lt; <span class="stringliteral">&quot;: beginning to read lines with numbers only&quot;</span></div>
<div class="line"><a name="l01862"></a><span class="lineno"> 1862</span>&#160;                              &lt;&lt; <span class="stringliteral">&quot;, lineId = &quot;</span>          &lt;&lt; lineId</div>
<div class="line"><a name="l01863"></a><span class="lineno"> 1863</span>&#160;                              &lt;&lt; <span class="stringliteral">&quot;, idOfMyFirstLine = &quot;</span> &lt;&lt; idOfMyFirstLine</div>
<div class="line"><a name="l01864"></a><span class="lineno"> 1864</span>&#160;                              &lt;&lt; <span class="stringliteral">&quot;, idOfMyLastLine = &quot;</span>  &lt;&lt; idOfMyLastLine</div>
<div class="line"><a name="l01865"></a><span class="lineno"> 1865</span>&#160;                              &lt;&lt; std::endl;</div>
<div class="line"><a name="l01866"></a><span class="lineno"> 1866</span>&#160;    }</div>
<div class="line"><a name="l01867"></a><span class="lineno"> 1867</span>&#160;</div>
<div class="line"><a name="l01868"></a><span class="lineno"> 1868</span>&#160;    <span class="keywordtype">double</span> tmpRead;</div>
<div class="line"><a name="l01869"></a><span class="lineno"> 1869</span>&#160;    <span class="keywordflow">while</span> (lineId &lt;= idOfMyLastLine) {</div>
<div class="line"><a name="l01870"></a><span class="lineno"> 1870</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> j = 0; j &lt; nCols; ++j) {</div>
<div class="line"><a name="l01871"></a><span class="lineno"> 1871</span>&#160;        *filePtrSet.<a class="code" href="a00086.html#a1faa6ed0771368358c29a492edf764ee">ifsVar</a> &gt;&gt; tmpRead;</div>
<div class="line"><a name="l01872"></a><span class="lineno"> 1872</span>&#160;        (*this)(lineId-idOfMyFirstLine,j) = tmpRead;</div>
<div class="line"><a name="l01873"></a><span class="lineno"> 1873</span>&#160;      }</div>
<div class="line"><a name="l01874"></a><span class="lineno"> 1874</span>&#160;      lineId++;</div>
<div class="line"><a name="l01875"></a><span class="lineno"> 1875</span>&#160;    };</div>
<div class="line"><a name="l01876"></a><span class="lineno"> 1876</span>&#160;</div>
<div class="line"><a name="l01877"></a><span class="lineno"> 1877</span>&#160;    <a class="code" href="a00164.html#a247fb0fc0b87fecdee054bb4660b68e8">m_env</a>.<a class="code" href="a00036.html#ab712bff194ddd91459d4ea8715c77e8b">closeFile</a>(filePtrSet,fileType);</div>
<div class="line"><a name="l01878"></a><span class="lineno"> 1878</span>&#160;  }</div>
<div class="line"><a name="l01879"></a><span class="lineno"> 1879</span>&#160;</div>
<div class="line"><a name="l01880"></a><span class="lineno"> 1880</span>&#160;  <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l01881"></a><span class="lineno"> 1881</span>&#160;}</div>
<div class="line"><a name="l01882"></a><span class="lineno"> 1882</span>&#160;</div>
<div class="line"><a name="l01883"></a><span class="lineno"> 1883</span>&#160;<span class="comment">// ---------------------------------------------------</span></div>
<div class="line"><a name="l01884"></a><span class="lineno"> 1884</span>&#160;<span class="keywordtype">void</span></div>
<div class="line"><a name="l01885"></a><span class="lineno"><a class="line" href="a00227.html#a0dbe566341ac0c0fcf41cc0f0f69f5e9"> 1885</a></span>&#160;<a class="code" href="a00227.html#a0dbe566341ac0c0fcf41cc0f0f69f5e9">TeuchosMatrix::subWriteContents</a>(</div>
<div class="line"><a name="l01886"></a><span class="lineno"> 1886</span>&#160;  <span class="keyword">const</span> std::string&amp;            varNamePrefix,</div>
<div class="line"><a name="l01887"></a><span class="lineno"> 1887</span>&#160;  <span class="keyword">const</span> std::string&amp;            fileName,</div>
<div class="line"><a name="l01888"></a><span class="lineno"> 1888</span>&#160;  <span class="keyword">const</span> std::string&amp;            fileType,</div>
<div class="line"><a name="l01889"></a><span class="lineno"> 1889</span>&#160;  <span class="keyword">const</span> std::set&lt;unsigned int&gt;&amp; allowedSubEnvIds)<span class="keyword"> const</span></div>
<div class="line"><a name="l01890"></a><span class="lineno"> 1890</span>&#160;<span class="keyword"></span>{</div>
<div class="line"><a name="l01891"></a><span class="lineno"> 1891</span>&#160;  queso_require_greater_equal_msg(<a class="code" href="a00164.html#a247fb0fc0b87fecdee054bb4660b68e8">m_env</a>.<a class="code" href="a00036.html#a172d52f993f1322ed45aaddf71518dbb">subRank</a>(), 0, <span class="stringliteral">&quot;unexpected subRank&quot;</span>);</div>
<div class="line"><a name="l01892"></a><span class="lineno"> 1892</span>&#160;</div>
<div class="line"><a name="l01893"></a><span class="lineno"> 1893</span>&#160;  queso_require_less_equal_msg(this-&gt;<a class="code" href="a00164.html#a7d7310149ecf33ca68c5ef7a815093db">numOfProcsForStorage</a>(), 1, <span class="stringliteral">&quot;implemented just for sequential vectors for now&quot;</span>);</div>
<div class="line"><a name="l01894"></a><span class="lineno"> 1894</span>&#160;</div>
<div class="line"><a name="l01895"></a><span class="lineno"> 1895</span>&#160;  <a class="code" href="a00086.html">FilePtrSetStruct</a> filePtrSet;</div>
<div class="line"><a name="l01896"></a><span class="lineno"> 1896</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="a00164.html#a247fb0fc0b87fecdee054bb4660b68e8">m_env</a>.<a class="code" href="a00036.html#ab8fe853074f12ea34e18724119a2fc75">openOutputFile</a>(fileName,</div>
<div class="line"><a name="l01897"></a><span class="lineno"> 1897</span>&#160;                           fileType, <span class="comment">// &quot;m or hdf&quot;</span></div>
<div class="line"><a name="l01898"></a><span class="lineno"> 1898</span>&#160;                           allowedSubEnvIds,</div>
<div class="line"><a name="l01899"></a><span class="lineno"> 1899</span>&#160;                           <span class="keyword">false</span>,</div>
<div class="line"><a name="l01900"></a><span class="lineno"> 1900</span>&#160;                           filePtrSet)) {</div>
<div class="line"><a name="l01901"></a><span class="lineno"> 1901</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> nRows = this-&gt;<a class="code" href="a00227.html#a78a5b262967d31e6171aadd292e77395">numRowsLocal</a>();</div>
<div class="line"><a name="l01902"></a><span class="lineno"> 1902</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> nCols = this-&gt;<a class="code" href="a00227.html#a6e3aa20d8c618718a9fa9cc56ff65b9f">numCols</a>();</div>
<div class="line"><a name="l01903"></a><span class="lineno"> 1903</span>&#160;    *filePtrSet.<a class="code" href="a00086.html#a354cb0a6659254aa38ba38986ccf5c8a">ofsVar</a> &lt;&lt; varNamePrefix &lt;&lt; <span class="stringliteral">&quot;_sub&quot;</span> &lt;&lt; <a class="code" href="a00164.html#a247fb0fc0b87fecdee054bb4660b68e8">m_env</a>.<a class="code" href="a00036.html#a73f7849acdd5d5ba15a3094fe18f258f">subIdString</a>() &lt;&lt; <span class="stringliteral">&quot; = zeros(&quot;</span> &lt;&lt; nRows</div>
<div class="line"><a name="l01904"></a><span class="lineno"> 1904</span>&#160;                       &lt;&lt; <span class="stringliteral">&quot;,&quot;</span>                                                           &lt;&lt; nCols</div>
<div class="line"><a name="l01905"></a><span class="lineno"> 1905</span>&#160;                       &lt;&lt; <span class="stringliteral">&quot;);&quot;</span></div>
<div class="line"><a name="l01906"></a><span class="lineno"> 1906</span>&#160;                       &lt;&lt; std::endl;</div>
<div class="line"><a name="l01907"></a><span class="lineno"> 1907</span>&#160;    *filePtrSet.<a class="code" href="a00086.html#a354cb0a6659254aa38ba38986ccf5c8a">ofsVar</a> &lt;&lt; varNamePrefix &lt;&lt; <span class="stringliteral">&quot;_sub&quot;</span> &lt;&lt; <a class="code" href="a00164.html#a247fb0fc0b87fecdee054bb4660b68e8">m_env</a>.<a class="code" href="a00036.html#a73f7849acdd5d5ba15a3094fe18f258f">subIdString</a>() &lt;&lt; <span class="stringliteral">&quot; = [&quot;</span>;</div>
<div class="line"><a name="l01908"></a><span class="lineno"> 1908</span>&#160;</div>
<div class="line"><a name="l01909"></a><span class="lineno"> 1909</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = 0; i &lt; nRows; ++i) {</div>
<div class="line"><a name="l01910"></a><span class="lineno"> 1910</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> j = 0; j &lt; nCols; ++j) {</div>
<div class="line"><a name="l01911"></a><span class="lineno"> 1911</span>&#160;        *filePtrSet.<a class="code" href="a00086.html#a354cb0a6659254aa38ba38986ccf5c8a">ofsVar</a> &lt;&lt; (*this)(i,j)</div>
<div class="line"><a name="l01912"></a><span class="lineno"> 1912</span>&#160;                &lt;&lt; <span class="stringliteral">&quot; &quot;</span>;</div>
<div class="line"><a name="l01913"></a><span class="lineno"> 1913</span>&#160;      }</div>
<div class="line"><a name="l01914"></a><span class="lineno"> 1914</span>&#160;      *filePtrSet.<a class="code" href="a00086.html#a354cb0a6659254aa38ba38986ccf5c8a">ofsVar</a> &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l01915"></a><span class="lineno"> 1915</span>&#160;    }</div>
<div class="line"><a name="l01916"></a><span class="lineno"> 1916</span>&#160;    *filePtrSet.<a class="code" href="a00086.html#a354cb0a6659254aa38ba38986ccf5c8a">ofsVar</a> &lt;&lt; <span class="stringliteral">&quot;];\n&quot;</span>;</div>
<div class="line"><a name="l01917"></a><span class="lineno"> 1917</span>&#160;</div>
<div class="line"><a name="l01918"></a><span class="lineno"> 1918</span>&#160;    <a class="code" href="a00164.html#a247fb0fc0b87fecdee054bb4660b68e8">m_env</a>.<a class="code" href="a00036.html#ab712bff194ddd91459d4ea8715c77e8b">closeFile</a>(filePtrSet,fileType);</div>
<div class="line"><a name="l01919"></a><span class="lineno"> 1919</span>&#160;  }</div>
<div class="line"><a name="l01920"></a><span class="lineno"> 1920</span>&#160;</div>
<div class="line"><a name="l01921"></a><span class="lineno"> 1921</span>&#160;  <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l01922"></a><span class="lineno"> 1922</span>&#160;}</div>
<div class="line"><a name="l01923"></a><span class="lineno"> 1923</span>&#160;</div>
<div class="line"><a name="l01924"></a><span class="lineno"> 1924</span>&#160;<span class="comment">//====================================================</span></div>
<div class="line"><a name="l01925"></a><span class="lineno"> 1925</span>&#160;<span class="comment">// Private members</span></div>
<div class="line"><a name="l01926"></a><span class="lineno"> 1926</span>&#160;<span class="comment">//====================================================</span></div>
<div class="line"><a name="l01927"></a><span class="lineno"> 1927</span>&#160;</div>
<div class="line"><a name="l01928"></a><span class="lineno"> 1928</span>&#160;<span class="comment">// ---------------------------------------------------</span></div>
<div class="line"><a name="l01929"></a><span class="lineno"> 1929</span>&#160;<span class="comment">// Kemelli 12/05/12 - tested</span></div>
<div class="line"><a name="l01930"></a><span class="lineno"> 1930</span>&#160;<span class="keywordtype">void</span></div>
<div class="line"><a name="l01931"></a><span class="lineno"><a class="line" href="a00227.html#a1858cbb278b4cbfca8110133ed4ca19e"> 1931</a></span>&#160;<a class="code" href="a00227.html#a1858cbb278b4cbfca8110133ed4ca19e">TeuchosMatrix::copy</a>(<span class="keyword">const</span> <a class="code" href="a00227.html">TeuchosMatrix</a>&amp; src) <span class="comment">//dummy</span></div>
<div class="line"><a name="l01932"></a><span class="lineno"> 1932</span>&#160;{</div>
<div class="line"><a name="l01933"></a><span class="lineno"> 1933</span>&#160;  <span class="comment">// FIXME - should we be calling Matrix::base_copy here? - RHS</span></div>
<div class="line"><a name="l01934"></a><span class="lineno"> 1934</span>&#160;  this-&gt;<a class="code" href="a00227.html#ad2739933c700c0abb7d27aa094f49630">resetLU</a>();</div>
<div class="line"><a name="l01935"></a><span class="lineno"> 1935</span>&#160;  <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i,j, nrows=src.<a class="code" href="a00227.html#a78a5b262967d31e6171aadd292e77395">numRowsLocal</a>(), ncols=src.<a class="code" href="a00227.html#a6e3aa20d8c618718a9fa9cc56ff65b9f">numCols</a>();</div>
<div class="line"><a name="l01936"></a><span class="lineno"> 1936</span>&#160;</div>
<div class="line"><a name="l01937"></a><span class="lineno"> 1937</span>&#160;  <span class="keywordflow">for</span>(i=0; i&lt; nrows ; i++)</div>
<div class="line"><a name="l01938"></a><span class="lineno"> 1938</span>&#160;    <span class="keywordflow">for</span> (j = 0; j &lt; ncols; j++)</div>
<div class="line"><a name="l01939"></a><span class="lineno"> 1939</span>&#160;      <a class="code" href="a00227.html#a154931850614ec7597e9b134b7d9ffbb">m_mat</a>(i,j) = src(i,j);</div>
<div class="line"><a name="l01940"></a><span class="lineno"> 1940</span>&#160;</div>
<div class="line"><a name="l01941"></a><span class="lineno"> 1941</span>&#160;  <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l01942"></a><span class="lineno"> 1942</span>&#160;}</div>
<div class="line"><a name="l01943"></a><span class="lineno"> 1943</span>&#160;</div>
<div class="line"><a name="l01944"></a><span class="lineno"> 1944</span>&#160;<span class="comment">// ---------------------------------------------------</span></div>
<div class="line"><a name="l01945"></a><span class="lineno"> 1945</span>&#160;<span class="keywordtype">void</span></div>
<div class="line"><a name="l01946"></a><span class="lineno"><a class="line" href="a00227.html#ad2739933c700c0abb7d27aa094f49630"> 1946</a></span>&#160;<a class="code" href="a00227.html#ad2739933c700c0abb7d27aa094f49630">TeuchosMatrix::resetLU</a>()</div>
<div class="line"><a name="l01947"></a><span class="lineno"> 1947</span>&#160;{</div>
<div class="line"><a name="l01948"></a><span class="lineno"> 1948</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="a00227.html#a6df7300159f5ca3ff664ebca6e3c932f">m_LU</a>.numCols() &gt;0 || <a class="code" href="a00227.html#a6df7300159f5ca3ff664ebca6e3c932f">m_LU</a>.numRows() &gt; 0) {</div>
<div class="line"><a name="l01949"></a><span class="lineno"> 1949</span>&#160;    <a class="code" href="a00227.html#a6df7300159f5ca3ff664ebca6e3c932f">m_LU</a>.reshape(0,0); <span class="comment">//Kemelli, 12/06/12, dummy</span></div>
<div class="line"><a name="l01950"></a><span class="lineno"> 1950</span>&#160;  }</div>
<div class="line"><a name="l01951"></a><span class="lineno"> 1951</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="a00227.html#a4dc7e5ac8a92c5151771b785a7dfa8aa">m_inverse</a>) {</div>
<div class="line"><a name="l01952"></a><span class="lineno"> 1952</span>&#160;    <span class="keyword">delete</span> <a class="code" href="a00227.html#a4dc7e5ac8a92c5151771b785a7dfa8aa">m_inverse</a>;</div>
<div class="line"><a name="l01953"></a><span class="lineno"> 1953</span>&#160;    <a class="code" href="a00227.html#a4dc7e5ac8a92c5151771b785a7dfa8aa">m_inverse</a> = NULL;</div>
<div class="line"><a name="l01954"></a><span class="lineno"> 1954</span>&#160;  }</div>
<div class="line"><a name="l01955"></a><span class="lineno"> 1955</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="a00227.html#a05fe1849f60cf4057698d6ef0a80febf">m_svdColMap</a>) {</div>
<div class="line"><a name="l01956"></a><span class="lineno"> 1956</span>&#160;    <span class="keyword">delete</span> <a class="code" href="a00227.html#a05fe1849f60cf4057698d6ef0a80febf">m_svdColMap</a>;</div>
<div class="line"><a name="l01957"></a><span class="lineno"> 1957</span>&#160;    <a class="code" href="a00227.html#a05fe1849f60cf4057698d6ef0a80febf">m_svdColMap</a> = NULL;</div>
<div class="line"><a name="l01958"></a><span class="lineno"> 1958</span>&#160;  }</div>
<div class="line"><a name="l01959"></a><span class="lineno"> 1959</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="a00227.html#adae6a5fa59652c964e2d3893117bb95d">m_svdUmat</a>) {</div>
<div class="line"><a name="l01960"></a><span class="lineno"> 1960</span>&#160;    <span class="keyword">delete</span> <a class="code" href="a00227.html#adae6a5fa59652c964e2d3893117bb95d">m_svdUmat</a>;</div>
<div class="line"><a name="l01961"></a><span class="lineno"> 1961</span>&#160;    <a class="code" href="a00227.html#adae6a5fa59652c964e2d3893117bb95d">m_svdUmat</a> = NULL;</div>
<div class="line"><a name="l01962"></a><span class="lineno"> 1962</span>&#160;  }</div>
<div class="line"><a name="l01963"></a><span class="lineno"> 1963</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="a00227.html#a7b20f299e99f5bbe86053ca5c720f9f7">m_svdSvec</a>) {</div>
<div class="line"><a name="l01964"></a><span class="lineno"> 1964</span>&#160;    <span class="keyword">delete</span> <a class="code" href="a00227.html#a7b20f299e99f5bbe86053ca5c720f9f7">m_svdSvec</a>;</div>
<div class="line"><a name="l01965"></a><span class="lineno"> 1965</span>&#160;    <a class="code" href="a00227.html#a7b20f299e99f5bbe86053ca5c720f9f7">m_svdSvec</a> = NULL;</div>
<div class="line"><a name="l01966"></a><span class="lineno"> 1966</span>&#160;  }</div>
<div class="line"><a name="l01967"></a><span class="lineno"> 1967</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="a00227.html#a38aebd6933884dd1dccdb140227092b6">m_svdVmat</a>) {</div>
<div class="line"><a name="l01968"></a><span class="lineno"> 1968</span>&#160;    <span class="keyword">delete</span> <a class="code" href="a00227.html#a38aebd6933884dd1dccdb140227092b6">m_svdVmat</a>;</div>
<div class="line"><a name="l01969"></a><span class="lineno"> 1969</span>&#160;    <a class="code" href="a00227.html#a38aebd6933884dd1dccdb140227092b6">m_svdVmat</a> = NULL;</div>
<div class="line"><a name="l01970"></a><span class="lineno"> 1970</span>&#160;  }</div>
<div class="line"><a name="l01971"></a><span class="lineno"> 1971</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="a00227.html#a50e1d16f2e2b7045157c5596ca240be1">m_svdVTmat</a>) {</div>
<div class="line"><a name="l01972"></a><span class="lineno"> 1972</span>&#160;    <span class="keyword">delete</span> <a class="code" href="a00227.html#a50e1d16f2e2b7045157c5596ca240be1">m_svdVTmat</a>;</div>
<div class="line"><a name="l01973"></a><span class="lineno"> 1973</span>&#160;    <a class="code" href="a00227.html#a50e1d16f2e2b7045157c5596ca240be1">m_svdVTmat</a> = NULL;</div>
<div class="line"><a name="l01974"></a><span class="lineno"> 1974</span>&#160;  }</div>
<div class="line"><a name="l01975"></a><span class="lineno"> 1975</span>&#160;  <a class="code" href="a00227.html#a8e80ebb3c4e6720bf35c5f5a214a3c1f">m_determinant</a>   = -INFINITY;</div>
<div class="line"><a name="l01976"></a><span class="lineno"> 1976</span>&#160;  <a class="code" href="a00227.html#a665ce7c3ecf4ba47c8b00ffebd06f438">m_lnDeterminant</a> = -INFINITY;</div>
<div class="line"><a name="l01977"></a><span class="lineno"> 1977</span>&#160;</div>
<div class="line"><a name="l01978"></a><span class="lineno"> 1978</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="a00227.html#af81bb8e0e3c02a248b8cdf87fc13fd2a">v_pivoting</a>) {  <span class="comment">//Kemelli added 12/09/12</span></div>
<div class="line"><a name="l01979"></a><span class="lineno"> 1979</span>&#160;    free(<a class="code" href="a00227.html#af81bb8e0e3c02a248b8cdf87fc13fd2a">v_pivoting</a>);</div>
<div class="line"><a name="l01980"></a><span class="lineno"> 1980</span>&#160;    <a class="code" href="a00227.html#af81bb8e0e3c02a248b8cdf87fc13fd2a">v_pivoting</a> = NULL;</div>
<div class="line"><a name="l01981"></a><span class="lineno"> 1981</span>&#160;</div>
<div class="line"><a name="l01982"></a><span class="lineno"> 1982</span>&#160;  }</div>
<div class="line"><a name="l01983"></a><span class="lineno"> 1983</span>&#160;  <a class="code" href="a00227.html#aac0e4aaade72d002c9b43f9a01e7020c">m_signum</a> = 0;</div>
<div class="line"><a name="l01984"></a><span class="lineno"> 1984</span>&#160;  <a class="code" href="a00227.html#afb82d09e20c32f15e4b4a490efedab9b">m_isSingular</a> = <span class="keyword">false</span>;</div>
<div class="line"><a name="l01985"></a><span class="lineno"> 1985</span>&#160;</div>
<div class="line"><a name="l01986"></a><span class="lineno"> 1986</span>&#160;  <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l01987"></a><span class="lineno"> 1987</span>&#160;}</div>
<div class="line"><a name="l01988"></a><span class="lineno"> 1988</span>&#160;</div>
<div class="line"><a name="l01989"></a><span class="lineno"> 1989</span>&#160;<span class="comment">// ---------------------------------------------------</span></div>
<div class="line"><a name="l01990"></a><span class="lineno"> 1990</span>&#160;<span class="comment">// multiply this matrix by vector x and store in vector y</span></div>
<div class="line"><a name="l01991"></a><span class="lineno"> 1991</span>&#160;<span class="comment">// checked 12/10/12</span></div>
<div class="line"><a name="l01992"></a><span class="lineno"> 1992</span>&#160;<span class="keywordtype">void</span></div>
<div class="line"><a name="l01993"></a><span class="lineno"><a class="line" href="a00227.html#a4c2f3b34a0a4ad2a15e58b72c036bc01"> 1993</a></span>&#160;<a class="code" href="a00227.html#a2ce0ab6dfd8ef4d82caddd4d052218f5">TeuchosMatrix::multiply</a>(<span class="keyword">const</span> <a class="code" href="a00228.html">TeuchosVector</a>&amp; x, <a class="code" href="a00228.html">TeuchosVector</a>&amp; y)<span class="keyword"> const</span></div>
<div class="line"><a name="l01994"></a><span class="lineno"> 1994</span>&#160;<span class="keyword"></span>{</div>
<div class="line"><a name="l01995"></a><span class="lineno"> 1995</span>&#160;  <a class="code" href="a00674.html#ace699c1e7716717f330c783a58ebcd4f">queso_require_equal_to_msg</a>(this-&gt;<a class="code" href="a00227.html#a6e3aa20d8c618718a9fa9cc56ff65b9f">numCols</a>(), x.<a class="code" href="a00228.html#aa1d2726c42a9c317898e348fafca6998">sizeLocal</a>(), <span class="stringliteral">&quot;matrix and x have incompatible sizes&quot;</span>);</div>
<div class="line"><a name="l01996"></a><span class="lineno"> 1996</span>&#160;</div>
<div class="line"><a name="l01997"></a><span class="lineno"> 1997</span>&#160;  <a class="code" href="a00674.html#ace699c1e7716717f330c783a58ebcd4f">queso_require_equal_to_msg</a>(this-&gt;<a class="code" href="a00227.html#a78a5b262967d31e6171aadd292e77395">numRowsLocal</a>(), y.<a class="code" href="a00228.html#aa1d2726c42a9c317898e348fafca6998">sizeLocal</a>(), <span class="stringliteral">&quot;matrix and y have incompatible sizes&quot;</span>);</div>
<div class="line"><a name="l01998"></a><span class="lineno"> 1998</span>&#160;</div>
<div class="line"><a name="l01999"></a><span class="lineno"> 1999</span>&#160;  <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> sizeX = this-&gt;<a class="code" href="a00227.html#a6e3aa20d8c618718a9fa9cc56ff65b9f">numCols</a>();</div>
<div class="line"><a name="l02000"></a><span class="lineno"> 2000</span>&#160;  <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> sizeY = this-&gt;<a class="code" href="a00227.html#a78a5b262967d31e6171aadd292e77395">numRowsLocal</a>();</div>
<div class="line"><a name="l02001"></a><span class="lineno"> 2001</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = 0; i &lt; sizeY; ++i) {</div>
<div class="line"><a name="l02002"></a><span class="lineno"> 2002</span>&#160;    <span class="keywordtype">double</span> value = 0.;</div>
<div class="line"><a name="l02003"></a><span class="lineno"> 2003</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> j = 0; j &lt; sizeX; ++j) {</div>
<div class="line"><a name="l02004"></a><span class="lineno"> 2004</span>&#160;      value += (*this)(i,j)*x[j];</div>
<div class="line"><a name="l02005"></a><span class="lineno"> 2005</span>&#160;    }</div>
<div class="line"><a name="l02006"></a><span class="lineno"> 2006</span>&#160;    y[i] = value;</div>
<div class="line"><a name="l02007"></a><span class="lineno"> 2007</span>&#160;  }</div>
<div class="line"><a name="l02008"></a><span class="lineno"> 2008</span>&#160;</div>
<div class="line"><a name="l02009"></a><span class="lineno"> 2009</span>&#160;  <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l02010"></a><span class="lineno"> 2010</span>&#160;}</div>
<div class="line"><a name="l02011"></a><span class="lineno"> 2011</span>&#160;</div>
<div class="line"><a name="l02012"></a><span class="lineno"> 2012</span>&#160;<span class="comment">// ---------------------------------------------------</span></div>
<div class="line"><a name="l02013"></a><span class="lineno"> 2013</span>&#160;<span class="comment">// Implemented(finally) and checked 1/10/13</span></div>
<div class="line"><a name="l02014"></a><span class="lineno"> 2014</span>&#160;<span class="keywordtype">int</span></div>
<div class="line"><a name="l02015"></a><span class="lineno"><a class="line" href="a00227.html#a6a0ed6fd46f5b06c571a59f6678a3380"> 2015</a></span>&#160;<a class="code" href="a00227.html#a6a0ed6fd46f5b06c571a59f6678a3380">TeuchosMatrix::internalSvd</a>()<span class="keyword"> const</span></div>
<div class="line"><a name="l02016"></a><span class="lineno"> 2016</span>&#160;<span class="keyword"></span>{</div>
<div class="line"><a name="l02017"></a><span class="lineno"> 2017</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="a00227.html#a05fe1849f60cf4057698d6ef0a80febf">m_svdColMap</a> == NULL) {</div>
<div class="line"><a name="l02018"></a><span class="lineno"> 2018</span>&#160;    <span class="keywordtype">int</span> nRows = (int) this-&gt;<a class="code" href="a00227.html#a78a5b262967d31e6171aadd292e77395">numRowsLocal</a>();</div>
<div class="line"><a name="l02019"></a><span class="lineno"> 2019</span>&#160;    <span class="keywordtype">int</span> nCols = (int) this-&gt;<a class="code" href="a00227.html#a6e3aa20d8c618718a9fa9cc56ff65b9f">numCols</a>();</div>
<div class="line"><a name="l02020"></a><span class="lineno"> 2020</span>&#160;    queso_require_greater_equal_msg(nRows, nCols, <span class="stringliteral">&quot;LAPACK/Teuchos only supports cases where nRows &gt;= nCols&quot;</span>);</div>
<div class="line"><a name="l02021"></a><span class="lineno"> 2021</span>&#160;</div>
<div class="line"><a name="l02022"></a><span class="lineno"> 2022</span>&#160;    <a class="code" href="a00227.html#a05fe1849f60cf4057698d6ef0a80febf">m_svdColMap</a> = <span class="keyword">new</span> <a class="code" href="a00162.html">Map</a>(this-&gt;<a class="code" href="a00227.html#a6e3aa20d8c618718a9fa9cc56ff65b9f">numCols</a>(),0,this-&gt;<a class="code" href="a00164.html#ae01c72255466cd95201bb4c7f07e1b83">map</a>().Comm()); <span class="comment">// see &#39;VectorSpace&lt;.,.&gt;::newMap()&#39;</span></div>
<div class="line"><a name="l02023"></a><span class="lineno"> 2023</span>&#160;  <span class="comment">//in src/basic/src/TeuchosVectorSpace.C //old comment already existent in GslMatrix</span></div>
<div class="line"><a name="l02024"></a><span class="lineno"> 2024</span>&#160;    <a class="code" href="a00227.html#adae6a5fa59652c964e2d3893117bb95d">m_svdUmat</a>   = <span class="keyword">new</span> <a class="code" href="a00227.html#a1c93b3054debeb1277a4ef0d06a6001d">TeuchosMatrix</a>(*<span class="keyword">this</span>); <span class="comment">// Yes, &#39;this&#39;</span></div>
<div class="line"><a name="l02025"></a><span class="lineno"> 2025</span>&#160;    <a class="code" href="a00227.html#a7b20f299e99f5bbe86053ca5c720f9f7">m_svdSvec</a>   = <span class="keyword">new</span> <a class="code" href="a00228.html">TeuchosVector</a>(<a class="code" href="a00164.html#a247fb0fc0b87fecdee054bb4660b68e8">m_env</a>,*<a class="code" href="a00227.html#a05fe1849f60cf4057698d6ef0a80febf">m_svdColMap</a>);</div>
<div class="line"><a name="l02026"></a><span class="lineno"> 2026</span>&#160;    <a class="code" href="a00227.html#a38aebd6933884dd1dccdb140227092b6">m_svdVmat</a>   = <span class="keyword">new</span> <a class="code" href="a00227.html#a1c93b3054debeb1277a4ef0d06a6001d">TeuchosMatrix</a>(*<a class="code" href="a00227.html#a7b20f299e99f5bbe86053ca5c720f9f7">m_svdSvec</a>);</div>
<div class="line"><a name="l02027"></a><span class="lineno"> 2027</span>&#160;    <a class="code" href="a00227.html#a50e1d16f2e2b7045157c5596ca240be1">m_svdVTmat</a>  = <span class="keyword">new</span> <a class="code" href="a00227.html#a1c93b3054debeb1277a4ef0d06a6001d">TeuchosMatrix</a>(*<a class="code" href="a00227.html#a7b20f299e99f5bbe86053ca5c720f9f7">m_svdSvec</a>);</div>
<div class="line"><a name="l02028"></a><span class="lineno"> 2028</span>&#160;</div>
<div class="line"><a name="l02029"></a><span class="lineno"> 2029</span>&#160;    <span class="keywordtype">int</span> minRowsCols, maxRowsCols;</div>
<div class="line"><a name="l02030"></a><span class="lineno"> 2030</span>&#160;</div>
<div class="line"><a name="l02031"></a><span class="lineno"> 2031</span>&#160;    <span class="keywordflow">if</span> (nRows&gt;=nCols) { minRowsCols = nCols; maxRowsCols = nRows; } <span class="keywordflow">else</span> { minRowsCols = nRows; maxRowsCols = nCols; }</div>
<div class="line"><a name="l02032"></a><span class="lineno"> 2032</span>&#160;</div>
<div class="line"><a name="l02033"></a><span class="lineno"> 2033</span>&#160;    <span class="keywordtype">char</span> jobu, jobvt;</div>
<div class="line"><a name="l02034"></a><span class="lineno"> 2034</span>&#160;    <span class="keywordtype">int</span>  lwork, info;</div>
<div class="line"><a name="l02035"></a><span class="lineno"> 2035</span>&#160;    <span class="keywordtype">double</span>  *<a class="code" href="a00311.html#afdb0a747f08804b5ae928e34146db865">work</a>, *rwork;</div>
<div class="line"><a name="l02036"></a><span class="lineno"> 2036</span>&#160;</div>
<div class="line"><a name="l02037"></a><span class="lineno"> 2037</span>&#160;    jobu = <span class="charliteral">&#39;S&#39;</span>;</div>
<div class="line"><a name="l02038"></a><span class="lineno"> 2038</span>&#160;    jobvt = <span class="charliteral">&#39;S&#39;</span>;</div>
<div class="line"><a name="l02039"></a><span class="lineno"> 2039</span>&#160;</div>
<div class="line"><a name="l02040"></a><span class="lineno"> 2040</span>&#160;    lwork = 15*maxRowsCols; <span class="comment">// Set up the work array, larger than needed.</span></div>
<div class="line"><a name="l02041"></a><span class="lineno"> 2041</span>&#160;    work = <span class="keyword">new</span> <span class="keywordtype">double</span>[lwork];</div>
<div class="line"><a name="l02042"></a><span class="lineno"> 2042</span>&#160;</div>
<div class="line"><a name="l02043"></a><span class="lineno"> 2043</span>&#160;    <span class="keywordtype">int</span> aux1= 5*minRowsCols+7, aux2= 2*maxRowsCols+2*minRowsCols+1;</div>
<div class="line"><a name="l02044"></a><span class="lineno"> 2044</span>&#160;    <span class="keywordtype">int</span> aux_dim;</div>
<div class="line"><a name="l02045"></a><span class="lineno"> 2045</span>&#160;</div>
<div class="line"><a name="l02046"></a><span class="lineno"> 2046</span>&#160;    <span class="keywordflow">if</span> (aux1&gt;=aux2) { aux_dim = minRowsCols*aux1; } <span class="keywordflow">else</span> {aux_dim = minRowsCols*aux2; }</div>
<div class="line"><a name="l02047"></a><span class="lineno"> 2047</span>&#160;</div>
<div class="line"><a name="l02048"></a><span class="lineno"> 2048</span>&#160;    rwork = <span class="keyword">new</span> <span class="keywordtype">double</span>[aux_dim];</div>
<div class="line"><a name="l02049"></a><span class="lineno"> 2049</span>&#160;</div>
<div class="line"><a name="l02050"></a><span class="lineno"> 2050</span>&#160;    Teuchos::LAPACK&lt;int, double&gt; lapack;</div>
<div class="line"><a name="l02051"></a><span class="lineno"> 2051</span>&#160;</div>
<div class="line"><a name="l02052"></a><span class="lineno"> 2052</span>&#160;    lapack.GESVD(jobu,jobvt,<a class="code" href="a00227.html#a154931850614ec7597e9b134b7d9ffbb">m_mat</a>.numRows(),<a class="code" href="a00227.html#a154931850614ec7597e9b134b7d9ffbb">m_mat</a>.numCols(),<a class="code" href="a00227.html#a154931850614ec7597e9b134b7d9ffbb">m_mat</a>.values(),<a class="code" href="a00227.html#a154931850614ec7597e9b134b7d9ffbb">m_mat</a>.stride(),</div>
<div class="line"><a name="l02053"></a><span class="lineno"> 2053</span>&#160;                <a class="code" href="a00227.html#a7b20f299e99f5bbe86053ca5c720f9f7">m_svdSvec</a>-&gt;<a class="code" href="a00228.html#a2398f321692d661267a6e9dc5d249917">values</a>(),<a class="code" href="a00227.html#adae6a5fa59652c964e2d3893117bb95d">m_svdUmat</a>-&gt;<a class="code" href="a00227.html#a22c82a6fb78541a113f65753d9303448">values</a>(),<a class="code" href="a00227.html#adae6a5fa59652c964e2d3893117bb95d">m_svdUmat</a>-&gt;<a class="code" href="a00227.html#aaba42e724f7b422d69f6ebe1cb40d0df">stride</a>(),<a class="code" href="a00227.html#a50e1d16f2e2b7045157c5596ca240be1">m_svdVTmat</a>-&gt;<a class="code" href="a00227.html#a22c82a6fb78541a113f65753d9303448">values</a>(),</div>
<div class="line"><a name="l02054"></a><span class="lineno"> 2054</span>&#160;                <a class="code" href="a00227.html#a50e1d16f2e2b7045157c5596ca240be1">m_svdVTmat</a>-&gt;<a class="code" href="a00227.html#aaba42e724f7b422d69f6ebe1cb40d0df">stride</a>(),&amp;work[0],lwork,&amp;rwork[0],&amp;info);</div>
<div class="line"><a name="l02055"></a><span class="lineno"> 2055</span>&#160;  }</div>
<div class="line"><a name="l02056"></a><span class="lineno"> 2056</span>&#160;  <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l02057"></a><span class="lineno"> 2057</span>&#160;}</div>
<div class="line"><a name="l02058"></a><span class="lineno"> 2058</span>&#160;</div>
<div class="line"><a name="l02059"></a><span class="lineno"> 2059</span>&#160;</div>
<div class="line"><a name="l02060"></a><span class="lineno"> 2060</span>&#160;<span class="comment">//++++++++++++++++++++++++++++++++++++++++++++++++++++</span></div>
<div class="line"><a name="l02061"></a><span class="lineno"> 2061</span>&#160;<span class="comment">// Operators outside class definition</span></div>
<div class="line"><a name="l02062"></a><span class="lineno"> 2062</span>&#160;<span class="comment">//++++++++++++++++++++++++++++++++++++++++++++++++++++</span></div>
<div class="line"><a name="l02063"></a><span class="lineno"> 2063</span>&#160;</div>
<div class="line"><a name="l02064"></a><span class="lineno"><a class="line" href="a00674.html#a243a45955543eefad5eef1faae047b0c"> 2064</a></span>&#160;<a class="code" href="a00227.html">TeuchosMatrix</a> <a class="code" href="a00674.html#a1fa0d79f37a4fccc4c307456d29c4bfa">operator*</a>(<span class="keywordtype">double</span> a, <span class="keyword">const</span> <a class="code" href="a00227.html">TeuchosMatrix</a>&amp; mat)</div>
<div class="line"><a name="l02065"></a><span class="lineno"> 2065</span>&#160;{</div>
<div class="line"><a name="l02066"></a><span class="lineno"> 2066</span>&#160;  <a class="code" href="a00227.html">TeuchosMatrix</a> answer(mat);</div>
<div class="line"><a name="l02067"></a><span class="lineno"> 2067</span>&#160;  answer *= a;</div>
<div class="line"><a name="l02068"></a><span class="lineno"> 2068</span>&#160;  <span class="keywordflow">return</span> answer;</div>
<div class="line"><a name="l02069"></a><span class="lineno"> 2069</span>&#160;}</div>
<div class="line"><a name="l02070"></a><span class="lineno"> 2070</span>&#160;</div>
<div class="line"><a name="l02071"></a><span class="lineno"> 2071</span>&#160;<span class="comment">// ---------------------------------------------------</span></div>
<div class="line"><a name="l02072"></a><span class="lineno"><a class="line" href="a00674.html#af826b34a486e0f96f15ca72f45842613"> 2072</a></span>&#160;<a class="code" href="a00228.html">TeuchosVector</a> <a class="code" href="a00674.html#a1fa0d79f37a4fccc4c307456d29c4bfa">operator*</a>(<span class="keyword">const</span> <a class="code" href="a00227.html">TeuchosMatrix</a>&amp; mat, <span class="keyword">const</span> <a class="code" href="a00228.html">TeuchosVector</a>&amp; vec)</div>
<div class="line"><a name="l02073"></a><span class="lineno"> 2073</span>&#160;{</div>
<div class="line"><a name="l02074"></a><span class="lineno"> 2074</span>&#160;  <span class="keywordflow">return</span> mat.<a class="code" href="a00227.html#a2ce0ab6dfd8ef4d82caddd4d052218f5">multiply</a>(vec);</div>
<div class="line"><a name="l02075"></a><span class="lineno"> 2075</span>&#160;}</div>
<div class="line"><a name="l02076"></a><span class="lineno"> 2076</span>&#160;</div>
<div class="line"><a name="l02077"></a><span class="lineno"> 2077</span>&#160;<span class="comment">// ---------------------------------------------------</span></div>
<div class="line"><a name="l02078"></a><span class="lineno"><a class="line" href="a00674.html#ac12bdd592ef4c4397bac762beaf84d70"> 2078</a></span>&#160;<a class="code" href="a00227.html">TeuchosMatrix</a> <a class="code" href="a00674.html#a1fa0d79f37a4fccc4c307456d29c4bfa">operator*</a>(<span class="keyword">const</span> <a class="code" href="a00227.html">TeuchosMatrix</a>&amp; m1, <span class="keyword">const</span> <a class="code" href="a00227.html">TeuchosMatrix</a>&amp; m2)</div>
<div class="line"><a name="l02079"></a><span class="lineno"> 2079</span>&#160;{</div>
<div class="line"><a name="l02080"></a><span class="lineno"> 2080</span>&#160;  <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> m1Rows = m1.<a class="code" href="a00227.html#a78a5b262967d31e6171aadd292e77395">numRowsLocal</a>();</div>
<div class="line"><a name="l02081"></a><span class="lineno"> 2081</span>&#160;  <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> m1Cols = m1.<a class="code" href="a00227.html#a6e3aa20d8c618718a9fa9cc56ff65b9f">numCols</a>();</div>
<div class="line"><a name="l02082"></a><span class="lineno"> 2082</span>&#160;  <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> m2Rows = m2.<a class="code" href="a00227.html#a78a5b262967d31e6171aadd292e77395">numRowsLocal</a>();</div>
<div class="line"><a name="l02083"></a><span class="lineno"> 2083</span>&#160;  <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> m2Cols = m2.<a class="code" href="a00227.html#a6e3aa20d8c618718a9fa9cc56ff65b9f">numCols</a>();</div>
<div class="line"><a name="l02084"></a><span class="lineno"> 2084</span>&#160;</div>
<div class="line"><a name="l02085"></a><span class="lineno"> 2085</span>&#160;  <a class="code" href="a00674.html#ace699c1e7716717f330c783a58ebcd4f">queso_require_equal_to_msg</a>(m1Cols, m2Rows, <span class="stringliteral">&quot;different sizes m1Cols and m2Rows&quot;</span>);</div>
<div class="line"><a name="l02086"></a><span class="lineno"> 2086</span>&#160;</div>
<div class="line"><a name="l02087"></a><span class="lineno"> 2087</span>&#160;  <a class="code" href="a00227.html">TeuchosMatrix</a> mat(m1.<a class="code" href="a00164.html#a1eefeca9f35200e8275fb0fdfa0c8684">env</a>(),m1.<a class="code" href="a00164.html#ae01c72255466cd95201bb4c7f07e1b83">map</a>(),m2Cols);</div>
<div class="line"><a name="l02088"></a><span class="lineno"> 2088</span>&#160;  <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> commonSize = m1Cols;</div>
<div class="line"><a name="l02089"></a><span class="lineno"> 2089</span>&#160;</div>
<div class="line"><a name="l02090"></a><span class="lineno"> 2090</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> row1 = 0; row1 &lt; m1Rows; ++row1) {</div>
<div class="line"><a name="l02091"></a><span class="lineno"> 2091</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> col2 = 0; col2 &lt; m2Cols; ++col2) {</div>
<div class="line"><a name="l02092"></a><span class="lineno"> 2092</span>&#160;      <span class="keywordtype">double</span> result = 0.;</div>
<div class="line"><a name="l02093"></a><span class="lineno"> 2093</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="a00313.html#ab66ed8e0098c0a86b458672a55a9cca9">k</a> = 0; <a class="code" href="a00313.html#ab66ed8e0098c0a86b458672a55a9cca9">k</a> &lt; commonSize; ++<a class="code" href="a00313.html#ab66ed8e0098c0a86b458672a55a9cca9">k</a>) {</div>
<div class="line"><a name="l02094"></a><span class="lineno"> 2094</span>&#160;        result += m1(row1,<a class="code" href="a00313.html#ab66ed8e0098c0a86b458672a55a9cca9">k</a>)*m2(<a class="code" href="a00313.html#ab66ed8e0098c0a86b458672a55a9cca9">k</a>,col2);</div>
<div class="line"><a name="l02095"></a><span class="lineno"> 2095</span>&#160;      }</div>
<div class="line"><a name="l02096"></a><span class="lineno"> 2096</span>&#160;      mat(row1,col2) = result;</div>
<div class="line"><a name="l02097"></a><span class="lineno"> 2097</span>&#160;    }</div>
<div class="line"><a name="l02098"></a><span class="lineno"> 2098</span>&#160;  }</div>
<div class="line"><a name="l02099"></a><span class="lineno"> 2099</span>&#160;</div>
<div class="line"><a name="l02100"></a><span class="lineno"> 2100</span>&#160;  <span class="keywordflow">return</span> mat;</div>
<div class="line"><a name="l02101"></a><span class="lineno"> 2101</span>&#160;}</div>
<div class="line"><a name="l02102"></a><span class="lineno"> 2102</span>&#160;</div>
<div class="line"><a name="l02103"></a><span class="lineno"> 2103</span>&#160;<span class="comment">// ---------------------------------------------------</span></div>
<div class="line"><a name="l02104"></a><span class="lineno"><a class="line" href="a00674.html#a2194a830bfac3d18fb52c812a358c223"> 2104</a></span>&#160;<a class="code" href="a00227.html">TeuchosMatrix</a> <a class="code" href="a00674.html#a299d5db0d04a1d1a943b292585d01ad9">operator+</a>(<span class="keyword">const</span> <a class="code" href="a00227.html">TeuchosMatrix</a>&amp; m1, <span class="keyword">const</span> <a class="code" href="a00227.html">TeuchosMatrix</a>&amp; m2)</div>
<div class="line"><a name="l02105"></a><span class="lineno"> 2105</span>&#160;{</div>
<div class="line"><a name="l02106"></a><span class="lineno"> 2106</span>&#160;  <a class="code" href="a00227.html">TeuchosMatrix</a> answer(m1);</div>
<div class="line"><a name="l02107"></a><span class="lineno"> 2107</span>&#160;  answer += m2;</div>
<div class="line"><a name="l02108"></a><span class="lineno"> 2108</span>&#160;  <span class="keywordflow">return</span> answer;</div>
<div class="line"><a name="l02109"></a><span class="lineno"> 2109</span>&#160;}</div>
<div class="line"><a name="l02110"></a><span class="lineno"> 2110</span>&#160;</div>
<div class="line"><a name="l02111"></a><span class="lineno"> 2111</span>&#160;<span class="comment">// ---------------------------------------------------</span></div>
<div class="line"><a name="l02112"></a><span class="lineno"><a class="line" href="a00674.html#adb0322ab80680d0e0a9caf0a2a91049b"> 2112</a></span>&#160;<a class="code" href="a00227.html">TeuchosMatrix</a> <a class="code" href="a00674.html#a07502ec763e41daf33325dfbda9b0102">operator-</a>(<span class="keyword">const</span> <a class="code" href="a00227.html">TeuchosMatrix</a>&amp; m1, <span class="keyword">const</span> <a class="code" href="a00227.html">TeuchosMatrix</a>&amp; m2)</div>
<div class="line"><a name="l02113"></a><span class="lineno"> 2113</span>&#160;{</div>
<div class="line"><a name="l02114"></a><span class="lineno"> 2114</span>&#160;  <a class="code" href="a00227.html">TeuchosMatrix</a> answer(m1);</div>
<div class="line"><a name="l02115"></a><span class="lineno"> 2115</span>&#160;  answer -= m2;</div>
<div class="line"><a name="l02116"></a><span class="lineno"> 2116</span>&#160;  <span class="keywordflow">return</span> answer;</div>
<div class="line"><a name="l02117"></a><span class="lineno"> 2117</span>&#160;}</div>
<div class="line"><a name="l02118"></a><span class="lineno"> 2118</span>&#160;</div>
<div class="line"><a name="l02119"></a><span class="lineno"> 2119</span>&#160;<span class="comment">// ---------------------------------------------------</span></div>
<div class="line"><a name="l02120"></a><span class="lineno"><a class="line" href="a00674.html#a828307923d0ea185fc4da2cd01c38094"> 2120</a></span>&#160;<a class="code" href="a00227.html">TeuchosMatrix</a> <a class="code" href="a00674.html#aea04e232d5d3dd76349a85bb8acf9e17">matrixProduct</a>(<span class="keyword">const</span> <a class="code" href="a00228.html">TeuchosVector</a>&amp; v1, <span class="keyword">const</span> <a class="code" href="a00228.html">TeuchosVector</a>&amp; v2)</div>
<div class="line"><a name="l02121"></a><span class="lineno"> 2121</span>&#160;{</div>
<div class="line"><a name="l02122"></a><span class="lineno"> 2122</span>&#160;  <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> nRows = v1.<a class="code" href="a00228.html#aa1d2726c42a9c317898e348fafca6998">sizeLocal</a>();</div>
<div class="line"><a name="l02123"></a><span class="lineno"> 2123</span>&#160;  <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> nCols = v2.<a class="code" href="a00228.html#aa1d2726c42a9c317898e348fafca6998">sizeLocal</a>();</div>
<div class="line"><a name="l02124"></a><span class="lineno"> 2124</span>&#160;  <a class="code" href="a00227.html">TeuchosMatrix</a> answer(v1.<a class="code" href="a00246.html#a2e2952dab0554fedd8dc9a2543715745">env</a>(),v1.<a class="code" href="a00246.html#a0cbedc1f6e24c0ad3b688d201fd649a4">map</a>(),nCols);</div>
<div class="line"><a name="l02125"></a><span class="lineno"> 2125</span>&#160;</div>
<div class="line"><a name="l02126"></a><span class="lineno"> 2126</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = 0; i &lt; nRows; ++i) {</div>
<div class="line"><a name="l02127"></a><span class="lineno"> 2127</span>&#160;    <span class="keywordtype">double</span> value1 = v1[i];</div>
<div class="line"><a name="l02128"></a><span class="lineno"> 2128</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> j = 0; j &lt; nCols; ++j) {</div>
<div class="line"><a name="l02129"></a><span class="lineno"> 2129</span>&#160;      answer(i,j) = value1*v2[j];</div>
<div class="line"><a name="l02130"></a><span class="lineno"> 2130</span>&#160;    }</div>
<div class="line"><a name="l02131"></a><span class="lineno"> 2131</span>&#160;  }</div>
<div class="line"><a name="l02132"></a><span class="lineno"> 2132</span>&#160;</div>
<div class="line"><a name="l02133"></a><span class="lineno"> 2133</span>&#160;  <span class="keywordflow">return</span> answer;</div>
<div class="line"><a name="l02134"></a><span class="lineno"> 2134</span>&#160;}</div>
<div class="line"><a name="l02135"></a><span class="lineno"> 2135</span>&#160;</div>
<div class="line"><a name="l02136"></a><span class="lineno"> 2136</span>&#160;<span class="comment">// ---------------------------------------------------</span></div>
<div class="line"><a name="l02137"></a><span class="lineno"><a class="line" href="a00674.html#aa0355b349798b9aea2ff95ff5daffba4"> 2137</a></span>&#160;<a class="code" href="a00227.html">TeuchosMatrix</a> <a class="code" href="a00674.html#a0d18267f571a86516c0d9960b1a0f1c9">leftDiagScaling</a>(<span class="keyword">const</span> <a class="code" href="a00228.html">TeuchosVector</a>&amp; vec, <span class="keyword">const</span> <a class="code" href="a00227.html">TeuchosMatrix</a>&amp; mat)</div>
<div class="line"><a name="l02138"></a><span class="lineno"> 2138</span>&#160;{</div>
<div class="line"><a name="l02139"></a><span class="lineno"> 2139</span>&#160;  <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> vSize = vec.<a class="code" href="a00228.html#aa1d2726c42a9c317898e348fafca6998">sizeLocal</a>();</div>
<div class="line"><a name="l02140"></a><span class="lineno"> 2140</span>&#160;  <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> mRows = mat.<a class="code" href="a00227.html#a78a5b262967d31e6171aadd292e77395">numRowsLocal</a>();</div>
<div class="line"><a name="l02141"></a><span class="lineno"> 2141</span>&#160;  <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> mCols = mat.<a class="code" href="a00227.html#a6e3aa20d8c618718a9fa9cc56ff65b9f">numCols</a>();</div>
<div class="line"><a name="l02142"></a><span class="lineno"> 2142</span>&#160;</div>
<div class="line"><a name="l02143"></a><span class="lineno"> 2143</span>&#160;  <a class="code" href="a00674.html#ace699c1e7716717f330c783a58ebcd4f">queso_require_equal_to_msg</a>(vSize, mRows, <span class="stringliteral">&quot;size of vector is different from the number of rows in matrix&quot;</span>);</div>
<div class="line"><a name="l02144"></a><span class="lineno"> 2144</span>&#160;</div>
<div class="line"><a name="l02145"></a><span class="lineno"> 2145</span>&#160;  <a class="code" href="a00674.html#ace699c1e7716717f330c783a58ebcd4f">queso_require_equal_to_msg</a>(mCols, mRows, <span class="stringliteral">&quot;routine currently works for square matrices only&quot;</span>);</div>
<div class="line"><a name="l02146"></a><span class="lineno"> 2146</span>&#160;</div>
<div class="line"><a name="l02147"></a><span class="lineno"> 2147</span>&#160;  <a class="code" href="a00227.html">TeuchosMatrix</a> answer(mat);</div>
<div class="line"><a name="l02148"></a><span class="lineno"> 2148</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = 0; i &lt; mRows; ++i) {</div>
<div class="line"><a name="l02149"></a><span class="lineno"> 2149</span>&#160;    <span class="keywordtype">double</span> vecValue = vec[i];</div>
<div class="line"><a name="l02150"></a><span class="lineno"> 2150</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> j = 0; j &lt; mCols; ++j) {</div>
<div class="line"><a name="l02151"></a><span class="lineno"> 2151</span>&#160;      answer(i,j) *= vecValue;</div>
<div class="line"><a name="l02152"></a><span class="lineno"> 2152</span>&#160;    }</div>
<div class="line"><a name="l02153"></a><span class="lineno"> 2153</span>&#160;  }</div>
<div class="line"><a name="l02154"></a><span class="lineno"> 2154</span>&#160;</div>
<div class="line"><a name="l02155"></a><span class="lineno"> 2155</span>&#160;  <span class="keywordflow">return</span> answer;</div>
<div class="line"><a name="l02156"></a><span class="lineno"> 2156</span>&#160;}</div>
<div class="line"><a name="l02157"></a><span class="lineno"> 2157</span>&#160;</div>
<div class="line"><a name="l02158"></a><span class="lineno"> 2158</span>&#160;<span class="comment">// ---------------------------------------------------</span></div>
<div class="line"><a name="l02159"></a><span class="lineno"><a class="line" href="a00674.html#adc08f294ad27bc28285141d4b628c61e"> 2159</a></span>&#160;<a class="code" href="a00227.html">TeuchosMatrix</a> <a class="code" href="a00674.html#a2c87d8c1ab55355226086522f9fb7f83">rightDiagScaling</a>(<span class="keyword">const</span> <a class="code" href="a00227.html">TeuchosMatrix</a>&amp; mat, <span class="keyword">const</span> <a class="code" href="a00228.html">TeuchosVector</a>&amp; vec)</div>
<div class="line"><a name="l02160"></a><span class="lineno"> 2160</span>&#160;{</div>
<div class="line"><a name="l02161"></a><span class="lineno"> 2161</span>&#160;  <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> vSize = vec.<a class="code" href="a00228.html#aa1d2726c42a9c317898e348fafca6998">sizeLocal</a>();</div>
<div class="line"><a name="l02162"></a><span class="lineno"> 2162</span>&#160;  <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> mRows = mat.<a class="code" href="a00227.html#a78a5b262967d31e6171aadd292e77395">numRowsLocal</a>();</div>
<div class="line"><a name="l02163"></a><span class="lineno"> 2163</span>&#160;  <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> mCols = mat.<a class="code" href="a00227.html#a6e3aa20d8c618718a9fa9cc56ff65b9f">numCols</a>();</div>
<div class="line"><a name="l02164"></a><span class="lineno"> 2164</span>&#160;</div>
<div class="line"><a name="l02165"></a><span class="lineno"> 2165</span>&#160;  <a class="code" href="a00674.html#ace699c1e7716717f330c783a58ebcd4f">queso_require_equal_to_msg</a>(vSize, mCols, <span class="stringliteral">&quot;size of vector is different from the number of cols in matrix&quot;</span>);</div>
<div class="line"><a name="l02166"></a><span class="lineno"> 2166</span>&#160;</div>
<div class="line"><a name="l02167"></a><span class="lineno"> 2167</span>&#160;  <a class="code" href="a00674.html#ace699c1e7716717f330c783a58ebcd4f">queso_require_equal_to_msg</a>(mCols, mRows, <span class="stringliteral">&quot;routine currently works for square matrices only&quot;</span>);</div>
<div class="line"><a name="l02168"></a><span class="lineno"> 2168</span>&#160;</div>
<div class="line"><a name="l02169"></a><span class="lineno"> 2169</span>&#160;  <a class="code" href="a00227.html">TeuchosMatrix</a> answer(mat);</div>
<div class="line"><a name="l02170"></a><span class="lineno"> 2170</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> j = 0; j &lt; mCols; ++j) {</div>
<div class="line"><a name="l02171"></a><span class="lineno"> 2171</span>&#160;    <span class="keywordtype">double</span> vecValue = vec[j];</div>
<div class="line"><a name="l02172"></a><span class="lineno"> 2172</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = 0; i &lt; mRows; ++i) {</div>
<div class="line"><a name="l02173"></a><span class="lineno"> 2173</span>&#160;      answer(i,j) *= vecValue;</div>
<div class="line"><a name="l02174"></a><span class="lineno"> 2174</span>&#160;    }</div>
<div class="line"><a name="l02175"></a><span class="lineno"> 2175</span>&#160;  }</div>
<div class="line"><a name="l02176"></a><span class="lineno"> 2176</span>&#160;</div>
<div class="line"><a name="l02177"></a><span class="lineno"> 2177</span>&#160;  <span class="keywordflow">return</span> answer;</div>
<div class="line"><a name="l02178"></a><span class="lineno"> 2178</span>&#160;}</div>
<div class="line"><a name="l02179"></a><span class="lineno"> 2179</span>&#160;</div>
<div class="line"><a name="l02180"></a><span class="lineno"> 2180</span>&#160;<span class="comment">// ---------------------------------------------------</span></div>
<div class="line"><a name="l02181"></a><span class="lineno"> 2181</span>&#160;std::ostream&amp;</div>
<div class="line"><a name="l02182"></a><span class="lineno"><a class="line" href="a00674.html#a62744adb25ad203460c1c90b4db7bc8a"> 2182</a></span>&#160;<a class="code" href="a00674.html#ae619f31b9c8dff80e8eb44defeb52711">operator&lt;&lt;</a>(std::ostream&amp; os, <span class="keyword">const</span> <a class="code" href="a00227.html">TeuchosMatrix</a>&amp; obj)</div>
<div class="line"><a name="l02183"></a><span class="lineno"> 2183</span>&#160;{</div>
<div class="line"><a name="l02184"></a><span class="lineno"> 2184</span>&#160;  obj.<a class="code" href="a00227.html#a3f1a1e4d74f39bcef06cd1fc91a58656">print</a>(os);</div>
<div class="line"><a name="l02185"></a><span class="lineno"> 2185</span>&#160;</div>
<div class="line"><a name="l02186"></a><span class="lineno"> 2186</span>&#160;  <span class="keywordflow">return</span> os;</div>
<div class="line"><a name="l02187"></a><span class="lineno"> 2187</span>&#160;}</div>
<div class="line"><a name="l02188"></a><span class="lineno"> 2188</span>&#160;</div>
<div class="line"><a name="l02189"></a><span class="lineno"> 2189</span>&#160;}  <span class="comment">// End namespace QUESO</span></div>
<div class="line"><a name="l02190"></a><span class="lineno"> 2190</span>&#160;</div>
<div class="line"><a name="l02191"></a><span class="lineno"> 2191</span>&#160;<span class="preprocessor">#endif // ifdef QUESO_HAS_TRILINOS</span></div>
<div class="ttc" id="a00227_html_a8a6b19a4f686072a2b5416febef920d8"><div class="ttname"><a href="a00227.html#a8a6b19a4f686072a2b5416febef920d8">QUESO::TeuchosMatrix::setRow</a></div><div class="ttdeci">void setRow(const unsigned int row_num, const TeuchosVector &amp;row)</div><div class="ttdoc">This function copies vector row into the row_num-th column of this matrix. </div><div class="ttdef"><b>Definition:</b> <a href="a00431_source.html#l01301">TeuchosMatrix.C:1301</a></div></div>
<div class="ttc" id="a00227_html_a8b1592f739d3ae726449ab3d5d49843f"><div class="ttname"><a href="a00227.html#a8b1592f739d3ae726449ab3d5d49843f">QUESO::TeuchosMatrix::fillWithBlocksVertically</a></div><div class="ttdeci">void fillWithBlocksVertically(const std::vector&lt; const TeuchosMatrix * &gt; &amp;matrices)</div><div class="ttdoc">This function fills this matrix vertically with const block matrices. </div><div class="ttdef"><b>Definition:</b> <a href="a00431_source.html#l01553">TeuchosMatrix.C:1553</a></div></div>
<div class="ttc" id="a00227_html_ad4ebc8fd7d602eaa7178819d92e86556"><div class="ttname"><a href="a00227.html#ad4ebc8fd7d602eaa7178819d92e86556">QUESO::TeuchosMatrix::zeroUpper</a></div><div class="ttdeci">void zeroUpper(bool includeDiagonal=false)</div><div class="ttdoc">This function sets all the entries bellow the main diagonal (inclusive or not) of this matrix to zero...</div><div class="ttdef"><b>Definition:</b> <a href="a00431_source.html#l01347">TeuchosMatrix.C:1347</a></div></div>
<div class="ttc" id="a00227_html_a471d2629d244a87d0c2a58552da0c76b"><div class="ttname"><a href="a00227.html#a471d2629d244a87d0c2a58552da0c76b">QUESO::TeuchosMatrix::largestEigen</a></div><div class="ttdeci">void largestEigen(double &amp;eigenValue, TeuchosVector &amp;eigenVector) const </div><div class="ttdoc">This function finds largest eigenvalue, namely eigenValue, of this matrix and its corresponding eigen...</div><div class="ttdef"><b>Definition:</b> <a href="a00431_source.html#l01097">TeuchosMatrix.C:1097</a></div></div>
<div class="ttc" id="a00227_html_a2ce0ab6dfd8ef4d82caddd4d052218f5"><div class="ttname"><a href="a00227.html#a2ce0ab6dfd8ef4d82caddd4d052218f5">QUESO::TeuchosMatrix::multiply</a></div><div class="ttdeci">TeuchosVector multiply(const TeuchosVector &amp;x) const </div><div class="ttdoc">This function multiplies this matrix by vector x and returns a vector. </div><div class="ttdef"><b>Definition:</b> <a href="a00431_source.html#l00765">TeuchosMatrix.C:765</a></div></div>
<div class="ttc" id="a00227_html_a984606fc58d720fe0cb21345106e7c33"><div class="ttname"><a href="a00227.html#a984606fc58d720fe0cb21345106e7c33">QUESO::TeuchosMatrix::svdSolve</a></div><div class="ttdeci">int svdSolve(const TeuchosVector &amp;rhsVec, TeuchosVector &amp;solVec) const </div><div class="ttdoc">This function solves the system A x = b using the singular value decomposition (U, S, V) of A which must have been computed previously with TeuchosMatrix::svd (x=solVec, b=rhsVec). </div><div class="ttdef"><b>Definition:</b> <a href="a00431_source.html#l00667">TeuchosMatrix.C:667</a></div></div>
<div class="ttc" id="a00674_html_a299d5db0d04a1d1a943b292585d01ad9"><div class="ttname"><a href="a00674.html#a299d5db0d04a1d1a943b292585d01ad9">QUESO::operator+</a></div><div class="ttdeci">GslMatrix operator+(const GslMatrix &amp;m1, const GslMatrix &amp;m2)</div><div class="ttdef"><b>Definition:</b> <a href="a00409_source.html#l02022">GslMatrix.C:2022</a></div></div>
<div class="ttc" id="a00227_html_a4d97b7b6df41e465fc46a57c6a4f5cb7"><div class="ttname"><a href="a00227.html#a4d97b7b6df41e465fc46a57c6a4f5cb7">QUESO::TeuchosMatrix::matlabLinearInterpExtrap</a></div><div class="ttdeci">void matlabLinearInterpExtrap(const TeuchosVector &amp;x1Vec, const TeuchosMatrix &amp;y1Mat, const TeuchosVector &amp;x2Vec)</div><div class="ttdef"><b>Definition:</b> <a href="a00431_source.html#l01693">TeuchosMatrix.C:1693</a></div></div>
<div class="ttc" id="a00164_html_aebf5e44b149cf1454b2e12995d9f8b6b"><div class="ttname"><a href="a00164.html#aebf5e44b149cf1454b2e12995d9f8b6b">QUESO::Matrix::m_printHorizontally</a></div><div class="ttdeci">bool m_printHorizontally</div><div class="ttdoc">Flag for either or not print this matrix. </div><div class="ttdef"><b>Definition:</b> <a href="a00372_source.html#l00131">Matrix.h:131</a></div></div>
<div class="ttc" id="a00227_html_a154931850614ec7597e9b134b7d9ffbb"><div class="ttname"><a href="a00227.html#a154931850614ec7597e9b134b7d9ffbb">QUESO::TeuchosMatrix::m_mat</a></div><div class="ttdeci">Teuchos::SerialDenseMatrix&lt; int, double &gt; m_mat</div><div class="ttdoc">Teuchos matrix, also referred to as this matrix. </div><div class="ttdef"><b>Definition:</b> <a href="a00385_source.html#l00352">TeuchosMatrix.h:352</a></div></div>
<div class="ttc" id="a00162_html_ac67907266dcd7108ffe5a0cbef908781"><div class="ttname"><a href="a00162.html#ac67907266dcd7108ffe5a0cbef908781">QUESO::Map::NumGlobalElements</a></div><div class="ttdeci">int NumGlobalElements() const </div><div class="ttdoc">Returns the total number of elements across all processors. </div><div class="ttdef"><b>Definition:</b> <a href="a00420_source.html#l00085">Map.C:85</a></div></div>
<div class="ttc" id="a00227_html_aba7a03164e995005cc82e45b78975c19"><div class="ttname"><a href="a00227.html#aba7a03164e995005cc82e45b78975c19">QUESO::TeuchosMatrix::inverse</a></div><div class="ttdeci">TeuchosMatrix inverse() const </div><div class="ttdoc">This function calculates the inverse of this matrix (square). </div><div class="ttdef"><b>Definition:</b> <a href="a00431_source.html#l00392">TeuchosMatrix.C:392</a></div></div>
<div class="ttc" id="a00227_html_a4dc7e5ac8a92c5151771b785a7dfa8aa"><div class="ttname"><a href="a00227.html#a4dc7e5ac8a92c5151771b785a7dfa8aa">QUESO::TeuchosMatrix::m_inverse</a></div><div class="ttdeci">TeuchosMatrix * m_inverse</div><div class="ttdoc">Stores the inverse of this matrix. </div><div class="ttdef"><b>Definition:</b> <a href="a00385_source.html#l00358">TeuchosMatrix.h:358</a></div></div>
<div class="ttc" id="a00674_html_ae619f31b9c8dff80e8eb44defeb52711"><div class="ttname"><a href="a00674.html#ae619f31b9c8dff80e8eb44defeb52711">QUESO::operator&lt;&lt;</a></div><div class="ttdeci">std::ostream &amp; operator&lt;&lt;(std::ostream &amp;os, const SequenceStatisticalOptions &amp;obj)</div><div class="ttdef"><b>Definition:</b> <a href="a00298_source.html#l01457">SequenceStatisticalOptions.C:1457</a></div></div>
<div class="ttc" id="a00227_html"><div class="ttname"><a href="a00227.html">QUESO::TeuchosMatrix</a></div><div class="ttdoc">Class for matrix operations using Teuchos (Trilinos). </div><div class="ttdef"><b>Definition:</b> <a href="a00385_source.html#l00053">TeuchosMatrix.h:53</a></div></div>
<div class="ttc" id="a00086_html_a1faa6ed0771368358c29a492edf764ee"><div class="ttname"><a href="a00086.html#a1faa6ed0771368358c29a492edf764ee">QUESO::FilePtrSetStruct::ifsVar</a></div><div class="ttdeci">std::ifstream * ifsVar</div><div class="ttdoc">Provides a stream interface to read data from files. </div><div class="ttdef"><b>Definition:</b> <a href="a00353_source.html#l00089">Environment.h:89</a></div></div>
<div class="ttc" id="a00674_html_aae2cd8576f7d7d4de5543f13b8edc974"><div class="ttname"><a href="a00674.html#aae2cd8576f7d7d4de5543f13b8edc974">QUESO::queso_require_not_equal_to_msg</a></div><div class="ttdeci">MonteCarloSGOptions::MonteCarloSGOptions(const BaseEnvironment &amp;env, const char *prefix queso_require_not_equal_to_msg)(m_env.optionsInputFileName(), std::string(&quot;&quot;), std::string(&quot;this constructor is incompatible with the absence of an options input file&quot;))</div><div class="ttdef"><b>Definition:</b> <a href="a00624_source.html#l00417">MonteCarloSGOptions.C:417</a></div></div>
<div class="ttc" id="a00674_html_a533f41b58c01b7a3acb23dcfd25142a7"><div class="ttname"><a href="a00674.html#a533f41b58c01b7a3acb23dcfd25142a7">QUESO::size</a></div><div class="ttdeci">unsigned int size</div><div class="ttdef"><b>Definition:</b> <a href="a00635_source.html#l00122">StatisticalForwardProblemOptions.C:122</a></div></div>
<div class="ttc" id="a00227_html_a6e3aa20d8c618718a9fa9cc56ff65b9f"><div class="ttname"><a href="a00227.html#a6e3aa20d8c618718a9fa9cc56ff65b9f">QUESO::TeuchosMatrix::numCols</a></div><div class="ttdeci">unsigned int numCols() const </div><div class="ttdoc">Returns the column dimension of this matrix. </div><div class="ttdef"><b>Definition:</b> <a href="a00431_source.html#l00290">TeuchosMatrix.C:290</a></div></div>
<div class="ttc" id="a00164_html_a95e307c6e1263d505af0a43c35f81a8b"><div class="ttname"><a href="a00164.html#a95e307c6e1263d505af0a43c35f81a8b">QUESO::Matrix::m_map</a></div><div class="ttdeci">const Map m_map</div><div class="ttdoc">Mapping variable. </div><div class="ttdef"><b>Definition:</b> <a href="a00372_source.html#l00121">Matrix.h:121</a></div></div>
<div class="ttc" id="a00164_html_a3384d3fc1a1058fce9191b0d74653911"><div class="ttname"><a href="a00164.html#a3384d3fc1a1058fce9191b0d74653911">QUESO::Matrix::m_inDebugMode</a></div><div class="ttdeci">bool m_inDebugMode</div><div class="ttdoc">Flag for either or not QUESO is in debug mode. </div><div class="ttdef"><b>Definition:</b> <a href="a00372_source.html#l00134">Matrix.h:134</a></div></div>
<div class="ttc" id="a00227_html_af951a778007acf7992d8504bf29c8a89"><div class="ttname"><a href="a00227.html#af951a778007acf7992d8504bf29c8a89">QUESO::TeuchosMatrix::cwSet</a></div><div class="ttdeci">void cwSet(double value)</div><div class="ttdoc">Component-wise set all values to this with value. </div><div class="ttdef"><b>Definition:</b> <a href="a00431_source.html#l01189">TeuchosMatrix.C:1189</a></div></div>
<div class="ttc" id="a00227_html_ae343b697c04a1716ce73e69f7e4f61e6"><div class="ttname"><a href="a00227.html#ae343b697c04a1716ce73e69f7e4f61e6">QUESO::TeuchosMatrix::lnDeterminant</a></div><div class="ttdeci">double lnDeterminant() const </div><div class="ttdoc">Calculates the ln(determinant) of this matrix. </div><div class="ttdef"><b>Definition:</b> <a href="a00431_source.html#l00491">TeuchosMatrix.C:491</a></div></div>
<div class="ttc" id="a00164_html"><div class="ttname"><a href="a00164.html">QUESO::Matrix</a></div><div class="ttdoc">Class for matrix operations (virtual). </div><div class="ttdef"><b>Definition:</b> <a href="a00372_source.html#l00046">Matrix.h:46</a></div></div>
<div class="ttc" id="a00162_html"><div class="ttname"><a href="a00162.html">QUESO::Map</a></div><div class="ttdoc">A class for partitioning vectors and matrices. </div><div class="ttdef"><b>Definition:</b> <a href="a00371_source.html#l00049">Map.h:49</a></div></div>
<div class="ttc" id="a00227_html_a1db2c54c46debc003638605253eab5c6"><div class="ttname"><a href="a00227.html#a1db2c54c46debc003638605253eab5c6">QUESO::TeuchosMatrix::operator+=</a></div><div class="ttdeci">TeuchosMatrix &amp; operator+=(const TeuchosMatrix &amp;rhs)</div><div class="ttdoc">Stores in this the coordinate-wise addition of this and rhs. </div><div class="ttdef"><b>Definition:</b> <a href="a00431_source.html#l00212">TeuchosMatrix.C:212</a></div></div>
<div class="ttc" id="a00227_html_ad2739933c700c0abb7d27aa094f49630"><div class="ttname"><a href="a00227.html#ad2739933c700c0abb7d27aa094f49630">QUESO::TeuchosMatrix::resetLU</a></div><div class="ttdeci">void resetLU()</div><div class="ttdoc">In this function resets the LU decomposition of this matrix, as well as deletes the private member po...</div><div class="ttdef"><b>Definition:</b> <a href="a00431_source.html#l01946">TeuchosMatrix.C:1946</a></div></div>
<div class="ttc" id="a00227_html_a3f1a1e4d74f39bcef06cd1fc91a58656"><div class="ttname"><a href="a00227.html#a3f1a1e4d74f39bcef06cd1fc91a58656">QUESO::TeuchosMatrix::print</a></div><div class="ttdeci">void print(std::ostream &amp;os) const </div><div class="ttdoc">Print method. Defines the behavior of the ostream &amp;lt;&amp;lt; operator inherited from the Object class...</div><div class="ttdef"><b>Definition:</b> <a href="a00431_source.html#l01721">TeuchosMatrix.C:1721</a></div></div>
<div class="ttc" id="a00164_html_ae01c72255466cd95201bb4c7f07e1b83"><div class="ttname"><a href="a00164.html#ae01c72255466cd95201bb4c7f07e1b83">QUESO::Matrix::map</a></div><div class="ttdeci">const Map &amp; map() const </div><div class="ttdef"><b>Definition:</b> <a href="a00421_source.html#l00054">Matrix.C:54</a></div></div>
<div class="ttc" id="a00227_html_a9c476bcea87d63f4b984d05292f919ee"><div class="ttname"><a href="a00227.html#a9c476bcea87d63f4b984d05292f919ee">QUESO::TeuchosMatrix::fillWithBlocksDiagonally</a></div><div class="ttdeci">void fillWithBlocksDiagonally(const std::vector&lt; const TeuchosMatrix * &gt; &amp;matrices)</div><div class="ttdoc">This function fills this matrix diagonally with const block matrices. </div><div class="ttdef"><b>Definition:</b> <a href="a00431_source.html#l01439">TeuchosMatrix.C:1439</a></div></div>
<div class="ttc" id="a00227_html_afb82d09e20c32f15e4b4a490efedab9b"><div class="ttname"><a href="a00227.html#afb82d09e20c32f15e4b4a490efedab9b">QUESO::TeuchosMatrix::m_isSingular</a></div><div class="ttdeci">bool m_isSingular</div><div class="ttdoc">Indicates whether or not this matrix is singular. </div><div class="ttdef"><b>Definition:</b> <a href="a00385_source.html#l00390">TeuchosMatrix.h:390</a></div></div>
<div class="ttc" id="a00179_html"><div class="ttname"><a href="a00179.html">QUESO::MpiComm</a></div><div class="ttdoc">The QUESO MPI Communicator Class. </div><div class="ttdef"><b>Definition:</b> <a href="a00373_source.html#l00203">MpiComm.h:203</a></div></div>
<div class="ttc" id="a00036_html_a73f7849acdd5d5ba15a3094fe18f258f"><div class="ttname"><a href="a00036.html#a73f7849acdd5d5ba15a3094fe18f258f">QUESO::BaseEnvironment::subIdString</a></div><div class="ttdeci">const std::string &amp; subIdString() const </div><div class="ttdoc">Access to the attribute m_subIdString; which stores the string for the sub-environment, and it will be used, for instance, to create the output files for each sub-environment. </div><div class="ttdef"><b>Definition:</b> <a href="a00404_source.html#l00348">Environment.C:348</a></div></div>
<div class="ttc" id="a00227_html_ab7c5e29da5ac4d1e82015cf91171d4c0"><div class="ttname"><a href="a00227.html#ab7c5e29da5ac4d1e82015cf91171d4c0">QUESO::TeuchosMatrix::zeroLower</a></div><div class="ttdeci">void zeroLower(bool includeDiagonal=false)</div><div class="ttdoc">This function sets all the entries above the main diagonal (inclusive or not) of this matrix to zero...</div><div class="ttdef"><b>Definition:</b> <a href="a00431_source.html#l01318">TeuchosMatrix.C:1318</a></div></div>
<div class="ttc" id="a00313_html_ab66ed8e0098c0a86b458672a55a9cca9"><div class="ttname"><a href="a00313.html#ab66ed8e0098c0a86b458672a55a9cca9">k</a></div><div class="ttdeci">int k</div><div class="ttdef"><b>Definition:</b> <a href="a00313_source.html#l00053">ann_sample.cpp:53</a></div></div>
<div class="ttc" id="a00227_html_a3172e19749bd8821644142ea3b103223"><div class="ttname"><a href="a00227.html#a3172e19749bd8821644142ea3b103223">QUESO::TeuchosMatrix::fillWithBlocksHorizontally</a></div><div class="ttdeci">void fillWithBlocksHorizontally(const std::vector&lt; const TeuchosMatrix * &gt; &amp;matrices)</div><div class="ttdoc">This function fills this matrix horizontally with const block matrices. </div><div class="ttdef"><b>Definition:</b> <a href="a00431_source.html#l01499">TeuchosMatrix.C:1499</a></div></div>
<div class="ttc" id="a00227_html_a3215fb5daae7a4a13c4820ec8f7f9725"><div class="ttname"><a href="a00227.html#a3215fb5daae7a4a13c4820ec8f7f9725">QUESO::TeuchosMatrix::operator=</a></div><div class="ttdeci">TeuchosMatrix &amp; operator=(const TeuchosMatrix &amp;rhs)</div><div class="ttdoc">Copies values from matrix rhs to this. </div><div class="ttdef"><b>Definition:</b> <a href="a00431_source.html#l00183">TeuchosMatrix.C:183</a></div></div>
<div class="ttc" id="a00036_html_a84a239e42ae443cf71db6e03e8159620"><div class="ttname"><a href="a00036.html#a84a239e42ae443cf71db6e03e8159620">QUESO::BaseEnvironment::fullRank</a></div><div class="ttdeci">int fullRank() const </div><div class="ttdoc">Returns the rank of the MPI process in QUESO&amp;#39;s full communicator. </div><div class="ttdef"><b>Definition:</b> <a href="a00404_source.html#l00268">Environment.C:268</a></div></div>
<div class="ttc" id="a00227_html_af81bb8e0e3c02a248b8cdf87fc13fd2a"><div class="ttname"><a href="a00227.html#af81bb8e0e3c02a248b8cdf87fc13fd2a">QUESO::TeuchosMatrix::v_pivoting</a></div><div class="ttdeci">int * v_pivoting</div><div class="ttdoc">The pivoting vector of a LU decomposition. </div><div class="ttdef"><b>Definition:</b> <a href="a00385_source.html#l00384">TeuchosMatrix.h:384</a></div></div>
<div class="ttc" id="a00227_html_a6fd964946622f14f509fdf65c90538ee"><div class="ttname"><a href="a00227.html#a6fd964946622f14f509fdf65c90538ee">QUESO::TeuchosMatrix::operator/=</a></div><div class="ttdeci">TeuchosMatrix &amp; operator/=(double a)</div><div class="ttdoc">Stores in this the coordinate-wise division of this by a. </div><div class="ttdef"><b>Definition:</b> <a href="a00431_source.html#l00203">TeuchosMatrix.C:203</a></div></div>
<div class="ttc" id="a00227_html_ac2918edbd8b9ca1a931bd420ac45054e"><div class="ttname"><a href="a00227.html#ac2918edbd8b9ca1a931bd420ac45054e">QUESO::TeuchosMatrix::~TeuchosMatrix</a></div><div class="ttdeci">~TeuchosMatrix()</div><div class="ttdoc">Destructor. </div><div class="ttdef"><b>Definition:</b> <a href="a00431_source.html#l00174">TeuchosMatrix.C:174</a></div></div>
<div class="ttc" id="a00086_html_a354cb0a6659254aa38ba38986ccf5c8a"><div class="ttname"><a href="a00086.html#a354cb0a6659254aa38ba38986ccf5c8a">QUESO::FilePtrSetStruct::ofsVar</a></div><div class="ttdeci">std::ofstream * ofsVar</div><div class="ttdoc">Provides a stream interface to write data to files. </div><div class="ttdef"><b>Definition:</b> <a href="a00353_source.html#l00086">Environment.h:86</a></div></div>
<div class="ttc" id="a00227_html_aa6ea06ee3e2307d4f72bbea12933c919"><div class="ttname"><a href="a00227.html#aa6ea06ee3e2307d4f72bbea12933c919">QUESO::TeuchosMatrix::invertMultiplyForceLU</a></div><div class="ttdeci">void invertMultiplyForceLU(const TeuchosVector &amp;b, TeuchosVector &amp;x) const </div><div class="ttdoc">This function calculates the inverse of this matrix, multiplies it with vector b and stores the resul...</div><div class="ttdef"><b>Definition:</b> <a href="a00431_source.html#l00941">TeuchosMatrix.C:941</a></div></div>
<div class="ttc" id="a00674_html_a677863cd32092584175760250f39e8bb"><div class="ttname"><a href="a00674.html#a677863cd32092584175760250f39e8bb">QUESO::UQ_MATRIX_IS_NOT_POS_DEFINITE_RC</a></div><div class="ttdeci">const int UQ_MATRIX_IS_NOT_POS_DEFINITE_RC</div><div class="ttdef"><b>Definition:</b> <a href="a00351_source.html#l00100">Defines.h:100</a></div></div>
<div class="ttc" id="a00228_html_aa1d2726c42a9c317898e348fafca6998"><div class="ttname"><a href="a00228.html#aa1d2726c42a9c317898e348fafca6998">QUESO::TeuchosVector::sizeLocal</a></div><div class="ttdeci">unsigned int sizeLocal() const </div><div class="ttdoc">Returns the length of this vector. </div><div class="ttdef"><b>Definition:</b> <a href="a00432_source.html#l00249">TeuchosVector.C:249</a></div></div>
<div class="ttc" id="a00227_html_a78a5b262967d31e6171aadd292e77395"><div class="ttname"><a href="a00227.html#a78a5b262967d31e6171aadd292e77395">QUESO::TeuchosMatrix::numRowsLocal</a></div><div class="ttdeci">unsigned int numRowsLocal() const </div><div class="ttdoc">Returns the local row dimension of this matrix. </div><div class="ttdef"><b>Definition:</b> <a href="a00431_source.html#l00274">TeuchosMatrix.C:274</a></div></div>
<div class="ttc" id="a00228_html_ac8ec998ac054f3a726bb14d1df05e7d7"><div class="ttname"><a href="a00228.html#ac8ec998ac054f3a726bb14d1df05e7d7">QUESO::TeuchosVector::cwSet</a></div><div class="ttdeci">void cwSet(double value)</div><div class="ttdoc">Component-wise sets all values to this with value. </div><div class="ttdef"><b>Definition:</b> <a href="a00432_source.html#l00472">TeuchosVector.C:472</a></div></div>
<div class="ttc" id="a00227_html_aec68ff5ba30a3fbacad6e2c2ef278d07"><div class="ttname"><a href="a00227.html#aec68ff5ba30a3fbacad6e2c2ef278d07">QUESO::TeuchosMatrix::rank</a></div><div class="ttdeci">unsigned int rank(double absoluteZeroThreshold, double relativeZeroThreshold) const </div><div class="ttdoc">This function returns the number of singular values of this matrix (rank). </div><div class="ttdef"><b>Definition:</b> <a href="a00431_source.html#l00335">TeuchosMatrix.C:335</a></div></div>
<div class="ttc" id="a00036_html_ab8fe853074f12ea34e18724119a2fc75"><div class="ttname"><a href="a00036.html#ab8fe853074f12ea34e18724119a2fc75">QUESO::BaseEnvironment::openOutputFile</a></div><div class="ttdeci">bool openOutputFile(const std::string &amp;fileName, const std::string &amp;fileType, const std::set&lt; unsigned int &gt; &amp;allowedSubEnvIds, bool writeOver, FilePtrSetStruct &amp;filePtrSet) const </div><div class="ttdoc">Opens an output file for each sub-environment that was chosen to send data to the file...</div><div class="ttdef"><b>Definition:</b> <a href="a00404_source.html#l00521">Environment.C:521</a></div></div>
<div class="ttc" id="a00227_html_a9a415d3d463c4620ac59e3f7476bc6c9"><div class="ttname"><a href="a00227.html#a9a415d3d463c4620ac59e3f7476bc6c9">QUESO::TeuchosMatrix::transpose</a></div><div class="ttdeci">TeuchosMatrix transpose() const </div><div class="ttdoc">This function calculates the transpose of this matrix (square). </div><div class="ttdef"><b>Definition:</b> <a href="a00431_source.html#l00372">TeuchosMatrix.C:372</a></div></div>
<div class="ttc" id="a00228_html_a1f6482c296c6bb263810772af6c81746"><div class="ttname"><a href="a00228.html#a1f6482c296c6bb263810772af6c81746">QUESO::TeuchosVector::matlabLinearInterpExtrap</a></div><div class="ttdeci">void matlabLinearInterpExtrap(const TeuchosVector &amp;xVec, const TeuchosVector &amp;yVec, const TeuchosVector &amp;xiVec)</div><div class="ttdoc">Reproduces MATLAB linear inter/extra-polation. </div><div class="ttdef"><b>Definition:</b> <a href="a00432_source.html#l00834">TeuchosVector.C:834</a></div></div>
<div class="ttc" id="a00227_html_a1858cbb278b4cbfca8110133ed4ca19e"><div class="ttname"><a href="a00227.html#a1858cbb278b4cbfca8110133ed4ca19e">QUESO::TeuchosMatrix::copy</a></div><div class="ttdeci">void copy(const TeuchosMatrix &amp;src)</div><div class="ttdoc">In this function this matrix receives a copy of matrix src. </div><div class="ttdef"><b>Definition:</b> <a href="a00431_source.html#l01931">TeuchosMatrix.C:1931</a></div></div>
<div class="ttc" id="a00674_html_a07502ec763e41daf33325dfbda9b0102"><div class="ttname"><a href="a00674.html#a07502ec763e41daf33325dfbda9b0102">QUESO::operator-</a></div><div class="ttdeci">GslMatrix operator-(const GslMatrix &amp;m1, const GslMatrix &amp;m2)</div><div class="ttdef"><b>Definition:</b> <a href="a00409_source.html#l02029">GslMatrix.C:2029</a></div></div>
<div class="ttc" id="a00227_html_ac52cc56f2786fbd2d77023265a7da390"><div class="ttname"><a href="a00227.html#ac52cc56f2786fbd2d77023265a7da390">QUESO::TeuchosMatrix::mpiSum</a></div><div class="ttdeci">void mpiSum(const MpiComm &amp;comm, TeuchosMatrix &amp;M_global) const </div><div class="ttdef"><b>Definition:</b> <a href="a00431_source.html#l01653">TeuchosMatrix.C:1653</a></div></div>
<div class="ttc" id="a00227_html_ad033f43de1f52ba83d8abbf0c32ca7aa"><div class="ttname"><a href="a00227.html#ad033f43de1f52ba83d8abbf0c32ca7aa">QUESO::TeuchosMatrix::svdMatU</a></div><div class="ttdeci">const TeuchosMatrix &amp; svdMatU() const </div><div class="ttdoc">This function calls private member TeuchosMatrix::internalSvd() to set a M-by-N orthogonal matrix U o...</div><div class="ttdef"><b>Definition:</b> <a href="a00431_source.html#l00639">TeuchosMatrix.C:639</a></div></div>
<div class="ttc" id="a00227_html_af6828c79debcbab452e75576d95b8e19"><div class="ttname"><a href="a00227.html#af6828c79debcbab452e75576d95b8e19">QUESO::TeuchosMatrix::operator()</a></div><div class="ttdeci">double &amp; operator()(unsigned int i, unsigned int j)</div><div class="ttdoc">Element access method (non-const). </div><div class="ttdef"><b>Definition:</b> <a href="a00431_source.html#l00244">TeuchosMatrix.C:244</a></div></div>
<div class="ttc" id="a00228_html_ac8ac3cab19606dca5097e8d80bf203bf"><div class="ttname"><a href="a00228.html#ac8ac3cab19606dca5097e8d80bf203bf">QUESO::TeuchosVector::norm2</a></div><div class="ttdeci">double norm2() const </div><div class="ttdoc">Returns the 2-norm (Euclidean norm) of the vector. </div><div class="ttdef"><b>Definition:</b> <a href="a00432_source.html#l00367">TeuchosVector.C:367</a></div></div>
<div class="ttc" id="a00227_html_a95a38a5e8519e0f030107dc7087ac6ed"><div class="ttname"><a href="a00227.html#a95a38a5e8519e0f030107dc7087ac6ed">QUESO::TeuchosMatrix::operator*=</a></div><div class="ttdeci">TeuchosMatrix &amp; operator*=(double a)</div><div class="ttdoc">Stores in this the coordinate-wise multiplication of this and a. </div><div class="ttdef"><b>Definition:</b> <a href="a00431_source.html#l00192">TeuchosMatrix.C:192</a></div></div>
<div class="ttc" id="a00036_html_a78b57112bbd0e6dd0e8afec00b40ffa7"><div class="ttname"><a href="a00036.html#a78b57112bbd0e6dd0e8afec00b40ffa7">QUESO::BaseEnvironment::worldRank</a></div><div class="ttdeci">int worldRank() const </div><div class="ttdoc">Returns the same thing as fullRank() </div><div class="ttdef"><b>Definition:</b> <a href="a00404_source.html#l00262">Environment.C:262</a></div></div>
<div class="ttc" id="a00227_html_adcf5767d9854efc82ba9da78b3d5bec2"><div class="ttname"><a href="a00227.html#adcf5767d9854efc82ba9da78b3d5bec2">QUESO::TeuchosMatrix::eigen</a></div><div class="ttdeci">void eigen(TeuchosVector &amp;eigenValues, TeuchosMatrix *eigenVectors) const </div><div class="ttdoc">This function computes the eigenvalues of a real symmetric matrix. </div><div class="ttdef"><b>Definition:</b> <a href="a00431_source.html#l01039">TeuchosMatrix.C:1039</a></div></div>
<div class="ttc" id="a00246_html_a0cbedc1f6e24c0ad3b688d201fd649a4"><div class="ttname"><a href="a00246.html#a0cbedc1f6e24c0ad3b688d201fd649a4">QUESO::Vector::map</a></div><div class="ttdeci">const Map &amp; map() const </div><div class="ttdef"><b>Definition:</b> <a href="a00435_source.html#l00061">Vector.C:61</a></div></div>
<div class="ttc" id="a00227_html_a76363713af8d8c36338f999ca0cba0e1"><div class="ttname"><a href="a00227.html#a76363713af8d8c36338f999ca0cba0e1">QUESO::TeuchosMatrix::fillWithTranspose</a></div><div class="ttdeci">void fillWithTranspose(const TeuchosMatrix &amp;mat)</div><div class="ttdoc">This function stores the transpose of this matrix into this matrix. </div><div class="ttdef"><b>Definition:</b> <a href="a00431_source.html#l01420">TeuchosMatrix.C:1420</a></div></div>
<div class="ttc" id="a00227_html_ac36155312f4cb51fbe4da2b89420b8d4"><div class="ttname"><a href="a00227.html#ac36155312f4cb51fbe4da2b89420b8d4">QUESO::TeuchosMatrix::subReadContents</a></div><div class="ttdeci">void subReadContents(const std::string &amp;fileName, const std::string &amp;fileType, const std::set&lt; unsigned int &gt; &amp;allowedSubEnvIds)</div><div class="ttdoc">Read contents of subenvironment from file fileName. </div><div class="ttdef"><b>Definition:</b> <a href="a00431_source.html#l01751">TeuchosMatrix.C:1751</a></div></div>
<div class="ttc" id="a00227_html_a1c93b3054debeb1277a4ef0d06a6001d"><div class="ttname"><a href="a00227.html#a1c93b3054debeb1277a4ef0d06a6001d">QUESO::TeuchosMatrix::TeuchosMatrix</a></div><div class="ttdeci">TeuchosMatrix()</div><div class="ttdoc">Default Constructor. </div></div>
<div class="ttc" id="a00164_html_a1eefeca9f35200e8275fb0fdfa0c8684"><div class="ttname"><a href="a00164.html#a1eefeca9f35200e8275fb0fdfa0c8684">QUESO::Matrix::env</a></div><div class="ttdeci">const BaseEnvironment &amp; env() const </div><div class="ttdef"><b>Definition:</b> <a href="a00421_source.html#l00047">Matrix.C:47</a></div></div>
<div class="ttc" id="a00227_html_af4f736849f78e1d7b93590fa00323394"><div class="ttname"><a href="a00227.html#af4f736849f78e1d7b93590fa00323394">QUESO::TeuchosMatrix::operator-=</a></div><div class="ttdeci">TeuchosMatrix &amp; operator-=(const TeuchosMatrix &amp;rhs)</div><div class="ttdoc">Stores in this the coordinate-wise subtraction of this by rhs. </div><div class="ttdef"><b>Definition:</b> <a href="a00431_source.html#l00227">TeuchosMatrix.C:227</a></div></div>
<div class="ttc" id="a00228_html_a2398f321692d661267a6e9dc5d249917"><div class="ttname"><a href="a00228.html#a2398f321692d661267a6e9dc5d249917">QUESO::TeuchosVector::values</a></div><div class="ttdeci">double * values()</div><div class="ttdef"><b>Definition:</b> <a href="a00432_source.html#l00266">TeuchosVector.C:266</a></div></div>
<div class="ttc" id="a00227_html_a2e0cc4998dfb5c3d3de7efaec012b87f"><div class="ttname"><a href="a00227.html#a2e0cc4998dfb5c3d3de7efaec012b87f">QUESO::TeuchosMatrix::numRowsGlobal</a></div><div class="ttdeci">unsigned int numRowsGlobal() const </div><div class="ttdoc">Returns the global row dimension of this matrix. </div><div class="ttdef"><b>Definition:</b> <a href="a00431_source.html#l00282">TeuchosMatrix.C:282</a></div></div>
<div class="ttc" id="a00227_html_a8bac5523896601fdd26325250a4d732d"><div class="ttname"><a href="a00227.html#a8bac5523896601fdd26325250a4d732d">QUESO::TeuchosMatrix::chol</a></div><div class="ttdeci">int chol()</div><div class="ttdoc">Computes Cholesky factorization of this, a real symmetric positive definite matrix. </div><div class="ttdef"><b>Definition:</b> <a href="a00431_source.html#l00568">TeuchosMatrix.C:568</a></div></div>
<div class="ttc" id="a00179_html_a72e137e60ef8060efb1ee5fc874fa4b8"><div class="ttname"><a href="a00179.html#a72e137e60ef8060efb1ee5fc874fa4b8">QUESO::MpiComm::Allreduce</a></div><div class="ttdeci">void Allreduce(void *sendbuf, void *recvbuf, int count, RawType_MPI_Datatype datatype, RawType_MPI_Op op, const char *whereMsg, const char *whatMsg) const </div><div class="ttdoc">Combines values from all processes and distributes the result back to all processes. </div><div class="ttdef"><b>Definition:</b> <a href="a00422_source.html#l00143">MpiComm.C:143</a></div></div>
<div class="ttc" id="a00227_html_a9c251746e569e5b51231bcfe939e13c7"><div class="ttname"><a href="a00227.html#a9c251746e569e5b51231bcfe939e13c7">QUESO::TeuchosMatrix::determinant</a></div><div class="ttdeci">double determinant() const </div><div class="ttdoc">Calculates the determinant of this matrix. </div><div class="ttdef"><b>Definition:</b> <a href="a00431_source.html#l00442">TeuchosMatrix.C:442</a></div></div>
<div class="ttc" id="a00227_html_a96490c60f3bf57fe5cfdc95d8ff97dd1"><div class="ttname"><a href="a00227.html#a96490c60f3bf57fe5cfdc95d8ff97dd1">QUESO::TeuchosMatrix::normFrob</a></div><div class="ttdeci">double normFrob() const </div><div class="ttdoc">Returns the Frobenius norm of this matrix. </div><div class="ttdef"><b>Definition:</b> <a href="a00431_source.html#l00541">TeuchosMatrix.C:541</a></div></div>
<div class="ttc" id="a00306_html_a70b5e28b5bc3d1b63a7435c5fe50b837"><div class="ttname"><a href="a00306.html#a70b5e28b5bc3d1b63a7435c5fe50b837">dim</a></div><div class="ttdeci">int dim</div><div class="ttdef"><b>Definition:</b> <a href="a00306_source.html#l00081">ann2fig.cpp:81</a></div></div>
<div class="ttc" id="a00164_html_a7d7310149ecf33ca68c5ef7a815093db"><div class="ttname"><a href="a00164.html#a7d7310149ecf33ca68c5ef7a815093db">QUESO::Matrix::numOfProcsForStorage</a></div><div class="ttdeci">unsigned int numOfProcsForStorage() const </div><div class="ttdef"><b>Definition:</b> <a href="a00421_source.html#l00062">Matrix.C:62</a></div></div>
<div class="ttc" id="a00227_html_aba1ee7daec126808c3798ce17c9756d4"><div class="ttname"><a href="a00227.html#aba1ee7daec126808c3798ce17c9756d4">QUESO::TeuchosMatrix::filterLargeValues</a></div><div class="ttdeci">void filterLargeValues(double thresholdValue)</div><div class="ttdoc">This function sets to zero (filters) all entries of this matrix which are greater than thresholdValue...</div><div class="ttdef"><b>Definition:</b> <a href="a00431_source.html#l01397">TeuchosMatrix.C:1397</a></div></div>
<div class="ttc" id="a00227_html_abfa59abcb8bddf7fc3e455465e6ee0e4"><div class="ttname"><a href="a00227.html#abfa59abcb8bddf7fc3e455465e6ee0e4">QUESO::TeuchosMatrix::svdMatV</a></div><div class="ttdeci">const TeuchosMatrix &amp; svdMatV() const </div><div class="ttdoc">This function calls private member TeuchosMatrix::internalSvd() to set a N-by-N orthogonal square mat...</div><div class="ttdef"><b>Definition:</b> <a href="a00431_source.html#l00649">TeuchosMatrix.C:649</a></div></div>
<div class="ttc" id="a00311_html_afdb0a747f08804b5ae928e34146db865"><div class="ttname"><a href="a00311.html#afdb0a747f08804b5ae928e34146db865">work</a></div><div class="ttdeci">the intent is to exercise the right to control the distribution of derivative or collective works based on the Library In mere aggregation of another work not based on the Library with the you must alter all the notices that refer to this so that they refer to the ordinary GNU General Public instead of to this it is irreversible for that so the ordinary GNU General Public License applies to all subsequent copies and derivative works made from that copy This option is useful when you wish to copy part of the code of the Library into a program that is not a library You may copy and distribute the which must be distributed under the terms of Sections and above on a medium customarily used for software interchange If distribution of object code is made by offering access to copy from a designated then offering equivalent access to copy the source code from the same place satisfies the requirement to distribute the source even though third parties are not compelled to copy the source along with the object code A program that contains no derivative of any portion of the but is designed to work with the Library by being compiled or linked with is called a work that uses the Library Such a work</div><div class="ttdef"><b>Definition:</b> <a href="a00311_source.html#l00237">License.txt:237</a></div></div>
<div class="ttc" id="a00674_html_aea04e232d5d3dd76349a85bb8acf9e17"><div class="ttname"><a href="a00674.html#aea04e232d5d3dd76349a85bb8acf9e17">QUESO::matrixProduct</a></div><div class="ttdeci">GslMatrix matrixProduct(const GslVector &amp;v1, const GslVector &amp;v2)</div><div class="ttdef"><b>Definition:</b> <a href="a00409_source.html#l02036">GslMatrix.C:2036</a></div></div>
<div class="ttc" id="a00227_html_a898ab9b09abd36a4f8632d5c0acf8f53"><div class="ttname"><a href="a00227.html#a898ab9b09abd36a4f8632d5c0acf8f53">QUESO::TeuchosMatrix::getRow</a></div><div class="ttdeci">void getRow(const unsigned int row_num, TeuchosVector &amp;row) const </div><div class="ttdoc">This function gets the row_num-th column of this matrix and stores it into vector row...</div><div class="ttdef"><b>Definition:</b> <a href="a00431_source.html#l01272">TeuchosMatrix.C:1272</a></div></div>
<div class="ttc" id="a00164_html_a247fb0fc0b87fecdee054bb4660b68e8"><div class="ttname"><a href="a00164.html#a247fb0fc0b87fecdee054bb4660b68e8">QUESO::Matrix::m_env</a></div><div class="ttdeci">const BaseEnvironment &amp; m_env</div><div class="ttdoc">QUESO environment variable. </div><div class="ttdef"><b>Definition:</b> <a href="a00372_source.html#l00116">Matrix.h:116</a></div></div>
<div class="ttc" id="a00674_html_a1fa0d79f37a4fccc4c307456d29c4bfa"><div class="ttname"><a href="a00674.html#a1fa0d79f37a4fccc4c307456d29c4bfa">QUESO::operator*</a></div><div class="ttdeci">GslMatrix operator*(double a, const GslMatrix &amp;mat)</div><div class="ttdef"><b>Definition:</b> <a href="a00409_source.html#l01982">GslMatrix.C:1982</a></div></div>
<div class="ttc" id="a00227_html_a38aebd6933884dd1dccdb140227092b6"><div class="ttname"><a href="a00227.html#a38aebd6933884dd1dccdb140227092b6">QUESO::TeuchosMatrix::m_svdVmat</a></div><div class="ttdeci">TeuchosMatrix * m_svdVmat</div><div class="ttdoc">m_svdVmat stores the N-by-N orthogonal square matrix V after the singular value decomposition of a ma...</div><div class="ttdef"><b>Definition:</b> <a href="a00385_source.html#l00370">TeuchosMatrix.h:370</a></div></div>
<div class="ttc" id="a00227_html_a7b20f299e99f5bbe86053ca5c720f9f7"><div class="ttname"><a href="a00227.html#a7b20f299e99f5bbe86053ca5c720f9f7">QUESO::TeuchosMatrix::m_svdSvec</a></div><div class="ttdeci">TeuchosVector * m_svdSvec</div><div class="ttdoc">m_svdSvec stores the diagonal of the N-by-N diagonal matrix of singular values S after the singular v...</div><div class="ttdef"><b>Definition:</b> <a href="a00385_source.html#l00367">TeuchosMatrix.h:367</a></div></div>
<div class="ttc" id="a00227_html_a665ce7c3ecf4ba47c8b00ffebd06f438"><div class="ttname"><a href="a00227.html#a665ce7c3ecf4ba47c8b00ffebd06f438">QUESO::TeuchosMatrix::m_lnDeterminant</a></div><div class="ttdeci">double m_lnDeterminant</div><div class="ttdoc">The natural logarithm of the determinant of this matrix. </div><div class="ttdef"><b>Definition:</b> <a href="a00385_source.html#l00379">TeuchosMatrix.h:379</a></div></div>
<div class="ttc" id="a00674_html_a0d18267f571a86516c0d9960b1a0f1c9"><div class="ttname"><a href="a00674.html#a0d18267f571a86516c0d9960b1a0f1c9">QUESO::leftDiagScaling</a></div><div class="ttdeci">GslMatrix leftDiagScaling(const GslVector &amp;vec, const GslMatrix &amp;mat)</div><div class="ttdef"><b>Definition:</b> <a href="a00409_source.html#l02052">GslMatrix.C:2052</a></div></div>
<div class="ttc" id="a00086_html"><div class="ttname"><a href="a00086.html">QUESO::FilePtrSetStruct</a></div><div class="ttdoc">Struct for handling data input and output from files. </div><div class="ttdef"><b>Definition:</b> <a href="a00353_source.html#l00077">Environment.h:77</a></div></div>
<div class="ttc" id="a00036_html_a172d52f993f1322ed45aaddf71518dbb"><div class="ttname"><a href="a00036.html#a172d52f993f1322ed45aaddf71518dbb">QUESO::BaseEnvironment::subRank</a></div><div class="ttdeci">int subRank() const </div><div class="ttdoc">Returns the rank of the MPI process in the sub-communicator subComm() </div><div class="ttdef"><b>Definition:</b> <a href="a00404_source.html#l00287">Environment.C:287</a></div></div>
<div class="ttc" id="a00227_html_a22c82a6fb78541a113f65753d9303448"><div class="ttname"><a href="a00227.html#a22c82a6fb78541a113f65753d9303448">QUESO::TeuchosMatrix::values</a></div><div class="ttdeci">double * values()</div><div class="ttdoc">Returns a pointer to the first element of this matrix. </div><div class="ttdef"><b>Definition:</b> <a href="a00431_source.html#l00298">TeuchosMatrix.C:298</a></div></div>
<div class="ttc" id="a00246_html_a2e2952dab0554fedd8dc9a2543715745"><div class="ttname"><a href="a00246.html#a2e2952dab0554fedd8dc9a2543715745">QUESO::Vector::env</a></div><div class="ttdeci">const BaseEnvironment &amp; env() const </div><div class="ttdef"><b>Definition:</b> <a href="a00435_source.html#l00054">Vector.C:54</a></div></div>
<div class="ttc" id="a00227_html_ae049ec766677ae92dab499da444ad772"><div class="ttname"><a href="a00227.html#ae049ec766677ae92dab499da444ad772">QUESO::TeuchosMatrix::smallestEigen</a></div><div class="ttdeci">void smallestEigen(double &amp;eigenValue, TeuchosVector &amp;eigenVector) const </div><div class="ttdoc">This function finds smallest eigenvalue, namely eigenValue, of this matrix and its corresponding eige...</div><div class="ttdef"><b>Definition:</b> <a href="a00431_source.html#l01141">TeuchosMatrix.C:1141</a></div></div>
<div class="ttc" id="a00227_html_a4f3affd6522fafb794e2cc36a382ccc9"><div class="ttname"><a href="a00227.html#a4f3affd6522fafb794e2cc36a382ccc9">QUESO::TeuchosMatrix::invertMultiply</a></div><div class="ttdeci">void invertMultiply(const TeuchosVector &amp;b, TeuchosVector &amp;x) const </div><div class="ttdoc">This function calculates the inverse of this matrix, multiplies it with vector b and stores the resul...</div><div class="ttdef"><b>Definition:</b> <a href="a00431_source.html#l00791">TeuchosMatrix.C:791</a></div></div>
<div class="ttc" id="a00227_html_a546b7b2e45a5ce4cd47222229e0b9732"><div class="ttname"><a href="a00227.html#a546b7b2e45a5ce4cd47222229e0b9732">QUESO::TeuchosMatrix::svd</a></div><div class="ttdeci">int svd(TeuchosMatrix &amp;matU, TeuchosVector &amp;vecS, TeuchosMatrix &amp;matVt) const </div><div class="ttdoc">Checks for the dimension of this matrix, matU, VecS and matVt, and calls the protected routine intern...</div><div class="ttdef"><b>Definition:</b> <a href="a00431_source.html#l00617">TeuchosMatrix.C:617</a></div></div>
<div class="ttc" id="a00227_html_aaba42e724f7b422d69f6ebe1cb40d0df"><div class="ttname"><a href="a00227.html#aaba42e724f7b422d69f6ebe1cb40d0df">QUESO::TeuchosMatrix::stride</a></div><div class="ttdeci">int stride()</div><div class="ttdoc">Returns the stride between the columns of this matrix in memory. </div><div class="ttdef"><b>Definition:</b> <a href="a00431_source.html#l00306">TeuchosMatrix.C:306</a></div></div>
<div class="ttc" id="a00036_html_ab712bff194ddd91459d4ea8715c77e8b"><div class="ttname"><a href="a00036.html#ab712bff194ddd91459d4ea8715c77e8b">QUESO::BaseEnvironment::closeFile</a></div><div class="ttdeci">void closeFile(FilePtrSetStruct &amp;filePtrSet, const std::string &amp;fileType) const </div><div class="ttdoc">Closes the file. </div><div class="ttdef"><b>Definition:</b> <a href="a00404_source.html#l01084">Environment.C:1084</a></div></div>
<div class="ttc" id="a00227_html_a0dbe566341ac0c0fcf41cc0f0f69f5e9"><div class="ttname"><a href="a00227.html#a0dbe566341ac0c0fcf41cc0f0f69f5e9">QUESO::TeuchosMatrix::subWriteContents</a></div><div class="ttdeci">void subWriteContents(const std::string &amp;varNamePrefix, const std::string &amp;fileName, const std::string &amp;fileType, const std::set&lt; unsigned int &gt; &amp;allowedSubEnvIds) const </div><div class="ttdoc">Write contents of subenvironment in file fileName. </div><div class="ttdef"><b>Definition:</b> <a href="a00431_source.html#l01885">TeuchosMatrix.C:1885</a></div></div>
<div class="ttc" id="a00227_html_a8e80ebb3c4e6720bf35c5f5a214a3c1f"><div class="ttname"><a href="a00227.html#a8e80ebb3c4e6720bf35c5f5a214a3c1f">QUESO::TeuchosMatrix::m_determinant</a></div><div class="ttdeci">double m_determinant</div><div class="ttdoc">The determinant of this matrix. </div><div class="ttdef"><b>Definition:</b> <a href="a00385_source.html#l00376">TeuchosMatrix.h:376</a></div></div>
<div class="ttc" id="a00227_html_a05fe1849f60cf4057698d6ef0a80febf"><div class="ttname"><a href="a00227.html#a05fe1849f60cf4057698d6ef0a80febf">QUESO::TeuchosMatrix::m_svdColMap</a></div><div class="ttdeci">Map * m_svdColMap</div><div class="ttdoc">Mapping for matrices involved in the singular value decomposition (svd) routine. </div><div class="ttdef"><b>Definition:</b> <a href="a00385_source.html#l00361">TeuchosMatrix.h:361</a></div></div>
<div class="ttc" id="a00227_html_a35c6b451ba8daeb0a08046b5dad4ecfc"><div class="ttname"><a href="a00227.html#a35c6b451ba8daeb0a08046b5dad4ecfc">QUESO::TeuchosMatrix::filterSmallValues</a></div><div class="ttdeci">void filterSmallValues(double thresholdValue)</div><div class="ttdoc">This function sets to zero (filters) all entries of this matrix which are smaller than thresholdValue...</div><div class="ttdef"><b>Definition:</b> <a href="a00431_source.html#l01375">TeuchosMatrix.C:1375</a></div></div>
<div class="ttc" id="a00674_html_ace699c1e7716717f330c783a58ebcd4f"><div class="ttname"><a href="a00674.html#ace699c1e7716717f330c783a58ebcd4f">QUESO::queso_require_equal_to_msg</a></div><div class="ttdeci">MonteCarloSGOptions::MonteCarloSGOptions(const BaseEnvironment &amp;env, const char *prefix, const McOptionsValues &amp;alternativeOptionsValues queso_require_equal_to_msg)(m_env.optionsInputFileName(), std::string(&quot;&quot;), std::string(&quot;this constructor is incompatible with the existence of an options input file&quot;))</div><div class="ttdef"><b>Definition:</b> <a href="a00624_source.html#l00460">MonteCarloSGOptions.C:460</a></div></div>
<div class="ttc" id="a00674_html_a2c87d8c1ab55355226086522f9fb7f83"><div class="ttname"><a href="a00674.html#a2c87d8c1ab55355226086522f9fb7f83">QUESO::rightDiagScaling</a></div><div class="ttdeci">GslMatrix rightDiagScaling(const GslMatrix &amp;mat, const GslVector &amp;vec)</div><div class="ttdef"><b>Definition:</b> <a href="a00409_source.html#l02073">GslMatrix.C:2073</a></div></div>
<div class="ttc" id="a00227_html_a6df7300159f5ca3ff664ebca6e3c932f"><div class="ttname"><a href="a00227.html#a6df7300159f5ca3ff664ebca6e3c932f">QUESO::TeuchosMatrix::m_LU</a></div><div class="ttdeci">Teuchos::SerialDenseMatrix&lt; int, double &gt; m_LU</div><div class="ttdoc">Teuchos matrix for the LU decomposition of m_mat. </div><div class="ttdef"><b>Definition:</b> <a href="a00385_source.html#l00355">TeuchosMatrix.h:355</a></div></div>
<div class="ttc" id="a00228_html"><div class="ttname"><a href="a00228.html">QUESO::TeuchosVector</a></div><div class="ttdoc">Class for vector operations using Teuchos (Trilinos). </div><div class="ttdef"><b>Definition:</b> <a href="a00386_source.html#l00055">TeuchosVector.h:55</a></div></div>
<div class="ttc" id="a00227_html_a50e1d16f2e2b7045157c5596ca240be1"><div class="ttname"><a href="a00227.html#a50e1d16f2e2b7045157c5596ca240be1">QUESO::TeuchosMatrix::m_svdVTmat</a></div><div class="ttdeci">TeuchosMatrix * m_svdVTmat</div><div class="ttdoc">m_svdVmatT stores the transpose of N-by-N orthogonal square matrix V, namely V^T, after the singular ...</div><div class="ttdef"><b>Definition:</b> <a href="a00385_source.html#l00373">TeuchosMatrix.h:373</a></div></div>
<div class="ttc" id="a00036_html_a8a0064746ae8dddfece4229b9ad374d6"><div class="ttname"><a href="a00036.html#a8a0064746ae8dddfece4229b9ad374d6">QUESO::BaseEnvironment::subDisplayFile</a></div><div class="ttdeci">std::ofstream * subDisplayFile() const </div><div class="ttdoc">Access function for m_subDisplayFile (displays file on stream). </div><div class="ttdef"><b>Definition:</b> <a href="a00404_source.html#l00320">Environment.C:320</a></div></div>
<div class="ttc" id="a00036_html_a8a3f76733a31991a1ed9a942feb2dc3c"><div class="ttname"><a href="a00036.html#a8a3f76733a31991a1ed9a942feb2dc3c">QUESO::BaseEnvironment::openInputFile</a></div><div class="ttdeci">bool openInputFile(const std::string &amp;fileName, const std::string &amp;fileType, const std::set&lt; unsigned int &gt; &amp;allowedSubEnvIds, FilePtrSetStruct &amp;filePtrSet) const </div><div class="ttdoc">Opens an input file. </div><div class="ttdef"><b>Definition:</b> <a href="a00404_source.html#l00896">Environment.C:896</a></div></div>
<div class="ttc" id="a00227_html_a6a0ed6fd46f5b06c571a59f6678a3380"><div class="ttname"><a href="a00227.html#a6a0ed6fd46f5b06c571a59f6678a3380">QUESO::TeuchosMatrix::internalSvd</a></div><div class="ttdeci">int internalSvd() const </div><div class="ttdoc">This function factorizes the M-by-N matrix A into the singular value decomposition A = U S V^T for M ...</div><div class="ttdef"><b>Definition:</b> <a href="a00431_source.html#l02015">TeuchosMatrix.C:2015</a></div></div>
<div class="ttc" id="a00036_html_a83c1c036f81651792a74975f2da23ae1"><div class="ttname"><a href="a00036.html#a83c1c036f81651792a74975f2da23ae1">QUESO::BaseEnvironment::checkingLevel</a></div><div class="ttdeci">unsigned int checkingLevel() const </div><div class="ttdoc">Access function to private attribute m_checkingLevel. </div><div class="ttdef"><b>Definition:</b> <a href="a00404_source.html#l00464">Environment.C:464</a></div></div>
<div class="ttc" id="a00036_html_a1fe5f244fc0316a0ab3e37463f108b96"><div class="ttname"><a href="a00036.html#a1fe5f244fc0316a0ab3e37463f108b96">QUESO::BaseEnvironment::displayVerbosity</a></div><div class="ttdeci">unsigned int displayVerbosity() const </div><div class="ttdef"><b>Definition:</b> <a href="a00404_source.html#l00450">Environment.C:450</a></div></div>
<div class="ttc" id="a00227_html_a5855b579a855166171ccdd72c55e5d0d"><div class="ttname"><a href="a00227.html#a5855b579a855166171ccdd72c55e5d0d">QUESO::TeuchosMatrix::setColumn</a></div><div class="ttdeci">void setColumn(const unsigned int column_num, const TeuchosVector &amp;column)</div><div class="ttdoc">This function copies vector column into the column_num-th column of this matrix. </div><div class="ttdef"><b>Definition:</b> <a href="a00431_source.html#l01255">TeuchosMatrix.C:1255</a></div></div>
<div class="ttc" id="a00164_html_a643225869ea7f8371aa638619b8c8990"><div class="ttname"><a href="a00164.html#a643225869ea7f8371aa638619b8c8990">QUESO::Matrix::base_copy</a></div><div class="ttdeci">virtual void base_copy(const Matrix &amp;src)</div><div class="ttdoc">Copies base data from matrix src to this matrix. </div><div class="ttdef"><b>Definition:</b> <a href="a00421_source.html#l00099">Matrix.C:99</a></div></div>
<div class="ttc" id="a00227_html_ae66a7551b49a7e33a407972c3da2763c"><div class="ttname"><a href="a00227.html#ae66a7551b49a7e33a407972c3da2763c">QUESO::TeuchosMatrix::getColumn</a></div><div class="ttdeci">void getColumn(const unsigned int column_num, TeuchosVector &amp;column) const </div><div class="ttdoc">This function gets the column_num-th column of this matrix and stores it into vector column...</div><div class="ttdef"><b>Definition:</b> <a href="a00431_source.html#l01220">TeuchosMatrix.C:1220</a></div></div>
<div class="ttc" id="a00227_html_aac0e4aaade72d002c9b43f9a01e7020c"><div class="ttname"><a href="a00227.html#aac0e4aaade72d002c9b43f9a01e7020c">QUESO::TeuchosMatrix::m_signum</a></div><div class="ttdeci">int m_signum</div><div class="ttdef"><b>Definition:</b> <a href="a00385_source.html#l00387">TeuchosMatrix.h:387</a></div></div>
<div class="ttc" id="a00227_html_a1205fbbcb3dee3a5a3c761e0c7fd54fa"><div class="ttname"><a href="a00227.html#a1205fbbcb3dee3a5a3c761e0c7fd54fa">QUESO::TeuchosMatrix::normMax</a></div><div class="ttdeci">double normMax() const </div><div class="ttdoc">Returns the Frobenius norm of this matrix. </div><div class="ttdef"><b>Definition:</b> <a href="a00431_source.html#l00548">TeuchosMatrix.C:548</a></div></div>
<div class="ttc" id="a00227_html_a33d7b0e6223baca6c8e10f6e65c67151"><div class="ttname"><a href="a00227.html#a33d7b0e6223baca6c8e10f6e65c67151">QUESO::TeuchosMatrix::fillWithTensorProduct</a></div><div class="ttdeci">void fillWithTensorProduct(const TeuchosMatrix &amp;mat1, const TeuchosMatrix &amp;mat2)</div><div class="ttdoc">This function calculates the tensor product of matrices mat1 and mat2 and stores it in this matrix...</div><div class="ttdef"><b>Definition:</b> <a href="a00431_source.html#l01605">TeuchosMatrix.C:1605</a></div></div>
<div class="ttc" id="a00036_html"><div class="ttname"><a href="a00036.html">QUESO::BaseEnvironment</a></div><div class="ttdoc">This (virtual) class sets up the environment underlying the use of the QUESO library by an executable...</div><div class="ttdef"><b>Definition:</b> <a href="a00353_source.html#l00198">Environment.h:198</a></div></div>
<div class="ttc" id="a00227_html_a23860d08ecf0f3ec2683811dbaeda14c"><div class="ttname"><a href="a00227.html#a23860d08ecf0f3ec2683811dbaeda14c">QUESO::TeuchosMatrix::max</a></div><div class="ttdeci">double max() const </div><div class="ttdoc">Returns the maximum element value of the matrix. </div><div class="ttdef"><b>Definition:</b> <a href="a00431_source.html#l00315">TeuchosMatrix.C:315</a></div></div>
<div class="ttc" id="a00227_html_adae6a5fa59652c964e2d3893117bb95d"><div class="ttname"><a href="a00227.html#adae6a5fa59652c964e2d3893117bb95d">QUESO::TeuchosMatrix::m_svdUmat</a></div><div class="ttdeci">TeuchosMatrix * m_svdUmat</div><div class="ttdoc">m_svdUmat stores the M-by-N orthogonal matrix U after the singular value decomposition of a matrix...</div><div class="ttdef"><b>Definition:</b> <a href="a00385_source.html#l00364">TeuchosMatrix.h:364</a></div></div>
</div><!-- fragment --></div><!-- contents -->
<hr size="1"/><address style="text-align: right;"><small>
Generated on Sat Apr 22 2017 14:04:36 for queso-0.57.0
by&nbsp;<a href="http://www.doxygen.org/index.html">
<em>doxygen</em></a>
1.8.5</small></address>
</body>
</html>
