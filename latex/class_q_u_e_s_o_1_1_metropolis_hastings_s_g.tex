\hypertarget{class_q_u_e_s_o_1_1_metropolis_hastings_s_g}{\section{Q\-U\-E\-S\-O\-:\-:Metropolis\-Hastings\-S\-G$<$ P\-\_\-\-V, P\-\_\-\-M $>$ Class Template Reference}
\label{class_q_u_e_s_o_1_1_metropolis_hastings_s_g}\index{Q\-U\-E\-S\-O\-::\-Metropolis\-Hastings\-S\-G$<$ P\-\_\-\-V, P\-\_\-\-M $>$@{Q\-U\-E\-S\-O\-::\-Metropolis\-Hastings\-S\-G$<$ P\-\_\-\-V, P\-\_\-\-M $>$}}
}


A templated class that represents a Metropolis-\/\-Hastings generator of samples.  




{\ttfamily \#include $<$Metropolis\-Hastings\-S\-G.\-h$>$}



Collaboration diagram for Q\-U\-E\-S\-O\-:\-:Metropolis\-Hastings\-S\-G$<$ P\-\_\-\-V, P\-\_\-\-M $>$\-:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{class_q_u_e_s_o_1_1_metropolis_hastings_s_g__coll__graph}
\end{center}
\end{figure}
\subsection*{Public Member Functions}
\begin{Indent}{\bf Constructor/\-Destructor methods}\par
\begin{DoxyCompactItemize}
\item 
\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_aced8a6afa8902ab317f67b5ab38492b3}{Metropolis\-Hastings\-S\-G} (const char $\ast$prefix, const \hyperlink{class_q_u_e_s_o_1_1_mh_options_values}{Mh\-Options\-Values} $\ast$alternative\-Options\-Values, const \hyperlink{class_q_u_e_s_o_1_1_base_vector_r_v}{Base\-Vector\-R\-V}$<$ P\-\_\-\-V, P\-\_\-\-M $>$ \&source\-Rv, const P\-\_\-\-V \&initial\-Position, const P\-\_\-\-M $\ast$input\-Proposal\-Cov\-Matrix)
\begin{DoxyCompactList}\small\item\em Constructor. \end{DoxyCompactList}\item 
\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_a76aacd5c5b50134dc97b0bb8a8d3c047}{Metropolis\-Hastings\-S\-G} (const \hyperlink{class_q_u_e_s_o_1_1_m_l_sampling_level_options}{M\-L\-Sampling\-Level\-Options} \&ml\-Options, const \hyperlink{class_q_u_e_s_o_1_1_base_vector_r_v}{Base\-Vector\-R\-V}$<$ P\-\_\-\-V, P\-\_\-\-M $>$ \&source\-Rv, const P\-\_\-\-V \&initial\-Position, const P\-\_\-\-M $\ast$input\-Proposal\-Cov\-Matrix)
\begin{DoxyCompactList}\small\item\em Constructor. \end{DoxyCompactList}\item 
\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_a86d5903964a3c8a873ab119be1b030a9}{$\sim$\-Metropolis\-Hastings\-S\-G} ()
\begin{DoxyCompactList}\small\item\em Destructor. \end{DoxyCompactList}\end{DoxyCompactItemize}
\end{Indent}
\begin{Indent}{\bf Statistical methods}\par
\begin{DoxyCompactItemize}
\item 
void \hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_a34aae6d77dc81adb00e7049942553ae7}{generate\-Sequence} (\hyperlink{class_q_u_e_s_o_1_1_base_vector_sequence}{Base\-Vector\-Sequence}$<$ P\-\_\-\-V, P\-\_\-\-M $>$ \&working\-Chain, \hyperlink{class_q_u_e_s_o_1_1_scalar_sequence}{Scalar\-Sequence}$<$ double $>$ $\ast$working\-Log\-Likelihood\-Values, \hyperlink{class_q_u_e_s_o_1_1_scalar_sequence}{Scalar\-Sequence}$<$ double $>$ $\ast$working\-Log\-Target\-Values)
\begin{DoxyCompactList}\small\item\em Method to generate the chain. \end{DoxyCompactList}\item 
void \hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_a1f0aebb8374162b9dee9463412a21436}{get\-Raw\-Chain\-Info} (\hyperlink{struct_q_u_e_s_o_1_1_m_h_raw_chain_info_struct}{M\-H\-Raw\-Chain\-Info\-Struct} \&info) const 
\begin{DoxyCompactList}\small\item\em Gets information from the raw chain. \end{DoxyCompactList}\end{DoxyCompactItemize}
\end{Indent}
\subsection*{Private Member Functions}
\begin{DoxyCompactItemize}
\item 
void \hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_a38f0ec3feee117f6abe20c0a806f9c0a}{common\-Constructor} ()
\begin{DoxyCompactList}\small\item\em Reads the options values from the options input file. \end{DoxyCompactList}\item 
void \hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_af904814eb149a8fcc8ca346f2c254337}{generate\-Full\-Chain} (const P\-\_\-\-V \&values\-Of1st\-Position, unsigned int chain\-Size, \hyperlink{class_q_u_e_s_o_1_1_base_vector_sequence}{Base\-Vector\-Sequence}$<$ P\-\_\-\-V, P\-\_\-\-M $>$ \&working\-Chain, \hyperlink{class_q_u_e_s_o_1_1_scalar_sequence}{Scalar\-Sequence}$<$ double $>$ $\ast$working\-Log\-Likelihood\-Values, \hyperlink{class_q_u_e_s_o_1_1_scalar_sequence}{Scalar\-Sequence}$<$ double $>$ $\ast$working\-Log\-Target\-Values)
\begin{DoxyCompactList}\small\item\em This method generates the chain. \end{DoxyCompactList}\item 
void \hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_ad1a6f23afa254985240949b8bbfb0c59}{read\-Full\-Chain} (const std\-::string \&input\-File\-Name, const std\-::string \&input\-File\-Type, unsigned int chain\-Size, \hyperlink{class_q_u_e_s_o_1_1_base_vector_sequence}{Base\-Vector\-Sequence}$<$ P\-\_\-\-V, P\-\_\-\-M $>$ \&working\-Chain)
\begin{DoxyCompactList}\small\item\em This method reads the chain contents. \end{DoxyCompactList}\item 
void \hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_a8b6571483a26c8ce1783519c43ed55a4}{update\-Adapted\-Cov\-Matrix} (const \hyperlink{class_q_u_e_s_o_1_1_base_vector_sequence}{Base\-Vector\-Sequence}$<$ P\-\_\-\-V, P\-\_\-\-M $>$ \&sub\-Chain, unsigned int id\-Of\-First\-Position\-In\-Sub\-Chain, double \&last\-Chain\-Size, P\-\_\-\-V \&last\-Mean, P\-\_\-\-M \&last\-Adapted\-Cov\-Matrix)
\begin{DoxyCompactList}\small\item\em This method updates the adapted covariance matrix. \end{DoxyCompactList}\item 
double \hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_ad5c2b3afd5e845ea22518536274a8dd7}{alpha} (const \hyperlink{class_q_u_e_s_o_1_1_markov_chain_position_data}{Markov\-Chain\-Position\-Data}$<$ P\-\_\-\-V $>$ \&x, const \hyperlink{class_q_u_e_s_o_1_1_markov_chain_position_data}{Markov\-Chain\-Position\-Data}$<$ P\-\_\-\-V $>$ \&y, unsigned int x\-Stage\-Id, unsigned int y\-Stage\-Id, double $\ast$alpha\-Quotient\-Ptr=N\-U\-L\-L)
\begin{DoxyCompactList}\small\item\em Calculates acceptance ration. \end{DoxyCompactList}\item 
double \hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_a2adeca5cc9cf99ea0b209eacfa42bd83}{alpha} (const std\-::vector$<$ \hyperlink{class_q_u_e_s_o_1_1_markov_chain_position_data}{Markov\-Chain\-Position\-Data}$<$ P\-\_\-\-V $>$ $\ast$ $>$ \&input\-Positions, const std\-::vector$<$ unsigned int $>$ \&input\-T\-K\-Stage\-Ids)
\begin{DoxyCompactList}\small\item\em Calculates acceptance ration. \end{DoxyCompactList}\item 
bool \hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_abef3a3b60bc10db208864f6db09eeea8}{accept\-Alpha} (double \hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_ad5c2b3afd5e845ea22518536274a8dd7}{alpha})
\begin{DoxyCompactList}\small\item\em Decides whether or not to accept alpha. \end{DoxyCompactList}\item 
int \hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_ae354fe11a3f89df768b15f1743567db2}{write\-Info} (const \hyperlink{class_q_u_e_s_o_1_1_base_vector_sequence}{Base\-Vector\-Sequence}$<$ P\-\_\-\-V, P\-\_\-\-M $>$ \&working\-Chain, std\-::ofstream \&ofsvar) const 
\begin{DoxyCompactList}\small\item\em Writes information about the Markov chain in a file. \end{DoxyCompactList}\end{DoxyCompactItemize}
\subsection*{Private Attributes}
\begin{DoxyCompactItemize}
\item 
const \hyperlink{class_q_u_e_s_o_1_1_base_environment}{Base\-Environment} \& \hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_ac8ea061e55b920e0c8f9bce5c3f20e52}{m\-\_\-env}
\item 
const \hyperlink{class_q_u_e_s_o_1_1_vector_space}{Vector\-Space}$<$ P\-\_\-\-V, P\-\_\-\-M $>$ \& \hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_a2ef17fbfc6a156f03bbfad044b5a75f5}{m\-\_\-vector\-Space}
\item 
const \hyperlink{class_q_u_e_s_o_1_1_base_joint_pdf}{Base\-Joint\-Pdf}$<$ P\-\_\-\-V, P\-\_\-\-M $>$ \& \hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_a42ce4ffcb3addf62dd3f19fe8bb09268}{m\-\_\-target\-Pdf}
\item 
P\-\_\-\-V \hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_ae29f5d1198228858283d733021da2b14}{m\-\_\-initial\-Position}
\item 
P\-\_\-\-M \hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_a4d9862afbafb34921e91de3d4610c6cd}{m\-\_\-initial\-Proposal\-Cov\-Matrix}
\item 
bool \hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_a416c5ed0c8520d23a479d4a6d3c3c083}{m\-\_\-null\-Input\-Proposal\-Cov\-Matrix}
\item 
unsigned int \hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_a43a883aa28c81ed99e5f0cd9de93889b}{m\-\_\-num\-Disabled\-Parameters}
\item 
std\-::vector$<$ bool $>$ \hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_afce8eeadae98935c72727b3640e88a31}{m\-\_\-parameter\-Enabled\-Status}
\item 
const \\*
\hyperlink{class_q_u_e_s_o_1_1_scalar_function_synchronizer}{Scalar\-Function\-Synchronizer}\\*
$<$ P\-\_\-\-V, P\-\_\-\-M $>$ $\ast$ \hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_ae7c7551764e0ccdfbe2862c544cdab10}{m\-\_\-target\-Pdf\-Synchronizer}
\item 
\hyperlink{class_q_u_e_s_o_1_1_base_t_k_group}{Base\-T\-K\-Group}$<$ P\-\_\-\-V, P\-\_\-\-M $>$ $\ast$ \hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_a26e9680abddfb793486c995fa16f8c2d}{m\-\_\-tk}
\item 
unsigned int \hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_a49500f5107190c94813e232cd806c2bc}{m\-\_\-position\-Id\-For\-Debugging}
\item 
unsigned int \hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_aca9351ab468808759b8b19686231ae4f}{m\-\_\-stage\-Id\-For\-Debugging}
\item 
std\-::vector$<$ unsigned int $>$ \hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_ad1916a22b4a53ba67fa87f93c6e0a252}{m\-\_\-ids\-Of\-Unique\-Positions}
\item 
std\-::vector$<$ double $>$ \hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_ac33a6e46e05c20c071a46ecf58a9291c}{m\-\_\-log\-Targets}
\item 
std\-::vector$<$ double $>$ \hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_a6fd65985afd80114ece8b2b5fffe658d}{m\-\_\-alpha\-Quotients}
\item 
double \hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_a005d221d1c458ff767ed03304ca4cd6f}{m\-\_\-last\-Chain\-Size}
\item 
P\-\_\-\-V $\ast$ \hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_a9741f56d947e9d7967af91c6ea083b56}{m\-\_\-last\-Mean}
\item 
P\-\_\-\-M $\ast$ \hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_a1c73b49339c8a1015d95a890d7882331}{m\-\_\-last\-Adapted\-Cov\-Matrix}
\item 
unsigned int \hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_a60695940f442f6568d10ee9e456032c7}{m\-\_\-num\-Positions\-Not\-Sub\-Written}
\item 
\hyperlink{struct_q_u_e_s_o_1_1_m_h_raw_chain_info_struct}{M\-H\-Raw\-Chain\-Info\-Struct} \hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_ac531509489028853bb17c0353fc9eafd}{m\-\_\-raw\-Chain\-Info}
\item 
\hyperlink{class_q_u_e_s_o_1_1_mh_options_values}{Mh\-Options\-Values} \hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_add6eb8fa2e706ef1de9772f71c84d839}{m\-\_\-alternative\-Options\-Values}
\item 
\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_options}{Metropolis\-Hastings\-S\-G\-Options} $\ast$ \hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_a5d0bc9f73d50d272aa6bfb5ef5939ef3}{m\-\_\-options\-Obj}
\end{DoxyCompactItemize}
\subsection*{I/\-O methods}
\begin{DoxyCompactItemize}
\item 
void \hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_aed301deea1c0eab1a7d9e4a332729141}{print} (std\-::ostream \&os) const 
\begin{DoxyCompactList}\small\item\em T\-O\-D\-O\-: Prints the sequence. \end{DoxyCompactList}\item 
std\-::ostream \& \hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_ab930e71442c0c1e3b8236f2f975c0664}{operator$<$$<$} (std\-::ostream \&os, const \hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g}{Metropolis\-Hastings\-S\-G}$<$ P\-\_\-\-V, P\-\_\-\-M $>$ \&obj)
\end{DoxyCompactItemize}


\subsection{Detailed Description}
\subsubsection*{template$<$class P\-\_\-\-V, class P\-\_\-\-M$>$class Q\-U\-E\-S\-O\-::\-Metropolis\-Hastings\-S\-G$<$ P\-\_\-\-V, P\-\_\-\-M $>$}

A templated class that represents a Metropolis-\/\-Hastings generator of samples. 

This class implements a Metropolis-\/\-Hastings generator of samples. 'S\-G' stands for 'Sequence Generator'. Options reading is handled by class 'Metropolis\-Hastings\-Options'. If options request data to be written in the output file (M\-A\-T\-L\-A\-B .m format only, for now), the user can check which M\-A\-T\-L\-A\-B variables are defined and set by running 'grep zeros $<$\-O\-U\-T\-P\-U\-T file=\char`\"{}\char`\"{} name$>$=\char`\"{}\char`\"{}$>$' after the solution procedures ends. The names of the variables are self explanatory. 

Definition at line 120 of file Metropolis\-Hastings\-S\-G.\-h.



\subsection{Constructor \& Destructor Documentation}
\hypertarget{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_aced8a6afa8902ab317f67b5ab38492b3}{\index{Q\-U\-E\-S\-O\-::\-Metropolis\-Hastings\-S\-G@{Q\-U\-E\-S\-O\-::\-Metropolis\-Hastings\-S\-G}!Metropolis\-Hastings\-S\-G@{Metropolis\-Hastings\-S\-G}}
\index{Metropolis\-Hastings\-S\-G@{Metropolis\-Hastings\-S\-G}!QUESO::MetropolisHastingsSG@{Q\-U\-E\-S\-O\-::\-Metropolis\-Hastings\-S\-G}}
\subsubsection[{Metropolis\-Hastings\-S\-G}]{\setlength{\rightskip}{0pt plus 5cm}template$<$class P\-\_\-\-V , class P\-\_\-\-M $>$ {\bf Q\-U\-E\-S\-O\-::\-Metropolis\-Hastings\-S\-G}$<$ P\-\_\-\-V, P\-\_\-\-M $>$\-::{\bf Metropolis\-Hastings\-S\-G} (
\begin{DoxyParamCaption}
\item[{const char $\ast$}]{prefix, }
\item[{const {\bf Mh\-Options\-Values} $\ast$}]{alternative\-Options\-Values, }
\item[{const {\bf Base\-Vector\-R\-V}$<$ P\-\_\-\-V, P\-\_\-\-M $>$ \&}]{source\-Rv, }
\item[{const P\-\_\-\-V \&}]{initial\-Position, }
\item[{const P\-\_\-\-M $\ast$}]{input\-Proposal\-Cov\-Matrix}
\end{DoxyParamCaption}
)}}\label{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_aced8a6afa8902ab317f67b5ab38492b3}


Constructor. 

This method reads the options from the options input file. It calls \hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_a38f0ec3feee117f6abe20c0a806f9c0a}{common\-Constructor()}. Requirements\-: 1) the image set of the vector random variable 'source\-Rv' should belong to a vector space of dimension equal to the size of the vector 'initial\-Position' and 2) if 'input\-Proposal\-Cov\-Matrix' is not N\-U\-L\-L, is should be square and its size should be equal to the size of 'initial\-Position'. If the requirements are satisfied, the constructor then reads input options that begin with the string '$<$prefix$>$\-\_\-mh\-\_\-'. For instance, if 'prefix' is 'p\-R\-Oblem\-\_\-775\-\_\-ip\-\_\-', then the constructor will read all options that begin with 'p\-R\-Oblem\-\_\-775\-\_\-ip\-\_\-mh\-\_\-'. Options reading is handled by class 'Metropolis\-Hastings\-Options'. 
\begin{DoxyParams}{Parameters}
{\em prefix} & Prefix \\
\hline
{\em alternative\-Options\-Values} & Options (if no input file) \\
\hline
{\em source\-Rv} & The source R\-V \\
\hline
{\em initial\-Position} & Initial chain position \\
\hline
{\em input\-Proposal\-Cov\-Matrix} & Proposal cov. matrix \\
\hline
\end{DoxyParams}


Definition at line 130 of file Metropolis\-Hastings\-S\-G.\-C.



References U\-Q\-\_\-\-F\-A\-T\-A\-L\-\_\-\-T\-E\-S\-T\-\_\-\-M\-A\-C\-R\-O.


\begin{DoxyCode}
136   :
137   \hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_ac8ea061e55b920e0c8f9bce5c3f20e52}{m\_env}                       (sourceRv.\hyperlink{class_q_u_e_s_o_1_1_base_vector_r_v_ad5bf8486b3bacb46b9d4ecba513fd37b}{env}()),
138   \hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_a2ef17fbfc6a156f03bbfad044b5a75f5}{m\_vectorSpace}               (sourceRv.\hyperlink{class_q_u_e_s_o_1_1_base_vector_r_v_aa4dd2f036228eac1f945bacc7147a922}{imageSet}().
      \hyperlink{class_q_u_e_s_o_1_1_vector_set_a923421590baf5bf93cf066e528f927dc}{vectorSpace}()),
139   \hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_a42ce4ffcb3addf62dd3f19fe8bb09268}{m\_targetPdf}                 (sourceRv.\hyperlink{class_q_u_e_s_o_1_1_base_vector_r_v_a3206740e05e0c64a88273029e963b185}{pdf}()),
140   \hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_ae29f5d1198228858283d733021da2b14}{m\_initialPosition}           (initialPosition),
141   \hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_a4d9862afbafb34921e91de3d4610c6cd}{m\_initialProposalCovMatrix}  (\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_a2ef17fbfc6a156f03bbfad044b5a75f5}{m\_vectorSpace}.
      \hyperlink{class_q_u_e_s_o_1_1_vector_space_a92e963bb5cab3eecd290dfe4b8f03b04}{zeroVector}()),
142   \hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_a416c5ed0c8520d23a479d4a6d3c3c083}{m\_nullInputProposalCovMatrix}(inputProposalCovMatrix == NULL),
143   \hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_a43a883aa28c81ed99e5f0cd9de93889b}{m\_numDisabledParameters}     (0), \textcolor{comment}{// gpmsa2}
144   \hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_afce8eeadae98935c72727b3640e88a31}{m\_parameterEnabledStatus}    (\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_a2ef17fbfc6a156f03bbfad044b5a75f5}{m\_vectorSpace}.
      \hyperlink{class_q_u_e_s_o_1_1_vector_space_a5829a1f4f996f8307c840b705144d666}{dimLocal}(),\textcolor{keyword}{true}), \textcolor{comment}{// gpmsa2}
145   \hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_ae7c7551764e0ccdfbe2862c544cdab10}{m\_targetPdfSynchronizer}     (\textcolor{keyword}{new} ScalarFunctionSynchronizer<P\_V,P\_M>(
      \hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_a42ce4ffcb3addf62dd3f19fe8bb09268}{m\_targetPdf},\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_ae29f5d1198228858283d733021da2b14}{m\_initialPosition})),
146   \hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_a26e9680abddfb793486c995fa16f8c2d}{m\_tk}                        (NULL),
147   \hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_a49500f5107190c94813e232cd806c2bc}{m\_positionIdForDebugging}    (0),
148   \hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_aca9351ab468808759b8b19686231ae4f}{m\_stageIdForDebugging}       (0),
149   \hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_ad1916a22b4a53ba67fa87f93c6e0a252}{m\_idsOfUniquePositions}      (0),\textcolor{comment}{//0.),}
150   \hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_ac33a6e46e05c20c071a46ecf58a9291c}{m\_logTargets}                (0),\textcolor{comment}{//0.),}
151   \hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_a6fd65985afd80114ece8b2b5fffe658d}{m\_alphaQuotients}            (0),\textcolor{comment}{//0.),}
152   \hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_a005d221d1c458ff767ed03304ca4cd6f}{m\_lastChainSize}             (0),
153   \hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_a9741f56d947e9d7967af91c6ea083b56}{m\_lastMean}                  (NULL),
154   \hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_a1c73b49339c8a1015d95a890d7882331}{m\_lastAdaptedCovMatrix}      (NULL),
155   \hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_a60695940f442f6568d10ee9e456032c7}{m\_numPositionsNotSubWritten} (0),
156 \textcolor{preprocessor}{#ifdef QUESO\_USES\_SEQUENCE\_STATISTICAL\_OPTIONS}
157 \textcolor{preprocessor}{}  \hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_add6eb8fa2e706ef1de9772f71c84d839}{m\_alternativeOptionsValues}  (NULL,NULL),
158 \textcolor{preprocessor}{#else}
159 \textcolor{preprocessor}{}  \hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_add6eb8fa2e706ef1de9772f71c84d839}{m\_alternativeOptionsValues}  (),
160 \textcolor{preprocessor}{#endif}
161 \textcolor{preprocessor}{}  \hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_a5d0bc9f73d50d272aa6bfb5ef5939ef3}{m\_optionsObj}                (NULL)
162 \{
163   \textcolor{keywordflow}{if} (inputProposalCovMatrix != NULL) \{
164     \hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_a4d9862afbafb34921e91de3d4610c6cd}{m\_initialProposalCovMatrix} = *inputProposalCovMatrix;
165   \}
166   \textcolor{keywordflow}{if} (alternativeOptionsValues) \hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_add6eb8fa2e706ef1de9772f71c84d839}{m\_alternativeOptionsValues} = *
      alternativeOptionsValues;
167   \textcolor{keywordflow}{if} (\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_ac8ea061e55b920e0c8f9bce5c3f20e52}{m\_env}.\hyperlink{class_q_u_e_s_o_1_1_base_environment_aa0e3ccfe00e6f51dbe6dd6b9b6f65183}{optionsInputFileName}() == \textcolor{stringliteral}{""}) \{
168     \hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_a5d0bc9f73d50d272aa6bfb5ef5939ef3}{m\_optionsObj} = \textcolor{keyword}{new} MetropolisHastingsSGOptions(\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_ac8ea061e55b920e0c8f9bce5c3f20e52}{m\_env},prefix,
      \hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_add6eb8fa2e706ef1de9772f71c84d839}{m\_alternativeOptionsValues});
169   \}
170   \textcolor{keywordflow}{else} \{
171     \hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_a5d0bc9f73d50d272aa6bfb5ef5939ef3}{m\_optionsObj} = \textcolor{keyword}{new} MetropolisHastingsSGOptions(\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_ac8ea061e55b920e0c8f9bce5c3f20e52}{m\_env},prefix);
172     \hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_a5d0bc9f73d50d272aa6bfb5ef5939ef3}{m\_optionsObj}->\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_options_a51455fb28b064d5dc2cc114c8448021b}{scanOptionsValues}();
173   \}
174 
175   \textcolor{keywordflow}{if} ((\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_ac8ea061e55b920e0c8f9bce5c3f20e52}{m\_env}.\hyperlink{class_q_u_e_s_o_1_1_base_environment_a8a0064746ae8dddfece4229b9ad374d6}{subDisplayFile}()                   ) &&
176       (\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_a5d0bc9f73d50d272aa6bfb5ef5939ef3}{m\_optionsObj}->\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_options_a9d4792d9fc2dc5439b8ab489b0c236eb}{m\_ov}.\hyperlink{class_q_u_e_s_o_1_1_mh_options_values_af812309e81191e88dfdc87c5815141a3}{m\_totallyMute} == \textcolor{keyword}{false})) \{
177     *\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_ac8ea061e55b920e0c8f9bce5c3f20e52}{m\_env}.\hyperlink{class_q_u_e_s_o_1_1_base_environment_a8a0064746ae8dddfece4229b9ad374d6}{subDisplayFile}() << \textcolor{stringliteral}{"Entering MetropolisHastingsSG<P\_V,P\_M>::constructor(1)"}
178                             << \textcolor{stringliteral}{": prefix = "} << prefix
179                             << \textcolor{stringliteral}{", alternativeOptionsValues = "} << alternativeOptionsValues
180                             << \textcolor{stringliteral}{", m\_env.optionsInputFileName() = "} << \hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_ac8ea061e55b920e0c8f9bce5c3f20e52}{m\_env}.
      \hyperlink{class_q_u_e_s_o_1_1_base_environment_aa0e3ccfe00e6f51dbe6dd6b9b6f65183}{optionsInputFileName}()
181                             << \textcolor{stringliteral}{", m\_initialProposalCovMatrix = "} << 
      \hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_a4d9862afbafb34921e91de3d4610c6cd}{m\_initialProposalCovMatrix}
182                             << std::endl;
183   \}
184 
185   \hyperlink{_defines_8h_a56d63d18d0a6d45757de47fcc06f574d}{UQ\_FATAL\_TEST\_MACRO}(sourceRv.\hyperlink{class_q_u_e_s_o_1_1_base_vector_r_v_aa4dd2f036228eac1f945bacc7147a922}{imageSet}().\hyperlink{class_q_u_e_s_o_1_1_vector_set_a923421590baf5bf93cf066e528f927dc}{vectorSpace}().
      \hyperlink{class_q_u_e_s_o_1_1_vector_space_a5829a1f4f996f8307c840b705144d666}{dimLocal}() != initialPosition.sizeLocal(),
186                       \hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_ac8ea061e55b920e0c8f9bce5c3f20e52}{m\_env}.\hyperlink{class_q_u_e_s_o_1_1_base_environment_a78b57112bbd0e6dd0e8afec00b40ffa7}{worldRank}(),
187                       \textcolor{stringliteral}{"MetropolisHastingsSG<P\_V,P\_M>::constructor(1)"},
188                       \textcolor{stringliteral}{"'sourceRv' and 'initialPosition' should have equal dimensions"});
189 
190   \textcolor{keywordflow}{if} (inputProposalCovMatrix) \{
191     \hyperlink{_defines_8h_a56d63d18d0a6d45757de47fcc06f574d}{UQ\_FATAL\_TEST\_MACRO}(sourceRv.\hyperlink{class_q_u_e_s_o_1_1_base_vector_r_v_aa4dd2f036228eac1f945bacc7147a922}{imageSet}().
      \hyperlink{class_q_u_e_s_o_1_1_vector_set_a923421590baf5bf93cf066e528f927dc}{vectorSpace}().\hyperlink{class_q_u_e_s_o_1_1_vector_space_a5829a1f4f996f8307c840b705144d666}{dimLocal}() != inputProposalCovMatrix->numRowsLocal(),
192                         \hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_ac8ea061e55b920e0c8f9bce5c3f20e52}{m\_env}.\hyperlink{class_q_u_e_s_o_1_1_base_environment_a78b57112bbd0e6dd0e8afec00b40ffa7}{worldRank}(),
193                         \textcolor{stringliteral}{"MetropolisHastingsSG<P\_V,P\_M>::constructor(1)"},
194                         \textcolor{stringliteral}{"'sourceRv' and 'inputProposalCovMatrix' should have equal dimensions"});
195     \hyperlink{_defines_8h_a56d63d18d0a6d45757de47fcc06f574d}{UQ\_FATAL\_TEST\_MACRO}(inputProposalCovMatrix->numCols() != inputProposalCovMatrix->
      numRowsGlobal(),
196                         \hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_ac8ea061e55b920e0c8f9bce5c3f20e52}{m\_env}.\hyperlink{class_q_u_e_s_o_1_1_base_environment_a78b57112bbd0e6dd0e8afec00b40ffa7}{worldRank}(),
197                         \textcolor{stringliteral}{"MetropolisHastingsSG<P\_V,P\_M>::constructor(1)"},
198                         \textcolor{stringliteral}{"'inputProposalCovMatrix' should be a square matrix"});
199   \}
200 
201   \hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_a38f0ec3feee117f6abe20c0a806f9c0a}{commonConstructor}();
202 
203   \textcolor{keywordflow}{if} ((\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_ac8ea061e55b920e0c8f9bce5c3f20e52}{m\_env}.\hyperlink{class_q_u_e_s_o_1_1_base_environment_a8a0064746ae8dddfece4229b9ad374d6}{subDisplayFile}()                   ) &&
204       (\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_a5d0bc9f73d50d272aa6bfb5ef5939ef3}{m\_optionsObj}->\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_options_a9d4792d9fc2dc5439b8ab489b0c236eb}{m\_ov}.\hyperlink{class_q_u_e_s_o_1_1_mh_options_values_af812309e81191e88dfdc87c5815141a3}{m\_totallyMute} == \textcolor{keyword}{false})) \{
205     *\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_ac8ea061e55b920e0c8f9bce5c3f20e52}{m\_env}.\hyperlink{class_q_u_e_s_o_1_1_base_environment_a8a0064746ae8dddfece4229b9ad374d6}{subDisplayFile}() << \textcolor{stringliteral}{"Leaving MetropolisHastingsSG<P\_V,P\_M>::constructor(1)"}
206                             << std::endl;
207   \}
208 \}
\end{DoxyCode}
\hypertarget{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_a76aacd5c5b50134dc97b0bb8a8d3c047}{\index{Q\-U\-E\-S\-O\-::\-Metropolis\-Hastings\-S\-G@{Q\-U\-E\-S\-O\-::\-Metropolis\-Hastings\-S\-G}!Metropolis\-Hastings\-S\-G@{Metropolis\-Hastings\-S\-G}}
\index{Metropolis\-Hastings\-S\-G@{Metropolis\-Hastings\-S\-G}!QUESO::MetropolisHastingsSG@{Q\-U\-E\-S\-O\-::\-Metropolis\-Hastings\-S\-G}}
\subsubsection[{Metropolis\-Hastings\-S\-G}]{\setlength{\rightskip}{0pt plus 5cm}template$<$class P\-\_\-\-V , class P\-\_\-\-M $>$ {\bf Q\-U\-E\-S\-O\-::\-Metropolis\-Hastings\-S\-G}$<$ P\-\_\-\-V, P\-\_\-\-M $>$\-::{\bf Metropolis\-Hastings\-S\-G} (
\begin{DoxyParamCaption}
\item[{const {\bf M\-L\-Sampling\-Level\-Options} \&}]{ml\-Options, }
\item[{const {\bf Base\-Vector\-R\-V}$<$ P\-\_\-\-V, P\-\_\-\-M $>$ \&}]{source\-Rv, }
\item[{const P\-\_\-\-V \&}]{initial\-Position, }
\item[{const P\-\_\-\-M $\ast$}]{input\-Proposal\-Cov\-Matrix}
\end{DoxyParamCaption}
)}}\label{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_a76aacd5c5b50134dc97b0bb8a8d3c047}


Constructor. 



Definition at line 211 of file Metropolis\-Hastings\-S\-G.\-C.



References Q\-U\-E\-S\-O\-::\-Metropolis\-Hastings\-S\-G$<$ P\-\_\-\-V, P\-\_\-\-M $>$\-::common\-Constructor(), Q\-U\-E\-S\-O\-::\-Metropolis\-Hastings\-S\-G$<$ P\-\_\-\-V, P\-\_\-\-M $>$\-::m\-\_\-env, Q\-U\-E\-S\-O\-::\-Metropolis\-Hastings\-S\-G$<$ P\-\_\-\-V, P\-\_\-\-M $>$\-::m\-\_\-initial\-Proposal\-Cov\-Matrix, Q\-U\-E\-S\-O\-::\-Metropolis\-Hastings\-S\-G$<$ P\-\_\-\-V, P\-\_\-\-M $>$\-::m\-\_\-options\-Obj, Q\-U\-E\-S\-O\-::\-Metropolis\-Hastings\-S\-G\-Options\-::m\-\_\-ov, Q\-U\-E\-S\-O\-::\-Mh\-Options\-Values\-::m\-\_\-totally\-Mute, and Q\-U\-E\-S\-O\-::\-Base\-Environment\-::sub\-Display\-File().


\begin{DoxyCode}
216   :
217   \hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_ac8ea061e55b920e0c8f9bce5c3f20e52}{m\_env}                       (sourceRv.\hyperlink{class_q_u_e_s_o_1_1_base_vector_r_v_ad5bf8486b3bacb46b9d4ecba513fd37b}{env}()),
218   \hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_a2ef17fbfc6a156f03bbfad044b5a75f5}{m\_vectorSpace}               (sourceRv.\hyperlink{class_q_u_e_s_o_1_1_base_vector_r_v_aa4dd2f036228eac1f945bacc7147a922}{imageSet}().
      \hyperlink{class_q_u_e_s_o_1_1_vector_set_a923421590baf5bf93cf066e528f927dc}{vectorSpace}()),
219   \hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_a42ce4ffcb3addf62dd3f19fe8bb09268}{m\_targetPdf}                 (sourceRv.\hyperlink{class_q_u_e_s_o_1_1_base_vector_r_v_a3206740e05e0c64a88273029e963b185}{pdf}()),
220   \hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_ae29f5d1198228858283d733021da2b14}{m\_initialPosition}           (initialPosition),
221   \hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_a4d9862afbafb34921e91de3d4610c6cd}{m\_initialProposalCovMatrix}  (\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_a2ef17fbfc6a156f03bbfad044b5a75f5}{m\_vectorSpace}.
      \hyperlink{class_q_u_e_s_o_1_1_vector_space_a92e963bb5cab3eecd290dfe4b8f03b04}{zeroVector}()),
222   \hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_a416c5ed0c8520d23a479d4a6d3c3c083}{m\_nullInputProposalCovMatrix}(inputProposalCovMatrix == NULL),
223   \hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_a43a883aa28c81ed99e5f0cd9de93889b}{m\_numDisabledParameters}     (0), \textcolor{comment}{// gpmsa2}
224   \hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_afce8eeadae98935c72727b3640e88a31}{m\_parameterEnabledStatus}    (\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_a2ef17fbfc6a156f03bbfad044b5a75f5}{m\_vectorSpace}.
      \hyperlink{class_q_u_e_s_o_1_1_vector_space_a5829a1f4f996f8307c840b705144d666}{dimLocal}(),\textcolor{keyword}{true}), \textcolor{comment}{// gpmsa2}
225   \hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_ae7c7551764e0ccdfbe2862c544cdab10}{m\_targetPdfSynchronizer}     (\textcolor{keyword}{new} ScalarFunctionSynchronizer<P\_V,P\_M>(
      \hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_a42ce4ffcb3addf62dd3f19fe8bb09268}{m\_targetPdf},\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_ae29f5d1198228858283d733021da2b14}{m\_initialPosition})),
226   \hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_a26e9680abddfb793486c995fa16f8c2d}{m\_tk}                        (NULL),
227   \hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_a49500f5107190c94813e232cd806c2bc}{m\_positionIdForDebugging}    (0),
228   \hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_aca9351ab468808759b8b19686231ae4f}{m\_stageIdForDebugging}       (0),
229   \hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_ad1916a22b4a53ba67fa87f93c6e0a252}{m\_idsOfUniquePositions}      (0),\textcolor{comment}{//0.),}
230   \hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_ac33a6e46e05c20c071a46ecf58a9291c}{m\_logTargets}                (0),\textcolor{comment}{//0.),}
231   \hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_a6fd65985afd80114ece8b2b5fffe658d}{m\_alphaQuotients}            (0),\textcolor{comment}{//0.),}
232   \hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_a005d221d1c458ff767ed03304ca4cd6f}{m\_lastChainSize}             (0),
233   \hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_a9741f56d947e9d7967af91c6ea083b56}{m\_lastMean}                  (NULL),
234   \hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_a1c73b49339c8a1015d95a890d7882331}{m\_lastAdaptedCovMatrix}      (NULL),
235 \textcolor{preprocessor}{#ifdef QUESO\_USES\_SEQUENCE\_STATISTICAL\_OPTIONS}
236 \textcolor{preprocessor}{}  \hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_add6eb8fa2e706ef1de9772f71c84d839}{m\_alternativeOptionsValues}  (NULL,NULL),
237 \textcolor{preprocessor}{#else}
238 \textcolor{preprocessor}{}  \hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_add6eb8fa2e706ef1de9772f71c84d839}{m\_alternativeOptionsValues}  (),
239 \textcolor{preprocessor}{#endif}
240 \textcolor{preprocessor}{}  \hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_a5d0bc9f73d50d272aa6bfb5ef5939ef3}{m\_optionsObj}                (\textcolor{keyword}{new} MetropolisHastingsSGOptions(mlOptions))
241 \{
242   \textcolor{keywordflow}{if} (inputProposalCovMatrix != NULL) \{
243     \hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_a4d9862afbafb34921e91de3d4610c6cd}{m\_initialProposalCovMatrix} = *inputProposalCovMatrix;
244     \textcolor{keywordflow}{if} ((\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_ac8ea061e55b920e0c8f9bce5c3f20e52}{m\_env}.\hyperlink{class_q_u_e_s_o_1_1_base_environment_a8a0064746ae8dddfece4229b9ad374d6}{subDisplayFile}()                   ) &&
245         (\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_a5d0bc9f73d50d272aa6bfb5ef5939ef3}{m\_optionsObj}->\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_options_a9d4792d9fc2dc5439b8ab489b0c236eb}{m\_ov}.\hyperlink{class_q_u_e_s_o_1_1_mh_options_values_af812309e81191e88dfdc87c5815141a3}{m\_totallyMute} == \textcolor{keyword}{false})) \{
246       *\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_ac8ea061e55b920e0c8f9bce5c3f20e52}{m\_env}.\hyperlink{class_q_u_e_s_o_1_1_base_environment_a8a0064746ae8dddfece4229b9ad374d6}{subDisplayFile}() << \textcolor{stringliteral}{"In MetropolisHastingsSG<P\_V,P\_M>::constructor(2)"}
247                               << \textcolor{stringliteral}{": just set m\_initialProposalCovMatrix = "} << 
      \hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_a4d9862afbafb34921e91de3d4610c6cd}{m\_initialProposalCovMatrix}
248                               << std::endl;
249     \}
250   \}
251   \textcolor{keywordflow}{if} ((\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_ac8ea061e55b920e0c8f9bce5c3f20e52}{m\_env}.\hyperlink{class_q_u_e_s_o_1_1_base_environment_a8a0064746ae8dddfece4229b9ad374d6}{subDisplayFile}()                   ) &&
252       (\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_a5d0bc9f73d50d272aa6bfb5ef5939ef3}{m\_optionsObj}->\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_options_a9d4792d9fc2dc5439b8ab489b0c236eb}{m\_ov}.\hyperlink{class_q_u_e_s_o_1_1_mh_options_values_af812309e81191e88dfdc87c5815141a3}{m\_totallyMute} == \textcolor{keyword}{false})) \{
253     *\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_ac8ea061e55b920e0c8f9bce5c3f20e52}{m\_env}.\hyperlink{class_q_u_e_s_o_1_1_base_environment_a8a0064746ae8dddfece4229b9ad374d6}{subDisplayFile}() << \textcolor{stringliteral}{"Entering MetropolisHastingsSG<P\_V,P\_M>::constructor(2)"}
254                             << std::endl;
255   \}
256 
257   \hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_a38f0ec3feee117f6abe20c0a806f9c0a}{commonConstructor}();
258 
259   \textcolor{keywordflow}{if} ((\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_ac8ea061e55b920e0c8f9bce5c3f20e52}{m\_env}.\hyperlink{class_q_u_e_s_o_1_1_base_environment_a8a0064746ae8dddfece4229b9ad374d6}{subDisplayFile}()                   ) &&
260       (\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_a5d0bc9f73d50d272aa6bfb5ef5939ef3}{m\_optionsObj}->\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_options_a9d4792d9fc2dc5439b8ab489b0c236eb}{m\_ov}.\hyperlink{class_q_u_e_s_o_1_1_mh_options_values_af812309e81191e88dfdc87c5815141a3}{m\_totallyMute} == \textcolor{keyword}{false})) \{
261     *\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_ac8ea061e55b920e0c8f9bce5c3f20e52}{m\_env}.\hyperlink{class_q_u_e_s_o_1_1_base_environment_a8a0064746ae8dddfece4229b9ad374d6}{subDisplayFile}() << \textcolor{stringliteral}{"Leaving MetropolisHastingsSG<P\_V,P\_M>::constructor(2)"}
262                             << std::endl;
263   \}
264 \}
\end{DoxyCode}
\hypertarget{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_a86d5903964a3c8a873ab119be1b030a9}{\index{Q\-U\-E\-S\-O\-::\-Metropolis\-Hastings\-S\-G@{Q\-U\-E\-S\-O\-::\-Metropolis\-Hastings\-S\-G}!$\sim$\-Metropolis\-Hastings\-S\-G@{$\sim$\-Metropolis\-Hastings\-S\-G}}
\index{$\sim$\-Metropolis\-Hastings\-S\-G@{$\sim$\-Metropolis\-Hastings\-S\-G}!QUESO::MetropolisHastingsSG@{Q\-U\-E\-S\-O\-::\-Metropolis\-Hastings\-S\-G}}
\subsubsection[{$\sim$\-Metropolis\-Hastings\-S\-G}]{\setlength{\rightskip}{0pt plus 5cm}template$<$class P\-\_\-\-V , class P\-\_\-\-M $>$ {\bf Q\-U\-E\-S\-O\-::\-Metropolis\-Hastings\-S\-G}$<$ P\-\_\-\-V, P\-\_\-\-M $>$\-::$\sim${\bf Metropolis\-Hastings\-S\-G} (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)}}\label{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_a86d5903964a3c8a873ab119be1b030a9}


Destructor. 



Definition at line 267 of file Metropolis\-Hastings\-S\-G.\-C.


\begin{DoxyCode}
268 \{
269   \textcolor{comment}{//if (m\_env.subDisplayFile()) \{}
270   \textcolor{comment}{//  *m\_env.subDisplayFile() << "Entering MetropolisHastingsSG<P\_V,P\_M>::destructor()"}
271   \textcolor{comment}{//                          << std::endl;}
272   \textcolor{comment}{//\}}
273 
274   \textcolor{keywordflow}{if} (\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_a1c73b49339c8a1015d95a890d7882331}{m\_lastAdaptedCovMatrix}) \textcolor{keyword}{delete} 
      \hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_a1c73b49339c8a1015d95a890d7882331}{m\_lastAdaptedCovMatrix};
275   \textcolor{keywordflow}{if} (\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_a9741f56d947e9d7967af91c6ea083b56}{m\_lastMean})             \textcolor{keyword}{delete} \hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_a9741f56d947e9d7967af91c6ea083b56}{m\_lastMean};
276   \hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_a005d221d1c458ff767ed03304ca4cd6f}{m\_lastChainSize}             = 0;
277   \hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_ac531509489028853bb17c0353fc9eafd}{m\_rawChainInfo}.\hyperlink{struct_q_u_e_s_o_1_1_m_h_raw_chain_info_struct_a366d78d7309ff99039bf005716ca18aa}{reset}();
278   \hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_a6fd65985afd80114ece8b2b5fffe658d}{m\_alphaQuotients}.clear();
279   \hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_ac33a6e46e05c20c071a46ecf58a9291c}{m\_logTargets}.clear();
280   \hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_a43a883aa28c81ed99e5f0cd9de93889b}{m\_numDisabledParameters}  = 0; \textcolor{comment}{// gpmsa2}
281   \hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_afce8eeadae98935c72727b3640e88a31}{m\_parameterEnabledStatus}.clear(); \textcolor{comment}{// gpmsa2}
282   \hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_a49500f5107190c94813e232cd806c2bc}{m\_positionIdForDebugging} = 0;
283   \hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_aca9351ab468808759b8b19686231ae4f}{m\_stageIdForDebugging}    = 0;
284   \hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_ad1916a22b4a53ba67fa87f93c6e0a252}{m\_idsOfUniquePositions}.clear();
285 
286   \textcolor{keywordflow}{if} (\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_a26e9680abddfb793486c995fa16f8c2d}{m\_tk}                   ) \textcolor{keyword}{delete} \hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_a26e9680abddfb793486c995fa16f8c2d}{m\_tk};
287   \textcolor{keywordflow}{if} (\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_ae7c7551764e0ccdfbe2862c544cdab10}{m\_targetPdfSynchronizer}) \textcolor{keyword}{delete} 
      \hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_ae7c7551764e0ccdfbe2862c544cdab10}{m\_targetPdfSynchronizer};
288   \textcolor{keywordflow}{if} (\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_a5d0bc9f73d50d272aa6bfb5ef5939ef3}{m\_optionsObj}           ) \textcolor{keyword}{delete} \hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_a5d0bc9f73d50d272aa6bfb5ef5939ef3}{m\_optionsObj};
289 
290   \textcolor{comment}{//if (m\_env.subDisplayFile()) \{}
291   \textcolor{comment}{//  *m\_env.subDisplayFile() << "Leaving MetropolisHastingsSG<P\_V,P\_M>::destructor()"}
292   \textcolor{comment}{//                          << std::endl;}
293   \textcolor{comment}{//\}}
294 \}
\end{DoxyCode}


\subsection{Member Function Documentation}
\hypertarget{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_abef3a3b60bc10db208864f6db09eeea8}{\index{Q\-U\-E\-S\-O\-::\-Metropolis\-Hastings\-S\-G@{Q\-U\-E\-S\-O\-::\-Metropolis\-Hastings\-S\-G}!accept\-Alpha@{accept\-Alpha}}
\index{accept\-Alpha@{accept\-Alpha}!QUESO::MetropolisHastingsSG@{Q\-U\-E\-S\-O\-::\-Metropolis\-Hastings\-S\-G}}
\subsubsection[{accept\-Alpha}]{\setlength{\rightskip}{0pt plus 5cm}template$<$class P\-\_\-\-V , class P\-\_\-\-M $>$ bool {\bf Q\-U\-E\-S\-O\-::\-Metropolis\-Hastings\-S\-G}$<$ P\-\_\-\-V, P\-\_\-\-M $>$\-::accept\-Alpha (
\begin{DoxyParamCaption}
\item[{double}]{alpha}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [private]}}}\label{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_abef3a3b60bc10db208864f6db09eeea8}


Decides whether or not to accept alpha. 

If either alpha is negative or greater than one, its value will not be accepted. 

Definition at line 712 of file Metropolis\-Hastings\-S\-G.\-C.


\begin{DoxyCode}
713 \{
714   \textcolor{keywordtype}{bool} result = \textcolor{keyword}{false};
715 
716   \textcolor{keywordflow}{if}      (\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_ad5c2b3afd5e845ea22518536274a8dd7}{alpha} <= 0.                                ) result = \textcolor{keyword}{false};
717   \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_ad5c2b3afd5e845ea22518536274a8dd7}{alpha} >= 1.                                ) result = \textcolor{keyword}{true};
718   \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_ad5c2b3afd5e845ea22518536274a8dd7}{alpha} >= \hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_ac8ea061e55b920e0c8f9bce5c3f20e52}{m\_env}.\hyperlink{class_q_u_e_s_o_1_1_base_environment_afc1f1258b770ac8e27cf308bbcd6a296}{rngObject}()->\hyperlink{class_q_u_e_s_o_1_1_rng_base_aed8342f0c8a4ac0a311cce9cac2b67e5}{uniformSample}()) result = \textcolor{keyword}{true};
719   \textcolor{keywordflow}{else}                                                  result = \textcolor{keyword}{false};
720 
721   \textcolor{keywordflow}{return} result;
722 \}
\end{DoxyCode}
\hypertarget{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_ad5c2b3afd5e845ea22518536274a8dd7}{\index{Q\-U\-E\-S\-O\-::\-Metropolis\-Hastings\-S\-G@{Q\-U\-E\-S\-O\-::\-Metropolis\-Hastings\-S\-G}!alpha@{alpha}}
\index{alpha@{alpha}!QUESO::MetropolisHastingsSG@{Q\-U\-E\-S\-O\-::\-Metropolis\-Hastings\-S\-G}}
\subsubsection[{alpha}]{\setlength{\rightskip}{0pt plus 5cm}template$<$class P\-\_\-\-V , class P\-\_\-\-M $>$ double {\bf Q\-U\-E\-S\-O\-::\-Metropolis\-Hastings\-S\-G}$<$ P\-\_\-\-V, P\-\_\-\-M $>$\-::alpha (
\begin{DoxyParamCaption}
\item[{const {\bf Markov\-Chain\-Position\-Data}$<$ P\-\_\-\-V $>$ \&}]{x, }
\item[{const {\bf Markov\-Chain\-Position\-Data}$<$ P\-\_\-\-V $>$ \&}]{y, }
\item[{unsigned int}]{x\-Stage\-Id, }
\item[{unsigned int}]{y\-Stage\-Id, }
\item[{double $\ast$}]{alpha\-Quotient\-Ptr = {\ttfamily NULL}}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [private]}}}\label{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_ad5c2b3afd5e845ea22518536274a8dd7}


Calculates acceptance ration. 

It is called by alpha(const std\-::vector$<$Markov\-Chain\-Position\-Data$<$\-P\-\_\-\-V$>$$\ast$$>$\& input\-Positions, const std\-::vector$<$unsigned int$>$\& input\-T\-K\-Stage\-Ids); 

Definition at line 393 of file Metropolis\-Hastings\-S\-G.\-C.



References Q\-U\-E\-S\-O\-::\-Gaussian\-Joint\-Pdf$<$ V, M $>$\-::law\-Cov\-Matrix(), Q\-U\-E\-S\-O\-::\-Gaussian\-Joint\-Pdf$<$ V, M $>$\-::law\-Exp\-Vector(), Q\-U\-E\-S\-O\-::\-Gaussian\-Joint\-Pdf$<$ V, M $>$\-::law\-Var\-Vector(), Q\-U\-E\-S\-O\-::\-Markov\-Chain\-Position\-Data$<$ V $>$\-::log\-Target(), Q\-U\-E\-S\-O\-::\-Markov\-Chain\-Position\-Data$<$ V $>$\-::out\-Of\-Target\-Support(), and Q\-U\-E\-S\-O\-::\-Markov\-Chain\-Position\-Data$<$ V $>$\-::vec\-Values().


\begin{DoxyCode}
399 \{
400   \textcolor{keywordtype}{double} alphaQuotient = 0.;
401   \textcolor{keywordflow}{if} ((x.outOfTargetSupport() == \textcolor{keyword}{false}) &&
402       (y.outOfTargetSupport() == \textcolor{keyword}{false})) \{
403     \textcolor{keywordflow}{if} ((x.logTarget() == -INFINITY) ||
404         (x.logTarget() ==  INFINITY) ||
405         ( (boost::math::isnan)(x.logTarget())      )) \{
406       std::cerr << \textcolor{stringliteral}{"WARNING In MetropolisHastingsSG<P\_V,P\_M>::alpha(x,y)"}
407                 << \textcolor{stringliteral}{", worldRank "}       << \hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_ac8ea061e55b920e0c8f9bce5c3f20e52}{m\_env}.\hyperlink{class_q_u_e_s_o_1_1_base_environment_a78b57112bbd0e6dd0e8afec00b40ffa7}{worldRank}()
408                 << \textcolor{stringliteral}{", fullRank "}        << \hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_ac8ea061e55b920e0c8f9bce5c3f20e52}{m\_env}.\hyperlink{class_q_u_e_s_o_1_1_base_environment_a84a239e42ae443cf71db6e03e8159620}{fullRank}()
409                 << \textcolor{stringliteral}{", subEnvironment "}  << \hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_ac8ea061e55b920e0c8f9bce5c3f20e52}{m\_env}.\hyperlink{class_q_u_e_s_o_1_1_base_environment_a6ae3174897a9b3a4c85fa18da5d4c16f}{subId}()
410                 << \textcolor{stringliteral}{", subRank "}         << \hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_ac8ea061e55b920e0c8f9bce5c3f20e52}{m\_env}.\hyperlink{class_q_u_e_s_o_1_1_base_environment_a172d52f993f1322ed45aaddf71518dbb}{subRank}()
411                 << \textcolor{stringliteral}{", inter0Rank "}      << \hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_ac8ea061e55b920e0c8f9bce5c3f20e52}{m\_env}.\hyperlink{class_q_u_e_s_o_1_1_base_environment_ae106b5bb8a80b655b88b3a26b1e7c185}{inter0Rank}()
412                 << \textcolor{stringliteral}{", positionId = "}    << \hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_a49500f5107190c94813e232cd806c2bc}{m\_positionIdForDebugging}
413                 << \textcolor{stringliteral}{", stageId = "}       << \hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_aca9351ab468808759b8b19686231ae4f}{m\_stageIdForDebugging}
414                 << \textcolor{stringliteral}{": x.logTarget() = "} << x.logTarget()
415                 << \textcolor{stringliteral}{", x.values() = "}    << x.vecValues()
416                 << \textcolor{stringliteral}{", y.values() = "}    << y.vecValues()
417                 << std::endl;
418     \}
419     \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} ((y.logTarget() == -INFINITY           ) ||
420              (y.logTarget() ==  INFINITY           ) ||
421              ( (boost::math::isnan)(y.logTarget()) )) \{
422       std::cerr << \textcolor{stringliteral}{"WARNING In MetropolisHastingsSG<P\_V,P\_M>::alpha(x,y)"}
423                 << \textcolor{stringliteral}{", worldRank "}       << \hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_ac8ea061e55b920e0c8f9bce5c3f20e52}{m\_env}.\hyperlink{class_q_u_e_s_o_1_1_base_environment_a78b57112bbd0e6dd0e8afec00b40ffa7}{worldRank}()
424                 << \textcolor{stringliteral}{", fullRank "}        << \hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_ac8ea061e55b920e0c8f9bce5c3f20e52}{m\_env}.\hyperlink{class_q_u_e_s_o_1_1_base_environment_a84a239e42ae443cf71db6e03e8159620}{fullRank}()
425                 << \textcolor{stringliteral}{", subEnvironment "}  << \hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_ac8ea061e55b920e0c8f9bce5c3f20e52}{m\_env}.\hyperlink{class_q_u_e_s_o_1_1_base_environment_a6ae3174897a9b3a4c85fa18da5d4c16f}{subId}()
426                 << \textcolor{stringliteral}{", subRank "}         << \hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_ac8ea061e55b920e0c8f9bce5c3f20e52}{m\_env}.\hyperlink{class_q_u_e_s_o_1_1_base_environment_a172d52f993f1322ed45aaddf71518dbb}{subRank}()
427                 << \textcolor{stringliteral}{", inter0Rank "}      << \hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_ac8ea061e55b920e0c8f9bce5c3f20e52}{m\_env}.\hyperlink{class_q_u_e_s_o_1_1_base_environment_ae106b5bb8a80b655b88b3a26b1e7c185}{inter0Rank}()
428                 << \textcolor{stringliteral}{", positionId = "}    << \hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_a49500f5107190c94813e232cd806c2bc}{m\_positionIdForDebugging}
429                 << \textcolor{stringliteral}{", stageId = "}       << \hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_aca9351ab468808759b8b19686231ae4f}{m\_stageIdForDebugging}
430                 << \textcolor{stringliteral}{": y.logTarget() = "} << y.logTarget()
431                 << \textcolor{stringliteral}{", x.values() = "}    << x.vecValues()
432                 << \textcolor{stringliteral}{", y.values() = "}    << y.vecValues()
433                 << std::endl;
434     \}
435     \textcolor{keywordflow}{else} \{
436       \textcolor{keywordtype}{double} yLogTargetToUse = y.logTarget();
437       \textcolor{keywordflow}{if} (\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_a26e9680abddfb793486c995fa16f8c2d}{m\_tk}->\hyperlink{class_q_u_e_s_o_1_1_base_t_k_group_ad0130349060d50b985c83b6bb1abc58e}{symmetric}()) \{
438         alphaQuotient = std::exp(yLogTargetToUse - x.logTarget());
439         \textcolor{keywordflow}{if} ((\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_ac8ea061e55b920e0c8f9bce5c3f20e52}{m\_env}.\hyperlink{class_q_u_e_s_o_1_1_base_environment_a8a0064746ae8dddfece4229b9ad374d6}{subDisplayFile}()                   ) &&
440             (\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_ac8ea061e55b920e0c8f9bce5c3f20e52}{m\_env}.\hyperlink{class_q_u_e_s_o_1_1_base_environment_a1fe5f244fc0316a0ab3e37463f108b96}{displayVerbosity}() >= 3            ) &&
441             (\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_a5d0bc9f73d50d272aa6bfb5ef5939ef3}{m\_optionsObj}->\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_options_a9d4792d9fc2dc5439b8ab489b0c236eb}{m\_ov}.\hyperlink{class_q_u_e_s_o_1_1_mh_options_values_af812309e81191e88dfdc87c5815141a3}{m\_totallyMute} == \textcolor{keyword}{false})) \{
442           *\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_ac8ea061e55b920e0c8f9bce5c3f20e52}{m\_env}.\hyperlink{class_q_u_e_s_o_1_1_base_environment_a8a0064746ae8dddfece4229b9ad374d6}{subDisplayFile}() << \textcolor{stringliteral}{"In MetropolisHastingsSG<P\_V,P\_M>::alpha(x,y)"}
443                                  << \textcolor{stringliteral}{": symmetric proposal case"}
444                                  << \textcolor{stringliteral}{", x = "}               << x.vecValues()
445                                  << \textcolor{stringliteral}{", y = "}               << y.vecValues()
446                                  << \textcolor{stringliteral}{", yLogTargetToUse = "} << yLogTargetToUse
447                                  << \textcolor{stringliteral}{", x.logTarget() = "}   << x.logTarget()
448                                  << \textcolor{stringliteral}{", alpha = "}           << alphaQuotient
449                                  << std::endl;
450         \}
451       \}
452       \textcolor{keywordflow}{else} \{
453 \textcolor{preprocessor}{#ifdef QUESO\_EXPECTS\_LN\_LIKELIHOOD\_INSTEAD\_OF\_MINUS\_2\_LN}
454 \textcolor{preprocessor}{}        \textcolor{keywordtype}{double} qyx = \hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_a26e9680abddfb793486c995fa16f8c2d}{m\_tk}->\hyperlink{class_q_u_e_s_o_1_1_base_t_k_group_a6bd8e0bec0105471aad8801cbf1a0851}{rv}(yStageId).pdf().lnValue(x.vecValues(),NULL,NULL,NULL,NULL);
455 \textcolor{preprocessor}{#else}
456 \textcolor{preprocessor}{}        \textcolor{keywordtype}{double} qyx = -.5 * \hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_a26e9680abddfb793486c995fa16f8c2d}{m\_tk}->\hyperlink{class_q_u_e_s_o_1_1_base_t_k_group_a6bd8e0bec0105471aad8801cbf1a0851}{rv}(yStageId).pdf().lnValue(x.vecValues(),NULL,NULL,NULL,NULL);
457 \textcolor{preprocessor}{#endif}
458 \textcolor{preprocessor}{}        \textcolor{keywordflow}{if} ((\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_ac8ea061e55b920e0c8f9bce5c3f20e52}{m\_env}.\hyperlink{class_q_u_e_s_o_1_1_base_environment_a8a0064746ae8dddfece4229b9ad374d6}{subDisplayFile}()                   ) &&
459             (\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_ac8ea061e55b920e0c8f9bce5c3f20e52}{m\_env}.\hyperlink{class_q_u_e_s_o_1_1_base_environment_a1fe5f244fc0316a0ab3e37463f108b96}{displayVerbosity}() >= 10           ) &&
460             (\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_a5d0bc9f73d50d272aa6bfb5ef5939ef3}{m\_optionsObj}->\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_options_a9d4792d9fc2dc5439b8ab489b0c236eb}{m\_ov}.\hyperlink{class_q_u_e_s_o_1_1_mh_options_values_af812309e81191e88dfdc87c5815141a3}{m\_totallyMute} == \textcolor{keyword}{false})) \{
461           \textcolor{keyword}{const} GaussianJointPdf<P\_V,P\_M>* pdfYX = \textcolor{keyword}{dynamic\_cast<} \textcolor{keyword}{const }GaussianJointPdf<P\_V,P\_M>* \textcolor{keyword}{>}(&(
      \hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_a26e9680abddfb793486c995fa16f8c2d}{m\_tk}->\hyperlink{class_q_u_e_s_o_1_1_base_t_k_group_a6bd8e0bec0105471aad8801cbf1a0851}{rv}(yStageId).pdf()));
462           *\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_ac8ea061e55b920e0c8f9bce5c3f20e52}{m\_env}.\hyperlink{class_q_u_e_s_o_1_1_base_environment_a8a0064746ae8dddfece4229b9ad374d6}{subDisplayFile}() << \textcolor{stringliteral}{"In MetropolisHastingsSG<P\_V,P\_M>::alpha(x,y)"}
463                                  << \textcolor{stringliteral}{", rvYX.lawExpVector = "} << pdfYX->lawExpVector()
464                                  << \textcolor{stringliteral}{", rvYX.lawVarVector = "} << pdfYX->lawVarVector()
465                                  << \textcolor{stringliteral}{", rvYX.lawCovMatrix = "} << pdfYX->lawCovMatrix()
466                                  << std::endl;
467         \}
468 \textcolor{preprocessor}{#ifdef QUESO\_EXPECTS\_LN\_LIKELIHOOD\_INSTEAD\_OF\_MINUS\_2\_LN}
469 \textcolor{preprocessor}{}        \textcolor{keywordtype}{double} qxy = \hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_a26e9680abddfb793486c995fa16f8c2d}{m\_tk}->\hyperlink{class_q_u_e_s_o_1_1_base_t_k_group_a6bd8e0bec0105471aad8801cbf1a0851}{rv}(xStageId).pdf().lnValue(y.vecValues(),NULL,NULL,NULL,NULL);
470 \textcolor{preprocessor}{#else}
471 \textcolor{preprocessor}{}        \textcolor{keywordtype}{double} qxy = -.5 * \hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_a26e9680abddfb793486c995fa16f8c2d}{m\_tk}->\hyperlink{class_q_u_e_s_o_1_1_base_t_k_group_a6bd8e0bec0105471aad8801cbf1a0851}{rv}(xStageId).pdf().lnValue(y.vecValues(),NULL,NULL,NULL,NULL);
472 \textcolor{preprocessor}{#endif}
473 \textcolor{preprocessor}{}        \textcolor{keywordflow}{if} ((\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_ac8ea061e55b920e0c8f9bce5c3f20e52}{m\_env}.\hyperlink{class_q_u_e_s_o_1_1_base_environment_a8a0064746ae8dddfece4229b9ad374d6}{subDisplayFile}()                   ) &&
474             (\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_ac8ea061e55b920e0c8f9bce5c3f20e52}{m\_env}.\hyperlink{class_q_u_e_s_o_1_1_base_environment_a1fe5f244fc0316a0ab3e37463f108b96}{displayVerbosity}() >= 10           ) &&
475             (\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_a5d0bc9f73d50d272aa6bfb5ef5939ef3}{m\_optionsObj}->\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_options_a9d4792d9fc2dc5439b8ab489b0c236eb}{m\_ov}.\hyperlink{class_q_u_e_s_o_1_1_mh_options_values_af812309e81191e88dfdc87c5815141a3}{m\_totallyMute} == \textcolor{keyword}{false})) \{
476           \textcolor{keyword}{const} GaussianJointPdf<P\_V,P\_M>* pdfXY = \textcolor{keyword}{dynamic\_cast<} \textcolor{keyword}{const }GaussianJointPdf<P\_V,P\_M>* \textcolor{keyword}{>}(&(
      \hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_a26e9680abddfb793486c995fa16f8c2d}{m\_tk}->\hyperlink{class_q_u_e_s_o_1_1_base_t_k_group_a6bd8e0bec0105471aad8801cbf1a0851}{rv}(xStageId).pdf()));
477           *\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_ac8ea061e55b920e0c8f9bce5c3f20e52}{m\_env}.\hyperlink{class_q_u_e_s_o_1_1_base_environment_a8a0064746ae8dddfece4229b9ad374d6}{subDisplayFile}() << \textcolor{stringliteral}{"In MetropolisHastingsSG<P\_V,P\_M>::alpha(x,y)"}
478                                  << \textcolor{stringliteral}{", rvXY.lawExpVector = "} << pdfXY->lawExpVector()
479                                  << \textcolor{stringliteral}{", rvXY.lawVarVector = "} << pdfXY->lawVarVector()
480                                  << \textcolor{stringliteral}{", rvXY.lawCovMatrix = "} << pdfXY->lawCovMatrix()
481                                  << std::endl;
482         \}
483         alphaQuotient = std::exp(yLogTargetToUse +
484                                  qyx -
485                                  x.logTarget() -
486                                  qxy);
487         \textcolor{keywordflow}{if} ((\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_ac8ea061e55b920e0c8f9bce5c3f20e52}{m\_env}.\hyperlink{class_q_u_e_s_o_1_1_base_environment_a8a0064746ae8dddfece4229b9ad374d6}{subDisplayFile}()                   ) &&
488             (\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_ac8ea061e55b920e0c8f9bce5c3f20e52}{m\_env}.\hyperlink{class_q_u_e_s_o_1_1_base_environment_a1fe5f244fc0316a0ab3e37463f108b96}{displayVerbosity}() >= 3            ) &&
489             (\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_a5d0bc9f73d50d272aa6bfb5ef5939ef3}{m\_optionsObj}->\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_options_a9d4792d9fc2dc5439b8ab489b0c236eb}{m\_ov}.\hyperlink{class_q_u_e_s_o_1_1_mh_options_values_af812309e81191e88dfdc87c5815141a3}{m\_totallyMute} == \textcolor{keyword}{false})) \{
490           *\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_ac8ea061e55b920e0c8f9bce5c3f20e52}{m\_env}.\hyperlink{class_q_u_e_s_o_1_1_base_environment_a8a0064746ae8dddfece4229b9ad374d6}{subDisplayFile}() << \textcolor{stringliteral}{"In MetropolisHastingsSG<P\_V,P\_M>::alpha(x,y)"}
491                                  << \textcolor{stringliteral}{": asymmetric proposal case"}
492                                  << \textcolor{stringliteral}{", xStageId = "}        << xStageId
493                                  << \textcolor{stringliteral}{", yStageId = "}        << yStageId
494                                  << \textcolor{stringliteral}{", x = "}               << x.vecValues()
495                                  << \textcolor{stringliteral}{", y = "}               << y.vecValues()
496                                  << \textcolor{stringliteral}{", yLogTargetToUse = "} << yLogTargetToUse
497                                  << \textcolor{stringliteral}{", q(y,x) = "}          << qyx
498                                  << \textcolor{stringliteral}{", x.logTarget() = "}   << x.logTarget()
499                                  << \textcolor{stringliteral}{", q(x,y) = "}          << qxy
500                                  << \textcolor{stringliteral}{", alpha = "}           << alphaQuotient
501                                  << std::endl;
502         \}
503       \}
504     \} \textcolor{comment}{// protection logic against logTarget values}
505   \}
506   \textcolor{keywordflow}{else} \{
507     \textcolor{keywordflow}{if} ((\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_ac8ea061e55b920e0c8f9bce5c3f20e52}{m\_env}.\hyperlink{class_q_u_e_s_o_1_1_base_environment_a8a0064746ae8dddfece4229b9ad374d6}{subDisplayFile}()                   ) &&
508         (\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_ac8ea061e55b920e0c8f9bce5c3f20e52}{m\_env}.\hyperlink{class_q_u_e_s_o_1_1_base_environment_a1fe5f244fc0316a0ab3e37463f108b96}{displayVerbosity}() >= 10           ) &&
509         (\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_a5d0bc9f73d50d272aa6bfb5ef5939ef3}{m\_optionsObj}->\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_options_a9d4792d9fc2dc5439b8ab489b0c236eb}{m\_ov}.\hyperlink{class_q_u_e_s_o_1_1_mh_options_values_af812309e81191e88dfdc87c5815141a3}{m\_totallyMute} == \textcolor{keyword}{false})) \{
510       *\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_ac8ea061e55b920e0c8f9bce5c3f20e52}{m\_env}.\hyperlink{class_q_u_e_s_o_1_1_base_environment_a8a0064746ae8dddfece4229b9ad374d6}{subDisplayFile}() << \textcolor{stringliteral}{"In MetropolisHastingsSG<P\_V,P\_M>::alpha(x,y)"}
511                              << \textcolor{stringliteral}{": x.outOfTargetSupport = "} << x.outOfTargetSupport()
512                              << \textcolor{stringliteral}{", y.outOfTargetSupport = "} << y.outOfTargetSupport()
513                              << std::endl;
514     \}
515   \}
516   \textcolor{keywordflow}{if} (alphaQuotientPtr != NULL) *alphaQuotientPtr = alphaQuotient;
517 
518   \textcolor{keywordflow}{return} std::min(1.,alphaQuotient);
519 \}
\end{DoxyCode}
\hypertarget{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_a2adeca5cc9cf99ea0b209eacfa42bd83}{\index{Q\-U\-E\-S\-O\-::\-Metropolis\-Hastings\-S\-G@{Q\-U\-E\-S\-O\-::\-Metropolis\-Hastings\-S\-G}!alpha@{alpha}}
\index{alpha@{alpha}!QUESO::MetropolisHastingsSG@{Q\-U\-E\-S\-O\-::\-Metropolis\-Hastings\-S\-G}}
\subsubsection[{alpha}]{\setlength{\rightskip}{0pt plus 5cm}template$<$class P\-\_\-\-V , class P\-\_\-\-M $>$ double {\bf Q\-U\-E\-S\-O\-::\-Metropolis\-Hastings\-S\-G}$<$ P\-\_\-\-V, P\-\_\-\-M $>$\-::alpha (
\begin{DoxyParamCaption}
\item[{const std\-::vector$<$ {\bf Markov\-Chain\-Position\-Data}$<$ P\-\_\-\-V $>$ $\ast$ $>$ \&}]{input\-Positions, }
\item[{const std\-::vector$<$ unsigned int $>$ \&}]{input\-T\-K\-Stage\-Ids}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [private]}}}\label{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_a2adeca5cc9cf99ea0b209eacfa42bd83}


Calculates acceptance ration. 

The acceptance ratio is used to decide whether to accept or reject a candidate. 

Definition at line 523 of file Metropolis\-Hastings\-S\-G.\-C.



References U\-Q\-\_\-\-F\-A\-T\-A\-L\-\_\-\-T\-E\-S\-T\-\_\-\-M\-A\-C\-R\-O.


\begin{DoxyCode}
526 \{
527   \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} inputSize = inputPositionsData.size();
528   \textcolor{keywordflow}{if} ((\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_ac8ea061e55b920e0c8f9bce5c3f20e52}{m\_env}.\hyperlink{class_q_u_e_s_o_1_1_base_environment_a8a0064746ae8dddfece4229b9ad374d6}{subDisplayFile}()                   ) &&
529       (\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_ac8ea061e55b920e0c8f9bce5c3f20e52}{m\_env}.\hyperlink{class_q_u_e_s_o_1_1_base_environment_a1fe5f244fc0316a0ab3e37463f108b96}{displayVerbosity}() >= 10           ) &&
530       (\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_a5d0bc9f73d50d272aa6bfb5ef5939ef3}{m\_optionsObj}->\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_options_a9d4792d9fc2dc5439b8ab489b0c236eb}{m\_ov}.\hyperlink{class_q_u_e_s_o_1_1_mh_options_values_af812309e81191e88dfdc87c5815141a3}{m\_totallyMute} == \textcolor{keyword}{false})) \{
531     *\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_ac8ea061e55b920e0c8f9bce5c3f20e52}{m\_env}.\hyperlink{class_q_u_e_s_o_1_1_base_environment_a8a0064746ae8dddfece4229b9ad374d6}{subDisplayFile}() << \textcolor{stringliteral}{"Entering MetropolisHastingsSG<P\_V,P\_M>::alpha(vec)"}
532                            << \textcolor{stringliteral}{", inputSize = "} << inputSize
533                            << std::endl;
534   \}
535   \hyperlink{_defines_8h_a56d63d18d0a6d45757de47fcc06f574d}{UQ\_FATAL\_TEST\_MACRO}((inputSize < 2),
536                       \hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_ac8ea061e55b920e0c8f9bce5c3f20e52}{m\_env}.\hyperlink{class_q_u_e_s_o_1_1_base_environment_a78b57112bbd0e6dd0e8afec00b40ffa7}{worldRank}(),
537                       \textcolor{stringliteral}{"MetropolisHastingsSG<P\_V,P\_M>::alpha(vec)"},
538                       \textcolor{stringliteral}{"inputPositionsData has size < 2"});
539 
540   \textcolor{comment}{// If necessary, return 0. right away}
541   \textcolor{keywordflow}{if} (inputPositionsData[0          ]->outOfTargetSupport()) \textcolor{keywordflow}{return} 0.;
542   \textcolor{keywordflow}{if} (inputPositionsData[inputSize-1]->outOfTargetSupport()) \textcolor{keywordflow}{return} 0.;
543 
544   \textcolor{keywordflow}{if} ((inputPositionsData[0]->logTarget() == -INFINITY           ) ||
545       (inputPositionsData[0]->logTarget() ==  INFINITY           ) ||
546       ( (boost::math::isnan)(inputPositionsData[0]->logTarget()) )) \{
547     std::cerr << \textcolor{stringliteral}{"WARNING In MetropolisHastingsSG<P\_V,P\_M>::alpha(vec)"}
548               << \textcolor{stringliteral}{", worldRank "}      << \hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_ac8ea061e55b920e0c8f9bce5c3f20e52}{m\_env}.\hyperlink{class_q_u_e_s_o_1_1_base_environment_a78b57112bbd0e6dd0e8afec00b40ffa7}{worldRank}()
549               << \textcolor{stringliteral}{", fullRank "}       << \hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_ac8ea061e55b920e0c8f9bce5c3f20e52}{m\_env}.\hyperlink{class_q_u_e_s_o_1_1_base_environment_a84a239e42ae443cf71db6e03e8159620}{fullRank}()
550               << \textcolor{stringliteral}{", subEnvironment "} << \hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_ac8ea061e55b920e0c8f9bce5c3f20e52}{m\_env}.\hyperlink{class_q_u_e_s_o_1_1_base_environment_a6ae3174897a9b3a4c85fa18da5d4c16f}{subId}()
551               << \textcolor{stringliteral}{", subRank "}        << \hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_ac8ea061e55b920e0c8f9bce5c3f20e52}{m\_env}.\hyperlink{class_q_u_e_s_o_1_1_base_environment_a172d52f993f1322ed45aaddf71518dbb}{subRank}()
552               << \textcolor{stringliteral}{", inter0Rank "}     << \hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_ac8ea061e55b920e0c8f9bce5c3f20e52}{m\_env}.\hyperlink{class_q_u_e_s_o_1_1_base_environment_ae106b5bb8a80b655b88b3a26b1e7c185}{inter0Rank}()
553               << \textcolor{stringliteral}{", positionId = "}   << \hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_a49500f5107190c94813e232cd806c2bc}{m\_positionIdForDebugging}
554               << \textcolor{stringliteral}{", stageId = "}      << \hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_aca9351ab468808759b8b19686231ae4f}{m\_stageIdForDebugging}
555               << \textcolor{stringliteral}{": inputSize = "}    << inputSize
556               << \textcolor{stringliteral}{", inputPositionsData[0]->logTarget() = "} << inputPositionsData[0]->logTarget()
557               << \textcolor{stringliteral}{", [0]->values() = "}                      << inputPositionsData[0]->vecValues()
558               << \textcolor{stringliteral}{", [inputSize - 1]->values() = "}          << inputPositionsData[inputSize-1]->vecValues()
559               << std::endl;
560     \textcolor{keywordflow}{return} 0.;
561   \}
562   \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} ((inputPositionsData[inputSize - 1]->logTarget() == -INFINITY           ) ||
563            (inputPositionsData[inputSize - 1]->logTarget() ==  INFINITY           ) ||
564            ( (boost::math::isnan)(inputPositionsData[inputSize - 1]->logTarget()) )) \{
565     std::cerr << \textcolor{stringliteral}{"WARNING In MetropolisHastingsSG<P\_V,P\_M>::alpha(vec)"}
566               << \textcolor{stringliteral}{", worldRank "}      << \hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_ac8ea061e55b920e0c8f9bce5c3f20e52}{m\_env}.\hyperlink{class_q_u_e_s_o_1_1_base_environment_a78b57112bbd0e6dd0e8afec00b40ffa7}{worldRank}()
567               << \textcolor{stringliteral}{", fullRank "}       << \hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_ac8ea061e55b920e0c8f9bce5c3f20e52}{m\_env}.\hyperlink{class_q_u_e_s_o_1_1_base_environment_a84a239e42ae443cf71db6e03e8159620}{fullRank}()
568               << \textcolor{stringliteral}{", subEnvironment "} << \hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_ac8ea061e55b920e0c8f9bce5c3f20e52}{m\_env}.\hyperlink{class_q_u_e_s_o_1_1_base_environment_a6ae3174897a9b3a4c85fa18da5d4c16f}{subId}()
569               << \textcolor{stringliteral}{", subRank "}        << \hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_ac8ea061e55b920e0c8f9bce5c3f20e52}{m\_env}.\hyperlink{class_q_u_e_s_o_1_1_base_environment_a172d52f993f1322ed45aaddf71518dbb}{subRank}()
570               << \textcolor{stringliteral}{", inter0Rank "}     << \hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_ac8ea061e55b920e0c8f9bce5c3f20e52}{m\_env}.\hyperlink{class_q_u_e_s_o_1_1_base_environment_ae106b5bb8a80b655b88b3a26b1e7c185}{inter0Rank}()
571               << \textcolor{stringliteral}{", positionId = "}   << \hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_a49500f5107190c94813e232cd806c2bc}{m\_positionIdForDebugging}
572               << \textcolor{stringliteral}{", stageId = "}      << \hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_aca9351ab468808759b8b19686231ae4f}{m\_stageIdForDebugging}
573               << \textcolor{stringliteral}{": inputSize = "}    << inputSize
574               << \textcolor{stringliteral}{", inputPositionsData[inputSize - 1]->logTarget() = "} << inputPositionsData[inputSize-1]->
      logTarget()
575               << \textcolor{stringliteral}{", [0]->values() = "}                                  << inputPositionsData[0]->vecValues(
      )
576               << \textcolor{stringliteral}{", [inputSize - 1]->values() = "}                      << inputPositionsData[inputSize-1]->
      vecValues()
577               << std::endl;
578     \textcolor{keywordflow}{return} 0.;
579   \}
580 
581   \textcolor{comment}{// If inputSize is 2, recursion is not needed}
582   \textcolor{keywordflow}{if} (inputSize == 2) \textcolor{keywordflow}{return} this->\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_ad5c2b3afd5e845ea22518536274a8dd7}{alpha}(*(inputPositionsData[0            ]),
583                                          *(inputPositionsData[inputSize - 1]),
584                                          inputTKStageIds[0],
585                                          inputTKStageIds[inputSize-1]);
586 
587   \textcolor{comment}{// Prepare two vectors of positions}
588   std::vector<MarkovChainPositionData<P\_V>*>         positionsData  (inputSize,NULL);
589   std::vector<MarkovChainPositionData<P\_V>*> backwardPositionsData  (inputSize,NULL);
590 
591   std::vector<unsigned int                        >         tkStageIds     (inputSize,0);
592   std::vector<unsigned int                        > backwardTKStageIds     (inputSize,0);
593 
594   std::vector<unsigned int                        >         tkStageIdsLess1(inputSize,0);
595   std::vector<unsigned int                        > backwardTKStageIdsLess1(inputSize,0);
596 
597   \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} i = 0; i < inputSize; ++i) \{
598             positionsData  [i] = inputPositionsData[i];
599     backwardPositionsData  [i] = inputPositionsData[inputSize-i-1];
600 
601             tkStageIds     [i] = inputTKStageIds   [i];
602     backwardTKStageIds     [i] = inputTKStageIds   [inputSize-i-1];
603 
604             tkStageIdsLess1[i] = inputTKStageIds   [i];
605     backwardTKStageIdsLess1[i] = inputTKStageIds   [inputSize-i-1];
606   \}
607 
608           tkStageIdsLess1.pop\_back();
609   backwardTKStageIdsLess1.pop\_back();
610 
611   \textcolor{comment}{// Initialize cumulative variables}
612   \textcolor{keywordtype}{double} logNumerator      = 0.;
613   \textcolor{keywordtype}{double} logDenominator    = 0.;
614   \textcolor{keywordtype}{double} alphasNumerator   = 1.;
615   \textcolor{keywordtype}{double} alphasDenominator = 1.;
616 
617   \textcolor{comment}{// Compute cumulative variables}
618   \textcolor{keyword}{const} P\_V& \_lastTKPosition         = \hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_a26e9680abddfb793486c995fa16f8c2d}{m\_tk}->\hyperlink{class_q_u_e_s_o_1_1_base_t_k_group_aa864c6cc07327a698f91cef72cdc35aa}{preComputingPosition}(        
      tkStageIds[inputSize-1]);
619   \textcolor{keyword}{const} P\_V& \_lastBackwardTKPosition = \hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_a26e9680abddfb793486c995fa16f8c2d}{m\_tk}->\hyperlink{class_q_u_e_s_o_1_1_base_t_k_group_aa864c6cc07327a698f91cef72cdc35aa}{preComputingPosition}(
      backwardTKStageIds[inputSize-1]);
620 
621 \textcolor{preprocessor}{#ifdef QUESO\_EXPECTS\_LN\_LIKELIHOOD\_INSTEAD\_OF\_MINUS\_2\_LN}
622 \textcolor{preprocessor}{}  \textcolor{keywordtype}{double} numContrib = \hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_a26e9680abddfb793486c995fa16f8c2d}{m\_tk}->\hyperlink{class_q_u_e_s_o_1_1_base_t_k_group_a6bd8e0bec0105471aad8801cbf1a0851}{rv}(backwardTKStageIdsLess1).pdf().lnValue(\_lastBackwardTKPosition,NULL,
      NULL,NULL,NULL);
623   \textcolor{keywordtype}{double} denContrib = \hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_a26e9680abddfb793486c995fa16f8c2d}{m\_tk}->\hyperlink{class_q_u_e_s_o_1_1_base_t_k_group_a6bd8e0bec0105471aad8801cbf1a0851}{rv}(        tkStageIdsLess1).pdf().lnValue(\_lastTKPosition        ,NULL,
      NULL,NULL,NULL);
624 \textcolor{preprocessor}{#else}
625 \textcolor{preprocessor}{}  \textcolor{keywordtype}{double} numContrib = -.5 * \hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_a26e9680abddfb793486c995fa16f8c2d}{m\_tk}->\hyperlink{class_q_u_e_s_o_1_1_base_t_k_group_a6bd8e0bec0105471aad8801cbf1a0851}{rv}(backwardTKStageIdsLess1).pdf().lnValue(\_lastBackwardTKPosition,
      NULL,NULL,NULL,NULL);
626   \textcolor{keywordtype}{double} denContrib = -.5 * \hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_a26e9680abddfb793486c995fa16f8c2d}{m\_tk}->\hyperlink{class_q_u_e_s_o_1_1_base_t_k_group_a6bd8e0bec0105471aad8801cbf1a0851}{rv}(        tkStageIdsLess1).pdf().lnValue(\_lastTKPosition        ,
      NULL,NULL,NULL,NULL);
627 \textcolor{preprocessor}{#endif}
628 \textcolor{preprocessor}{}  \textcolor{keywordflow}{if} ((\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_ac8ea061e55b920e0c8f9bce5c3f20e52}{m\_env}.\hyperlink{class_q_u_e_s_o_1_1_base_environment_a8a0064746ae8dddfece4229b9ad374d6}{subDisplayFile}()                   ) &&
629       (\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_ac8ea061e55b920e0c8f9bce5c3f20e52}{m\_env}.\hyperlink{class_q_u_e_s_o_1_1_base_environment_a1fe5f244fc0316a0ab3e37463f108b96}{displayVerbosity}() >= 10           ) &&
630       (\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_a5d0bc9f73d50d272aa6bfb5ef5939ef3}{m\_optionsObj}->\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_options_a9d4792d9fc2dc5439b8ab489b0c236eb}{m\_ov}.\hyperlink{class_q_u_e_s_o_1_1_mh_options_values_af812309e81191e88dfdc87c5815141a3}{m\_totallyMute} == \textcolor{keyword}{false})) \{
631     *\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_ac8ea061e55b920e0c8f9bce5c3f20e52}{m\_env}.\hyperlink{class_q_u_e_s_o_1_1_base_environment_a8a0064746ae8dddfece4229b9ad374d6}{subDisplayFile}() << \textcolor{stringliteral}{"In MetropolisHastingsSG<P\_V,P\_M>::alpha(vec)"}
632                            << \textcolor{stringliteral}{", inputSize = "}  << inputSize
633                            << \textcolor{stringliteral}{", before loop"}
634                            << \textcolor{stringliteral}{": numContrib = "} << numContrib
635                            << \textcolor{stringliteral}{", denContrib = "} << denContrib
636                            << std::endl;
637   \}
638   logNumerator   += numContrib;
639   logDenominator += denContrib;
640 
641   \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} i = 0; i < (inputSize-2); ++i) \{ \textcolor{comment}{// That is why size must be >= 2}
642             positionsData.pop\_back();
643     backwardPositionsData.pop\_back();
644 
645     \textcolor{keyword}{const} P\_V& lastTKPosition         = \hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_a26e9680abddfb793486c995fa16f8c2d}{m\_tk}->\hyperlink{class_q_u_e_s_o_1_1_base_t_k_group_aa864c6cc07327a698f91cef72cdc35aa}{preComputingPosition}(        
      tkStageIds[inputSize-2-i]);
646     \textcolor{keyword}{const} P\_V& lastBackwardTKPosition = \hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_a26e9680abddfb793486c995fa16f8c2d}{m\_tk}->\hyperlink{class_q_u_e_s_o_1_1_base_t_k_group_aa864c6cc07327a698f91cef72cdc35aa}{preComputingPosition}(
      backwardTKStageIds[inputSize-2-i]);
647 
648             tkStageIds.pop\_back();
649     backwardTKStageIds.pop\_back();
650 
651             tkStageIdsLess1.pop\_back();
652     backwardTKStageIdsLess1.pop\_back();
653 
654 \textcolor{preprocessor}{#ifdef QUESO\_EXPECTS\_LN\_LIKELIHOOD\_INSTEAD\_OF\_MINUS\_2\_LN}
655 \textcolor{preprocessor}{}    numContrib = \hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_a26e9680abddfb793486c995fa16f8c2d}{m\_tk}->\hyperlink{class_q_u_e_s_o_1_1_base_t_k_group_a6bd8e0bec0105471aad8801cbf1a0851}{rv}(backwardTKStageIdsLess1).pdf().lnValue(lastBackwardTKPosition,NULL,NULL,
      NULL,NULL);
656     denContrib = \hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_a26e9680abddfb793486c995fa16f8c2d}{m\_tk}->\hyperlink{class_q_u_e_s_o_1_1_base_t_k_group_a6bd8e0bec0105471aad8801cbf1a0851}{rv}(        tkStageIdsLess1).pdf().lnValue(lastTKPosition        ,NULL,NULL,
      NULL,NULL);
657 \textcolor{preprocessor}{#else}
658 \textcolor{preprocessor}{}    numContrib = -.5 * \hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_a26e9680abddfb793486c995fa16f8c2d}{m\_tk}->\hyperlink{class_q_u_e_s_o_1_1_base_t_k_group_a6bd8e0bec0105471aad8801cbf1a0851}{rv}(backwardTKStageIdsLess1).pdf().lnValue(lastBackwardTKPosition,NULL,
      NULL,NULL,NULL);
659     denContrib = -.5 * \hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_a26e9680abddfb793486c995fa16f8c2d}{m\_tk}->\hyperlink{class_q_u_e_s_o_1_1_base_t_k_group_a6bd8e0bec0105471aad8801cbf1a0851}{rv}(        tkStageIdsLess1).pdf().lnValue(lastTKPosition        ,NULL,
      NULL,NULL,NULL);
660 \textcolor{preprocessor}{#endif}
661 \textcolor{preprocessor}{}    \textcolor{keywordflow}{if} ((\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_ac8ea061e55b920e0c8f9bce5c3f20e52}{m\_env}.\hyperlink{class_q_u_e_s_o_1_1_base_environment_a8a0064746ae8dddfece4229b9ad374d6}{subDisplayFile}()                   ) &&
662         (\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_ac8ea061e55b920e0c8f9bce5c3f20e52}{m\_env}.\hyperlink{class_q_u_e_s_o_1_1_base_environment_a1fe5f244fc0316a0ab3e37463f108b96}{displayVerbosity}() >= 10           ) &&
663         (\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_a5d0bc9f73d50d272aa6bfb5ef5939ef3}{m\_optionsObj}->\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_options_a9d4792d9fc2dc5439b8ab489b0c236eb}{m\_ov}.\hyperlink{class_q_u_e_s_o_1_1_mh_options_values_af812309e81191e88dfdc87c5815141a3}{m\_totallyMute} == \textcolor{keyword}{false})) \{
664       *\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_ac8ea061e55b920e0c8f9bce5c3f20e52}{m\_env}.\hyperlink{class_q_u_e_s_o_1_1_base_environment_a8a0064746ae8dddfece4229b9ad374d6}{subDisplayFile}() << \textcolor{stringliteral}{"In MetropolisHastingsSG<P\_V,P\_M>::alpha(vec)"}
665                              << \textcolor{stringliteral}{", inputSize = "}  << inputSize
666                              << \textcolor{stringliteral}{", in loop, i = "} << i
667                              << \textcolor{stringliteral}{": numContrib = "} << numContrib
668                              << \textcolor{stringliteral}{", denContrib = "} << denContrib
669                              << std::endl;
670     \}
671     logNumerator   += numContrib;
672     logDenominator += denContrib;
673 
674     alphasNumerator   *= (1. - this->\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_ad5c2b3afd5e845ea22518536274a8dd7}{alpha}(backwardPositionsData,backwardTKStageIds));
675     alphasDenominator *= (1. - this->\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_ad5c2b3afd5e845ea22518536274a8dd7}{alpha}(        positionsData,        tkStageIds));
676   \}
677 
678   \textcolor{keywordtype}{double} numeratorLogTargetToUse = backwardPositionsData[0]->logTarget();
679   numContrib = numeratorLogTargetToUse;
680   denContrib = positionsData[0]->logTarget();
681   \textcolor{keywordflow}{if} ((\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_ac8ea061e55b920e0c8f9bce5c3f20e52}{m\_env}.\hyperlink{class_q_u_e_s_o_1_1_base_environment_a8a0064746ae8dddfece4229b9ad374d6}{subDisplayFile}()                   ) &&
682       (\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_ac8ea061e55b920e0c8f9bce5c3f20e52}{m\_env}.\hyperlink{class_q_u_e_s_o_1_1_base_environment_a1fe5f244fc0316a0ab3e37463f108b96}{displayVerbosity}() >= 10           ) &&
683       (\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_a5d0bc9f73d50d272aa6bfb5ef5939ef3}{m\_optionsObj}->\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_options_a9d4792d9fc2dc5439b8ab489b0c236eb}{m\_ov}.\hyperlink{class_q_u_e_s_o_1_1_mh_options_values_af812309e81191e88dfdc87c5815141a3}{m\_totallyMute} == \textcolor{keyword}{false})) \{
684     *\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_ac8ea061e55b920e0c8f9bce5c3f20e52}{m\_env}.\hyperlink{class_q_u_e_s_o_1_1_base_environment_a8a0064746ae8dddfece4229b9ad374d6}{subDisplayFile}() << \textcolor{stringliteral}{"In MetropolisHastingsSG<P\_V,P\_M>::alpha(vec)"}
685                            << \textcolor{stringliteral}{", inputSize = "}  << inputSize
686                            << \textcolor{stringliteral}{", after loop"}
687                            << \textcolor{stringliteral}{": numContrib = "} << numContrib
688                            << \textcolor{stringliteral}{", denContrib = "} << denContrib
689                            << std::endl;
690   \}
691   logNumerator   += numContrib;
692   logDenominator += denContrib;
693 
694   \textcolor{keywordflow}{if} ((\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_ac8ea061e55b920e0c8f9bce5c3f20e52}{m\_env}.\hyperlink{class_q_u_e_s_o_1_1_base_environment_a8a0064746ae8dddfece4229b9ad374d6}{subDisplayFile}()                   ) &&
695       (\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_ac8ea061e55b920e0c8f9bce5c3f20e52}{m\_env}.\hyperlink{class_q_u_e_s_o_1_1_base_environment_a1fe5f244fc0316a0ab3e37463f108b96}{displayVerbosity}() >= 10           ) &&
696       (\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_a5d0bc9f73d50d272aa6bfb5ef5939ef3}{m\_optionsObj}->\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_options_a9d4792d9fc2dc5439b8ab489b0c236eb}{m\_ov}.\hyperlink{class_q_u_e_s_o_1_1_mh_options_values_af812309e81191e88dfdc87c5815141a3}{m\_totallyMute} == \textcolor{keyword}{false})) \{
697     *\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_ac8ea061e55b920e0c8f9bce5c3f20e52}{m\_env}.\hyperlink{class_q_u_e_s_o_1_1_base_environment_a8a0064746ae8dddfece4229b9ad374d6}{subDisplayFile}() << \textcolor{stringliteral}{"Leaving MetropolisHastingsSG<P\_V,P\_M>::alpha(vec)"}
698                            << \textcolor{stringliteral}{", inputSize = "}         << inputSize
699                            << \textcolor{stringliteral}{": alphasNumerator = "}   << alphasNumerator
700                            << \textcolor{stringliteral}{", alphasDenominator = "} << alphasDenominator
701                            << \textcolor{stringliteral}{", logNumerator = "}      << logNumerator
702                            << \textcolor{stringliteral}{", logDenominator = "}    << logDenominator
703                            << std::endl;
704   \}
705 
706   \textcolor{comment}{// Return result}
707   \textcolor{keywordflow}{return} std::min(1.,(alphasNumerator/alphasDenominator)*std::exp(logNumerator-logDenominator));
708 \}
\end{DoxyCode}
\hypertarget{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_a38f0ec3feee117f6abe20c0a806f9c0a}{\index{Q\-U\-E\-S\-O\-::\-Metropolis\-Hastings\-S\-G@{Q\-U\-E\-S\-O\-::\-Metropolis\-Hastings\-S\-G}!common\-Constructor@{common\-Constructor}}
\index{common\-Constructor@{common\-Constructor}!QUESO::MetropolisHastingsSG@{Q\-U\-E\-S\-O\-::\-Metropolis\-Hastings\-S\-G}}
\subsubsection[{common\-Constructor}]{\setlength{\rightskip}{0pt plus 5cm}template$<$class P\-\_\-\-V , class P\-\_\-\-M $>$ void {\bf Q\-U\-E\-S\-O\-::\-Metropolis\-Hastings\-S\-G}$<$ P\-\_\-\-V, P\-\_\-\-M $>$\-::common\-Constructor (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [private]}}}\label{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_a38f0ec3feee117f6abe20c0a806f9c0a}


Reads the options values from the options input file. 

This method {\bfseries actually} reads the options input file, such as the value for the Delayed Rejection scales, the presence of Hessian covariance matrices and reads the user-\/provided initial proposal covariance matrix (alternative to local Hessians). 

Definition at line 299 of file Metropolis\-Hastings\-S\-G.\-C.



References U\-Q\-\_\-\-F\-A\-T\-A\-L\-\_\-\-T\-E\-S\-T\-\_\-\-M\-A\-C\-R\-O.



Referenced by Q\-U\-E\-S\-O\-::\-Metropolis\-Hastings\-S\-G$<$ P\-\_\-\-V, P\-\_\-\-M $>$\-::\-Metropolis\-Hastings\-S\-G().


\begin{DoxyCode}
300 \{
302   \textcolor{comment}{// Instantiate the appropriate TK (transition kernel)}
304 \textcolor{comment}{}  \textcolor{keywordflow}{if} ((\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_ac8ea061e55b920e0c8f9bce5c3f20e52}{m\_env}.\hyperlink{class_q_u_e_s_o_1_1_base_environment_a8a0064746ae8dddfece4229b9ad374d6}{subDisplayFile}()                   ) &&
305       (\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_a5d0bc9f73d50d272aa6bfb5ef5939ef3}{m\_optionsObj}->\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_options_a9d4792d9fc2dc5439b8ab489b0c236eb}{m\_ov}.\hyperlink{class_q_u_e_s_o_1_1_mh_options_values_af812309e81191e88dfdc87c5815141a3}{m\_totallyMute} == \textcolor{keyword}{false})) \{
306     *\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_ac8ea061e55b920e0c8f9bce5c3f20e52}{m\_env}.\hyperlink{class_q_u_e_s_o_1_1_base_environment_a8a0064746ae8dddfece4229b9ad374d6}{subDisplayFile}() << \textcolor{stringliteral}{"Entering
       MetropolisHastingsSG<P\_V,P\_M>::commonConstructor()"}
307                             << std::endl;
308   \}
309 
310   \textcolor{keywordflow}{if} (\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_a5d0bc9f73d50d272aa6bfb5ef5939ef3}{m\_optionsObj}->\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_options_a9d4792d9fc2dc5439b8ab489b0c236eb}{m\_ov}.\hyperlink{class_q_u_e_s_o_1_1_mh_options_values_a208c0eb1f88ee743b2710afb503c4b4d}{m\_initialPositionDataInputFileName}
       != \textcolor{stringliteral}{"."}) \{ \textcolor{comment}{// palms}
311     std::set<unsigned int> tmpSet;
312     tmpSet.insert(\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_ac8ea061e55b920e0c8f9bce5c3f20e52}{m\_env}.\hyperlink{class_q_u_e_s_o_1_1_base_environment_a6ae3174897a9b3a4c85fa18da5d4c16f}{subId}());
313     \hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_ae29f5d1198228858283d733021da2b14}{m\_initialPosition}.subReadContents((\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_a5d0bc9f73d50d272aa6bfb5ef5939ef3}{m\_optionsObj}->
      \hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_options_a9d4792d9fc2dc5439b8ab489b0c236eb}{m\_ov}.\hyperlink{class_q_u_e_s_o_1_1_mh_options_values_a208c0eb1f88ee743b2710afb503c4b4d}{m\_initialPositionDataInputFileName}+\textcolor{stringliteral}{"\_sub"}+
      \hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_ac8ea061e55b920e0c8f9bce5c3f20e52}{m\_env}.\hyperlink{class_q_u_e_s_o_1_1_base_environment_a73f7849acdd5d5ba15a3094fe18f258f}{subIdString}()),
314                                       \hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_a5d0bc9f73d50d272aa6bfb5ef5939ef3}{m\_optionsObj}->\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_options_a9d4792d9fc2dc5439b8ab489b0c236eb}{m\_ov}.
      \hyperlink{class_q_u_e_s_o_1_1_mh_options_values_ad5bdf1c0416c71aeef586e4c86b4d4be}{m\_initialPositionDataInputFileType},
315                                       tmpSet);
316     \textcolor{keywordflow}{if} ((\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_ac8ea061e55b920e0c8f9bce5c3f20e52}{m\_env}.\hyperlink{class_q_u_e_s_o_1_1_base_environment_a8a0064746ae8dddfece4229b9ad374d6}{subDisplayFile}()                   ) &&
317         (\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_a5d0bc9f73d50d272aa6bfb5ef5939ef3}{m\_optionsObj}->\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_options_a9d4792d9fc2dc5439b8ab489b0c236eb}{m\_ov}.\hyperlink{class_q_u_e_s_o_1_1_mh_options_values_af812309e81191e88dfdc87c5815141a3}{m\_totallyMute} == \textcolor{keyword}{false})) \{
318       *\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_ac8ea061e55b920e0c8f9bce5c3f20e52}{m\_env}.\hyperlink{class_q_u_e_s_o_1_1_base_environment_a8a0064746ae8dddfece4229b9ad374d6}{subDisplayFile}() << \textcolor{stringliteral}{"In MetropolisHastingsSG<P\_V,P\_M>::commonConstructor()"}
319                               << \textcolor{stringliteral}{": just read initial position contents = "} << 
      \hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_ae29f5d1198228858283d733021da2b14}{m\_initialPosition}
320                               << std::endl;
321     \}
322   \}
323 
324   \textcolor{keywordflow}{if} (\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_a5d0bc9f73d50d272aa6bfb5ef5939ef3}{m\_optionsObj}->\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_options_a9d4792d9fc2dc5439b8ab489b0c236eb}{m\_ov}.\hyperlink{class_q_u_e_s_o_1_1_mh_options_values_a88f45c280bb77a8a48d47504b8d9e898}{m\_parameterDisabledSet}.size() > 0) \{ \textcolor{comment}{//
       gpmsa2}
325     \textcolor{keywordflow}{for} (std::set<unsigned int>::iterator setIt = \hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_a5d0bc9f73d50d272aa6bfb5ef5939ef3}{m\_optionsObj}->\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_options_a9d4792d9fc2dc5439b8ab489b0c236eb}{m\_ov}.
      \hyperlink{class_q_u_e_s_o_1_1_mh_options_values_a88f45c280bb77a8a48d47504b8d9e898}{m\_parameterDisabledSet}.begin(); setIt != \hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_a5d0bc9f73d50d272aa6bfb5ef5939ef3}{m\_optionsObj}->
      \hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_options_a9d4792d9fc2dc5439b8ab489b0c236eb}{m\_ov}.\hyperlink{class_q_u_e_s_o_1_1_mh_options_values_a88f45c280bb77a8a48d47504b8d9e898}{m\_parameterDisabledSet}.end(); ++setIt) \{
326       \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} paramId = *setIt;
327       \textcolor{keywordflow}{if} (paramId < \hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_a2ef17fbfc6a156f03bbfad044b5a75f5}{m\_vectorSpace}.\hyperlink{class_q_u_e_s_o_1_1_vector_space_a5829a1f4f996f8307c840b705144d666}{dimLocal}()) \{
328         \hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_a43a883aa28c81ed99e5f0cd9de93889b}{m\_numDisabledParameters}++;
329         \hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_afce8eeadae98935c72727b3640e88a31}{m\_parameterEnabledStatus}[paramId] = \textcolor{keyword}{false};
330       \}
331     \}
332   \}
333 
334   std::vector<double> drScalesAll(\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_a5d0bc9f73d50d272aa6bfb5ef5939ef3}{m\_optionsObj}->\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_options_a9d4792d9fc2dc5439b8ab489b0c236eb}{m\_ov}.
      \hyperlink{class_q_u_e_s_o_1_1_mh_options_values_a37774da61eda0aaa92dbcc417944b2e2}{m\_drScalesForExtraStages}.size()+1,1.);
335   \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} i = 1; i < (\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_a5d0bc9f73d50d272aa6bfb5ef5939ef3}{m\_optionsObj}->\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_options_a9d4792d9fc2dc5439b8ab489b0c236eb}{m\_ov}.
      \hyperlink{class_q_u_e_s_o_1_1_mh_options_values_a37774da61eda0aaa92dbcc417944b2e2}{m\_drScalesForExtraStages}.size()+1); ++i) \{
336     drScalesAll[i] = \hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_a5d0bc9f73d50d272aa6bfb5ef5939ef3}{m\_optionsObj}->\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_options_a9d4792d9fc2dc5439b8ab489b0c236eb}{m\_ov}.\hyperlink{class_q_u_e_s_o_1_1_mh_options_values_a37774da61eda0aaa92dbcc417944b2e2}{m\_drScalesForExtraStages}[i-
      1];
337   \}
338   \textcolor{keywordflow}{if} (\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_a5d0bc9f73d50d272aa6bfb5ef5939ef3}{m\_optionsObj}->\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_options_a9d4792d9fc2dc5439b8ab489b0c236eb}{m\_ov}.\hyperlink{class_q_u_e_s_o_1_1_mh_options_values_a3fa3d465b07ea276e7b2aa68b897e4ec}{m\_tkUseLocalHessian}) \{ \textcolor{comment}{// sep2011}
339     \hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_a26e9680abddfb793486c995fa16f8c2d}{m\_tk} = \textcolor{keyword}{new} HessianCovMatricesTKGroup<P\_V,P\_M>(\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_a5d0bc9f73d50d272aa6bfb5ef5939ef3}{m\_optionsObj}->
      \hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_options_a4f7c510aaa530336d24259e2a89f5d0b}{m\_prefix}.c\_str(),
340                                                          \hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_a2ef17fbfc6a156f03bbfad044b5a75f5}{m\_vectorSpace},
341                                                          drScalesAll,
342                                                          *
      \hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_ae7c7551764e0ccdfbe2862c544cdab10}{m\_targetPdfSynchronizer});
343     \textcolor{keywordflow}{if} ((\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_ac8ea061e55b920e0c8f9bce5c3f20e52}{m\_env}.\hyperlink{class_q_u_e_s_o_1_1_base_environment_a8a0064746ae8dddfece4229b9ad374d6}{subDisplayFile}()                   ) &&
344         (\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_a5d0bc9f73d50d272aa6bfb5ef5939ef3}{m\_optionsObj}->\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_options_a9d4792d9fc2dc5439b8ab489b0c236eb}{m\_ov}.\hyperlink{class_q_u_e_s_o_1_1_mh_options_values_af812309e81191e88dfdc87c5815141a3}{m\_totallyMute} == \textcolor{keyword}{false})) \{
345       *\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_ac8ea061e55b920e0c8f9bce5c3f20e52}{m\_env}.\hyperlink{class_q_u_e_s_o_1_1_base_environment_a8a0064746ae8dddfece4229b9ad374d6}{subDisplayFile}() << \textcolor{stringliteral}{"In MetropolisHastingsSG<P\_V,P\_M>::commonConstructor()"}
346                               << \textcolor{stringliteral}{": just instantiated a 'HessianCovMatrices' TK class"}
347                               << std::endl;
348     \}
349   \}
350   \textcolor{keywordflow}{else} \{
351     \textcolor{keywordflow}{if} (\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_a5d0bc9f73d50d272aa6bfb5ef5939ef3}{m\_optionsObj}->\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_options_a9d4792d9fc2dc5439b8ab489b0c236eb}{m\_ov}.
      \hyperlink{class_q_u_e_s_o_1_1_mh_options_values_af4cc4b8f1cea9441c9243d3ada49796b}{m\_initialProposalCovMatrixDataInputFileName} != \textcolor{stringliteral}{"."}) \{ \textcolor{comment}{// palms}
352       std::set<unsigned int> tmpSet;
353       tmpSet.insert(\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_ac8ea061e55b920e0c8f9bce5c3f20e52}{m\_env}.\hyperlink{class_q_u_e_s_o_1_1_base_environment_a6ae3174897a9b3a4c85fa18da5d4c16f}{subId}());
354       \hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_a4d9862afbafb34921e91de3d4610c6cd}{m\_initialProposalCovMatrix}.subReadContents((
      \hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_a5d0bc9f73d50d272aa6bfb5ef5939ef3}{m\_optionsObj}->\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_options_a9d4792d9fc2dc5439b8ab489b0c236eb}{m\_ov}.\hyperlink{class_q_u_e_s_o_1_1_mh_options_values_af4cc4b8f1cea9441c9243d3ada49796b}{m\_initialProposalCovMatrixDataInputFileName}
      +\textcolor{stringliteral}{"\_sub"}+\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_ac8ea061e55b920e0c8f9bce5c3f20e52}{m\_env}.\hyperlink{class_q_u_e_s_o_1_1_base_environment_a73f7849acdd5d5ba15a3094fe18f258f}{subIdString}()),
355                                                  \hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_a5d0bc9f73d50d272aa6bfb5ef5939ef3}{m\_optionsObj}->\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_options_a9d4792d9fc2dc5439b8ab489b0c236eb}{m\_ov}.
      \hyperlink{class_q_u_e_s_o_1_1_mh_options_values_afd25d3ec572922fe1cf7ff39d431633e}{m\_initialProposalCovMatrixDataInputFileType},
356                                                  tmpSet);
357       \textcolor{keywordflow}{if} ((\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_ac8ea061e55b920e0c8f9bce5c3f20e52}{m\_env}.\hyperlink{class_q_u_e_s_o_1_1_base_environment_a8a0064746ae8dddfece4229b9ad374d6}{subDisplayFile}()                   ) &&
358           (\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_a5d0bc9f73d50d272aa6bfb5ef5939ef3}{m\_optionsObj}->\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_options_a9d4792d9fc2dc5439b8ab489b0c236eb}{m\_ov}.\hyperlink{class_q_u_e_s_o_1_1_mh_options_values_af812309e81191e88dfdc87c5815141a3}{m\_totallyMute} == \textcolor{keyword}{false})) \{
359         *\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_ac8ea061e55b920e0c8f9bce5c3f20e52}{m\_env}.\hyperlink{class_q_u_e_s_o_1_1_base_environment_a8a0064746ae8dddfece4229b9ad374d6}{subDisplayFile}() << \textcolor{stringliteral}{"In
       MetropolisHastingsSG<P\_V,P\_M>::commonConstructor()"}
360                                 << \textcolor{stringliteral}{": just read initial proposal cov matrix contents = "} << 
      \hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_a4d9862afbafb34921e91de3d4610c6cd}{m\_initialProposalCovMatrix}
361                                 << std::endl;
362       \}
363     \}
364     \textcolor{keywordflow}{else} \{
365       \hyperlink{_defines_8h_a56d63d18d0a6d45757de47fcc06f574d}{UQ\_FATAL\_TEST\_MACRO}(\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_a416c5ed0c8520d23a479d4a6d3c3c083}{m\_nullInputProposalCovMatrix},
366                           \hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_ac8ea061e55b920e0c8f9bce5c3f20e52}{m\_env}.\hyperlink{class_q_u_e_s_o_1_1_base_environment_a78b57112bbd0e6dd0e8afec00b40ffa7}{worldRank}(),
367                           \textcolor{stringliteral}{"MetropolisHastingsSG<P\_V,P\_M>::commonConstructor()"},
368                           \textcolor{stringliteral}{"proposal cov matrix should have been passed by user, since, according to the
       input algorithm options, local Hessians will not be used in the proposal"});
369     \}
370 
371     \hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_a26e9680abddfb793486c995fa16f8c2d}{m\_tk} = \textcolor{keyword}{new} ScaledCovMatrixTKGroup<P\_V,P\_M>(\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_a5d0bc9f73d50d272aa6bfb5ef5939ef3}{m\_optionsObj}->
      \hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_options_a4f7c510aaa530336d24259e2a89f5d0b}{m\_prefix}.c\_str(),
372                                                       \hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_a2ef17fbfc6a156f03bbfad044b5a75f5}{m\_vectorSpace},
373                                                       drScalesAll,
374                                                       \hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_a4d9862afbafb34921e91de3d4610c6cd}{m\_initialProposalCovMatrix})
      ;
375     \textcolor{keywordflow}{if} ((\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_ac8ea061e55b920e0c8f9bce5c3f20e52}{m\_env}.\hyperlink{class_q_u_e_s_o_1_1_base_environment_a8a0064746ae8dddfece4229b9ad374d6}{subDisplayFile}()                   ) &&
376         (\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_a5d0bc9f73d50d272aa6bfb5ef5939ef3}{m\_optionsObj}->\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_options_a9d4792d9fc2dc5439b8ab489b0c236eb}{m\_ov}.\hyperlink{class_q_u_e_s_o_1_1_mh_options_values_af812309e81191e88dfdc87c5815141a3}{m\_totallyMute} == \textcolor{keyword}{false})) \{
377       *\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_ac8ea061e55b920e0c8f9bce5c3f20e52}{m\_env}.\hyperlink{class_q_u_e_s_o_1_1_base_environment_a8a0064746ae8dddfece4229b9ad374d6}{subDisplayFile}() << \textcolor{stringliteral}{"In MetropolisHastingsSG<P\_V,P\_M>::commonConstructor()"}
378                               << \textcolor{stringliteral}{": just instantiated a 'ScaledCovMatrix' TK class"}
379                               << std::endl;
380     \}
381   \}
382 
383   \textcolor{keywordflow}{if} ((\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_ac8ea061e55b920e0c8f9bce5c3f20e52}{m\_env}.\hyperlink{class_q_u_e_s_o_1_1_base_environment_a8a0064746ae8dddfece4229b9ad374d6}{subDisplayFile}()                   ) &&
384       (\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_a5d0bc9f73d50d272aa6bfb5ef5939ef3}{m\_optionsObj}->\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_options_a9d4792d9fc2dc5439b8ab489b0c236eb}{m\_ov}.\hyperlink{class_q_u_e_s_o_1_1_mh_options_values_af812309e81191e88dfdc87c5815141a3}{m\_totallyMute} == \textcolor{keyword}{false})) \{
385     *\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_ac8ea061e55b920e0c8f9bce5c3f20e52}{m\_env}.\hyperlink{class_q_u_e_s_o_1_1_base_environment_a8a0064746ae8dddfece4229b9ad374d6}{subDisplayFile}() << \textcolor{stringliteral}{"Leaving
       MetropolisHastingsSG<P\_V,P\_M>::commonConstructor()"}
386                             << std::endl;
387   \}
388   \textcolor{keywordflow}{return};
389 \}
\end{DoxyCode}
\hypertarget{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_af904814eb149a8fcc8ca346f2c254337}{\index{Q\-U\-E\-S\-O\-::\-Metropolis\-Hastings\-S\-G@{Q\-U\-E\-S\-O\-::\-Metropolis\-Hastings\-S\-G}!generate\-Full\-Chain@{generate\-Full\-Chain}}
\index{generate\-Full\-Chain@{generate\-Full\-Chain}!QUESO::MetropolisHastingsSG@{Q\-U\-E\-S\-O\-::\-Metropolis\-Hastings\-S\-G}}
\subsubsection[{generate\-Full\-Chain}]{\setlength{\rightskip}{0pt plus 5cm}template$<$class P\-\_\-\-V , class P\-\_\-\-M $>$ void {\bf Q\-U\-E\-S\-O\-::\-Metropolis\-Hastings\-S\-G}$<$ P\-\_\-\-V, P\-\_\-\-M $>$\-::generate\-Full\-Chain (
\begin{DoxyParamCaption}
\item[{const P\-\_\-\-V \&}]{values\-Of1st\-Position, }
\item[{unsigned int}]{chain\-Size, }
\item[{{\bf Base\-Vector\-Sequence}$<$ P\-\_\-\-V, P\-\_\-\-M $>$ \&}]{working\-Chain, }
\item[{{\bf Scalar\-Sequence}$<$ double $>$ $\ast$}]{working\-Log\-Likelihood\-Values, }
\item[{{\bf Scalar\-Sequence}$<$ double $>$ $\ast$}]{working\-Log\-Target\-Values}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [private]}}}\label{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_af904814eb149a8fcc8ca346f2c254337}


This method generates the chain. 

Given the size of the chain, the values of the first position in the chain. It checks if the position is out of target pdf support, otherwise it calculates the value of both its likelihood and prior and adds the position to the chain. For the next positions, once they are generated, some tests are performed (such as unicity and the value of alpha) and the steps for the first position are repeated, including the optional Delayed Rejection and the adaptive Metropolis (adaptation of covariance matrix) steps. 

Definition at line 1270 of file Metropolis\-Hastings\-S\-G.\-C.



References Q\-U\-E\-S\-O\-::\-Base\-Vector\-Sequence$<$ V, M $>$\-::estimate\-Conv\-Brooks\-Gelman(), Q\-U\-E\-S\-O\-::\-Base\-Vector\-Sequence$<$ V, M $>$\-::get\-Position\-Values(), Q\-U\-E\-S\-O\-::\-Markov\-Chain\-Position\-Data$<$ V $>$\-::log\-Likelihood(), Q\-U\-E\-S\-O\-::\-Markov\-Chain\-Position\-Data$<$ V $>$\-::log\-Target(), Q\-U\-E\-S\-O\-::\-Misc\-Get\-Ellapsed\-Seconds(), Q\-U\-E\-S\-O\-::\-Base\-Vector\-Sequence$<$ V, M $>$\-::name(), Q\-U\-E\-S\-O\-::\-Sequence\-Of\-Vectors$<$ V, M $>$\-::resize\-Sequence(), Q\-U\-E\-S\-O\-::\-Scalar\-Sequence$<$ T $>$\-::resize\-Sequence(), Q\-U\-E\-S\-O\-::\-Base\-Vector\-Sequence$<$ V, M $>$\-::resize\-Sequence(), Q\-U\-E\-S\-O\-::\-Sequence\-Of\-Vectors$<$ V, M $>$\-::set\-Position\-Values(), Q\-U\-E\-S\-O\-::\-Base\-Vector\-Sequence$<$ V, M $>$\-::set\-Position\-Values(), Q\-U\-E\-S\-O\-::\-Base\-Vector\-Sequence$<$ V, M $>$\-::sub\-Sequence\-Size(), Q\-U\-E\-S\-O\-::\-Sequence\-Of\-Vectors$<$ V, M $>$\-::sub\-Sequence\-Size(), Q\-U\-E\-S\-O\-::\-Base\-Vector\-Sequence$<$ V, M $>$\-::sub\-Write\-Contents(), Q\-U\-E\-S\-O\-::\-Scalar\-Sequence$<$ T $>$\-::sub\-Write\-Contents(), Q\-U\-E\-S\-O\-::\-Scaled\-Cov\-Matrix\-T\-K\-Group$<$ V, M $>$\-::update\-Law\-Cov\-Matrix(), U\-Q\-\_\-\-F\-A\-T\-A\-L\-\_\-\-R\-C\-\_\-\-M\-A\-C\-R\-O, U\-Q\-\_\-\-F\-A\-T\-A\-L\-\_\-\-T\-E\-S\-T\-\_\-\-M\-A\-C\-R\-O, Q\-U\-E\-S\-O\-::\-U\-Q\-\_\-\-I\-N\-C\-O\-M\-P\-L\-E\-T\-E\-\_\-\-I\-M\-P\-L\-E\-M\-E\-N\-T\-A\-T\-I\-O\-N\-\_\-\-R\-C, Q\-U\-E\-S\-O\-::\-U\-Q\-\_\-\-M\-A\-T\-R\-I\-X\-\_\-\-I\-S\-\_\-\-N\-O\-T\-\_\-\-P\-O\-S\-\_\-\-D\-E\-F\-I\-N\-I\-T\-E\-\_\-\-R\-C, Q\-U\-E\-S\-O\-::\-U\-Q\-\_\-\-O\-K\-\_\-\-R\-C, and Q\-U\-E\-S\-O\-::\-Markov\-Chain\-Position\-Data$<$ V $>$\-::vec\-Values().


\begin{DoxyCode}
1276 \{
1277   \textcolor{comment}{//m\_env.syncPrintDebugMsg("Entering
       MetropolisHastingsSG<P\_V,P\_M>::generateFullChain()",3,3000000,m\_env.fullComm()); // Dangerous to barrier on fullComm ... // KAUST}
1278 
1279   \textcolor{keywordflow}{if} ((\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_ac8ea061e55b920e0c8f9bce5c3f20e52}{m\_env}.\hyperlink{class_q_u_e_s_o_1_1_base_environment_a8a0064746ae8dddfece4229b9ad374d6}{subDisplayFile}()                   ) &&
1280       (\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_a5d0bc9f73d50d272aa6bfb5ef5939ef3}{m\_optionsObj}->\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_options_a9d4792d9fc2dc5439b8ab489b0c236eb}{m\_ov}.\hyperlink{class_q_u_e_s_o_1_1_mh_options_values_af812309e81191e88dfdc87c5815141a3}{m\_totallyMute} == \textcolor{keyword}{false})) \{
1281     *\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_ac8ea061e55b920e0c8f9bce5c3f20e52}{m\_env}.\hyperlink{class_q_u_e_s_o_1_1_base_environment_a8a0064746ae8dddfece4229b9ad374d6}{subDisplayFile}() << \textcolor{stringliteral}{"Starting the generation of Markov chain "} << 
      workingChain.\hyperlink{class_q_u_e_s_o_1_1_base_vector_sequence_a48f6fe02cf77f4233d3bcdfef3870f19}{name}()
1282                             << \textcolor{stringliteral}{", with "}                                  << chainSize
1283                             << \textcolor{stringliteral}{" positions..."}
1284                             << std::endl;
1285   \}
1286 
1287   \textcolor{keywordtype}{int} iRC = \hyperlink{namespace_q_u_e_s_o_a8e909502900aecf24cedba022ea84471}{UQ\_OK\_RC};
1288   \textcolor{keyword}{struct }timeval timevalChain;
1289   \textcolor{keyword}{struct }timeval timevalCandidate;
1290   \textcolor{keyword}{struct }timeval timevalTarget;
1291   \textcolor{keyword}{struct }timeval timevalMhAlpha;
1292   \textcolor{keyword}{struct }timeval timevalDrAlpha;
1293   \textcolor{keyword}{struct }timeval timevalDR;
1294   \textcolor{keyword}{struct }timeval timevalAM;
1295 
1296   \hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_a49500f5107190c94813e232cd806c2bc}{m\_positionIdForDebugging} = 0;
1297   \hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_aca9351ab468808759b8b19686231ae4f}{m\_stageIdForDebugging}    = 0;
1298 
1299   \hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_ac531509489028853bb17c0353fc9eafd}{m\_rawChainInfo}.\hyperlink{struct_q_u_e_s_o_1_1_m_h_raw_chain_info_struct_a366d78d7309ff99039bf005716ca18aa}{reset}();
1300 
1301   iRC = gettimeofday(&timevalChain, NULL);
1302 
1303   \textcolor{keywordflow}{if} ((\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_ac8ea061e55b920e0c8f9bce5c3f20e52}{m\_env}.\hyperlink{class_q_u_e_s_o_1_1_base_environment_a8a0064746ae8dddfece4229b9ad374d6}{subDisplayFile}()                   ) &&
1304       (\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_a5d0bc9f73d50d272aa6bfb5ef5939ef3}{m\_optionsObj}->\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_options_a9d4792d9fc2dc5439b8ab489b0c236eb}{m\_ov}.\hyperlink{class_q_u_e_s_o_1_1_mh_options_values_af812309e81191e88dfdc87c5815141a3}{m\_totallyMute} == \textcolor{keyword}{false})) \{
1305     *\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_ac8ea061e55b920e0c8f9bce5c3f20e52}{m\_env}.\hyperlink{class_q_u_e_s_o_1_1_base_environment_a8a0064746ae8dddfece4229b9ad374d6}{subDisplayFile}() << \textcolor{stringliteral}{"\(\backslash\)nIn MetropolisHastingsSG<P\_V,P\_M>::generateFullChain()"}
1306                             << \textcolor{stringliteral}{": contents of initial position are:"};
1307     *\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_ac8ea061e55b920e0c8f9bce5c3f20e52}{m\_env}.\hyperlink{class_q_u_e_s_o_1_1_base_environment_a8a0064746ae8dddfece4229b9ad374d6}{subDisplayFile}() << valuesOf1stPosition; \textcolor{comment}{// FIX ME: might need parallelism}
1308     *\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_ac8ea061e55b920e0c8f9bce5c3f20e52}{m\_env}.\hyperlink{class_q_u_e_s_o_1_1_base_environment_a8a0064746ae8dddfece4229b9ad374d6}{subDisplayFile}() << \textcolor{stringliteral}{"\(\backslash\)nIn MetropolisHastingsSG<P\_V,P\_M>::generateFullChain()"}
1309                             << \textcolor{stringliteral}{": targetPdf.domaintSet() info is:"}
1310                             << \hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_a42ce4ffcb3addf62dd3f19fe8bb09268}{m\_targetPdf}.\hyperlink{class_q_u_e_s_o_1_1_base_scalar_function_ad0937628825249dd36ded3ce0c7959ac}{domainSet}();
1311     *\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_ac8ea061e55b920e0c8f9bce5c3f20e52}{m\_env}.\hyperlink{class_q_u_e_s_o_1_1_base_environment_a8a0064746ae8dddfece4229b9ad374d6}{subDisplayFile}() << std::endl;
1312   \}
1313 
1314   \textcolor{keywordtype}{bool} outOfTargetSupport = !\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_a42ce4ffcb3addf62dd3f19fe8bb09268}{m\_targetPdf}.\hyperlink{class_q_u_e_s_o_1_1_base_scalar_function_ad0937628825249dd36ded3ce0c7959ac}{domainSet}().contains(valuesOf1stPosition);
1315   \textcolor{keywordflow}{if} ((\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_ac8ea061e55b920e0c8f9bce5c3f20e52}{m\_env}.\hyperlink{class_q_u_e_s_o_1_1_base_environment_a8a0064746ae8dddfece4229b9ad374d6}{subDisplayFile}()) &&
1316       (outOfTargetSupport    )) \{
1317     *\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_ac8ea061e55b920e0c8f9bce5c3f20e52}{m\_env}.\hyperlink{class_q_u_e_s_o_1_1_base_environment_a8a0064746ae8dddfece4229b9ad374d6}{subDisplayFile}() << \textcolor{stringliteral}{"ERROR: In
       MetropolisHastingsSG<P\_V,P\_M>::generateFullChain()"}
1318                             << \textcolor{stringliteral}{": contents of initial position are:\(\backslash\)n"};
1319     *\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_ac8ea061e55b920e0c8f9bce5c3f20e52}{m\_env}.\hyperlink{class_q_u_e_s_o_1_1_base_environment_a8a0064746ae8dddfece4229b9ad374d6}{subDisplayFile}() << valuesOf1stPosition; \textcolor{comment}{// FIX ME: might need parallelism}
1320     *\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_ac8ea061e55b920e0c8f9bce5c3f20e52}{m\_env}.\hyperlink{class_q_u_e_s_o_1_1_base_environment_a8a0064746ae8dddfece4229b9ad374d6}{subDisplayFile}() << \textcolor{stringliteral}{"\(\backslash\)nERROR: In
       MetropolisHastingsSG<P\_V,P\_M>::generateFullChain()"}
1321                             << \textcolor{stringliteral}{": targetPdf.domaintSet() info is:\(\backslash\)n"}
1322                             << \hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_a42ce4ffcb3addf62dd3f19fe8bb09268}{m\_targetPdf}.\hyperlink{class_q_u_e_s_o_1_1_base_scalar_function_ad0937628825249dd36ded3ce0c7959ac}{domainSet}();
1323     *\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_ac8ea061e55b920e0c8f9bce5c3f20e52}{m\_env}.\hyperlink{class_q_u_e_s_o_1_1_base_environment_a8a0064746ae8dddfece4229b9ad374d6}{subDisplayFile}() << std::endl;
1324   \}
1325   \hyperlink{_defines_8h_a56d63d18d0a6d45757de47fcc06f574d}{UQ\_FATAL\_TEST\_MACRO}(outOfTargetSupport,
1326                       \hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_ac8ea061e55b920e0c8f9bce5c3f20e52}{m\_env}.\hyperlink{class_q_u_e_s_o_1_1_base_environment_a78b57112bbd0e6dd0e8afec00b40ffa7}{worldRank}(),
1327                       \textcolor{stringliteral}{"MetropolisHastingsSG<P\_V,P\_M>::generateFullChain()"},
1328                       \textcolor{stringliteral}{"initial position should not be out of target pdf support"});
1329   \textcolor{keywordflow}{if} (\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_a5d0bc9f73d50d272aa6bfb5ef5939ef3}{m\_optionsObj}->\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_options_a9d4792d9fc2dc5439b8ab489b0c236eb}{m\_ov}.\hyperlink{class_q_u_e_s_o_1_1_mh_options_values_a6fcc2efc9146b68548e62d707aeed883}{m\_rawChainMeasureRunTimes}) iRC = 
      gettimeofday(&timevalTarget, NULL);
1330   \textcolor{keywordtype}{double} logPrior      = 0.;
1331   \textcolor{keywordtype}{double} logLikelihood = 0.;
1332 \textcolor{preprocessor}{#ifdef QUESO\_EXPECTS\_LN\_LIKELIHOOD\_INSTEAD\_OF\_MINUS\_2\_LN}
1333 \textcolor{preprocessor}{}  \textcolor{keywordtype}{double} logTarget =        \hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_ae7c7551764e0ccdfbe2862c544cdab10}{m\_targetPdfSynchronizer}->
      \hyperlink{class_q_u_e_s_o_1_1_scalar_function_synchronizer_adcdc70486ac64c11d0e505c4fb590a6b}{callFunction}(&valuesOf1stPosition,NULL,NULL,NULL,NULL,&logPrior,&logLikelihood); \textcolor{comment}{// Might
       demand parallel environment // KEY}
1334 \textcolor{preprocessor}{#else}
1335 \textcolor{preprocessor}{}  \textcolor{keywordtype}{double} logTarget = -0.5 * \hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_ae7c7551764e0ccdfbe2862c544cdab10}{m\_targetPdfSynchronizer}->
      \hyperlink{class_q_u_e_s_o_1_1_scalar_function_synchronizer_adcdc70486ac64c11d0e505c4fb590a6b}{callFunction}(&valuesOf1stPosition,NULL,NULL,NULL,NULL,&logPrior,&logLikelihood); \textcolor{comment}{// Might
       demand parallel environment}
1336 \textcolor{preprocessor}{#endif}
1337 \textcolor{preprocessor}{}  \textcolor{keywordflow}{if} (\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_a5d0bc9f73d50d272aa6bfb5ef5939ef3}{m\_optionsObj}->\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_options_a9d4792d9fc2dc5439b8ab489b0c236eb}{m\_ov}.\hyperlink{class_q_u_e_s_o_1_1_mh_options_values_a6fcc2efc9146b68548e62d707aeed883}{m\_rawChainMeasureRunTimes}) 
      \hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_ac531509489028853bb17c0353fc9eafd}{m\_rawChainInfo}.\hyperlink{struct_q_u_e_s_o_1_1_m_h_raw_chain_info_struct_ab230db8f99e46f0c1e4fc6c2aa3773eb}{targetRunTime} += 
      \hyperlink{namespace_q_u_e_s_o_a424bc33f2e6e287fd468408d14b772ee}{MiscGetEllapsedSeconds}(&timevalTarget);
1338   \hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_ac531509489028853bb17c0353fc9eafd}{m\_rawChainInfo}.\hyperlink{struct_q_u_e_s_o_1_1_m_h_raw_chain_info_struct_a506e08bdffc1f777e33c7ec2d7862747}{numTargetCalls}++;
1339   \textcolor{keywordflow}{if} ((\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_ac8ea061e55b920e0c8f9bce5c3f20e52}{m\_env}.\hyperlink{class_q_u_e_s_o_1_1_base_environment_a8a0064746ae8dddfece4229b9ad374d6}{subDisplayFile}()                   ) &&
1340       (\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_ac8ea061e55b920e0c8f9bce5c3f20e52}{m\_env}.\hyperlink{class_q_u_e_s_o_1_1_base_environment_a1fe5f244fc0316a0ab3e37463f108b96}{displayVerbosity}() >= 3            ) &&
1341       (\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_a5d0bc9f73d50d272aa6bfb5ef5939ef3}{m\_optionsObj}->\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_options_a9d4792d9fc2dc5439b8ab489b0c236eb}{m\_ov}.\hyperlink{class_q_u_e_s_o_1_1_mh_options_values_af812309e81191e88dfdc87c5815141a3}{m\_totallyMute} == \textcolor{keyword}{false})) \{
1342     *\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_ac8ea061e55b920e0c8f9bce5c3f20e52}{m\_env}.\hyperlink{class_q_u_e_s_o_1_1_base_environment_a8a0064746ae8dddfece4229b9ad374d6}{subDisplayFile}() << \textcolor{stringliteral}{"In MetropolisHastingsSG<P\_V,P\_M>::generateFullChain()"}
1343                             << \textcolor{stringliteral}{": just returned from likelihood() for initial chain position"}
1344                             << \textcolor{stringliteral}{", m\_rawChainInfo.numTargetCalls = "} << 
      \hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_ac531509489028853bb17c0353fc9eafd}{m\_rawChainInfo}.\hyperlink{struct_q_u_e_s_o_1_1_m_h_raw_chain_info_struct_a506e08bdffc1f777e33c7ec2d7862747}{numTargetCalls}
1345                             << \textcolor{stringliteral}{", logPrior = "}      << logPrior
1346                             << \textcolor{stringliteral}{", logLikelihood = "} << logLikelihood
1347                             << \textcolor{stringliteral}{", logTarget = "}     << logTarget
1348                             << std::endl;
1349   \}
1350 
1351   \textcolor{comment}{//*m\_env.subDisplayFile() << "AQUI 001" << std::endl;}
1352   MarkovChainPositionData<P\_V> currentPositionData(\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_ac8ea061e55b920e0c8f9bce5c3f20e52}{m\_env},
1353                                                           valuesOf1stPosition,
1354                                                           outOfTargetSupport,
1355                                                           logLikelihood,
1356                                                           logTarget);
1357 
1358   P\_V gaussianVector(\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_a2ef17fbfc6a156f03bbfad044b5a75f5}{m\_vectorSpace}.\hyperlink{class_q_u_e_s_o_1_1_vector_space_a92e963bb5cab3eecd290dfe4b8f03b04}{zeroVector}());
1359   P\_V tmpVecValues(\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_a2ef17fbfc6a156f03bbfad044b5a75f5}{m\_vectorSpace}.\hyperlink{class_q_u_e_s_o_1_1_vector_space_a92e963bb5cab3eecd290dfe4b8f03b04}{zeroVector}());
1360   MarkovChainPositionData<P\_V> currentCandidateData(\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_ac8ea061e55b920e0c8f9bce5c3f20e52}{m\_env});
1361 
1362   \textcolor{comment}{//****************************************************}
1363   \textcolor{comment}{// Set chain position with positionId = 0}
1364   \textcolor{comment}{//****************************************************}
1365   workingChain.\hyperlink{class_q_u_e_s_o_1_1_base_vector_sequence_adc238af7f6e8af2402ab791de7d60af5}{resizeSequence}(chainSize);
1366   \hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_a60695940f442f6568d10ee9e456032c7}{m\_numPositionsNotSubWritten} = 0;
1367   \textcolor{keywordflow}{if} (workingLogLikelihoodValues) workingLogLikelihoodValues->\hyperlink{class_q_u_e_s_o_1_1_scalar_sequence_a2aa8d77c39927060227275b12b6d3dd0}{resizeSequence}(chainSize);
1368   \textcolor{keywordflow}{if} (workingLogTargetValues    ) workingLogTargetValues->\hyperlink{class_q_u_e_s_o_1_1_scalar_sequence_a2aa8d77c39927060227275b12b6d3dd0}{resizeSequence}    (chainSize);
1369   \textcolor{keywordflow}{if} (\textcolor{keyword}{true}\textcolor{comment}{/*m\_uniqueChainGenerate*/}) \hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_ad1916a22b4a53ba67fa87f93c6e0a252}{m\_idsOfUniquePositions}.resize(chainSize,0);
1370   \textcolor{keywordflow}{if} (\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_a5d0bc9f73d50d272aa6bfb5ef5939ef3}{m\_optionsObj}->\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_options_a9d4792d9fc2dc5439b8ab489b0c236eb}{m\_ov}.\hyperlink{class_q_u_e_s_o_1_1_mh_options_values_a9d540978290d39df801e32f183450859}{m\_rawChainGenerateExtra}) \{
1371     \hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_ac33a6e46e05c20c071a46ecf58a9291c}{m\_logTargets}.resize    (chainSize,0.);
1372     \hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_a6fd65985afd80114ece8b2b5fffe658d}{m\_alphaQuotients}.resize(chainSize,0.);
1373   \}
1374 
1375   \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} uniquePos = 0;
1376   workingChain.\hyperlink{class_q_u_e_s_o_1_1_base_vector_sequence_a5bcce98b68e0e24c05136e7a3bb50c12}{setPositionValues}(0,currentPositionData.vecValues());
1377   \hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_a60695940f442f6568d10ee9e456032c7}{m\_numPositionsNotSubWritten}++;
1378   \textcolor{keywordflow}{if} ((\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_a5d0bc9f73d50d272aa6bfb5ef5939ef3}{m\_optionsObj}->\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_options_a9d4792d9fc2dc5439b8ab489b0c236eb}{m\_ov}.\hyperlink{class_q_u_e_s_o_1_1_mh_options_values_ad838a3095d5158e27b9af55597822d31}{m\_rawChainDataOutputPeriod}           > 
       0  ) &&
1379       (((0+1) % \hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_a5d0bc9f73d50d272aa6bfb5ef5939ef3}{m\_optionsObj}->\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_options_a9d4792d9fc2dc5439b8ab489b0c236eb}{m\_ov}.\hyperlink{class_q_u_e_s_o_1_1_mh_options_values_ad838a3095d5158e27b9af55597822d31}{m\_rawChainDataOutputPeriod}) ==
       0  ) &&
1380       (\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_a5d0bc9f73d50d272aa6bfb5ef5939ef3}{m\_optionsObj}->\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_options_a9d4792d9fc2dc5439b8ab489b0c236eb}{m\_ov}.\hyperlink{class_q_u_e_s_o_1_1_mh_options_values_a0ff310cdab62e1bdbff8663f8a6b1c77}{m\_rawChainDataOutputFileName}         
      != \textcolor{stringliteral}{"."})) \{
1381     workingChain.\hyperlink{class_q_u_e_s_o_1_1_base_vector_sequence_aa59738c6df15b1b369b90f0d025fb6f2}{subWriteContents}(0 + 1 - \hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_a5d0bc9f73d50d272aa6bfb5ef5939ef3}{m\_optionsObj}->
      \hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_options_a9d4792d9fc2dc5439b8ab489b0c236eb}{m\_ov}.\hyperlink{class_q_u_e_s_o_1_1_mh_options_values_ad838a3095d5158e27b9af55597822d31}{m\_rawChainDataOutputPeriod},
1382                                   \hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_a5d0bc9f73d50d272aa6bfb5ef5939ef3}{m\_optionsObj}->\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_options_a9d4792d9fc2dc5439b8ab489b0c236eb}{m\_ov}.
      \hyperlink{class_q_u_e_s_o_1_1_mh_options_values_ad838a3095d5158e27b9af55597822d31}{m\_rawChainDataOutputPeriod},
1383                                   \hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_a5d0bc9f73d50d272aa6bfb5ef5939ef3}{m\_optionsObj}->\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_options_a9d4792d9fc2dc5439b8ab489b0c236eb}{m\_ov}.
      \hyperlink{class_q_u_e_s_o_1_1_mh_options_values_a0ff310cdab62e1bdbff8663f8a6b1c77}{m\_rawChainDataOutputFileName},
1384                                   \hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_a5d0bc9f73d50d272aa6bfb5ef5939ef3}{m\_optionsObj}->\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_options_a9d4792d9fc2dc5439b8ab489b0c236eb}{m\_ov}.
      \hyperlink{class_q_u_e_s_o_1_1_mh_options_values_ae435f8be38f9f6407a2e0f75c53b4e76}{m\_rawChainDataOutputFileType},
1385                                   \hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_a5d0bc9f73d50d272aa6bfb5ef5939ef3}{m\_optionsObj}->\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_options_a9d4792d9fc2dc5439b8ab489b0c236eb}{m\_ov}.
      \hyperlink{class_q_u_e_s_o_1_1_mh_options_values_a99f722385d57bcb24542f3969c3764cd}{m\_rawChainDataOutputAllowedSet});
1386     \textcolor{keywordflow}{if} ((\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_ac8ea061e55b920e0c8f9bce5c3f20e52}{m\_env}.\hyperlink{class_q_u_e_s_o_1_1_base_environment_a8a0064746ae8dddfece4229b9ad374d6}{subDisplayFile}()                   ) &&
1387         (\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_a5d0bc9f73d50d272aa6bfb5ef5939ef3}{m\_optionsObj}->\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_options_a9d4792d9fc2dc5439b8ab489b0c236eb}{m\_ov}.\hyperlink{class_q_u_e_s_o_1_1_mh_options_values_af812309e81191e88dfdc87c5815141a3}{m\_totallyMute} == \textcolor{keyword}{false})) \{
1388       *\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_ac8ea061e55b920e0c8f9bce5c3f20e52}{m\_env}.\hyperlink{class_q_u_e_s_o_1_1_base_environment_a8a0064746ae8dddfece4229b9ad374d6}{subDisplayFile}() << \textcolor{stringliteral}{"In MetropolisHastingsSG<P\_V,P\_M>::generateFullChain()"}
1389                               << \textcolor{stringliteral}{": just wrote (per period request) "} << 
      \hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_a60695940f442f6568d10ee9e456032c7}{m\_numPositionsNotSubWritten} << \textcolor{stringliteral}{" chain positions "}
1390                               << \textcolor{stringliteral}{", "} << 0 + 1 - \hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_a5d0bc9f73d50d272aa6bfb5ef5939ef3}{m\_optionsObj}->\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_options_a9d4792d9fc2dc5439b8ab489b0c236eb}{m\_ov}.
      \hyperlink{class_q_u_e_s_o_1_1_mh_options_values_ad838a3095d5158e27b9af55597822d31}{m\_rawChainDataOutputPeriod} << \textcolor{stringliteral}{" <= pos <= "} << 0
1391                               << std::endl;
1392     \}
1393 
1394     \textcolor{keywordflow}{if} (workingLogLikelihoodValues) \{
1395       workingLogLikelihoodValues->\hyperlink{class_q_u_e_s_o_1_1_scalar_sequence_aa162c8bbca4e0dedca894828c57e1fa7}{subWriteContents}(0 + 1 - 
      \hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_a5d0bc9f73d50d272aa6bfb5ef5939ef3}{m\_optionsObj}->\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_options_a9d4792d9fc2dc5439b8ab489b0c236eb}{m\_ov}.\hyperlink{class_q_u_e_s_o_1_1_mh_options_values_ad838a3095d5158e27b9af55597822d31}{m\_rawChainDataOutputPeriod},
1396                                                    \hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_a5d0bc9f73d50d272aa6bfb5ef5939ef3}{m\_optionsObj}->
      \hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_options_a9d4792d9fc2dc5439b8ab489b0c236eb}{m\_ov}.\hyperlink{class_q_u_e_s_o_1_1_mh_options_values_ad838a3095d5158e27b9af55597822d31}{m\_rawChainDataOutputPeriod},
1397                                                    \hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_a5d0bc9f73d50d272aa6bfb5ef5939ef3}{m\_optionsObj}->
      \hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_options_a9d4792d9fc2dc5439b8ab489b0c236eb}{m\_ov}.\hyperlink{class_q_u_e_s_o_1_1_mh_options_values_a0ff310cdab62e1bdbff8663f8a6b1c77}{m\_rawChainDataOutputFileName} + \textcolor{stringliteral}{"\_likelihood"},
1398                                                    \hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_a5d0bc9f73d50d272aa6bfb5ef5939ef3}{m\_optionsObj}->
      \hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_options_a9d4792d9fc2dc5439b8ab489b0c236eb}{m\_ov}.\hyperlink{class_q_u_e_s_o_1_1_mh_options_values_ae435f8be38f9f6407a2e0f75c53b4e76}{m\_rawChainDataOutputFileType},
1399                                                    \hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_a5d0bc9f73d50d272aa6bfb5ef5939ef3}{m\_optionsObj}->
      \hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_options_a9d4792d9fc2dc5439b8ab489b0c236eb}{m\_ov}.\hyperlink{class_q_u_e_s_o_1_1_mh_options_values_a99f722385d57bcb24542f3969c3764cd}{m\_rawChainDataOutputAllowedSet});
1400     \}
1401 
1402     \textcolor{keywordflow}{if} (workingLogTargetValues) \{
1403       workingLogTargetValues->\hyperlink{class_q_u_e_s_o_1_1_scalar_sequence_aa162c8bbca4e0dedca894828c57e1fa7}{subWriteContents}(0 + 1 - 
      \hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_a5d0bc9f73d50d272aa6bfb5ef5939ef3}{m\_optionsObj}->\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_options_a9d4792d9fc2dc5439b8ab489b0c236eb}{m\_ov}.\hyperlink{class_q_u_e_s_o_1_1_mh_options_values_ad838a3095d5158e27b9af55597822d31}{m\_rawChainDataOutputPeriod},
1404                                                \hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_a5d0bc9f73d50d272aa6bfb5ef5939ef3}{m\_optionsObj}->\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_options_a9d4792d9fc2dc5439b8ab489b0c236eb}{m\_ov}.
      \hyperlink{class_q_u_e_s_o_1_1_mh_options_values_ad838a3095d5158e27b9af55597822d31}{m\_rawChainDataOutputPeriod},
1405                                                \hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_a5d0bc9f73d50d272aa6bfb5ef5939ef3}{m\_optionsObj}->\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_options_a9d4792d9fc2dc5439b8ab489b0c236eb}{m\_ov}.
      \hyperlink{class_q_u_e_s_o_1_1_mh_options_values_a0ff310cdab62e1bdbff8663f8a6b1c77}{m\_rawChainDataOutputFileName} + \textcolor{stringliteral}{"\_target"},
1406                                                \hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_a5d0bc9f73d50d272aa6bfb5ef5939ef3}{m\_optionsObj}->\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_options_a9d4792d9fc2dc5439b8ab489b0c236eb}{m\_ov}.
      \hyperlink{class_q_u_e_s_o_1_1_mh_options_values_ae435f8be38f9f6407a2e0f75c53b4e76}{m\_rawChainDataOutputFileType},
1407                                                \hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_a5d0bc9f73d50d272aa6bfb5ef5939ef3}{m\_optionsObj}->\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_options_a9d4792d9fc2dc5439b8ab489b0c236eb}{m\_ov}.
      \hyperlink{class_q_u_e_s_o_1_1_mh_options_values_a99f722385d57bcb24542f3969c3764cd}{m\_rawChainDataOutputAllowedSet});
1408     \}
1409 
1410     \hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_a60695940f442f6568d10ee9e456032c7}{m\_numPositionsNotSubWritten} = 0;
1411   \}
1412 
1413   \textcolor{keywordflow}{if} (workingLogLikelihoodValues) (*workingLogLikelihoodValues)[0] = currentPositionData.logLikelihood();
1414   \textcolor{keywordflow}{if} (workingLogTargetValues    ) (*workingLogTargetValues    )[0] = currentPositionData.logTarget();
1415   \textcolor{keywordflow}{if} (\textcolor{keyword}{true}\textcolor{comment}{/*m\_uniqueChainGenerate*/}) \hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_ad1916a22b4a53ba67fa87f93c6e0a252}{m\_idsOfUniquePositions}[uniquePos++] = 0;
1416   \textcolor{keywordflow}{if} (\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_a5d0bc9f73d50d272aa6bfb5ef5939ef3}{m\_optionsObj}->\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_options_a9d4792d9fc2dc5439b8ab489b0c236eb}{m\_ov}.\hyperlink{class_q_u_e_s_o_1_1_mh_options_values_a9d540978290d39df801e32f183450859}{m\_rawChainGenerateExtra}) \{
1417     \hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_ac33a6e46e05c20c071a46ecf58a9291c}{m\_logTargets}    [0] = currentPositionData.logTarget();
1418     \hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_a6fd65985afd80114ece8b2b5fffe658d}{m\_alphaQuotients}[0] = 1.;
1419   \}
1420   \textcolor{comment}{//*m\_env.subDisplayFile() << "AQUI 002" << std::endl;}
1421 
1422   \textcolor{keywordflow}{if} ((\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_ac8ea061e55b920e0c8f9bce5c3f20e52}{m\_env}.\hyperlink{class_q_u_e_s_o_1_1_base_environment_a8a0064746ae8dddfece4229b9ad374d6}{subDisplayFile}()                   ) &&
1423       (\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_ac8ea061e55b920e0c8f9bce5c3f20e52}{m\_env}.\hyperlink{class_q_u_e_s_o_1_1_base_environment_a1fe5f244fc0316a0ab3e37463f108b96}{displayVerbosity}() >= 10           ) &&
1424       (\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_a5d0bc9f73d50d272aa6bfb5ef5939ef3}{m\_optionsObj}->\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_options_a9d4792d9fc2dc5439b8ab489b0c236eb}{m\_ov}.\hyperlink{class_q_u_e_s_o_1_1_mh_options_values_af812309e81191e88dfdc87c5815141a3}{m\_totallyMute} == \textcolor{keyword}{false})) \{
1425     *\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_ac8ea061e55b920e0c8f9bce5c3f20e52}{m\_env}.\hyperlink{class_q_u_e_s_o_1_1_base_environment_a8a0064746ae8dddfece4229b9ad374d6}{subDisplayFile}() << \textcolor{stringliteral}{"\(\backslash\)n"}
1426                             << \textcolor{stringliteral}{"\(\backslash\)n++++++++++++++++++++++++++++++++++++++++++++++++++++++++"}
1427                             << \textcolor{stringliteral}{"\(\backslash\)n"}
1428                             << std::endl;
1429   \}
1430 
1431   \textcolor{comment}{//m\_env.syncPrintDebugMsg("In MetropolisHastingsSG<P\_V,P\_M>::generateFullChain(), right before main
       loop",3,3000000,m\_env.fullComm()); // Dangerous to barrier on fullComm ... // KAUST}
1432 
1433   \textcolor{comment}{//****************************************************}
1434   \textcolor{comment}{// Begin chain loop from positionId = 1}
1435   \textcolor{comment}{//****************************************************}
1436   \textcolor{keywordflow}{if} ((\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_ac8ea061e55b920e0c8f9bce5c3f20e52}{m\_env}.\hyperlink{class_q_u_e_s_o_1_1_base_environment_ac0345f57e31ef7833e379ed972bd094d}{numSubEnvironments}() < (\textcolor{keywordtype}{unsigned} int) \hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_ac8ea061e55b920e0c8f9bce5c3f20e52}{m\_env}.
      \hyperlink{class_q_u_e_s_o_1_1_base_environment_a0b0779b41ff304058856e97e1d16b4d4}{fullComm}().\hyperlink{class_q_u_e_s_o_1_1_mpi_comm_aa780721ae0fdeabc5a15e04cb0cad964}{NumProc}()) &&
1437       (\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_ae29f5d1198228858283d733021da2b14}{m\_initialPosition}.numOfProcsForStorage() == 1                         ) &&
1438       (\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_ac8ea061e55b920e0c8f9bce5c3f20e52}{m\_env}.\hyperlink{class_q_u_e_s_o_1_1_base_environment_a172d52f993f1322ed45aaddf71518dbb}{subRank}()                          != 0                         )) \{
1439     \textcolor{comment}{// subRank != 0 --> Enter the barrier and wait for processor 0 to decide to call the targetPdf}
1440     \textcolor{keywordtype}{double} aux = 0.;
1441     aux = \hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_ae7c7551764e0ccdfbe2862c544cdab10}{m\_targetPdfSynchronizer}->\hyperlink{class_q_u_e_s_o_1_1_scalar_function_synchronizer_adcdc70486ac64c11d0e505c4fb590a6b}{callFunction}(NULL,
1442                                                 NULL,
1443                                                 NULL,
1444                                                 NULL,
1445                                                 NULL,
1446                                                 NULL,
1447                                                 NULL);
1448     \textcolor{keywordflow}{if} (aux) \{\}; \textcolor{comment}{// just to remove compiler warning}
1449     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} positionId = 1; positionId < workingChain.\hyperlink{class_q_u_e_s_o_1_1_base_vector_sequence_afd6278702d40bdf1044697bbd6ad1957}{subSequenceSize}(); ++
      positionId) \{
1450       \textcolor{comment}{// Multiply by position values by 'positionId' in order to avoid a constant sequence,}
1451       \textcolor{comment}{// which would cause zero variance and eventually OVERFLOW flags raised}
1452       workingChain.\hyperlink{class_q_u_e_s_o_1_1_base_vector_sequence_a5bcce98b68e0e24c05136e7a3bb50c12}{setPositionValues}(positionId,((\textcolor{keywordtype}{double}) positionId) * 
      currentPositionData.vecValues());
1453       \hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_ac531509489028853bb17c0353fc9eafd}{m\_rawChainInfo}.\hyperlink{struct_q_u_e_s_o_1_1_m_h_raw_chain_info_struct_a276f608de19910713df01124a971c79c}{numRejections}++;
1454     \}
1455   \}
1456   \textcolor{keywordflow}{else} \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} positionId = 1; positionId < workingChain.
      \hyperlink{class_q_u_e_s_o_1_1_base_vector_sequence_afd6278702d40bdf1044697bbd6ad1957}{subSequenceSize}(); ++positionId) \{
1457     \textcolor{comment}{//****************************************************}
1458     \textcolor{comment}{// Point 1/6 of logic for new position}
1459     \textcolor{comment}{// Loop: initialize variables and print some information}
1460     \textcolor{comment}{//****************************************************}
1461     m\_positionIdForDebugging = positionId;
1462     \textcolor{keywordflow}{if} ((\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_ac8ea061e55b920e0c8f9bce5c3f20e52}{m\_env}.\hyperlink{class_q_u_e_s_o_1_1_base_environment_a8a0064746ae8dddfece4229b9ad374d6}{subDisplayFile}()                   ) &&
1463         (\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_ac8ea061e55b920e0c8f9bce5c3f20e52}{m\_env}.\hyperlink{class_q_u_e_s_o_1_1_base_environment_a1fe5f244fc0316a0ab3e37463f108b96}{displayVerbosity}() >= 3            ) &&
1464         (\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_a5d0bc9f73d50d272aa6bfb5ef5939ef3}{m\_optionsObj}->\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_options_a9d4792d9fc2dc5439b8ab489b0c236eb}{m\_ov}.\hyperlink{class_q_u_e_s_o_1_1_mh_options_values_af812309e81191e88dfdc87c5815141a3}{m\_totallyMute} == \textcolor{keyword}{false})) \{
1465       *\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_ac8ea061e55b920e0c8f9bce5c3f20e52}{m\_env}.\hyperlink{class_q_u_e_s_o_1_1_base_environment_a8a0064746ae8dddfece4229b9ad374d6}{subDisplayFile}() << \textcolor{stringliteral}{"In MetropolisHastingsSG<P\_V,P\_M>::generateFullChain()"}
1466                               << \textcolor{stringliteral}{": beginning chain position of id = "}  << positionId
1467                               << \textcolor{stringliteral}{", m\_optionsObj->m\_ov.m\_drMaxNumExtraStages = "} << 
      \hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_a5d0bc9f73d50d272aa6bfb5ef5939ef3}{m\_optionsObj}->\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_options_a9d4792d9fc2dc5439b8ab489b0c236eb}{m\_ov}.\hyperlink{class_q_u_e_s_o_1_1_mh_options_values_ab72acd4e4b80dd5c3a4b361466474f21}{m\_drMaxNumExtraStages}
1468                               << std::endl;
1469     \}
1470     \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} stageId  = 0;
1471     \hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_aca9351ab468808759b8b19686231ae4f}{m\_stageIdForDebugging} = stageId;
1472 
1473     \hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_a26e9680abddfb793486c995fa16f8c2d}{m\_tk}->\hyperlink{class_q_u_e_s_o_1_1_base_t_k_group_adb4decb4e8f01dce2ae4d5a3333c74f8}{clearPreComputingPositions}();
1474 
1475     \textcolor{keywordflow}{if} ((\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_ac8ea061e55b920e0c8f9bce5c3f20e52}{m\_env}.\hyperlink{class_q_u_e_s_o_1_1_base_environment_a8a0064746ae8dddfece4229b9ad374d6}{subDisplayFile}()                   ) &&
1476         (\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_ac8ea061e55b920e0c8f9bce5c3f20e52}{m\_env}.\hyperlink{class_q_u_e_s_o_1_1_base_environment_a1fe5f244fc0316a0ab3e37463f108b96}{displayVerbosity}() >= 5            ) &&
1477         (\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_a5d0bc9f73d50d272aa6bfb5ef5939ef3}{m\_optionsObj}->\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_options_a9d4792d9fc2dc5439b8ab489b0c236eb}{m\_ov}.\hyperlink{class_q_u_e_s_o_1_1_mh_options_values_af812309e81191e88dfdc87c5815141a3}{m\_totallyMute} == \textcolor{keyword}{false})) \{
1478       *\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_ac8ea061e55b920e0c8f9bce5c3f20e52}{m\_env}.\hyperlink{class_q_u_e_s_o_1_1_base_environment_a8a0064746ae8dddfece4229b9ad374d6}{subDisplayFile}() << \textcolor{stringliteral}{"In MetropolisHastingsSG<P\_V,P\_M>::generateFullChain()"}
1479                               << \textcolor{stringliteral}{": about to set TK pre computing position of local id "} << 0
1480                               << \textcolor{stringliteral}{", values = "} << currentPositionData.vecValues()
1481                               << std::endl;
1482     \}
1483     \textcolor{keywordtype}{bool} validPreComputingPosition = \hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_a26e9680abddfb793486c995fa16f8c2d}{m\_tk}->\hyperlink{class_q_u_e_s_o_1_1_base_t_k_group_acd1efb5b2ae3eb4f1130fa37201545d8}{setPreComputingPosition}(
      currentPositionData.vecValues(),0);
1484     \textcolor{keywordflow}{if} ((\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_ac8ea061e55b920e0c8f9bce5c3f20e52}{m\_env}.\hyperlink{class_q_u_e_s_o_1_1_base_environment_a8a0064746ae8dddfece4229b9ad374d6}{subDisplayFile}()                   ) &&
1485         (\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_ac8ea061e55b920e0c8f9bce5c3f20e52}{m\_env}.\hyperlink{class_q_u_e_s_o_1_1_base_environment_a1fe5f244fc0316a0ab3e37463f108b96}{displayVerbosity}() >= 5            ) &&
1486         (\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_a5d0bc9f73d50d272aa6bfb5ef5939ef3}{m\_optionsObj}->\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_options_a9d4792d9fc2dc5439b8ab489b0c236eb}{m\_ov}.\hyperlink{class_q_u_e_s_o_1_1_mh_options_values_af812309e81191e88dfdc87c5815141a3}{m\_totallyMute} == \textcolor{keyword}{false})) \{
1487       *\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_ac8ea061e55b920e0c8f9bce5c3f20e52}{m\_env}.\hyperlink{class_q_u_e_s_o_1_1_base_environment_a8a0064746ae8dddfece4229b9ad374d6}{subDisplayFile}() << \textcolor{stringliteral}{"In MetropolisHastingsSG<P\_V,P\_M>::generateFullChain()"}
1488                               << \textcolor{stringliteral}{": returned from setting TK pre computing position of local id "} << 0
1489                               << \textcolor{stringliteral}{", values = "} << currentPositionData.vecValues()
1490                               << \textcolor{stringliteral}{", valid = "}  << validPreComputingPosition
1491                               << std::endl;
1492     \}
1493     \hyperlink{_defines_8h_a56d63d18d0a6d45757de47fcc06f574d}{UQ\_FATAL\_TEST\_MACRO}(validPreComputingPosition == \textcolor{keyword}{false},
1494                         \hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_ac8ea061e55b920e0c8f9bce5c3f20e52}{m\_env}.\hyperlink{class_q_u_e_s_o_1_1_base_environment_a78b57112bbd0e6dd0e8afec00b40ffa7}{worldRank}(),
1495                         \textcolor{stringliteral}{"MetropolisHastingsSG<P\_V,P\_M>::generateFullChain()"},
1496                         \textcolor{stringliteral}{"initial position should not be an invalid pre computing position"});
1497 
1498     \textcolor{comment}{//****************************************************}
1499     \textcolor{comment}{// Point 2/6 of logic for new position}
1500     \textcolor{comment}{// Loop: generate new position}
1501     \textcolor{comment}{//****************************************************}
1502     \textcolor{comment}{// sep2011}
1503     \textcolor{keywordtype}{bool} keepGeneratingCandidates = \textcolor{keyword}{true};
1504     \textcolor{keywordflow}{while} (keepGeneratingCandidates) \{
1505       \textcolor{keywordflow}{if} (\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_a5d0bc9f73d50d272aa6bfb5ef5939ef3}{m\_optionsObj}->\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_options_a9d4792d9fc2dc5439b8ab489b0c236eb}{m\_ov}.\hyperlink{class_q_u_e_s_o_1_1_mh_options_values_a6fcc2efc9146b68548e62d707aeed883}{m\_rawChainMeasureRunTimes}) iRC = 
      gettimeofday(&timevalCandidate, NULL);
1506       \hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_a26e9680abddfb793486c995fa16f8c2d}{m\_tk}->\hyperlink{class_q_u_e_s_o_1_1_base_t_k_group_a6bd8e0bec0105471aad8801cbf1a0851}{rv}(0).realizer().realization(tmpVecValues);
1507       \textcolor{keywordflow}{if} (\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_a43a883aa28c81ed99e5f0cd9de93889b}{m\_numDisabledParameters} > 0) \{ \textcolor{comment}{// gpmsa2}
1508         \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} paramId = 0; paramId < \hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_a2ef17fbfc6a156f03bbfad044b5a75f5}{m\_vectorSpace}.
      \hyperlink{class_q_u_e_s_o_1_1_vector_space_a5829a1f4f996f8307c840b705144d666}{dimLocal}(); ++paramId) \{
1509           \textcolor{keywordflow}{if} (\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_afce8eeadae98935c72727b3640e88a31}{m\_parameterEnabledStatus}[paramId] == \textcolor{keyword}{false}) \{
1510             tmpVecValues[paramId] = \hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_ae29f5d1198228858283d733021da2b14}{m\_initialPosition}[paramId];
1511           \}
1512         \}
1513       \}
1514       \textcolor{keywordflow}{if} (\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_a5d0bc9f73d50d272aa6bfb5ef5939ef3}{m\_optionsObj}->\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_options_a9d4792d9fc2dc5439b8ab489b0c236eb}{m\_ov}.\hyperlink{class_q_u_e_s_o_1_1_mh_options_values_a6fcc2efc9146b68548e62d707aeed883}{m\_rawChainMeasureRunTimes}) 
      \hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_ac531509489028853bb17c0353fc9eafd}{m\_rawChainInfo}.\hyperlink{struct_q_u_e_s_o_1_1_m_h_raw_chain_info_struct_ada3a9649c975062a366df63561c599c7}{candidateRunTime} += 
      \hyperlink{namespace_q_u_e_s_o_a424bc33f2e6e287fd468408d14b772ee}{MiscGetEllapsedSeconds}(&timevalCandidate);
1515 
1516       outOfTargetSupport = !\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_a42ce4ffcb3addf62dd3f19fe8bb09268}{m\_targetPdf}.\hyperlink{class_q_u_e_s_o_1_1_base_scalar_function_ad0937628825249dd36ded3ce0c7959ac}{domainSet}().contains(tmpVecValues);
1517 
1518       \textcolor{keywordtype}{bool} displayDetail = (\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_ac8ea061e55b920e0c8f9bce5c3f20e52}{m\_env}.\hyperlink{class_q_u_e_s_o_1_1_base_environment_a1fe5f244fc0316a0ab3e37463f108b96}{displayVerbosity}() >= 10\textcolor{comment}{/*99*/}) || 
      \hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_a5d0bc9f73d50d272aa6bfb5ef5939ef3}{m\_optionsObj}->\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_options_a9d4792d9fc2dc5439b8ab489b0c236eb}{m\_ov}.\hyperlink{class_q_u_e_s_o_1_1_mh_options_values_a1df386cecfd87745e4d8adfb472d3443}{m\_displayCandidates};
1519       if ((\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_ac8ea061e55b920e0c8f9bce5c3f20e52}{m\_env}.\hyperlink{class_q_u_e_s_o_1_1_base_environment_a8a0064746ae8dddfece4229b9ad374d6}{subDisplayFile}()                   ) &&
1520           (displayDetail                            ) &&
1521           (\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_a5d0bc9f73d50d272aa6bfb5ef5939ef3}{m\_optionsObj}->\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_options_a9d4792d9fc2dc5439b8ab489b0c236eb}{m\_ov}.\hyperlink{class_q_u_e_s_o_1_1_mh_options_values_af812309e81191e88dfdc87c5815141a3}{m\_totallyMute} == \textcolor{keyword}{false})) \{
1522         *\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_ac8ea061e55b920e0c8f9bce5c3f20e52}{m\_env}.\hyperlink{class_q_u_e_s_o_1_1_base_environment_a8a0064746ae8dddfece4229b9ad374d6}{subDisplayFile}() << \textcolor{stringliteral}{"In
       MetropolisHastingsSG<P\_V,P\_M>::generateFullChain()"}
1523                                 << \textcolor{stringliteral}{": for chain position of id = "} << positionId
1524                                 << \textcolor{stringliteral}{", candidate = "}                << tmpVecValues \textcolor{comment}{// FIX ME: might need
       parallelism}
1525                                 << \textcolor{stringliteral}{", outOfTargetSupport = "}       << outOfTargetSupport
1526                                 << std::endl;
1527       \}
1528 
1529       \textcolor{keywordflow}{if} (\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_a5d0bc9f73d50d272aa6bfb5ef5939ef3}{m\_optionsObj}->\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_options_a9d4792d9fc2dc5439b8ab489b0c236eb}{m\_ov}.\hyperlink{class_q_u_e_s_o_1_1_mh_options_values_a6500d388ce724964ed858174a454177a}{m\_putOutOfBoundsInChain}) 
      keepGeneratingCandidates = \textcolor{keyword}{false};
1530       \textcolor{keywordflow}{else}                                            keepGeneratingCandidates = outOfTargetSupport;
1531     \}
1532 
1533     \textcolor{keywordflow}{if} ((\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_ac8ea061e55b920e0c8f9bce5c3f20e52}{m\_env}.\hyperlink{class_q_u_e_s_o_1_1_base_environment_a8a0064746ae8dddfece4229b9ad374d6}{subDisplayFile}()                   ) &&
1534         (\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_ac8ea061e55b920e0c8f9bce5c3f20e52}{m\_env}.\hyperlink{class_q_u_e_s_o_1_1_base_environment_a1fe5f244fc0316a0ab3e37463f108b96}{displayVerbosity}() >= 5            ) &&
1535         (\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_a5d0bc9f73d50d272aa6bfb5ef5939ef3}{m\_optionsObj}->\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_options_a9d4792d9fc2dc5439b8ab489b0c236eb}{m\_ov}.\hyperlink{class_q_u_e_s_o_1_1_mh_options_values_af812309e81191e88dfdc87c5815141a3}{m\_totallyMute} == \textcolor{keyword}{false})) \{
1536       *\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_ac8ea061e55b920e0c8f9bce5c3f20e52}{m\_env}.\hyperlink{class_q_u_e_s_o_1_1_base_environment_a8a0064746ae8dddfece4229b9ad374d6}{subDisplayFile}() << \textcolor{stringliteral}{"In MetropolisHastingsSG<P\_V,P\_M>::generateFullChain()"}
1537                               << \textcolor{stringliteral}{": about to set TK pre computing position of local id "} << stageId+1
1538                               << \textcolor{stringliteral}{", values = "} << tmpVecValues
1539                               << std::endl;
1540     \}
1541     validPreComputingPosition = \hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_a26e9680abddfb793486c995fa16f8c2d}{m\_tk}->\hyperlink{class_q_u_e_s_o_1_1_base_t_k_group_acd1efb5b2ae3eb4f1130fa37201545d8}{setPreComputingPosition}(tmpVecValues,
      stageId+1);
1542     \textcolor{keywordflow}{if} ((\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_ac8ea061e55b920e0c8f9bce5c3f20e52}{m\_env}.\hyperlink{class_q_u_e_s_o_1_1_base_environment_a8a0064746ae8dddfece4229b9ad374d6}{subDisplayFile}()                   ) &&
1543         (\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_ac8ea061e55b920e0c8f9bce5c3f20e52}{m\_env}.\hyperlink{class_q_u_e_s_o_1_1_base_environment_a1fe5f244fc0316a0ab3e37463f108b96}{displayVerbosity}() >= 5            ) &&
1544         (\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_a5d0bc9f73d50d272aa6bfb5ef5939ef3}{m\_optionsObj}->\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_options_a9d4792d9fc2dc5439b8ab489b0c236eb}{m\_ov}.\hyperlink{class_q_u_e_s_o_1_1_mh_options_values_af812309e81191e88dfdc87c5815141a3}{m\_totallyMute} == \textcolor{keyword}{false})) \{
1545       *\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_ac8ea061e55b920e0c8f9bce5c3f20e52}{m\_env}.\hyperlink{class_q_u_e_s_o_1_1_base_environment_a8a0064746ae8dddfece4229b9ad374d6}{subDisplayFile}() << \textcolor{stringliteral}{"In MetropolisHastingsSG<P\_V,P\_M>::generateFullChain()"}
1546                               << \textcolor{stringliteral}{": returned from setting TK pre computing position of local id "} << 
      stageId+1
1547                               << \textcolor{stringliteral}{", values = "} << tmpVecValues
1548                               << \textcolor{stringliteral}{", valid = "}  << validPreComputingPosition
1549                               << std::endl;
1550     \}
1551 
1552     \textcolor{keywordflow}{if} (outOfTargetSupport) \{
1553       \hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_ac531509489028853bb17c0353fc9eafd}{m\_rawChainInfo}.\hyperlink{struct_q_u_e_s_o_1_1_m_h_raw_chain_info_struct_a601f798ee4dc28cfa6b342fc04a8c841}{numOutOfTargetSupport}++;
1554       logPrior      = -INFINITY;
1555       logLikelihood = -INFINITY;
1556       logTarget     = -INFINITY;
1557     \}
1558     \textcolor{keywordflow}{else} \{
1559       \textcolor{keywordflow}{if} (\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_a5d0bc9f73d50d272aa6bfb5ef5939ef3}{m\_optionsObj}->\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_options_a9d4792d9fc2dc5439b8ab489b0c236eb}{m\_ov}.\hyperlink{class_q_u_e_s_o_1_1_mh_options_values_a6fcc2efc9146b68548e62d707aeed883}{m\_rawChainMeasureRunTimes}) iRC = 
      gettimeofday(&timevalTarget, NULL);
1560 \textcolor{preprocessor}{#ifdef QUESO\_EXPECTS\_LN\_LIKELIHOOD\_INSTEAD\_OF\_MINUS\_2\_LN}
1561 \textcolor{preprocessor}{}      logTarget =        \hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_ae7c7551764e0ccdfbe2862c544cdab10}{m\_targetPdfSynchronizer}->
      \hyperlink{class_q_u_e_s_o_1_1_scalar_function_synchronizer_adcdc70486ac64c11d0e505c4fb590a6b}{callFunction}(&tmpVecValues,NULL,NULL,NULL,NULL,&logPrior,&logLikelihood); \textcolor{comment}{// Might demand
       parallel environment}
1562 \textcolor{preprocessor}{#else}
1563 \textcolor{preprocessor}{}      logTarget = -0.5 * \hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_ae7c7551764e0ccdfbe2862c544cdab10}{m\_targetPdfSynchronizer}->
      \hyperlink{class_q_u_e_s_o_1_1_scalar_function_synchronizer_adcdc70486ac64c11d0e505c4fb590a6b}{callFunction}(&tmpVecValues,NULL,NULL,NULL,NULL,&logPrior,&logLikelihood); \textcolor{comment}{// Might demand
       parallel environment}
1564 \textcolor{preprocessor}{#endif}
1565 \textcolor{preprocessor}{}      \textcolor{keywordflow}{if} (\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_a5d0bc9f73d50d272aa6bfb5ef5939ef3}{m\_optionsObj}->\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_options_a9d4792d9fc2dc5439b8ab489b0c236eb}{m\_ov}.\hyperlink{class_q_u_e_s_o_1_1_mh_options_values_a6fcc2efc9146b68548e62d707aeed883}{m\_rawChainMeasureRunTimes}) 
      \hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_ac531509489028853bb17c0353fc9eafd}{m\_rawChainInfo}.\hyperlink{struct_q_u_e_s_o_1_1_m_h_raw_chain_info_struct_ab230db8f99e46f0c1e4fc6c2aa3773eb}{targetRunTime} += 
      \hyperlink{namespace_q_u_e_s_o_a424bc33f2e6e287fd468408d14b772ee}{MiscGetEllapsedSeconds}(&timevalTarget);
1566       \hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_ac531509489028853bb17c0353fc9eafd}{m\_rawChainInfo}.\hyperlink{struct_q_u_e_s_o_1_1_m_h_raw_chain_info_struct_a506e08bdffc1f777e33c7ec2d7862747}{numTargetCalls}++;
1567       \textcolor{keywordflow}{if} ((\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_ac8ea061e55b920e0c8f9bce5c3f20e52}{m\_env}.\hyperlink{class_q_u_e_s_o_1_1_base_environment_a8a0064746ae8dddfece4229b9ad374d6}{subDisplayFile}()                   ) &&
1568           (\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_ac8ea061e55b920e0c8f9bce5c3f20e52}{m\_env}.\hyperlink{class_q_u_e_s_o_1_1_base_environment_a1fe5f244fc0316a0ab3e37463f108b96}{displayVerbosity}() >= 3            ) &&
1569           (\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_a5d0bc9f73d50d272aa6bfb5ef5939ef3}{m\_optionsObj}->\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_options_a9d4792d9fc2dc5439b8ab489b0c236eb}{m\_ov}.\hyperlink{class_q_u_e_s_o_1_1_mh_options_values_af812309e81191e88dfdc87c5815141a3}{m\_totallyMute} == \textcolor{keyword}{false})) \{
1570         *\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_ac8ea061e55b920e0c8f9bce5c3f20e52}{m\_env}.\hyperlink{class_q_u_e_s_o_1_1_base_environment_a8a0064746ae8dddfece4229b9ad374d6}{subDisplayFile}() << \textcolor{stringliteral}{"In
       MetropolisHastingsSG<P\_V,P\_M>::generateFullChain()"}
1571                                 << \textcolor{stringliteral}{": just returned from likelihood() for chain position of id "} << 
      positionId
1572                                 << \textcolor{stringliteral}{", m\_rawChainInfo.numTargetCalls = "} << 
      \hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_ac531509489028853bb17c0353fc9eafd}{m\_rawChainInfo}.\hyperlink{struct_q_u_e_s_o_1_1_m_h_raw_chain_info_struct_a506e08bdffc1f777e33c7ec2d7862747}{numTargetCalls}
1573                                 << \textcolor{stringliteral}{", logPrior = "}      << logPrior
1574                                 << \textcolor{stringliteral}{", logLikelihood = "} << logLikelihood
1575                                 << \textcolor{stringliteral}{", logTarget = "}     << logTarget
1576                                 << std::endl;
1577       \}
1578     \}
1579     currentCandidateData.set(tmpVecValues,
1580                              outOfTargetSupport,
1581                              logLikelihood,
1582                              logTarget);
1583 
1584     \textcolor{keywordflow}{if} ((\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_ac8ea061e55b920e0c8f9bce5c3f20e52}{m\_env}.\hyperlink{class_q_u_e_s_o_1_1_base_environment_a8a0064746ae8dddfece4229b9ad374d6}{subDisplayFile}()                   ) &&
1585         (\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_ac8ea061e55b920e0c8f9bce5c3f20e52}{m\_env}.\hyperlink{class_q_u_e_s_o_1_1_base_environment_a1fe5f244fc0316a0ab3e37463f108b96}{displayVerbosity}() >= 10           ) &&
1586         (\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_a5d0bc9f73d50d272aa6bfb5ef5939ef3}{m\_optionsObj}->\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_options_a9d4792d9fc2dc5439b8ab489b0c236eb}{m\_ov}.\hyperlink{class_q_u_e_s_o_1_1_mh_options_values_af812309e81191e88dfdc87c5815141a3}{m\_totallyMute} == \textcolor{keyword}{false})) \{
1587       *\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_ac8ea061e55b920e0c8f9bce5c3f20e52}{m\_env}.\hyperlink{class_q_u_e_s_o_1_1_base_environment_a8a0064746ae8dddfece4229b9ad374d6}{subDisplayFile}() << \textcolor{stringliteral}{"\(\backslash\)n"}
1588                               << \textcolor{stringliteral}{"\(\backslash\)n-----------------------------------------------------------\(\backslash\)n"}
1589                               << \textcolor{stringliteral}{"\(\backslash\)n"}
1590                               << std::endl;
1591     \}
1592     \textcolor{keywordtype}{bool} accept = \textcolor{keyword}{false};
1593     \textcolor{keywordtype}{double} alphaFirstCandidate = 0.;
1594     \textcolor{keywordflow}{if} (outOfTargetSupport) \{
1595       \textcolor{keywordflow}{if} (\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_a5d0bc9f73d50d272aa6bfb5ef5939ef3}{m\_optionsObj}->\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_options_a9d4792d9fc2dc5439b8ab489b0c236eb}{m\_ov}.\hyperlink{class_q_u_e_s_o_1_1_mh_options_values_a9d540978290d39df801e32f183450859}{m\_rawChainGenerateExtra}) \{
1596         \hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_a6fd65985afd80114ece8b2b5fffe658d}{m\_alphaQuotients}[positionId] = 0.;
1597       \}
1598     \}
1599     \textcolor{keywordflow}{else} \{
1600       \textcolor{keywordflow}{if} (\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_a5d0bc9f73d50d272aa6bfb5ef5939ef3}{m\_optionsObj}->\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_options_a9d4792d9fc2dc5439b8ab489b0c236eb}{m\_ov}.\hyperlink{class_q_u_e_s_o_1_1_mh_options_values_a6fcc2efc9146b68548e62d707aeed883}{m\_rawChainMeasureRunTimes}) iRC = 
      gettimeofday(&timevalMhAlpha, NULL);
1601       \textcolor{keywordflow}{if} (\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_a5d0bc9f73d50d272aa6bfb5ef5939ef3}{m\_optionsObj}->\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_options_a9d4792d9fc2dc5439b8ab489b0c236eb}{m\_ov}.\hyperlink{class_q_u_e_s_o_1_1_mh_options_values_a9d540978290d39df801e32f183450859}{m\_rawChainGenerateExtra}) \{
1602         alphaFirstCandidate = this->\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_ad5c2b3afd5e845ea22518536274a8dd7}{alpha}(currentPositionData,currentCandidateData,0,1,&
      \hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_a6fd65985afd80114ece8b2b5fffe658d}{m\_alphaQuotients}[positionId]);
1603       \}
1604       \textcolor{keywordflow}{else} \{
1605         alphaFirstCandidate = this->\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_ad5c2b3afd5e845ea22518536274a8dd7}{alpha}(currentPositionData,currentCandidateData,0,1,NULL);
1606       \}
1607       \textcolor{keywordflow}{if} (\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_a5d0bc9f73d50d272aa6bfb5ef5939ef3}{m\_optionsObj}->\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_options_a9d4792d9fc2dc5439b8ab489b0c236eb}{m\_ov}.\hyperlink{class_q_u_e_s_o_1_1_mh_options_values_a6fcc2efc9146b68548e62d707aeed883}{m\_rawChainMeasureRunTimes}) 
      \hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_ac531509489028853bb17c0353fc9eafd}{m\_rawChainInfo}.\hyperlink{struct_q_u_e_s_o_1_1_m_h_raw_chain_info_struct_a16d5d703c764352dfe30dfaa25ce8b8b}{mhAlphaRunTime} += 
      \hyperlink{namespace_q_u_e_s_o_a424bc33f2e6e287fd468408d14b772ee}{MiscGetEllapsedSeconds}(&timevalMhAlpha);
1608       \textcolor{keywordflow}{if} ((\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_ac8ea061e55b920e0c8f9bce5c3f20e52}{m\_env}.\hyperlink{class_q_u_e_s_o_1_1_base_environment_a8a0064746ae8dddfece4229b9ad374d6}{subDisplayFile}()                   ) &&
1609           (\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_ac8ea061e55b920e0c8f9bce5c3f20e52}{m\_env}.\hyperlink{class_q_u_e_s_o_1_1_base_environment_a1fe5f244fc0316a0ab3e37463f108b96}{displayVerbosity}() >= 10           ) &&
1610           (\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_a5d0bc9f73d50d272aa6bfb5ef5939ef3}{m\_optionsObj}->\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_options_a9d4792d9fc2dc5439b8ab489b0c236eb}{m\_ov}.\hyperlink{class_q_u_e_s_o_1_1_mh_options_values_af812309e81191e88dfdc87c5815141a3}{m\_totallyMute} == \textcolor{keyword}{false})) \{
1611         *\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_ac8ea061e55b920e0c8f9bce5c3f20e52}{m\_env}.\hyperlink{class_q_u_e_s_o_1_1_base_environment_a8a0064746ae8dddfece4229b9ad374d6}{subDisplayFile}() << \textcolor{stringliteral}{"In
       MetropolisHastingsSG<P\_V,P\_M>::generateFullChain()"}
1612                                 << \textcolor{stringliteral}{": for chain position of id = "} << positionId
1613                                 << std::endl;
1614       \}
1615       accept = \hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_abef3a3b60bc10db208864f6db09eeea8}{acceptAlpha}(alphaFirstCandidate);
1616     \}
1617 
1618     \textcolor{keywordtype}{bool} displayDetail = (\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_ac8ea061e55b920e0c8f9bce5c3f20e52}{m\_env}.\hyperlink{class_q_u_e_s_o_1_1_base_environment_a1fe5f244fc0316a0ab3e37463f108b96}{displayVerbosity}() >= 10\textcolor{comment}{/*99*/}) || 
      \hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_a5d0bc9f73d50d272aa6bfb5ef5939ef3}{m\_optionsObj}->\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_options_a9d4792d9fc2dc5439b8ab489b0c236eb}{m\_ov}.\hyperlink{class_q_u_e_s_o_1_1_mh_options_values_a1df386cecfd87745e4d8adfb472d3443}{m\_displayCandidates};
1619     if ((\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_ac8ea061e55b920e0c8f9bce5c3f20e52}{m\_env}.\hyperlink{class_q_u_e_s_o_1_1_base_environment_a8a0064746ae8dddfece4229b9ad374d6}{subDisplayFile}()                   ) &&
1620         (displayDetail                            ) &&
1621         (\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_a5d0bc9f73d50d272aa6bfb5ef5939ef3}{m\_optionsObj}->\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_options_a9d4792d9fc2dc5439b8ab489b0c236eb}{m\_ov}.\hyperlink{class_q_u_e_s_o_1_1_mh_options_values_af812309e81191e88dfdc87c5815141a3}{m\_totallyMute} == \textcolor{keyword}{false})) \{
1622       *\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_ac8ea061e55b920e0c8f9bce5c3f20e52}{m\_env}.\hyperlink{class_q_u_e_s_o_1_1_base_environment_a8a0064746ae8dddfece4229b9ad374d6}{subDisplayFile}() << \textcolor{stringliteral}{"In MetropolisHastingsSG<P\_V,P\_M>::generateFullChain()"}
1623                               << \textcolor{stringliteral}{": for chain position of id = "} << positionId
1624                               << \textcolor{stringliteral}{", outOfTargetSupport = "}       << outOfTargetSupport
1625                               << \textcolor{stringliteral}{", alpha = "}                    << alphaFirstCandidate
1626                               << \textcolor{stringliteral}{", accept = "}                   << accept
1627                               << \textcolor{stringliteral}{", currentCandidateData.vecValues() = "};
1628       *\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_ac8ea061e55b920e0c8f9bce5c3f20e52}{m\_env}.\hyperlink{class_q_u_e_s_o_1_1_base_environment_a8a0064746ae8dddfece4229b9ad374d6}{subDisplayFile}() << currentCandidateData.vecValues(); \textcolor{comment}{// FIX ME: might need
       parallelism}
1629       *\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_ac8ea061e55b920e0c8f9bce5c3f20e52}{m\_env}.\hyperlink{class_q_u_e_s_o_1_1_base_environment_a8a0064746ae8dddfece4229b9ad374d6}{subDisplayFile}() << \textcolor{stringliteral}{"\(\backslash\)n"}
1630                               << \textcolor{stringliteral}{"\(\backslash\)n curLogTarget  = "}           << currentPositionData.logTarget()
1631                               << \textcolor{stringliteral}{"\(\backslash\)n"}
1632                               << \textcolor{stringliteral}{"\(\backslash\)n canLogTarget  = "}           << currentCandidateData.logTarget()
1633                               << \textcolor{stringliteral}{"\(\backslash\)n"}
1634                               << std::endl;
1635     \}
1636     \textcolor{keywordflow}{if} ((\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_ac8ea061e55b920e0c8f9bce5c3f20e52}{m\_env}.\hyperlink{class_q_u_e_s_o_1_1_base_environment_a8a0064746ae8dddfece4229b9ad374d6}{subDisplayFile}()                   ) &&
1637         (\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_ac8ea061e55b920e0c8f9bce5c3f20e52}{m\_env}.\hyperlink{class_q_u_e_s_o_1_1_base_environment_a1fe5f244fc0316a0ab3e37463f108b96}{displayVerbosity}() >= 10           ) &&
1638         (\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_a5d0bc9f73d50d272aa6bfb5ef5939ef3}{m\_optionsObj}->\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_options_a9d4792d9fc2dc5439b8ab489b0c236eb}{m\_ov}.\hyperlink{class_q_u_e_s_o_1_1_mh_options_values_af812309e81191e88dfdc87c5815141a3}{m\_totallyMute} == \textcolor{keyword}{false})) \{
1639       *\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_ac8ea061e55b920e0c8f9bce5c3f20e52}{m\_env}.\hyperlink{class_q_u_e_s_o_1_1_base_environment_a8a0064746ae8dddfece4229b9ad374d6}{subDisplayFile}() << \textcolor{stringliteral}{"\(\backslash\)n"}
1640                               << \textcolor{stringliteral}{"\(\backslash\)n-----------------------------------------------------------\(\backslash\)n"}
1641                               << \textcolor{stringliteral}{"\(\backslash\)n"}
1642                               << std::endl;
1643     \}
1644 
1645     \textcolor{comment}{//****************************************************}
1646     \textcolor{comment}{// Point 3/6 of logic for new position}
1647     \textcolor{comment}{// Loop: delayed rejection}
1648     \textcolor{comment}{//****************************************************}
1649     \textcolor{comment}{// sep2011}
1650     std::vector<MarkovChainPositionData<P\_V>*> drPositionsData(stageId+2,NULL);
1651     std::vector<unsigned int> tkStageIds (stageId+2,0);
1652     \textcolor{keywordflow}{if} ((accept                                   == \textcolor{keyword}{false}) &&
1653         (outOfTargetSupport                       == \textcolor{keyword}{false}) && \textcolor{comment}{// IMPORTANT}
1654         (\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_a5d0bc9f73d50d272aa6bfb5ef5939ef3}{m\_optionsObj}->\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_options_a9d4792d9fc2dc5439b8ab489b0c236eb}{m\_ov}.\hyperlink{class_q_u_e_s_o_1_1_mh_options_values_ab72acd4e4b80dd5c3a4b361466474f21}{m\_drMaxNumExtraStages} >  0    )) \{
1655       \textcolor{keywordflow}{if} ((\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_a5d0bc9f73d50d272aa6bfb5ef5939ef3}{m\_optionsObj}->\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_options_a9d4792d9fc2dc5439b8ab489b0c236eb}{m\_ov}.\hyperlink{class_q_u_e_s_o_1_1_mh_options_values_ab546a17967c0690d0c01730f63ccb70b}{m\_drDuringAmNonAdaptiveInt}  == \textcolor{keyword}{
      false}     ) &&
1656           (\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_a5d0bc9f73d50d272aa6bfb5ef5939ef3}{m\_optionsObj}->\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_options_a9d4792d9fc2dc5439b8ab489b0c236eb}{m\_ov}.\hyperlink{class_q_u_e_s_o_1_1_mh_options_values_a3fa3d465b07ea276e7b2aa68b897e4ec}{m\_tkUseLocalHessian}         == \textcolor{keyword}{false}     )
       &&
1657           (\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_a5d0bc9f73d50d272aa6bfb5ef5939ef3}{m\_optionsObj}->\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_options_a9d4792d9fc2dc5439b8ab489b0c236eb}{m\_ov}.\hyperlink{class_q_u_e_s_o_1_1_mh_options_values_a3e72af53780ce9420c3454b00f56bc11}{m\_amInitialNonAdaptInterval} >  0  
             ) &&
1658           (\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_a5d0bc9f73d50d272aa6bfb5ef5939ef3}{m\_optionsObj}->\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_options_a9d4792d9fc2dc5439b8ab489b0c236eb}{m\_ov}.\hyperlink{class_q_u_e_s_o_1_1_mh_options_values_a5cda43f7f5361c56eab4c036c9bcab5d}{m\_amAdaptInterval}           >  0         ) 
      &&
1659           (positionId <= m\_optionsObj->m\_ov.m\_amInitialNonAdaptInterval)) \{
1660         \textcolor{comment}{// Avoid DR now}
1661       \}
1662       \textcolor{keywordflow}{else} \{
1663         \textcolor{keywordflow}{if} (\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_a5d0bc9f73d50d272aa6bfb5ef5939ef3}{m\_optionsObj}->\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_options_a9d4792d9fc2dc5439b8ab489b0c236eb}{m\_ov}.\hyperlink{class_q_u_e_s_o_1_1_mh_options_values_a6fcc2efc9146b68548e62d707aeed883}{m\_rawChainMeasureRunTimes}) iRC = 
      gettimeofday(&timevalDR, NULL);
1664 
1665         drPositionsData[0] = \textcolor{keyword}{new} MarkovChainPositionData<P\_V>(currentPositionData );
1666         drPositionsData[1] = \textcolor{keyword}{new} MarkovChainPositionData<P\_V>(currentCandidateData);
1667 
1668         tkStageIds[0] = 0;
1669         tkStageIds[1] = 1;
1670 
1671         \textcolor{keywordflow}{while} ((validPreComputingPosition == \textcolor{keyword}{true}                 ) &&
1672                (accept                    == false                ) &&
1673                (stageId < m\_optionsObj->m\_ov.m\_drMaxNumExtraStages)) \{
1674           \textcolor{keywordflow}{if} ((\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_ac8ea061e55b920e0c8f9bce5c3f20e52}{m\_env}.\hyperlink{class_q_u_e_s_o_1_1_base_environment_a8a0064746ae8dddfece4229b9ad374d6}{subDisplayFile}()                   ) &&
1675               (\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_ac8ea061e55b920e0c8f9bce5c3f20e52}{m\_env}.\hyperlink{class_q_u_e_s_o_1_1_base_environment_a1fe5f244fc0316a0ab3e37463f108b96}{displayVerbosity}() >= 10           ) &&
1676               (\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_a5d0bc9f73d50d272aa6bfb5ef5939ef3}{m\_optionsObj}->\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_options_a9d4792d9fc2dc5439b8ab489b0c236eb}{m\_ov}.\hyperlink{class_q_u_e_s_o_1_1_mh_options_values_af812309e81191e88dfdc87c5815141a3}{m\_totallyMute} == \textcolor{keyword}{false})) \{
1677             *\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_ac8ea061e55b920e0c8f9bce5c3f20e52}{m\_env}.\hyperlink{class_q_u_e_s_o_1_1_base_environment_a8a0064746ae8dddfece4229b9ad374d6}{subDisplayFile}() << \textcolor{stringliteral}{"\(\backslash\)n"}
1678                                     << \textcolor{stringliteral}{"\(\backslash\)n+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-"}
1679                                     << \textcolor{stringliteral}{"\(\backslash\)n"}
1680                                     << std::endl;
1681           \}
1682           \hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_ac531509489028853bb17c0353fc9eafd}{m\_rawChainInfo}.\hyperlink{struct_q_u_e_s_o_1_1_m_h_raw_chain_info_struct_a993b070bd796dd176f4168be05f11ce9}{numDRs}++;
1683           stageId++;
1684           \hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_aca9351ab468808759b8b19686231ae4f}{m\_stageIdForDebugging} = stageId;
1685           \textcolor{keywordflow}{if} ((\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_ac8ea061e55b920e0c8f9bce5c3f20e52}{m\_env}.\hyperlink{class_q_u_e_s_o_1_1_base_environment_a8a0064746ae8dddfece4229b9ad374d6}{subDisplayFile}()                   ) &&
1686               (\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_ac8ea061e55b920e0c8f9bce5c3f20e52}{m\_env}.\hyperlink{class_q_u_e_s_o_1_1_base_environment_a1fe5f244fc0316a0ab3e37463f108b96}{displayVerbosity}() >= 10           ) &&
1687               (\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_a5d0bc9f73d50d272aa6bfb5ef5939ef3}{m\_optionsObj}->\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_options_a9d4792d9fc2dc5439b8ab489b0c236eb}{m\_ov}.\hyperlink{class_q_u_e_s_o_1_1_mh_options_values_af812309e81191e88dfdc87c5815141a3}{m\_totallyMute} == \textcolor{keyword}{false})) \{
1688             *\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_ac8ea061e55b920e0c8f9bce5c3f20e52}{m\_env}.\hyperlink{class_q_u_e_s_o_1_1_base_environment_a8a0064746ae8dddfece4229b9ad374d6}{subDisplayFile}() << \textcolor{stringliteral}{"In
       MetropolisHastingsSG<P\_V,P\_M>::generateFullChain()"}
1689                                     << \textcolor{stringliteral}{": for chain position of id = "} << positionId
1690                                     << \textcolor{stringliteral}{", beginning stageId = "}        << stageId
1691                                     << std::endl;
1692           \}
1693 
1694           keepGeneratingCandidates = \textcolor{keyword}{true};
1695           \textcolor{keywordflow}{while} (keepGeneratingCandidates) \{
1696             \textcolor{keywordflow}{if} (\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_a5d0bc9f73d50d272aa6bfb5ef5939ef3}{m\_optionsObj}->\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_options_a9d4792d9fc2dc5439b8ab489b0c236eb}{m\_ov}.\hyperlink{class_q_u_e_s_o_1_1_mh_options_values_a6fcc2efc9146b68548e62d707aeed883}{m\_rawChainMeasureRunTimes}) iRC 
      = gettimeofday(&timevalCandidate, NULL);
1697             \hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_a26e9680abddfb793486c995fa16f8c2d}{m\_tk}->\hyperlink{class_q_u_e_s_o_1_1_base_t_k_group_a6bd8e0bec0105471aad8801cbf1a0851}{rv}(tkStageIds).realizer().realization(tmpVecValues);
1698             \textcolor{keywordflow}{if} (\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_a43a883aa28c81ed99e5f0cd9de93889b}{m\_numDisabledParameters} > 0) \{ \textcolor{comment}{// gpmsa2}
1699               \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} paramId = 0; paramId < \hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_a2ef17fbfc6a156f03bbfad044b5a75f5}{m\_vectorSpace}.
      \hyperlink{class_q_u_e_s_o_1_1_vector_space_a5829a1f4f996f8307c840b705144d666}{dimLocal}(); ++paramId) \{
1700                 \textcolor{keywordflow}{if} (\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_afce8eeadae98935c72727b3640e88a31}{m\_parameterEnabledStatus}[paramId] == \textcolor{keyword}{false}) \{
1701                   tmpVecValues[paramId] = \hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_ae29f5d1198228858283d733021da2b14}{m\_initialPosition}[paramId];
1702                 \}
1703               \}
1704             \}
1705             \textcolor{keywordflow}{if} (\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_a5d0bc9f73d50d272aa6bfb5ef5939ef3}{m\_optionsObj}->\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_options_a9d4792d9fc2dc5439b8ab489b0c236eb}{m\_ov}.\hyperlink{class_q_u_e_s_o_1_1_mh_options_values_a6fcc2efc9146b68548e62d707aeed883}{m\_rawChainMeasureRunTimes}) 
      \hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_ac531509489028853bb17c0353fc9eafd}{m\_rawChainInfo}.\hyperlink{struct_q_u_e_s_o_1_1_m_h_raw_chain_info_struct_ada3a9649c975062a366df63561c599c7}{candidateRunTime} += 
      \hyperlink{namespace_q_u_e_s_o_a424bc33f2e6e287fd468408d14b772ee}{MiscGetEllapsedSeconds}(&timevalCandidate);
1706 
1707             outOfTargetSupport = !\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_a42ce4ffcb3addf62dd3f19fe8bb09268}{m\_targetPdf}.\hyperlink{class_q_u_e_s_o_1_1_base_scalar_function_ad0937628825249dd36ded3ce0c7959ac}{domainSet}().contains(tmpVecValues);
1708 
1709             \textcolor{keywordflow}{if} (\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_a5d0bc9f73d50d272aa6bfb5ef5939ef3}{m\_optionsObj}->\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_options_a9d4792d9fc2dc5439b8ab489b0c236eb}{m\_ov}.\hyperlink{class_q_u_e_s_o_1_1_mh_options_values_a6500d388ce724964ed858174a454177a}{m\_putOutOfBoundsInChain}) 
      keepGeneratingCandidates = \textcolor{keyword}{false};
1710             \textcolor{keywordflow}{else}                                            keepGeneratingCandidates = outOfTargetSupport;
1711           \}
1712 
1713           \textcolor{keywordflow}{if} ((\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_ac8ea061e55b920e0c8f9bce5c3f20e52}{m\_env}.\hyperlink{class_q_u_e_s_o_1_1_base_environment_a8a0064746ae8dddfece4229b9ad374d6}{subDisplayFile}()                   ) &&
1714               (\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_ac8ea061e55b920e0c8f9bce5c3f20e52}{m\_env}.\hyperlink{class_q_u_e_s_o_1_1_base_environment_a1fe5f244fc0316a0ab3e37463f108b96}{displayVerbosity}() >= 5            ) &&
1715               (\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_a5d0bc9f73d50d272aa6bfb5ef5939ef3}{m\_optionsObj}->\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_options_a9d4792d9fc2dc5439b8ab489b0c236eb}{m\_ov}.\hyperlink{class_q_u_e_s_o_1_1_mh_options_values_af812309e81191e88dfdc87c5815141a3}{m\_totallyMute} == \textcolor{keyword}{false})) \{
1716             *\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_ac8ea061e55b920e0c8f9bce5c3f20e52}{m\_env}.\hyperlink{class_q_u_e_s_o_1_1_base_environment_a8a0064746ae8dddfece4229b9ad374d6}{subDisplayFile}() << \textcolor{stringliteral}{"In
       MetropolisHastingsSG<P\_V,P\_M>::generateFullChain()"}
1717                                     << \textcolor{stringliteral}{": about to set TK pre computing position of local id "} << stageId+1
1718                                     << \textcolor{stringliteral}{", values = "} << tmpVecValues
1719                                     << std::endl;
1720           \}
1721           validPreComputingPosition = \hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_a26e9680abddfb793486c995fa16f8c2d}{m\_tk}->\hyperlink{class_q_u_e_s_o_1_1_base_t_k_group_acd1efb5b2ae3eb4f1130fa37201545d8}{setPreComputingPosition}(tmpVecValues
      ,stageId+1);
1722           \textcolor{keywordflow}{if} ((\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_ac8ea061e55b920e0c8f9bce5c3f20e52}{m\_env}.\hyperlink{class_q_u_e_s_o_1_1_base_environment_a8a0064746ae8dddfece4229b9ad374d6}{subDisplayFile}()                   ) &&
1723               (\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_ac8ea061e55b920e0c8f9bce5c3f20e52}{m\_env}.\hyperlink{class_q_u_e_s_o_1_1_base_environment_a1fe5f244fc0316a0ab3e37463f108b96}{displayVerbosity}() >= 5            ) &&
1724               (\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_a5d0bc9f73d50d272aa6bfb5ef5939ef3}{m\_optionsObj}->\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_options_a9d4792d9fc2dc5439b8ab489b0c236eb}{m\_ov}.\hyperlink{class_q_u_e_s_o_1_1_mh_options_values_af812309e81191e88dfdc87c5815141a3}{m\_totallyMute} == \textcolor{keyword}{false})) \{
1725             *\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_ac8ea061e55b920e0c8f9bce5c3f20e52}{m\_env}.\hyperlink{class_q_u_e_s_o_1_1_base_environment_a8a0064746ae8dddfece4229b9ad374d6}{subDisplayFile}() << \textcolor{stringliteral}{"In
       MetropolisHastingsSG<P\_V,P\_M>::generateFullChain()"}
1726                                     << \textcolor{stringliteral}{": returned from setting TK pre computing position of local id "} << 
      stageId+1
1727                                     << \textcolor{stringliteral}{", values = "} << tmpVecValues
1728                                     << \textcolor{stringliteral}{", valid = "}  << validPreComputingPosition
1729                                     << std::endl;
1730           \}
1731 
1732           \textcolor{keywordflow}{if} (outOfTargetSupport) \{
1733             \hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_ac531509489028853bb17c0353fc9eafd}{m\_rawChainInfo}.\hyperlink{struct_q_u_e_s_o_1_1_m_h_raw_chain_info_struct_a783bb6c6b6dcab7f2bcc9fd0f49c588f}{numOutOfTargetSupportInDR}++; \textcolor{comment}{// new
       2010/May/12}
1734             logPrior      = -INFINITY;
1735             logLikelihood = -INFINITY;
1736             logTarget     = -INFINITY;
1737           \}
1738           \textcolor{keywordflow}{else} \{
1739             \textcolor{keywordflow}{if} (\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_a5d0bc9f73d50d272aa6bfb5ef5939ef3}{m\_optionsObj}->\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_options_a9d4792d9fc2dc5439b8ab489b0c236eb}{m\_ov}.\hyperlink{class_q_u_e_s_o_1_1_mh_options_values_a6fcc2efc9146b68548e62d707aeed883}{m\_rawChainMeasureRunTimes}) iRC 
      = gettimeofday(&timevalTarget, NULL);
1740 \textcolor{preprocessor}{#ifdef QUESO\_EXPECTS\_LN\_LIKELIHOOD\_INSTEAD\_OF\_MINUS\_2\_LN}
1741 \textcolor{preprocessor}{}            logTarget =        \hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_ae7c7551764e0ccdfbe2862c544cdab10}{m\_targetPdfSynchronizer}->
      \hyperlink{class_q_u_e_s_o_1_1_scalar_function_synchronizer_adcdc70486ac64c11d0e505c4fb590a6b}{callFunction}(&tmpVecValues,NULL,NULL,NULL,NULL,&logPrior,&logLikelihood); \textcolor{comment}{// Might demand
       parallel environment}
1742 \textcolor{preprocessor}{#else}
1743 \textcolor{preprocessor}{}            logTarget = -0.5 * \hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_ae7c7551764e0ccdfbe2862c544cdab10}{m\_targetPdfSynchronizer}->
      \hyperlink{class_q_u_e_s_o_1_1_scalar_function_synchronizer_adcdc70486ac64c11d0e505c4fb590a6b}{callFunction}(&tmpVecValues,NULL,NULL,NULL,NULL,&logPrior,&logLikelihood); \textcolor{comment}{// Might demand
       parallel environment}
1744 \textcolor{preprocessor}{#endif}
1745 \textcolor{preprocessor}{}            \textcolor{keywordflow}{if} (\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_a5d0bc9f73d50d272aa6bfb5ef5939ef3}{m\_optionsObj}->\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_options_a9d4792d9fc2dc5439b8ab489b0c236eb}{m\_ov}.\hyperlink{class_q_u_e_s_o_1_1_mh_options_values_a6fcc2efc9146b68548e62d707aeed883}{m\_rawChainMeasureRunTimes}) 
      \hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_ac531509489028853bb17c0353fc9eafd}{m\_rawChainInfo}.\hyperlink{struct_q_u_e_s_o_1_1_m_h_raw_chain_info_struct_ab230db8f99e46f0c1e4fc6c2aa3773eb}{targetRunTime} += 
      \hyperlink{namespace_q_u_e_s_o_a424bc33f2e6e287fd468408d14b772ee}{MiscGetEllapsedSeconds}(&timevalTarget);
1746             \hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_ac531509489028853bb17c0353fc9eafd}{m\_rawChainInfo}.\hyperlink{struct_q_u_e_s_o_1_1_m_h_raw_chain_info_struct_a506e08bdffc1f777e33c7ec2d7862747}{numTargetCalls}++;
1747             \textcolor{keywordflow}{if} ((\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_ac8ea061e55b920e0c8f9bce5c3f20e52}{m\_env}.\hyperlink{class_q_u_e_s_o_1_1_base_environment_a8a0064746ae8dddfece4229b9ad374d6}{subDisplayFile}()                   ) &&
1748                 (\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_ac8ea061e55b920e0c8f9bce5c3f20e52}{m\_env}.\hyperlink{class_q_u_e_s_o_1_1_base_environment_a1fe5f244fc0316a0ab3e37463f108b96}{displayVerbosity}() >= 3            ) &&
1749                 (\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_a5d0bc9f73d50d272aa6bfb5ef5939ef3}{m\_optionsObj}->\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_options_a9d4792d9fc2dc5439b8ab489b0c236eb}{m\_ov}.\hyperlink{class_q_u_e_s_o_1_1_mh_options_values_af812309e81191e88dfdc87c5815141a3}{m\_totallyMute} == \textcolor{keyword}{false})) \{
1750               *\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_ac8ea061e55b920e0c8f9bce5c3f20e52}{m\_env}.\hyperlink{class_q_u_e_s_o_1_1_base_environment_a8a0064746ae8dddfece4229b9ad374d6}{subDisplayFile}() << \textcolor{stringliteral}{"In
       MetropolisHastingsSG<P\_V,P\_M>::generateFullChain()"}
1751                                       << \textcolor{stringliteral}{": just returned from likelihood() for chain position of id "} << 
      positionId
1752                                       << \textcolor{stringliteral}{", m\_rawChainInfo.numTargetCalls = "} << 
      \hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_ac531509489028853bb17c0353fc9eafd}{m\_rawChainInfo}.\hyperlink{struct_q_u_e_s_o_1_1_m_h_raw_chain_info_struct_a506e08bdffc1f777e33c7ec2d7862747}{numTargetCalls}
1753                                       << \textcolor{stringliteral}{", stageId = "}       << stageId
1754                                       << \textcolor{stringliteral}{", logPrior = "}      << logPrior
1755                                       << \textcolor{stringliteral}{", logLikelihood = "} << logLikelihood
1756                                       << \textcolor{stringliteral}{", logTarget = "}     << logTarget
1757                                       << std::endl;
1758             \}
1759           \}
1760           currentCandidateData.set(tmpVecValues,
1761                                    outOfTargetSupport,
1762                                    logLikelihood,
1763                                    logTarget);
1764 
1765           drPositionsData.push\_back(\textcolor{keyword}{new} MarkovChainPositionData<P\_V>(currentCandidateData));
1766           tkStageIds.push\_back     (stageId+1);
1767 
1768           \textcolor{keywordtype}{double} alphaDR = 0.;
1769           \textcolor{keywordflow}{if} (outOfTargetSupport == \textcolor{keyword}{false}) \{
1770             \textcolor{keywordflow}{if} (\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_a5d0bc9f73d50d272aa6bfb5ef5939ef3}{m\_optionsObj}->\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_options_a9d4792d9fc2dc5439b8ab489b0c236eb}{m\_ov}.\hyperlink{class_q_u_e_s_o_1_1_mh_options_values_a6fcc2efc9146b68548e62d707aeed883}{m\_rawChainMeasureRunTimes}) iRC 
      = gettimeofday(&timevalDrAlpha, NULL);
1771             alphaDR = this->\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_ad5c2b3afd5e845ea22518536274a8dd7}{alpha}(drPositionsData,tkStageIds);
1772             \textcolor{keywordflow}{if} (\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_a5d0bc9f73d50d272aa6bfb5ef5939ef3}{m\_optionsObj}->\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_options_a9d4792d9fc2dc5439b8ab489b0c236eb}{m\_ov}.\hyperlink{class_q_u_e_s_o_1_1_mh_options_values_a6fcc2efc9146b68548e62d707aeed883}{m\_rawChainMeasureRunTimes}) 
      \hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_ac531509489028853bb17c0353fc9eafd}{m\_rawChainInfo}.\hyperlink{struct_q_u_e_s_o_1_1_m_h_raw_chain_info_struct_afa74a9d74fc3e7942012b8d8448f6687}{drAlphaRunTime} += 
      \hyperlink{namespace_q_u_e_s_o_a424bc33f2e6e287fd468408d14b772ee}{MiscGetEllapsedSeconds}(&timevalDrAlpha);
1773             accept = \hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_abef3a3b60bc10db208864f6db09eeea8}{acceptAlpha}(alphaDR);
1774           \}
1775 
1776           displayDetail = (\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_ac8ea061e55b920e0c8f9bce5c3f20e52}{m\_env}.\hyperlink{class_q_u_e_s_o_1_1_base_environment_a1fe5f244fc0316a0ab3e37463f108b96}{displayVerbosity}() >= 10\textcolor{comment}{/*99*/}) || 
      \hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_a5d0bc9f73d50d272aa6bfb5ef5939ef3}{m\_optionsObj}->\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_options_a9d4792d9fc2dc5439b8ab489b0c236eb}{m\_ov}.\hyperlink{class_q_u_e_s_o_1_1_mh_options_values_a1df386cecfd87745e4d8adfb472d3443}{m\_displayCandidates};
1777           if ((\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_ac8ea061e55b920e0c8f9bce5c3f20e52}{m\_env}.\hyperlink{class_q_u_e_s_o_1_1_base_environment_a8a0064746ae8dddfece4229b9ad374d6}{subDisplayFile}()                   ) &&
1778               (displayDetail                            ) &&
1779               (\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_a5d0bc9f73d50d272aa6bfb5ef5939ef3}{m\_optionsObj}->\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_options_a9d4792d9fc2dc5439b8ab489b0c236eb}{m\_ov}.\hyperlink{class_q_u_e_s_o_1_1_mh_options_values_af812309e81191e88dfdc87c5815141a3}{m\_totallyMute} == \textcolor{keyword}{false})) \{
1780             *\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_ac8ea061e55b920e0c8f9bce5c3f20e52}{m\_env}.\hyperlink{class_q_u_e_s_o_1_1_base_environment_a8a0064746ae8dddfece4229b9ad374d6}{subDisplayFile}() << \textcolor{stringliteral}{"In
       MetropolisHastingsSG<P\_V,P\_M>::generateFullChain()"}
1781                                     << \textcolor{stringliteral}{": for chain position of id = "} << positionId
1782                                     << \textcolor{stringliteral}{" and stageId = "}               << stageId
1783                                     << \textcolor{stringliteral}{", outOfTargetSupport = "}       << outOfTargetSupport
1784                                     << \textcolor{stringliteral}{", alpha = "}                    << alphaDR
1785                                     << \textcolor{stringliteral}{", accept = "}                   << accept
1786                                     << \textcolor{stringliteral}{", currentCandidateData.vecValues() = "};
1787             *\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_ac8ea061e55b920e0c8f9bce5c3f20e52}{m\_env}.\hyperlink{class_q_u_e_s_o_1_1_base_environment_a8a0064746ae8dddfece4229b9ad374d6}{subDisplayFile}() << currentCandidateData.vecValues(); \textcolor{comment}{// FIX ME:
       might need parallelism}
1788             *\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_ac8ea061e55b920e0c8f9bce5c3f20e52}{m\_env}.\hyperlink{class_q_u_e_s_o_1_1_base_environment_a8a0064746ae8dddfece4229b9ad374d6}{subDisplayFile}() << std::endl;
1789           \}
1790         \} \textcolor{comment}{// while}
1791 
1792         \textcolor{keywordflow}{if} (\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_a5d0bc9f73d50d272aa6bfb5ef5939ef3}{m\_optionsObj}->\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_options_a9d4792d9fc2dc5439b8ab489b0c236eb}{m\_ov}.\hyperlink{class_q_u_e_s_o_1_1_mh_options_values_a6fcc2efc9146b68548e62d707aeed883}{m\_rawChainMeasureRunTimes}) 
      \hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_ac531509489028853bb17c0353fc9eafd}{m\_rawChainInfo}.\hyperlink{struct_q_u_e_s_o_1_1_m_h_raw_chain_info_struct_acd15a61993f122a3780dfae6f096d9b9}{drRunTime} += \hyperlink{namespace_q_u_e_s_o_a424bc33f2e6e287fd468408d14b772ee}{MiscGetEllapsedSeconds}(&timevalDR)
      ;
1793       \} \textcolor{comment}{// if-else "Avoid DR now"}
1794     \} \textcolor{comment}{// end of 'delayed rejection' logic}
1795 
1796     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} i = 0; i < drPositionsData.size(); ++i) \{
1797       \textcolor{keywordflow}{if} (drPositionsData[i]) \textcolor{keyword}{delete} drPositionsData[i];
1798     \}
1799 
1800     \textcolor{comment}{//****************************************************}
1801     \textcolor{comment}{// Point 4/6 of logic for new position}
1802     \textcolor{comment}{// Loop: update chain}
1803     \textcolor{comment}{//****************************************************}
1804     \textcolor{keywordflow}{if} (accept) \{
1805       workingChain.\hyperlink{class_q_u_e_s_o_1_1_base_vector_sequence_a5bcce98b68e0e24c05136e7a3bb50c12}{setPositionValues}(positionId,currentCandidateData.vecValues());
1806       \textcolor{keywordflow}{if} (\textcolor{keyword}{true}\textcolor{comment}{/*m\_uniqueChainGenerate*/}) \hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_ad1916a22b4a53ba67fa87f93c6e0a252}{m\_idsOfUniquePositions}[uniquePos++] = 
      positionId;
1807       currentPositionData = currentCandidateData;
1808     \}
1809     \textcolor{keywordflow}{else} \{
1810       workingChain.\hyperlink{class_q_u_e_s_o_1_1_base_vector_sequence_a5bcce98b68e0e24c05136e7a3bb50c12}{setPositionValues}(positionId,currentPositionData.vecValues());
1811       \hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_ac531509489028853bb17c0353fc9eafd}{m\_rawChainInfo}.\hyperlink{struct_q_u_e_s_o_1_1_m_h_raw_chain_info_struct_a276f608de19910713df01124a971c79c}{numRejections}++;
1812     \}
1813     \hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_a60695940f442f6568d10ee9e456032c7}{m\_numPositionsNotSubWritten}++;
1814     \textcolor{keywordflow}{if} ((\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_a5d0bc9f73d50d272aa6bfb5ef5939ef3}{m\_optionsObj}->\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_options_a9d4792d9fc2dc5439b8ab489b0c236eb}{m\_ov}.\hyperlink{class_q_u_e_s_o_1_1_mh_options_values_ad838a3095d5158e27b9af55597822d31}{m\_rawChainDataOutputPeriod}           
               >  0  ) &&
1815         (((positionId+1) % \hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_a5d0bc9f73d50d272aa6bfb5ef5939ef3}{m\_optionsObj}->\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_options_a9d4792d9fc2dc5439b8ab489b0c236eb}{m\_ov}.
      \hyperlink{class_q_u_e_s_o_1_1_mh_options_values_ad838a3095d5158e27b9af55597822d31}{m\_rawChainDataOutputPeriod}) == 0  ) &&
1816         (\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_a5d0bc9f73d50d272aa6bfb5ef5939ef3}{m\_optionsObj}->\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_options_a9d4792d9fc2dc5439b8ab489b0c236eb}{m\_ov}.\hyperlink{class_q_u_e_s_o_1_1_mh_options_values_a0ff310cdab62e1bdbff8663f8a6b1c77}{m\_rawChainDataOutputFileName}       
                 != \textcolor{stringliteral}{"."})) \{
1817       \textcolor{keywordflow}{if} ((\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_ac8ea061e55b920e0c8f9bce5c3f20e52}{m\_env}.\hyperlink{class_q_u_e_s_o_1_1_base_environment_a8a0064746ae8dddfece4229b9ad374d6}{subDisplayFile}()                   ) &&
1818           (\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_ac8ea061e55b920e0c8f9bce5c3f20e52}{m\_env}.\hyperlink{class_q_u_e_s_o_1_1_base_environment_a1fe5f244fc0316a0ab3e37463f108b96}{displayVerbosity}()         >= 10   ) &&
1819           (\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_a5d0bc9f73d50d272aa6bfb5ef5939ef3}{m\_optionsObj}->\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_options_a9d4792d9fc2dc5439b8ab489b0c236eb}{m\_ov}.\hyperlink{class_q_u_e_s_o_1_1_mh_options_values_af812309e81191e88dfdc87c5815141a3}{m\_totallyMute} == \textcolor{keyword}{false})) \{
1820         *\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_ac8ea061e55b920e0c8f9bce5c3f20e52}{m\_env}.\hyperlink{class_q_u_e_s_o_1_1_base_environment_a8a0064746ae8dddfece4229b9ad374d6}{subDisplayFile}() << \textcolor{stringliteral}{"In
       MetropolisHastingsSG<P\_V,P\_M>::generateFullChain()"}
1821                                 << \textcolor{stringliteral}{", for chain position of id = "} << positionId
1822                                 << \textcolor{stringliteral}{": about to write (per period request) "} << 
      \hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_a60695940f442f6568d10ee9e456032c7}{m\_numPositionsNotSubWritten} << \textcolor{stringliteral}{" chain positions "}
1823                                 << \textcolor{stringliteral}{", "} << positionId + 1 - \hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_a5d0bc9f73d50d272aa6bfb5ef5939ef3}{m\_optionsObj}->
      \hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_options_a9d4792d9fc2dc5439b8ab489b0c236eb}{m\_ov}.\hyperlink{class_q_u_e_s_o_1_1_mh_options_values_ad838a3095d5158e27b9af55597822d31}{m\_rawChainDataOutputPeriod} << \textcolor{stringliteral}{" <= pos <= "} << positionId
1824                                 << std::endl;
1825       \}
1826       workingChain.\hyperlink{class_q_u_e_s_o_1_1_base_vector_sequence_aa59738c6df15b1b369b90f0d025fb6f2}{subWriteContents}(positionId + 1 - 
      \hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_a5d0bc9f73d50d272aa6bfb5ef5939ef3}{m\_optionsObj}->\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_options_a9d4792d9fc2dc5439b8ab489b0c236eb}{m\_ov}.\hyperlink{class_q_u_e_s_o_1_1_mh_options_values_ad838a3095d5158e27b9af55597822d31}{m\_rawChainDataOutputPeriod},
1827                                     \hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_a5d0bc9f73d50d272aa6bfb5ef5939ef3}{m\_optionsObj}->\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_options_a9d4792d9fc2dc5439b8ab489b0c236eb}{m\_ov}.
      \hyperlink{class_q_u_e_s_o_1_1_mh_options_values_ad838a3095d5158e27b9af55597822d31}{m\_rawChainDataOutputPeriod},
1828                                     \hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_a5d0bc9f73d50d272aa6bfb5ef5939ef3}{m\_optionsObj}->\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_options_a9d4792d9fc2dc5439b8ab489b0c236eb}{m\_ov}.
      \hyperlink{class_q_u_e_s_o_1_1_mh_options_values_a0ff310cdab62e1bdbff8663f8a6b1c77}{m\_rawChainDataOutputFileName},
1829                                     \hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_a5d0bc9f73d50d272aa6bfb5ef5939ef3}{m\_optionsObj}->\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_options_a9d4792d9fc2dc5439b8ab489b0c236eb}{m\_ov}.
      \hyperlink{class_q_u_e_s_o_1_1_mh_options_values_ae435f8be38f9f6407a2e0f75c53b4e76}{m\_rawChainDataOutputFileType},
1830                                     \hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_a5d0bc9f73d50d272aa6bfb5ef5939ef3}{m\_optionsObj}->\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_options_a9d4792d9fc2dc5439b8ab489b0c236eb}{m\_ov}.
      \hyperlink{class_q_u_e_s_o_1_1_mh_options_values_a99f722385d57bcb24542f3969c3764cd}{m\_rawChainDataOutputAllowedSet});
1831       \textcolor{keywordflow}{if} ((\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_ac8ea061e55b920e0c8f9bce5c3f20e52}{m\_env}.\hyperlink{class_q_u_e_s_o_1_1_base_environment_a8a0064746ae8dddfece4229b9ad374d6}{subDisplayFile}()                   ) &&
1832           (\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_a5d0bc9f73d50d272aa6bfb5ef5939ef3}{m\_optionsObj}->\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_options_a9d4792d9fc2dc5439b8ab489b0c236eb}{m\_ov}.\hyperlink{class_q_u_e_s_o_1_1_mh_options_values_af812309e81191e88dfdc87c5815141a3}{m\_totallyMute} == \textcolor{keyword}{false})) \{
1833         *\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_ac8ea061e55b920e0c8f9bce5c3f20e52}{m\_env}.\hyperlink{class_q_u_e_s_o_1_1_base_environment_a8a0064746ae8dddfece4229b9ad374d6}{subDisplayFile}() << \textcolor{stringliteral}{"In
       MetropolisHastingsSG<P\_V,P\_M>::generateFullChain()"}
1834                                 << \textcolor{stringliteral}{", for chain position of id = "} << positionId
1835                                 << \textcolor{stringliteral}{": just wrote (per period request) "} << 
      \hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_a60695940f442f6568d10ee9e456032c7}{m\_numPositionsNotSubWritten} << \textcolor{stringliteral}{" chain positions "}
1836                                 << \textcolor{stringliteral}{", "} << positionId + 1 - \hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_a5d0bc9f73d50d272aa6bfb5ef5939ef3}{m\_optionsObj}->
      \hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_options_a9d4792d9fc2dc5439b8ab489b0c236eb}{m\_ov}.\hyperlink{class_q_u_e_s_o_1_1_mh_options_values_ad838a3095d5158e27b9af55597822d31}{m\_rawChainDataOutputPeriod} << \textcolor{stringliteral}{" <= pos <= "} << positionId
1837                                 << std::endl;
1838       \}
1839 
1840       \textcolor{keywordflow}{if} (workingLogLikelihoodValues) \{
1841         workingLogLikelihoodValues->\hyperlink{class_q_u_e_s_o_1_1_scalar_sequence_aa162c8bbca4e0dedca894828c57e1fa7}{subWriteContents}(0 + 1 - 
      \hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_a5d0bc9f73d50d272aa6bfb5ef5939ef3}{m\_optionsObj}->\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_options_a9d4792d9fc2dc5439b8ab489b0c236eb}{m\_ov}.\hyperlink{class_q_u_e_s_o_1_1_mh_options_values_ad838a3095d5158e27b9af55597822d31}{m\_rawChainDataOutputPeriod},
1842                                                      \hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_a5d0bc9f73d50d272aa6bfb5ef5939ef3}{m\_optionsObj}->
      \hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_options_a9d4792d9fc2dc5439b8ab489b0c236eb}{m\_ov}.\hyperlink{class_q_u_e_s_o_1_1_mh_options_values_ad838a3095d5158e27b9af55597822d31}{m\_rawChainDataOutputPeriod},
1843                                                      \hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_a5d0bc9f73d50d272aa6bfb5ef5939ef3}{m\_optionsObj}->
      \hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_options_a9d4792d9fc2dc5439b8ab489b0c236eb}{m\_ov}.\hyperlink{class_q_u_e_s_o_1_1_mh_options_values_a0ff310cdab62e1bdbff8663f8a6b1c77}{m\_rawChainDataOutputFileName} + \textcolor{stringliteral}{"\_likelihood"},
1844                                                      \hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_a5d0bc9f73d50d272aa6bfb5ef5939ef3}{m\_optionsObj}->
      \hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_options_a9d4792d9fc2dc5439b8ab489b0c236eb}{m\_ov}.\hyperlink{class_q_u_e_s_o_1_1_mh_options_values_ae435f8be38f9f6407a2e0f75c53b4e76}{m\_rawChainDataOutputFileType},
1845                                                      \hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_a5d0bc9f73d50d272aa6bfb5ef5939ef3}{m\_optionsObj}->
      \hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_options_a9d4792d9fc2dc5439b8ab489b0c236eb}{m\_ov}.\hyperlink{class_q_u_e_s_o_1_1_mh_options_values_a99f722385d57bcb24542f3969c3764cd}{m\_rawChainDataOutputAllowedSet});
1846       \}
1847 
1848       \textcolor{keywordflow}{if} (workingLogTargetValues) \{
1849         workingLogTargetValues->\hyperlink{class_q_u_e_s_o_1_1_scalar_sequence_aa162c8bbca4e0dedca894828c57e1fa7}{subWriteContents}(0 + 1 - 
      \hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_a5d0bc9f73d50d272aa6bfb5ef5939ef3}{m\_optionsObj}->\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_options_a9d4792d9fc2dc5439b8ab489b0c236eb}{m\_ov}.\hyperlink{class_q_u_e_s_o_1_1_mh_options_values_ad838a3095d5158e27b9af55597822d31}{m\_rawChainDataOutputPeriod},
1850                                                  \hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_a5d0bc9f73d50d272aa6bfb5ef5939ef3}{m\_optionsObj}->\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_options_a9d4792d9fc2dc5439b8ab489b0c236eb}{m\_ov}.
      \hyperlink{class_q_u_e_s_o_1_1_mh_options_values_ad838a3095d5158e27b9af55597822d31}{m\_rawChainDataOutputPeriod},
1851                                                  \hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_a5d0bc9f73d50d272aa6bfb5ef5939ef3}{m\_optionsObj}->\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_options_a9d4792d9fc2dc5439b8ab489b0c236eb}{m\_ov}.
      \hyperlink{class_q_u_e_s_o_1_1_mh_options_values_a0ff310cdab62e1bdbff8663f8a6b1c77}{m\_rawChainDataOutputFileName} + \textcolor{stringliteral}{"\_target"},
1852                                                  \hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_a5d0bc9f73d50d272aa6bfb5ef5939ef3}{m\_optionsObj}->\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_options_a9d4792d9fc2dc5439b8ab489b0c236eb}{m\_ov}.
      \hyperlink{class_q_u_e_s_o_1_1_mh_options_values_ae435f8be38f9f6407a2e0f75c53b4e76}{m\_rawChainDataOutputFileType},
1853                                                  \hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_a5d0bc9f73d50d272aa6bfb5ef5939ef3}{m\_optionsObj}->\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_options_a9d4792d9fc2dc5439b8ab489b0c236eb}{m\_ov}.
      \hyperlink{class_q_u_e_s_o_1_1_mh_options_values_a99f722385d57bcb24542f3969c3764cd}{m\_rawChainDataOutputAllowedSet});
1854       \}
1855 
1856       \hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_a60695940f442f6568d10ee9e456032c7}{m\_numPositionsNotSubWritten} = 0;
1857     \}
1858 
1859 
1860     \textcolor{keywordflow}{if} (workingLogLikelihoodValues) (*workingLogLikelihoodValues)[positionId] = currentPositionData.
      logLikelihood();
1861     \textcolor{keywordflow}{if} (workingLogTargetValues    ) (*workingLogTargetValues    )[positionId] = currentPositionData.
      logTarget();
1862 
1863     \textcolor{keywordflow}{if} (\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_a5d0bc9f73d50d272aa6bfb5ef5939ef3}{m\_optionsObj}->\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_options_a9d4792d9fc2dc5439b8ab489b0c236eb}{m\_ov}.\hyperlink{class_q_u_e_s_o_1_1_mh_options_values_a9d540978290d39df801e32f183450859}{m\_rawChainGenerateExtra}) \{
1864       \hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_ac33a6e46e05c20c071a46ecf58a9291c}{m\_logTargets}[positionId] = currentPositionData.logTarget();
1865     \}
1866 
1867     \textcolor{keywordflow}{if}( \hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_a5d0bc9f73d50d272aa6bfb5ef5939ef3}{m\_optionsObj}->\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_options_a9d4792d9fc2dc5439b8ab489b0c236eb}{m\_ov}.\hyperlink{class_q_u_e_s_o_1_1_mh_options_values_afae1b3bf96ee3657212fa91ac7859bb7}{m\_enableBrooksGelmanConvMonitor} >
       0 ) \{
1868       \textcolor{keywordflow}{if}( positionId%\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_a5d0bc9f73d50d272aa6bfb5ef5939ef3}{m\_optionsObj}->\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_options_a9d4792d9fc2dc5439b8ab489b0c236eb}{m\_ov}.
      \hyperlink{class_q_u_e_s_o_1_1_mh_options_values_afae1b3bf96ee3657212fa91ac7859bb7}{m\_enableBrooksGelmanConvMonitor} == 0 &&
1869     positionId > \hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_a5d0bc9f73d50d272aa6bfb5ef5939ef3}{m\_optionsObj}->\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_options_a9d4792d9fc2dc5439b8ab489b0c236eb}{m\_ov}.\hyperlink{class_q_u_e_s_o_1_1_mh_options_values_a574f8a1d72eb5d45af5ab0c020a69447}{m\_BrooksGelmanLag}+1 ) \{ \textcolor{comment}{//+1 to help
       ensure there are at least 2 samples to use}
1870 
1871   \textcolor{keywordtype}{double} conv\_est = workingChain.\hyperlink{class_q_u_e_s_o_1_1_base_vector_sequence_a7f70b1762b6ba91a8f619403453cf2b2}{estimateConvBrooksGelman}( 
      \hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_a5d0bc9f73d50d272aa6bfb5ef5939ef3}{m\_optionsObj}->\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_options_a9d4792d9fc2dc5439b8ab489b0c236eb}{m\_ov}.\hyperlink{class_q_u_e_s_o_1_1_mh_options_values_a574f8a1d72eb5d45af5ab0c020a69447}{m\_BrooksGelmanLag},
1872                  positionId - \hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_a5d0bc9f73d50d272aa6bfb5ef5939ef3}{m\_optionsObj}->\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_options_a9d4792d9fc2dc5439b8ab489b0c236eb}{m\_ov}.
      \hyperlink{class_q_u_e_s_o_1_1_mh_options_values_a574f8a1d72eb5d45af5ab0c020a69447}{m\_BrooksGelmanLag} );
1873 
1874   \textcolor{keywordflow}{if} ( \hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_ac8ea061e55b920e0c8f9bce5c3f20e52}{m\_env}.\hyperlink{class_q_u_e_s_o_1_1_base_environment_a8a0064746ae8dddfece4229b9ad374d6}{subDisplayFile}() ) \{
1875       *\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_ac8ea061e55b920e0c8f9bce5c3f20e52}{m\_env}.\hyperlink{class_q_u_e_s_o_1_1_base_environment_a8a0064746ae8dddfece4229b9ad374d6}{subDisplayFile}() << \textcolor{stringliteral}{"positionId = "} << positionId
1876             << \textcolor{stringliteral}{", conv\_est = "} << conv\_est << std::endl;
1877       (*\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_ac8ea061e55b920e0c8f9bce5c3f20e52}{m\_env}.\hyperlink{class_q_u_e_s_o_1_1_base_environment_a8a0064746ae8dddfece4229b9ad374d6}{subDisplayFile}()).flush();
1878   \}
1879       \}
1880     \}
1881 
1882     \textcolor{comment}{//****************************************************}
1883     \textcolor{comment}{// Point 5/6 of logic for new position}
1884     \textcolor{comment}{// Loop: adaptive Metropolis (adaptation of covariance matrix)}
1885     \textcolor{comment}{//****************************************************}
1886     \textcolor{comment}{// sep2011}
1887     \textcolor{keywordflow}{if} ((\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_a5d0bc9f73d50d272aa6bfb5ef5939ef3}{m\_optionsObj}->\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_options_a9d4792d9fc2dc5439b8ab489b0c236eb}{m\_ov}.\hyperlink{class_q_u_e_s_o_1_1_mh_options_values_a3fa3d465b07ea276e7b2aa68b897e4ec}{m\_tkUseLocalHessian} ==    \textcolor{keyword}{false}) && \textcolor{comment}{//
       IMPORTANT}
1888         (\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_a5d0bc9f73d50d272aa6bfb5ef5939ef3}{m\_optionsObj}->\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_options_a9d4792d9fc2dc5439b8ab489b0c236eb}{m\_ov}.\hyperlink{class_q_u_e_s_o_1_1_mh_options_values_a3e72af53780ce9420c3454b00f56bc11}{m\_amInitialNonAdaptInterval} > 0) &&
1889         (\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_a5d0bc9f73d50d272aa6bfb5ef5939ef3}{m\_optionsObj}->\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_options_a9d4792d9fc2dc5439b8ab489b0c236eb}{m\_ov}.\hyperlink{class_q_u_e_s_o_1_1_mh_options_values_a5cda43f7f5361c56eab4c036c9bcab5d}{m\_amAdaptInterval}           > 0)) \{
1890       \textcolor{keywordflow}{if} (\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_a5d0bc9f73d50d272aa6bfb5ef5939ef3}{m\_optionsObj}->\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_options_a9d4792d9fc2dc5439b8ab489b0c236eb}{m\_ov}.\hyperlink{class_q_u_e_s_o_1_1_mh_options_values_a6fcc2efc9146b68548e62d707aeed883}{m\_rawChainMeasureRunTimes}) iRC = 
      gettimeofday(&timevalAM, NULL);
1891 
1892       \textcolor{comment}{// Now might be the moment to adapt}
1893       \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} idOfFirstPositionInSubChain = 0;
1894       SequenceOfVectors<P\_V,P\_M> partialChain(\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_a2ef17fbfc6a156f03bbfad044b5a75f5}{m\_vectorSpace},0,
      \hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_a5d0bc9f73d50d272aa6bfb5ef5939ef3}{m\_optionsObj}->\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_options_a4f7c510aaa530336d24259e2a89f5d0b}{m\_prefix}+\textcolor{stringliteral}{"partialChain"});
1895 
1896       \textcolor{comment}{// Check if now is indeed the moment to adapt}
1897       \textcolor{keywordtype}{bool} printAdaptedMatrix = \textcolor{keyword}{false};
1898       \textcolor{keywordflow}{if} (positionId < m\_optionsObj->m\_ov.m\_amInitialNonAdaptInterval) \{
1899         \textcolor{comment}{// Do nothing}
1900       \}
1901       \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (positionId == \hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_a5d0bc9f73d50d272aa6bfb5ef5939ef3}{m\_optionsObj}->\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_options_a9d4792d9fc2dc5439b8ab489b0c236eb}{m\_ov}.
      \hyperlink{class_q_u_e_s_o_1_1_mh_options_values_a3e72af53780ce9420c3454b00f56bc11}{m\_amInitialNonAdaptInterval}) \{
1902         idOfFirstPositionInSubChain = 0;
1903         partialChain.resizeSequence(\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_a5d0bc9f73d50d272aa6bfb5ef5939ef3}{m\_optionsObj}->\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_options_a9d4792d9fc2dc5439b8ab489b0c236eb}{m\_ov}.
      \hyperlink{class_q_u_e_s_o_1_1_mh_options_values_a3e72af53780ce9420c3454b00f56bc11}{m\_amInitialNonAdaptInterval}+1);
1904         \hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_a9741f56d947e9d7967af91c6ea083b56}{m\_lastMean}             = \hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_a2ef17fbfc6a156f03bbfad044b5a75f5}{m\_vectorSpace}.\hyperlink{class_q_u_e_s_o_1_1_vector_space_a6fc1d08dfe902e83a011ea6a81aff439}{newVector}();
1905         \hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_a1c73b49339c8a1015d95a890d7882331}{m\_lastAdaptedCovMatrix} = \hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_a2ef17fbfc6a156f03bbfad044b5a75f5}{m\_vectorSpace}.
      \hyperlink{class_q_u_e_s_o_1_1_vector_space_a8277f132ea382a7f49aa4a6ab7cbea1c}{newMatrix}();
1906         printAdaptedMatrix = \textcolor{keyword}{true};
1907       \}
1908       \textcolor{keywordflow}{else} \{
1909         \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} interval = positionId - \hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_a5d0bc9f73d50d272aa6bfb5ef5939ef3}{m\_optionsObj}->\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_options_a9d4792d9fc2dc5439b8ab489b0c236eb}{m\_ov}.
      \hyperlink{class_q_u_e_s_o_1_1_mh_options_values_a3e72af53780ce9420c3454b00f56bc11}{m\_amInitialNonAdaptInterval};
1910         \textcolor{keywordflow}{if} ((interval % \hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_a5d0bc9f73d50d272aa6bfb5ef5939ef3}{m\_optionsObj}->\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_options_a9d4792d9fc2dc5439b8ab489b0c236eb}{m\_ov}.\hyperlink{class_q_u_e_s_o_1_1_mh_options_values_a5cda43f7f5361c56eab4c036c9bcab5d}{m\_amAdaptInterval}) == 0) \{
1911           idOfFirstPositionInSubChain = positionId - \hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_a5d0bc9f73d50d272aa6bfb5ef5939ef3}{m\_optionsObj}->
      \hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_options_a9d4792d9fc2dc5439b8ab489b0c236eb}{m\_ov}.\hyperlink{class_q_u_e_s_o_1_1_mh_options_values_a5cda43f7f5361c56eab4c036c9bcab5d}{m\_amAdaptInterval};
1912           partialChain.resizeSequence(\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_a5d0bc9f73d50d272aa6bfb5ef5939ef3}{m\_optionsObj}->\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_options_a9d4792d9fc2dc5439b8ab489b0c236eb}{m\_ov}.
      \hyperlink{class_q_u_e_s_o_1_1_mh_options_values_a5cda43f7f5361c56eab4c036c9bcab5d}{m\_amAdaptInterval});
1913 
1914           \textcolor{keywordflow}{if} (\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_a5d0bc9f73d50d272aa6bfb5ef5939ef3}{m\_optionsObj}->\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_options_a9d4792d9fc2dc5439b8ab489b0c236eb}{m\_ov}.
      \hyperlink{class_q_u_e_s_o_1_1_mh_options_values_a9e9de50014cce9683774d42119a1b752}{m\_amAdaptedMatricesDataOutputPeriod} > 0) \{
1915             \textcolor{keywordflow}{if} ((interval % \hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_a5d0bc9f73d50d272aa6bfb5ef5939ef3}{m\_optionsObj}->\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_options_a9d4792d9fc2dc5439b8ab489b0c236eb}{m\_ov}.
      \hyperlink{class_q_u_e_s_o_1_1_mh_options_values_a9e9de50014cce9683774d42119a1b752}{m\_amAdaptedMatricesDataOutputPeriod}) == 0) \{
1916               printAdaptedMatrix = \textcolor{keyword}{true};
1917             \}
1918           \}
1919         \}
1920       \}
1921 
1922       \textcolor{comment}{// If now is indeed the moment to adapt, then do it!}
1923       \textcolor{keywordflow}{if} (partialChain.subSequenceSize() > 0) \{
1924         P\_V transporterVec(\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_a2ef17fbfc6a156f03bbfad044b5a75f5}{m\_vectorSpace}.\hyperlink{class_q_u_e_s_o_1_1_vector_space_a92e963bb5cab3eecd290dfe4b8f03b04}{zeroVector}());
1925         \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} i = 0; i < partialChain.subSequenceSize(); ++i) \{
1926           workingChain.\hyperlink{class_q_u_e_s_o_1_1_base_vector_sequence_a656d47a18b401d6d914b0daf2dea88b0}{getPositionValues}(idOfFirstPositionInSubChain+i,transporterVec);
1927           partialChain.setPositionValues(i,transporterVec);
1928         \}
1929         \hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_a8b6571483a26c8ce1783519c43ed55a4}{updateAdaptedCovMatrix}(partialChain,
1930                                idOfFirstPositionInSubChain,
1931                                \hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_a005d221d1c458ff767ed03304ca4cd6f}{m\_lastChainSize},
1932                                *\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_a9741f56d947e9d7967af91c6ea083b56}{m\_lastMean},
1933                                *\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_a1c73b49339c8a1015d95a890d7882331}{m\_lastAdaptedCovMatrix});
1934 
1935         \textcolor{keywordflow}{if} ((printAdaptedMatrix                                       == \textcolor{keyword}{true}) &&
1936             (\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_a5d0bc9f73d50d272aa6bfb5ef5939ef3}{m\_optionsObj}->\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_options_a9d4792d9fc2dc5439b8ab489b0c236eb}{m\_ov}.
      \hyperlink{class_q_u_e_s_o_1_1_mh_options_values_ad131a1b5617e040b7602fbd6bf4a600e}{m\_amAdaptedMatricesDataOutputFileName} != \textcolor{stringliteral}{"."} )) \{ \textcolor{comment}{// palms}
1937           \textcolor{keywordtype}{char} varNamePrefix[64];
1938           sprintf(varNamePrefix,\textcolor{stringliteral}{"mat\_am%d"},positionId);
1939 
1940           \textcolor{keywordtype}{char} tmpChar[64];
1941           sprintf(tmpChar,\textcolor{stringliteral}{"\_am%d"},positionId);
1942 
1943           std::set<unsigned int> tmpSet;
1944           tmpSet.insert(\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_ac8ea061e55b920e0c8f9bce5c3f20e52}{m\_env}.\hyperlink{class_q_u_e_s_o_1_1_base_environment_a6ae3174897a9b3a4c85fa18da5d4c16f}{subId}());
1945 
1946           \hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_a1c73b49339c8a1015d95a890d7882331}{m\_lastAdaptedCovMatrix}->subWriteContents(varNamePrefix,
1947                                                    (\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_a5d0bc9f73d50d272aa6bfb5ef5939ef3}{m\_optionsObj}->
      \hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_options_a9d4792d9fc2dc5439b8ab489b0c236eb}{m\_ov}.\hyperlink{class_q_u_e_s_o_1_1_mh_options_values_ad131a1b5617e040b7602fbd6bf4a600e}{m\_amAdaptedMatricesDataOutputFileName}+tmpChar),
1948                                                    \hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_a5d0bc9f73d50d272aa6bfb5ef5939ef3}{m\_optionsObj}->
      \hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_options_a9d4792d9fc2dc5439b8ab489b0c236eb}{m\_ov}.\hyperlink{class_q_u_e_s_o_1_1_mh_options_values_a2aeb0e38d87c86464af4bde6a202598a}{m\_amAdaptedMatricesDataOutputFileType},
1949                                                    tmpSet);
1950           \textcolor{keywordflow}{if} ((\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_ac8ea061e55b920e0c8f9bce5c3f20e52}{m\_env}.\hyperlink{class_q_u_e_s_o_1_1_base_environment_a8a0064746ae8dddfece4229b9ad374d6}{subDisplayFile}()                   ) &&
1951               (\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_a5d0bc9f73d50d272aa6bfb5ef5939ef3}{m\_optionsObj}->\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_options_a9d4792d9fc2dc5439b8ab489b0c236eb}{m\_ov}.\hyperlink{class_q_u_e_s_o_1_1_mh_options_values_af812309e81191e88dfdc87c5815141a3}{m\_totallyMute} == \textcolor{keyword}{false})) \{
1952             *\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_ac8ea061e55b920e0c8f9bce5c3f20e52}{m\_env}.\hyperlink{class_q_u_e_s_o_1_1_base_environment_a8a0064746ae8dddfece4229b9ad374d6}{subDisplayFile}() << \textcolor{stringliteral}{"In
       MetropolisHastingsSG<P\_V,P\_M>::generateFullChain()"}
1953                                     << \textcolor{stringliteral}{": just wrote last adapted proposal cov matrix contents = "} << *
      \hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_a1c73b49339c8a1015d95a890d7882331}{m\_lastAdaptedCovMatrix}
1954                                     << std::endl;
1955           \}
1956         \} \textcolor{comment}{// if (printAdaptedMatrix && ...)}
1957 
1958         \textcolor{keywordtype}{bool} tmpCholIsPositiveDefinite = \textcolor{keyword}{false};
1959         P\_M tmpChol(*\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_a1c73b49339c8a1015d95a890d7882331}{m\_lastAdaptedCovMatrix});
1960         P\_M attemptedMatrix(tmpChol);
1961         \textcolor{keywordflow}{if} ((\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_ac8ea061e55b920e0c8f9bce5c3f20e52}{m\_env}.\hyperlink{class_q_u_e_s_o_1_1_base_environment_a8a0064746ae8dddfece4229b9ad374d6}{subDisplayFile}()        ) &&
1962             (\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_ac8ea061e55b920e0c8f9bce5c3f20e52}{m\_env}.\hyperlink{class_q_u_e_s_o_1_1_base_environment_a1fe5f244fc0316a0ab3e37463f108b96}{displayVerbosity}() >= 10)) \{
1963     \textcolor{comment}{//(m\_optionsObj->m\_ov.m\_totallyMute == false)) \{}
1964           *\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_ac8ea061e55b920e0c8f9bce5c3f20e52}{m\_env}.\hyperlink{class_q_u_e_s_o_1_1_base_environment_a8a0064746ae8dddfece4229b9ad374d6}{subDisplayFile}() << \textcolor{stringliteral}{"In
       MetropolisHastingsSG<P\_V,P\_M>::generateFullChain()"}
1965                                   << \textcolor{stringliteral}{", positionId = "}  << positionId
1966                                   << \textcolor{stringliteral}{": 'am' calling first tmpChol.chol()"}
1967                                   << std::endl;
1968         \}
1969         iRC = tmpChol.chol();
1970         \textcolor{keywordflow}{if} (iRC) \{
1971           std::cerr << \textcolor{stringliteral}{"In MetropolisHastingsSG<P\_V,P\_M>::generateFullChain(): first chol failed\(\backslash\)n"};
1972         \}
1973         \textcolor{keywordflow}{if} ((\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_ac8ea061e55b920e0c8f9bce5c3f20e52}{m\_env}.\hyperlink{class_q_u_e_s_o_1_1_base_environment_a8a0064746ae8dddfece4229b9ad374d6}{subDisplayFile}()        ) &&
1974             (\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_ac8ea061e55b920e0c8f9bce5c3f20e52}{m\_env}.\hyperlink{class_q_u_e_s_o_1_1_base_environment_a1fe5f244fc0316a0ab3e37463f108b96}{displayVerbosity}() >= 10)) \{
1975     \textcolor{comment}{//(m\_optionsObj->m\_ov.m\_totallyMute == false)) \{}
1976           *\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_ac8ea061e55b920e0c8f9bce5c3f20e52}{m\_env}.\hyperlink{class_q_u_e_s_o_1_1_base_environment_a8a0064746ae8dddfece4229b9ad374d6}{subDisplayFile}() << \textcolor{stringliteral}{"In
       MetropolisHastingsSG<P\_V,P\_M>::generateFullChain()"}
1977                                   << \textcolor{stringliteral}{", positionId = "}  << positionId
1978                                   << \textcolor{stringliteral}{": 'am' got first tmpChol.chol() with iRC = "} << iRC
1979                                   << std::endl;
1980           \textcolor{keywordflow}{if} (iRC == 0) \{
1981             \textcolor{keywordtype}{double} diagMult = 1.;
1982             \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} j = 0; j < tmpChol.numRowsLocal(); ++j) \{
1983               diagMult *= tmpChol(j,j);
1984             \}
1985             *\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_ac8ea061e55b920e0c8f9bce5c3f20e52}{m\_env}.\hyperlink{class_q_u_e_s_o_1_1_base_environment_a8a0064746ae8dddfece4229b9ad374d6}{subDisplayFile}() << \textcolor{stringliteral}{"diagMult = "} << diagMult
1986                                     << std::endl;
1987           \}
1988         \}
1989 \textcolor{preprocessor}{#if 0 // tentative logic}
1990 \textcolor{preprocessor}{}        \textcolor{keywordflow}{if} (iRC == 0) \{
1991           \textcolor{keywordtype}{double} diagMult = 1.;
1992           \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} j = 0; j < tmpChol.numRowsLocal(); ++j) \{
1993             diagMult *= tmpChol(j,j);
1994           \}
1995           \textcolor{keywordflow}{if} (diagMult < 1.e-40) \{
1996             iRC = \hyperlink{namespace_q_u_e_s_o_a677863cd32092584175760250f39e8bb}{UQ\_MATRIX\_IS\_NOT\_POS\_DEFINITE\_RC};
1997           \}
1998         \}
1999 \textcolor{preprocessor}{#endif}
2000 \textcolor{preprocessor}{}
2001         \textcolor{keywordflow}{if} (iRC) \{
2002           \hyperlink{_defines_8h_a56d63d18d0a6d45757de47fcc06f574d}{UQ\_FATAL\_TEST\_MACRO}(iRC != 
      \hyperlink{namespace_q_u_e_s_o_a677863cd32092584175760250f39e8bb}{UQ\_MATRIX\_IS\_NOT\_POS\_DEFINITE\_RC},
2003                               \hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_ac8ea061e55b920e0c8f9bce5c3f20e52}{m\_env}.\hyperlink{class_q_u_e_s_o_1_1_base_environment_a78b57112bbd0e6dd0e8afec00b40ffa7}{worldRank}(),
2004                               \textcolor{stringliteral}{"MetropolisHastingsSG<P\_V,P\_M>::generateFullChain()"},
2005                               \textcolor{stringliteral}{"invalid iRC returned from first chol()"});
2006           \textcolor{comment}{// Matrix is not positive definite}
2007           P\_M* tmpDiag = \hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_a2ef17fbfc6a156f03bbfad044b5a75f5}{m\_vectorSpace}.\hyperlink{class_q_u_e_s_o_1_1_vector_space_a9f4ad174b63fbc0626070e0f38745e1e}{newDiagMatrix}(
      \hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_a5d0bc9f73d50d272aa6bfb5ef5939ef3}{m\_optionsObj}->\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_options_a9d4792d9fc2dc5439b8ab489b0c236eb}{m\_ov}.\hyperlink{class_q_u_e_s_o_1_1_mh_options_values_af899c001e1bbdaf9c740d6b4dc0e13e0}{m\_amEpsilon});
2008           \textcolor{keywordflow}{if} (\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_a43a883aa28c81ed99e5f0cd9de93889b}{m\_numDisabledParameters} > 0) \{ \textcolor{comment}{// gpmsa2}
2009             \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} paramId = 0; paramId < \hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_a2ef17fbfc6a156f03bbfad044b5a75f5}{m\_vectorSpace}.
      \hyperlink{class_q_u_e_s_o_1_1_vector_space_a5829a1f4f996f8307c840b705144d666}{dimLocal}(); ++paramId) \{
2010               \textcolor{keywordflow}{if} (\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_afce8eeadae98935c72727b3640e88a31}{m\_parameterEnabledStatus}[paramId] == \textcolor{keyword}{false}) \{
2011                 (*tmpDiag)(paramId,paramId) = 0.;
2012               \}
2013             \}
2014           \}
2015           tmpChol = *\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_a1c73b49339c8a1015d95a890d7882331}{m\_lastAdaptedCovMatrix} + *tmpDiag;
2016           attemptedMatrix = tmpChol;
2017           \textcolor{keyword}{delete} tmpDiag;
2018           \textcolor{keywordflow}{if} ((\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_ac8ea061e55b920e0c8f9bce5c3f20e52}{m\_env}.\hyperlink{class_q_u_e_s_o_1_1_base_environment_a8a0064746ae8dddfece4229b9ad374d6}{subDisplayFile}()        ) &&
2019               (\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_ac8ea061e55b920e0c8f9bce5c3f20e52}{m\_env}.\hyperlink{class_q_u_e_s_o_1_1_base_environment_a1fe5f244fc0316a0ab3e37463f108b96}{displayVerbosity}() >= 10)) \{
2020       \textcolor{comment}{//(m\_optionsObj->m\_ov.m\_totallyMute == false)) \{}
2021             *\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_ac8ea061e55b920e0c8f9bce5c3f20e52}{m\_env}.\hyperlink{class_q_u_e_s_o_1_1_base_environment_a8a0064746ae8dddfece4229b9ad374d6}{subDisplayFile}() << \textcolor{stringliteral}{"In
       MetropolisHastingsSG<P\_V,P\_M>::generateFullChain()"}
2022                                     << \textcolor{stringliteral}{", positionId = "}  << positionId
2023                                     << \textcolor{stringliteral}{": 'am' calling second tmpChol.chol()"}
2024                                     << std::endl;
2025           \}
2026           iRC = tmpChol.chol();
2027           \textcolor{keywordflow}{if} (iRC) \{
2028             std::cerr << \textcolor{stringliteral}{"In MetropolisHastingsSG<P\_V,P\_M>::generateFullChain(): second chol failed\(\backslash\)n"};
2029           \}
2030           \textcolor{keywordflow}{if} ((\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_ac8ea061e55b920e0c8f9bce5c3f20e52}{m\_env}.\hyperlink{class_q_u_e_s_o_1_1_base_environment_a8a0064746ae8dddfece4229b9ad374d6}{subDisplayFile}()        ) &&
2031               (\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_ac8ea061e55b920e0c8f9bce5c3f20e52}{m\_env}.\hyperlink{class_q_u_e_s_o_1_1_base_environment_a1fe5f244fc0316a0ab3e37463f108b96}{displayVerbosity}() >= 10)) \{
2032       \textcolor{comment}{//(m\_optionsObj->m\_ov.m\_totallyMute == false)) \{}
2033             *\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_ac8ea061e55b920e0c8f9bce5c3f20e52}{m\_env}.\hyperlink{class_q_u_e_s_o_1_1_base_environment_a8a0064746ae8dddfece4229b9ad374d6}{subDisplayFile}() << \textcolor{stringliteral}{"In
       MetropolisHastingsSG<P\_V,P\_M>::generateFullChain()"}
2034                                     << \textcolor{stringliteral}{", positionId = "} << positionId
2035                                     << \textcolor{stringliteral}{": 'am' got second tmpChol.chol() with iRC = "} << iRC
2036                                     << std::endl;
2037             \textcolor{keywordflow}{if} (iRC == 0) \{
2038               \textcolor{keywordtype}{double} diagMult = 1.;
2039               \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} j = 0; j < tmpChol.numRowsLocal(); ++j) \{
2040                 diagMult *= tmpChol(j,j);
2041               \}
2042               *\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_ac8ea061e55b920e0c8f9bce5c3f20e52}{m\_env}.\hyperlink{class_q_u_e_s_o_1_1_base_environment_a8a0064746ae8dddfece4229b9ad374d6}{subDisplayFile}() << \textcolor{stringliteral}{"diagMult = "} << diagMult
2043                                       << std::endl;
2044             \}
2045             \textcolor{keywordflow}{else} \{
2046               *\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_ac8ea061e55b920e0c8f9bce5c3f20e52}{m\_env}.\hyperlink{class_q_u_e_s_o_1_1_base_environment_a8a0064746ae8dddfece4229b9ad374d6}{subDisplayFile}() << \textcolor{stringliteral}{"attemptedMatrix = "} << attemptedMatrix \textcolor{comment}{// FIX
       ME: might demand parallelism}
2047                                       << std::endl;
2048             \}
2049           \}
2050           \textcolor{keywordflow}{if} (iRC) \{
2051             \hyperlink{_defines_8h_a56d63d18d0a6d45757de47fcc06f574d}{UQ\_FATAL\_TEST\_MACRO}(iRC != 
      \hyperlink{namespace_q_u_e_s_o_a677863cd32092584175760250f39e8bb}{UQ\_MATRIX\_IS\_NOT\_POS\_DEFINITE\_RC},
2052                                 \hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_ac8ea061e55b920e0c8f9bce5c3f20e52}{m\_env}.\hyperlink{class_q_u_e_s_o_1_1_base_environment_a78b57112bbd0e6dd0e8afec00b40ffa7}{worldRank}(),
2053                                 \textcolor{stringliteral}{"MetropolisHastingsSG<P\_V,P\_M>::generateFullChain()"},
2054                                 \textcolor{stringliteral}{"invalid iRC returned from second chol()"});
2055             \textcolor{comment}{// Do nothing}
2056           \}
2057           \textcolor{keywordflow}{else} \{
2058             tmpCholIsPositiveDefinite = \textcolor{keyword}{true};
2059           \}
2060         \}
2061         \textcolor{keywordflow}{else} \{
2062           tmpCholIsPositiveDefinite = \textcolor{keyword}{true};
2063         \}
2064         \textcolor{keywordflow}{if} (tmpCholIsPositiveDefinite) \{
2065           ScaledCovMatrixTKGroup<P\_V,P\_M>* tempTK = \textcolor{keyword}{dynamic\_cast<}ScaledCovMatrixTKGroup<P\_V,P\_M>* \textcolor{keyword}{>}(
      \hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_a26e9680abddfb793486c995fa16f8c2d}{m\_tk});
2066           P\_M tmpMatrix(\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_a5d0bc9f73d50d272aa6bfb5ef5939ef3}{m\_optionsObj}->\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_options_a9d4792d9fc2dc5439b8ab489b0c236eb}{m\_ov}.\hyperlink{class_q_u_e_s_o_1_1_mh_options_values_ac901ea79ba9b77aae31e3ea07df140b1}{m\_amEta}*attemptedMatrix);
2067           \textcolor{keywordflow}{if} (\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_a43a883aa28c81ed99e5f0cd9de93889b}{m\_numDisabledParameters} > 0) \{ \textcolor{comment}{// gpmsa2}
2068             \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} paramId = 0; paramId < \hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_a2ef17fbfc6a156f03bbfad044b5a75f5}{m\_vectorSpace}.
      \hyperlink{class_q_u_e_s_o_1_1_vector_space_a5829a1f4f996f8307c840b705144d666}{dimLocal}(); ++paramId) \{
2069               \textcolor{keywordflow}{if} (\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_afce8eeadae98935c72727b3640e88a31}{m\_parameterEnabledStatus}[paramId] == \textcolor{keyword}{false}) \{
2070                 \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} i = 0; i < \hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_a2ef17fbfc6a156f03bbfad044b5a75f5}{m\_vectorSpace}.\hyperlink{class_q_u_e_s_o_1_1_vector_space_a5829a1f4f996f8307c840b705144d666}{dimLocal}(); ++i) \{
2071                   tmpMatrix(i,paramId) = 0.;
2072                 \}
2073                 \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} j = 0; j < \hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_a2ef17fbfc6a156f03bbfad044b5a75f5}{m\_vectorSpace}.\hyperlink{class_q_u_e_s_o_1_1_vector_space_a5829a1f4f996f8307c840b705144d666}{dimLocal}(); ++j) \{
2074                   tmpMatrix(paramId,j) = 0.;
2075                 \}
2076                 tmpMatrix(paramId,paramId) = 1.;
2077               \}
2078             \}
2079           \}
2080           tempTK->updateLawCovMatrix(tmpMatrix);
2081 
2082 \textcolor{preprocessor}{#ifdef UQ\_DRAM\_MCG\_REQUIRES\_INVERTED\_COV\_MATRICES}
2083 \textcolor{preprocessor}{}          \hyperlink{_defines_8h_aa9107e1a9a5197371a412db3fa349988}{UQ\_FATAL\_RC\_MACRO}(\hyperlink{namespace_q_u_e_s_o_a5332d3ac9b246e40779ba01f19a3f0c7}{UQ\_INCOMPLETE\_IMPLEMENTATION\_RC}
      ,
2084                             \hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_ac8ea061e55b920e0c8f9bce5c3f20e52}{m\_env}.\hyperlink{class_q_u_e_s_o_1_1_base_environment_a78b57112bbd0e6dd0e8afec00b40ffa7}{worldRank}(),
2085                             \textcolor{stringliteral}{"MetropolisHastingsSG<P\_V,P\_M>::generateFullChain()"},
2086                             \textcolor{stringliteral}{"need to code the update of m\_upperCholProposalPrecMatrices"});
2087 \textcolor{preprocessor}{#endif}
2088 \textcolor{preprocessor}{}        \}
2089 
2090         \textcolor{comment}{//for (unsigned int i = 0; i < partialChain.subSequenceSize(); ++i) \{}
2091         \textcolor{comment}{//  if (partialChain[i]) delete partialChain[i];}
2092         \textcolor{comment}{//\}}
2093       \} \textcolor{comment}{// if (partialChain.subSequenceSize() > 0)}
2094 
2095       \textcolor{keywordflow}{if} (\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_a5d0bc9f73d50d272aa6bfb5ef5939ef3}{m\_optionsObj}->\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_options_a9d4792d9fc2dc5439b8ab489b0c236eb}{m\_ov}.\hyperlink{class_q_u_e_s_o_1_1_mh_options_values_a6fcc2efc9146b68548e62d707aeed883}{m\_rawChainMeasureRunTimes}) 
      \hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_ac531509489028853bb17c0353fc9eafd}{m\_rawChainInfo}.\hyperlink{struct_q_u_e_s_o_1_1_m_h_raw_chain_info_struct_a0ea7cbad553a5f79c1e1c89b25bc8cde}{amRunTime} += \hyperlink{namespace_q_u_e_s_o_a424bc33f2e6e287fd468408d14b772ee}{MiscGetEllapsedSeconds}(&timevalAM)
      ;
2096     \} \textcolor{comment}{// End of 'adaptive Metropolis' logic}
2097 
2098     \textcolor{comment}{//****************************************************}
2099     \textcolor{comment}{// Point 6/6 of logic for new position}
2100     \textcolor{comment}{// Loop: print some information before going to the next chain position}
2101     \textcolor{comment}{//****************************************************}
2102     \textcolor{keywordflow}{if} ((\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_ac8ea061e55b920e0c8f9bce5c3f20e52}{m\_env}.\hyperlink{class_q_u_e_s_o_1_1_base_environment_a8a0064746ae8dddfece4229b9ad374d6}{subDisplayFile}()                   ) &&
2103         (\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_ac8ea061e55b920e0c8f9bce5c3f20e52}{m\_env}.\hyperlink{class_q_u_e_s_o_1_1_base_environment_a1fe5f244fc0316a0ab3e37463f108b96}{displayVerbosity}() >= 3            ) &&
2104         (\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_a5d0bc9f73d50d272aa6bfb5ef5939ef3}{m\_optionsObj}->\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_options_a9d4792d9fc2dc5439b8ab489b0c236eb}{m\_ov}.\hyperlink{class_q_u_e_s_o_1_1_mh_options_values_af812309e81191e88dfdc87c5815141a3}{m\_totallyMute} == \textcolor{keyword}{false})) \{
2105       *\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_ac8ea061e55b920e0c8f9bce5c3f20e52}{m\_env}.\hyperlink{class_q_u_e_s_o_1_1_base_environment_a8a0064746ae8dddfece4229b9ad374d6}{subDisplayFile}() << \textcolor{stringliteral}{"In MetropolisHastingsSG<P\_V,P\_M>::generateFullChain()"}
2106                               << \textcolor{stringliteral}{": finishing chain position of id = "} << positionId
2107                               << \textcolor{stringliteral}{", accept = "}                         << accept
2108                               << \textcolor{stringliteral}{", curLogTarget  = "}                  << currentPositionData.logTarget()
2109                               << \textcolor{stringliteral}{", canLogTarget  = "}                  << currentCandidateData.logTarget()
2110                               << std::endl;
2111     \}
2112 
2113     \textcolor{keywordflow}{if} ((\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_a5d0bc9f73d50d272aa6bfb5ef5939ef3}{m\_optionsObj}->\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_options_a9d4792d9fc2dc5439b8ab489b0c236eb}{m\_ov}.\hyperlink{class_q_u_e_s_o_1_1_mh_options_values_a6d11f0ea62107b789da99befe29ebffa}{m\_rawChainDisplayPeriod}                 
          > 0) &&
2114         (((positionId+1) % \hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_a5d0bc9f73d50d272aa6bfb5ef5939ef3}{m\_optionsObj}->\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_options_a9d4792d9fc2dc5439b8ab489b0c236eb}{m\_ov}.
      \hyperlink{class_q_u_e_s_o_1_1_mh_options_values_a6d11f0ea62107b789da99befe29ebffa}{m\_rawChainDisplayPeriod}) == 0)) \{
2115       \textcolor{keywordflow}{if} ((\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_ac8ea061e55b920e0c8f9bce5c3f20e52}{m\_env}.\hyperlink{class_q_u_e_s_o_1_1_base_environment_a8a0064746ae8dddfece4229b9ad374d6}{subDisplayFile}()                   ) &&
2116           (\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_a5d0bc9f73d50d272aa6bfb5ef5939ef3}{m\_optionsObj}->\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_options_a9d4792d9fc2dc5439b8ab489b0c236eb}{m\_ov}.\hyperlink{class_q_u_e_s_o_1_1_mh_options_values_af812309e81191e88dfdc87c5815141a3}{m\_totallyMute} == \textcolor{keyword}{false})) \{
2117         *\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_ac8ea061e55b920e0c8f9bce5c3f20e52}{m\_env}.\hyperlink{class_q_u_e_s_o_1_1_base_environment_a8a0064746ae8dddfece4229b9ad374d6}{subDisplayFile}() << \textcolor{stringliteral}{"Finished generating "} << positionId+1
2118                                 << \textcolor{stringliteral}{" positions"}  \textcolor{comment}{// root}
2119                                 << \textcolor{stringliteral}{", curret rejection percentage = "} << (100. * ((double) 
      \hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_ac531509489028853bb17c0353fc9eafd}{m\_rawChainInfo}.\hyperlink{struct_q_u_e_s_o_1_1_m_h_raw_chain_info_struct_a276f608de19910713df01124a971c79c}{numRejections})/((double) (positionId+1)))
2120                                 << \textcolor{stringliteral}{" %"}
2121                                 << std::endl;
2122       \}
2123     \}
2124 
2125     \textcolor{keywordflow}{if} ((\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_ac8ea061e55b920e0c8f9bce5c3f20e52}{m\_env}.\hyperlink{class_q_u_e_s_o_1_1_base_environment_a8a0064746ae8dddfece4229b9ad374d6}{subDisplayFile}()                   ) &&
2126         (\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_ac8ea061e55b920e0c8f9bce5c3f20e52}{m\_env}.\hyperlink{class_q_u_e_s_o_1_1_base_environment_a1fe5f244fc0316a0ab3e37463f108b96}{displayVerbosity}() >= 10           ) &&
2127         (\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_a5d0bc9f73d50d272aa6bfb5ef5939ef3}{m\_optionsObj}->\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_options_a9d4792d9fc2dc5439b8ab489b0c236eb}{m\_ov}.\hyperlink{class_q_u_e_s_o_1_1_mh_options_values_af812309e81191e88dfdc87c5815141a3}{m\_totallyMute} == \textcolor{keyword}{false})) \{
2128       *\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_ac8ea061e55b920e0c8f9bce5c3f20e52}{m\_env}.\hyperlink{class_q_u_e_s_o_1_1_base_environment_a8a0064746ae8dddfece4229b9ad374d6}{subDisplayFile}() << \textcolor{stringliteral}{"\(\backslash\)n"}
2129                               << \textcolor{stringliteral}{"\(\backslash\)n++++++++++++++++++++++++++++++++++++++++++++++++++++++++"}
2130                               << \textcolor{stringliteral}{"\(\backslash\)n"}
2131                               << std::endl;
2132     \}
2133   \} \textcolor{comment}{// end chain loop [for (unsigned int positionId = 1; positionId < workingChain.subSequenceSize();
       ++positionId) \{]}
2134 
2135   \textcolor{keywordflow}{if} ((\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_ac8ea061e55b920e0c8f9bce5c3f20e52}{m\_env}.\hyperlink{class_q_u_e_s_o_1_1_base_environment_ac0345f57e31ef7833e379ed972bd094d}{numSubEnvironments}() < (\textcolor{keywordtype}{unsigned} int) \hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_ac8ea061e55b920e0c8f9bce5c3f20e52}{m\_env}.
      \hyperlink{class_q_u_e_s_o_1_1_base_environment_a0b0779b41ff304058856e97e1d16b4d4}{fullComm}().\hyperlink{class_q_u_e_s_o_1_1_mpi_comm_aa780721ae0fdeabc5a15e04cb0cad964}{NumProc}()) &&
2136       (\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_ae29f5d1198228858283d733021da2b14}{m\_initialPosition}.numOfProcsForStorage() == 1                         ) &&
2137       (\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_ac8ea061e55b920e0c8f9bce5c3f20e52}{m\_env}.\hyperlink{class_q_u_e_s_o_1_1_base_environment_a172d52f993f1322ed45aaddf71518dbb}{subRank}()                          == 0                         )) \{
2138     \textcolor{comment}{// subRank == 0 --> Tell all other processors to exit barrier now that the chain has been fully
       generated}
2139     \textcolor{keywordtype}{double} aux = 0.;
2140     aux = \hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_ae7c7551764e0ccdfbe2862c544cdab10}{m\_targetPdfSynchronizer}->\hyperlink{class_q_u_e_s_o_1_1_scalar_function_synchronizer_adcdc70486ac64c11d0e505c4fb590a6b}{callFunction}(NULL,
2141                                                 NULL,
2142                                                 NULL,
2143                                                 NULL,
2144                                                 NULL,
2145                                                 NULL,
2146                                                 NULL);
2147     \textcolor{keywordflow}{if} (aux) \{\}; \textcolor{comment}{// just to remove compiler warning}
2148   \}
2149 
2150   \textcolor{comment}{//****************************************************}
2151   \textcolor{comment}{// Print basic information about the chain}
2152   \textcolor{comment}{//****************************************************}
2153   \hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_ac531509489028853bb17c0353fc9eafd}{m\_rawChainInfo}.\hyperlink{struct_q_u_e_s_o_1_1_m_h_raw_chain_info_struct_a5b36b9734f0b40d54cfd4c58c18c9b45}{runTime} += \hyperlink{namespace_q_u_e_s_o_a424bc33f2e6e287fd468408d14b772ee}{MiscGetEllapsedSeconds}(&timevalChain
      );
2154   \textcolor{keywordflow}{if} ((\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_ac8ea061e55b920e0c8f9bce5c3f20e52}{m\_env}.\hyperlink{class_q_u_e_s_o_1_1_base_environment_a8a0064746ae8dddfece4229b9ad374d6}{subDisplayFile}()                   ) &&
2155       (\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_a5d0bc9f73d50d272aa6bfb5ef5939ef3}{m\_optionsObj}->\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_options_a9d4792d9fc2dc5439b8ab489b0c236eb}{m\_ov}.\hyperlink{class_q_u_e_s_o_1_1_mh_options_values_af812309e81191e88dfdc87c5815141a3}{m\_totallyMute} == \textcolor{keyword}{false})) \{
2156     *\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_ac8ea061e55b920e0c8f9bce5c3f20e52}{m\_env}.\hyperlink{class_q_u_e_s_o_1_1_base_environment_a8a0064746ae8dddfece4229b9ad374d6}{subDisplayFile}() << \textcolor{stringliteral}{"Finished the generation of Markov chain "} << 
      workingChain.\hyperlink{class_q_u_e_s_o_1_1_base_vector_sequence_a48f6fe02cf77f4233d3bcdfef3870f19}{name}()
2157                             << \textcolor{stringliteral}{", with sub "}                              << workingChain.
      \hyperlink{class_q_u_e_s_o_1_1_base_vector_sequence_afd6278702d40bdf1044697bbd6ad1957}{subSequenceSize}()
2158                             << \textcolor{stringliteral}{" positions"};
2159     *\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_ac8ea061e55b920e0c8f9bce5c3f20e52}{m\_env}.\hyperlink{class_q_u_e_s_o_1_1_base_environment_a8a0064746ae8dddfece4229b9ad374d6}{subDisplayFile}() << \textcolor{stringliteral}{"\(\backslash\)nSome information about this chain:"}
2160                             << \textcolor{stringliteral}{"\(\backslash\)n  Chain run time       = "} << \hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_ac531509489028853bb17c0353fc9eafd}{m\_rawChainInfo}.
      \hyperlink{struct_q_u_e_s_o_1_1_m_h_raw_chain_info_struct_a5b36b9734f0b40d54cfd4c58c18c9b45}{runTime}
2161                             << \textcolor{stringliteral}{" seconds"};
2162     \textcolor{keywordflow}{if} (\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_a5d0bc9f73d50d272aa6bfb5ef5939ef3}{m\_optionsObj}->\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_options_a9d4792d9fc2dc5439b8ab489b0c236eb}{m\_ov}.\hyperlink{class_q_u_e_s_o_1_1_mh_options_values_a6fcc2efc9146b68548e62d707aeed883}{m\_rawChainMeasureRunTimes}) \{
2163       *\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_ac8ea061e55b920e0c8f9bce5c3f20e52}{m\_env}.\hyperlink{class_q_u_e_s_o_1_1_base_environment_a8a0064746ae8dddfece4229b9ad374d6}{subDisplayFile}() << \textcolor{stringliteral}{"\(\backslash\)n\(\backslash\)n Breaking of the chain run time:\(\backslash\)n"};
2164       *\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_ac8ea061e55b920e0c8f9bce5c3f20e52}{m\_env}.\hyperlink{class_q_u_e_s_o_1_1_base_environment_a8a0064746ae8dddfece4229b9ad374d6}{subDisplayFile}() << \textcolor{stringliteral}{"\(\backslash\)n  Candidate run time   = "} << 
      \hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_ac531509489028853bb17c0353fc9eafd}{m\_rawChainInfo}.\hyperlink{struct_q_u_e_s_o_1_1_m_h_raw_chain_info_struct_ada3a9649c975062a366df63561c599c7}{candidateRunTime}
2165                               << \textcolor{stringliteral}{" seconds ("}                  << 100.*
      \hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_ac531509489028853bb17c0353fc9eafd}{m\_rawChainInfo}.\hyperlink{struct_q_u_e_s_o_1_1_m_h_raw_chain_info_struct_ada3a9649c975062a366df63561c599c7}{candidateRunTime}/\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_ac531509489028853bb17c0353fc9eafd}{m\_rawChainInfo}.
      \hyperlink{struct_q_u_e_s_o_1_1_m_h_raw_chain_info_struct_a5b36b9734f0b40d54cfd4c58c18c9b45}{runTime}
2166                               << \textcolor{stringliteral}{"%)"};
2167       *\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_ac8ea061e55b920e0c8f9bce5c3f20e52}{m\_env}.\hyperlink{class_q_u_e_s_o_1_1_base_environment_a8a0064746ae8dddfece4229b9ad374d6}{subDisplayFile}() << \textcolor{stringliteral}{"\(\backslash\)n  Num target calls  = "}    << 
      \hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_ac531509489028853bb17c0353fc9eafd}{m\_rawChainInfo}.\hyperlink{struct_q_u_e_s_o_1_1_m_h_raw_chain_info_struct_a506e08bdffc1f777e33c7ec2d7862747}{numTargetCalls};
2168       *\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_ac8ea061e55b920e0c8f9bce5c3f20e52}{m\_env}.\hyperlink{class_q_u_e_s_o_1_1_base_environment_a8a0064746ae8dddfece4229b9ad374d6}{subDisplayFile}() << \textcolor{stringliteral}{"\(\backslash\)n  Target d. run time   = "} << 
      \hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_ac531509489028853bb17c0353fc9eafd}{m\_rawChainInfo}.\hyperlink{struct_q_u_e_s_o_1_1_m_h_raw_chain_info_struct_ab230db8f99e46f0c1e4fc6c2aa3773eb}{targetRunTime}
2169                               << \textcolor{stringliteral}{" seconds ("}                  << 100.*
      \hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_ac531509489028853bb17c0353fc9eafd}{m\_rawChainInfo}.\hyperlink{struct_q_u_e_s_o_1_1_m_h_raw_chain_info_struct_ab230db8f99e46f0c1e4fc6c2aa3773eb}{targetRunTime}/\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_ac531509489028853bb17c0353fc9eafd}{m\_rawChainInfo}.
      \hyperlink{struct_q_u_e_s_o_1_1_m_h_raw_chain_info_struct_a5b36b9734f0b40d54cfd4c58c18c9b45}{runTime}
2170                               << \textcolor{stringliteral}{"%)"};
2171       *\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_ac8ea061e55b920e0c8f9bce5c3f20e52}{m\_env}.\hyperlink{class_q_u_e_s_o_1_1_base_environment_a8a0064746ae8dddfece4229b9ad374d6}{subDisplayFile}() << \textcolor{stringliteral}{"\(\backslash\)n  Avg target run time   = "} << 
      \hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_ac531509489028853bb17c0353fc9eafd}{m\_rawChainInfo}.\hyperlink{struct_q_u_e_s_o_1_1_m_h_raw_chain_info_struct_ab230db8f99e46f0c1e4fc6c2aa3773eb}{targetRunTime}/((double) \hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_ac531509489028853bb17c0353fc9eafd}{m\_rawChainInfo}.
      \hyperlink{struct_q_u_e_s_o_1_1_m_h_raw_chain_info_struct_a506e08bdffc1f777e33c7ec2d7862747}{numTargetCalls})
2172                               << \textcolor{stringliteral}{" seconds"};
2173       *\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_ac8ea061e55b920e0c8f9bce5c3f20e52}{m\_env}.\hyperlink{class_q_u_e_s_o_1_1_base_environment_a8a0064746ae8dddfece4229b9ad374d6}{subDisplayFile}() << \textcolor{stringliteral}{"\(\backslash\)n  Mh alpha run time    = "} << 
      \hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_ac531509489028853bb17c0353fc9eafd}{m\_rawChainInfo}.\hyperlink{struct_q_u_e_s_o_1_1_m_h_raw_chain_info_struct_a16d5d703c764352dfe30dfaa25ce8b8b}{mhAlphaRunTime}
2174                               << \textcolor{stringliteral}{" seconds ("}                  << 100.*
      \hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_ac531509489028853bb17c0353fc9eafd}{m\_rawChainInfo}.\hyperlink{struct_q_u_e_s_o_1_1_m_h_raw_chain_info_struct_a16d5d703c764352dfe30dfaa25ce8b8b}{mhAlphaRunTime}/\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_ac531509489028853bb17c0353fc9eafd}{m\_rawChainInfo}.
      \hyperlink{struct_q_u_e_s_o_1_1_m_h_raw_chain_info_struct_a5b36b9734f0b40d54cfd4c58c18c9b45}{runTime}
2175                               << \textcolor{stringliteral}{"%)"};
2176       *\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_ac8ea061e55b920e0c8f9bce5c3f20e52}{m\_env}.\hyperlink{class_q_u_e_s_o_1_1_base_environment_a8a0064746ae8dddfece4229b9ad374d6}{subDisplayFile}() << \textcolor{stringliteral}{"\(\backslash\)n  Dr alpha run time    = "} << 
      \hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_ac531509489028853bb17c0353fc9eafd}{m\_rawChainInfo}.\hyperlink{struct_q_u_e_s_o_1_1_m_h_raw_chain_info_struct_afa74a9d74fc3e7942012b8d8448f6687}{drAlphaRunTime}
2177                               << \textcolor{stringliteral}{" seconds ("}                  << 100.*
      \hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_ac531509489028853bb17c0353fc9eafd}{m\_rawChainInfo}.\hyperlink{struct_q_u_e_s_o_1_1_m_h_raw_chain_info_struct_afa74a9d74fc3e7942012b8d8448f6687}{drAlphaRunTime}/\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_ac531509489028853bb17c0353fc9eafd}{m\_rawChainInfo}.
      \hyperlink{struct_q_u_e_s_o_1_1_m_h_raw_chain_info_struct_a5b36b9734f0b40d54cfd4c58c18c9b45}{runTime}
2178                               << \textcolor{stringliteral}{"%)"};
2179       *\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_ac8ea061e55b920e0c8f9bce5c3f20e52}{m\_env}.\hyperlink{class_q_u_e_s_o_1_1_base_environment_a8a0064746ae8dddfece4229b9ad374d6}{subDisplayFile}() << \textcolor{stringliteral}{"\(\backslash\)n----------------------   --------------"};
2180       \textcolor{keywordtype}{double} sumRunTime = \hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_ac531509489028853bb17c0353fc9eafd}{m\_rawChainInfo}.\hyperlink{struct_q_u_e_s_o_1_1_m_h_raw_chain_info_struct_ada3a9649c975062a366df63561c599c7}{candidateRunTime} + 
      \hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_ac531509489028853bb17c0353fc9eafd}{m\_rawChainInfo}.\hyperlink{struct_q_u_e_s_o_1_1_m_h_raw_chain_info_struct_ab230db8f99e46f0c1e4fc6c2aa3773eb}{targetRunTime} + \hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_ac531509489028853bb17c0353fc9eafd}{m\_rawChainInfo}.
      \hyperlink{struct_q_u_e_s_o_1_1_m_h_raw_chain_info_struct_a16d5d703c764352dfe30dfaa25ce8b8b}{mhAlphaRunTime} + \hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_ac531509489028853bb17c0353fc9eafd}{m\_rawChainInfo}.\hyperlink{struct_q_u_e_s_o_1_1_m_h_raw_chain_info_struct_afa74a9d74fc3e7942012b8d8448f6687}{drAlphaRunTime};
2181       *\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_ac8ea061e55b920e0c8f9bce5c3f20e52}{m\_env}.\hyperlink{class_q_u_e_s_o_1_1_base_environment_a8a0064746ae8dddfece4229b9ad374d6}{subDisplayFile}() << \textcolor{stringliteral}{"\(\backslash\)n  Sum                  = "} << sumRunTime
2182                               << \textcolor{stringliteral}{" seconds ("}                  << 100.*sumRunTime/
      \hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_ac531509489028853bb17c0353fc9eafd}{m\_rawChainInfo}.\hyperlink{struct_q_u_e_s_o_1_1_m_h_raw_chain_info_struct_a5b36b9734f0b40d54cfd4c58c18c9b45}{runTime}
2183                               << \textcolor{stringliteral}{"%)"};
2184       *\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_ac8ea061e55b920e0c8f9bce5c3f20e52}{m\_env}.\hyperlink{class_q_u_e_s_o_1_1_base_environment_a8a0064746ae8dddfece4229b9ad374d6}{subDisplayFile}() << \textcolor{stringliteral}{"\(\backslash\)n\(\backslash\)n Other run times:"};
2185       *\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_ac8ea061e55b920e0c8f9bce5c3f20e52}{m\_env}.\hyperlink{class_q_u_e_s_o_1_1_base_environment_a8a0064746ae8dddfece4229b9ad374d6}{subDisplayFile}() << \textcolor{stringliteral}{"\(\backslash\)n  DR run time          = "} << 
      \hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_ac531509489028853bb17c0353fc9eafd}{m\_rawChainInfo}.\hyperlink{struct_q_u_e_s_o_1_1_m_h_raw_chain_info_struct_acd15a61993f122a3780dfae6f096d9b9}{drRunTime}
2186                               << \textcolor{stringliteral}{" seconds ("}                  << 100.*
      \hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_ac531509489028853bb17c0353fc9eafd}{m\_rawChainInfo}.\hyperlink{struct_q_u_e_s_o_1_1_m_h_raw_chain_info_struct_acd15a61993f122a3780dfae6f096d9b9}{drRunTime}/\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_ac531509489028853bb17c0353fc9eafd}{m\_rawChainInfo}.
      \hyperlink{struct_q_u_e_s_o_1_1_m_h_raw_chain_info_struct_a5b36b9734f0b40d54cfd4c58c18c9b45}{runTime}
2187                               << \textcolor{stringliteral}{"%)"};
2188       *\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_ac8ea061e55b920e0c8f9bce5c3f20e52}{m\_env}.\hyperlink{class_q_u_e_s_o_1_1_base_environment_a8a0064746ae8dddfece4229b9ad374d6}{subDisplayFile}() << \textcolor{stringliteral}{"\(\backslash\)n  AM run time          = "} << 
      \hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_ac531509489028853bb17c0353fc9eafd}{m\_rawChainInfo}.\hyperlink{struct_q_u_e_s_o_1_1_m_h_raw_chain_info_struct_a0ea7cbad553a5f79c1e1c89b25bc8cde}{amRunTime}
2189                               << \textcolor{stringliteral}{" seconds ("}                  << 100.*
      \hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_ac531509489028853bb17c0353fc9eafd}{m\_rawChainInfo}.\hyperlink{struct_q_u_e_s_o_1_1_m_h_raw_chain_info_struct_a0ea7cbad553a5f79c1e1c89b25bc8cde}{amRunTime}/\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_ac531509489028853bb17c0353fc9eafd}{m\_rawChainInfo}.
      \hyperlink{struct_q_u_e_s_o_1_1_m_h_raw_chain_info_struct_a5b36b9734f0b40d54cfd4c58c18c9b45}{runTime}
2190                               << \textcolor{stringliteral}{"%)"};
2191     \}
2192     *\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_ac8ea061e55b920e0c8f9bce5c3f20e52}{m\_env}.\hyperlink{class_q_u_e_s_o_1_1_base_environment_a8a0064746ae8dddfece4229b9ad374d6}{subDisplayFile}() << \textcolor{stringliteral}{"\(\backslash\)n  Number of DRs = "}  << 
      \hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_ac531509489028853bb17c0353fc9eafd}{m\_rawChainInfo}.\hyperlink{struct_q_u_e_s_o_1_1_m_h_raw_chain_info_struct_a993b070bd796dd176f4168be05f11ce9}{numDRs} << \textcolor{stringliteral}{"(num\_DRs/chain\_size = "} << (double) 
      \hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_ac531509489028853bb17c0353fc9eafd}{m\_rawChainInfo}.\hyperlink{struct_q_u_e_s_o_1_1_m_h_raw_chain_info_struct_a993b070bd796dd176f4168be05f11ce9}{numDRs}/(\textcolor{keywordtype}{double}) workingChain.\hyperlink{class_q_u_e_s_o_1_1_base_vector_sequence_afd6278702d40bdf1044697bbd6ad1957}{subSequenceSize}()
2193                             << \textcolor{stringliteral}{")"};
2194     *\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_ac8ea061e55b920e0c8f9bce5c3f20e52}{m\_env}.\hyperlink{class_q_u_e_s_o_1_1_base_environment_a8a0064746ae8dddfece4229b9ad374d6}{subDisplayFile}() << \textcolor{stringliteral}{"\(\backslash\)n  Out of target support in DR = "} << 
      \hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_ac531509489028853bb17c0353fc9eafd}{m\_rawChainInfo}.\hyperlink{struct_q_u_e_s_o_1_1_m_h_raw_chain_info_struct_a783bb6c6b6dcab7f2bcc9fd0f49c588f}{numOutOfTargetSupportInDR};
2195     *\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_ac8ea061e55b920e0c8f9bce5c3f20e52}{m\_env}.\hyperlink{class_q_u_e_s_o_1_1_base_environment_a8a0064746ae8dddfece4229b9ad374d6}{subDisplayFile}() << \textcolor{stringliteral}{"\(\backslash\)n  Rejection percentage = "}        << 100. * (double) 
      \hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_ac531509489028853bb17c0353fc9eafd}{m\_rawChainInfo}.\hyperlink{struct_q_u_e_s_o_1_1_m_h_raw_chain_info_struct_a276f608de19910713df01124a971c79c}{numRejections}/(\textcolor{keywordtype}{double}) workingChain.
      \hyperlink{class_q_u_e_s_o_1_1_base_vector_sequence_afd6278702d40bdf1044697bbd6ad1957}{subSequenceSize}()
2196                             << \textcolor{stringliteral}{" %"};
2197     *\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_ac8ea061e55b920e0c8f9bce5c3f20e52}{m\_env}.\hyperlink{class_q_u_e_s_o_1_1_base_environment_a8a0064746ae8dddfece4229b9ad374d6}{subDisplayFile}() << \textcolor{stringliteral}{"\(\backslash\)n  Out of target support percentage = "} << 100. * (
      double) \hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_ac531509489028853bb17c0353fc9eafd}{m\_rawChainInfo}.\hyperlink{struct_q_u_e_s_o_1_1_m_h_raw_chain_info_struct_a601f798ee4dc28cfa6b342fc04a8c841}{numOutOfTargetSupport}/(\textcolor{keywordtype}{double}) workingChain.
      \hyperlink{class_q_u_e_s_o_1_1_base_vector_sequence_afd6278702d40bdf1044697bbd6ad1957}{subSequenceSize}()
2198                             << \textcolor{stringliteral}{" %"};
2199     *\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_ac8ea061e55b920e0c8f9bce5c3f20e52}{m\_env}.\hyperlink{class_q_u_e_s_o_1_1_base_environment_a8a0064746ae8dddfece4229b9ad374d6}{subDisplayFile}() << std::endl;
2200   \}
2201 
2202   \textcolor{comment}{//****************************************************}
2203   \textcolor{comment}{// Release memory before leaving routine}
2204   \textcolor{comment}{//****************************************************}
2205   \textcolor{comment}{//m\_env.syncPrintDebugMsg("Leaving
       MetropolisHastingsSG<P\_V,P\_M>::generateFullChain()",3,3000000,m\_env.fullComm()); // Dangerous to barrier on fullComm ... // KAUST}
2206 
2207   \textcolor{keywordflow}{return};
2208 \}
\end{DoxyCode}
\hypertarget{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_a34aae6d77dc81adb00e7049942553ae7}{\index{Q\-U\-E\-S\-O\-::\-Metropolis\-Hastings\-S\-G@{Q\-U\-E\-S\-O\-::\-Metropolis\-Hastings\-S\-G}!generate\-Sequence@{generate\-Sequence}}
\index{generate\-Sequence@{generate\-Sequence}!QUESO::MetropolisHastingsSG@{Q\-U\-E\-S\-O\-::\-Metropolis\-Hastings\-S\-G}}
\subsubsection[{generate\-Sequence}]{\setlength{\rightskip}{0pt plus 5cm}template$<$class P\-\_\-\-V , class P\-\_\-\-M $>$ void {\bf Q\-U\-E\-S\-O\-::\-Metropolis\-Hastings\-S\-G}$<$ P\-\_\-\-V, P\-\_\-\-M $>$\-::generate\-Sequence (
\begin{DoxyParamCaption}
\item[{{\bf Base\-Vector\-Sequence}$<$ P\-\_\-\-V, P\-\_\-\-M $>$ \&}]{working\-Chain, }
\item[{{\bf Scalar\-Sequence}$<$ double $>$ $\ast$}]{working\-Log\-Likelihood\-Values, }
\item[{{\bf Scalar\-Sequence}$<$ double $>$ $\ast$}]{working\-Log\-Target\-Values}
\end{DoxyParamCaption}
)}}\label{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_a34aae6d77dc81adb00e7049942553ae7}


Method to generate the chain. 

Requirement\-: the vector space 'm\-\_\-vector\-Space' should have dimension equal to the size of a vector in 'working\-Chain'. If the requirement is satisfied, this operation sets the size and the contents of 'working\-Chain' using the algorithm options set in the constructor. If not N\-U\-L\-L, 'working\-Log\-Likelihood\-Values' and 'working\-Log\-Target\-Values' are set accordingly. This operation currently implements the D\-R\-A\-M algorithm (Heikki Haario, Marko Laine, Antonietta Mira and Eero Saksman, \char`\"{}\-D\-R\-A\-M\-: Efficient Adaptive M\-C\-M\-C\char`\"{}, Statistics and Computing (2006), 16\-:339-\/354), as a translation of the core routine at the M\-C\-M\-C toolbox for M\-A\-T\-L\-A\-B, available at  (accessed in July 3rd, 2013). Indeed, the example available in examples/statistical\-Inverse\-Problem is closely related to the 'normal example' in the toolbox. Over time, though\-: 
\begin{DoxyEnumerate}
\item the whole set of \hyperlink{namespace_q_u_e_s_o}{Q\-U\-E\-S\-O} classes took shape, focusing not only on Markov Chains, but on statistical forward problems and model validation as well; 
\item the interfaces to this Metropolis-\/\-Hastings class changed; 
\item \hyperlink{namespace_q_u_e_s_o}{Q\-U\-E\-S\-O} has parallel capabilities; 
\item T\-K (transition kernel) class has been added in order to have both D\-R\-A\-M with Stochastic Newton capabilities. 
\end{DoxyEnumerate}

Definition at line 811 of file Metropolis\-Hastings\-S\-G.\-C.



References Q\-U\-E\-S\-O\-::\-Base\-Vector\-Sequence$<$ V, M $>$\-::compute\-Filter\-Params(), Q\-U\-E\-S\-O\-::\-Base\-Vector\-Sequence$<$ V, M $>$\-::filter(), Q\-U\-E\-S\-O\-::\-Scalar\-Sequence$<$ T $>$\-::filter(), Q\-U\-E\-S\-O\-::\-Sequence\-Of\-Vectors$<$ V, M $>$\-::get\-Position\-Values(), Q\-U\-E\-S\-O\-::\-Base\-Vector\-Sequence$<$ V, M $>$\-::name(), Q\-U\-E\-S\-O\-::\-File\-Ptr\-Set\-Struct\-::ofs\-Var, Q\-U\-E\-S\-O\-::\-Base\-Vector\-Sequence$<$ V, M $>$\-::set\-Name(), Q\-U\-E\-S\-O\-::\-Base\-Vector\-Sequence$<$ V, M $>$\-::sub\-Positions\-Of\-Maximum(), Q\-U\-E\-S\-O\-::\-Base\-Vector\-Sequence$<$ V, M $>$\-::sub\-Sequence\-Size(), Q\-U\-E\-S\-O\-::\-Sequence\-Of\-Vectors$<$ V, M $>$\-::sub\-Sequence\-Size(), Q\-U\-E\-S\-O\-::\-Base\-Vector\-Sequence$<$ V, M $>$\-::sub\-Write\-Contents(), Q\-U\-E\-S\-O\-::\-Scalar\-Sequence$<$ T $>$\-::sub\-Write\-Contents(), Q\-U\-E\-S\-O\-::\-Base\-Vector\-Sequence$<$ V, M $>$\-::unified\-Positions\-Of\-Maximum(), Q\-U\-E\-S\-O\-::\-Base\-Vector\-Sequence$<$ V, M $>$\-::unified\-Write\-Contents(), Q\-U\-E\-S\-O\-::\-Scalar\-Sequence$<$ T $>$\-::unified\-Write\-Contents(), U\-Q\-\_\-\-F\-A\-T\-A\-L\-\_\-\-R\-C\-\_\-\-M\-A\-C\-R\-O, U\-Q\-\_\-\-F\-A\-T\-A\-L\-\_\-\-T\-E\-S\-T\-\_\-\-M\-A\-C\-R\-O, U\-Q\-\_\-\-F\-I\-L\-E\-\_\-\-E\-X\-T\-E\-N\-S\-I\-O\-N\-\_\-\-F\-O\-R\-\_\-\-M\-A\-T\-L\-A\-B\-\_\-\-F\-O\-R\-M\-A\-T, U\-Q\-\_\-\-M\-H\-\_\-\-S\-G\-\_\-\-F\-I\-L\-E\-N\-A\-M\-E\-\_\-\-F\-O\-R\-\_\-\-N\-O\-\_\-\-F\-I\-L\-E, Q\-U\-E\-S\-O\-::\-U\-Q\-\_\-\-O\-K\-\_\-\-R\-C, and Q\-U\-E\-S\-O\-::\-Base\-Vector\-Sequence$<$ V, M $>$\-::vector\-Size\-Local().



Referenced by Q\-U\-E\-S\-O\-::\-M\-L\-Sampling$<$ P\-\_\-\-V, P\-\_\-\-M $>$\-::generate\-Bal\-Linked\-Chains\-\_\-all(), and Q\-U\-E\-S\-O\-::\-M\-L\-Sampling$<$ P\-\_\-\-V, P\-\_\-\-M $>$\-::generate\-Unb\-Linked\-Chains\-\_\-all().


\begin{DoxyCode}
815 \{
816   \textcolor{keywordflow}{if} ((\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_ac8ea061e55b920e0c8f9bce5c3f20e52}{m\_env}.\hyperlink{class_q_u_e_s_o_1_1_base_environment_a8a0064746ae8dddfece4229b9ad374d6}{subDisplayFile}()                   ) &&
817       (\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_ac8ea061e55b920e0c8f9bce5c3f20e52}{m\_env}.\hyperlink{class_q_u_e_s_o_1_1_base_environment_a1fe5f244fc0316a0ab3e37463f108b96}{displayVerbosity}() >= 5            ) &&
818       (\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_a5d0bc9f73d50d272aa6bfb5ef5939ef3}{m\_optionsObj}->\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_options_a9d4792d9fc2dc5439b8ab489b0c236eb}{m\_ov}.\hyperlink{class_q_u_e_s_o_1_1_mh_options_values_af812309e81191e88dfdc87c5815141a3}{m\_totallyMute} == \textcolor{keyword}{false})) \{
819     *\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_ac8ea061e55b920e0c8f9bce5c3f20e52}{m\_env}.\hyperlink{class_q_u_e_s_o_1_1_base_environment_a8a0064746ae8dddfece4229b9ad374d6}{subDisplayFile}() << \textcolor{stringliteral}{"Entering
       MetropolisHastingsSG<P\_V,P\_M>::generateSequence()..."}
820                             << std::endl;
821   \}
822 
823   \hyperlink{_defines_8h_a56d63d18d0a6d45757de47fcc06f574d}{UQ\_FATAL\_TEST\_MACRO}(\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_a2ef17fbfc6a156f03bbfad044b5a75f5}{m\_vectorSpace}.\hyperlink{class_q_u_e_s_o_1_1_vector_space_a5829a1f4f996f8307c840b705144d666}{dimLocal}() != workingChain.
      \hyperlink{class_q_u_e_s_o_1_1_base_vector_sequence_a2fefedf9e5b90f22881103b3f92555f6}{vectorSizeLocal}(),
824                       \hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_ac8ea061e55b920e0c8f9bce5c3f20e52}{m\_env}.\hyperlink{class_q_u_e_s_o_1_1_base_environment_a78b57112bbd0e6dd0e8afec00b40ffa7}{worldRank}(),
825                       \textcolor{stringliteral}{"MetropolisHastingsSG<P\_V,P\_M>::generateSequence()"},
826                       \textcolor{stringliteral}{"'m\_vectorSpace' and 'workingChain' are related to vector spaces of different
       dimensions"});
827 
828   \textcolor{comment}{//m\_env.syncPrintDebugMsg("Entering
       MetropolisHastingsSG<P\_V,P\_M>::generateSequence()",2,3000000,m\_env.fullComm());  // Dangerous to barrier on fullComm ... // KAUST}
829   MiscCheckTheParallelEnvironment<P\_V,P\_V>(\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_ae29f5d1198228858283d733021da2b14}{m\_initialPosition},
830                                              \hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_ae29f5d1198228858283d733021da2b14}{m\_initialPosition});
831 
832   P\_V valuesOf1stPosition(m\_initialPosition);
833   \textcolor{keywordtype}{int} iRC = \hyperlink{namespace_q_u_e_s_o_a8e909502900aecf24cedba022ea84471}{UQ\_OK\_RC};
834 
835   workingChain.\hyperlink{class_q_u_e_s_o_1_1_base_vector_sequence_a0a2f78cd12e0f136f7801f7d0175b849}{setName}(\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_a5d0bc9f73d50d272aa6bfb5ef5939ef3}{m\_optionsObj}->\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_options_a4f7c510aaa530336d24259e2a89f5d0b}{m\_prefix} + \textcolor{stringliteral}{"rawChain"});
836 
837   \textcolor{comment}{//****************************************************}
838   \textcolor{comment}{// Generate chain}
839   \textcolor{comment}{//****************************************************}
840   \textcolor{keywordflow}{if} (\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_a5d0bc9f73d50d272aa6bfb5ef5939ef3}{m\_optionsObj}->\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_options_a9d4792d9fc2dc5439b8ab489b0c236eb}{m\_ov}.\hyperlink{class_q_u_e_s_o_1_1_mh_options_values_a3d031c2cdc8f17c589e999d11782c8ba}{m\_rawChainDataInputFileName} == 
      \hyperlink{_metropolis_hastings_s_g_options_8h_a75699ceb938d800e2b7f59ede3ea9a31}{UQ\_MH\_SG\_FILENAME\_FOR\_NO\_FILE}) \{
841     \hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_af904814eb149a8fcc8ca346f2c254337}{generateFullChain}(valuesOf1stPosition,
842                       \hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_a5d0bc9f73d50d272aa6bfb5ef5939ef3}{m\_optionsObj}->\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_options_a9d4792d9fc2dc5439b8ab489b0c236eb}{m\_ov}.\hyperlink{class_q_u_e_s_o_1_1_mh_options_values_a18dcb5898ba7101ae11856e866742aaf}{m\_rawChainSize},
843                       workingChain,
844                       workingLogLikelihoodValues,
845                       workingLogTargetValues);
846   \}
847   \textcolor{keywordflow}{else} \{
848     \hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_ad1a6f23afa254985240949b8bbfb0c59}{readFullChain}(\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_a5d0bc9f73d50d272aa6bfb5ef5939ef3}{m\_optionsObj}->\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_options_a9d4792d9fc2dc5439b8ab489b0c236eb}{m\_ov}.
      \hyperlink{class_q_u_e_s_o_1_1_mh_options_values_a3d031c2cdc8f17c589e999d11782c8ba}{m\_rawChainDataInputFileName},
849                   \hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_a5d0bc9f73d50d272aa6bfb5ef5939ef3}{m\_optionsObj}->\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_options_a9d4792d9fc2dc5439b8ab489b0c236eb}{m\_ov}.\hyperlink{class_q_u_e_s_o_1_1_mh_options_values_a61974cb51a10d03dcd317dcd10f2684f}{m\_rawChainDataInputFileType}
      ,
850                   \hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_a5d0bc9f73d50d272aa6bfb5ef5939ef3}{m\_optionsObj}->\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_options_a9d4792d9fc2dc5439b8ab489b0c236eb}{m\_ov}.\hyperlink{class_q_u_e_s_o_1_1_mh_options_values_a18dcb5898ba7101ae11856e866742aaf}{m\_rawChainSize},
851                   workingChain);
852   \}
853 
854   \textcolor{comment}{//****************************************************}
855   \textcolor{comment}{// Open generic output file}
856   \textcolor{comment}{//****************************************************}
857   \textcolor{keywordflow}{if} ((\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_ac8ea061e55b920e0c8f9bce5c3f20e52}{m\_env}.\hyperlink{class_q_u_e_s_o_1_1_base_environment_a8a0064746ae8dddfece4229b9ad374d6}{subDisplayFile}()                   ) &&
858       (\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_a5d0bc9f73d50d272aa6bfb5ef5939ef3}{m\_optionsObj}->\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_options_a9d4792d9fc2dc5439b8ab489b0c236eb}{m\_ov}.\hyperlink{class_q_u_e_s_o_1_1_mh_options_values_af812309e81191e88dfdc87c5815141a3}{m\_totallyMute} == \textcolor{keyword}{false})) \{
859     *\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_ac8ea061e55b920e0c8f9bce5c3f20e52}{m\_env}.\hyperlink{class_q_u_e_s_o_1_1_base_environment_a8a0064746ae8dddfece4229b9ad374d6}{subDisplayFile}() << \textcolor{stringliteral}{"In MetropolisHastingsSG<P\_V,P\_M>::generateSequence()"}
860                             << \textcolor{stringliteral}{", prefix = "}                                         << 
      \hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_a5d0bc9f73d50d272aa6bfb5ef5939ef3}{m\_optionsObj}->\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_options_a4f7c510aaa530336d24259e2a89f5d0b}{m\_prefix}
861                             << \textcolor{stringliteral}{", chain name = "}                                     << workingChain.
      \hyperlink{class_q_u_e_s_o_1_1_base_vector_sequence_a48f6fe02cf77f4233d3bcdfef3870f19}{name}()
862                             << \textcolor{stringliteral}{": about to try to open generic output file '"}        << 
      \hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_a5d0bc9f73d50d272aa6bfb5ef5939ef3}{m\_optionsObj}->\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_options_a9d4792d9fc2dc5439b8ab489b0c236eb}{m\_ov}.\hyperlink{class_q_u_e_s_o_1_1_mh_options_values_a768664ee23ad3783751eca33eaeb14b9}{m\_dataOutputFileName}
863                             << \textcolor{stringliteral}{"."}                                                   << 
      \hyperlink{_defines_8h_ac440026eff7deb1c1eed1eea0e8e36ba}{UQ\_FILE\_EXTENSION\_FOR\_MATLAB\_FORMAT} \textcolor{comment}{// Yes, always ".m"}
864                             << \textcolor{stringliteral}{"', subId = "}                                         << 
      \hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_ac8ea061e55b920e0c8f9bce5c3f20e52}{m\_env}.\hyperlink{class_q_u_e_s_o_1_1_base_environment_a6ae3174897a9b3a4c85fa18da5d4c16f}{subId}()
865                             << \textcolor{stringliteral}{", subenv is allowed to write (1/true or 0/false) = "} << (
      \hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_a5d0bc9f73d50d272aa6bfb5ef5939ef3}{m\_optionsObj}->\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_options_a9d4792d9fc2dc5439b8ab489b0c236eb}{m\_ov}.\hyperlink{class_q_u_e_s_o_1_1_mh_options_values_ac3c9acb7a09d53c2ae4bd9088e99aa27}{m\_dataOutputAllowedSet}.find(
      \hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_ac8ea061e55b920e0c8f9bce5c3f20e52}{m\_env}.\hyperlink{class_q_u_e_s_o_1_1_base_environment_a6ae3174897a9b3a4c85fa18da5d4c16f}{subId}()) != \hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_a5d0bc9f73d50d272aa6bfb5ef5939ef3}{m\_optionsObj}->\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_options_a9d4792d9fc2dc5439b8ab489b0c236eb}{m\_ov}.
      \hyperlink{class_q_u_e_s_o_1_1_mh_options_values_ac3c9acb7a09d53c2ae4bd9088e99aa27}{m\_dataOutputAllowedSet}.end())
866                             << \textcolor{stringliteral}{"..."}
867                             << std::endl;
868   \}
869 
870   FilePtrSetStruct genericFilePtrSet;
871   \hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_ac8ea061e55b920e0c8f9bce5c3f20e52}{m\_env}.\hyperlink{class_q_u_e_s_o_1_1_base_environment_ab8fe853074f12ea34e18724119a2fc75}{openOutputFile}(\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_a5d0bc9f73d50d272aa6bfb5ef5939ef3}{m\_optionsObj}->\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_options_a9d4792d9fc2dc5439b8ab489b0c236eb}{m\_ov}.
      \hyperlink{class_q_u_e_s_o_1_1_mh_options_values_a768664ee23ad3783751eca33eaeb14b9}{m\_dataOutputFileName},
872                        \hyperlink{_defines_8h_ac440026eff7deb1c1eed1eea0e8e36ba}{UQ\_FILE\_EXTENSION\_FOR\_MATLAB\_FORMAT}, \textcolor{comment}{// Yes,
       always ".m"}
873                        \hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_a5d0bc9f73d50d272aa6bfb5ef5939ef3}{m\_optionsObj}->\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_options_a9d4792d9fc2dc5439b8ab489b0c236eb}{m\_ov}.\hyperlink{class_q_u_e_s_o_1_1_mh_options_values_ac3c9acb7a09d53c2ae4bd9088e99aa27}{m\_dataOutputAllowedSet},
874                        \textcolor{keyword}{false},
875                        genericFilePtrSet);
876 
877   \textcolor{keywordflow}{if} ((\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_ac8ea061e55b920e0c8f9bce5c3f20e52}{m\_env}.\hyperlink{class_q_u_e_s_o_1_1_base_environment_a8a0064746ae8dddfece4229b9ad374d6}{subDisplayFile}()                   ) &&
878       (\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_a5d0bc9f73d50d272aa6bfb5ef5939ef3}{m\_optionsObj}->\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_options_a9d4792d9fc2dc5439b8ab489b0c236eb}{m\_ov}.\hyperlink{class_q_u_e_s_o_1_1_mh_options_values_af812309e81191e88dfdc87c5815141a3}{m\_totallyMute} == \textcolor{keyword}{false})) \{
879     *\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_ac8ea061e55b920e0c8f9bce5c3f20e52}{m\_env}.\hyperlink{class_q_u_e_s_o_1_1_base_environment_a8a0064746ae8dddfece4229b9ad374d6}{subDisplayFile}() << \textcolor{stringliteral}{"In MetropolisHastingsSG<P\_V,P\_M>::generateSequence()"}
880                             << \textcolor{stringliteral}{", prefix = "}                                   << 
      \hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_a5d0bc9f73d50d272aa6bfb5ef5939ef3}{m\_optionsObj}->\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_options_a4f7c510aaa530336d24259e2a89f5d0b}{m\_prefix}
881                             << \textcolor{stringliteral}{", raw chain name = "}                           << workingChain.
      \hyperlink{class_q_u_e_s_o_1_1_base_vector_sequence_a48f6fe02cf77f4233d3bcdfef3870f19}{name}()
882                             << \textcolor{stringliteral}{": returned from opening generic output file '"} << 
      \hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_a5d0bc9f73d50d272aa6bfb5ef5939ef3}{m\_optionsObj}->\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_options_a9d4792d9fc2dc5439b8ab489b0c236eb}{m\_ov}.\hyperlink{class_q_u_e_s_o_1_1_mh_options_values_a768664ee23ad3783751eca33eaeb14b9}{m\_dataOutputFileName}
883                             << \textcolor{stringliteral}{"."}                                             << 
      \hyperlink{_defines_8h_ac440026eff7deb1c1eed1eea0e8e36ba}{UQ\_FILE\_EXTENSION\_FOR\_MATLAB\_FORMAT} \textcolor{comment}{// Yes, always ".m"}
884                             << \textcolor{stringliteral}{"', subId = "}                                   << 
      \hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_ac8ea061e55b920e0c8f9bce5c3f20e52}{m\_env}.\hyperlink{class_q_u_e_s_o_1_1_base_environment_a6ae3174897a9b3a4c85fa18da5d4c16f}{subId}()
885                             << std::endl;
886   \}
887 
888   \textcolor{comment}{//****************************************************************************************}
889   \textcolor{comment}{// Eventually:}
890   \textcolor{comment}{// --> write raw chain}
891   \textcolor{comment}{// --> compute statistics on it}
892   \textcolor{comment}{//****************************************************************************************}
893   \textcolor{keywordflow}{if} ((\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_a5d0bc9f73d50d272aa6bfb5ef5939ef3}{m\_optionsObj}->\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_options_a9d4792d9fc2dc5439b8ab489b0c236eb}{m\_ov}.\hyperlink{class_q_u_e_s_o_1_1_mh_options_values_a0ff310cdab62e1bdbff8663f8a6b1c77}{m\_rawChainDataOutputFileName} != 
      \hyperlink{_metropolis_hastings_s_g_options_8h_a75699ceb938d800e2b7f59ede3ea9a31}{UQ\_MH\_SG\_FILENAME\_FOR\_NO\_FILE}) &&
894       (\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_a5d0bc9f73d50d272aa6bfb5ef5939ef3}{m\_optionsObj}->\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_options_a9d4792d9fc2dc5439b8ab489b0c236eb}{m\_ov}.\hyperlink{class_q_u_e_s_o_1_1_mh_options_values_af812309e81191e88dfdc87c5815141a3}{m\_totallyMute} == \textcolor{keyword}{false}                              
               )) \{
895 
896     \textcolor{comment}{// Take "sub" care of raw chain}
897     \textcolor{keywordflow}{if} ((\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_ac8ea061e55b920e0c8f9bce5c3f20e52}{m\_env}.\hyperlink{class_q_u_e_s_o_1_1_base_environment_a8a0064746ae8dddfece4229b9ad374d6}{subDisplayFile}()                   ) &&
898         (\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_a5d0bc9f73d50d272aa6bfb5ef5939ef3}{m\_optionsObj}->\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_options_a9d4792d9fc2dc5439b8ab489b0c236eb}{m\_ov}.\hyperlink{class_q_u_e_s_o_1_1_mh_options_values_af812309e81191e88dfdc87c5815141a3}{m\_totallyMute} == \textcolor{keyword}{false})) \{
899       *\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_ac8ea061e55b920e0c8f9bce5c3f20e52}{m\_env}.\hyperlink{class_q_u_e_s_o_1_1_base_environment_a8a0064746ae8dddfece4229b9ad374d6}{subDisplayFile}() << \textcolor{stringliteral}{"In MetropolisHastingsSG<P\_V,P\_M>::generateSequence()"}
900                               << \textcolor{stringliteral}{", prefix = "}                                         << 
      \hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_a5d0bc9f73d50d272aa6bfb5ef5939ef3}{m\_optionsObj}->\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_options_a4f7c510aaa530336d24259e2a89f5d0b}{m\_prefix}
901                               << \textcolor{stringliteral}{", raw chain name = "}                                 << workingChain.
      \hyperlink{class_q_u_e_s_o_1_1_base_vector_sequence_a48f6fe02cf77f4233d3bcdfef3870f19}{name}()
902                               << \textcolor{stringliteral}{": about to try to write raw sub chain output file '"} << 
      \hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_a5d0bc9f73d50d272aa6bfb5ef5939ef3}{m\_optionsObj}->\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_options_a9d4792d9fc2dc5439b8ab489b0c236eb}{m\_ov}.\hyperlink{class_q_u_e_s_o_1_1_mh_options_values_a0ff310cdab62e1bdbff8663f8a6b1c77}{m\_rawChainDataOutputFileName}
903                               << \textcolor{stringliteral}{"."}                                                   << 
      \hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_a5d0bc9f73d50d272aa6bfb5ef5939ef3}{m\_optionsObj}->\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_options_a9d4792d9fc2dc5439b8ab489b0c236eb}{m\_ov}.\hyperlink{class_q_u_e_s_o_1_1_mh_options_values_ae435f8be38f9f6407a2e0f75c53b4e76}{m\_rawChainDataOutputFileType}
904                               << \textcolor{stringliteral}{"', subId = "}                                         << 
      \hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_ac8ea061e55b920e0c8f9bce5c3f20e52}{m\_env}.\hyperlink{class_q_u_e_s_o_1_1_base_environment_a6ae3174897a9b3a4c85fa18da5d4c16f}{subId}()
905                               << \textcolor{stringliteral}{", subenv is allowed to write  1/true or 0/false) = "} << (
      \hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_a5d0bc9f73d50d272aa6bfb5ef5939ef3}{m\_optionsObj}->\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_options_a9d4792d9fc2dc5439b8ab489b0c236eb}{m\_ov}.\hyperlink{class_q_u_e_s_o_1_1_mh_options_values_a99f722385d57bcb24542f3969c3764cd}{m\_rawChainDataOutputAllowedSet}.find(
      \hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_ac8ea061e55b920e0c8f9bce5c3f20e52}{m\_env}.\hyperlink{class_q_u_e_s_o_1_1_base_environment_a6ae3174897a9b3a4c85fa18da5d4c16f}{subId}()) != \hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_a5d0bc9f73d50d272aa6bfb5ef5939ef3}{m\_optionsObj}->\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_options_a9d4792d9fc2dc5439b8ab489b0c236eb}{m\_ov}.
      \hyperlink{class_q_u_e_s_o_1_1_mh_options_values_a99f722385d57bcb24542f3969c3764cd}{m\_rawChainDataOutputAllowedSet}.end())
906                               << \textcolor{stringliteral}{"..."}
907                               << std::endl;
908     \}
909 
910     \textcolor{keywordflow}{if} ((\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_a60695940f442f6568d10ee9e456032c7}{m\_numPositionsNotSubWritten}                     >  0  ) &&
911         (\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_a5d0bc9f73d50d272aa6bfb5ef5939ef3}{m\_optionsObj}->\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_options_a9d4792d9fc2dc5439b8ab489b0c236eb}{m\_ov}.\hyperlink{class_q_u_e_s_o_1_1_mh_options_values_a0ff310cdab62e1bdbff8663f8a6b1c77}{m\_rawChainDataOutputFileName} != \textcolor{stringliteral}{"."}
      )) \{
912       workingChain.\hyperlink{class_q_u_e_s_o_1_1_base_vector_sequence_aa59738c6df15b1b369b90f0d025fb6f2}{subWriteContents}(\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_a5d0bc9f73d50d272aa6bfb5ef5939ef3}{m\_optionsObj}->
      \hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_options_a9d4792d9fc2dc5439b8ab489b0c236eb}{m\_ov}.\hyperlink{class_q_u_e_s_o_1_1_mh_options_values_a18dcb5898ba7101ae11856e866742aaf}{m\_rawChainSize} - \hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_a60695940f442f6568d10ee9e456032c7}{m\_numPositionsNotSubWritten},
913                                     \hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_a60695940f442f6568d10ee9e456032c7}{m\_numPositionsNotSubWritten},
914                                     \hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_a5d0bc9f73d50d272aa6bfb5ef5939ef3}{m\_optionsObj}->\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_options_a9d4792d9fc2dc5439b8ab489b0c236eb}{m\_ov}.
      \hyperlink{class_q_u_e_s_o_1_1_mh_options_values_a0ff310cdab62e1bdbff8663f8a6b1c77}{m\_rawChainDataOutputFileName},
915                                     \hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_a5d0bc9f73d50d272aa6bfb5ef5939ef3}{m\_optionsObj}->\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_options_a9d4792d9fc2dc5439b8ab489b0c236eb}{m\_ov}.
      \hyperlink{class_q_u_e_s_o_1_1_mh_options_values_ae435f8be38f9f6407a2e0f75c53b4e76}{m\_rawChainDataOutputFileType},
916                                     \hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_a5d0bc9f73d50d272aa6bfb5ef5939ef3}{m\_optionsObj}->\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_options_a9d4792d9fc2dc5439b8ab489b0c236eb}{m\_ov}.
      \hyperlink{class_q_u_e_s_o_1_1_mh_options_values_a99f722385d57bcb24542f3969c3764cd}{m\_rawChainDataOutputAllowedSet});
917       \textcolor{keywordflow}{if} ((\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_ac8ea061e55b920e0c8f9bce5c3f20e52}{m\_env}.\hyperlink{class_q_u_e_s_o_1_1_base_environment_a8a0064746ae8dddfece4229b9ad374d6}{subDisplayFile}()                   ) &&
918           (\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_a5d0bc9f73d50d272aa6bfb5ef5939ef3}{m\_optionsObj}->\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_options_a9d4792d9fc2dc5439b8ab489b0c236eb}{m\_ov}.\hyperlink{class_q_u_e_s_o_1_1_mh_options_values_af812309e81191e88dfdc87c5815141a3}{m\_totallyMute} == \textcolor{keyword}{false})) \{
919         *\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_ac8ea061e55b920e0c8f9bce5c3f20e52}{m\_env}.\hyperlink{class_q_u_e_s_o_1_1_base_environment_a8a0064746ae8dddfece4229b9ad374d6}{subDisplayFile}() << \textcolor{stringliteral}{"In MetropolisHastingsSG<P\_V,P\_M>::generateSequence()
      "}
920                                 << \textcolor{stringliteral}{": just wrote (per period request) remaining "} << 
      \hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_a60695940f442f6568d10ee9e456032c7}{m\_numPositionsNotSubWritten} << \textcolor{stringliteral}{" chain positions "}
921                                 << \textcolor{stringliteral}{", "} << \hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_a5d0bc9f73d50d272aa6bfb5ef5939ef3}{m\_optionsObj}->\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_options_a9d4792d9fc2dc5439b8ab489b0c236eb}{m\_ov}.
      \hyperlink{class_q_u_e_s_o_1_1_mh_options_values_a18dcb5898ba7101ae11856e866742aaf}{m\_rawChainSize} - \hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_a60695940f442f6568d10ee9e456032c7}{m\_numPositionsNotSubWritten} << \textcolor{stringliteral}{" <= pos <= "} << 
      \hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_a5d0bc9f73d50d272aa6bfb5ef5939ef3}{m\_optionsObj}->\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_options_a9d4792d9fc2dc5439b8ab489b0c236eb}{m\_ov}.\hyperlink{class_q_u_e_s_o_1_1_mh_options_values_a18dcb5898ba7101ae11856e866742aaf}{m\_rawChainSize} - 1
922                                 << std::endl;
923       \}
924 
925       \textcolor{keywordflow}{if} (workingLogLikelihoodValues) \{
926         workingLogLikelihoodValues->\hyperlink{class_q_u_e_s_o_1_1_scalar_sequence_aa162c8bbca4e0dedca894828c57e1fa7}{subWriteContents}(
      \hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_a5d0bc9f73d50d272aa6bfb5ef5939ef3}{m\_optionsObj}->\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_options_a9d4792d9fc2dc5439b8ab489b0c236eb}{m\_ov}.\hyperlink{class_q_u_e_s_o_1_1_mh_options_values_a18dcb5898ba7101ae11856e866742aaf}{m\_rawChainSize} - 
      \hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_a60695940f442f6568d10ee9e456032c7}{m\_numPositionsNotSubWritten},
927                                                      \hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_a60695940f442f6568d10ee9e456032c7}{m\_numPositionsNotSubWritten}
      ,
928                                                      \hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_a5d0bc9f73d50d272aa6bfb5ef5939ef3}{m\_optionsObj}->
      \hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_options_a9d4792d9fc2dc5439b8ab489b0c236eb}{m\_ov}.\hyperlink{class_q_u_e_s_o_1_1_mh_options_values_a0ff310cdab62e1bdbff8663f8a6b1c77}{m\_rawChainDataOutputFileName} + \textcolor{stringliteral}{"\_likelihood"},
929                                                      \hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_a5d0bc9f73d50d272aa6bfb5ef5939ef3}{m\_optionsObj}->
      \hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_options_a9d4792d9fc2dc5439b8ab489b0c236eb}{m\_ov}.\hyperlink{class_q_u_e_s_o_1_1_mh_options_values_ae435f8be38f9f6407a2e0f75c53b4e76}{m\_rawChainDataOutputFileType},
930                                                      \hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_a5d0bc9f73d50d272aa6bfb5ef5939ef3}{m\_optionsObj}->
      \hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_options_a9d4792d9fc2dc5439b8ab489b0c236eb}{m\_ov}.\hyperlink{class_q_u_e_s_o_1_1_mh_options_values_a99f722385d57bcb24542f3969c3764cd}{m\_rawChainDataOutputAllowedSet});
931       \}
932 
933       \textcolor{keywordflow}{if} (workingLogTargetValues) \{
934         workingLogTargetValues->\hyperlink{class_q_u_e_s_o_1_1_scalar_sequence_aa162c8bbca4e0dedca894828c57e1fa7}{subWriteContents}(\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_a5d0bc9f73d50d272aa6bfb5ef5939ef3}{m\_optionsObj}->
      \hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_options_a9d4792d9fc2dc5439b8ab489b0c236eb}{m\_ov}.\hyperlink{class_q_u_e_s_o_1_1_mh_options_values_a18dcb5898ba7101ae11856e866742aaf}{m\_rawChainSize} - \hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_a60695940f442f6568d10ee9e456032c7}{m\_numPositionsNotSubWritten},
935                                                  \hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_a60695940f442f6568d10ee9e456032c7}{m\_numPositionsNotSubWritten},
936                                                  \hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_a5d0bc9f73d50d272aa6bfb5ef5939ef3}{m\_optionsObj}->\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_options_a9d4792d9fc2dc5439b8ab489b0c236eb}{m\_ov}.
      \hyperlink{class_q_u_e_s_o_1_1_mh_options_values_a0ff310cdab62e1bdbff8663f8a6b1c77}{m\_rawChainDataOutputFileName} + \textcolor{stringliteral}{"\_target"},
937                                                  \hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_a5d0bc9f73d50d272aa6bfb5ef5939ef3}{m\_optionsObj}->\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_options_a9d4792d9fc2dc5439b8ab489b0c236eb}{m\_ov}.
      \hyperlink{class_q_u_e_s_o_1_1_mh_options_values_ae435f8be38f9f6407a2e0f75c53b4e76}{m\_rawChainDataOutputFileType},
938                                                  \hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_a5d0bc9f73d50d272aa6bfb5ef5939ef3}{m\_optionsObj}->\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_options_a9d4792d9fc2dc5439b8ab489b0c236eb}{m\_ov}.
      \hyperlink{class_q_u_e_s_o_1_1_mh_options_values_a99f722385d57bcb24542f3969c3764cd}{m\_rawChainDataOutputAllowedSet});
939       \}
940 
941       \hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_a60695940f442f6568d10ee9e456032c7}{m\_numPositionsNotSubWritten} = 0;
942     \}
943 
944     \textcolor{comment}{// Compute raw sub MLE}
945     \textcolor{keywordflow}{if} (workingLogLikelihoodValues) \{
946       SequenceOfVectors<P\_V,P\_M> rawSubMLEpositions(\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_a2ef17fbfc6a156f03bbfad044b5a75f5}{m\_vectorSpace},0,
      \hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_a5d0bc9f73d50d272aa6bfb5ef5939ef3}{m\_optionsObj}->\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_options_a4f7c510aaa530336d24259e2a89f5d0b}{m\_prefix}+\textcolor{stringliteral}{"rawSubMLEseq"});
947       \textcolor{keywordtype}{double} rawSubMLEvalue = workingChain.\hyperlink{class_q_u_e_s_o_1_1_base_vector_sequence_a971e9e1a87e4eb47b4910348a6b437d5}{subPositionsOfMaximum}(*
      workingLogLikelihoodValues,
948                                                                  rawSubMLEpositions);
949       \hyperlink{_defines_8h_a56d63d18d0a6d45757de47fcc06f574d}{UQ\_FATAL\_TEST\_MACRO}(rawSubMLEpositions.subSequenceSize() == 0,
950                           \hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_ac8ea061e55b920e0c8f9bce5c3f20e52}{m\_env}.\hyperlink{class_q_u_e_s_o_1_1_base_environment_a78b57112bbd0e6dd0e8afec00b40ffa7}{worldRank}(),
951                           \textcolor{stringliteral}{"MetropolisHastingsSG<P\_V,P\_M>::generateSequence()"},
952                           \textcolor{stringliteral}{"rawSubMLEpositions.subSequenceSize() = 0"});
953 
954       \textcolor{keywordflow}{if} ((\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_ac8ea061e55b920e0c8f9bce5c3f20e52}{m\_env}.\hyperlink{class_q_u_e_s_o_1_1_base_environment_a8a0064746ae8dddfece4229b9ad374d6}{subDisplayFile}()                   ) &&
955           (\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_a5d0bc9f73d50d272aa6bfb5ef5939ef3}{m\_optionsObj}->\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_options_a9d4792d9fc2dc5439b8ab489b0c236eb}{m\_ov}.\hyperlink{class_q_u_e_s_o_1_1_mh_options_values_af812309e81191e88dfdc87c5815141a3}{m\_totallyMute} == \textcolor{keyword}{false})) \{
956         P\_V tmpVec(\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_a2ef17fbfc6a156f03bbfad044b5a75f5}{m\_vectorSpace}.\hyperlink{class_q_u_e_s_o_1_1_vector_space_a92e963bb5cab3eecd290dfe4b8f03b04}{zeroVector}());
957         rawSubMLEpositions.getPositionValues(0,tmpVec);
958         *\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_ac8ea061e55b920e0c8f9bce5c3f20e52}{m\_env}.\hyperlink{class_q_u_e_s_o_1_1_base_environment_a8a0064746ae8dddfece4229b9ad374d6}{subDisplayFile}() << \textcolor{stringliteral}{"In MetropolisHastingsSG<P\_V,P\_M>::generateSequence()
      "}
959                                 << \textcolor{stringliteral}{": just computed MLE"}
960                                 << \textcolor{stringliteral}{", rawSubMLEvalue = "}                       << rawSubMLEvalue
961                                 << \textcolor{stringliteral}{", rawSubMLEpositions.subSequenceSize() = "} << rawSubMLEpositions.
      subSequenceSize()
962                                 << \textcolor{stringliteral}{", rawSubMLEpositions[0] = "}                << tmpVec
963                                 << std::endl;
964       \}
965     \}
966 
967     \textcolor{comment}{// Compute raw sub MAP}
968     \textcolor{keywordflow}{if} (workingLogTargetValues) \{
969       SequenceOfVectors<P\_V,P\_M> rawSubMAPpositions(\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_a2ef17fbfc6a156f03bbfad044b5a75f5}{m\_vectorSpace},0,
      \hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_a5d0bc9f73d50d272aa6bfb5ef5939ef3}{m\_optionsObj}->\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_options_a4f7c510aaa530336d24259e2a89f5d0b}{m\_prefix}+\textcolor{stringliteral}{"rawSubMAPseq"});
970       \textcolor{keywordtype}{double} rawSubMAPvalue = workingChain.\hyperlink{class_q_u_e_s_o_1_1_base_vector_sequence_a971e9e1a87e4eb47b4910348a6b437d5}{subPositionsOfMaximum}(*
      workingLogTargetValues,
971                                                                  rawSubMAPpositions);
972       \hyperlink{_defines_8h_a56d63d18d0a6d45757de47fcc06f574d}{UQ\_FATAL\_TEST\_MACRO}(rawSubMAPpositions.subSequenceSize() == 0,
973                           \hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_ac8ea061e55b920e0c8f9bce5c3f20e52}{m\_env}.\hyperlink{class_q_u_e_s_o_1_1_base_environment_a78b57112bbd0e6dd0e8afec00b40ffa7}{worldRank}(),
974                           \textcolor{stringliteral}{"MetropolisHastingsSG<P\_V,P\_M>::generateSequence()"},
975                           \textcolor{stringliteral}{"rawSubMAPpositions.subSequenceSize() = 0"});
976 
977       \textcolor{keywordflow}{if} ((\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_ac8ea061e55b920e0c8f9bce5c3f20e52}{m\_env}.\hyperlink{class_q_u_e_s_o_1_1_base_environment_a8a0064746ae8dddfece4229b9ad374d6}{subDisplayFile}()                   ) &&
978           (\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_a5d0bc9f73d50d272aa6bfb5ef5939ef3}{m\_optionsObj}->\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_options_a9d4792d9fc2dc5439b8ab489b0c236eb}{m\_ov}.\hyperlink{class_q_u_e_s_o_1_1_mh_options_values_af812309e81191e88dfdc87c5815141a3}{m\_totallyMute} == \textcolor{keyword}{false})) \{
979         P\_V tmpVec(\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_a2ef17fbfc6a156f03bbfad044b5a75f5}{m\_vectorSpace}.\hyperlink{class_q_u_e_s_o_1_1_vector_space_a92e963bb5cab3eecd290dfe4b8f03b04}{zeroVector}());
980         rawSubMAPpositions.getPositionValues(0,tmpVec);
981         *\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_ac8ea061e55b920e0c8f9bce5c3f20e52}{m\_env}.\hyperlink{class_q_u_e_s_o_1_1_base_environment_a8a0064746ae8dddfece4229b9ad374d6}{subDisplayFile}() << \textcolor{stringliteral}{"In MetropolisHastingsSG<P\_V,P\_M>::generateSequence()
      "}
982                                 << \textcolor{stringliteral}{": just computed MAP"}
983                                 << \textcolor{stringliteral}{", rawSubMAPvalue = "}                       << rawSubMAPvalue
984                                 << \textcolor{stringliteral}{", rawSubMAPpositions.subSequenceSize() = "} << rawSubMAPpositions.
      subSequenceSize()
985                                 << \textcolor{stringliteral}{", rawSubMAPpositions[0] = "}                << tmpVec
986                                 << std::endl;
987       \}
988     \}
989 
990     \textcolor{keywordflow}{if} ((\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_ac8ea061e55b920e0c8f9bce5c3f20e52}{m\_env}.\hyperlink{class_q_u_e_s_o_1_1_base_environment_a8a0064746ae8dddfece4229b9ad374d6}{subDisplayFile}()                   ) &&
991         (\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_a5d0bc9f73d50d272aa6bfb5ef5939ef3}{m\_optionsObj}->\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_options_a9d4792d9fc2dc5439b8ab489b0c236eb}{m\_ov}.\hyperlink{class_q_u_e_s_o_1_1_mh_options_values_af812309e81191e88dfdc87c5815141a3}{m\_totallyMute} == \textcolor{keyword}{false})) \{
992       *\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_ac8ea061e55b920e0c8f9bce5c3f20e52}{m\_env}.\hyperlink{class_q_u_e_s_o_1_1_base_environment_a8a0064746ae8dddfece4229b9ad374d6}{subDisplayFile}() << \textcolor{stringliteral}{"In MetropolisHastingsSG<P\_V,P\_M>::generateSequence()"}
993                               << \textcolor{stringliteral}{", prefix = "}                                         << 
      \hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_a5d0bc9f73d50d272aa6bfb5ef5939ef3}{m\_optionsObj}->\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_options_a4f7c510aaa530336d24259e2a89f5d0b}{m\_prefix}
994                               << \textcolor{stringliteral}{", raw chain name = "}                                 << workingChain.
      \hyperlink{class_q_u_e_s_o_1_1_base_vector_sequence_a48f6fe02cf77f4233d3bcdfef3870f19}{name}()
995                               << \textcolor{stringliteral}{": returned from writing raw sub chain output file '"} << 
      \hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_a5d0bc9f73d50d272aa6bfb5ef5939ef3}{m\_optionsObj}->\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_options_a9d4792d9fc2dc5439b8ab489b0c236eb}{m\_ov}.\hyperlink{class_q_u_e_s_o_1_1_mh_options_values_a0ff310cdab62e1bdbff8663f8a6b1c77}{m\_rawChainDataOutputFileName}
996                               << \textcolor{stringliteral}{"."}                                                   << 
      \hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_a5d0bc9f73d50d272aa6bfb5ef5939ef3}{m\_optionsObj}->\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_options_a9d4792d9fc2dc5439b8ab489b0c236eb}{m\_ov}.\hyperlink{class_q_u_e_s_o_1_1_mh_options_values_ae435f8be38f9f6407a2e0f75c53b4e76}{m\_rawChainDataOutputFileType}
997                               << \textcolor{stringliteral}{"', subId = "}                                         << 
      \hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_ac8ea061e55b920e0c8f9bce5c3f20e52}{m\_env}.\hyperlink{class_q_u_e_s_o_1_1_base_environment_a6ae3174897a9b3a4c85fa18da5d4c16f}{subId}()
998                               << std::endl;
999     \}
1000 
1001     \textcolor{comment}{// Take "unified" care of raw chain}
1002     \textcolor{keywordflow}{if} ((\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_ac8ea061e55b920e0c8f9bce5c3f20e52}{m\_env}.\hyperlink{class_q_u_e_s_o_1_1_base_environment_a8a0064746ae8dddfece4229b9ad374d6}{subDisplayFile}()                   ) &&
1003         (\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_a5d0bc9f73d50d272aa6bfb5ef5939ef3}{m\_optionsObj}->\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_options_a9d4792d9fc2dc5439b8ab489b0c236eb}{m\_ov}.\hyperlink{class_q_u_e_s_o_1_1_mh_options_values_af812309e81191e88dfdc87c5815141a3}{m\_totallyMute} == \textcolor{keyword}{false})) \{
1004       *\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_ac8ea061e55b920e0c8f9bce5c3f20e52}{m\_env}.\hyperlink{class_q_u_e_s_o_1_1_base_environment_a8a0064746ae8dddfece4229b9ad374d6}{subDisplayFile}() << \textcolor{stringliteral}{"In MetropolisHastingsSG<P\_V,P\_M>::generateSequence()"}
1005                               << \textcolor{stringliteral}{", prefix = "}                                             << 
      \hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_a5d0bc9f73d50d272aa6bfb5ef5939ef3}{m\_optionsObj}->\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_options_a4f7c510aaa530336d24259e2a89f5d0b}{m\_prefix}
1006                               << \textcolor{stringliteral}{", raw chain name = "}                                     << workingChain.
      \hyperlink{class_q_u_e_s_o_1_1_base_vector_sequence_a48f6fe02cf77f4233d3bcdfef3870f19}{name}()
1007                               << \textcolor{stringliteral}{": about to try to write raw unified chain output file '"} << 
      \hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_a5d0bc9f73d50d272aa6bfb5ef5939ef3}{m\_optionsObj}->\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_options_a9d4792d9fc2dc5439b8ab489b0c236eb}{m\_ov}.\hyperlink{class_q_u_e_s_o_1_1_mh_options_values_a0ff310cdab62e1bdbff8663f8a6b1c77}{m\_rawChainDataOutputFileName}
1008                               << \textcolor{stringliteral}{"."}                                                       << 
      \hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_a5d0bc9f73d50d272aa6bfb5ef5939ef3}{m\_optionsObj}->\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_options_a9d4792d9fc2dc5439b8ab489b0c236eb}{m\_ov}.\hyperlink{class_q_u_e_s_o_1_1_mh_options_values_ae435f8be38f9f6407a2e0f75c53b4e76}{m\_rawChainDataOutputFileType}
1009                               << \textcolor{stringliteral}{"', subId = "}                                             << 
      \hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_ac8ea061e55b920e0c8f9bce5c3f20e52}{m\_env}.\hyperlink{class_q_u_e_s_o_1_1_base_environment_a6ae3174897a9b3a4c85fa18da5d4c16f}{subId}()
1010                               << \textcolor{stringliteral}{"..."}
1011                               << std::endl;
1012     \}
1013 
1014     workingChain.\hyperlink{class_q_u_e_s_o_1_1_base_vector_sequence_a3987ee6d026842e4ddaeaf0bc850ef83}{unifiedWriteContents}(\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_a5d0bc9f73d50d272aa6bfb5ef5939ef3}{m\_optionsObj}->
      \hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_options_a9d4792d9fc2dc5439b8ab489b0c236eb}{m\_ov}.\hyperlink{class_q_u_e_s_o_1_1_mh_options_values_a0ff310cdab62e1bdbff8663f8a6b1c77}{m\_rawChainDataOutputFileName},
1015                                       \hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_a5d0bc9f73d50d272aa6bfb5ef5939ef3}{m\_optionsObj}->\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_options_a9d4792d9fc2dc5439b8ab489b0c236eb}{m\_ov}.
      \hyperlink{class_q_u_e_s_o_1_1_mh_options_values_ae435f8be38f9f6407a2e0f75c53b4e76}{m\_rawChainDataOutputFileType});
1016     \textcolor{keywordflow}{if} ((\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_ac8ea061e55b920e0c8f9bce5c3f20e52}{m\_env}.\hyperlink{class_q_u_e_s_o_1_1_base_environment_a8a0064746ae8dddfece4229b9ad374d6}{subDisplayFile}()                   ) &&
1017         (\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_a5d0bc9f73d50d272aa6bfb5ef5939ef3}{m\_optionsObj}->\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_options_a9d4792d9fc2dc5439b8ab489b0c236eb}{m\_ov}.\hyperlink{class_q_u_e_s_o_1_1_mh_options_values_af812309e81191e88dfdc87c5815141a3}{m\_totallyMute} == \textcolor{keyword}{false})) \{
1018       *\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_ac8ea061e55b920e0c8f9bce5c3f20e52}{m\_env}.\hyperlink{class_q_u_e_s_o_1_1_base_environment_a8a0064746ae8dddfece4229b9ad374d6}{subDisplayFile}() << \textcolor{stringliteral}{"In MetropolisHastingsSG<P\_V,P\_M>::generateSequence()"}
1019                               << \textcolor{stringliteral}{", prefix = "}                                             << 
      \hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_a5d0bc9f73d50d272aa6bfb5ef5939ef3}{m\_optionsObj}->\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_options_a4f7c510aaa530336d24259e2a89f5d0b}{m\_prefix}
1020                               << \textcolor{stringliteral}{", raw chain name = "}                                     << workingChain.
      \hyperlink{class_q_u_e_s_o_1_1_base_vector_sequence_a48f6fe02cf77f4233d3bcdfef3870f19}{name}()
1021                               << \textcolor{stringliteral}{": returned from writing raw unified chain output file '"} << 
      \hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_a5d0bc9f73d50d272aa6bfb5ef5939ef3}{m\_optionsObj}->\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_options_a9d4792d9fc2dc5439b8ab489b0c236eb}{m\_ov}.\hyperlink{class_q_u_e_s_o_1_1_mh_options_values_a0ff310cdab62e1bdbff8663f8a6b1c77}{m\_rawChainDataOutputFileName}
1022                               << \textcolor{stringliteral}{"."}                                                       << 
      \hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_a5d0bc9f73d50d272aa6bfb5ef5939ef3}{m\_optionsObj}->\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_options_a9d4792d9fc2dc5439b8ab489b0c236eb}{m\_ov}.\hyperlink{class_q_u_e_s_o_1_1_mh_options_values_ae435f8be38f9f6407a2e0f75c53b4e76}{m\_rawChainDataOutputFileType}
1023                               << \textcolor{stringliteral}{"', subId = "}                                             << 
      \hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_ac8ea061e55b920e0c8f9bce5c3f20e52}{m\_env}.\hyperlink{class_q_u_e_s_o_1_1_base_environment_a6ae3174897a9b3a4c85fa18da5d4c16f}{subId}()
1024                               << std::endl;
1025     \}
1026 
1027     \textcolor{keywordflow}{if} (workingLogLikelihoodValues) \{
1028       workingLogLikelihoodValues->\hyperlink{class_q_u_e_s_o_1_1_scalar_sequence_a2f832dd5eda37df06eb52650ab8ce733}{unifiedWriteContents}(
      \hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_a5d0bc9f73d50d272aa6bfb5ef5939ef3}{m\_optionsObj}->\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_options_a9d4792d9fc2dc5439b8ab489b0c236eb}{m\_ov}.\hyperlink{class_q_u_e_s_o_1_1_mh_options_values_a0ff310cdab62e1bdbff8663f8a6b1c77}{m\_rawChainDataOutputFileName} + \textcolor{stringliteral}{"\_likelihood"}
      ,
1029                                                        \hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_a5d0bc9f73d50d272aa6bfb5ef5939ef3}{m\_optionsObj}->
      \hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_options_a9d4792d9fc2dc5439b8ab489b0c236eb}{m\_ov}.\hyperlink{class_q_u_e_s_o_1_1_mh_options_values_ae435f8be38f9f6407a2e0f75c53b4e76}{m\_rawChainDataOutputFileType});
1030     \}
1031 
1032     \textcolor{keywordflow}{if} (workingLogTargetValues) \{
1033       workingLogTargetValues->\hyperlink{class_q_u_e_s_o_1_1_scalar_sequence_a2f832dd5eda37df06eb52650ab8ce733}{unifiedWriteContents}(
      \hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_a5d0bc9f73d50d272aa6bfb5ef5939ef3}{m\_optionsObj}->\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_options_a9d4792d9fc2dc5439b8ab489b0c236eb}{m\_ov}.\hyperlink{class_q_u_e_s_o_1_1_mh_options_values_a0ff310cdab62e1bdbff8663f8a6b1c77}{m\_rawChainDataOutputFileName} + \textcolor{stringliteral}{"\_target"},
1034                                                    \hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_a5d0bc9f73d50d272aa6bfb5ef5939ef3}{m\_optionsObj}->
      \hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_options_a9d4792d9fc2dc5439b8ab489b0c236eb}{m\_ov}.\hyperlink{class_q_u_e_s_o_1_1_mh_options_values_ae435f8be38f9f6407a2e0f75c53b4e76}{m\_rawChainDataOutputFileType});
1035     \}
1036 
1037     \textcolor{comment}{// Compute raw unified MLE}
1038     \textcolor{keywordflow}{if} (workingLogLikelihoodValues) \{
1039       SequenceOfVectors<P\_V,P\_M> rawUnifiedMLEpositions(\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_a2ef17fbfc6a156f03bbfad044b5a75f5}{m\_vectorSpace},0,
      \hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_a5d0bc9f73d50d272aa6bfb5ef5939ef3}{m\_optionsObj}->\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_options_a4f7c510aaa530336d24259e2a89f5d0b}{m\_prefix}+\textcolor{stringliteral}{"rawUnifiedMLEseq"});
1040       \textcolor{keywordtype}{double} rawUnifiedMLEvalue = workingChain.\hyperlink{class_q_u_e_s_o_1_1_base_vector_sequence_a4269482101b2bcdb1975543f8191ab4c}{unifiedPositionsOfMaximum}(*
      workingLogLikelihoodValues,
1041                                                                          rawUnifiedMLEpositions);
1042       \hyperlink{_defines_8h_a56d63d18d0a6d45757de47fcc06f574d}{UQ\_FATAL\_TEST\_MACRO}(rawUnifiedMLEpositions.subSequenceSize() == 0,
1043                           \hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_ac8ea061e55b920e0c8f9bce5c3f20e52}{m\_env}.\hyperlink{class_q_u_e_s_o_1_1_base_environment_a78b57112bbd0e6dd0e8afec00b40ffa7}{worldRank}(),
1044                           \textcolor{stringliteral}{"MetropolisHastingsSG<P\_V,P\_M>::generateSequence()"},
1045                           \textcolor{stringliteral}{"rawUnifiedMLEpositions.subSequenceSize() = 0"});
1046 
1047       \textcolor{keywordflow}{if} ((\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_ac8ea061e55b920e0c8f9bce5c3f20e52}{m\_env}.\hyperlink{class_q_u_e_s_o_1_1_base_environment_a8a0064746ae8dddfece4229b9ad374d6}{subDisplayFile}()                   ) &&
1048           (\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_a5d0bc9f73d50d272aa6bfb5ef5939ef3}{m\_optionsObj}->\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_options_a9d4792d9fc2dc5439b8ab489b0c236eb}{m\_ov}.\hyperlink{class_q_u_e_s_o_1_1_mh_options_values_af812309e81191e88dfdc87c5815141a3}{m\_totallyMute} == \textcolor{keyword}{false})) \{
1049         P\_V tmpVec(\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_a2ef17fbfc6a156f03bbfad044b5a75f5}{m\_vectorSpace}.\hyperlink{class_q_u_e_s_o_1_1_vector_space_a92e963bb5cab3eecd290dfe4b8f03b04}{zeroVector}());
1050         rawUnifiedMLEpositions.getPositionValues(0,tmpVec);
1051         *\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_ac8ea061e55b920e0c8f9bce5c3f20e52}{m\_env}.\hyperlink{class_q_u_e_s_o_1_1_base_environment_a8a0064746ae8dddfece4229b9ad374d6}{subDisplayFile}() << \textcolor{stringliteral}{"In MetropolisHastingsSG<P\_V,P\_M>::generateSequence()
      "}
1052                                 << \textcolor{stringliteral}{": just computed MLE"}
1053                                 << \textcolor{stringliteral}{", rawUnifiedMLEvalue = "}                       << rawUnifiedMLEvalue
1054                                 << \textcolor{stringliteral}{", rawUnifiedMLEpositions.subSequenceSize() = "} << 
      rawUnifiedMLEpositions.subSequenceSize()
1055                                 << \textcolor{stringliteral}{", rawUnifiedMLEpositions[0] = "}                << tmpVec
1056                                 << std::endl;
1057       \}
1058     \}
1059 
1060     \textcolor{comment}{// Compute raw unified MAP}
1061     \textcolor{keywordflow}{if} (workingLogTargetValues) \{
1062       SequenceOfVectors<P\_V,P\_M> rawUnifiedMAPpositions(\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_a2ef17fbfc6a156f03bbfad044b5a75f5}{m\_vectorSpace},0,
      \hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_a5d0bc9f73d50d272aa6bfb5ef5939ef3}{m\_optionsObj}->\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_options_a4f7c510aaa530336d24259e2a89f5d0b}{m\_prefix}+\textcolor{stringliteral}{"rawUnifiedMAPseq"});
1063       \textcolor{keywordtype}{double} rawUnifiedMAPvalue = workingChain.\hyperlink{class_q_u_e_s_o_1_1_base_vector_sequence_a4269482101b2bcdb1975543f8191ab4c}{unifiedPositionsOfMaximum}(*
      workingLogTargetValues,
1064                                                                          rawUnifiedMAPpositions);
1065 
1066       \hyperlink{_defines_8h_a56d63d18d0a6d45757de47fcc06f574d}{UQ\_FATAL\_TEST\_MACRO}(rawUnifiedMAPpositions.subSequenceSize() == 0,
1067                           \hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_ac8ea061e55b920e0c8f9bce5c3f20e52}{m\_env}.\hyperlink{class_q_u_e_s_o_1_1_base_environment_a78b57112bbd0e6dd0e8afec00b40ffa7}{worldRank}(),
1068                           \textcolor{stringliteral}{"MetropolisHastingsSG<P\_V,P\_M>::generateSequence()"},
1069                           \textcolor{stringliteral}{"rawUnifiedMAPpositions.subSequenceSize() = 0"});
1070 
1071       \textcolor{keywordflow}{if} ((\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_ac8ea061e55b920e0c8f9bce5c3f20e52}{m\_env}.\hyperlink{class_q_u_e_s_o_1_1_base_environment_a8a0064746ae8dddfece4229b9ad374d6}{subDisplayFile}()                   ) &&
1072           (\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_a5d0bc9f73d50d272aa6bfb5ef5939ef3}{m\_optionsObj}->\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_options_a9d4792d9fc2dc5439b8ab489b0c236eb}{m\_ov}.\hyperlink{class_q_u_e_s_o_1_1_mh_options_values_af812309e81191e88dfdc87c5815141a3}{m\_totallyMute} == \textcolor{keyword}{false})) \{
1073         P\_V tmpVec(\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_a2ef17fbfc6a156f03bbfad044b5a75f5}{m\_vectorSpace}.\hyperlink{class_q_u_e_s_o_1_1_vector_space_a92e963bb5cab3eecd290dfe4b8f03b04}{zeroVector}());
1074         rawUnifiedMAPpositions.getPositionValues(0,tmpVec);
1075         *\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_ac8ea061e55b920e0c8f9bce5c3f20e52}{m\_env}.\hyperlink{class_q_u_e_s_o_1_1_base_environment_a8a0064746ae8dddfece4229b9ad374d6}{subDisplayFile}() << \textcolor{stringliteral}{"In MetropolisHastingsSG<P\_V,P\_M>::generateSequence()
      "}
1076                                 << \textcolor{stringliteral}{": just computed MAP"}
1077                                 << \textcolor{stringliteral}{", rawUnifiedMAPvalue = "}                       << rawUnifiedMAPvalue
1078                                 << \textcolor{stringliteral}{", rawUnifiedMAPpositions.subSequenceSize() = "} << 
      rawUnifiedMAPpositions.subSequenceSize()
1079                                 << \textcolor{stringliteral}{", rawUnifiedMAPpositions[0] = "}                << tmpVec
1080                                 << std::endl;
1081       \}
1082     \}
1083   \}
1084 
1085   \textcolor{comment}{// Take care of other aspects of raw chain}
1086   \textcolor{keywordflow}{if} ((genericFilePtrSet.ofsVar                 ) &&
1087       (\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_a5d0bc9f73d50d272aa6bfb5ef5939ef3}{m\_optionsObj}->\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_options_a9d4792d9fc2dc5439b8ab489b0c236eb}{m\_ov}.\hyperlink{class_q_u_e_s_o_1_1_mh_options_values_af812309e81191e88dfdc87c5815141a3}{m\_totallyMute} == \textcolor{keyword}{false})) \{
1088     \textcolor{comment}{// Write likelihoodValues and alphaValues, if they were requested by user}
1089     iRC = \hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_ae354fe11a3f89df768b15f1743567db2}{writeInfo}(workingChain,
1090                     *genericFilePtrSet.ofsVar);
1091     \hyperlink{_defines_8h_aa9107e1a9a5197371a412db3fa349988}{UQ\_FATAL\_RC\_MACRO}(iRC,
1092                       \hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_ac8ea061e55b920e0c8f9bce5c3f20e52}{m\_env}.\hyperlink{class_q_u_e_s_o_1_1_base_environment_a78b57112bbd0e6dd0e8afec00b40ffa7}{worldRank}(),
1093                       \textcolor{stringliteral}{"MetropolisHastingsSG<P\_V,P\_M>::generateSequence()"},
1094                       \textcolor{stringliteral}{"improper writeInfo() return"});
1095   \}
1096 
1097 \textcolor{preprocessor}{#ifdef QUESO\_USES\_SEQUENCE\_STATISTICAL\_OPTIONS}
1098 \textcolor{preprocessor}{}  \textcolor{keywordflow}{if} (\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_a5d0bc9f73d50d272aa6bfb5ef5939ef3}{m\_optionsObj}->\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_options_a9d4792d9fc2dc5439b8ab489b0c236eb}{m\_ov}.m\_rawChainComputeStats) \{
1099     workingChain.computeStatistics(*\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_a5d0bc9f73d50d272aa6bfb5ef5939ef3}{m\_optionsObj}->m\_rawChainStatisticalOptionsObj,
1100                                    genericFilePtrSet.ofsVar);
1101   \}
1102 \textcolor{preprocessor}{#endif}
1103 \textcolor{preprocessor}{}
1104   \textcolor{comment}{//****************************************************************************************}
1105   \textcolor{comment}{// Eventually:}
1106   \textcolor{comment}{// --> filter the raw chain}
1107   \textcolor{comment}{// --> write it}
1108   \textcolor{comment}{// --> compute statistics on it}
1109   \textcolor{comment}{//****************************************************************************************}
1110   \textcolor{keywordflow}{if} (\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_a5d0bc9f73d50d272aa6bfb5ef5939ef3}{m\_optionsObj}->\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_options_a9d4792d9fc2dc5439b8ab489b0c236eb}{m\_ov}.\hyperlink{class_q_u_e_s_o_1_1_mh_options_values_afe02816132a862e807ea3675b4125ccb}{m\_filteredChainGenerate}) \{
1111     \textcolor{comment}{// Compute filter parameters}
1112     \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} filterInitialPos = (\textcolor{keywordtype}{unsigned} int) (\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_a5d0bc9f73d50d272aa6bfb5ef5939ef3}{m\_optionsObj}->
      \hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_options_a9d4792d9fc2dc5439b8ab489b0c236eb}{m\_ov}.\hyperlink{class_q_u_e_s_o_1_1_mh_options_values_afdaa37947c3a5c5acc11b89fa0a98fb9}{m\_filteredChainDiscardedPortion} * (\textcolor{keywordtype}{double}) workingChain.
      \hyperlink{class_q_u_e_s_o_1_1_base_vector_sequence_afd6278702d40bdf1044697bbd6ad1957}{subSequenceSize}());
1113     \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} filterSpacing    = \hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_a5d0bc9f73d50d272aa6bfb5ef5939ef3}{m\_optionsObj}->\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_options_a9d4792d9fc2dc5439b8ab489b0c236eb}{m\_ov}.
      \hyperlink{class_q_u_e_s_o_1_1_mh_options_values_abd87b32b15f3ce695d910b48d837094f}{m\_filteredChainLag};
1114     \textcolor{keywordflow}{if} (filterSpacing == 0) \{
1115       workingChain.\hyperlink{class_q_u_e_s_o_1_1_base_vector_sequence_a8e34f6205e26eab1e9cbe457dbd376bc}{computeFilterParams}(genericFilePtrSet.ofsVar,
1116                                        filterInitialPos,
1117                                        filterSpacing);
1118     \}
1119 
1120     \textcolor{comment}{// Filter positions from the converged portion of the chain}
1121     workingChain.\hyperlink{class_q_u_e_s_o_1_1_base_vector_sequence_adfb88fdbaa1c6b2b040ef888633619ef}{filter}(filterInitialPos,
1122                         filterSpacing);
1123     workingChain.\hyperlink{class_q_u_e_s_o_1_1_base_vector_sequence_a0a2f78cd12e0f136f7801f7d0175b849}{setName}(\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_a5d0bc9f73d50d272aa6bfb5ef5939ef3}{m\_optionsObj}->\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_options_a4f7c510aaa530336d24259e2a89f5d0b}{m\_prefix} + \textcolor{stringliteral}{"filtChain"});
1124 
1125     \textcolor{keywordflow}{if} (workingLogLikelihoodValues) workingLogLikelihoodValues->\hyperlink{class_q_u_e_s_o_1_1_scalar_sequence_aaf386a04a0cebd7f88c5b7694a5fd3d1}{filter}(filterInitialPos,
1126                                                                        filterSpacing);
1127 
1128     \textcolor{keywordflow}{if} (workingLogTargetValues) workingLogTargetValues->\hyperlink{class_q_u_e_s_o_1_1_scalar_sequence_aaf386a04a0cebd7f88c5b7694a5fd3d1}{filter}(filterInitialPos,
1129                                                                filterSpacing);
1130 
1131     \textcolor{comment}{// Write filtered chain}
1132     \textcolor{keywordflow}{if} ((\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_ac8ea061e55b920e0c8f9bce5c3f20e52}{m\_env}.\hyperlink{class_q_u_e_s_o_1_1_base_environment_a8a0064746ae8dddfece4229b9ad374d6}{subDisplayFile}()                   ) &&
1133         (\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_a5d0bc9f73d50d272aa6bfb5ef5939ef3}{m\_optionsObj}->\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_options_a9d4792d9fc2dc5439b8ab489b0c236eb}{m\_ov}.\hyperlink{class_q_u_e_s_o_1_1_mh_options_values_af812309e81191e88dfdc87c5815141a3}{m\_totallyMute} == \textcolor{keyword}{false})) \{
1134       *\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_ac8ea061e55b920e0c8f9bce5c3f20e52}{m\_env}.\hyperlink{class_q_u_e_s_o_1_1_base_environment_a8a0064746ae8dddfece4229b9ad374d6}{subDisplayFile}() << \textcolor{stringliteral}{"In MetropolisHastingsSG<P\_V,P\_M>::generateSequence()"}
1135                               << \textcolor{stringliteral}{", prefix = "}                                                      << 
      \hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_a5d0bc9f73d50d272aa6bfb5ef5939ef3}{m\_optionsObj}->\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_options_a4f7c510aaa530336d24259e2a89f5d0b}{m\_prefix}
1136                               << \textcolor{stringliteral}{": checking necessity of opening output files for filtered chain "} << 
      workingChain.\hyperlink{class_q_u_e_s_o_1_1_base_vector_sequence_a48f6fe02cf77f4233d3bcdfef3870f19}{name}()
1137                               << \textcolor{stringliteral}{"..."}
1138                               << std::endl;
1139     \}
1140 
1141     \textcolor{comment}{// Take "sub" care of filtered chain}
1142     \textcolor{keywordflow}{if} ((\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_a5d0bc9f73d50d272aa6bfb5ef5939ef3}{m\_optionsObj}->\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_options_a9d4792d9fc2dc5439b8ab489b0c236eb}{m\_ov}.\hyperlink{class_q_u_e_s_o_1_1_mh_options_values_a337b2f1161814f1c52153cbe7706f59a}{m\_filteredChainDataOutputFileName}
       != \hyperlink{_metropolis_hastings_s_g_options_8h_a75699ceb938d800e2b7f59ede3ea9a31}{UQ\_MH\_SG\_FILENAME\_FOR\_NO\_FILE}) &&
1143         (\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_a5d0bc9f73d50d272aa6bfb5ef5939ef3}{m\_optionsObj}->\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_options_a9d4792d9fc2dc5439b8ab489b0c236eb}{m\_ov}.\hyperlink{class_q_u_e_s_o_1_1_mh_options_values_af812309e81191e88dfdc87c5815141a3}{m\_totallyMute} == \textcolor{keyword}{false}                            
                      )) \{
1144       workingChain.\hyperlink{class_q_u_e_s_o_1_1_base_vector_sequence_aa59738c6df15b1b369b90f0d025fb6f2}{subWriteContents}(0,
1145                                     workingChain.\hyperlink{class_q_u_e_s_o_1_1_base_vector_sequence_afd6278702d40bdf1044697bbd6ad1957}{subSequenceSize}(),
1146                                     \hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_a5d0bc9f73d50d272aa6bfb5ef5939ef3}{m\_optionsObj}->\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_options_a9d4792d9fc2dc5439b8ab489b0c236eb}{m\_ov}.
      \hyperlink{class_q_u_e_s_o_1_1_mh_options_values_a337b2f1161814f1c52153cbe7706f59a}{m\_filteredChainDataOutputFileName},
1147                                     \hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_a5d0bc9f73d50d272aa6bfb5ef5939ef3}{m\_optionsObj}->\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_options_a9d4792d9fc2dc5439b8ab489b0c236eb}{m\_ov}.
      \hyperlink{class_q_u_e_s_o_1_1_mh_options_values_adc3052dc0f1c2fd5072cb415a0eb3265}{m\_filteredChainDataOutputFileType},
1148                                     \hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_a5d0bc9f73d50d272aa6bfb5ef5939ef3}{m\_optionsObj}->\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_options_a9d4792d9fc2dc5439b8ab489b0c236eb}{m\_ov}.
      \hyperlink{class_q_u_e_s_o_1_1_mh_options_values_ab465e2184857848c2276578b2b08baab}{m\_filteredChainDataOutputAllowedSet});
1149       \textcolor{keywordflow}{if} ((\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_ac8ea061e55b920e0c8f9bce5c3f20e52}{m\_env}.\hyperlink{class_q_u_e_s_o_1_1_base_environment_a8a0064746ae8dddfece4229b9ad374d6}{subDisplayFile}()                   ) &&
1150           (\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_a5d0bc9f73d50d272aa6bfb5ef5939ef3}{m\_optionsObj}->\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_options_a9d4792d9fc2dc5439b8ab489b0c236eb}{m\_ov}.\hyperlink{class_q_u_e_s_o_1_1_mh_options_values_af812309e81191e88dfdc87c5815141a3}{m\_totallyMute} == \textcolor{keyword}{false})) \{
1151         *\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_ac8ea061e55b920e0c8f9bce5c3f20e52}{m\_env}.\hyperlink{class_q_u_e_s_o_1_1_base_environment_a8a0064746ae8dddfece4229b9ad374d6}{subDisplayFile}() << \textcolor{stringliteral}{"In MetropolisHastingsSG<P\_V,P\_M>::generateSequence()
      "}
1152                                 << \textcolor{stringliteral}{", prefix = "}                << \hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_a5d0bc9f73d50d272aa6bfb5ef5939ef3}{m\_optionsObj}->
      \hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_options_a4f7c510aaa530336d24259e2a89f5d0b}{m\_prefix}
1153                                 << \textcolor{stringliteral}{": closed sub output file '"} << \hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_a5d0bc9f73d50d272aa6bfb5ef5939ef3}{m\_optionsObj}->
      \hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_options_a9d4792d9fc2dc5439b8ab489b0c236eb}{m\_ov}.\hyperlink{class_q_u_e_s_o_1_1_mh_options_values_a337b2f1161814f1c52153cbe7706f59a}{m\_filteredChainDataOutputFileName}
1154                                 << \textcolor{stringliteral}{"' for filtered chain "}      << workingChain.
      \hyperlink{class_q_u_e_s_o_1_1_base_vector_sequence_a48f6fe02cf77f4233d3bcdfef3870f19}{name}()
1155                                 << std::endl;
1156       \}
1157 
1158       \textcolor{keywordflow}{if} (workingLogLikelihoodValues) \{
1159         workingLogLikelihoodValues->\hyperlink{class_q_u_e_s_o_1_1_scalar_sequence_aa162c8bbca4e0dedca894828c57e1fa7}{subWriteContents}(0,
1160                                                      workingChain.
      \hyperlink{class_q_u_e_s_o_1_1_base_vector_sequence_afd6278702d40bdf1044697bbd6ad1957}{subSequenceSize}(),
1161                                                      \hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_a5d0bc9f73d50d272aa6bfb5ef5939ef3}{m\_optionsObj}->
      \hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_options_a9d4792d9fc2dc5439b8ab489b0c236eb}{m\_ov}.\hyperlink{class_q_u_e_s_o_1_1_mh_options_values_a337b2f1161814f1c52153cbe7706f59a}{m\_filteredChainDataOutputFileName} + \textcolor{stringliteral}{"\_likelihood"},
1162                                                      \hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_a5d0bc9f73d50d272aa6bfb5ef5939ef3}{m\_optionsObj}->
      \hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_options_a9d4792d9fc2dc5439b8ab489b0c236eb}{m\_ov}.\hyperlink{class_q_u_e_s_o_1_1_mh_options_values_adc3052dc0f1c2fd5072cb415a0eb3265}{m\_filteredChainDataOutputFileType},
1163                                                      \hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_a5d0bc9f73d50d272aa6bfb5ef5939ef3}{m\_optionsObj}->
      \hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_options_a9d4792d9fc2dc5439b8ab489b0c236eb}{m\_ov}.\hyperlink{class_q_u_e_s_o_1_1_mh_options_values_ab465e2184857848c2276578b2b08baab}{m\_filteredChainDataOutputAllowedSet});
1164       \}
1165 
1166       \textcolor{keywordflow}{if} (workingLogTargetValues) \{
1167         workingLogTargetValues->\hyperlink{class_q_u_e_s_o_1_1_scalar_sequence_aa162c8bbca4e0dedca894828c57e1fa7}{subWriteContents}(0,
1168                                                  workingChain.\hyperlink{class_q_u_e_s_o_1_1_base_vector_sequence_afd6278702d40bdf1044697bbd6ad1957}{subSequenceSize}(),
1169                                                  \hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_a5d0bc9f73d50d272aa6bfb5ef5939ef3}{m\_optionsObj}->\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_options_a9d4792d9fc2dc5439b8ab489b0c236eb}{m\_ov}.
      \hyperlink{class_q_u_e_s_o_1_1_mh_options_values_a337b2f1161814f1c52153cbe7706f59a}{m\_filteredChainDataOutputFileName} + \textcolor{stringliteral}{"\_target"},
1170                                                  \hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_a5d0bc9f73d50d272aa6bfb5ef5939ef3}{m\_optionsObj}->\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_options_a9d4792d9fc2dc5439b8ab489b0c236eb}{m\_ov}.
      \hyperlink{class_q_u_e_s_o_1_1_mh_options_values_adc3052dc0f1c2fd5072cb415a0eb3265}{m\_filteredChainDataOutputFileType},
1171                                                  \hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_a5d0bc9f73d50d272aa6bfb5ef5939ef3}{m\_optionsObj}->\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_options_a9d4792d9fc2dc5439b8ab489b0c236eb}{m\_ov}.
      \hyperlink{class_q_u_e_s_o_1_1_mh_options_values_ab465e2184857848c2276578b2b08baab}{m\_filteredChainDataOutputAllowedSet});
1172       \}
1173     \}
1174 
1175     \textcolor{comment}{// Compute sub filtered MLE and sub filtered MAP}
1176 
1177     \textcolor{comment}{// Take "unified" care of filtered chain}
1178     \textcolor{keywordflow}{if} ((\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_a5d0bc9f73d50d272aa6bfb5ef5939ef3}{m\_optionsObj}->\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_options_a9d4792d9fc2dc5439b8ab489b0c236eb}{m\_ov}.\hyperlink{class_q_u_e_s_o_1_1_mh_options_values_a337b2f1161814f1c52153cbe7706f59a}{m\_filteredChainDataOutputFileName}
       != \hyperlink{_metropolis_hastings_s_g_options_8h_a75699ceb938d800e2b7f59ede3ea9a31}{UQ\_MH\_SG\_FILENAME\_FOR\_NO\_FILE}) &&
1179         (\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_a5d0bc9f73d50d272aa6bfb5ef5939ef3}{m\_optionsObj}->\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_options_a9d4792d9fc2dc5439b8ab489b0c236eb}{m\_ov}.\hyperlink{class_q_u_e_s_o_1_1_mh_options_values_af812309e81191e88dfdc87c5815141a3}{m\_totallyMute} == false                            
                      )) \{
1180       workingChain.\hyperlink{class_q_u_e_s_o_1_1_base_vector_sequence_a3987ee6d026842e4ddaeaf0bc850ef83}{unifiedWriteContents}(\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_a5d0bc9f73d50d272aa6bfb5ef5939ef3}{m\_optionsObj}->
      \hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_options_a9d4792d9fc2dc5439b8ab489b0c236eb}{m\_ov}.\hyperlink{class_q_u_e_s_o_1_1_mh_options_values_a337b2f1161814f1c52153cbe7706f59a}{m\_filteredChainDataOutputFileName},
1181                                         \hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_a5d0bc9f73d50d272aa6bfb5ef5939ef3}{m\_optionsObj}->\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_options_a9d4792d9fc2dc5439b8ab489b0c236eb}{m\_ov}.
      \hyperlink{class_q_u_e_s_o_1_1_mh_options_values_adc3052dc0f1c2fd5072cb415a0eb3265}{m\_filteredChainDataOutputFileType});
1182       \textcolor{keywordflow}{if} ((\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_ac8ea061e55b920e0c8f9bce5c3f20e52}{m\_env}.\hyperlink{class_q_u_e_s_o_1_1_base_environment_a8a0064746ae8dddfece4229b9ad374d6}{subDisplayFile}()                   ) &&
1183           (\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_a5d0bc9f73d50d272aa6bfb5ef5939ef3}{m\_optionsObj}->\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_options_a9d4792d9fc2dc5439b8ab489b0c236eb}{m\_ov}.\hyperlink{class_q_u_e_s_o_1_1_mh_options_values_af812309e81191e88dfdc87c5815141a3}{m\_totallyMute} == \textcolor{keyword}{false})) \{
1184         *\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_ac8ea061e55b920e0c8f9bce5c3f20e52}{m\_env}.\hyperlink{class_q_u_e_s_o_1_1_base_environment_a8a0064746ae8dddfece4229b9ad374d6}{subDisplayFile}() << \textcolor{stringliteral}{"In MetropolisHastingsSG<P\_V,P\_M>::generateSequence()
      "}
1185                                 << \textcolor{stringliteral}{", prefix = "}                    << 
      \hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_a5d0bc9f73d50d272aa6bfb5ef5939ef3}{m\_optionsObj}->\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_options_a4f7c510aaa530336d24259e2a89f5d0b}{m\_prefix}
1186                                 << \textcolor{stringliteral}{": closed unified output file '"} << 
      \hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_a5d0bc9f73d50d272aa6bfb5ef5939ef3}{m\_optionsObj}->\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_options_a9d4792d9fc2dc5439b8ab489b0c236eb}{m\_ov}.\hyperlink{class_q_u_e_s_o_1_1_mh_options_values_a337b2f1161814f1c52153cbe7706f59a}{m\_filteredChainDataOutputFileName}
1187                                 << \textcolor{stringliteral}{"' for filtered chain "}          << workingChain.
      \hyperlink{class_q_u_e_s_o_1_1_base_vector_sequence_a48f6fe02cf77f4233d3bcdfef3870f19}{name}()
1188                                 << std::endl;
1189       \}
1190 
1191       \textcolor{keywordflow}{if} (workingLogLikelihoodValues) \{
1192         workingLogLikelihoodValues->\hyperlink{class_q_u_e_s_o_1_1_scalar_sequence_a2f832dd5eda37df06eb52650ab8ce733}{unifiedWriteContents}(
      \hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_a5d0bc9f73d50d272aa6bfb5ef5939ef3}{m\_optionsObj}->\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_options_a9d4792d9fc2dc5439b8ab489b0c236eb}{m\_ov}.\hyperlink{class_q_u_e_s_o_1_1_mh_options_values_a337b2f1161814f1c52153cbe7706f59a}{m\_filteredChainDataOutputFileName} + \textcolor{stringliteral}{"
      \_likelihood"},
1193                                                          \hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_a5d0bc9f73d50d272aa6bfb5ef5939ef3}{m\_optionsObj}->
      \hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_options_a9d4792d9fc2dc5439b8ab489b0c236eb}{m\_ov}.\hyperlink{class_q_u_e_s_o_1_1_mh_options_values_adc3052dc0f1c2fd5072cb415a0eb3265}{m\_filteredChainDataOutputFileType});
1194       \}
1195 
1196       \textcolor{keywordflow}{if} (workingLogTargetValues) \{
1197         workingLogTargetValues->\hyperlink{class_q_u_e_s_o_1_1_scalar_sequence_a2f832dd5eda37df06eb52650ab8ce733}{unifiedWriteContents}(
      \hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_a5d0bc9f73d50d272aa6bfb5ef5939ef3}{m\_optionsObj}->\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_options_a9d4792d9fc2dc5439b8ab489b0c236eb}{m\_ov}.\hyperlink{class_q_u_e_s_o_1_1_mh_options_values_a337b2f1161814f1c52153cbe7706f59a}{m\_filteredChainDataOutputFileName} + \textcolor{stringliteral}{"
      \_target"},
1198                                                      \hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_a5d0bc9f73d50d272aa6bfb5ef5939ef3}{m\_optionsObj}->
      \hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_options_a9d4792d9fc2dc5439b8ab489b0c236eb}{m\_ov}.\hyperlink{class_q_u_e_s_o_1_1_mh_options_values_adc3052dc0f1c2fd5072cb415a0eb3265}{m\_filteredChainDataOutputFileType});
1199       \}
1200     \}
1201 
1202     \textcolor{comment}{// Compute unified filtered MLE and unified filtered MAP}
1203 
1204     \textcolor{comment}{// Compute statistics}
1205 \textcolor{preprocessor}{#ifdef QUESO\_USES\_SEQUENCE\_STATISTICAL\_OPTIONS}
1206 \textcolor{preprocessor}{}    \textcolor{keywordflow}{if} (\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_a5d0bc9f73d50d272aa6bfb5ef5939ef3}{m\_optionsObj}->\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_options_a9d4792d9fc2dc5439b8ab489b0c236eb}{m\_ov}.m\_filteredChainComputeStats) \{
1207       workingChain.computeStatistics(*\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_a5d0bc9f73d50d272aa6bfb5ef5939ef3}{m\_optionsObj}->m\_filteredChainStatisticalOptionsObj,
1208                                      genericFilePtrSet.ofsVar);
1209     \}
1210 \textcolor{preprocessor}{#endif}
1211 \textcolor{preprocessor}{}  \}
1212 
1213   \textcolor{comment}{//****************************************************}
1214   \textcolor{comment}{// Close generic output file}
1215   \textcolor{comment}{//****************************************************}
1216   \textcolor{keywordflow}{if} (genericFilePtrSet.ofsVar) \{
1217     \textcolor{comment}{//genericFilePtrSet.ofsVar->close();}
1218     \textcolor{keyword}{delete} genericFilePtrSet.ofsVar;
1219     \textcolor{keywordflow}{if} ((\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_ac8ea061e55b920e0c8f9bce5c3f20e52}{m\_env}.\hyperlink{class_q_u_e_s_o_1_1_base_environment_a8a0064746ae8dddfece4229b9ad374d6}{subDisplayFile}()                   ) &&
1220         (\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_a5d0bc9f73d50d272aa6bfb5ef5939ef3}{m\_optionsObj}->\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_options_a9d4792d9fc2dc5439b8ab489b0c236eb}{m\_ov}.\hyperlink{class_q_u_e_s_o_1_1_mh_options_values_af812309e81191e88dfdc87c5815141a3}{m\_totallyMute} == \textcolor{keyword}{false})) \{
1221       *\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_ac8ea061e55b920e0c8f9bce5c3f20e52}{m\_env}.\hyperlink{class_q_u_e_s_o_1_1_base_environment_a8a0064746ae8dddfece4229b9ad374d6}{subDisplayFile}() << \textcolor{stringliteral}{"In MetropolisHastingsSG<P\_V,P\_M>::generateSequence()"}
1222                               << \textcolor{stringliteral}{", prefix = "}                    << 
      \hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_a5d0bc9f73d50d272aa6bfb5ef5939ef3}{m\_optionsObj}->\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_options_a4f7c510aaa530336d24259e2a89f5d0b}{m\_prefix}
1223                               << \textcolor{stringliteral}{": closed generic output file '"} << 
      \hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_a5d0bc9f73d50d272aa6bfb5ef5939ef3}{m\_optionsObj}->\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_options_a9d4792d9fc2dc5439b8ab489b0c236eb}{m\_ov}.\hyperlink{class_q_u_e_s_o_1_1_mh_options_values_a768664ee23ad3783751eca33eaeb14b9}{m\_dataOutputFileName}
1224                               << \textcolor{stringliteral}{"' (chain name is "}              << workingChain.
      \hyperlink{class_q_u_e_s_o_1_1_base_vector_sequence_a48f6fe02cf77f4233d3bcdfef3870f19}{name}()
1225                               << \textcolor{stringliteral}{")"}
1226                               << std::endl;
1227     \}
1228   \}
1229 
1230   \textcolor{keywordflow}{if} ((\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_ac8ea061e55b920e0c8f9bce5c3f20e52}{m\_env}.\hyperlink{class_q_u_e_s_o_1_1_base_environment_a8a0064746ae8dddfece4229b9ad374d6}{subDisplayFile}()                   ) &&
1231       (\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_a5d0bc9f73d50d272aa6bfb5ef5939ef3}{m\_optionsObj}->\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_options_a9d4792d9fc2dc5439b8ab489b0c236eb}{m\_ov}.\hyperlink{class_q_u_e_s_o_1_1_mh_options_values_af812309e81191e88dfdc87c5815141a3}{m\_totallyMute} == \textcolor{keyword}{false})) \{
1232     *\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_ac8ea061e55b920e0c8f9bce5c3f20e52}{m\_env}.\hyperlink{class_q_u_e_s_o_1_1_base_environment_a8a0064746ae8dddfece4229b9ad374d6}{subDisplayFile}() << std::endl;
1233   \}
1234 
1235   \textcolor{comment}{//m\_env.syncPrintDebugMsg("Leaving
       MetropolisHastingsSG<P\_V,P\_M>::generateSequence()",2,3000000,m\_env.fullComm()); // Dangerous to barrier on fullComm ... // KAUST}
1236 
1237   \textcolor{keywordflow}{if} ((\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_ac8ea061e55b920e0c8f9bce5c3f20e52}{m\_env}.\hyperlink{class_q_u_e_s_o_1_1_base_environment_a8a0064746ae8dddfece4229b9ad374d6}{subDisplayFile}()                   ) &&
1238       (\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_ac8ea061e55b920e0c8f9bce5c3f20e52}{m\_env}.\hyperlink{class_q_u_e_s_o_1_1_base_environment_a1fe5f244fc0316a0ab3e37463f108b96}{displayVerbosity}() >= 5            ) &&
1239       (\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_a5d0bc9f73d50d272aa6bfb5ef5939ef3}{m\_optionsObj}->\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_options_a9d4792d9fc2dc5439b8ab489b0c236eb}{m\_ov}.\hyperlink{class_q_u_e_s_o_1_1_mh_options_values_af812309e81191e88dfdc87c5815141a3}{m\_totallyMute} == \textcolor{keyword}{false})) \{
1240     *\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_ac8ea061e55b920e0c8f9bce5c3f20e52}{m\_env}.\hyperlink{class_q_u_e_s_o_1_1_base_environment_a8a0064746ae8dddfece4229b9ad374d6}{subDisplayFile}() << \textcolor{stringliteral}{"Leaving
       MetropolisHastingsSG<P\_V,P\_M>::generateSequence()"}
1241                             << std::endl;
1242   \}
1243 
1244   \textcolor{keywordflow}{return};
1245 \}
\end{DoxyCode}
\hypertarget{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_a1f0aebb8374162b9dee9463412a21436}{\index{Q\-U\-E\-S\-O\-::\-Metropolis\-Hastings\-S\-G@{Q\-U\-E\-S\-O\-::\-Metropolis\-Hastings\-S\-G}!get\-Raw\-Chain\-Info@{get\-Raw\-Chain\-Info}}
\index{get\-Raw\-Chain\-Info@{get\-Raw\-Chain\-Info}!QUESO::MetropolisHastingsSG@{Q\-U\-E\-S\-O\-::\-Metropolis\-Hastings\-S\-G}}
\subsubsection[{get\-Raw\-Chain\-Info}]{\setlength{\rightskip}{0pt plus 5cm}template$<$class P\-\_\-\-V , class P\-\_\-\-M $>$ void {\bf Q\-U\-E\-S\-O\-::\-Metropolis\-Hastings\-S\-G}$<$ P\-\_\-\-V, P\-\_\-\-M $>$\-::get\-Raw\-Chain\-Info (
\begin{DoxyParamCaption}
\item[{{\bf M\-H\-Raw\-Chain\-Info\-Struct} \&}]{info}
\end{DoxyParamCaption}
) const}}\label{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_a1f0aebb8374162b9dee9463412a21436}


Gets information from the raw chain. 



Definition at line 1250 of file Metropolis\-Hastings\-S\-G.\-C.



Referenced by Q\-U\-E\-S\-O\-::\-M\-L\-Sampling$<$ P\-\_\-\-V, P\-\_\-\-M $>$\-::generate\-Bal\-Linked\-Chains\-\_\-all(), and Q\-U\-E\-S\-O\-::\-M\-L\-Sampling$<$ P\-\_\-\-V, P\-\_\-\-M $>$\-::generate\-Unb\-Linked\-Chains\-\_\-all().


\begin{DoxyCode}
1251 \{
1252   info = \hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_ac531509489028853bb17c0353fc9eafd}{m\_rawChainInfo};
1253   \textcolor{keywordflow}{return};
1254 \}
\end{DoxyCode}
\hypertarget{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_aed301deea1c0eab1a7d9e4a332729141}{\index{Q\-U\-E\-S\-O\-::\-Metropolis\-Hastings\-S\-G@{Q\-U\-E\-S\-O\-::\-Metropolis\-Hastings\-S\-G}!print@{print}}
\index{print@{print}!QUESO::MetropolisHastingsSG@{Q\-U\-E\-S\-O\-::\-Metropolis\-Hastings\-S\-G}}
\subsubsection[{print}]{\setlength{\rightskip}{0pt plus 5cm}template$<$class P\-\_\-\-V, class P\-\_\-\-M$>$ void {\bf Q\-U\-E\-S\-O\-::\-Metropolis\-Hastings\-S\-G}$<$ P\-\_\-\-V, P\-\_\-\-M $>$\-::print (
\begin{DoxyParamCaption}
\item[{std\-::ostream \&}]{os}
\end{DoxyParamCaption}
) const}}\label{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_aed301deea1c0eab1a7d9e4a332729141}


T\-O\-D\-O\-: Prints the sequence. 

\begin{DoxyRefDesc}{Todo}
\item[\hyperlink{todo__todo000038}{Todo}]\-: implement me! \end{DoxyRefDesc}
\hypertarget{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_ad1a6f23afa254985240949b8bbfb0c59}{\index{Q\-U\-E\-S\-O\-::\-Metropolis\-Hastings\-S\-G@{Q\-U\-E\-S\-O\-::\-Metropolis\-Hastings\-S\-G}!read\-Full\-Chain@{read\-Full\-Chain}}
\index{read\-Full\-Chain@{read\-Full\-Chain}!QUESO::MetropolisHastingsSG@{Q\-U\-E\-S\-O\-::\-Metropolis\-Hastings\-S\-G}}
\subsubsection[{read\-Full\-Chain}]{\setlength{\rightskip}{0pt plus 5cm}template$<$class P\-\_\-\-V , class P\-\_\-\-M $>$ void {\bf Q\-U\-E\-S\-O\-::\-Metropolis\-Hastings\-S\-G}$<$ P\-\_\-\-V, P\-\_\-\-M $>$\-::read\-Full\-Chain (
\begin{DoxyParamCaption}
\item[{const std\-::string \&}]{input\-File\-Name, }
\item[{const std\-::string \&}]{input\-File\-Type, }
\item[{unsigned int}]{chain\-Size, }
\item[{{\bf Base\-Vector\-Sequence}$<$ P\-\_\-\-V, P\-\_\-\-M $>$ \&}]{working\-Chain}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [private]}}}\label{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_ad1a6f23afa254985240949b8bbfb0c59}


This method reads the chain contents. 



Definition at line 1258 of file Metropolis\-Hastings\-S\-G.\-C.



References Q\-U\-E\-S\-O\-::\-Base\-Vector\-Sequence$<$ V, M $>$\-::unified\-Read\-Contents().


\begin{DoxyCode}
1263 \{
1264   workingChain.\hyperlink{class_q_u_e_s_o_1_1_base_vector_sequence_afcb5935b592ab2e7ee39d23b08bcce62}{unifiedReadContents}(inputFileName,inputFileType,chainSize);
1265   \textcolor{keywordflow}{return};
1266 \}
\end{DoxyCode}
\hypertarget{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_a8b6571483a26c8ce1783519c43ed55a4}{\index{Q\-U\-E\-S\-O\-::\-Metropolis\-Hastings\-S\-G@{Q\-U\-E\-S\-O\-::\-Metropolis\-Hastings\-S\-G}!update\-Adapted\-Cov\-Matrix@{update\-Adapted\-Cov\-Matrix}}
\index{update\-Adapted\-Cov\-Matrix@{update\-Adapted\-Cov\-Matrix}!QUESO::MetropolisHastingsSG@{Q\-U\-E\-S\-O\-::\-Metropolis\-Hastings\-S\-G}}
\subsubsection[{update\-Adapted\-Cov\-Matrix}]{\setlength{\rightskip}{0pt plus 5cm}template$<$class P\-\_\-\-V , class P\-\_\-\-M $>$ void {\bf Q\-U\-E\-S\-O\-::\-Metropolis\-Hastings\-S\-G}$<$ P\-\_\-\-V, P\-\_\-\-M $>$\-::update\-Adapted\-Cov\-Matrix (
\begin{DoxyParamCaption}
\item[{const {\bf Base\-Vector\-Sequence}$<$ P\-\_\-\-V, P\-\_\-\-M $>$ \&}]{sub\-Chain, }
\item[{unsigned int}]{id\-Of\-First\-Position\-In\-Sub\-Chain, }
\item[{double \&}]{last\-Chain\-Size, }
\item[{P\-\_\-\-V \&}]{last\-Mean, }
\item[{P\-\_\-\-M \&}]{last\-Adapted\-Cov\-Matrix}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [private]}}}\label{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_a8b6571483a26c8ce1783519c43ed55a4}


This method updates the adapted covariance matrix. 

This function is called is the option to used adaptive Metropolis was chosen by the user (via options input file). It performs an adaptation of covariance matrix. 

Definition at line 2212 of file Metropolis\-Hastings\-S\-G.\-C.



References Q\-U\-E\-S\-O\-::\-Base\-Vector\-Sequence$<$ V, M $>$\-::get\-Position\-Values(), Q\-U\-E\-S\-O\-::matrix\-Product(), Q\-U\-E\-S\-O\-::\-Base\-Vector\-Sequence$<$ V, M $>$\-::sub\-Mean\-Extra(), Q\-U\-E\-S\-O\-::\-Base\-Vector\-Sequence$<$ V, M $>$\-::sub\-Mean\-Plain(), Q\-U\-E\-S\-O\-::\-Base\-Vector\-Sequence$<$ V, M $>$\-::sub\-Sequence\-Size(), and U\-Q\-\_\-\-F\-A\-T\-A\-L\-\_\-\-T\-E\-S\-T\-\_\-\-M\-A\-C\-R\-O.


\begin{DoxyCode}
2218 \{
2219   \textcolor{keywordtype}{double} doubleSubChainSize = (double) partialChain.subSequenceSize();
2220   \textcolor{keywordflow}{if} (lastChainSize == 0) \{
2221     \hyperlink{_defines_8h_a56d63d18d0a6d45757de47fcc06f574d}{UQ\_FATAL\_TEST\_MACRO}(partialChain.subSequenceSize() < 2,
2222                         \hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_ac8ea061e55b920e0c8f9bce5c3f20e52}{m\_env}.\hyperlink{class_q_u_e_s_o_1_1_base_environment_a78b57112bbd0e6dd0e8afec00b40ffa7}{worldRank}(),
2223                         \textcolor{stringliteral}{"MetropolisHastingsSG<P\_V,P\_M>::updateAdaptedCovMatrix()"},
2224                         \textcolor{stringliteral}{"'partialChain.subSequenceSize()' should be >= 2"});
2225 
2226 \textcolor{preprocessor}{#if 1 // prudenci-2012-07-06}
2227 \textcolor{preprocessor}{}    lastMean = partialChain.subMeanPlain();
2228 \textcolor{preprocessor}{#else}
2229 \textcolor{preprocessor}{}    partialChain.subMeanExtra(0,partialChain.subSequenceSize(),lastMean);
2230 \textcolor{preprocessor}{#endif}
2231 \textcolor{preprocessor}{}
2232     P\_V tmpVec(\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_a2ef17fbfc6a156f03bbfad044b5a75f5}{m\_vectorSpace}.\hyperlink{class_q_u_e_s_o_1_1_vector_space_a92e963bb5cab3eecd290dfe4b8f03b04}{zeroVector}());
2233     lastAdaptedCovMatrix = -doubleSubChainSize * \hyperlink{namespace_q_u_e_s_o_aea04e232d5d3dd76349a85bb8acf9e17}{matrixProduct}(lastMean,lastMean);
2234     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} i = 0; i < partialChain.subSequenceSize(); ++i) \{
2235       partialChain.getPositionValues(i,tmpVec);
2236       lastAdaptedCovMatrix += \hyperlink{namespace_q_u_e_s_o_aea04e232d5d3dd76349a85bb8acf9e17}{matrixProduct}(tmpVec,tmpVec);
2237     \}
2238     lastAdaptedCovMatrix /= (doubleSubChainSize - 1.); \textcolor{comment}{// That is why partialChain size must be >= 2}
2239   \}
2240   \textcolor{keywordflow}{else} \{
2241     \hyperlink{_defines_8h_a56d63d18d0a6d45757de47fcc06f574d}{UQ\_FATAL\_TEST\_MACRO}(partialChain.subSequenceSize() < 1,
2242                         \hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_ac8ea061e55b920e0c8f9bce5c3f20e52}{m\_env}.\hyperlink{class_q_u_e_s_o_1_1_base_environment_a78b57112bbd0e6dd0e8afec00b40ffa7}{worldRank}(),
2243                         \textcolor{stringliteral}{"MetropolisHastingsSG<P\_V,P\_M>::updateAdaptedCovMatrix()"},
2244                         \textcolor{stringliteral}{"'partialChain.subSequenceSize()' should be >= 1"});
2245 
2246     \hyperlink{_defines_8h_a56d63d18d0a6d45757de47fcc06f574d}{UQ\_FATAL\_TEST\_MACRO}(idOfFirstPositionInSubChain < 1,
2247                         \hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_ac8ea061e55b920e0c8f9bce5c3f20e52}{m\_env}.\hyperlink{class_q_u_e_s_o_1_1_base_environment_a78b57112bbd0e6dd0e8afec00b40ffa7}{worldRank}(),
2248                         \textcolor{stringliteral}{"MetropolisHastingsSG<P\_V,P\_M>::updateAdaptedCovMatrix()"},
2249                         \textcolor{stringliteral}{"'idOfFirstPositionInSubChain' should be >= 1"});
2250 
2251     P\_V tmpVec (\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_a2ef17fbfc6a156f03bbfad044b5a75f5}{m\_vectorSpace}.\hyperlink{class_q_u_e_s_o_1_1_vector_space_a92e963bb5cab3eecd290dfe4b8f03b04}{zeroVector}());
2252     P\_V diffVec(\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_a2ef17fbfc6a156f03bbfad044b5a75f5}{m\_vectorSpace}.\hyperlink{class_q_u_e_s_o_1_1_vector_space_a92e963bb5cab3eecd290dfe4b8f03b04}{zeroVector}());
2253     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} i = 0; i < partialChain.subSequenceSize(); ++i) \{
2254       \textcolor{keywordtype}{double} doubleCurrentId  = (double) (idOfFirstPositionInSubChain+i);
2255       partialChain.getPositionValues(i,tmpVec);
2256       diffVec = tmpVec - lastMean;
2257 
2258       \textcolor{keywordtype}{double} ratio1         = (1. - 1./doubleCurrentId); \textcolor{comment}{// That is why idOfFirstPositionInSubChain must be
       >= 1}
2259       \textcolor{keywordtype}{double} ratio2         = (1./(1.+doubleCurrentId));
2260       lastAdaptedCovMatrix  = ratio1 * lastAdaptedCovMatrix + ratio2 * 
      \hyperlink{namespace_q_u_e_s_o_aea04e232d5d3dd76349a85bb8acf9e17}{matrixProduct}(diffVec,diffVec);
2261       lastMean             += ratio2 * diffVec;
2262     \}
2263   \}
2264   lastChainSize += doubleSubChainSize;
2265 
2266   \textcolor{keywordflow}{if} (\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_a43a883aa28c81ed99e5f0cd9de93889b}{m\_numDisabledParameters} > 0) \{ \textcolor{comment}{// gpmsa2}
2267     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} paramId = 0; paramId < \hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_a2ef17fbfc6a156f03bbfad044b5a75f5}{m\_vectorSpace}.\hyperlink{class_q_u_e_s_o_1_1_vector_space_a5829a1f4f996f8307c840b705144d666}{dimLocal}(); ++paramId) \{
2268       \textcolor{keywordflow}{if} (\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_afce8eeadae98935c72727b3640e88a31}{m\_parameterEnabledStatus}[paramId] == \textcolor{keyword}{false}) \{
2269         \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} i = 0; i < \hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_a2ef17fbfc6a156f03bbfad044b5a75f5}{m\_vectorSpace}.\hyperlink{class_q_u_e_s_o_1_1_vector_space_a5829a1f4f996f8307c840b705144d666}{dimLocal}(); ++i) \{
2270           lastAdaptedCovMatrix(i,paramId) = 0.;
2271         \}
2272         \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} j = 0; j < \hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_a2ef17fbfc6a156f03bbfad044b5a75f5}{m\_vectorSpace}.\hyperlink{class_q_u_e_s_o_1_1_vector_space_a5829a1f4f996f8307c840b705144d666}{dimLocal}(); ++j) \{
2273           lastAdaptedCovMatrix(paramId,j) = 0.;
2274         \}
2275         lastAdaptedCovMatrix(paramId,paramId) = 1.;
2276       \}
2277     \}
2278   \}
2279 
2280   \textcolor{keywordflow}{return};
2281 \}
\end{DoxyCode}
\hypertarget{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_ae354fe11a3f89df768b15f1743567db2}{\index{Q\-U\-E\-S\-O\-::\-Metropolis\-Hastings\-S\-G@{Q\-U\-E\-S\-O\-::\-Metropolis\-Hastings\-S\-G}!write\-Info@{write\-Info}}
\index{write\-Info@{write\-Info}!QUESO::MetropolisHastingsSG@{Q\-U\-E\-S\-O\-::\-Metropolis\-Hastings\-S\-G}}
\subsubsection[{write\-Info}]{\setlength{\rightskip}{0pt plus 5cm}template$<$class P\-\_\-\-V , class P\-\_\-\-M $>$ int {\bf Q\-U\-E\-S\-O\-::\-Metropolis\-Hastings\-S\-G}$<$ P\-\_\-\-V, P\-\_\-\-M $>$\-::write\-Info (
\begin{DoxyParamCaption}
\item[{const {\bf Base\-Vector\-Sequence}$<$ P\-\_\-\-V, P\-\_\-\-M $>$ \&}]{working\-Chain, }
\item[{std\-::ofstream \&}]{ofsvar}
\end{DoxyParamCaption}
) const\hspace{0.3cm}{\ttfamily [private]}}}\label{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_ae354fe11a3f89df768b15f1743567db2}


Writes information about the Markov chain in a file. 

It writes down the alpha quotients, the number of rejected positions, number of positions out of target support, the name of the components and the chain runtime. 

Definition at line 726 of file Metropolis\-Hastings\-S\-G.\-C.



References Q\-U\-E\-S\-O\-::\-Base\-Vector\-Sequence$<$ V, M $>$\-::name(), Q\-U\-E\-S\-O\-::\-Base\-Vector\-Sequence$<$ V, M $>$\-::sub\-Sequence\-Size(), and Q\-U\-E\-S\-O\-::\-U\-Q\-\_\-\-O\-K\-\_\-\-R\-C.


\begin{DoxyCode}
729 \{
730   \textcolor{keywordflow}{if} ((\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_ac8ea061e55b920e0c8f9bce5c3f20e52}{m\_env}.\hyperlink{class_q_u_e_s_o_1_1_base_environment_a8a0064746ae8dddfece4229b9ad374d6}{subDisplayFile}()                   ) &&
731       (\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_a5d0bc9f73d50d272aa6bfb5ef5939ef3}{m\_optionsObj}->\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_options_a9d4792d9fc2dc5439b8ab489b0c236eb}{m\_ov}.\hyperlink{class_q_u_e_s_o_1_1_mh_options_values_af812309e81191e88dfdc87c5815141a3}{m\_totallyMute} == \textcolor{keyword}{false})) \{
732     *\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_ac8ea061e55b920e0c8f9bce5c3f20e52}{m\_env}.\hyperlink{class_q_u_e_s_o_1_1_base_environment_a8a0064746ae8dddfece4229b9ad374d6}{subDisplayFile}() << \textcolor{stringliteral}{"\(\backslash\)n"}
733                             << \textcolor{stringliteral}{"\(\backslash\)n-----------------------------------------------------"}
734                             << \textcolor{stringliteral}{"\(\backslash\)n Writing more information about the Markov chain "} << workingChain.
      \hyperlink{class_q_u_e_s_o_1_1_base_vector_sequence_a48f6fe02cf77f4233d3bcdfef3870f19}{name}() << \textcolor{stringliteral}{" to output file ..."}
735                             << \textcolor{stringliteral}{"\(\backslash\)n-----------------------------------------------------"}
736                             << \textcolor{stringliteral}{"\(\backslash\)n"}
737                             << std::endl;
738   \}
739 
740   \textcolor{keywordtype}{int} iRC = \hyperlink{namespace_q_u_e_s_o_a8e909502900aecf24cedba022ea84471}{UQ\_OK\_RC};
741 
742   \textcolor{keywordflow}{if} (\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_a5d0bc9f73d50d272aa6bfb5ef5939ef3}{m\_optionsObj}->\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_options_a9d4792d9fc2dc5439b8ab489b0c236eb}{m\_ov}.\hyperlink{class_q_u_e_s_o_1_1_mh_options_values_a9d540978290d39df801e32f183450859}{m\_rawChainGenerateExtra}) \{
743     \textcolor{comment}{// Write m\_logTargets}
744     ofsvar << \hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_a5d0bc9f73d50d272aa6bfb5ef5939ef3}{m\_optionsObj}->\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_options_a4f7c510aaa530336d24259e2a89f5d0b}{m\_prefix} << \textcolor{stringliteral}{"logTargets\_sub"} << 
      \hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_ac8ea061e55b920e0c8f9bce5c3f20e52}{m\_env}.\hyperlink{class_q_u_e_s_o_1_1_base_environment_a73f7849acdd5d5ba15a3094fe18f258f}{subIdString}() << \textcolor{stringliteral}{" = zeros("} << \hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_ac33a6e46e05c20c071a46ecf58a9291c}{m\_logTargets}.size()
745            << \textcolor{stringliteral}{","}                    << 1
746            << \textcolor{stringliteral}{");"}
747            << std::endl;
748     ofsvar << \hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_a5d0bc9f73d50d272aa6bfb5ef5939ef3}{m\_optionsObj}->\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_options_a4f7c510aaa530336d24259e2a89f5d0b}{m\_prefix} << \textcolor{stringliteral}{"logTargets\_sub"} << 
      \hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_ac8ea061e55b920e0c8f9bce5c3f20e52}{m\_env}.\hyperlink{class_q_u_e_s_o_1_1_base_environment_a73f7849acdd5d5ba15a3094fe18f258f}{subIdString}() << \textcolor{stringliteral}{" = ["};
749     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} i = 0; i < \hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_ac33a6e46e05c20c071a46ecf58a9291c}{m\_logTargets}.size(); ++i) \{
750       ofsvar << \hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_ac33a6e46e05c20c071a46ecf58a9291c}{m\_logTargets}[i]
751              << std::endl;
752     \}
753     ofsvar << \textcolor{stringliteral}{"];\(\backslash\)n"};
754 
755     \textcolor{comment}{// Write m\_alphaQuotients}
756     ofsvar << \hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_a5d0bc9f73d50d272aa6bfb5ef5939ef3}{m\_optionsObj}->\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_options_a4f7c510aaa530336d24259e2a89f5d0b}{m\_prefix} << \textcolor{stringliteral}{"alphaQuotients\_sub"} << 
      \hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_ac8ea061e55b920e0c8f9bce5c3f20e52}{m\_env}.\hyperlink{class_q_u_e_s_o_1_1_base_environment_a73f7849acdd5d5ba15a3094fe18f258f}{subIdString}() << \textcolor{stringliteral}{" = zeros("} << \hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_a6fd65985afd80114ece8b2b5fffe658d}{m\_alphaQuotients}.size()
757            << \textcolor{stringliteral}{","}                    << 1
758            << \textcolor{stringliteral}{");"}
759            << std::endl;
760     ofsvar << \hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_a5d0bc9f73d50d272aa6bfb5ef5939ef3}{m\_optionsObj}->\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_options_a4f7c510aaa530336d24259e2a89f5d0b}{m\_prefix} << \textcolor{stringliteral}{"alphaQuotients\_sub"} << 
      \hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_ac8ea061e55b920e0c8f9bce5c3f20e52}{m\_env}.\hyperlink{class_q_u_e_s_o_1_1_base_environment_a73f7849acdd5d5ba15a3094fe18f258f}{subIdString}() << \textcolor{stringliteral}{" = ["};
761     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} i = 0; i < \hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_a6fd65985afd80114ece8b2b5fffe658d}{m\_alphaQuotients}.size(); ++i) \{
762       ofsvar << \hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_a6fd65985afd80114ece8b2b5fffe658d}{m\_alphaQuotients}[i]
763              << std::endl;
764     \}
765     ofsvar << \textcolor{stringliteral}{"];\(\backslash\)n"};
766   \}
767 
768   \textcolor{comment}{// Write number of rejections}
769   ofsvar << \hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_a5d0bc9f73d50d272aa6bfb5ef5939ef3}{m\_optionsObj}->\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_options_a4f7c510aaa530336d24259e2a89f5d0b}{m\_prefix} << \textcolor{stringliteral}{"rejected = "} << (double) 
      \hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_ac531509489028853bb17c0353fc9eafd}{m\_rawChainInfo}.\hyperlink{struct_q_u_e_s_o_1_1_m_h_raw_chain_info_struct_a276f608de19910713df01124a971c79c}{numRejections}/(\textcolor{keywordtype}{double}) (workingChain.
      \hyperlink{class_q_u_e_s_o_1_1_base_vector_sequence_afd6278702d40bdf1044697bbd6ad1957}{subSequenceSize}()-1)
770          << \textcolor{stringliteral}{";\(\backslash\)n"}
771          << std::endl;
772 
773   \textcolor{keywordflow}{if} (\textcolor{keyword}{false}) \{ \textcolor{comment}{// Don't see need for code below. Let it there though, compiling, in case it is needed in
       the future.}
774     \textcolor{comment}{// Write names of components}
775     ofsvar << \hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_a5d0bc9f73d50d272aa6bfb5ef5939ef3}{m\_optionsObj}->\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_options_a4f7c510aaa530336d24259e2a89f5d0b}{m\_prefix} << \textcolor{stringliteral}{"componentNames = \{"};
776     \hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_a2ef17fbfc6a156f03bbfad044b5a75f5}{m\_vectorSpace}.\hyperlink{class_q_u_e_s_o_1_1_vector_space_adcae173f0230ef737ea592c34cad1d09}{printComponentsNames}(ofsvar,\textcolor{keyword}{false});
777     ofsvar << \textcolor{stringliteral}{"\};\(\backslash\)n"};
778 
779     \textcolor{comment}{// Write number of out of target support}
780     ofsvar << \hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_a5d0bc9f73d50d272aa6bfb5ef5939ef3}{m\_optionsObj}->\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_options_a4f7c510aaa530336d24259e2a89f5d0b}{m\_prefix} << \textcolor{stringliteral}{"outTargetSupport = "} << (double) 
      \hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_ac531509489028853bb17c0353fc9eafd}{m\_rawChainInfo}.\hyperlink{struct_q_u_e_s_o_1_1_m_h_raw_chain_info_struct_a601f798ee4dc28cfa6b342fc04a8c841}{numOutOfTargetSupport}/(\textcolor{keywordtype}{double}) (workingChain.
      \hyperlink{class_q_u_e_s_o_1_1_base_vector_sequence_afd6278702d40bdf1044697bbd6ad1957}{subSequenceSize}()-1)
781            << \textcolor{stringliteral}{";\(\backslash\)n"}
782            << std::endl;
783 
784     \textcolor{comment}{// Write chain run time}
785     ofsvar << \hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_a5d0bc9f73d50d272aa6bfb5ef5939ef3}{m\_optionsObj}->\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_options_a4f7c510aaa530336d24259e2a89f5d0b}{m\_prefix} << \textcolor{stringliteral}{"runTime = "} << 
      \hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_ac531509489028853bb17c0353fc9eafd}{m\_rawChainInfo}.\hyperlink{struct_q_u_e_s_o_1_1_m_h_raw_chain_info_struct_a5b36b9734f0b40d54cfd4c58c18c9b45}{runTime}
786            << \textcolor{stringliteral}{";\(\backslash\)n"}
787            << std::endl;
788   \}
789 
790   \textcolor{keywordflow}{if} ((\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_ac8ea061e55b920e0c8f9bce5c3f20e52}{m\_env}.\hyperlink{class_q_u_e_s_o_1_1_base_environment_a8a0064746ae8dddfece4229b9ad374d6}{subDisplayFile}()                   ) &&
791       (\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_a5d0bc9f73d50d272aa6bfb5ef5939ef3}{m\_optionsObj}->\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_options_a9d4792d9fc2dc5439b8ab489b0c236eb}{m\_ov}.\hyperlink{class_q_u_e_s_o_1_1_mh_options_values_af812309e81191e88dfdc87c5815141a3}{m\_totallyMute} == \textcolor{keyword}{false})) \{
792     *\hyperlink{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_ac8ea061e55b920e0c8f9bce5c3f20e52}{m\_env}.\hyperlink{class_q_u_e_s_o_1_1_base_environment_a8a0064746ae8dddfece4229b9ad374d6}{subDisplayFile}() << \textcolor{stringliteral}{"\(\backslash\)n-----------------------------------------------------"}
793                             << \textcolor{stringliteral}{"\(\backslash\)n Finished writing more information about the Markov chain "} << 
      workingChain.\hyperlink{class_q_u_e_s_o_1_1_base_vector_sequence_a48f6fe02cf77f4233d3bcdfef3870f19}{name}()
794                             << \textcolor{stringliteral}{"\(\backslash\)n-----------------------------------------------------"}
795                             << \textcolor{stringliteral}{"\(\backslash\)n"}
796                             << std::endl;
797   \}
798 
799   \textcolor{keywordflow}{return} iRC;
800 \}
\end{DoxyCode}


\subsection{Friends And Related Function Documentation}
\hypertarget{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_ab930e71442c0c1e3b8236f2f975c0664}{\index{Q\-U\-E\-S\-O\-::\-Metropolis\-Hastings\-S\-G@{Q\-U\-E\-S\-O\-::\-Metropolis\-Hastings\-S\-G}!operator$<$$<$@{operator$<$$<$}}
\index{operator$<$$<$@{operator$<$$<$}!QUESO::MetropolisHastingsSG@{Q\-U\-E\-S\-O\-::\-Metropolis\-Hastings\-S\-G}}
\subsubsection[{operator$<$$<$}]{\setlength{\rightskip}{0pt plus 5cm}template$<$class P\-\_\-\-V, class P\-\_\-\-M$>$ std\-::ostream\& operator$<$$<$ (
\begin{DoxyParamCaption}
\item[{std\-::ostream \&}]{os, }
\item[{const {\bf Metropolis\-Hastings\-S\-G}$<$ P\-\_\-\-V, P\-\_\-\-M $>$ \&}]{obj}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [friend]}}}\label{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_ab930e71442c0c1e3b8236f2f975c0664}


Definition at line 186 of file Metropolis\-Hastings\-S\-G.\-h.


\begin{DoxyCode}
188   \{
189     obj.print(os);
190 
191     \textcolor{keywordflow}{return} os;
192   \}
\end{DoxyCode}


\subsection{Member Data Documentation}
\hypertarget{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_a6fd65985afd80114ece8b2b5fffe658d}{\index{Q\-U\-E\-S\-O\-::\-Metropolis\-Hastings\-S\-G@{Q\-U\-E\-S\-O\-::\-Metropolis\-Hastings\-S\-G}!m\-\_\-alpha\-Quotients@{m\-\_\-alpha\-Quotients}}
\index{m\-\_\-alpha\-Quotients@{m\-\_\-alpha\-Quotients}!QUESO::MetropolisHastingsSG@{Q\-U\-E\-S\-O\-::\-Metropolis\-Hastings\-S\-G}}
\subsubsection[{m\-\_\-alpha\-Quotients}]{\setlength{\rightskip}{0pt plus 5cm}template$<$class P\-\_\-\-V, class P\-\_\-\-M$>$ std\-::vector$<$double$>$ {\bf Q\-U\-E\-S\-O\-::\-Metropolis\-Hastings\-S\-G}$<$ P\-\_\-\-V, P\-\_\-\-M $>$\-::m\-\_\-alpha\-Quotients\hspace{0.3cm}{\ttfamily [private]}}}\label{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_a6fd65985afd80114ece8b2b5fffe658d}


Definition at line 269 of file Metropolis\-Hastings\-S\-G.\-h.

\hypertarget{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_add6eb8fa2e706ef1de9772f71c84d839}{\index{Q\-U\-E\-S\-O\-::\-Metropolis\-Hastings\-S\-G@{Q\-U\-E\-S\-O\-::\-Metropolis\-Hastings\-S\-G}!m\-\_\-alternative\-Options\-Values@{m\-\_\-alternative\-Options\-Values}}
\index{m\-\_\-alternative\-Options\-Values@{m\-\_\-alternative\-Options\-Values}!QUESO::MetropolisHastingsSG@{Q\-U\-E\-S\-O\-::\-Metropolis\-Hastings\-S\-G}}
\subsubsection[{m\-\_\-alternative\-Options\-Values}]{\setlength{\rightskip}{0pt plus 5cm}template$<$class P\-\_\-\-V, class P\-\_\-\-M$>$ {\bf Mh\-Options\-Values} {\bf Q\-U\-E\-S\-O\-::\-Metropolis\-Hastings\-S\-G}$<$ P\-\_\-\-V, P\-\_\-\-M $>$\-::m\-\_\-alternative\-Options\-Values\hspace{0.3cm}{\ttfamily [private]}}}\label{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_add6eb8fa2e706ef1de9772f71c84d839}


Definition at line 277 of file Metropolis\-Hastings\-S\-G.\-h.

\hypertarget{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_ac8ea061e55b920e0c8f9bce5c3f20e52}{\index{Q\-U\-E\-S\-O\-::\-Metropolis\-Hastings\-S\-G@{Q\-U\-E\-S\-O\-::\-Metropolis\-Hastings\-S\-G}!m\-\_\-env@{m\-\_\-env}}
\index{m\-\_\-env@{m\-\_\-env}!QUESO::MetropolisHastingsSG@{Q\-U\-E\-S\-O\-::\-Metropolis\-Hastings\-S\-G}}
\subsubsection[{m\-\_\-env}]{\setlength{\rightskip}{0pt plus 5cm}template$<$class P\-\_\-\-V, class P\-\_\-\-M$>$ const {\bf Base\-Environment}\& {\bf Q\-U\-E\-S\-O\-::\-Metropolis\-Hastings\-S\-G}$<$ P\-\_\-\-V, P\-\_\-\-M $>$\-::m\-\_\-env\hspace{0.3cm}{\ttfamily [private]}}}\label{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_ac8ea061e55b920e0c8f9bce5c3f20e52}


Definition at line 254 of file Metropolis\-Hastings\-S\-G.\-h.



Referenced by Q\-U\-E\-S\-O\-::\-Metropolis\-Hastings\-S\-G$<$ P\-\_\-\-V, P\-\_\-\-M $>$\-::\-Metropolis\-Hastings\-S\-G().

\hypertarget{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_ad1916a22b4a53ba67fa87f93c6e0a252}{\index{Q\-U\-E\-S\-O\-::\-Metropolis\-Hastings\-S\-G@{Q\-U\-E\-S\-O\-::\-Metropolis\-Hastings\-S\-G}!m\-\_\-ids\-Of\-Unique\-Positions@{m\-\_\-ids\-Of\-Unique\-Positions}}
\index{m\-\_\-ids\-Of\-Unique\-Positions@{m\-\_\-ids\-Of\-Unique\-Positions}!QUESO::MetropolisHastingsSG@{Q\-U\-E\-S\-O\-::\-Metropolis\-Hastings\-S\-G}}
\subsubsection[{m\-\_\-ids\-Of\-Unique\-Positions}]{\setlength{\rightskip}{0pt plus 5cm}template$<$class P\-\_\-\-V, class P\-\_\-\-M$>$ std\-::vector$<$unsigned int$>$ {\bf Q\-U\-E\-S\-O\-::\-Metropolis\-Hastings\-S\-G}$<$ P\-\_\-\-V, P\-\_\-\-M $>$\-::m\-\_\-ids\-Of\-Unique\-Positions\hspace{0.3cm}{\ttfamily [private]}}}\label{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_ad1916a22b4a53ba67fa87f93c6e0a252}


Definition at line 267 of file Metropolis\-Hastings\-S\-G.\-h.

\hypertarget{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_ae29f5d1198228858283d733021da2b14}{\index{Q\-U\-E\-S\-O\-::\-Metropolis\-Hastings\-S\-G@{Q\-U\-E\-S\-O\-::\-Metropolis\-Hastings\-S\-G}!m\-\_\-initial\-Position@{m\-\_\-initial\-Position}}
\index{m\-\_\-initial\-Position@{m\-\_\-initial\-Position}!QUESO::MetropolisHastingsSG@{Q\-U\-E\-S\-O\-::\-Metropolis\-Hastings\-S\-G}}
\subsubsection[{m\-\_\-initial\-Position}]{\setlength{\rightskip}{0pt plus 5cm}template$<$class P\-\_\-\-V, class P\-\_\-\-M$>$ P\-\_\-\-V {\bf Q\-U\-E\-S\-O\-::\-Metropolis\-Hastings\-S\-G}$<$ P\-\_\-\-V, P\-\_\-\-M $>$\-::m\-\_\-initial\-Position\hspace{0.3cm}{\ttfamily [private]}}}\label{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_ae29f5d1198228858283d733021da2b14}


Definition at line 257 of file Metropolis\-Hastings\-S\-G.\-h.

\hypertarget{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_a4d9862afbafb34921e91de3d4610c6cd}{\index{Q\-U\-E\-S\-O\-::\-Metropolis\-Hastings\-S\-G@{Q\-U\-E\-S\-O\-::\-Metropolis\-Hastings\-S\-G}!m\-\_\-initial\-Proposal\-Cov\-Matrix@{m\-\_\-initial\-Proposal\-Cov\-Matrix}}
\index{m\-\_\-initial\-Proposal\-Cov\-Matrix@{m\-\_\-initial\-Proposal\-Cov\-Matrix}!QUESO::MetropolisHastingsSG@{Q\-U\-E\-S\-O\-::\-Metropolis\-Hastings\-S\-G}}
\subsubsection[{m\-\_\-initial\-Proposal\-Cov\-Matrix}]{\setlength{\rightskip}{0pt plus 5cm}template$<$class P\-\_\-\-V, class P\-\_\-\-M$>$ P\-\_\-\-M {\bf Q\-U\-E\-S\-O\-::\-Metropolis\-Hastings\-S\-G}$<$ P\-\_\-\-V, P\-\_\-\-M $>$\-::m\-\_\-initial\-Proposal\-Cov\-Matrix\hspace{0.3cm}{\ttfamily [private]}}}\label{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_a4d9862afbafb34921e91de3d4610c6cd}


Definition at line 258 of file Metropolis\-Hastings\-S\-G.\-h.



Referenced by Q\-U\-E\-S\-O\-::\-Metropolis\-Hastings\-S\-G$<$ P\-\_\-\-V, P\-\_\-\-M $>$\-::\-Metropolis\-Hastings\-S\-G().

\hypertarget{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_a1c73b49339c8a1015d95a890d7882331}{\index{Q\-U\-E\-S\-O\-::\-Metropolis\-Hastings\-S\-G@{Q\-U\-E\-S\-O\-::\-Metropolis\-Hastings\-S\-G}!m\-\_\-last\-Adapted\-Cov\-Matrix@{m\-\_\-last\-Adapted\-Cov\-Matrix}}
\index{m\-\_\-last\-Adapted\-Cov\-Matrix@{m\-\_\-last\-Adapted\-Cov\-Matrix}!QUESO::MetropolisHastingsSG@{Q\-U\-E\-S\-O\-::\-Metropolis\-Hastings\-S\-G}}
\subsubsection[{m\-\_\-last\-Adapted\-Cov\-Matrix}]{\setlength{\rightskip}{0pt plus 5cm}template$<$class P\-\_\-\-V, class P\-\_\-\-M$>$ P\-\_\-\-M$\ast$ {\bf Q\-U\-E\-S\-O\-::\-Metropolis\-Hastings\-S\-G}$<$ P\-\_\-\-V, P\-\_\-\-M $>$\-::m\-\_\-last\-Adapted\-Cov\-Matrix\hspace{0.3cm}{\ttfamily [private]}}}\label{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_a1c73b49339c8a1015d95a890d7882331}


Definition at line 272 of file Metropolis\-Hastings\-S\-G.\-h.

\hypertarget{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_a005d221d1c458ff767ed03304ca4cd6f}{\index{Q\-U\-E\-S\-O\-::\-Metropolis\-Hastings\-S\-G@{Q\-U\-E\-S\-O\-::\-Metropolis\-Hastings\-S\-G}!m\-\_\-last\-Chain\-Size@{m\-\_\-last\-Chain\-Size}}
\index{m\-\_\-last\-Chain\-Size@{m\-\_\-last\-Chain\-Size}!QUESO::MetropolisHastingsSG@{Q\-U\-E\-S\-O\-::\-Metropolis\-Hastings\-S\-G}}
\subsubsection[{m\-\_\-last\-Chain\-Size}]{\setlength{\rightskip}{0pt plus 5cm}template$<$class P\-\_\-\-V, class P\-\_\-\-M$>$ double {\bf Q\-U\-E\-S\-O\-::\-Metropolis\-Hastings\-S\-G}$<$ P\-\_\-\-V, P\-\_\-\-M $>$\-::m\-\_\-last\-Chain\-Size\hspace{0.3cm}{\ttfamily [private]}}}\label{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_a005d221d1c458ff767ed03304ca4cd6f}


Definition at line 270 of file Metropolis\-Hastings\-S\-G.\-h.

\hypertarget{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_a9741f56d947e9d7967af91c6ea083b56}{\index{Q\-U\-E\-S\-O\-::\-Metropolis\-Hastings\-S\-G@{Q\-U\-E\-S\-O\-::\-Metropolis\-Hastings\-S\-G}!m\-\_\-last\-Mean@{m\-\_\-last\-Mean}}
\index{m\-\_\-last\-Mean@{m\-\_\-last\-Mean}!QUESO::MetropolisHastingsSG@{Q\-U\-E\-S\-O\-::\-Metropolis\-Hastings\-S\-G}}
\subsubsection[{m\-\_\-last\-Mean}]{\setlength{\rightskip}{0pt plus 5cm}template$<$class P\-\_\-\-V, class P\-\_\-\-M$>$ P\-\_\-\-V$\ast$ {\bf Q\-U\-E\-S\-O\-::\-Metropolis\-Hastings\-S\-G}$<$ P\-\_\-\-V, P\-\_\-\-M $>$\-::m\-\_\-last\-Mean\hspace{0.3cm}{\ttfamily [private]}}}\label{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_a9741f56d947e9d7967af91c6ea083b56}


Definition at line 271 of file Metropolis\-Hastings\-S\-G.\-h.

\hypertarget{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_ac33a6e46e05c20c071a46ecf58a9291c}{\index{Q\-U\-E\-S\-O\-::\-Metropolis\-Hastings\-S\-G@{Q\-U\-E\-S\-O\-::\-Metropolis\-Hastings\-S\-G}!m\-\_\-log\-Targets@{m\-\_\-log\-Targets}}
\index{m\-\_\-log\-Targets@{m\-\_\-log\-Targets}!QUESO::MetropolisHastingsSG@{Q\-U\-E\-S\-O\-::\-Metropolis\-Hastings\-S\-G}}
\subsubsection[{m\-\_\-log\-Targets}]{\setlength{\rightskip}{0pt plus 5cm}template$<$class P\-\_\-\-V, class P\-\_\-\-M$>$ std\-::vector$<$double$>$ {\bf Q\-U\-E\-S\-O\-::\-Metropolis\-Hastings\-S\-G}$<$ P\-\_\-\-V, P\-\_\-\-M $>$\-::m\-\_\-log\-Targets\hspace{0.3cm}{\ttfamily [private]}}}\label{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_ac33a6e46e05c20c071a46ecf58a9291c}


Definition at line 268 of file Metropolis\-Hastings\-S\-G.\-h.

\hypertarget{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_a416c5ed0c8520d23a479d4a6d3c3c083}{\index{Q\-U\-E\-S\-O\-::\-Metropolis\-Hastings\-S\-G@{Q\-U\-E\-S\-O\-::\-Metropolis\-Hastings\-S\-G}!m\-\_\-null\-Input\-Proposal\-Cov\-Matrix@{m\-\_\-null\-Input\-Proposal\-Cov\-Matrix}}
\index{m\-\_\-null\-Input\-Proposal\-Cov\-Matrix@{m\-\_\-null\-Input\-Proposal\-Cov\-Matrix}!QUESO::MetropolisHastingsSG@{Q\-U\-E\-S\-O\-::\-Metropolis\-Hastings\-S\-G}}
\subsubsection[{m\-\_\-null\-Input\-Proposal\-Cov\-Matrix}]{\setlength{\rightskip}{0pt plus 5cm}template$<$class P\-\_\-\-V, class P\-\_\-\-M$>$ bool {\bf Q\-U\-E\-S\-O\-::\-Metropolis\-Hastings\-S\-G}$<$ P\-\_\-\-V, P\-\_\-\-M $>$\-::m\-\_\-null\-Input\-Proposal\-Cov\-Matrix\hspace{0.3cm}{\ttfamily [private]}}}\label{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_a416c5ed0c8520d23a479d4a6d3c3c083}


Definition at line 259 of file Metropolis\-Hastings\-S\-G.\-h.

\hypertarget{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_a43a883aa28c81ed99e5f0cd9de93889b}{\index{Q\-U\-E\-S\-O\-::\-Metropolis\-Hastings\-S\-G@{Q\-U\-E\-S\-O\-::\-Metropolis\-Hastings\-S\-G}!m\-\_\-num\-Disabled\-Parameters@{m\-\_\-num\-Disabled\-Parameters}}
\index{m\-\_\-num\-Disabled\-Parameters@{m\-\_\-num\-Disabled\-Parameters}!QUESO::MetropolisHastingsSG@{Q\-U\-E\-S\-O\-::\-Metropolis\-Hastings\-S\-G}}
\subsubsection[{m\-\_\-num\-Disabled\-Parameters}]{\setlength{\rightskip}{0pt plus 5cm}template$<$class P\-\_\-\-V, class P\-\_\-\-M$>$ unsigned int {\bf Q\-U\-E\-S\-O\-::\-Metropolis\-Hastings\-S\-G}$<$ P\-\_\-\-V, P\-\_\-\-M $>$\-::m\-\_\-num\-Disabled\-Parameters\hspace{0.3cm}{\ttfamily [private]}}}\label{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_a43a883aa28c81ed99e5f0cd9de93889b}


Definition at line 260 of file Metropolis\-Hastings\-S\-G.\-h.

\hypertarget{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_a60695940f442f6568d10ee9e456032c7}{\index{Q\-U\-E\-S\-O\-::\-Metropolis\-Hastings\-S\-G@{Q\-U\-E\-S\-O\-::\-Metropolis\-Hastings\-S\-G}!m\-\_\-num\-Positions\-Not\-Sub\-Written@{m\-\_\-num\-Positions\-Not\-Sub\-Written}}
\index{m\-\_\-num\-Positions\-Not\-Sub\-Written@{m\-\_\-num\-Positions\-Not\-Sub\-Written}!QUESO::MetropolisHastingsSG@{Q\-U\-E\-S\-O\-::\-Metropolis\-Hastings\-S\-G}}
\subsubsection[{m\-\_\-num\-Positions\-Not\-Sub\-Written}]{\setlength{\rightskip}{0pt plus 5cm}template$<$class P\-\_\-\-V, class P\-\_\-\-M$>$ unsigned int {\bf Q\-U\-E\-S\-O\-::\-Metropolis\-Hastings\-S\-G}$<$ P\-\_\-\-V, P\-\_\-\-M $>$\-::m\-\_\-num\-Positions\-Not\-Sub\-Written\hspace{0.3cm}{\ttfamily [private]}}}\label{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_a60695940f442f6568d10ee9e456032c7}


Definition at line 273 of file Metropolis\-Hastings\-S\-G.\-h.

\hypertarget{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_a5d0bc9f73d50d272aa6bfb5ef5939ef3}{\index{Q\-U\-E\-S\-O\-::\-Metropolis\-Hastings\-S\-G@{Q\-U\-E\-S\-O\-::\-Metropolis\-Hastings\-S\-G}!m\-\_\-options\-Obj@{m\-\_\-options\-Obj}}
\index{m\-\_\-options\-Obj@{m\-\_\-options\-Obj}!QUESO::MetropolisHastingsSG@{Q\-U\-E\-S\-O\-::\-Metropolis\-Hastings\-S\-G}}
\subsubsection[{m\-\_\-options\-Obj}]{\setlength{\rightskip}{0pt plus 5cm}template$<$class P\-\_\-\-V, class P\-\_\-\-M$>$ {\bf Metropolis\-Hastings\-S\-G\-Options}$\ast$ {\bf Q\-U\-E\-S\-O\-::\-Metropolis\-Hastings\-S\-G}$<$ P\-\_\-\-V, P\-\_\-\-M $>$\-::m\-\_\-options\-Obj\hspace{0.3cm}{\ttfamily [private]}}}\label{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_a5d0bc9f73d50d272aa6bfb5ef5939ef3}


Definition at line 278 of file Metropolis\-Hastings\-S\-G.\-h.



Referenced by Q\-U\-E\-S\-O\-::\-Metropolis\-Hastings\-S\-G$<$ P\-\_\-\-V, P\-\_\-\-M $>$\-::\-Metropolis\-Hastings\-S\-G().

\hypertarget{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_afce8eeadae98935c72727b3640e88a31}{\index{Q\-U\-E\-S\-O\-::\-Metropolis\-Hastings\-S\-G@{Q\-U\-E\-S\-O\-::\-Metropolis\-Hastings\-S\-G}!m\-\_\-parameter\-Enabled\-Status@{m\-\_\-parameter\-Enabled\-Status}}
\index{m\-\_\-parameter\-Enabled\-Status@{m\-\_\-parameter\-Enabled\-Status}!QUESO::MetropolisHastingsSG@{Q\-U\-E\-S\-O\-::\-Metropolis\-Hastings\-S\-G}}
\subsubsection[{m\-\_\-parameter\-Enabled\-Status}]{\setlength{\rightskip}{0pt plus 5cm}template$<$class P\-\_\-\-V, class P\-\_\-\-M$>$ std\-::vector$<$bool$>$ {\bf Q\-U\-E\-S\-O\-::\-Metropolis\-Hastings\-S\-G}$<$ P\-\_\-\-V, P\-\_\-\-M $>$\-::m\-\_\-parameter\-Enabled\-Status\hspace{0.3cm}{\ttfamily [private]}}}\label{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_afce8eeadae98935c72727b3640e88a31}


Definition at line 261 of file Metropolis\-Hastings\-S\-G.\-h.

\hypertarget{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_a49500f5107190c94813e232cd806c2bc}{\index{Q\-U\-E\-S\-O\-::\-Metropolis\-Hastings\-S\-G@{Q\-U\-E\-S\-O\-::\-Metropolis\-Hastings\-S\-G}!m\-\_\-position\-Id\-For\-Debugging@{m\-\_\-position\-Id\-For\-Debugging}}
\index{m\-\_\-position\-Id\-For\-Debugging@{m\-\_\-position\-Id\-For\-Debugging}!QUESO::MetropolisHastingsSG@{Q\-U\-E\-S\-O\-::\-Metropolis\-Hastings\-S\-G}}
\subsubsection[{m\-\_\-position\-Id\-For\-Debugging}]{\setlength{\rightskip}{0pt plus 5cm}template$<$class P\-\_\-\-V, class P\-\_\-\-M$>$ unsigned int {\bf Q\-U\-E\-S\-O\-::\-Metropolis\-Hastings\-S\-G}$<$ P\-\_\-\-V, P\-\_\-\-M $>$\-::m\-\_\-position\-Id\-For\-Debugging\hspace{0.3cm}{\ttfamily [private]}}}\label{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_a49500f5107190c94813e232cd806c2bc}


Definition at line 265 of file Metropolis\-Hastings\-S\-G.\-h.

\hypertarget{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_ac531509489028853bb17c0353fc9eafd}{\index{Q\-U\-E\-S\-O\-::\-Metropolis\-Hastings\-S\-G@{Q\-U\-E\-S\-O\-::\-Metropolis\-Hastings\-S\-G}!m\-\_\-raw\-Chain\-Info@{m\-\_\-raw\-Chain\-Info}}
\index{m\-\_\-raw\-Chain\-Info@{m\-\_\-raw\-Chain\-Info}!QUESO::MetropolisHastingsSG@{Q\-U\-E\-S\-O\-::\-Metropolis\-Hastings\-S\-G}}
\subsubsection[{m\-\_\-raw\-Chain\-Info}]{\setlength{\rightskip}{0pt plus 5cm}template$<$class P\-\_\-\-V, class P\-\_\-\-M$>$ {\bf M\-H\-Raw\-Chain\-Info\-Struct} {\bf Q\-U\-E\-S\-O\-::\-Metropolis\-Hastings\-S\-G}$<$ P\-\_\-\-V, P\-\_\-\-M $>$\-::m\-\_\-raw\-Chain\-Info\hspace{0.3cm}{\ttfamily [private]}}}\label{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_ac531509489028853bb17c0353fc9eafd}


Definition at line 275 of file Metropolis\-Hastings\-S\-G.\-h.

\hypertarget{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_aca9351ab468808759b8b19686231ae4f}{\index{Q\-U\-E\-S\-O\-::\-Metropolis\-Hastings\-S\-G@{Q\-U\-E\-S\-O\-::\-Metropolis\-Hastings\-S\-G}!m\-\_\-stage\-Id\-For\-Debugging@{m\-\_\-stage\-Id\-For\-Debugging}}
\index{m\-\_\-stage\-Id\-For\-Debugging@{m\-\_\-stage\-Id\-For\-Debugging}!QUESO::MetropolisHastingsSG@{Q\-U\-E\-S\-O\-::\-Metropolis\-Hastings\-S\-G}}
\subsubsection[{m\-\_\-stage\-Id\-For\-Debugging}]{\setlength{\rightskip}{0pt plus 5cm}template$<$class P\-\_\-\-V, class P\-\_\-\-M$>$ unsigned int {\bf Q\-U\-E\-S\-O\-::\-Metropolis\-Hastings\-S\-G}$<$ P\-\_\-\-V, P\-\_\-\-M $>$\-::m\-\_\-stage\-Id\-For\-Debugging\hspace{0.3cm}{\ttfamily [private]}}}\label{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_aca9351ab468808759b8b19686231ae4f}


Definition at line 266 of file Metropolis\-Hastings\-S\-G.\-h.

\hypertarget{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_a42ce4ffcb3addf62dd3f19fe8bb09268}{\index{Q\-U\-E\-S\-O\-::\-Metropolis\-Hastings\-S\-G@{Q\-U\-E\-S\-O\-::\-Metropolis\-Hastings\-S\-G}!m\-\_\-target\-Pdf@{m\-\_\-target\-Pdf}}
\index{m\-\_\-target\-Pdf@{m\-\_\-target\-Pdf}!QUESO::MetropolisHastingsSG@{Q\-U\-E\-S\-O\-::\-Metropolis\-Hastings\-S\-G}}
\subsubsection[{m\-\_\-target\-Pdf}]{\setlength{\rightskip}{0pt plus 5cm}template$<$class P\-\_\-\-V, class P\-\_\-\-M$>$ const {\bf Base\-Joint\-Pdf}$<$P\-\_\-\-V,P\-\_\-\-M$>$\& {\bf Q\-U\-E\-S\-O\-::\-Metropolis\-Hastings\-S\-G}$<$ P\-\_\-\-V, P\-\_\-\-M $>$\-::m\-\_\-target\-Pdf\hspace{0.3cm}{\ttfamily [private]}}}\label{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_a42ce4ffcb3addf62dd3f19fe8bb09268}


Definition at line 256 of file Metropolis\-Hastings\-S\-G.\-h.

\hypertarget{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_ae7c7551764e0ccdfbe2862c544cdab10}{\index{Q\-U\-E\-S\-O\-::\-Metropolis\-Hastings\-S\-G@{Q\-U\-E\-S\-O\-::\-Metropolis\-Hastings\-S\-G}!m\-\_\-target\-Pdf\-Synchronizer@{m\-\_\-target\-Pdf\-Synchronizer}}
\index{m\-\_\-target\-Pdf\-Synchronizer@{m\-\_\-target\-Pdf\-Synchronizer}!QUESO::MetropolisHastingsSG@{Q\-U\-E\-S\-O\-::\-Metropolis\-Hastings\-S\-G}}
\subsubsection[{m\-\_\-target\-Pdf\-Synchronizer}]{\setlength{\rightskip}{0pt plus 5cm}template$<$class P\-\_\-\-V, class P\-\_\-\-M$>$ const {\bf Scalar\-Function\-Synchronizer}$<$P\-\_\-\-V,P\-\_\-\-M$>$$\ast$ {\bf Q\-U\-E\-S\-O\-::\-Metropolis\-Hastings\-S\-G}$<$ P\-\_\-\-V, P\-\_\-\-M $>$\-::m\-\_\-target\-Pdf\-Synchronizer\hspace{0.3cm}{\ttfamily [private]}}}\label{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_ae7c7551764e0ccdfbe2862c544cdab10}


Definition at line 262 of file Metropolis\-Hastings\-S\-G.\-h.

\hypertarget{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_a26e9680abddfb793486c995fa16f8c2d}{\index{Q\-U\-E\-S\-O\-::\-Metropolis\-Hastings\-S\-G@{Q\-U\-E\-S\-O\-::\-Metropolis\-Hastings\-S\-G}!m\-\_\-tk@{m\-\_\-tk}}
\index{m\-\_\-tk@{m\-\_\-tk}!QUESO::MetropolisHastingsSG@{Q\-U\-E\-S\-O\-::\-Metropolis\-Hastings\-S\-G}}
\subsubsection[{m\-\_\-tk}]{\setlength{\rightskip}{0pt plus 5cm}template$<$class P\-\_\-\-V, class P\-\_\-\-M$>$ {\bf Base\-T\-K\-Group}$<$P\-\_\-\-V,P\-\_\-\-M$>$$\ast$ {\bf Q\-U\-E\-S\-O\-::\-Metropolis\-Hastings\-S\-G}$<$ P\-\_\-\-V, P\-\_\-\-M $>$\-::m\-\_\-tk\hspace{0.3cm}{\ttfamily [private]}}}\label{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_a26e9680abddfb793486c995fa16f8c2d}


Definition at line 264 of file Metropolis\-Hastings\-S\-G.\-h.

\hypertarget{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_a2ef17fbfc6a156f03bbfad044b5a75f5}{\index{Q\-U\-E\-S\-O\-::\-Metropolis\-Hastings\-S\-G@{Q\-U\-E\-S\-O\-::\-Metropolis\-Hastings\-S\-G}!m\-\_\-vector\-Space@{m\-\_\-vector\-Space}}
\index{m\-\_\-vector\-Space@{m\-\_\-vector\-Space}!QUESO::MetropolisHastingsSG@{Q\-U\-E\-S\-O\-::\-Metropolis\-Hastings\-S\-G}}
\subsubsection[{m\-\_\-vector\-Space}]{\setlength{\rightskip}{0pt plus 5cm}template$<$class P\-\_\-\-V, class P\-\_\-\-M$>$ const {\bf Vector\-Space}$<$P\-\_\-\-V,P\-\_\-\-M$>$\& {\bf Q\-U\-E\-S\-O\-::\-Metropolis\-Hastings\-S\-G}$<$ P\-\_\-\-V, P\-\_\-\-M $>$\-::m\-\_\-vector\-Space\hspace{0.3cm}{\ttfamily [private]}}}\label{class_q_u_e_s_o_1_1_metropolis_hastings_s_g_a2ef17fbfc6a156f03bbfad044b5a75f5}


Definition at line 255 of file Metropolis\-Hastings\-S\-G.\-h.



The documentation for this class was generated from the following files\-:\begin{DoxyCompactItemize}
\item 
src/stats/inc/\hyperlink{_metropolis_hastings_s_g_8h}{Metropolis\-Hastings\-S\-G.\-h}\item 
src/stats/src/\hyperlink{_metropolis_hastings_s_g_8_c}{Metropolis\-Hastings\-S\-G.\-C}\end{DoxyCompactItemize}
